<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JHUGen MELA: MELA/src/TUtil.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JHUGen MELA
   &#160;<span id="projectnumber">v2.4.1</span>
   </div>
   <div id="projectbrief">Matrix element calculations as used in JHUGen. MELA is an important tool that was used for the Higgs boson discovery and for precise measurements of its structure and interactions. Please see the website https://spin.pha.jhu.edu/ and papers cited there for more details, and kindly cite those papers when using this code.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_00387dd39d960209b81c23b2fe5ca929.html">MELA</a></li><li class="navelem"><a class="el" href="dir_a4d860b944a98453144538543559cfe2.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TUtil.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="TUtil_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;cstdio&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;iterator&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MELAStreamHelpers_8hh.html">MELAStreamHelpers.hh</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TJHUGenUtils_8hh.html">TJHUGenUtils.hh</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TUtilHelpers_8hh.html">TUtilHelpers.hh</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TUtil_8hh.html">TUtil.hh</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;TMath.h&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;TLorentzRotation.h&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">using</span> <a class="code" href="structTVar_1_1event__scales__type.html">TVar::event_scales_type</a>;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">using</span> <a class="code" href="structTVar_1_1simple__event__record.html">TVar::simple_event_record</a>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAStreamHelpers::MELAout</a>;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAStreamHelpers::MELAerr</a>;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceTJHUGenUtils.html">TJHUGenUtils</a>;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceTUtil.html">TUtil</a>{</div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#afd769e0556af6d51531e549c9f683e9a">   25</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespaceTUtil.html#afd769e0556af6d51531e549c9f683e9a">forbidMassiveLeptons</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a5908ccfb76dc006556fffda3fb26898a">   26</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespaceTUtil.html#a5908ccfb76dc006556fffda3fb26898a">forbidMassiveJets</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a026e5022c0a942b5d6ea06f02fb8339a">   27</a></span>&#160;  <a class="code" href="namespaceTVar.html#a9725014132a3701b15e4b3b0ae454288">TVar::FermionMassRemoval</a> <a class="code" href="namespaceTUtil.html#a026e5022c0a942b5d6ea06f02fb8339a">LeptonMassScheme</a> = <a class="code" href="namespaceTVar.html#a9725014132a3701b15e4b3b0ae454288a170700978feec9d94d7fadfdbf36161d">TVar::ConserveDifermionMass</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#ac1527caab4673d577edefd7d64c6f9f9">   28</a></span>&#160;  <a class="code" href="namespaceTVar.html#a9725014132a3701b15e4b3b0ae454288">TVar::FermionMassRemoval</a> <a class="code" href="namespaceTUtil.html#ac1527caab4673d577edefd7d64c6f9f9">JetMassScheme</a> = <a class="code" href="namespaceTVar.html#a9725014132a3701b15e4b3b0ae454288a170700978feec9d94d7fadfdbf36161d">TVar::ConserveDifermionMass</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;}</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">/***************************************************/</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">/***** Scripts for decay and production angles *****/</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">/***************************************************/</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a4824d6613cde741139ec5bc7e199ac57">   35</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a4824d6613cde741139ec5bc7e199ac57">TUtil::applyLeptonMassCorrection</a>(<span class="keywordtype">bool</span> flag){ <a class="code" href="namespaceTUtil.html#afd769e0556af6d51531e549c9f683e9a">TUtil::forbidMassiveLeptons</a> = flag; }</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#ae24251edeb2dbc469b31a1e1dc05e51e">   36</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#ae24251edeb2dbc469b31a1e1dc05e51e">TUtil::applyJetMassCorrection</a>(<span class="keywordtype">bool</span> flag){ <a class="code" href="namespaceTUtil.html#a5908ccfb76dc006556fffda3fb26898a">TUtil::forbidMassiveJets</a> = flag; }</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a8a1a325f3bb025d57fa9b649a31c93d2">   37</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a8a1a325f3bb025d57fa9b649a31c93d2">TUtil::setLeptonMassScheme</a>(<a class="code" href="namespaceTVar.html#a9725014132a3701b15e4b3b0ae454288">TVar::FermionMassRemoval</a> scheme){ <a class="code" href="namespaceTUtil.html#a026e5022c0a942b5d6ea06f02fb8339a">LeptonMassScheme</a>=scheme; }</div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a4f9532dc2110d5229def322ed98d61bc">   38</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a4f9532dc2110d5229def322ed98d61bc">TUtil::setJetMassScheme</a>(<a class="code" href="namespaceTVar.html#a9725014132a3701b15e4b3b0ae454288">TVar::FermionMassRemoval</a> scheme){ <a class="code" href="namespaceTUtil.html#ac1527caab4673d577edefd7d64c6f9f9">JetMassScheme</a>=scheme; }</div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a9dabf236e23c4ae39f05d575a1e501f9">   39</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a9dabf236e23c4ae39f05d575a1e501f9">TUtil::constrainedRemovePairMass</a>(TLorentzVector&amp; p1, TLorentzVector&amp; p2, <span class="keywordtype">double</span> m1, <span class="keywordtype">double</span> m2){</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  TLorentzVector <span class="keyword">const</span> nullFourVector(0, 0, 0, 0);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  TLorentzVector p1hat, p2hat;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordflow">if</span> (p1==nullFourVector || p2==nullFourVector) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">  /***** shiftMass in C++ *****/</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  TLorentzVector p12=p1+p2;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  TLorentzVector diffp2p1=p2-p1;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">double</span> p1sq = p1.M2();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">double</span> p2sq = p2.M2();</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">double</span> p1p2 = p1.Dot(p2);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">double</span> m1sq = m1*fabs(m1);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">double</span> m2sq = m2*fabs(m2);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordtype">double</span> p12sq = p12.M2();</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  TLorentzVector avec=(p1sq*p2 - p2sq*p1 + p1p2*diffp2p1);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">double</span> a = avec.M2();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">double</span> b = (p12sq + m2sq - m1sq) * (pow(p1p2, 2) - p1sq*p2sq);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">double</span> c = pow((p12sq + m2sq - m1sq), 2)*p1sq/4. - pow((p1sq + p1p2), 2)*m2sq;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">double</span> eta =  (-b - sqrt(fabs(b*b -4.*a*c)))/(2.*a);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordtype">double</span> xi = (p12sq + m2sq - m1sq - 2.*eta*(p2sq + p1p2))/(2.*(p1sq + p1p2));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  p1hat = (1.-xi)*p1 + (1.-eta)*p2;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  p2hat = xi*p1 + eta*p2;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  p1=p1hat;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  p2=p2hat;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#ab0e969365520b20156c39c71b1f4706b">   66</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#ab0e969365520b20156c39c71b1f4706b">TUtil::scaleMomentumToEnergy</a>(<span class="keyword">const</span> TLorentzVector&amp; massiveJet, TLorentzVector&amp; masslessJet, <span class="keywordtype">double</span> mass){</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordtype">double</span> energy, p3, newp3, <a class="code" href="namespacetestME__all.html#acfc17ef972d1823c2bdf158421c2caf7">ratio</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  energy = massiveJet.T();</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  p3 = massiveJet.P();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  newp3 = sqrt(max(pow(energy, 2)-mass*fabs(mass), 0.));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="namespacetestME__all.html#acfc17ef972d1823c2bdf158421c2caf7">ratio</a> = (p3&gt;0. ? (newp3/p3) : 1.);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  masslessJet.SetXYZT(massiveJet.X()*<a class="code" href="namespacetestME__all.html#acfc17ef972d1823c2bdf158421c2caf7">ratio</a>, massiveJet.Y()*<a class="code" href="namespacetestME__all.html#acfc17ef972d1823c2bdf158421c2caf7">ratio</a>, massiveJet.Z()*<a class="code" href="namespacetestME__all.html#acfc17ef972d1823c2bdf158421c2caf7">ratio</a>, energy);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">   74</a></span>&#160;std::pair&lt;TLorentzVector, TLorentzVector&gt; <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  TLorentzVector <span class="keyword">const</span>&amp; jet1, <span class="keywordtype">int</span> <span class="keyword">const</span>&amp; jet1Id,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  TLorentzVector <span class="keyword">const</span>&amp; jet2, <span class="keywordtype">int</span> <span class="keyword">const</span>&amp; jet2Id,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">double</span> m1, <span class="keywordtype">double</span> m2</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  ){</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  TLorentzVector <span class="keyword">const</span> nullFourVector(0, 0, 0, 0);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  TLorentzVector jet1massless(0, 0, 0, 0), jet2massless(0, 0, 0, 0);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="namespaceTUtil.html#a5908ccfb76dc006556fffda3fb26898a">TUtil::forbidMassiveJets</a></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    ((<a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(jet1Id) &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#ab98f91f00daa234b2d34eaec820cf49f">PDGHelpers::isATopQuark</a>(jet1Id)) || (<a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(jet2Id) &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#ab98f91f00daa234b2d34eaec820cf49f">PDGHelpers::isATopQuark</a>(jet2Id)))</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    ){</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceTUtil.html#ac1527caab4673d577edefd7d64c6f9f9">JetMassScheme</a>==<a class="code" href="namespaceTVar.html#a9725014132a3701b15e4b3b0ae454288a504d28683182f56661c4f1a590419ff2">TVar::NoRemoval</a>){</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      jet1massless=jet1;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      jet2massless=jet2;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (jet1==nullFourVector || jet2==nullFourVector || jet1==jet2 || <a class="code" href="namespaceTUtil.html#ac1527caab4673d577edefd7d64c6f9f9">JetMassScheme</a>==<a class="code" href="namespaceTVar.html#a9725014132a3701b15e4b3b0ae454288a92ca30ccc4c56e5c0bb63fd87c1a4c87">TVar::MomentumToEnergy</a>){</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <a class="code" href="namespaceTUtil.html#ab0e969365520b20156c39c71b1f4706b">TUtil::scaleMomentumToEnergy</a>(jet1, jet1massless, m1);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <a class="code" href="namespaceTUtil.html#ab0e969365520b20156c39c71b1f4706b">TUtil::scaleMomentumToEnergy</a>(jet2, jet2massless, m2);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceTUtil.html#ac1527caab4673d577edefd7d64c6f9f9">JetMassScheme</a>==<a class="code" href="namespaceTVar.html#a9725014132a3701b15e4b3b0ae454288a170700978feec9d94d7fadfdbf36161d">TVar::ConserveDifermionMass</a>){</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      jet1massless=jet1;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      jet2massless=jet2;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <a class="code" href="namespaceTUtil.html#a9dabf236e23c4ae39f05d575a1e501f9">TUtil::constrainedRemovePairMass</a>(jet1massless, jet2massless, m1, m2);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      jet1massless=jet1;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      jet2massless=jet2;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceTUtil.html#afd769e0556af6d51531e549c9f683e9a">TUtil::forbidMassiveLeptons</a> &amp;&amp; (<a class="code" href="namespacePDGHelpers.html#a6f98f45dbd53233287193ec3fe987746">PDGHelpers::isALepton</a>(jet1Id) || <a class="code" href="namespacePDGHelpers.html#a68ffb179226737e2006fb7b0870dae6a">PDGHelpers::isANeutrino</a>(jet1Id) || <a class="code" href="namespacePDGHelpers.html#a6f98f45dbd53233287193ec3fe987746">PDGHelpers::isALepton</a>(jet2Id) || <a class="code" href="namespacePDGHelpers.html#a68ffb179226737e2006fb7b0870dae6a">PDGHelpers::isANeutrino</a>(jet2Id))){</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceTUtil.html#a026e5022c0a942b5d6ea06f02fb8339a">LeptonMassScheme</a>==<a class="code" href="namespaceTVar.html#a9725014132a3701b15e4b3b0ae454288a504d28683182f56661c4f1a590419ff2">TVar::NoRemoval</a>){</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      jet1massless=jet1;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      jet2massless=jet2;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (jet1==nullFourVector || jet2==nullFourVector || jet1==jet2 || <a class="code" href="namespaceTUtil.html#a026e5022c0a942b5d6ea06f02fb8339a">LeptonMassScheme</a>==<a class="code" href="namespaceTVar.html#a9725014132a3701b15e4b3b0ae454288a92ca30ccc4c56e5c0bb63fd87c1a4c87">TVar::MomentumToEnergy</a>){</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="namespaceTUtil.html#ab0e969365520b20156c39c71b1f4706b">TUtil::scaleMomentumToEnergy</a>(jet1, jet1massless, m1);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <a class="code" href="namespaceTUtil.html#ab0e969365520b20156c39c71b1f4706b">TUtil::scaleMomentumToEnergy</a>(jet2, jet2massless, m2);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceTUtil.html#a026e5022c0a942b5d6ea06f02fb8339a">LeptonMassScheme</a>==<a class="code" href="namespaceTVar.html#a9725014132a3701b15e4b3b0ae454288a170700978feec9d94d7fadfdbf36161d">TVar::ConserveDifermionMass</a>){</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      jet1massless=jet1;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      jet2massless=jet2;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <a class="code" href="namespaceTUtil.html#a9dabf236e23c4ae39f05d575a1e501f9">TUtil::constrainedRemovePairMass</a>(jet1massless, jet2massless, m1, m2);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      jet1massless=jet1;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      jet2massless=jet2;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    jet1massless=jet1;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    jet2massless=jet2;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  pair&lt;TLorentzVector, TLorentzVector&gt; result(jet1massless, jet2massless);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a22ae65dea83b7d412dd94f09ac3b7de7">  132</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a22ae65dea83b7d412dd94f09ac3b7de7">TUtil::adjustTopDaughters</a>(<a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a>&amp; <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>){ <span class="comment">// Daughters are arranged as b, Wf, Wfb</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.size()!=3) <span class="keywordflow">return</span>; <span class="comment">// Cannot work if the number of daughters is not exactly 3.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  pair&lt;TLorentzVector, TLorentzVector&gt; corrWpair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(1).second, <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(1).first,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(2).second, <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(2).first</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    );</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(1).second = corrWpair.first;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(2).second = corrWpair.second;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  TLorentzVector pW = <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(1).second+<a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(2).second;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  TVector3 pW_boost_old = -pW.BoostVector();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  pair&lt;TLorentzVector, TLorentzVector&gt; corrbW = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(0).second, <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(0).first,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    pW, -<a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(0).first, <span class="comment">// Trick the function</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    0., pW.M() <span class="comment">// Conserve W mass, ensures Wf+Wfb=W after re-boosting Wf and Wfb to the new W frame.</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    );</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(0).second=corrbW.first;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  pW=corrbW.second;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  TVector3 pW_boost_new = pW.BoostVector();</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idau=1; idau&lt;<a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.size(); idau++){</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(idau).second.Boost(pW_boost_old);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(idau).second.Boost(pW_boost_new);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">// Compute a fake jet</span></div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#aad23bf004cb07fe852407f58e64dabd1">  156</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#aad23bf004cb07fe852407f58e64dabd1">TUtil::computeFakeJet</a>(TLorentzVector <span class="keyword">const</span>&amp; realJet, TLorentzVector <span class="keyword">const</span>&amp; others, TLorentzVector&amp; fakeJet){</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  TLorentzVector masslessRealJet(0, 0, 0, 0);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceTUtil.html#a5908ccfb76dc006556fffda3fb26898a">TUtil::forbidMassiveJets</a>) <a class="code" href="namespaceTUtil.html#ab0e969365520b20156c39c71b1f4706b">TUtil::scaleMomentumToEnergy</a>(realJet, masslessRealJet);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordflow">else</span> masslessRealJet = realJet;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  fakeJet = others + masslessRealJet;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  fakeJet.SetVect(-fakeJet.Vect());</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  fakeJet.SetE(fakeJet.P());</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">/***** Complex Boost *****/</span></div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a30ecd7cb8ba8ecd70fc2f18c0d7d56ee">  166</a></span>&#160;std::pair&lt;TLorentzVector, TLorentzVector&gt; <a class="code" href="namespaceTUtil.html#a30ecd7cb8ba8ecd70fc2f18c0d7d56ee">TUtil::ComplexBoost</a>(TVector3 <span class="keyword">const</span>&amp; beta, TLorentzVector <span class="keyword">const</span>&amp; p4){</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordtype">double</span> bx=beta.X();</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordtype">double</span> by=beta.Y();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordtype">double</span> bz=beta.Z();</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="namespacemodparameters.html#a07c57cc6e137206a0865bbad7e6fe289">b2</a> = bx*bx + by*by + bz*bz;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordtype">double</span> gammasqinv = 1.-<a class="code" href="namespacemodparameters.html#a07c57cc6e137206a0865bbad7e6fe289">b2</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordtype">double</span> gamma=0.;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordtype">double</span> bp = bx*p4.X() + by*p4.Y() + bz*p4.Z();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">double</span> gammap_real=0;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordtype">double</span> gammap_imag=0;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  TLorentzVector p4new_real(0, 0, 0, 0), p4new_imag(0, 0, 0, 0);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">if</span> (gammasqinv&gt;0.){</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    gamma = 1./sqrt(gammasqinv);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a07c57cc6e137206a0865bbad7e6fe289">b2</a>&gt;0.) gammap_real = (gamma-1.)/<a class="code" href="namespacemodparameters.html#a07c57cc6e137206a0865bbad7e6fe289">b2</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    p4new_real.SetX(p4.X() + gammap_real*bp*bx + gamma*bx*p4.T());</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    p4new_real.SetY(p4.Y() + gammap_real*bp*by + gamma*by*p4.T());</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    p4new_real.SetZ(p4.Z() + gammap_real*bp*bz + gamma*bz*p4.T());</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    p4new_real.SetT(gamma*(p4.T() + bp));</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (gammasqinv&lt;0.){</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    gamma = -1./sqrt(-gammasqinv);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a07c57cc6e137206a0865bbad7e6fe289">b2</a>&gt;0.){</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      gammap_real = -1./<a class="code" href="namespacemodparameters.html#a07c57cc6e137206a0865bbad7e6fe289">b2</a>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      gammap_imag = gamma/<a class="code" href="namespacemodparameters.html#a07c57cc6e137206a0865bbad7e6fe289">b2</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    p4new_real.SetX(p4.X() + gammap_real*bp*bx);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    p4new_real.SetY(p4.Y() + gammap_real*bp*by);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    p4new_real.SetZ(p4.Z() + gammap_real*bp*bz);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    p4new_real.SetT(0.);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    p4new_imag.SetX(gammap_imag*bp*bx + gamma*bx*p4.T());</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    p4new_imag.SetY(gammap_imag*bp*by + gamma*by*p4.T());</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    p4new_imag.SetZ(gammap_imag*bp*bz + gamma*bz*p4.T());</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    p4new_imag.SetT(gamma*(p4.T() + bp));</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordflow">return</span> (pair&lt;TLorentzVector, TLorentzVector&gt;(p4new_real, p4new_imag));</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">/***** Decay angles *****/</span></div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#afa81b178917557f2d5440957bbf5f08b">  208</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#afa81b178917557f2d5440957bbf5f08b">TUtil::computeAngles</a>(</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordtype">float</span>&amp; costhetastar,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordtype">float</span>&amp; costheta1,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordtype">float</span>&amp; costheta2,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordtype">float</span>&amp; Phi,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordtype">float</span>&amp; Phi1,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  TLorentzVector p4M11, <span class="keywordtype">int</span> Z1_lept1Id,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  TLorentzVector p4M12, <span class="keywordtype">int</span> Z1_lept2Id,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  TLorentzVector p4M21, <span class="keywordtype">int</span> Z2_lept1Id,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  TLorentzVector p4M22, <span class="keywordtype">int</span> Z2_lept2Id</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  ){</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  TLorentzVector <span class="keyword">const</span> nullFourVector(0, 0, 0, 0);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordflow">if</span> (p4M12==nullFourVector || p4M22==nullFourVector){</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    pair&lt;TLorentzVector, TLorentzVector&gt; f13Pair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(p4M11, Z1_lept1Id, p4M21, Z2_lept1Id);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    p4M11 = f13Pair.first;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    p4M21 = f13Pair.second;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p4M11==nullFourVector || p4M21==nullFourVector){</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    pair&lt;TLorentzVector, TLorentzVector&gt; f24Pair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(p4M12, Z1_lept2Id, p4M22, Z2_lept2Id);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    p4M12 = f24Pair.first;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    p4M22 = f24Pair.second;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    pair&lt;TLorentzVector, TLorentzVector&gt; f12Pair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(p4M11, Z1_lept1Id, p4M12, Z1_lept2Id);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    pair&lt;TLorentzVector, TLorentzVector&gt; f34Pair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(p4M21, Z2_lept1Id, p4M22, Z2_lept2Id);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    p4M11 = f12Pair.first;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    p4M12 = f12Pair.second;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    p4M21 = f34Pair.first;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    p4M22 = f34Pair.second;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">//build Z 4-vectors</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  TLorentzVector p4Z1 = p4M11 + p4M12;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  TLorentzVector p4Z2 = p4M21 + p4M22;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">// Sort Z1 leptons so that...</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    Z1_lept2Id!=-9000</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    (</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    (Z1_lept1Id*Z1_lept2Id&lt;0 &amp;&amp; Z1_lept1Id&lt;0) <span class="comment">// ...for OS pairs, lep1 is the particle.</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    ||</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    ((Z1_lept1Id*Z1_lept2Id&gt;0 || (Z1_lept1Id==0 &amp;&amp; Z1_lept2Id==0)) &amp;&amp; p4M11.Phi()&lt;=p4M12.Phi()) <span class="comment">// ...for SS pairs, a random deterministic convention is used.</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    )</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    ) swap(p4M11, p4M12);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">// Same for Z2 leptons</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    Z2_lept2Id!=-9000</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    (</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    (Z2_lept1Id*Z2_lept2Id&lt;0 &amp;&amp; Z2_lept1Id&lt;0)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    ||</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    ((Z2_lept1Id*Z2_lept2Id&gt;0 || (Z2_lept1Id==0 &amp;&amp; Z2_lept2Id==0)) &amp;&amp; p4M21.Phi()&lt;=p4M22.Phi())</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    )</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    ) swap(p4M21, p4M22);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="comment">// BEGIN THE CALCULATION</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">// build H 4-vectors</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  TLorentzVector p4H = p4Z1 + p4Z2;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="comment">// -----------------------------------</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  TVector3 boostX = -(p4H.BoostVector());</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  TLorentzVector thep4Z1inXFrame(p4Z1);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  TLorentzVector thep4Z2inXFrame(p4Z2);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  thep4Z1inXFrame.Boost(boostX);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  thep4Z2inXFrame.Boost(boostX);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  TVector3 theZ1X_p3 = thep4Z1inXFrame.Vect();</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  TVector3 theZ2X_p3 = thep4Z2inXFrame.Vect();</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  costhetastar = theZ1X_p3.CosTheta();</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  TVector3 boostV1(0, 0, 0);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  TVector3 boostV2(0, 0, 0);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordflow">if</span> (!(fabs(Z1_lept1Id)==21 || fabs(Z1_lept1Id)==22 || fabs(Z1_lept2Id)==21 || fabs(Z1_lept2Id)==22)){</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    boostV1 = -(p4Z1.BoostVector());</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">if</span> (boostV1.Mag()&gt;=1.) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Warning: Mela::computeAngles: Z1 boost with beta=1, scaling down&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      boostV1*=0.9999/boostV1.Mag();</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    TLorentzVector p4M11_BV1(p4M11);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    TLorentzVector p4M12_BV1(p4M12);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    TLorentzVector p4M21_BV1(p4M21);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    TLorentzVector p4M22_BV1(p4M22);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    p4M11_BV1.Boost(boostV1);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    p4M12_BV1.Boost(boostV1);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    p4M21_BV1.Boost(boostV1);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    p4M22_BV1.Boost(boostV1);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    TLorentzVector p4V2_BV1 = p4M21_BV1 + p4M22_BV1;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    costheta1 = -p4V2_BV1.Vect().Unit().Dot(p4M11_BV1.Vect().Unit());</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordflow">else</span> costheta1 = 0;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">if</span> (!(fabs(Z2_lept1Id)==21 || fabs(Z2_lept1Id)==22 || fabs(Z2_lept2Id)==21 || fabs(Z2_lept2Id)==22)){</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    boostV2 = -(p4Z2.BoostVector());</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span> (boostV2.Mag()&gt;=1.) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Warning: Mela::computeAngles: Z2 boost with beta=1, scaling down&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      boostV2*=0.9999/boostV2.Mag();</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    TLorentzVector p4M11_BV2(p4M11);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    TLorentzVector p4M12_BV2(p4M12);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    TLorentzVector p4M21_BV2(p4M21);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    TLorentzVector p4M22_BV2(p4M22);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    p4M11_BV2.Boost(boostV2);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    p4M12_BV2.Boost(boostV2);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    p4M21_BV2.Boost(boostV2);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    p4M22_BV2.Boost(boostV2);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    TLorentzVector p4V1_BV2 = p4M11_BV2 + p4M12_BV2;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    costheta2 = -p4V1_BV2.Vect().Unit().Dot(p4M21_BV2.Vect().Unit());</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">else</span> costheta2 = 0;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  TLorentzVector p4M11_BX(p4M11);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  TLorentzVector p4M12_BX(p4M12);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  TLorentzVector p4M21_BX(p4M21);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  TLorentzVector p4M22_BX(p4M22);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  p4M11_BX.Boost(boostX);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  p4M12_BX.Boost(boostX);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  p4M21_BX.Boost(boostX);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  p4M22_BX.Boost(boostX);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  TLorentzVector p4V1_BX = p4M11_BX + p4M12_BX;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  TVector3 <span class="keyword">const</span> beamAxis(0, 0, 1);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  TVector3 p3V1_BX = p4V1_BX.Vect().Unit();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  TVector3 normal1_BX = (p4M11_BX.Vect().Cross(p4M12_BX.Vect())).Unit();</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  TVector3 normal2_BX = (p4M21_BX.Vect().Cross(p4M22_BX.Vect())).Unit();</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  TVector3 normalSC_BX = (beamAxis.Cross(p3V1_BX)).Unit();</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordtype">float</span> tmpSgnPhi = p3V1_BX.Dot(normal1_BX.Cross(normal2_BX));</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordtype">float</span> sgnPhi = 0;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordflow">if</span> (fabs(tmpSgnPhi)&gt;0.) sgnPhi = tmpSgnPhi/fabs(tmpSgnPhi);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordtype">float</span> dot_BX12 = normal1_BX.Dot(normal2_BX);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">if</span> (fabs(dot_BX12)&gt;=1.) dot_BX12 *= 1./fabs(dot_BX12);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  Phi = sgnPhi * acos(-1.*dot_BX12);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordtype">float</span> tmpSgnPhi1 = p3V1_BX.Dot(normal1_BX.Cross(normalSC_BX));</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordtype">float</span> sgnPhi1 = 0;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">if</span> (fabs(tmpSgnPhi1)&gt;0.) sgnPhi1 = tmpSgnPhi1/fabs(tmpSgnPhi1);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordtype">float</span> dot_BX1SC = normal1_BX.Dot(normalSC_BX);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">if</span> (fabs(dot_BX1SC)&gt;=1.) dot_BX1SC *= 1./fabs(dot_BX1SC);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  Phi1 = sgnPhi1 * acos(dot_BX1SC);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacemodmisc.html#aec88f7154cdc627bd8c823597a684073">isnan</a>(costhetastar) || <a class="code" href="namespacemodmisc.html#aec88f7154cdc627bd8c823597a684073">isnan</a>(costheta1) || <a class="code" href="namespacemodmisc.html#aec88f7154cdc627bd8c823597a684073">isnan</a>(costheta2) || <a class="code" href="namespacemodmisc.html#aec88f7154cdc627bd8c823597a684073">isnan</a>(Phi) || <a class="code" href="namespacemodmisc.html#aec88f7154cdc627bd8c823597a684073">isnan</a>(Phi1)){</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: NaN in computeAngles: &quot;</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      &lt;&lt; costhetastar &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      &lt;&lt; costheta1  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      &lt;&lt; costheta2  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      &lt;&lt; Phi  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      &lt;&lt; Phi1  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;   boostV1: &quot;</span> &lt;&lt;boostV1.Pt() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; boostV1.Eta() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; boostV1.Phi() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; boostV1.Mag() &lt;&lt; endl;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;   boostV2: &quot;</span> &lt;&lt;boostV2.Pt() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; boostV2.Eta() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; boostV2.Phi() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; boostV2.Mag() &lt;&lt; endl;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div>
<div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a97664aaabcea7347c605799618ed1764">  374</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a97664aaabcea7347c605799618ed1764">TUtil::computeAnglesCS</a>(</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordtype">float</span> <span class="keyword">const</span>&amp; pbeam,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordtype">float</span>&amp; costhetastar,</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordtype">float</span>&amp; costheta1,</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordtype">float</span>&amp; costheta2,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordtype">float</span>&amp; Phi,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordtype">float</span>&amp; Phi1,</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  TLorentzVector p4M11, <span class="keywordtype">int</span> Z1_lept1Id,</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  TLorentzVector p4M12, <span class="keywordtype">int</span> Z1_lept2Id,</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  TLorentzVector p4M21, <span class="keywordtype">int</span> Z2_lept1Id,</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  TLorentzVector p4M22, <span class="keywordtype">int</span> Z2_lept2Id</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  ){</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  TLorentzVector <span class="keyword">const</span> nullFourVector(0, 0, 0, 0);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordflow">if</span> (p4M12==nullFourVector || p4M22==nullFourVector){</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    pair&lt;TLorentzVector, TLorentzVector&gt; f13Pair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(p4M11, Z1_lept1Id, p4M21, Z2_lept1Id);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    p4M11 = f13Pair.first;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    p4M21 = f13Pair.second;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p4M11==nullFourVector || p4M21==nullFourVector){</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    pair&lt;TLorentzVector, TLorentzVector&gt; f24Pair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(p4M12, Z1_lept2Id, p4M22, Z2_lept2Id);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    p4M12 = f24Pair.first;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    p4M22 = f24Pair.second;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    pair&lt;TLorentzVector, TLorentzVector&gt; f12Pair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(p4M11, Z1_lept1Id, p4M12, Z1_lept2Id);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    pair&lt;TLorentzVector, TLorentzVector&gt; f34Pair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(p4M21, Z2_lept1Id, p4M22, Z2_lept2Id);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    p4M11 = f12Pair.first;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    p4M12 = f12Pair.second;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    p4M21 = f34Pair.first;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    p4M22 = f34Pair.second;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  TVector3 LabXaxis(1.0, 0.0, 0.0);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  TVector3 LabYaxis(0.0, 1.0, 0.0);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  TVector3 LabZaxis(0.0, 0.0, 1.0);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordtype">float</span> Mprot = 0.938;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordtype">float</span> Ebeam = sqrt(pbeam*pbeam + Mprot*Mprot);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  TLorentzVector targ(0., 0., -pbeam, Ebeam);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  TLorentzVector beam(0., 0., pbeam, Ebeam);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="comment">//build Z 4-vectors</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  TLorentzVector p4Z1 = p4M11 + p4M12;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  TLorentzVector p4Z2 = p4M21 + p4M22;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="comment">// Sort Z1 leptons so that:</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    Z1_lept2Id!=9000</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    (</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    (Z1_lept1Id*Z1_lept2Id&lt;0 &amp;&amp; Z1_lept1Id&lt;0) <span class="comment">// for OS pairs: lep1 must be the negative one</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    ||</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    ((Z1_lept1Id*Z1_lept2Id&gt;0 || (Z1_lept1Id==0 &amp;&amp; Z1_lept2Id==0)) &amp;&amp; p4M11.Phi()&lt;=p4M12.Phi()) <span class="comment">//for SS pairs: use random deterministic convention</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    )</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    ) swap(p4M11, p4M12);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="comment">// Same for Z2 leptons</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    Z2_lept2Id!=9000</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    (</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    (Z2_lept1Id*Z2_lept2Id&lt;0 &amp;&amp; Z2_lept1Id&lt;0)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    ||</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    ((Z2_lept1Id*Z2_lept2Id&gt;0 || (Z2_lept1Id==0 &amp;&amp; Z2_lept2Id==0)) &amp;&amp; p4M21.Phi()&lt;=p4M22.Phi())</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    )</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    ) swap(p4M21, p4M22);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="comment">//build H 4-vectors</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  TLorentzVector p4H = p4Z1 + p4Z2;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  TVector3 boostX = -(p4H.BoostVector());</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="comment">// Collin-Sopper calculation:</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="comment">// in the CS frame, the z-axis is along the bisectrice of one beam and the opposite of the other beam,</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">// after their boost in X</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment"></span>  <span class="comment">// Rotation for the CS Frame</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  TRotation rotationCS;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  TLorentzVector beaminX(beam);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  TLorentzVector targinX(targ);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  targinX.Boost(boostX);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  beaminX.Boost(boostX);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">//Bisectrice: sum of unit vectors (remember: you need to invert one beam vector)</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  TVector3 beam_targ_bisecinX((beaminX.Vect().Unit() - targinX.Vect().Unit()).Unit());</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="comment">// Define a rotationCS Matrix, with Z along the bisectric, </span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  TVector3 newZaxisCS(beam_targ_bisecinX.Unit());</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  TVector3 newYaxisCS(beaminX.Vect().Unit().Cross(newZaxisCS).Unit());</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  TVector3 newXaxisCS(newYaxisCS.Unit().Cross(newZaxisCS).Unit());</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  rotationCS.RotateAxes(newXaxisCS, newYaxisCS, newZaxisCS);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  rotationCS.Invert();</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  TLorentzVector thep4Z1inXFrame_rotCS(p4Z1);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  TLorentzVector thep4Z2inXFrame_rotCS(p4Z2);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  thep4Z1inXFrame_rotCS.Transform(rotationCS);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  thep4Z2inXFrame_rotCS.Transform(rotationCS);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  thep4Z1inXFrame_rotCS.Boost(boostX);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  thep4Z2inXFrame_rotCS.Boost(boostX);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  TVector3 theZ1XrotCS_p3 = TVector3(thep4Z1inXFrame_rotCS.X(), thep4Z1inXFrame_rotCS.Y(), thep4Z1inXFrame_rotCS.Z());</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  costhetastar = theZ1XrotCS_p3.CosTheta();</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="comment">//    TVector3 boostX = -(thep4H.BoostVector());</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  TLorentzVector p4M11_BX_rotCS(p4M11);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  TLorentzVector p4M12_BX_rotCS(p4M12);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  TLorentzVector p4M21_BX_rotCS(p4M21);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  TLorentzVector p4M22_BX_rotCS(p4M22);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  p4M11_BX_rotCS.Transform(rotationCS);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  p4M12_BX_rotCS.Transform(rotationCS);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  p4M21_BX_rotCS.Transform(rotationCS);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  p4M22_BX_rotCS.Transform(rotationCS);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  p4M11_BX_rotCS.Boost(boostX);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  p4M12_BX_rotCS.Boost(boostX);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  p4M21_BX_rotCS.Boost(boostX);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  p4M22_BX_rotCS.Boost(boostX);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  TLorentzVector p4Z1_BX_rotCS = p4M11_BX_rotCS + p4M12_BX_rotCS;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  TVector3 p3V1_BX_rotCS = (p4Z1_BX_rotCS.Vect()).Unit();</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  TVector3 <span class="keyword">const</span> beamAxis(0, 0, 1);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  TVector3 normal1_BX_rotCS = (p4M11_BX_rotCS.Vect().Cross(p4M12_BX_rotCS.Vect())).Unit();</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  TVector3 normal2_BX_rotCS = (p4M21_BX_rotCS.Vect().Cross(p4M22_BX_rotCS.Vect())).Unit();</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  TVector3 normalSC_BX_rotCS = (beamAxis.Cross(p3V1_BX_rotCS)).Unit();</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordtype">float</span> tmpSgnPhi = p3V1_BX_rotCS.Dot(normal1_BX_rotCS.Cross(normal2_BX_rotCS));</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keywordtype">float</span> sgnPhi = 0;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">if</span> (fabs(tmpSgnPhi)&gt;0.) sgnPhi = tmpSgnPhi/fabs(tmpSgnPhi);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordtype">float</span> dot_BX12 = normal1_BX_rotCS.Dot(normal2_BX_rotCS);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordflow">if</span> (fabs(dot_BX12)&gt;=1.) dot_BX12 *= 1./fabs(dot_BX12);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  Phi = sgnPhi * acos(-1.*dot_BX12);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordtype">float</span> tmpSgnPhi1 = p3V1_BX_rotCS.Dot(normal1_BX_rotCS.Cross(normalSC_BX_rotCS));</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordtype">float</span> sgnPhi1 = 0;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keywordflow">if</span> (fabs(tmpSgnPhi1)&gt;0.) sgnPhi1 = tmpSgnPhi1/fabs(tmpSgnPhi1);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="keywordtype">float</span> dot_BX1SC = normal1_BX_rotCS.Dot(normalSC_BX_rotCS);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">if</span> (fabs(dot_BX1SC)&gt;=1.) dot_BX1SC *= 1./fabs(dot_BX1SC);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  Phi1 = sgnPhi1 * acos(dot_BX1SC);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordflow">if</span> (!(fabs(Z1_lept1Id)==21 || fabs(Z1_lept1Id)==22 || fabs(Z1_lept2Id)==21 || fabs(Z1_lept2Id)==22)){</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">//define Z1 rotation </span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    TRotation rotationZ1;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    TVector3 newZaxisZ1(thep4Z1inXFrame_rotCS.Vect().Unit());</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    TVector3 newXaxisZ1(newYaxisCS.Cross(newZaxisZ1).Unit());</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    TVector3 newYaxisZ1(newZaxisZ1.Cross(newXaxisZ1).Unit());</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    rotationZ1.RotateAxes(newXaxisZ1, newYaxisZ1, newZaxisZ1);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    rotationZ1.Invert();</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    TLorentzVector thep4Z1inXFrame_rotCS_rotZ1(thep4Z1inXFrame_rotCS);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    thep4Z1inXFrame_rotCS_rotZ1.Transform(rotationZ1);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    TVector3 boostZ1inX_rotCS_rotZ1= -(thep4Z1inXFrame_rotCS_rotZ1.BoostVector());</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    TLorentzVector p4M11_BX_rotCS_rotZ1(p4M11_BX_rotCS);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    TLorentzVector p4M12_BX_rotCS_rotZ1(p4M12_BX_rotCS);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    TLorentzVector p4M21_BX_rotCS_rotZ1(p4M21_BX_rotCS);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    TLorentzVector p4M22_BX_rotCS_rotZ1(p4M22_BX_rotCS);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    p4M11_BX_rotCS_rotZ1.Transform(rotationZ1);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    p4M12_BX_rotCS_rotZ1.Transform(rotationZ1);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    p4M21_BX_rotCS_rotZ1.Transform(rotationZ1);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    p4M22_BX_rotCS_rotZ1.Transform(rotationZ1);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    p4M11_BX_rotCS_rotZ1.Boost(boostZ1inX_rotCS_rotZ1);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    p4M12_BX_rotCS_rotZ1.Boost(boostZ1inX_rotCS_rotZ1);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    p4M21_BX_rotCS_rotZ1.Boost(boostZ1inX_rotCS_rotZ1);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    p4M22_BX_rotCS_rotZ1.Boost(boostZ1inX_rotCS_rotZ1);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    TLorentzVector p4V2_BX_rotCS_rotZ1 = p4M21_BX_rotCS_rotZ1 + p4M22_BX_rotCS_rotZ1;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    costheta1 = -p4V2_BX_rotCS_rotZ1.Vect().Dot(p4M11_BX_rotCS_rotZ1.Vect())/p4V2_BX_rotCS_rotZ1.Vect().Mag()/p4M11_BX_rotCS_rotZ1.Vect().Mag();</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordflow">else</span> costheta1=0;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">if</span> (!(fabs(Z2_lept1Id)==21 || fabs(Z2_lept1Id)==22 || fabs(Z2_lept2Id)==21 || fabs(Z2_lept2Id)==22)){</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">//define Z2 rotation </span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    TRotation rotationZ2;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    TVector3 newZaxisZ2(thep4Z2inXFrame_rotCS.Vect().Unit());</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    TVector3 newXaxisZ2(newYaxisCS.Cross(newZaxisZ2).Unit());</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    TVector3 newYaxisZ2(newZaxisZ2.Cross(newXaxisZ2).Unit());</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    rotationZ2.RotateAxes(newXaxisZ2, newYaxisZ2, newZaxisZ2);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    rotationZ2.Invert();</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    TLorentzVector thep4Z2inXFrame_rotCS_rotZ2(thep4Z2inXFrame_rotCS);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    thep4Z2inXFrame_rotCS_rotZ2.Transform(rotationZ2);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    TVector3 boostZ2inX_rotCS_rotZ2= -(thep4Z2inXFrame_rotCS_rotZ2.BoostVector());</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    TLorentzVector p4M11_BX_rotCS_rotZ2(p4M11_BX_rotCS);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    TLorentzVector p4M12_BX_rotCS_rotZ2(p4M12_BX_rotCS);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    TLorentzVector p4M21_BX_rotCS_rotZ2(p4M21_BX_rotCS);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    TLorentzVector p4M22_BX_rotCS_rotZ2(p4M22_BX_rotCS);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    p4M11_BX_rotCS_rotZ2.Transform(rotationZ2);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    p4M12_BX_rotCS_rotZ2.Transform(rotationZ2);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    p4M21_BX_rotCS_rotZ2.Transform(rotationZ2);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    p4M22_BX_rotCS_rotZ2.Transform(rotationZ2);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    p4M11_BX_rotCS_rotZ2.Boost(boostZ2inX_rotCS_rotZ2);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    p4M12_BX_rotCS_rotZ2.Boost(boostZ2inX_rotCS_rotZ2);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    p4M21_BX_rotCS_rotZ2.Boost(boostZ2inX_rotCS_rotZ2);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    p4M22_BX_rotCS_rotZ2.Boost(boostZ2inX_rotCS_rotZ2);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    TLorentzVector p4V1_BX_rotCS_rotZ2= p4M11_BX_rotCS_rotZ2 + p4M12_BX_rotCS_rotZ2;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    costheta2 = -p4V1_BX_rotCS_rotZ2.Vect().Dot(p4M21_BX_rotCS_rotZ2.Vect())/p4V1_BX_rotCS_rotZ2.Vect().Mag()/p4M21_BX_rotCS_rotZ2.Vect().Mag();</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">else</span> costheta2=0;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacemodmisc.html#aec88f7154cdc627bd8c823597a684073">isnan</a>(costhetastar) || <a class="code" href="namespacemodmisc.html#aec88f7154cdc627bd8c823597a684073">isnan</a>(costheta1) || <a class="code" href="namespacemodmisc.html#aec88f7154cdc627bd8c823597a684073">isnan</a>(costheta2) || <a class="code" href="namespacemodmisc.html#aec88f7154cdc627bd8c823597a684073">isnan</a>(Phi) || <a class="code" href="namespacemodmisc.html#aec88f7154cdc627bd8c823597a684073">isnan</a>(Phi1)){</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: NaN in computeAngles: &quot;</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      &lt;&lt; costhetastar &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      &lt;&lt; costheta1  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      &lt;&lt; costheta2  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      &lt;&lt; Phi  &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      &lt;&lt; Phi1  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;}</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">/***** Associated production angles *****/</span></div>
<div class="line"><a name="l00596"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#ac25514d0b4bfda2daae52ee27f8d2fe8">  596</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#ac25514d0b4bfda2daae52ee27f8d2fe8">TUtil::computeVBFAngles</a>(</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keywordtype">float</span>&amp; costhetastar,</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keywordtype">float</span>&amp; costheta1,</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordtype">float</span>&amp; costheta2,</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordtype">float</span>&amp; Phi,</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keywordtype">float</span>&amp; Phi1,</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="keywordtype">float</span>&amp; Q2V1,</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordtype">float</span>&amp; Q2V2,</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  TLorentzVector p4M11, <span class="keywordtype">int</span> Z1_lept1Id,</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  TLorentzVector p4M12, <span class="keywordtype">int</span> Z1_lept2Id,</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  TLorentzVector p4M21, <span class="keywordtype">int</span> Z2_lept1Id,</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  TLorentzVector p4M22, <span class="keywordtype">int</span> Z2_lept2Id,</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  TLorentzVector jet1, <span class="keywordtype">int</span> jet1Id,</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  TLorentzVector jet2, <span class="keywordtype">int</span> jet2Id,</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  TLorentzVector* injet1, <span class="keywordtype">int</span> injet1Id, <span class="comment">// Gen. partons in the lab frame</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  TLorentzVector* injet2, <span class="keywordtype">int</span> injet2Id</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  ){</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  TLorentzVector <span class="keyword">const</span> nullFourVector(0, 0, 0, 0);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  TLorentzVector jet1massless, jet2massless;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  pair&lt;TLorentzVector, TLorentzVector&gt; jetPair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(jet1, jet1Id, jet2, jet2Id);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  jet1massless = jetPair.first;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  jet2massless = jetPair.second;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="comment">//build Z 4-vectors</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  TLorentzVector p4Z1 = p4M11 + p4M12;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  TLorentzVector p4Z2 = p4M21 + p4M22;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  TLorentzVector pH = p4Z1+p4Z2;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="comment">//jet1 is defined as going forwards (bigger pz), jet2 going backwards (smaller pz)</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keywordflow">if</span> (jet1massless.Z() &lt; jet2massless.Z()) { swap(jet1massless, jet2massless); swap(jet1Id, jet2Id); }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="comment">//Find the incoming partons - first boost so the pT(HJJ) = 0, then boost away the pz.</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="comment">//This preserves the z direction.  Then assume that the partons come in this z direction.</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="comment">//This is exactly correct at LO (since pT=0 anyway).</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="comment">//Then associate the one going forwards with jet1 and the one going backwards with jet2</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  TLorentzRotation movingframe;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  TLorentzVector pHJJ = pH+jet1massless+jet2massless;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  TLorentzVector pHJJ_perp(pHJJ.X(), pHJJ.Y(), 0, pHJJ.T());</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  movingframe.Boost(-pHJJ_perp.BoostVector());</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  pHJJ.Boost(-pHJJ_perp.BoostVector());</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  movingframe.Boost(-pHJJ.BoostVector());</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  pHJJ.Boost(-pHJJ.BoostVector());   <span class="comment">//make sure to boost HJJ AFTER boosting movingframe</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  TLorentzVector P1(0, 0, pHJJ.T()/2, pHJJ.T()/2);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  TLorentzVector P2(0, 0, -pHJJ.T()/2, pHJJ.T()/2);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="comment">// Transform incoming partons back to original frame</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  P1.Transform(movingframe.Inverse());</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  P2.Transform(movingframe.Inverse());</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  pHJJ.Transform(movingframe.Inverse());</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="comment">// movingframe and HJJ_T will not be used anymore</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="comment">// Handle gen. partons if they are available</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordflow">if</span> (injet1 &amp;&amp; injet2 &amp;&amp; fabs((*injet1+*injet2).P()-pHJJ.P())&lt;pHJJ.P()*1e-4){</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    P1=*injet1;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    P2=*injet2;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">if</span> (P1.Z() &lt; P2.Z()){</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      swap(P1, P2);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      swap(injet1Id, injet2Id);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">// In the case of gen. partons, check if the intermediates are a Z or a W.</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordtype">int</span> diff1Id = jet1Id-injet1Id;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordtype">int</span> diff2Id = jet2Id-injet2Id;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      !( <span class="comment">// THIS IS A NOT-IF!</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      (diff1Id==0 &amp;&amp; diff2Id==0 &amp;&amp; !(injet1Id==21 || injet2Id==21)) <span class="comment">// Two Z bosons</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        ||</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        ((fabs(diff1Id)==1 || fabs(diff1Id)==3 || fabs(diff1Id)==5) &amp;&amp; (fabs(diff2Id)==1 || fabs(diff2Id)==3 || fabs(diff2Id)==5)) <span class="comment">// Two W bosons, do not check W+ vs W-</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        )</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      ){</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <span class="keywordtype">int</span> diff12Id = jet1Id-injet2Id;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <span class="keywordtype">int</span> diff21Id = jet2Id-injet1Id;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        ((diff12Id==0 || diff21Id==0) &amp;&amp; !(injet1Id==21 || injet2Id==21)) <span class="comment">// At least one Z boson</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        ||</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        ((fabs(diff12Id)==1 || fabs(diff12Id)==3 || fabs(diff12Id)==5) || (fabs(diff21Id)==1 || fabs(diff21Id)==3 || fabs(diff21Id)==5)) <span class="comment">// At least one W boson</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        ){</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        swap(P1, P2);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        swap(injet1Id, injet2Id);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  TLorentzRotation ZZframe;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  ZZframe.Boost(-pH.BoostVector());</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  P1.Transform(ZZframe);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  P2.Transform(ZZframe);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  p4Z1.Transform(ZZframe);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  p4Z2.Transform(ZZframe);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  jet1massless.Transform(ZZframe);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  jet2massless.Transform(ZZframe);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  TLorentzVector fermion1, fermion2, antifermion1, antifermion2;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="comment">// Consider cases with gen. partons</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="comment">// By default, fermion1/2 are jet1/2 unless incoming partons are specifically anti-quarks!</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="keywordflow">if</span> (injet1 &amp;&amp; injet1Id&lt;0){</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    fermion1=-P1;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    antifermion1 = jet1massless;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    fermion1 = jet1massless;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    antifermion1=-P1;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="keywordflow">if</span> (injet2 &amp;&amp; injet2Id&lt;0){</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    fermion2=-P2;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    antifermion2 = jet2massless;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    fermion2 = jet2massless;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    antifermion2=-P2;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="comment">// Computations in the frame of X</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  TLorentzVector V1 = fermion1 + antifermion1; <span class="comment">// Outgoing V1</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  TLorentzVector V2 = fermion2 + antifermion2; <span class="comment">// Outgoing V2</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  TVector3 normvec1 = fermion1.Vect().Cross(antifermion1.Vect()).Unit(); <span class="comment">// p11 x p12</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  TVector3 normvec2 = fermion2.Vect().Cross(antifermion2.Vect()).Unit(); <span class="comment">// p21 x p22</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  TVector3 normvec3 = p4Z2.Vect().Cross(V1.Vect()).Unit(); <span class="comment">// z x V1</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="keywordtype">double</span> cosPhi = normvec1.Dot(normvec2);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="keywordtype">double</span> sgnPhi = normvec1.Cross(normvec2).Dot(V1.Vect());</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keywordflow">if</span> (fabs(sgnPhi)&gt;0.) sgnPhi = sgnPhi/fabs(sgnPhi);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordtype">double</span> cosPhi1 = normvec1.Dot(normvec3);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordtype">double</span> sgnPhi1 = normvec1.Cross(normvec3).Dot(V1.Vect());</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keywordflow">if</span> (fabs(sgnPhi1)&gt;0.) sgnPhi1 = sgnPhi1/fabs(sgnPhi1);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="keywordflow">if</span> (fabs(cosPhi)&gt;1) cosPhi *= 1./fabs(cosPhi);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keywordflow">if</span> (fabs(cosPhi1)&gt;1) cosPhi1 *= 1./fabs(cosPhi1);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  Phi = acos(-cosPhi)*sgnPhi;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  Phi1 = acos(cosPhi1)*sgnPhi1;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  costhetastar = V1.Vect().Unit().Dot(p4Z2.Vect().Unit()); <span class="comment">// Note that p4Z2 is still in outgoing convention, so in incoming terms, this is equivalent to putting p4Z1.</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  Q2V1 = -(V1.M2());</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  Q2V2 = -(V2.M2());</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="comment">// Computations that would have been in the frame of X had V1 and V2 not been virtual</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  costheta1 = V1.Vect().Unit().Dot(fermion1.Vect().Unit());</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  costheta2 = V2.Vect().Unit().Dot(fermion2.Vect().Unit());</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;}</div>
<div class="line"><a name="l00730"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a9a0761a097eca0e6c200ad64ccfdf80f">  730</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a9a0761a097eca0e6c200ad64ccfdf80f">TUtil::computeVBFAngles_ComplexBoost</a>(</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordtype">float</span>&amp; costhetastar,</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordtype">float</span>&amp; costheta1_real, <span class="keywordtype">float</span>&amp; costheta1_imag,</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keywordtype">float</span>&amp; costheta2_real, <span class="keywordtype">float</span>&amp; costheta2_imag,</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keywordtype">float</span>&amp; Phi,</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keywordtype">float</span>&amp; Phi1,</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordtype">float</span>&amp; Q2V1,</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordtype">float</span>&amp; Q2V2,</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  TLorentzVector p4M11, <span class="keywordtype">int</span> Z1_lept1Id,</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  TLorentzVector p4M12, <span class="keywordtype">int</span> Z1_lept2Id,</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  TLorentzVector p4M21, <span class="keywordtype">int</span> Z2_lept1Id,</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  TLorentzVector p4M22, <span class="keywordtype">int</span> Z2_lept2Id,</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  TLorentzVector jet1, <span class="keywordtype">int</span> jet1Id,</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  TLorentzVector jet2, <span class="keywordtype">int</span> jet2Id,</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  TLorentzVector* injet1, <span class="keywordtype">int</span> injet1Id, <span class="comment">// Gen. partons in the lab frame</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  TLorentzVector* injet2, <span class="keywordtype">int</span> injet2Id</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  ){</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  TLorentzVector <span class="keyword">const</span> nullFourVector(0, 0, 0, 0);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  TLorentzVector jet1massless, jet2massless;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  pair&lt;TLorentzVector, TLorentzVector&gt; jetPair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(jet1, jet1Id, jet2, jet2Id);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  jet1massless = jetPair.first;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  jet2massless = jetPair.second;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="comment">//build Z 4-vectors</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  TLorentzVector p4Z1 = p4M11 + p4M12;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  TLorentzVector p4Z2 = p4M21 + p4M22;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  TLorentzVector pH = p4Z1+p4Z2;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="comment">//jet1 is defined as going forwards (bigger pz), jet2 going backwards (smaller pz)</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordflow">if</span> (jet1massless.Z() &lt; jet2massless.Z()) { swap(jet1massless, jet2massless); swap(jet1Id, jet2Id); }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <span class="comment">//Find the incoming partons - first boost so the pT(HJJ) = 0, then boost away the pz.</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <span class="comment">//This preserves the z direction.  Then assume that the partons come in this z direction.</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="comment">//This is exactly correct at LO (since pT=0 anyway).</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="comment">//Then associate the one going forwards with jet1 and the one going backwards with jet2</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  TLorentzRotation movingframe;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  TLorentzVector pHJJ = pH+jet1massless+jet2massless;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  TLorentzVector pHJJ_perp(pHJJ.X(), pHJJ.Y(), 0, pHJJ.T());</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  movingframe.Boost(-pHJJ_perp.BoostVector());</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  pHJJ.Boost(-pHJJ_perp.BoostVector());</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  movingframe.Boost(-pHJJ.BoostVector());</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  pHJJ.Boost(-pHJJ.BoostVector());   <span class="comment">//make sure to boost HJJ AFTER boosting movingframe</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  TLorentzVector P1(0, 0, pHJJ.T()/2, pHJJ.T()/2);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  TLorentzVector P2(0, 0, -pHJJ.T()/2, pHJJ.T()/2);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="comment">// Transform incoming partons back to original frame</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  P1.Transform(movingframe.Inverse());</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  P2.Transform(movingframe.Inverse());</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  pHJJ.Transform(movingframe.Inverse());</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="comment">// movingframe and HJJ_T will not be used anymore</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="comment">// Handle gen. partons if they are available</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="keywordflow">if</span> (injet1 &amp;&amp; injet2 &amp;&amp; fabs((*injet1+*injet2).P()-pHJJ.P())&lt;pHJJ.P()*1e-4){</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    P1=*injet1;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    P2=*injet2;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordflow">if</span> (P1.Z() &lt; P2.Z()){</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      swap(P1, P2);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      swap(injet1Id, injet2Id);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="comment">// In the case of gen. partons, check if the intermediates are a Z or a W.</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordtype">int</span> diff1Id = jet1Id-injet1Id;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordtype">int</span> diff2Id = jet2Id-injet2Id;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      !( <span class="comment">// THIS IS A NOT-IF!</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      (diff1Id==0 &amp;&amp; diff2Id==0 &amp;&amp; !(injet1Id==21 || injet2Id==21)) <span class="comment">// Two Z bosons</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        ||</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        ((fabs(diff1Id)==1 || fabs(diff1Id)==3 || fabs(diff1Id)==5) &amp;&amp; (fabs(diff2Id)==1 || fabs(diff2Id)==3 || fabs(diff2Id)==5)) <span class="comment">// Two W bosons, do not check W+ vs W-</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        )</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      ){</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="keywordtype">int</span> diff12Id = jet1Id-injet2Id;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="keywordtype">int</span> diff21Id = jet2Id-injet1Id;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        ((diff12Id==0 || diff21Id==0) &amp;&amp; !(injet1Id==21 || injet2Id==21)) <span class="comment">// At least one Z boson</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        ||</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        ((fabs(diff12Id)==1 || fabs(diff12Id)==3 || fabs(diff12Id)==5) || (fabs(diff21Id)==1 || fabs(diff21Id)==3 || fabs(diff21Id)==5)) <span class="comment">// At least one W boson</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        ){</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        swap(P1, P2);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        swap(injet1Id, injet2Id);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    }</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  TLorentzRotation ZZframe;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  ZZframe.Boost(-pH.BoostVector());</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  P1.Transform(ZZframe);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  P2.Transform(ZZframe);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  p4Z1.Transform(ZZframe);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  p4Z2.Transform(ZZframe);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  jet1massless.Transform(ZZframe);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  jet2massless.Transform(ZZframe);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  TLorentzVector fermion1, fermion2, antifermion1, antifermion2;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="comment">// Consider cases with gen. partons</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="comment">// By default, fermion1/2 are jet1/2 unless incoming partons are specifically anti-quarks!</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="keywordflow">if</span> (injet1 &amp;&amp; injet1Id&lt;0){</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    fermion1=-P1;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    antifermion1 = jet1massless;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    fermion1 = jet1massless;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    antifermion1=-P1;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  }</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="keywordflow">if</span> (injet2 &amp;&amp; injet2Id&lt;0){</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    fermion2=-P2;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    antifermion2 = jet2massless;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    fermion2 = jet2massless;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    antifermion2=-P2;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  }</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="comment">// Computations in the frame of X</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  TLorentzVector V1 = fermion1 + antifermion1; <span class="comment">// Outgoing V1</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  TLorentzVector V2 = fermion2 + antifermion2; <span class="comment">// Outgoing V2</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  TVector3 normvec1 = fermion1.Vect().Cross(antifermion1.Vect()).Unit(); <span class="comment">// p11 x p12</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  TVector3 normvec2 = fermion2.Vect().Cross(antifermion2.Vect()).Unit(); <span class="comment">// p21 x p22</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  TVector3 normvec3 = p4Z2.Vect().Cross(V1.Vect()).Unit(); <span class="comment">// z x V1</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="keywordtype">double</span> cosPhi = normvec1.Dot(normvec2);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="keywordtype">double</span> sgnPhi = normvec1.Cross(normvec2).Dot(V1.Vect());</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="keywordflow">if</span> (fabs(sgnPhi)&gt;0.) sgnPhi = sgnPhi/fabs(sgnPhi);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="keywordtype">double</span> cosPhi1 = normvec1.Dot(normvec3);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keywordtype">double</span> sgnPhi1 = normvec1.Cross(normvec3).Dot(V1.Vect());</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="keywordflow">if</span> (fabs(sgnPhi1)&gt;0.) sgnPhi1 = sgnPhi1/fabs(sgnPhi1);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="keywordflow">if</span> (fabs(cosPhi)&gt;1) cosPhi *= 1./fabs(cosPhi);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="keywordflow">if</span> (fabs(cosPhi1)&gt;1) cosPhi1 *= 1./fabs(cosPhi1);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  Phi = acos(-cosPhi)*sgnPhi;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  Phi1 = acos(cosPhi1)*sgnPhi1;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  costhetastar = V1.Vect().Unit().Dot(p4Z2.Vect().Unit()); <span class="comment">// Note that p4Z2 is still in outgoing convention, so in incoming terms, this is equivalent to putting p4Z1.</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  Q2V1 = -(V1.M2());</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  Q2V2 = -(V2.M2());</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="comment">// Up to here, everything has to be the same as TUtil::computeVBFAngles</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="comment">// Computations that would have been truly in the frame of X had V1 and V2 not been virtual:</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="comment">// Use TUtil::ComplexBoost to evade imaginary gamma problems when beta**2&lt;0</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  pair&lt;TLorentzVector, TLorentzVector&gt; V2_BV1 = <a class="code" href="namespaceTUtil.html#a30ecd7cb8ba8ecd70fc2f18c0d7d56ee">TUtil::ComplexBoost</a>(V1.BoostVector(), V2);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  pair&lt;TLorentzVector, TLorentzVector&gt; fermion1_BV1 = <a class="code" href="namespaceTUtil.html#a30ecd7cb8ba8ecd70fc2f18c0d7d56ee">TUtil::ComplexBoost</a>(V1.BoostVector(), fermion1);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  costheta1_real = -(V2_BV1.first.Vect().Unit().Dot(fermion1_BV1.first.Vect().Unit()) - V2_BV1.second.Vect().Unit().Dot(fermion1_BV1.second.Vect().Unit()));</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  costheta1_imag = -(V2_BV1.first.Vect().Unit().Dot(fermion1_BV1.second.Vect().Unit()) + V2_BV1.second.Vect().Unit().Dot(fermion1_BV1.first.Vect().Unit()));</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  pair&lt;TLorentzVector, TLorentzVector&gt; V1_BV2 = <a class="code" href="namespaceTUtil.html#a30ecd7cb8ba8ecd70fc2f18c0d7d56ee">TUtil::ComplexBoost</a>(V2.BoostVector(), V1);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  pair&lt;TLorentzVector, TLorentzVector&gt; fermion2_BV2 = <a class="code" href="namespaceTUtil.html#a30ecd7cb8ba8ecd70fc2f18c0d7d56ee">TUtil::ComplexBoost</a>(V2.BoostVector(), fermion2);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  costheta2_real = -(V1_BV2.first.Vect().Unit().Dot(fermion2_BV2.first.Vect().Unit()) - V1_BV2.second.Vect().Unit().Dot(fermion2_BV2.second.Vect().Unit()));</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  costheta2_imag = -(V1_BV2.first.Vect().Unit().Dot(fermion2_BV2.second.Vect().Unit()) + V1_BV2.second.Vect().Unit().Dot(fermion2_BV2.first.Vect().Unit()));</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;}</div>
<div class="line"><a name="l00873"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a928302e7a9815e5777eeea1fcd832a6e">  873</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a928302e7a9815e5777eeea1fcd832a6e">TUtil::computeVHAngles</a>(</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="keywordtype">float</span>&amp; costhetastar,</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="keywordtype">float</span>&amp; costheta1,</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keywordtype">float</span>&amp; costheta2,</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="keywordtype">float</span>&amp; Phi,</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="keywordtype">float</span>&amp; Phi1,</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="keywordtype">float</span>&amp; m1,</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keywordtype">float</span>&amp; m2,</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  TLorentzVector p4M11, <span class="keywordtype">int</span> Z1_lept1Id,</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  TLorentzVector p4M12, <span class="keywordtype">int</span> Z1_lept2Id,</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  TLorentzVector p4M21, <span class="keywordtype">int</span> Z2_lept1Id,</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  TLorentzVector p4M22, <span class="keywordtype">int</span> Z2_lept2Id,</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  TLorentzVector jet1, <span class="keywordtype">int</span> jet1Id,</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  TLorentzVector jet2, <span class="keywordtype">int</span> jet2Id,</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  TLorentzVector* injet1, <span class="keywordtype">int</span> injet1Id, <span class="comment">// Gen. partons in the lab frame</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  TLorentzVector* injet2, <span class="keywordtype">int</span> injet2Id</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  ){</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  TLorentzVector <span class="keyword">const</span> nullFourVector(0, 0, 0, 0);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  TLorentzVector jet1massless, jet2massless;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  pair&lt;TLorentzVector, TLorentzVector&gt; jetPair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(jet1, jet1Id, jet2, jet2Id);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  jet1massless = jetPair.first;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  jet2massless = jetPair.second;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="comment">// Build Z 4-vectors</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  TLorentzVector p4Z1 = p4M11 + p4M12;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  TLorentzVector p4Z2 = p4M21 + p4M22;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  TLorentzVector pH = p4Z1 + p4Z2;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="comment">// Apply convention for outgoing particles</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    (jet1Id*jet2Id&lt;0 &amp;&amp; jet1Id&lt;0) <span class="comment">// for OS pairs: jet1 must be the particle</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    ||</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    ((jet1Id*jet2Id&gt;0 || (jet1Id==0 &amp;&amp; jet2Id==0)) &amp;&amp; jet1massless.Phi()&lt;=jet2massless.Phi()) <span class="comment">// for SS pairs: use random deterministic convention</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    ){</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    swap(jet1massless, jet2massless);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    swap(jet1Id, jet2Id);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  }</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="comment">//Find the incoming partons - first boost so the pT(HJJ) = 0, then boost away the pz.</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="comment">//This preserves the z direction. </span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="comment">//Then, assume that the partons come in this z direction.</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">//This is exactly correct at LO (since pT=0 anyway).</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="comment">//Then associate the one going forwards with jet1 and the one going backwards with jet2</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  TLorentzRotation movingframe;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  TLorentzVector pHJJ = pH+jet1massless+jet2massless;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  TLorentzVector pHJJ_perp(pHJJ.X(), pHJJ.Y(), 0, pHJJ.T());</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  movingframe.Boost(-pHJJ_perp.BoostVector());</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  pHJJ.Boost(-pHJJ_perp.BoostVector());</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  movingframe.Boost(-pHJJ.BoostVector());</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  pHJJ.Boost(-pHJJ.BoostVector());   <span class="comment">//make sure to boost HJJ AFTER boosting movingframe</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  TLorentzVector P1(0, 0, -pHJJ.T()/2, pHJJ.T()/2);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  TLorentzVector P2(0, 0, pHJJ.T()/2, pHJJ.T()/2);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="comment">// Transform incoming partons back to the original frame</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  P1.Transform(movingframe.Inverse());</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  P2.Transform(movingframe.Inverse());</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  pHJJ.Transform(movingframe.Inverse());</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="comment">// movingframe and HJJ_T will not be used anymore</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <span class="comment">// Handle gen. partons if they are available</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="keywordflow">if</span> (injet1 &amp;&amp; injet2 &amp;&amp; fabs((*injet1+*injet2).P()-pHJJ.P())&lt;pHJJ.P()*1e-4){</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    P1=*injet1;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    P2=*injet2;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="comment">// Apply convention for incoming (!) particles</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      (injet1Id*injet2Id&lt;0 &amp;&amp; injet1Id&gt;0) <span class="comment">// for OS pairs: parton 2 must be the particle</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      ||</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      (injet1Id*injet2Id&gt;0 &amp;&amp; P1.Z()&gt;=P2.Z()) <span class="comment">//for SS pairs: use random deterministic convention</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      ){</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      swap(P1, P2);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      swap(injet1Id, injet2Id);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="comment">// Rotate every vector such that Z1 - Z2 axis is the &quot;beam axis&quot; analogue of decay</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  TLorentzRotation ZZframe;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  TVector3 <span class="keyword">const</span> beamAxis(0, 0, 1);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="keywordflow">if</span> (p4Z1==nullFourVector || p4Z2==nullFourVector){</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    TVector3 pNewAxis = (p4Z2-p4Z1).Vect().Unit(); <span class="comment">// Let Z2 be in the z direction so that once the direction of H is reversed, Z1 is in the z direction</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordflow">if</span> (pNewAxis != nullFourVector.Vect()){</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      TVector3 pNewAxisPerp = pNewAxis.Cross(beamAxis);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      ZZframe.Rotate(acos(pNewAxis.Dot(beamAxis)), pNewAxisPerp);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      P1.Transform(ZZframe);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      P2.Transform(ZZframe);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      jet1massless = -jet1massless; jet1massless.Transform(ZZframe); jet1massless = -jet1massless;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      jet2massless = -jet2massless; jet2massless.Transform(ZZframe); jet2massless = -jet2massless;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  }</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    ZZframe.Boost(-pH.BoostVector());</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    p4Z1.Boost(-pH.BoostVector());</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    p4Z2.Boost(-pH.BoostVector());</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    TVector3 pNewAxis = (p4Z2-p4Z1).Vect().Unit(); <span class="comment">// Let Z2 be in the z direction so that once the direction of H is reversed, Z1 is in the z direction</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    TVector3 pNewAxisPerp = pNewAxis.Cross(beamAxis);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    ZZframe.Rotate(acos(pNewAxis.Dot(beamAxis)), pNewAxisPerp);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    P1.Transform(ZZframe);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    P2.Transform(ZZframe);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    jet1massless = -jet1massless; jet1massless.Transform(ZZframe); jet1massless = -jet1massless;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    jet2massless = -jet2massless; jet2massless.Transform(ZZframe); jet2massless = -jet2massless;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  }</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <a class="code" href="namespaceTUtil.html#afa81b178917557f2d5440957bbf5f08b">TUtil::computeAngles</a>(</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    costhetastar,</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    costheta1,</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    costheta2,</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    Phi,</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    Phi1,</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    -P1, 23, <span class="comment">// Id is 23 to avoid an attempt to remove quark mass</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    -P2, 0, <span class="comment">// Id is 0 to avoid swapping</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    jet1massless, 23,</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    jet2massless, 0</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  );</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  m1 = (P1 + P2).M();</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  m2 = (jet1massless + jet2massless).M();</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;}</div>
<div class="line"><a name="l00989"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a8f220424c5f98ce6e208bb834ecd55a6">  989</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a8f220424c5f98ce6e208bb834ecd55a6">TUtil::computeTTHAngles</a>(</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="comment">// ttH system</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordtype">float</span>&amp; hs,</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="keywordtype">float</span>&amp; hincoming,</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <span class="keywordtype">float</span>&amp; hTT,</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <span class="keywordtype">float</span>&amp; PhiTT,</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="keywordtype">float</span>&amp; Phi1,</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="comment">// tt system</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="keywordtype">float</span>&amp; hbb,</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="keywordtype">float</span>&amp; hWW,</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <span class="keywordtype">float</span>&amp; Phibb,</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="keywordtype">float</span>&amp; Phi1bb,</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="comment">// Wplus system</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="keywordtype">float</span>&amp; hWplusf,</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="keywordtype">float</span>&amp; PhiWplusf,</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <span class="comment">// Wminus system</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <span class="keywordtype">float</span>&amp; hWminusf,</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="keywordtype">float</span>&amp; PhiWminusf,</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  TLorentzVector p4M11, <span class="keywordtype">int</span> Z1_lept1Id,</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  TLorentzVector p4M12, <span class="keywordtype">int</span> Z1_lept2Id,</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  TLorentzVector p4M21, <span class="keywordtype">int</span> Z2_lept1Id,</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  TLorentzVector p4M22, <span class="keywordtype">int</span> Z2_lept2Id,</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  TLorentzVector b, <span class="keywordtype">int</span> bId,</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  TLorentzVector Wplusf, <span class="keywordtype">int</span> WplusfId,</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  TLorentzVector Wplusfb, <span class="keywordtype">int</span> WplusfbId,</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  TLorentzVector bbar, <span class="keywordtype">int</span> bbarId,</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  TLorentzVector Wminusf, <span class="keywordtype">int</span> WminusfId,</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  TLorentzVector Wminusfb, <span class="keywordtype">int</span> WminusfbId,</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  TLorentzVector* injet1, <span class="keywordtype">int</span> injet1Id, <span class="comment">// Gen. partons in the lab frame</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  TLorentzVector* injet2, <span class="keywordtype">int</span> injet2Id</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;){</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  TLorentzVector <span class="keyword">const</span> nullFourVector(0, 0, 0, 0);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  TVector3 <span class="keyword">const</span> beamAxis(0, 0, 1);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  TVector3 <span class="keyword">const</span> xAxis(1, 0, 0);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="comment">// Initialize output values</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  hs=hincoming=hTT=PhiTT=Phi1</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    =hbb=hWW=Phibb=Phi1bb</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    =hWplusf=PhiWplusf</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    =hWminusf=PhiWminusf=0;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    bId!=-9000 &amp;&amp; !(<a class="code" href="namespacePDGHelpers.html#ab98f91f00daa234b2d34eaec820cf49f">PDGHelpers::isATopQuark</a>(bId) || <a class="code" href="namespacePDGHelpers.html#a794b5a5be20c1b6004500abb9938deec">PDGHelpers::isATauLepton</a>(bId)) &amp;&amp; WplusfId==-9000 &amp;&amp; WplusfbId==-9000</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    bbarId!=-9000 &amp;&amp; !(<a class="code" href="namespacePDGHelpers.html#ab98f91f00daa234b2d34eaec820cf49f">PDGHelpers::isATopQuark</a>(bbarId) || <a class="code" href="namespacePDGHelpers.html#a794b5a5be20c1b6004500abb9938deec">PDGHelpers::isATauLepton</a>(bbarId)) &amp;&amp; WminusfId==-9000 &amp;&amp; WminusfbId==-9000</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    ){</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="keywordtype">float</span> m1_dummy=0, m2_dummy=0;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceTUtil.html#a928302e7a9815e5777eeea1fcd832a6e">TUtil::computeVHAngles</a>(</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      hs, hincoming, hTT, PhiTT, Phi1,</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      m1_dummy, m2_dummy,</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      p4M11, Z1_lept1Id,</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      p4M12, Z1_lept2Id,</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      p4M21, Z2_lept1Id,</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      p4M22, Z2_lept2Id,</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      b, bId,</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      bbar, bbarId,</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      injet1, injet1Id,</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      injet2, injet2Id</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    );</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  }</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="comment">// Swap Wplus daughters if needed</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    WplusfId!=-9000 &amp;&amp; WplusfbId!=-9000</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    (</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    (WplusfId*WplusfbId&lt;0 &amp;&amp; WplusfId&lt;0) <span class="comment">// for OS pairs: Wplusf must be the particle</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      ||</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      ((WplusfId*WplusfbId&gt;0 || (WplusfId==0 &amp;&amp; WplusfbId==0)) &amp;&amp; Wplusf.Phi()&lt;=Wplusfb.Phi()) <span class="comment">// for SS pairs: use random deterministic convention</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      )</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    ){</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    swap(Wplusf, Wplusfb);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    swap(WplusfId, WplusfbId);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="comment">// Swap Wminus daughters if needed</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    WminusfId!=-9000 &amp;&amp; WminusfbId!=-9000</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    (</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    (WminusfId*WminusfbId&lt;0 &amp;&amp; WminusfId&lt;0) <span class="comment">// for OS pairs: Wminusf must be the particle</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      ||</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      ((WminusfId*WminusfbId&gt;0 || (WminusfId==0 &amp;&amp; WminusfbId==0)) &amp;&amp; Wminusf.Phi()&lt;=Wminusfb.Phi()) <span class="comment">// for SS pairs: use random deterministic convention</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      )</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    ){</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    swap(Wminusf, Wminusfb);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    swap(WminusfId, WminusfbId);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  }</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="comment">// Correct the T daughters</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <span class="keywordflow">if</span> (bId!=-9000 &amp;&amp; WplusfId!=-9000 &amp;&amp; WplusfbId!=-9000){</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> tmp_daus;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    tmp_daus.reserve(3);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    tmp_daus.emplace_back(bId, b);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    tmp_daus.emplace_back(WplusfId, Wplusf);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    tmp_daus.emplace_back(WplusfbId, Wplusfb);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <a class="code" href="namespaceTUtil.html#a22ae65dea83b7d412dd94f09ac3b7de7">TUtil::adjustTopDaughters</a>(tmp_daus);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    b = tmp_daus.at(0).second;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    Wplusf = tmp_daus.at(1).second;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    Wplusfb = tmp_daus.at(2).second;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (WplusfId!=-9000 &amp;&amp; WplusfbId!=-9000){</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    pair&lt;TLorentzVector, TLorentzVector&gt; Wffb = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(Wplusf, WplusfId, Wplusfb, WplusfbId);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    Wplusf = Wffb.first;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    Wplusfb = Wffb.second;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="comment">// Correct the TBar daughters</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="keywordflow">if</span> (bbarId!=-9000 &amp;&amp; WminusfId!=-9000 &amp;&amp; WminusfbId!=-9000){</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> tmp_daus;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    tmp_daus.reserve(3);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    tmp_daus.emplace_back(bbarId, bbar);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    tmp_daus.emplace_back(WminusfId, Wminusf);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    tmp_daus.emplace_back(WminusfbId, Wminusfb);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <a class="code" href="namespaceTUtil.html#a22ae65dea83b7d412dd94f09ac3b7de7">TUtil::adjustTopDaughters</a>(tmp_daus);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    bbar = tmp_daus.at(0).second;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    Wminusf = tmp_daus.at(1).second;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    Wminusfb = tmp_daus.at(2).second;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  }</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (WminusfId!=-9000 &amp;&amp; WminusfbId!=-9000){</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    pair&lt;TLorentzVector, TLorentzVector&gt; Wffb = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(Wminusf, WminusfId, Wminusfb, WminusfbId);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    Wminusf = Wffb.first;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    Wminusfb = Wffb.second;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  }</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="comment">// If the Ws are not present but the bs are, the masses of the bs should not be removed. This is because the bs are now either tops or taus (based on the similar if-statement above).</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <span class="comment">// Build Z 4-vectors</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  TLorentzVector p4Z1 = p4M11 + p4M12;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  TLorentzVector p4Z2 = p4M21 + p4M22;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  <span class="comment">// No longer need to use p4Mxy</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  TLorentzVector pH = p4Z1 + p4Z2;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  TLorentzVector pWplus = Wplusf + Wplusfb;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  TLorentzVector pTop = b + pWplus;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; </div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  TLorentzVector pWminus = Wminusf + Wminusfb;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  TLorentzVector pATop = bbar + pWminus;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160; </div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  TLorentzVector pTT = pTop + pATop;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  TLorentzVector pTTH = pTT + pH;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="comment">//Find the incoming partons - first boost so the pT(TTH) = 0, then boost away the pz.</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="comment">//This preserves the z direction. </span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="comment">//Then, assume that the partons come in this z direction.</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="comment">//This is exactly correct at LO (since pT=0 anyway).</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <span class="comment">//Then associate the one going forwards with jet1 and the one going backwards with jet2</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  TLorentzRotation movingframe;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  TLorentzVector pTTH_perp(pTTH.X(), pTTH.Y(), 0, pTTH.T());</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  movingframe.Boost(-pTTH_perp.BoostVector());</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  pTTH.Boost(-pTTH_perp.BoostVector());</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  movingframe.Boost(-pTTH.BoostVector());</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  pTTH.Boost(-pTTH.BoostVector());   <span class="comment">//make sure to boost TTH AFTER boosting movingframe</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160; </div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  TLorentzVector P1(0, 0, -pTTH.T()/2, pTTH.T()/2);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  TLorentzVector P2(0, 0, pTTH.T()/2, pTTH.T()/2);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <span class="comment">// Transform incoming partons back to the original frame</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  P1.Transform(movingframe.Inverse());</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  P2.Transform(movingframe.Inverse());</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  pTTH.Transform(movingframe.Inverse());</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="comment">// movingframe and TTH_T will not be used anymore</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="comment">// Handle gen. partons if they are available</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <span class="keywordflow">if</span> (injet1 &amp;&amp; injet2 &amp;&amp; fabs((*injet1+*injet2).P()-pTTH.P())&lt;pTTH.P()*1e-4){</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    P1=*injet1;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    P2=*injet2;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="comment">// Apply convention for incoming (!) particles</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      (injet1Id*injet2Id&lt;0 &amp;&amp; injet1Id&gt;0) <span class="comment">// for OS pairs: parton 2 must be the particle</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      ||</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      (injet1Id*injet2Id&gt;0 &amp;&amp; P1.Z()&gt;=P2.Z()) <span class="comment">//for SS pairs: parton 2 must have the greater pz</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      ){</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      swap(P1, P2);</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      swap(injet1Id, injet2Id);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    }</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  }</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="comment">// Rotate every vector such that Z1 - Z2 axis is the &quot;beam axis&quot; analogue of decay</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  TLorentzRotation ZZframe;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="keywordtype">bool</span> applyZZframe=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="keywordflow">if</span> (p4Z1==nullFourVector || p4Z2==nullFourVector){ <span class="comment">// Higgs is undecayed</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    TVector3 pNewAxis = (p4Z2-p4Z1).Vect().Unit(); <span class="comment">// Let Z2 be in the z direction so that once the direction of H is reversed, Z1 is in the z direction</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordflow">if</span> (pNewAxis != nullFourVector.Vect()){</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      TVector3 pNewAxisPerp = pNewAxis.Cross(beamAxis);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      ZZframe.Rotate(acos(pNewAxis.Dot(beamAxis)), pNewAxisPerp);</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      applyZZframe=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    }</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  }</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    TVector3 pHboost = pH.BoostVector();</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    ZZframe.Boost(-pHboost);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    p4Z1.Boost(-pHboost);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    p4Z2.Boost(-pHboost);</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    TVector3 pNewAxis = (p4Z2-p4Z1).Vect().Unit(); <span class="comment">// Let Z2 be in the z direction so that once the direction of H is reversed, Z1 is in the z direction</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    TVector3 pNewAxisPerp = pNewAxis.Cross(beamAxis);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    ZZframe.Rotate(acos(pNewAxis.Dot(beamAxis)), pNewAxisPerp);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="comment">// Boost p4Z1 and p4Z2 back so that you can apply the transformation separately</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    p4Z1.Boost(pHboost);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    p4Z2.Boost(pHboost);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    applyZZframe=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  }</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keywordflow">if</span> (applyZZframe){</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    P1.Transform(ZZframe); P2.Transform(ZZframe);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    p4Z1 = -p4Z1; p4Z1.Transform(ZZframe); p4Z1 = -p4Z1;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    p4Z2 = -p4Z2; p4Z2.Transform(ZZframe); p4Z2 = -p4Z2;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    b = -b; b.Transform(ZZframe); b = -b;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    Wplusf = -Wplusf; Wplusf.Transform(ZZframe); Wplusf = -Wplusf;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    Wplusfb = -Wplusfb; Wplusfb.Transform(ZZframe); Wplusfb = -Wplusfb;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    bbar = -bbar; bbar.Transform(ZZframe); bbar = -bbar;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    Wminusf = -Wminusf; Wminusf.Transform(ZZframe); Wminusf = -Wminusf;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    Wminusfb = -Wminusfb; Wminusfb.Transform(ZZframe); Wminusfb = -Wminusfb;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  }</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="comment">// Re-assign derived momenta</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  pH = p4Z1 + p4Z2;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  pWplus = Wplusf + Wplusfb;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  pTop = b + pWplus;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  pWminus = Wminusf + Wminusfb;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  pATop = bbar + pWminus;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  pTT = pTop + pATop;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  pTTH = pTT + pH;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  <a class="code" href="namespaceTUtil.html#afa81b178917557f2d5440957bbf5f08b">TUtil::computeAngles</a>(</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    hs,</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    hincoming,</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    hTT,</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    PhiTT,</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    Phi1,</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    -P1, 23, <span class="comment">// Id is 23 to avoid an attempt to remove quark mass</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    -P2, 0, <span class="comment">// Id is 0 to avoid swapping</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    pTop, 23,</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    pATop, 0</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  );</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160; </div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  <span class="comment">// Boost everything to Higgs frame AFTER ttH-frame angle computations</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="comment">// This is to avoid an undetermined z axis in the above angles when Higgs is undecayed</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  {</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    TVector3 pHboost = pH.BoostVector();</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160; </div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    P1.Boost(-pHboost);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    P2.Boost(-pHboost);</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="comment">// No need for Z1 and Z2</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="comment">//p4Z1.Boost(-pHboost);</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="comment">//p4Z2.Boost(-pHboost);</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    b.Boost(-pHboost);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    Wplusf.Boost(-pHboost);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    Wplusfb.Boost(-pHboost);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    bbar.Boost(-pHboost);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    Wminusf.Boost(-pHboost);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    Wminusfb.Boost(-pHboost);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="comment">// Re-assign derived momenta</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="comment">// No need for the Higgs in Higgs frame</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="comment">//pH = p4Z1 + p4Z2;</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    pWplus = Wplusf + Wplusfb;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    pTop = b + pWplus;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    pWminus = Wminusf + Wminusfb;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    pATop = bbar + pWminus;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    pTT = pTop + pATop;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="comment">// No need for the TTH system in Higgs frame</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="comment">//pTTH = pTT + pH;</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  }</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160; </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    TLorentzRotation TTframe;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160; </div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="comment">// z rotation</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    TVector3 nNewZAxis = (-P1-P2-pTop-pATop).Vect().Unit(); <span class="comment">// Let the z axis be formed by the (-P1-P2)--TT axis in the Higgs frame</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="keywordflow">if</span> (nNewZAxis != nullFourVector.Vect()){</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      TVector3 nNewZAxisPerp = nNewZAxis.Cross(beamAxis);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      TTframe.Rotate(acos(nNewZAxis.Dot(beamAxis)), nNewZAxisPerp);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    }</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    P1.Transform(TTframe);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    P2.Transform(TTframe);</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    b.Transform(TTframe);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    Wplusf.Transform(TTframe);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    Wplusfb.Transform(TTframe);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    bbar.Transform(TTframe);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    Wminusf.Transform(TTframe);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    Wminusfb.Transform(TTframe);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="comment">// Re-assign derived momenta</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    pWplus = Wplusf + Wplusfb;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    pTop = b + pWplus;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    pWminus = Wminusf + Wminusfb;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    pATop = bbar + pWminus;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160; </div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <span class="comment">// Compute TT angles</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="keywordtype">float</span> hs_dummy;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordtype">int</span> id_dummy_Wplus=24;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="keywordtype">int</span> id_dummy_Wminus=-24;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="keywordflow">if</span> (WplusfId!=-9000 &amp;&amp; WplusfbId!=-9000) id_dummy_Wplus=-9000;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keywordflow">if</span> (WminusfId!=-9000 &amp;&amp; WminusfbId!=-9000) id_dummy_Wminus=-9000;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <a class="code" href="namespaceTUtil.html#afa81b178917557f2d5440957bbf5f08b">TUtil::computeAngles</a>(</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      hs_dummy,</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      hbb,</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      hWW,</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      Phibb, <span class="comment">// -\Phi_b from arxiv:1606.03107</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      Phi1bb, <span class="comment">// This angle is the one between the bb plane and the TT-H plane instead of that between the WW plane and the TT-H plane as defined in arxiv:1606.03107.</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      b, bId,</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      bbar, bbarId,</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      pWplus, id_dummy_Wplus,</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      pWminus, id_dummy_Wminus</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    );</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  }</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="comment">// Wplus frame</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <span class="keywordflow">if</span> (WplusfId!=-9000 &amp;&amp; WplusfbId!=-9000){</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    TLorentzVector pATop_tmp = pATop;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    TVector3 pWplus_boost = (Wplusf+Wplusfb).BoostVector();</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    b.Boost(-pWplus_boost);</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    Wplusf.Boost(-pWplus_boost);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    Wplusfb.Boost(-pWplus_boost);</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    pATop_tmp.Boost(-pWplus_boost);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    TLorentzRotation Wplusframe;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160; </div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="comment">// z rotation</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    TVector3 nNewZAxis = (b+Wplusf+Wplusfb-pATop_tmp).Vect().Unit(); <span class="comment">// Let the z axis be formed by the TBar direction</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordflow">if</span> (nNewZAxis != nullFourVector.Vect()){</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      TVector3 nNewZAxisPerp = nNewZAxis.Cross(beamAxis);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      Wplusframe.Rotate(acos(nNewZAxis.Dot(beamAxis)), nNewZAxisPerp);</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    }</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    b.Transform(Wplusframe);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    Wplusf.Transform(Wplusframe);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    Wplusfb.Transform(Wplusframe);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    TVector3 n3_Wb = -b.Vect().Unit();</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    TVector3 nW = ((Wplusf-Wplusfb).Vect().Cross(n3_Wb)).Unit();</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    TVector3 nS = (beamAxis.Cross(n3_Wb)).Unit();</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160; </div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="comment">// hWplusf</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    hWplusf = n3_Wb.Dot(Wplusf.Vect().Unit());</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="comment">// PhiWplusf</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordtype">float</span> tmpSgnPhiWplusf = n3_Wb.Dot(nW.Cross(nS));</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keywordtype">float</span> sgnPhiWplusf = 0;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="keywordflow">if</span> (fabs(tmpSgnPhiWplusf)&gt;0.) sgnPhiWplusf = tmpSgnPhiWplusf/fabs(tmpSgnPhiWplusf);</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordtype">float</span> dot_nWnS = nW.Dot(nS);</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="keywordflow">if</span> (fabs(dot_nWnS)&gt;=1.) dot_nWnS *= 1./fabs(dot_nWnS);</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    PhiWplusf = sgnPhiWplusf * acos(dot_nWnS);</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment">    b.Transform(Wplusframe.Inverse());</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">    Wplusf.Transform(Wplusframe.Inverse());</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment">    Wplusfb.Transform(Wplusframe.Inverse());</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  }</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  <span class="comment">// Wminus frame</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <span class="keywordflow">if</span> (WminusfId!=-9000 &amp;&amp; WminusfbId!=-9000){</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    TLorentzVector pTop_tmp = pTop;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    TVector3 pWminus_boost = (Wminusf+Wminusfb).BoostVector();</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    bbar.Boost(-pWminus_boost);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    Wminusf.Boost(-pWminus_boost);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    Wminusfb.Boost(-pWminus_boost);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    pTop_tmp.Boost(-pWminus_boost);</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160; </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    TLorentzRotation Wminusframe;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160; </div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="comment">// z rotation</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    TVector3 nNewZAxis = (pTop_tmp-bbar-Wminusf-Wminusfb).Vect().Unit(); <span class="comment">// Let the z axis be formed by the T direction</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="keywordflow">if</span> (nNewZAxis != nullFourVector.Vect()){</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      TVector3 nNewZAxisPerp = nNewZAxis.Cross(beamAxis);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      Wminusframe.Rotate(acos(nNewZAxis.Dot(beamAxis)), nNewZAxisPerp);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    }</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    bbar.Transform(Wminusframe);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    Wminusf.Transform(Wminusframe);</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    Wminusfb.Transform(Wminusframe);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160; </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    TVector3 n3_Wb = -bbar.Vect().Unit();</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    TVector3 nW = ((Wminusf-Wminusfb).Vect().Cross(n3_Wb)).Unit();</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    TVector3 nS = (beamAxis.Cross(n3_Wb)).Unit();</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160; </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="comment">// hWminusf</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    hWminusf = n3_Wb.Dot(Wminusf.Vect().Unit());</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="comment">// PhiWminusf</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <span class="keywordtype">float</span> tmpSgnPhiWminusf = n3_Wb.Dot(nW.Cross(nS));</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="keywordtype">float</span> sgnPhiWminusf = 0;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="keywordflow">if</span> (fabs(tmpSgnPhiWminusf)&gt;0.) sgnPhiWminusf = tmpSgnPhiWminusf/fabs(tmpSgnPhiWminusf);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="keywordtype">float</span> dot_nWnS = nW.Dot(nS);</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keywordflow">if</span> (fabs(dot_nWnS)&gt;=1.) dot_nWnS *= 1./fabs(dot_nWnS);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    PhiWminusf = sgnPhiWminusf * acos(dot_nWnS);</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment">    bbar.Transform(Wminusframe.Inverse());</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">    Wminusf.Transform(Wminusframe.Inverse());</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">    Wminusfb.Transform(Wminusframe.Inverse());</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  }</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;}</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160; </div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment">/****************************************************/</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">/***** JHUGen- and MCFM-related ME computations *****/</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">/****************************************************/</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160; </div>
<div class="line"><a name="l01386"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#ab719f9b19416aa6c8df52515ac6a6db4"> 1386</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#ab719f9b19416aa6c8df52515ac6a6db4">TUtil::SetEwkCouplingParameters</a>(<span class="keywordtype">double</span> ext_Gf, <span class="keywordtype">double</span> ext_aemmz, <span class="keywordtype">double</span> ext_mW, <span class="keywordtype">double</span> ext_mZ, <span class="keywordtype">double</span> ext_xW, <span class="keywordtype">int</span> ext_ewscheme){</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  <span class="comment">// Set JHUGen couplings</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> GeV=1./100.;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  <span class="keywordtype">double</span> ext_mZ_jhu = ext_mZ*GeV;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <span class="keywordtype">double</span> ext_mW_jhu = ext_mW*GeV;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <span class="keywordtype">double</span> ext_Gf_jhu = ext_Gf/pow(GeV, 2);</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <a class="code" href="TModJHUGenMELA_8hh.html#a13ab47e1feba00f34a37fe3ffbd6e081">__modjhugenmela_MOD_setewparameters</a>(&amp;ext_mZ_jhu, &amp;ext_mW_jhu, &amp;ext_Gf_jhu, &amp;ext_aemmz, &amp;ext_xW);</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160; </div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  <span class="comment">// Set MCFM couplings</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  <span class="keywordflow">if</span> (ext_ewscheme&lt;-1 || ext_ewscheme&gt;3) ext_ewscheme=3;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  <a class="code" href="TMCFM_8hh.html#aac90f56581663b0c22980394abd0ad11">ewinput_</a>.Gf_inp = ext_Gf;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  <a class="code" href="TMCFM_8hh.html#aac90f56581663b0c22980394abd0ad11">ewinput_</a>.aemmz_inp = ext_aemmz;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <a class="code" href="TMCFM_8hh.html#aac90f56581663b0c22980394abd0ad11">ewinput_</a>.wmass_inp = ext_mW;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  <a class="code" href="TMCFM_8hh.html#aac90f56581663b0c22980394abd0ad11">ewinput_</a>.zmass_inp = ext_mZ;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  <a class="code" href="TMCFM_8hh.html#aac90f56581663b0c22980394abd0ad11">ewinput_</a>.xw_inp = ext_xW;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <a class="code" href="TMCFM_8hh.html#a7d1fa9afb94e77cd82a7edd6d02abcd4">ewscheme_</a>.ewscheme = ext_ewscheme;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <a class="code" href="TMCFM_8hh.html#aac5f9447172754e1d437b7b004e0ccbf">coupling_</a>();</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160; </div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <span class="comment">// SETTINGS TO MATCH JHUGen ME/generator:</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="comment">  ewscheme_.ewscheme = 3; // Switch ewscheme to full control, default is 1</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment">  ewinput_.Gf_inp=1.16639E-05;</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="comment">  ewinput_.aemmz_inp=1./128.;</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment">  ewinput_.wmass_inp=80.399;</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="comment">  ewinput_.zmass_inp=91.1876;</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="comment">  ewinput_.xw_inp=0.23119;</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  <span class="comment">// Settings used in Run I MC, un-synchronized to JHUGen and Run II generation</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment">  ewinput_.Gf_inp = 1.16639E-05;</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment">  ewinput_.wmass_inp = 80.385;</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">  ewinput_.zmass_inp = 91.1876;</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment">  //ewinput_.aemmz_inp = 7.81751e-3; // Not used in the compiled new default MCFM ewcheme=1</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">  //ewinput_.xw_inp = 0.23116864; // Not used in the compiled new default MCFM ewcheme=1</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment">  ewinput_.aemmz_inp = 7.562468901984759e-3;</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment">  ewinput_.xw_inp = 0.2228972225239183;</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  <span class="comment">// INPUT SETTINGS in default MCFM generator:</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="comment">  ewscheme_.ewscheme = 1;</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="comment">  ewinput_.Gf_inp=1.16639E-05;</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="comment">  ewinput_.wmass_inp=80.398;</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="comment">  ewinput_.zmass_inp=91.1876;</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="comment">  ewinput_.aemmz_inp=7.7585538055706e-3;</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="comment">  ewinput_.xw_inp=0.2312;</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160; </div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="comment">// ACTUAL SETTINGS in default MCFM generator, gives the same values as above but is more explicit</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">  ewscheme_.ewscheme = 3;</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="comment">  ewinput_.Gf_inp=1.16639E-05;</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment">  ewinput_.wmass_inp=80.398;</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">  ewinput_.zmass_inp=91.1876;</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">  ewinput_.aemmz_inp=7.55638390728736e-3;</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">  ewinput_.xw_inp=0.22264585341299625;</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;}</div>
<div class="line"><a name="l01445"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a51c225f177937798f635f16e7999af99"> 1445</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a51c225f177937798f635f16e7999af99">TUtil::SetMass</a>(<span class="keywordtype">double</span> inmass, <span class="keywordtype">int</span> ipart){</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> ipartabs = abs(ipart);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <span class="keywordtype">bool</span> runcoupling_mcfm=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <span class="keywordtype">bool</span> runcoupling_jhugen=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160; </div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  <span class="comment">// MCFM masses</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  <span class="comment">// Tprime and bprime masses are not defined in masses.f</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <span class="keywordflow">if</span> (ipartabs==8) <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.mt_4gen = inmass;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==7) <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.mb_4gen = inmass;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==6){ <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mt=inmass; runcoupling_mcfm=<span class="keyword">true</span>; }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==5){ <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mb=inmass; <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mbsq = pow(<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mb, 2); runcoupling_mcfm=<span class="keyword">true</span>; }</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==4){ <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mc=inmass; <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mcsq = pow(<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mc, 2); runcoupling_mcfm=<span class="keyword">true</span>; }</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==3) <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.ms=inmass;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==2) <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mu=inmass;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==1) <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.md=inmass;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==11) <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mel=inmass;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==13) <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mmu=inmass;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==15){ <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mtau=inmass; <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mtausq = pow(<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mtau, 2); }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==23){ <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zmass=inmass; <a class="code" href="TMCFM_8hh.html#aac90f56581663b0c22980394abd0ad11">ewinput_</a>.zmass_inp = inmass; runcoupling_mcfm=<span class="keyword">true</span>; }</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==24){ <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wmass=inmass; <a class="code" href="TMCFM_8hh.html#aac90f56581663b0c22980394abd0ad11">ewinput_</a>.wmass_inp = inmass; runcoupling_mcfm=<span class="keyword">true</span>; }</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==25) <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hmass=inmass;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160; </div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  <span class="comment">// JHUGen masses</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    ipartabs&lt;=6</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    ||</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    (ipartabs&gt;=11 &amp;&amp; ipartabs&lt;=16)</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    ||</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    ipartabs==23 || ipartabs==24 || ipartabs==25</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    ||</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    ipartabs==32 || ipartabs==34</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    ){</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    runcoupling_jhugen=(</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      ipartabs==23</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;      ||</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;      ipartabs==24</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;      );</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> GeV=1./100.;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keywordtype">double</span> jinmass = inmass*GeV;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordtype">int</span> jpart = <a class="code" href="TModParameters_8hh.html#a00e07c5a686985e7a030b7349d0f4998">convertLHEreverse</a>(&amp;ipart);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <a class="code" href="TModParameters_8hh.html#a1cad26d34fd7583002925e2456af0380">__modparameters_MOD_setmass</a>(&amp;jinmass, &amp;jpart);</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  }</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160; </div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  <span class="comment">// Recalculate couplings</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <span class="keywordflow">if</span> (runcoupling_mcfm || runcoupling_jhugen) <a class="code" href="namespaceTUtil.html#ab719f9b19416aa6c8df52515ac6a6db4">SetEwkCouplingParameters</a>(<a class="code" href="TMCFM_8hh.html#ac7e93fc031845d323db73d275dee5d58">ewcouple_</a>.Gf, <a class="code" href="TMCFM_8hh.html#aa296823e617af50b03e6df133187896c">em_</a>.aemmz, <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wmass, <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zmass, <a class="code" href="TMCFM_8hh.html#ac7e93fc031845d323db73d275dee5d58">ewcouple_</a>.xw, <a class="code" href="TMCFM_8hh.html#a7d1fa9afb94e77cd82a7edd6d02abcd4">ewscheme_</a>.ewscheme);</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;}</div>
<div class="line"><a name="l01491"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#af2f4d9e772c5b03b8554ecbd6778f623"> 1491</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#af2f4d9e772c5b03b8554ecbd6778f623">TUtil::SetDecayWidth</a>(<span class="keywordtype">double</span> inwidth, <span class="keywordtype">int</span> ipart){</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> ipartabs = abs(ipart);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  <span class="comment">// No need to recalculate couplings</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  <span class="comment">// MCFM masses</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  <span class="keywordflow">if</span> (ipartabs==6) <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.twidth=inwidth;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==15) <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.tauwidth=inwidth;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==23) <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zwidth=inwidth;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==24) <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wwidth=inwidth;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==25) <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hwidth=inwidth;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160; </div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="comment">// JHUGen masses</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> GeV=1./100.;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <span class="keywordtype">double</span> jinwidth = inwidth*GeV;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  <span class="keywordtype">int</span> jpart = <a class="code" href="TModParameters_8hh.html#a00e07c5a686985e7a030b7349d0f4998">convertLHEreverse</a>(&amp;ipart);</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <a class="code" href="TModParameters_8hh.html#acbe6f52cddf3b91cceb15289fed004e7">__modparameters_MOD_setdecaywidth</a>(&amp;jinwidth, &amp;jpart);</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;}</div>
<div class="line"><a name="l01507"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a9082c83a90005205bb355123c1c24875"> 1507</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a9082c83a90005205bb355123c1c24875">TUtil::SetCKMElements</a>(<span class="keywordtype">double</span>* invckm_ud, <span class="keywordtype">double</span>* invckm_us, <span class="keywordtype">double</span>* invckm_cd, <span class="keywordtype">double</span>* invckm_cs, <span class="keywordtype">double</span>* invckm_ts, <span class="keywordtype">double</span>* invckm_tb, <span class="keywordtype">double</span>* invckm_ub, <span class="keywordtype">double</span>* invckm_cb, <span class="keywordtype">double</span>* invckm_td){</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <a class="code" href="TModParameters_8hh.html#a870d3d3ae6653e7784e4699e3247d628">__modparameters_MOD_computeckmelements</a>(invckm_ud, invckm_us, invckm_cd, invckm_cs, invckm_ts, invckm_tb, invckm_ub, invckm_cb, invckm_td);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160; </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <span class="keywordtype">int</span> i, j;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  i=2; j=1;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <a class="code" href="TMCFM_8hh.html#ad7d6c16e0c48f31d8508784342540479">cabib_</a>.Vud = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;i, &amp;j);</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  i=2; j=3;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  <a class="code" href="TMCFM_8hh.html#ad7d6c16e0c48f31d8508784342540479">cabib_</a>.Vus = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;i, &amp;j);</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  i=2; j=5;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <a class="code" href="TMCFM_8hh.html#ad7d6c16e0c48f31d8508784342540479">cabib_</a>.Vub = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;i, &amp;j);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  i=4; j=1;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <a class="code" href="TMCFM_8hh.html#ad7d6c16e0c48f31d8508784342540479">cabib_</a>.Vcd = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;i, &amp;j);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  i=4; j=3;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <a class="code" href="TMCFM_8hh.html#ad7d6c16e0c48f31d8508784342540479">cabib_</a>.Vcs = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;i, &amp;j);</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  i=4; j=5;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  <a class="code" href="TMCFM_8hh.html#ad7d6c16e0c48f31d8508784342540479">cabib_</a>.Vcb = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;i, &amp;j);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <span class="comment">// Do not call ckmfill_(), it is called by MCFM_chooser!</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;}</div>
<div class="line"><a name="l01525"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a8cff275aa36f42dd114b266e6f8dcd74"> 1525</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceTUtil.html#a8cff275aa36f42dd114b266e6f8dcd74">TUtil::GetCKMElement</a>(<span class="keywordtype">int</span> iquark, <span class="keywordtype">int</span> jquark){</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;iquark, &amp;jquark);</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;}</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160; </div>
<div class="line"><a name="l01529"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#af0a7eb81fc049eae88e8be0e72e27451"> 1529</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceTUtil.html#af0a7eb81fc049eae88e8be0e72e27451">TUtil::GetMass</a>(<span class="keywordtype">int</span> ipart){</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> ipartabs = abs(ipart);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160; </div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <span class="keywordflow">if</span> (ipartabs==8) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.mt_4gen;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==7) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.mb_4gen;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==6) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mt;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==5) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mb;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==4) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mc;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==3) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.ms;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==2) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mu;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==1) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.md;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==11) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mel;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==13) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mmu;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==15) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mtau;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==23) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zmass;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==24) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wmass;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==25) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hmass;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <span class="comment">// JHUGen masses</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      ipartabs&lt;=6 <span class="comment">// (d, u, s, c, b, t)</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      ||</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      (ipartabs&gt;=11 &amp;&amp; ipartabs&lt;=16) <span class="comment">// (l, nu) x (e, mu, tau)</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;      ||</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;      ipartabs==23 || ipartabs==24 || ipartabs==25 <span class="comment">// Z, W, H</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;      ||</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      ipartabs==32 || ipartabs==34 <span class="comment">// Z&#39;, W+-&#39;</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      ){</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> GeV=1./100.;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      <span class="keywordtype">int</span> jpart = <a class="code" href="TModParameters_8hh.html#a00e07c5a686985e7a030b7349d0f4998">convertLHEreverse</a>(&amp;ipart);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      <span class="keywordtype">double</span> joutmass = <a class="code" href="TModParameters_8hh.html#ad03682febeb063859a8c4dd746245ed7">__modparameters_MOD_getmass</a>(&amp;jpart);</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;      <span class="keywordtype">double</span> outmass = joutmass/GeV;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      <span class="keywordflow">return</span> outmass;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    }</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  }</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;}</div>
<div class="line"><a name="l01566"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a2abfaba12b321c4f89447482105635a5"> 1566</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceTUtil.html#a2abfaba12b321c4f89447482105635a5">TUtil::GetDecayWidth</a>(<span class="keywordtype">int</span> ipart){</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> ipartabs = abs(ipart);</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <span class="comment">// MCFM widths</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <span class="keywordflow">if</span> (ipartabs==6) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.twidth;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==15) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.tauwidth;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==23) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zwidth;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==24) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wwidth;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipartabs==25) <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hwidth;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <span class="comment">// JHUGen widths</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> GeV=1./100.;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="keywordtype">int</span> jpart = <a class="code" href="TModParameters_8hh.html#a00e07c5a686985e7a030b7349d0f4998">convertLHEreverse</a>(&amp;ipart);</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="keywordtype">double</span> joutwidth = <a class="code" href="TModParameters_8hh.html#aa4ac2f250b3f0ccd7cfbce24aea16336">__modparameters_MOD_getdecaywidth</a>(&amp;jpart);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="keywordtype">double</span> outwidth = joutwidth/GeV;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="keywordflow">return</span> outwidth;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  }</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;}</div>
<div class="line"><a name="l01584"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#aa1d4b6a7bde96bc1a25ecfbee76d7ee5"> 1584</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceTUtil.html#af0a7eb81fc049eae88e8be0e72e27451">TUtil::GetMass</a>(<span class="keyword">const</span> <a class="code" href="classMELAParticle.html">MELAParticle</a>* part){</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  <span class="keywordflow">if</span> (part==<span class="keyword">nullptr</span>) <span class="keywordflow">return</span> <a class="code" href="namespaceTUtil.html#af0a7eb81fc049eae88e8be0e72e27451">GetMass</a>(-9000);</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceTUtil.html#af0a7eb81fc049eae88e8be0e72e27451">GetMass</a>(part-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>);</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;}</div>
<div class="line"><a name="l01588"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a57432221ba2618d1ee87cc363de43adf"> 1588</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceTUtil.html#a2abfaba12b321c4f89447482105635a5">TUtil::GetDecayWidth</a>(<span class="keyword">const</span> <a class="code" href="classMELAParticle.html">MELAParticle</a>* part){</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="keywordflow">if</span> (part==<span class="keyword">nullptr</span>) <span class="keywordflow">return</span> <a class="code" href="namespaceTUtil.html#a2abfaba12b321c4f89447482105635a5">GetDecayWidth</a>(-9000);</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceTUtil.html#a2abfaba12b321c4f89447482105635a5">GetDecayWidth</a>(part-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;}</div>
<div class="line"><a name="l01592"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a72e7c71bfda18734d90f846c43f0e0a5"> 1592</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a72e7c71bfda18734d90f846c43f0e0a5">TUtil::GetMassWidth</a>(<span class="keywordtype">int</span> ipart, <span class="keywordtype">double</span>&amp; <a class="code" href="namespacemela.html#a42a9f6ba8d6c9cec91eb11b999fea95e">m</a>, <span class="keywordtype">double</span>&amp; ga){</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <a class="code" href="namespacemela.html#a42a9f6ba8d6c9cec91eb11b999fea95e">m</a>=<a class="code" href="namespaceTUtil.html#af0a7eb81fc049eae88e8be0e72e27451">TUtil::GetMass</a>(ipart);</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  ga=<a class="code" href="namespaceTUtil.html#a2abfaba12b321c4f89447482105635a5">TUtil::GetDecayWidth</a>(ipart);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;}</div>
<div class="line"><a name="l01596"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a6e9f4b3d6db136b1bca9f7f7642565cc"> 1596</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a72e7c71bfda18734d90f846c43f0e0a5">TUtil::GetMassWidth</a>(<span class="keyword">const</span> <a class="code" href="classMELAParticle.html">MELAParticle</a>* part, <span class="keywordtype">double</span>&amp; <a class="code" href="namespacemela.html#a42a9f6ba8d6c9cec91eb11b999fea95e">m</a>, <span class="keywordtype">double</span>&amp; ga){</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  <span class="keywordflow">if</span> (part==<span class="keyword">nullptr</span>) <span class="keywordflow">return</span> <a class="code" href="namespaceTUtil.html#a72e7c71bfda18734d90f846c43f0e0a5">GetMassWidth</a>(-9000, <a class="code" href="namespacemela.html#a42a9f6ba8d6c9cec91eb11b999fea95e">m</a>, ga);</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceTUtil.html#a72e7c71bfda18734d90f846c43f0e0a5">GetMassWidth</a>(part-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>, <a class="code" href="namespacemela.html#a42a9f6ba8d6c9cec91eb11b999fea95e">m</a>, ga);</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;}</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160; </div>
<div class="line"><a name="l01601"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a4a00d03fa1abeb4335b6abd9fae90663"> 1601</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceTUtil.html#a4a00d03fa1abeb4335b6abd9fae90663">TUtil::InterpretScaleScheme</a>(<span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28c">TVar::Production</a>&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815f">TVar::MatrixElement</a>&amp; matrixElement, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805c">TVar::EventScaleScheme</a>&amp; scheme, TLorentzVector <a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>]){</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a>=0;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  TLorentzVector <span class="keyword">const</span> nullFourVector(0, 0, 0, 0);</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805ca6072646de5d43decee41caf8444bb209">TVar::Fixed_mH</a>) <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hmass;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805ca81c1d236842e99c1fb6180ad5cb17639">TVar::Fixed_mW</a>) <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wmass;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805ca910aef428690314035df7e6f359f4f61">TVar::Fixed_mZ</a>) <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zmass;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805ca42a0672e541b92585667e2df57b4d958">TVar::Fixed_mWPlusmH</a>) <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = (<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wmass+<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hmass);</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805caa8b7f54e0391e3747b7565a584f57acb">TVar::Fixed_mZPlusmH</a>) <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = (<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zmass+<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hmass);</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805ca2413e8a5281007717850721f61459dc3">TVar::Fixed_TwomtPlusmH</a>) <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = (2.*<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mt+<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hmass);</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805ca0d937411470defd3a6e748a4e8bfcc62">TVar::Fixed_mtPlusmH</a>) <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mt+<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hmass;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805cabc1bc15cd2b43d878d0f3b433cafb392">TVar::Dynamic_qH</a>){</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    TLorentzVector pTotal = <a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[2]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[3]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[4]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[5];</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = fabs(pTotal.M());</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  }</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805cacf38211651fe3f026d3323b90762b955">TVar::Dynamic_qJJH</a>){</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    TLorentzVector pTotal = <a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[2]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[3]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[4]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[5]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[6]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[7];</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = fabs(pTotal.M());</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  }</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805ca0e0dbb110275d4b68b0696ec0d4fbcb6">TVar::Dynamic_qJJ_qH</a>){</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    TLorentzVector qH = <a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[2]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[3]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[4]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[5];</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    TLorentzVector qJJ = <a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[6]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[7];</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = fabs(qH.M()+qJJ.M());</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805caeddd119fddfd7123176ceb49cf90d1a0">TVar::Dynamic_qJ_qJ_qH</a>){</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    TLorentzVector qH = <a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[2]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[3]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[4]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[5];</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = fabs(qH.M()+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[6].M()+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[7].M());</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  }</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805cace84f5ea3afdb116da2543edbad91560">TVar::Dynamic_HT</a>){</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=2; c&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; c++) <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> += <a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[c].Pt(); <span class="comment">// Scalar sum of all pTs</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  }</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805cae313d1a3b64c3b8b487652aa346ec57b">TVar::Dynamic_Leading_pTJ</a>){</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="comment">// pT of the hardest jet, should be just p[6].Pt() if jets are already ordered in pT</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=6; c&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; c++) <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = std::max(<a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a>, <a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[c].Pt());</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  }</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805ca9e7d08a46d59cf452ead5bcb211f8e45">TVar::Dynamic_Softest_pTJ</a>){</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="comment">// pT of the softest jet, should be just p[7].Pt() if jets are already ordered in pT</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = <a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[6].Pt();</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=7; c&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; c++){ <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[c].Pt()&gt;0.) <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = std::min(<a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a>, <a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[c].Pt()); }</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a>&lt;0.) <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = 0;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  }</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scheme == <a class="code" href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805cabff9613912b7618ad30a4c8360ec9dea">TVar::DefaultScaleScheme</a>){</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="comment">// Defaults are dynamic scales except in ttH and bbH.</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="keywordflow">if</span> (matrixElement==<a class="code" href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815faba6e6b23b0115bbaa919563a0626be03">TVar::JHUGen</a>){</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3706a5c493f245b1f6231e93e31383ea">TVar::JQCD</a></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4539519c2d018fd29228bdd605c76c47">TVar::ZZGG</a></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7f06d733c2cecc34c7fcd2b665ff8b79">TVar::ZZQQB_STU</a></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3ae97ff9bcb97541f88b75dc6b28c2af">TVar::ZZQQB_S</a></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caa8167833dfafdcfe495089716e6c1e0b">TVar::ZZQQB_TU</a></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        ){</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        TLorentzVector pTotal = <a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[2]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[3]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[4]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[5];</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = fabs(pTotal.M());</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      }</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca57c0e01faf9fc912284d7b1951fee889">TVar::ttH</a></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        ||</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca1ae680405479fddfedd3314339a47b01">TVar::bbH</a></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        ) <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = (2.*<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.mt+<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hmass);</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    }</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (matrixElement==<a class="code" href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815fa23f6a5a26e1e59a26957f95f3b252455">TVar::MCFM</a>){</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4539519c2d018fd29228bdd605c76c47">TVar::ZZGG</a></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7f06d733c2cecc34c7fcd2b665ff8b79">TVar::ZZQQB_STU</a></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160; </div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3706a5c493f245b1f6231e93e31383ea">TVar::JQCD</a></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160; </div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca89a5439f5d7527b48dfb23d3042e8d29">TVar::JJEW</a></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca936aef1ef89c04b5586ccb862544363a">TVar::JJEWQCD</a></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160; </div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3ae97ff9bcb97541f88b75dc6b28c2af">TVar::ZZQQB_S</a></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac09ee14d8ad516b27397f28eee642c62">TVar::JJQCD_S</a></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca902db21776e8b4069184189a3d35976a">TVar::JJVBF_S</a></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca78112f139715de80da62332b06c94926">TVar::JJEW_S</a></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cada9ae823e21061c18721960aadabee2c">TVar::JJEWQCD_S</a></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160; </div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caa8167833dfafdcfe495089716e6c1e0b">TVar::ZZQQB_TU</a></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca832b9995c64912826d4e5f60e86f35ed">TVar::JJQCD_TU</a></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca100a3d28b2ee4efd9227a4068543848f">TVar::JJVBF_TU</a></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caf04b7e8e4c0900b0206ceaa88dc50271">TVar::JJEW_TU</a></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4c10b0b90ea432d42a32a4ac8a099a1b">TVar::JJEWQCD_TU</a></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        ){</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        TLorentzVector pTotal = <a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[2]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[3]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[4]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[5];</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = fabs(pTotal.M());</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      }</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca57c0e01faf9fc912284d7b1951fee889">TVar::ttH</a></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca1ae680405479fddfedd3314339a47b01">TVar::bbH</a></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        ){ <span class="comment">// ttH and bbH are not implemented through MCFM, will need revision if they are implemented.</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        TLorentzVector pTotal = <a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[2]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[3]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[4]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[5]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[6]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[7];</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = fabs(pTotal.M());</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      }</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    }</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  }</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160; </div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a>&lt;=0.){</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;Scaling &quot;</span> &lt;&lt; scheme &lt;&lt; <span class="stringliteral">&quot; fails for production &quot;</span> &lt;&lt; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> &lt;&lt; <span class="stringliteral">&quot;, defaulting to dynamic scheme m3456 &quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    TLorentzVector pTotal = <a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[2]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[3]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[4]+<a class="code" href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">p</a>[5];</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a> = fabs(pTotal.M());</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  }</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a>;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;}</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#ab551562aaa197841cd0a638f1f38b0ff">TUtil::SetAlphaS</a>(<span class="keywordtype">double</span>&amp; Q_ren, <span class="keywordtype">double</span>&amp; Q_fac, <span class="keywordtype">double</span> multiplier_ren, <span class="keywordtype">double</span> multiplier_fac, <span class="keywordtype">int</span> mynloop, <span class="keywordtype">int</span> mynflav, <span class="keywordtype">string</span> mypartons){</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  <span class="keywordtype">bool</span> hasReset=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  <span class="keywordflow">if</span> (multiplier_ren&lt;=0. || multiplier_fac&lt;=0.){</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SetAlphaS: Invalid scale multipliers&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  }</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <span class="keywordflow">if</span> (Q_ren&lt;=1. || Q_fac&lt;=1. || mynloop&lt;=0 || mypartons.compare(<span class="stringliteral">&quot;Default&quot;</span>)==0){</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="keywordflow">if</span> (Q_ren&lt;0.) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SetAlphaS: Invalid QCD scale for alpha_s, setting to mH/2...&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="keywordflow">if</span> (Q_fac&lt;0.) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SetAlphaS: Invalid factorization scale, setting to mH/2...&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    Q_ren = (<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hmass)*0.5;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    Q_fac = Q_ren;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    mynloop = 1;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    hasReset=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  }</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  <span class="keywordflow">if</span> (!hasReset){</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    Q_ren *= multiplier_ren;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    Q_fac *= multiplier_fac;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  }</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160; </div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="comment">  /***** MCFM Alpha_S *****/</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  <span class="keywordtype">bool</span> nflav_is_same = (<a class="code" href="TMCFM_8hh.html#a55930b5d389dfae39115156b2bc9a692">nflav_</a>.nflav == mynflav);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  <span class="keywordflow">if</span> (!nflav_is_same) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SetAlphaS: nflav=&quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a55930b5d389dfae39115156b2bc9a692">nflav_</a>.nflav &lt;&lt; <span class="stringliteral">&quot; is the only one supported.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale = Q_ren;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.musq = Q_ren*Q_ren;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale = Q_fac;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <span class="keywordflow">if</span> (mynloop!=1){</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SetAlphaS: Only nloop=1 is supported!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    mynloop=1;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  }</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  <a class="code" href="TMCFM_8hh.html#a819542dc6ff812e041d403592a6b8990">nlooprun_</a>.nlooprun = mynloop;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160; </div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="comment">  /***** JHUGen Alpha_S *****/</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="comment">  // For proper pdfwrapper_linux.f execution (alpha_s computation does not use pdf but examines the pdf name to initialize amz.)</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="comment">  if (mypartons.compare(&quot;Default&quot;)!=0 &amp;&amp; mypartons.compare(&quot;cteq6_l&quot;)!=0 &amp;&amp; mypartons.compare(&quot;cteq6l1&quot;)!=0){</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="comment">  MELAout &lt;&lt; &quot;Only default=cteq6l1 or cteq6_l are supported. Modify mela.cc symlinks, put the pdf table into data/Pdfdata and retry. Setting mypartons to Default...&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="comment">  mypartons = &quot;Default&quot;;</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="comment">  }</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="comment">  // From pdfwrapper_linux.f:</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;<span class="comment">  if (mypartons.compare(&quot;cteq6_l&quot;)==0) couple_.amz = 0.118;</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;<span class="comment">  else if (mypartons.compare(&quot;cteq6l1&quot;)==0 || mypartons.compare(&quot;Default&quot;)==0) couple_.amz = 0.130;</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="comment">  else couple_.amz = 0.118; // Add pdf as appropriate</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="comment">  if (!nflav_is_same){</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="comment">    nflav_.nflav = mynflav;</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="comment">    if (mypartons.compare(&quot;Default&quot;)!=0) sprintf(pdlabel_.pdlabel, &quot;%s&quot;, mypartons.c_str());</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="comment">    else sprintf(pdlabel_.pdlabel, &quot;%s&quot;, &quot;cteq6l1&quot;); // Default pdf is cteq6l1</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="comment">    coupling2_();</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="comment">  }</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="comment">  else qcdcouple_.as = alphas_(&amp;(scale_.scale), &amp;(couple_.amz), &amp;(nlooprun_.nlooprun));</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> GeV=1./100.;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  <span class="keywordtype">double</span> muren_jhu = <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale*GeV;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  <span class="keywordtype">double</span> mufac_jhu = <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale*GeV;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <a class="code" href="TModJHUGenMELA_8hh.html#a020cbe585463df7e05300b1cb081b4be">__modjhugenmela_MOD_setmurenfac</a>(&amp;muren_jhu, &amp;mufac_jhu);</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <a class="code" href="TModParameters_8hh.html#a2e797b8b4578c30bfcb0cc7f97017e31">__modparameters_MOD_evalalphas</a>();</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  <a class="code" href="namespaceTUtil.html#a2f0fce2b3d66f17b673f2e75d87adf00">TUtil::GetAlphaS</a>(&amp;(<a class="code" href="TMCFM_8hh.html#a2d17190b656f51e9aef47baab87a5895">qcdcouple_</a>.as), &amp;(<a class="code" href="TMCFM_8hh.html#a90f048ead599709198fca273d41c03c9">couple_</a>.amz));</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160; </div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  <a class="code" href="TMCFM_8hh.html#a2d17190b656f51e9aef47baab87a5895">qcdcouple_</a>.gsq = 4.0*TMath::Pi()*<a class="code" href="TMCFM_8hh.html#a2d17190b656f51e9aef47baab87a5895">qcdcouple_</a>.as;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  <a class="code" href="TMCFM_8hh.html#a2d17190b656f51e9aef47baab87a5895">qcdcouple_</a>.ason2pi = <a class="code" href="TMCFM_8hh.html#a2d17190b656f51e9aef47baab87a5895">qcdcouple_</a>.as/(2.0*TMath::Pi());</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  <a class="code" href="TMCFM_8hh.html#a2d17190b656f51e9aef47baab87a5895">qcdcouple_</a>.ason4pi = <a class="code" href="TMCFM_8hh.html#a2d17190b656f51e9aef47baab87a5895">qcdcouple_</a>.as/(4.0*TMath::Pi());</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160; </div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  <span class="comment">// TEST RUNNING SCALE PER EVENT:</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;<span class="comment">  if(verbosity &gt;= TVar::DEBUG){</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;<span class="comment">  MELAout &lt;&lt; &quot;My pdf is: &quot; &lt;&lt; pdlabel_.pdlabel &lt;&lt; endl;</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;<span class="comment">  MELAout &lt;&lt; &quot;My Q_ren: &quot; &lt;&lt; Q_ren &lt;&lt; &quot; | My alpha_s: &quot; &lt;&lt; qcdcouple_.as &lt;&lt; &quot; at order &quot; &lt;&lt; nlooprun_.nlooprun &lt;&lt; &quot; with a(m_Z): &quot; &lt;&lt; couple_.amz &lt;&lt; &#39;\t&#39;</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;<span class="comment">  &lt;&lt; &quot;Nflav: &quot; &lt;&lt; nflav_.nflav &lt;&lt; endl;</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;}</div>
<div class="line"><a name="l01794"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a2f0fce2b3d66f17b673f2e75d87adf00"> 1794</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a2f0fce2b3d66f17b673f2e75d87adf00">TUtil::GetAlphaS</a>(<span class="keywordtype">double</span>* <a class="code" href="TMCFM_8hh.html#a7166ca25e90c8884ec236febf53bf4c4">alphas_</a>, <span class="keywordtype">double</span>* alphasmz_){</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  <span class="keywordtype">double</span> alphasVal=0, alphasmzVal=0;</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  <a class="code" href="TModJHUGenMELA_8hh.html#aa157e1ca3fd32232d0937bcf2363988c">__modjhugenmela_MOD_getalphasalphasmz</a>(&amp;alphasVal, &amp;alphasmzVal);</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="TMCFM_8hh.html#a7166ca25e90c8884ec236febf53bf4c4">alphas_</a>!=0) *<a class="code" href="TMCFM_8hh.html#a7166ca25e90c8884ec236febf53bf4c4">alphas_</a> = alphasVal;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <span class="keywordflow">if</span> (alphasmz_!=0) *alphasmz_ = alphasmzVal;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;}</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160; </div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="comment">// chooser.f split into 2 different functions</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a5a527eeac9cb1eef2572d69f647e1e30"> 1802</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceTUtil.html#a5a527eeac9cb1eef2572d69f647e1e30">TUtil::MCFM_chooser</a>(</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1">TVar::Process</a>&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28c">TVar::Production</a>&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a2599e53f6f03e850b83dd83d6c296fec">TVar::LeptonInterference</a>&amp; leptonInterf,</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049">TVar::VerbosityLevel</a>&amp; verbosity,</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  <span class="keyword">const</span> <a class="code" href="structTVar_1_1simple__event__record.html">simple_event_record</a>&amp; mela_event</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  ){</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  <span class="keywordtype">bool</span> result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160; </div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ndau = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size();</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <span class="keywordtype">int</span>* pId = <span class="keyword">new</span> <span class="keywordtype">int</span>[ndau];</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;ndau; ip++){</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    pId[ip]=mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.at(ip).first;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  }</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <span class="keywordtype">bool</span> isWW = (ndau&gt;=4 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1)));</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  <span class="keywordtype">bool</span> isZZ = (ndau&gt;=4 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1)));</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="keywordtype">bool</span> hasZZ4fInterf = isZZ &amp;&amp; abs(pId[0])==abs(pId[2]) &amp;&amp; abs(pId[1])==abs(pId[3]) &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pId[0]) &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pId[3]);</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <span class="comment">//bool isZJJ = false;</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  <span class="comment">//if (ndau&gt;=4) isZJJ = (PDGHelpers::isAZBoson(mela_event.intermediateVid.at(0)) &amp;&amp; PDGHelpers::isAJet(pId[2]) &amp;&amp; PDGHelpers::isAJet(pId[3])); // Notice both isZZ and isZJJ could be true</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="comment">//bool isZG = (ndau&gt;=3 &amp;&amp; PDGHelpers::isAZBoson(mela_event.intermediateVid.at(0)) &amp;&amp; PDGHelpers::isAPhoton(mela_event.intermediateVid.at(1)));</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  <span class="keywordtype">bool</span> isGG = (ndau&gt;=2 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1)));</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: isWW=&quot;</span> &lt;&lt; (<a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>)isWW &lt;&lt; <span class="stringliteral">&quot;, isZZ=&quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)isZZ &lt;&lt; <span class="stringliteral">&quot;, hasZZ4fInterf=&quot;</span> &lt;&lt; (<a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>)hasZZ4fInterf &lt;&lt; endl;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160; </div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <a class="code" href="TMCFM_8hh.html#a54213f196c3344b9508ae4cb9eab0ea0">npart_</a>.npart=4; <span class="comment">// Default number of particles is just 4, indicating no associated particles</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  sprintf(<a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring, <span class="stringliteral">&quot;test&quot;</span>);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160; </div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    ndau&gt;=4</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    (</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    ((<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7f06d733c2cecc34c7fcd2b665ff8b79">TVar::ZZQQB_STU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3ae97ff9bcb97541f88b75dc6b28c2af">TVar::ZZQQB_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caa8167833dfafdcfe495089716e6c1e0b">TVar::ZZQQB_TU</a>) &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a>)</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    ||</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    ((<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a>) &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a>)</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    )</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    ){</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="comment">//81 &#39;  f(p1)+f(p2) --&gt; Z^0(--&gt;mu^-(p3)+mu^+(p4)) + Z^0(--&gt;e^-(p5)+e^+(p6))&#39;</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="comment">//86 &#39;  f(p1)+f(p2) --&gt; Z^0(--&gt;e^-(p5)+e^+(p6))+Z^0(--&gt;mu^-(p3)+mu^+(p4)) (NO GAMMA*)&#39;</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <span class="comment">//90 &#39;  f(p1)+f(p2) --&gt; Z^0(--&gt;e^-(p3)+e^+(p4)) + Z^0(--&gt;e^-(p5)+e^+(p6))&#39; &#39;L&#39;</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160; </div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <a class="code" href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a>.nqcdjets=0;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <a class="code" href="TMCFM_8hh.html#a9587d963d5224d712e16278a297f6983">srdiags_</a>.srdiags=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz=0; <a class="code" href="TMCFM_8hh.html#a4f6a5b3ceab297482e3ab5f300d8008a">ckmfill_</a>(&amp;(<a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz));</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <a class="code" href="TMCFM_8hh.html#a3b31843cde69d917445902e679909e6e">bveg1_mcfm_</a>.ndim=10;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n2=1;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n3=1;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass2=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zmass;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width2=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zwidth;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass3=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zmass;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width3=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zwidth;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160; </div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <a class="code" href="TMCFM_8hh.html#a1e72dbf082de5b3d5b384a09a1c83d75">vsymfact_</a>.vsymfact=1.0;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <a class="code" href="TMCFM_8hh.html#af8cdb99be9a8b3fc5881cc93f0e4b6cd">interference_</a>.interference=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="keywordflow">if</span> (hasZZ4fInterf &amp;&amp; (leptonInterf==<a class="code" href="namespaceTVar.html#a2599e53f6f03e850b83dd83d6c296feca92cbe92f4215368249033082e6671aa6">TVar::DefaultLeptonInterf</a> || leptonInterf==<a class="code" href="namespaceTVar.html#a2599e53f6f03e850b83dd83d6c296feca45bd1efd7db2e2687aa602c8a5d1b890">TVar::InterfOn</a>)){</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      <span class="comment">//90 &#39;  f(p1)+f(p2) --&gt; Z^0(--&gt;e^-(p3)+e^+(p4)) + Z^0(--&gt;e^-(p5)+e^+(p6))&#39; &#39;L&#39;</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      <a class="code" href="TMCFM_8hh.html#a1e72dbf082de5b3d5b384a09a1c83d75">vsymfact_</a>.vsymfact=0.5;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      <a class="code" href="TMCFM_8hh.html#af8cdb99be9a8b3fc5881cc93f0e4b6cd">interference_</a>.interference=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    }</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160; </div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: Setup is (production, process)=(&quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a1225a4280a727b6456d225d3493e0e66">TVar::ProductionName</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160; </div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  }</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    ndau&gt;=4</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    ((<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a>) &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a>)</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    ){</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="comment">// Processes 61 (4l), 62 (2l2q), 64 (2q2l)</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160; </div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <a class="code" href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a>.nqcdjets=0;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz=1; <a class="code" href="TMCFM_8hh.html#a4f6a5b3ceab297482e3ab5f300d8008a">ckmfill_</a>(&amp;(<a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz));</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <a class="code" href="TMCFM_8hh.html#a3b31843cde69d917445902e679909e6e">bveg1_mcfm_</a>.ndim=10;</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n2=1;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n3=1;</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass2=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wmass;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width2=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wwidth;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass3=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wmass;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width3=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wwidth;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    <a class="code" href="TMCFM_8hh.html#a9587d963d5224d712e16278a297f6983">srdiags_</a>.srdiags=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160; </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: Setup is (production, process)=(&quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a1225a4280a727b6456d225d3493e0e66">TVar::ProductionName</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  }</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    (ndau&gt;=4 || ndau==2)</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad2933b84082d269af9a836d4646aeefd">TVar::bkgZJets</a></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    ){</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    <span class="comment">// -- 44 &#39;  f(p1)+f(p2) --&gt; Z^0(--&gt;e^-(p3)+e^+(p4))+f(p5)+f(p6)&#39;</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <span class="comment">// these settings are identical to use the chooser_() function</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160; </div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <a class="code" href="TMCFM_8hh.html#aa0c0c6e5953247793844f2959d19cbf8">flags_</a>.Gflag=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <a class="code" href="TMCFM_8hh.html#aa0c0c6e5953247793844f2959d19cbf8">flags_</a>.Qflag=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <a class="code" href="TMCFM_8hh.html#aa0c0c6e5953247793844f2959d19cbf8">flags_</a>.QandGflag=<span class="keyword">true</span>; <span class="comment">// This is in case NLO is implemented.</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <a class="code" href="TMCFM_8hh.html#a3b31843cde69d917445902e679909e6e">bveg1_mcfm_</a>.ndim=10;</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n2=0;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n3=1;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <a class="code" href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a>.nqcdjets=2;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz=0; <a class="code" href="TMCFM_8hh.html#a4f6a5b3ceab297482e3ab5f300d8008a">ckmfill_</a>(&amp;(<a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz));</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass3=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zmass;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width3=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zwidth;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160; </div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: Setup is (production, process)=(&quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a1225a4280a727b6456d225d3493e0e66">TVar::ProductionName</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160; </div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  }</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    ndau==3</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a>)</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a2f26259ffb9387326573b0b1c4f2c700">TVar::bkgZGamma</a></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    ){</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="comment">// -- 300 &#39;  f(p1)+f(p2) --&gt; Z^0(--&gt;e^-(p3)+e^+(p4))+gamma(p5)&#39;</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="comment">// -- 305 &#39;  f(p1)+f(p2) --&gt; Z^0(--&gt;3*(nu(p3)+nu~(p4)))-(sum over 3 nu)+gamma(p5)&#39;</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160; </div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <a class="code" href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a>.nqcdjets=0;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <a class="code" href="TMCFM_8hh.html#a3b31843cde69d917445902e679909e6e">bveg1_mcfm_</a>.ndim=7;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n2=0;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n3=1;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass3=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zmass;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width3=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zwidth;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    <span class="comment">//lastphot_.lastphot=5; // Done during particle label assignment</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz=0; <a class="code" href="TMCFM_8hh.html#a4f6a5b3ceab297482e3ab5f300d8008a">ckmfill_</a>(&amp;(<a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz));</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160; </div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: Setup is (production, process)=(&quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a1225a4280a727b6456d225d3493e0e66">TVar::ProductionName</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160; </div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  }</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    isGG</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4539519c2d018fd29228bdd605c76c47">TVar::ZZGG</a>)</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4baafc289948916b0b531aa85e8f896f">TVar::bkgGammaGamma</a></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    ){</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="comment">// -- 285 &#39;  f(p1)+f(p2) --&gt; gamma(p3)+gamma(p4)&#39;</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160; </div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <a class="code" href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a>.nqcdjets=0;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <a class="code" href="TMCFM_8hh.html#a3b31843cde69d917445902e679909e6e">bveg1_mcfm_</a>.ndim=4;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n3=0;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <a class="code" href="TMCFM_8hh.html#aef44b17288a914b738c4fbdf55d64dbb">lastphot_</a>.lastphot=4;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz=0; <a class="code" href="TMCFM_8hh.html#a4f6a5b3ceab297482e3ab5f300d8008a">ckmfill_</a>(&amp;(<a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz));</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a>) <a class="code" href="TMCFM_8hh.html#ace316759a46920794a772ae644254576">noglue_</a>.omitgg=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="TMCFM_8hh.html#ace316759a46920794a772ae644254576">noglue_</a>.omitgg=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160; </div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: Setup is (production, process)=(&quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a1225a4280a727b6456d225d3493e0e66">TVar::ProductionName</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; </div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  }</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    ndau&gt;=4</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4539519c2d018fd29228bdd605c76c47">TVar::ZZGG</a></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    (isZZ &amp;&amp; (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4cc74ca92572b408de0ce370a51f64e5">TVar::bkgZZ_SMHiggs</a>))</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    ){</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;<span class="comment">    nprocs:</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="comment">    c--- 128 &#39;  f(p1)+f(p2) --&gt; H(--&gt; Z^0(e^-(p3)+e^+(p4)) + Z^0(mu^-(p5)+mu^+(p6)) [top, bottom loops, exact]&#39; &#39;L&#39;</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="comment">    c--- 129 &#39;  f(p1)+f(p2) --&gt; H(--&gt; Z^0(e^-(p3)+e^+(p4)) + Z^0(mu^-(p5)+mu^+(p6)) [only H, gg-&gt;ZZ intf.]&#39; &#39;L&#39; -&gt; NOT IMPLEMENTED</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="comment">    c--- 130 &#39;  f(p1)+f(p2) --&gt; H(--&gt; Z^0(e^-(p3)+e^+(p4)) + Z^0(mu^-(p5)+mu^+(p6)) [H squared and H, gg-&gt;ZZ intf.]&#39; &#39;L&#39;</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="comment">    c--- 131 &#39;  f(p1)+f(p2) --&gt; Z^0(e^-(p3)+e^+(p4)) + Z^0(mu^-(p5)+mu^+(p6) [gg only, (H + gg-&gt;ZZ) squared]&#39; &#39;L&#39;</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="comment">    c--- 132 &#39;  f(p1)+f(p2) --&gt; Z^0(e^-(p3)+e^+(p4)) + Z^0(mu^-(p5)+mu^+(p6) [(gg-&gt;ZZ) squared]&#39; &#39;L&#39;</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160; </div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <a class="code" href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a>.nqcdjets=0;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz=0; <a class="code" href="TMCFM_8hh.html#a4f6a5b3ceab297482e3ab5f300d8008a">ckmfill_</a>(&amp;(<a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz));</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <a class="code" href="TMCFM_8hh.html#a3b31843cde69d917445902e679909e6e">bveg1_mcfm_</a>.ndim=10;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n2=1;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n3=1;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass2 =<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zmass;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width2=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zwidth;</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass3 =<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zmass;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width3=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zwidth;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <a class="code" href="TMCFM_8hh.html#a1e72dbf082de5b3d5b384a09a1c83d75">vsymfact_</a>.vsymfact=1.0;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <a class="code" href="TMCFM_8hh.html#af8cdb99be9a8b3fc5881cc93f0e4b6cd">interference_</a>.interference=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="keywordflow">if</span> (hasZZ4fInterf &amp;&amp; (leptonInterf==<a class="code" href="namespaceTVar.html#a2599e53f6f03e850b83dd83d6c296feca92cbe92f4215368249033082e6671aa6">TVar::DefaultLeptonInterf</a> || leptonInterf==<a class="code" href="namespaceTVar.html#a2599e53f6f03e850b83dd83d6c296feca45bd1efd7db2e2687aa602c8a5d1b890">TVar::InterfOn</a>)){</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;      <a class="code" href="TMCFM_8hh.html#a1e72dbf082de5b3d5b384a09a1c83d75">vsymfact_</a>.vsymfact=0.5;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;      <a class="code" href="TMCFM_8hh.html#af8cdb99be9a8b3fc5881cc93f0e4b6cd">interference_</a>.interference=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    }</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160; </div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: Setup is (production, process)=(&quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a1225a4280a727b6456d225d3493e0e66">TVar::ProductionName</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  }</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    ndau&gt;=4</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4539519c2d018fd29228bdd605c76c47">TVar::ZZGG</a></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    (</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    (</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    (isWW &amp;&amp; (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ac616ffacd90b7e38f875512989d62e5d">TVar::bkgWW_SMHiggs</a>))</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    )</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    ||</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    (</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    ((isWW || isZZ) &amp;&amp; (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655">TVar::bkgWWZZ_SMHiggs</a>))</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    )</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    )</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    ){ <span class="comment">// gg-&gt;VV</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <span class="comment">// Processes 1281, 1311, 1321</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160; </div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz=0; <a class="code" href="TMCFM_8hh.html#a4f6a5b3ceab297482e3ab5f300d8008a">ckmfill_</a>(&amp;(<a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz));</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <a class="code" href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a>.nqcdjets=0;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <a class="code" href="TMCFM_8hh.html#a3b31843cde69d917445902e679909e6e">bveg1_mcfm_</a>.ndim=10;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n2=1;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n3=1;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <a class="code" href="TMCFM_8hh.html#ac7c53005d835398935c9b0612b460762">nuflav_</a>.nuflav=1; <span class="comment">// Keep this at 1. Mela controls how many flavors in a more exact way.</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160; </div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: Setup is (production, process)=(&quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a1225a4280a727b6456d225d3493e0e66">TVar::ProductionName</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160; </div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  }</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  <span class="comment">// JJ + ZZ-&gt;4f</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <span class="comment">// Check for support in qq&#39;H+2J</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    ndau&gt;=4</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    (</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca89a5439f5d7527b48dfb23d3042e8d29">TVar::JJEW</a></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca902db21776e8b4069184189a3d35976a">TVar::JJVBF_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca78112f139715de80da62332b06c94926">TVar::JJEW_S</a></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca100a3d28b2ee4efd9227a4068543848f">TVar::JJVBF_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caf04b7e8e4c0900b0206ceaa88dc50271">TVar::JJEW_TU</a></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    )</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    (isZZ &amp;&amp; (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4cc74ca92572b408de0ce370a51f64e5">TVar::bkgZZ_SMHiggs</a>))</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    ){</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <span class="comment">// 220 &#39;  f(p1)+f(p2) --&gt; Z(e-(p3),e^+(p4))Z(mu-(p5),mu+(p6)))+f(p7)+f(p8) [weak]&#39; &#39;L&#39;</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160; </div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a>) sprintf(<a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring, <span class="stringliteral">&quot;wbfBO&quot;</span>);</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a>) sprintf(<a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring, <span class="stringliteral">&quot;wbfHO&quot;</span>);</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160; </div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <a class="code" href="TMCFM_8hh.html#a54213f196c3344b9508ae4cb9eab0ea0">npart_</a>.npart=6;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz=2; <a class="code" href="TMCFM_8hh.html#a4f6a5b3ceab297482e3ab5f300d8008a">ckmfill_</a>(&amp;(<a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz));</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    <a class="code" href="TMCFM_8hh.html#a3b31843cde69d917445902e679909e6e">bveg1_mcfm_</a>.ndim=16;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    <a class="code" href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a>.nqcdjets=2;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n2=1;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n3=1;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass2 =<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zmass;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width2=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zwidth;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass3 =<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zmass;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width3=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zwidth;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160; </div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <a class="code" href="TMCFM_8hh.html#a1e72dbf082de5b3d5b384a09a1c83d75">vsymfact_</a>.vsymfact=1.0;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    <a class="code" href="TMCFM_8hh.html#af8cdb99be9a8b3fc5881cc93f0e4b6cd">interference_</a>.interference=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <span class="keywordflow">if</span> (hasZZ4fInterf &amp;&amp; (leptonInterf==<a class="code" href="namespaceTVar.html#a2599e53f6f03e850b83dd83d6c296feca92cbe92f4215368249033082e6671aa6">TVar::DefaultLeptonInterf</a> || leptonInterf==<a class="code" href="namespaceTVar.html#a2599e53f6f03e850b83dd83d6c296feca45bd1efd7db2e2687aa602c8a5d1b890">TVar::InterfOn</a>)){</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      <a class="code" href="TMCFM_8hh.html#a1e72dbf082de5b3d5b384a09a1c83d75">vsymfact_</a>.vsymfact=0.5;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;      <a class="code" href="TMCFM_8hh.html#af8cdb99be9a8b3fc5881cc93f0e4b6cd">interference_</a>.interference=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    }</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160; </div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: Setup is (production, process)=(&quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a1225a4280a727b6456d225d3493e0e66">TVar::ProductionName</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160; </div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  }</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  <span class="comment">// JJ + WW-&gt;4f</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <span class="comment">// Check for support in qq&#39;H+2J</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    ndau&gt;=4</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    (</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca89a5439f5d7527b48dfb23d3042e8d29">TVar::JJEW</a></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca902db21776e8b4069184189a3d35976a">TVar::JJVBF_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca78112f139715de80da62332b06c94926">TVar::JJEW_S</a></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca100a3d28b2ee4efd9227a4068543848f">TVar::JJVBF_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caf04b7e8e4c0900b0206ceaa88dc50271">TVar::JJEW_TU</a></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    )</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    (isWW &amp;&amp; (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ac616ffacd90b7e38f875512989d62e5d">TVar::bkgWW_SMHiggs</a>))</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    ){</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <span class="comment">// Process 224</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160; </div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a>) sprintf(<a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring, <span class="stringliteral">&quot;wbfBO&quot;</span>);</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a>) sprintf(<a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring, <span class="stringliteral">&quot;wbfHO&quot;</span>);</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160; </div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <a class="code" href="TMCFM_8hh.html#a54213f196c3344b9508ae4cb9eab0ea0">npart_</a>.npart=6;</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz=2; <a class="code" href="TMCFM_8hh.html#a4f6a5b3ceab297482e3ab5f300d8008a">ckmfill_</a>(&amp;(<a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz));</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <a class="code" href="TMCFM_8hh.html#a3b31843cde69d917445902e679909e6e">bveg1_mcfm_</a>.ndim=16;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <a class="code" href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a>.nqcdjets=2;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n2=1;</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n3=1;</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass2 =<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wmass;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width2=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wwidth;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass3 =<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wmass;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width3=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wwidth;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160; </div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: Setup is (production, process)=(&quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a1225a4280a727b6456d225d3493e0e66">TVar::ProductionName</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160; </div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;  }</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="comment">// JJ + VV-&gt;4f</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <span class="comment">// Check for support in qq&#39;H+2J</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    ndau&gt;=4</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    (</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca89a5439f5d7527b48dfb23d3042e8d29">TVar::JJEW</a></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca902db21776e8b4069184189a3d35976a">TVar::JJVBF_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca78112f139715de80da62332b06c94926">TVar::JJEW_S</a></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca100a3d28b2ee4efd9227a4068543848f">TVar::JJVBF_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caf04b7e8e4c0900b0206ceaa88dc50271">TVar::JJEW_TU</a></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    )</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    ((isZZ || isWW) &amp;&amp; (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655">TVar::bkgWWZZ_SMHiggs</a>))</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    ){</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    <span class="comment">// Procsss 226</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160; </div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a>) sprintf(<a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring, <span class="stringliteral">&quot;wbfBO&quot;</span>);</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a>) sprintf(<a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring, <span class="stringliteral">&quot;wbfHO&quot;</span>);</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160; </div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    <a class="code" href="TMCFM_8hh.html#a54213f196c3344b9508ae4cb9eab0ea0">npart_</a>.npart=6;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz=2; <a class="code" href="TMCFM_8hh.html#a4f6a5b3ceab297482e3ab5f300d8008a">ckmfill_</a>(&amp;(<a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz));</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    <a class="code" href="TMCFM_8hh.html#a3b31843cde69d917445902e679909e6e">bveg1_mcfm_</a>.ndim=16;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    <a class="code" href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a>.nqcdjets=2;</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n2=1;</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n3=1;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass2 =<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wmass;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width2=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wwidth;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass3 =<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wmass;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width3=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wwidth;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160; </div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: Setup is (production, process)=(&quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a1225a4280a727b6456d225d3493e0e66">TVar::ProductionName</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160; </div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;  }</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  <span class="comment">// JJ + ZZ-&gt;4f (QCD)</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    ndau&gt;=4</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    (</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a><span class="comment">/* || production == TVar::JJQCD_S || production == TVar::JJQCD_TU*/</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca936aef1ef89c04b5586ccb862544363a">TVar::JJEWQCD</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cada9ae823e21061c18721960aadabee2c">TVar::JJEWQCD_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4c10b0b90ea432d42a32a4ac8a099a1b">TVar::JJEWQCD_TU</a></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    )</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    (isZZ &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a>) <span class="comment">// ME is bkg-only</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    ){</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <span class="comment">// 2201 &#39;  f(p1)+f(p2) --&gt; Z(e-(p3),e^+(p4))Z(mu-(p5),mu+(p6)))+f(p7)+f(p8) [strong]&#39; &#39;L&#39;</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="comment">    NOTE TO DEVELOPER</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<span class="comment">    MCFM also sets common/VVstrong/VVstrong (logical) here, but it only controls which ww_ZZqq function is called.</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;<span class="comment">    It is irrelevant as long as eventgeneration through lowint is not used directly through MELA.</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <a class="code" href="TMCFM_8hh.html#a54213f196c3344b9508ae4cb9eab0ea0">npart_</a>.npart=6;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz=2; <a class="code" href="TMCFM_8hh.html#a4f6a5b3ceab297482e3ab5f300d8008a">ckmfill_</a>(&amp;(<a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz));</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <a class="code" href="TMCFM_8hh.html#a3b31843cde69d917445902e679909e6e">bveg1_mcfm_</a>.ndim=16;</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <a class="code" href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a>.nqcdjets=2;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n2=1;</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n3=1;</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass2 =<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zmass;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width2=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zwidth;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass3 =<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zmass;</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width3=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.zwidth;</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160; </div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <a class="code" href="TMCFM_8hh.html#a1e72dbf082de5b3d5b384a09a1c83d75">vsymfact_</a>.vsymfact=1.0;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    <a class="code" href="TMCFM_8hh.html#af8cdb99be9a8b3fc5881cc93f0e4b6cd">interference_</a>.interference=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="keywordflow">if</span> (hasZZ4fInterf &amp;&amp; (leptonInterf==<a class="code" href="namespaceTVar.html#a2599e53f6f03e850b83dd83d6c296feca92cbe92f4215368249033082e6671aa6">TVar::DefaultLeptonInterf</a> || leptonInterf==<a class="code" href="namespaceTVar.html#a2599e53f6f03e850b83dd83d6c296feca45bd1efd7db2e2687aa602c8a5d1b890">TVar::InterfOn</a>)){</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      <a class="code" href="TMCFM_8hh.html#a1e72dbf082de5b3d5b384a09a1c83d75">vsymfact_</a>.vsymfact=0.5;</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;      <a class="code" href="TMCFM_8hh.html#af8cdb99be9a8b3fc5881cc93f0e4b6cd">interference_</a>.interference=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    }</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160; </div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: Setup is (production, process)=(&quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a1225a4280a727b6456d225d3493e0e66">TVar::ProductionName</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160; </div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  }</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    <span class="comment">// JJ + WW-&gt;4f (QCD)</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    ndau&gt;=4</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    (</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a><span class="comment">/* || production == TVar::JJQCD_S || production == TVar::JJQCD_TU*/</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca936aef1ef89c04b5586ccb862544363a">TVar::JJEWQCD</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cada9ae823e21061c18721960aadabee2c">TVar::JJEWQCD_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4c10b0b90ea432d42a32a4ac8a099a1b">TVar::JJEWQCD_TU</a></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    )</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    (isWW &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a>) <span class="comment">// ME is bkg-only</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    ){</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="comment">// Process 2241</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="comment">    NOTE TO DEVELOPER</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="comment">    MCFM also sets common/VVstrong/VVstrong (logical) here, but it only controls which ww_ZZqq function is called.</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;<span class="comment">    It is irrelevant as long as eventgeneration through lowint is not used directly through MELA.</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <a class="code" href="TMCFM_8hh.html#a54213f196c3344b9508ae4cb9eab0ea0">npart_</a>.npart=6;</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz=2; <a class="code" href="TMCFM_8hh.html#a4f6a5b3ceab297482e3ab5f300d8008a">ckmfill_</a>(&amp;(<a class="code" href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a>.nwz));</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <a class="code" href="TMCFM_8hh.html#a3b31843cde69d917445902e679909e6e">bveg1_mcfm_</a>.ndim=16;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <a class="code" href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a>.nqcdjets=2;</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n2=1;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.n3=1;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass2 =<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wmass;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width2=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wwidth;</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.mass3 =<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wmass;</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    <a class="code" href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a>.width3=<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.wwidth;</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160; </div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: Setup is (production, process)=(&quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a1225a4280a727b6456d225d3493e0e66">TVar::ProductionName</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160; </div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  }</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <span class="comment">// JJ + VV-&gt;4f (QCD)</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;    ndau&gt;=4</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    (</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a><span class="comment">/* || production == TVar::JJQCD_S || production == TVar::JJQCD_TU*/</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca936aef1ef89c04b5586ccb862544363a">TVar::JJEWQCD</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cada9ae823e21061c18721960aadabee2c">TVar::JJEWQCD_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4c10b0b90ea432d42a32a4ac8a099a1b">TVar::JJEWQCD_TU</a></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    )</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    ((isZZ || isWW) &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a>)</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    ){</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    <span class="comment">// Procsss 2261 (not supported yet)</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: MCFM does not support QCD JJ+VV-&gt;4f interaction yet. Please contact the MELA authors if you need more information.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160; </div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  }</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: Can&#39;t identify (process, production) = (&quot;</span> &lt;&lt; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: ndau: &quot;</span> &lt;&lt; ndau &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: isZZ: &quot;</span> &lt;&lt; isZZ &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: isWW: &quot;</span> &lt;&lt; isWW &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_chooser: isGG: &quot;</span> &lt;&lt; isGG &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; endl;</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;  }</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160; </div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;  <span class="keyword">delete</span>[] pId;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;}</div>
<div class="line"><a name="l02227"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a886fd38c76f045c4d516492ecf1cb0ce"> 2227</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceTUtil.html#a886fd38c76f045c4d516492ecf1cb0ce">TUtil::MCFM_SetupParticleCouplings</a>(</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1">TVar::Process</a>&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28c">TVar::Production</a>&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>,</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049">TVar::VerbosityLevel</a>&amp; verbosity,</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;  <span class="keyword">const</span> <a class="code" href="structTVar_1_1simple__event__record.html">simple_event_record</a>&amp; mela_event,</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;  std::vector&lt;int&gt;* partOrder, std::vector&lt;int&gt;* apartOrder</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;  ){</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;  <span class="keywordtype">bool</span> result=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160; </div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;  <span class="comment">// Initialize Z couplings</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;  <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.q1=0;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;  <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l1=0;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;  <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r1=0;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;  <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.q2=0;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;  <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l2=0;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;  <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r2=0;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160; </div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;  <span class="comment">// Initialize plabels</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;  TString strplabel[<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>];</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) strplabel[ip]=<span class="stringliteral">&quot;  &quot;</span>;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160; </div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;  <span class="comment">// Channel checks</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ndau = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size();</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  <span class="keywordflow">if</span> (ndau&lt;1) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> napart = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.size();</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  <span class="keywordtype">bool</span> isWW = (ndau&gt;=4 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1)));</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;  <span class="keywordtype">bool</span> isZZ = (ndau&gt;=4 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1)));</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;  <span class="comment">//bool hasZZ4fInterf = isZZ &amp;&amp; abs(pId[0])==abs(pId[2]) &amp;&amp; abs(pId[1])==abs(pId[3]) &amp;&amp; !PDGHelpers::isAnUnknownJet(pId[0]) &amp;&amp; !PDGHelpers::isAnUnknownJet(pId[3]);</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;  <span class="keywordtype">bool</span> isZJJ = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;  <span class="keywordflow">if</span> (ndau&gt;=4) isZJJ = <a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)); <span class="comment">// No check on whether daughters 2 and 3 are jets. Notice both isZZ and isZJJ could be true</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ndau==2 &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad2933b84082d269af9a836d4646aeefd">TVar::bkgZJets</a>){ <span class="comment">// Check whether the two daughters can create a Z</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    isZJJ = (</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;      <a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(<a class="code" href="namespacePDGHelpers.html#a524d028bd6c958101639b40c8bfc5622">PDGHelpers::getCoupledVertex</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0), mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1)))</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;      ||</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;      ((<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)) || <a class="code" href="namespacePDGHelpers.html#a01f8690aaafe2c1d9b2497a41270f56a">PDGHelpers::isAQuark</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0))) &amp;&amp; (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1)) || <a class="code" href="namespacePDGHelpers.html#a01f8690aaafe2c1d9b2497a41270f56a">PDGHelpers::isAQuark</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1))))</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;      );</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;  }</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;  <span class="keywordtype">bool</span> isZG = (ndau&gt;=3 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1)));</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;  <span class="keywordtype">bool</span> isGG = (ndau&gt;=2 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1)));</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;  <span class="keywordtype">bool</span> hasZ1 = (isZZ || isZG || isZJJ);</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;  <span class="keywordtype">bool</span> hasZ2 = isZZ;</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;  <span class="keywordtype">bool</span> hasW1 = isWW;</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;  <span class="keywordtype">bool</span> hasW2 = isWW;</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_SetupParticleCouplings(&quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a1225a4280a727b6456d225d3493e0e66">TVar::ProductionName</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>) &lt;&lt; <span class="stringliteral">&quot;):\nInitial configuration &quot;</span>;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    vector&lt;TString&gt; strcfgs;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    <span class="keywordflow">if</span> (isGG) strcfgs.push_back(TString(<span class="stringliteral">&quot;GG&quot;</span>));</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    <span class="keywordflow">if</span> (isZG) strcfgs.push_back(TString(<span class="stringliteral">&quot;ZG&quot;</span>));</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    <span class="keywordflow">if</span> (isZZ) strcfgs.push_back(TString(<span class="stringliteral">&quot;ZZ&quot;</span>));</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    <span class="keywordflow">if</span> (isZJJ) strcfgs.push_back(TString(<span class="stringliteral">&quot;ZJJ&quot;</span>));</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    <span class="keywordflow">if</span> (isWW) strcfgs.push_back(TString(<span class="stringliteral">&quot;WW&quot;</span>));</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;    <span class="keywordflow">if</span> (!strcfgs.empty()){</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;is &quot;</span>;</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> istr=0; istr&lt;strcfgs.size(); istr++){</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        <span class="keywordflow">if</span> (istr==0) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; strcfgs.at(istr);</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;        <span class="keywordflow">else</span> <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; strcfgs.at(istr);</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;      }</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    }</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;has no valid decay!&quot;</span>;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;  }</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160; </div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;  <span class="comment">// Setup the ordering arrays</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;  <span class="keywordtype">int</span>* pApartOrder = 0;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;  <span class="keywordtype">int</span>* pApartId = 0;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  <span class="keywordflow">if</span> (napart&gt;0){</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    pApartOrder = <span class="keyword">new</span> <span class="keywordtype">int</span>[napart];</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    pApartId = <span class="keyword">new</span> <span class="keywordtype">int</span>[napart];</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;napart; ip++){</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;      pApartOrder[ip]=ip; <span class="comment">// This order USUALLY does not change!</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;      pApartId[ip]=mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.at(ip).first; <span class="comment">// This order does not change.</span></div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    }</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;  }</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;  <span class="keywordtype">int</span>* pOrder = <span class="keyword">new</span> <span class="keywordtype">int</span>[ndau];</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;  <span class="keywordtype">int</span>* pZOrder = <span class="keyword">new</span> <span class="keywordtype">int</span>[ndau];</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  <span class="keywordtype">int</span>* pWOrder = <span class="keyword">new</span> <span class="keywordtype">int</span>[ndau];</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;  <span class="keywordtype">int</span>* pId = <span class="keyword">new</span> <span class="keywordtype">int</span>[ndau];</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;ndau; ip++){</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    pOrder[ip]=ip; <span class="comment">// This order does not change</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    pZOrder[ip]=ip;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    pWOrder[ip]=ip;</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    pId[ip]=mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.at(ip).first; <span class="comment">// This order does not change.</span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;  }</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160; </div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;  <span class="comment">// Special case checks</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  <span class="keywordtype">bool</span> useQQBZGAM = (isZG &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a2f26259ffb9387326573b0b1c4f2c700">TVar::bkgZGamma</a> &amp;&amp; (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a>));</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;  <span class="keywordtype">bool</span> useQQVVQQ =</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    (</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    ((isZZ &amp;&amp; (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4cc74ca92572b408de0ce370a51f64e5">TVar::bkgZZ_SMHiggs</a>))</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    || (isWW &amp;&amp; (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ac616ffacd90b7e38f875512989d62e5d">TVar::bkgWW_SMHiggs</a>))</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    || ((isZZ || isWW) &amp;&amp; (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655">TVar::bkgWWZZ_SMHiggs</a>)))</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a></div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a></div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca89a5439f5d7527b48dfb23d3042e8d29">TVar::JJEW</a></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca902db21776e8b4069184189a3d35976a">TVar::JJVBF_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca78112f139715de80da62332b06c94926">TVar::JJEW_S</a></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca100a3d28b2ee4efd9227a4068543848f">TVar::JJVBF_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caf04b7e8e4c0900b0206ceaa88dc50271">TVar::JJEW_TU</a>)</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    );</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;  <span class="keywordtype">bool</span> useQQVVQQstrong =</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    (</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    ((isZZ &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a>) || (isWW &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a>) || ((isZZ || isWW) &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a>))</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac09ee14d8ad516b27397f28eee642c62">TVar::JJQCD_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca832b9995c64912826d4e5f60e86f35ed">TVar::JJQCD_TU</a>)</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    );</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;  <span class="keywordtype">bool</span> useQQVVQQboth =</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    (</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    ((isZZ &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a>) || (isWW &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a>) || ((isZZ || isWW) &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a>))</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca936aef1ef89c04b5586ccb862544363a">TVar::JJEWQCD</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cada9ae823e21061c18721960aadabee2c">TVar::JJEWQCD_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4c10b0b90ea432d42a32a4ac8a099a1b">TVar::JJEWQCD_TU</a>)</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    );</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;  <span class="keywordtype">bool</span> useQQVVQQany = useQQVVQQ || useQQVVQQstrong || useQQVVQQboth;</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160; </div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="comment">  /**************************/</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;  <span class="comment">/* Begin the setup checks */</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;<span class="comment">  /**************************/</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;  <span class="comment">// Check first if the decay mode is valid and the number of associated particles is consistent with the requested number</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    !(isWW || isZZ || isZJJ || isZG || isGG) <span class="comment">// Only ZZ, WW, ZG or GG supported in MCFM</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    ||</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;    ((<a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>)napart&lt;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aca54cfc4690b7f0ba78f5af03d0f1ddf">nRequested_AssociatedJets</a>+mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a3051f9440dc00a0a74b80997e898a5f5">nRequested_AssociatedLeptons</a>)) <span class="comment">// Associated particle not found</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    ) result=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160; </div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    <span class="keywordflow">if</span> (isWW &amp;&amp; !hasZ1 &amp;&amp; !hasZ2){</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;      <span class="comment">// Default swap is 3-5</span></div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;      <span class="comment">// For ggVV amplitudes, MCFM generates W+W- and does 3-5 swap inside the ME, so by definition, this is ok.</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;      <span class="comment">// For VBFWW amplitudes, MCFM generates W-W+ in the phase space and does a 4-6 swap before passing to the ME. The ordering here is W+W-, so this is equivalent to doing a 3-5 swap to get the corresponding ZZ-like combinations.</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;      swap(pZOrder[0], pZOrder[2]);</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160; </div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;      <span class="keywordtype">int</span> V1id, V2id;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pId[pZOrder[0]]) &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pId[pZOrder[1]])) V1id = <a class="code" href="namespacePDGHelpers.html#a524d028bd6c958101639b40c8bfc5622">PDGHelpers::getCoupledVertex</a>(pId[pZOrder[0]], pId[pZOrder[1]]);</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      <span class="keywordflow">else</span> V1id = 23;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pId[pZOrder[2]]) &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pId[pZOrder[3]])) V2id = <a class="code" href="namespacePDGHelpers.html#a524d028bd6c958101639b40c8bfc5622">PDGHelpers::getCoupledVertex</a>(pId[pZOrder[2]], pId[pZOrder[3]]);</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;      <span class="keywordflow">else</span> V2id = 23;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      hasZ1=hasZ1 || <a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(V1id);</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;      hasZ2=hasZ2 || <a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(V2id);</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      <span class="keywordflow">if</span> (!hasZ1 &amp;&amp; hasZ2){</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;        swap(pZOrder[0], pZOrder[2]);</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;        swap(pZOrder[1], pZOrder[3]);</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;        swap(hasZ1, hasZ2);</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;      }</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;      <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;        <span class="keywordflow">if</span> (hasZ1) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_SetupParticleCouplings: Found a Z1&quot;</span>;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;        <span class="keywordflow">if</span> (hasZ2) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot; and a Z2&quot;</span>;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;        <span class="keywordflow">if</span> (hasZ1 || hasZ2) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot; in WW.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;      }</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    }</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    <span class="keywordflow">if</span> (isZZ &amp;&amp; !hasW1 &amp;&amp; !hasW2){</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;      swap(pWOrder[0], pWOrder[2]);</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160; </div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;      <span class="keywordtype">int</span> V1id, V2id;</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pId[pWOrder[0]]) &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pId[pWOrder[1]])) V1id = <a class="code" href="namespacePDGHelpers.html#a524d028bd6c958101639b40c8bfc5622">PDGHelpers::getCoupledVertex</a>(pId[pWOrder[0]], pId[pWOrder[1]]);</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;      <span class="keywordflow">else</span> V1id = 24;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pId[pWOrder[2]]) &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pId[pWOrder[3]])) V2id = <a class="code" href="namespacePDGHelpers.html#a524d028bd6c958101639b40c8bfc5622">PDGHelpers::getCoupledVertex</a>(pId[pWOrder[2]], pId[pWOrder[3]]);</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;      <span class="keywordflow">else</span> V2id = -24;</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(V1id) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(V2id)){</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;        <span class="keywordflow">if</span> (V1id&lt;0 || V2id&gt;0){</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;          swap(pWOrder[0], pWOrder[2]);</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;          swap(pWOrder[1], pWOrder[3]);</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;        }</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;        hasW1=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;        hasW2=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;      }</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;      <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        <span class="keywordflow">if</span> (hasW1) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_SetupParticleCouplings: Found a W1(&quot;</span> &lt;&lt; V1id &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;        <span class="keywordflow">if</span> (hasW2) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot; and a W2(&quot;</span> &lt;&lt; V2id &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;        <span class="keywordflow">if</span> (hasW1 || hasW2) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot; in ZZ.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;      }</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    }</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160; </div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;<span class="comment">    /*******************/</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    <span class="comment">/* Particle labels */</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;<span class="comment">    /*******************/</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    <span class="comment">// Mother particles</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    <span class="comment">// Default labels for most processes</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    strplabel[0]=<span class="stringliteral">&quot;pp&quot;</span>;</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    strplabel[1]=<span class="stringliteral">&quot;pp&quot;</span>;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    <span class="keywordflow">if</span> (useQQVVQQany){ <span class="comment">// Special case if using qqZZ/VVqq*</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;      <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_SetupParticleCouplings: Setting up mother labels for MCFM:&quot;</span>;</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;min(2, (<span class="keywordtype">int</span>)mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.size()); ip++){</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; idmot = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ip).first;</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(idmot)) strplabel[ip]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(idmot, <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;        <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; idmot &lt;&lt; <span class="stringliteral">&quot;=&quot;</span> &lt;&lt; strplabel[ip];</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;        <span class="comment">// No need to check unknown parton case, already &quot;pp&quot;</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;      }</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;      <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    }</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160; </div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <span class="comment">// Decay and associated particles</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    <span class="comment">// 0-jet processes, set only decay labels (and plabel[5/6]=pp due to NLO stuff)</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    <span class="keywordflow">if</span> (isZJJ &amp;&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a> &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad2933b84082d269af9a836d4646aeefd">TVar::bkgZJets</a>){</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;      strplabel[2]=<span class="stringliteral">&quot;el&quot;</span>;</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;      strplabel[3]=<span class="stringliteral">&quot;ea&quot;</span>;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;      strplabel[4]=<span class="stringliteral">&quot;pp&quot;</span>;</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;      strplabel[5]=<span class="stringliteral">&quot;pp&quot;</span>;</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;      strplabel[6]=<span class="stringliteral">&quot;pp&quot;</span>;</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    }</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4539519c2d018fd29228bdd605c76c47">TVar::ZZGG</a> &amp;&amp; (</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;      (isWW &amp;&amp; (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ac616ffacd90b7e38f875512989d62e5d">TVar::bkgWW_SMHiggs</a>))</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;      ||</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;      ((isWW || isZZ) &amp;&amp; (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655">TVar::bkgWWZZ_SMHiggs</a>))</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;      )</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;      ){</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;      strplabel[2]=<span class="stringliteral">&quot;el&quot;</span>;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;      strplabel[3]=<span class="stringliteral">&quot;ea&quot;</span>;</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;      strplabel[4]=<span class="stringliteral">&quot;nl&quot;</span>;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;      strplabel[5]=<span class="stringliteral">&quot;na&quot;</span>;</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;      strplabel[6]=<span class="stringliteral">&quot;pp&quot;</span>;</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160; </div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;      <span class="keywordtype">string</span> strrun = <a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring;</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;      <span class="keywordflow">if</span> (isWW &amp;&amp; ((!hasZ1 || !hasZ2) || (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ac616ffacd90b7e38f875512989d62e5d">TVar::bkgWW_SMHiggs</a>))) strrun += <span class="stringliteral">&quot;_ww&quot;</span>;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isZZ &amp;&amp; (!hasW1 || !hasW2)) strrun += <span class="stringliteral">&quot;_zz&quot;</span>;</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;      sprintf(<a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring, strrun.c_str());</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    }</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isZG &amp;&amp; (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a>) &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a2f26259ffb9387326573b0b1c4f2c700">TVar::bkgZGamma</a>){</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;      <a class="code" href="TMCFM_8hh.html#aef44b17288a914b738c4fbdf55d64dbb">lastphot_</a>.lastphot=5;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      strplabel[4]=<span class="stringliteral">&quot;ga&quot;</span>;</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;      strplabel[5]=<span class="stringliteral">&quot;pp&quot;</span>;</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    }</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isGG &amp;&amp; (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4539519c2d018fd29228bdd605c76c47">TVar::ZZGG</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a>) &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4baafc289948916b0b531aa85e8f896f">TVar::bkgGammaGamma</a>){</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;      <span class="comment">//lastphot_.lastphot=4; // Done in chooser</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;      strplabel[2]=<span class="stringliteral">&quot;ga&quot;</span>;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;      strplabel[3]=<span class="stringliteral">&quot;ga&quot;</span>;</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;      strplabel[4]=<span class="stringliteral">&quot;pp&quot;</span>;</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    }</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isWW &amp;&amp; (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a>) &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a>){</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;      strplabel[6]=<span class="stringliteral">&quot;pp&quot;</span>;</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;      <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l1=1.;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160; </div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a68ffb179226737e2006fb7b0870dae6a">PDGHelpers::isANeutrino</a>(pId[pWOrder[0]])){</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;        strplabel[2]=<span class="stringliteral">&quot;nl&quot;</span>;</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;        strplabel[3]=<span class="stringliteral">&quot;ea&quot;</span>;</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;      }</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(pId[pWOrder[1]])){</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;        strplabel[2]=<span class="stringliteral">&quot;qj&quot;</span>;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;        strplabel[3]=<span class="stringliteral">&quot;qj&quot;</span>;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;        <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l1 *= sqrt(6.);</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;        <a class="code" href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a>.nqcdjets += 2;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;      }</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      <span class="keywordflow">else</span> result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160; </div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a68ffb179226737e2006fb7b0870dae6a">PDGHelpers::isANeutrino</a>(pId[pWOrder[3]])){</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;        strplabel[4]=<span class="stringliteral">&quot;el&quot;</span>;</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;        strplabel[5]=<span class="stringliteral">&quot;na&quot;</span>;</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;      }</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(pId[pWOrder[3]])){</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;        strplabel[4]=<span class="stringliteral">&quot;qj&quot;</span>;</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;        strplabel[5]=<span class="stringliteral">&quot;qj&quot;</span>;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;        <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l1 *= sqrt(6.);</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;        <a class="code" href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a>.nqcdjets += 2;</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;      }</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;      <span class="keywordflow">else</span> result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(pId[pWOrder[0]]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(pId[pWOrder[3]])) result = <span class="keyword">false</span>; <span class="comment">// MCFM does not support WW-&gt;4q</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    }</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    <span class="comment">// 2-jet processes</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    <span class="comment">// Most of the associated particle labels are set below</span></div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    <span class="comment">// VH productions loop over all possible associated particles to assign V daughters as the first two particles in particle-antiparticle order</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((isWW || isZZ) &amp;&amp; napart&gt;=2 &amp;&amp; (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a>)){</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.channeltoggle_stu = <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a>)*2 + <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a>)*1 + <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a>)*0;</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.vvhvvtoggle_vbfvh = 1;</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160; </div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655">TVar::bkgWWZZ_SMHiggs</a>){</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;        <span class="keywordtype">string</span> strrun = <a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring;</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        <span class="keywordflow">if</span> (isWW &amp;&amp; (!hasZ1 || !hasZ2)) strrun += <span class="stringliteral">&quot;_ww&quot;</span>;</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isZZ &amp;&amp; (!hasW1 || !hasW2)) strrun += <span class="stringliteral">&quot;_zz&quot;</span>;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;        sprintf(<a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring, strrun.c_str());</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;      }</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160; </div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;      <span class="keywordtype">bool</span> hasZll=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;      <span class="keywordtype">bool</span> hasZnn=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;napart; ix++){</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(pApartId[ix])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iy=ix+1; iy&lt;napart; iy++){</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(pApartId[iy])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;          <span class="keywordtype">int</span> Vid = <a class="code" href="namespacePDGHelpers.html#a524d028bd6c958101639b40c8bfc5622">PDGHelpers::getCoupledVertex</a>(pApartId[ix], pApartId[iy]);</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(Vid) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a6f98f45dbd53233287193ec3fe987746">PDGHelpers::isALepton</a>(pApartId[ix])){</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;            <span class="keywordtype">int</span> i1=ix; <span class="keywordtype">int</span> i2=iy;</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;            <span class="keywordflow">if</span> (pApartId[ix]&lt;0){ swap(i1, i2); }</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;            <span class="keywordtype">int</span>* tmpOrder = <span class="keyword">new</span> <span class="keywordtype">int</span>[napart];</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;            tmpOrder[0] = i1; tmpOrder[1] = i2;</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctr=2;</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipart=0; ipart&lt;napart; ipart++){ <span class="keywordflow">if</span> (ctr&lt;napart &amp;&amp; pApartOrder[ipart]!=i1 &amp;&amp; pApartOrder[ipart]!=i2){ tmpOrder[ctr] = pApartOrder[ipart]; ctr++; } }</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;            <span class="keyword">delete</span>[] pApartOrder; pApartOrder = tmpOrder;</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;            hasZll=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;          }</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(Vid) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a68ffb179226737e2006fb7b0870dae6a">PDGHelpers::isANeutrino</a>(pApartId[ix])){</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;            <span class="keywordtype">int</span> i1=ix; <span class="keywordtype">int</span> i2=iy;</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;            <span class="keywordflow">if</span> (pApartId[ix]&lt;0){ swap(i1, i2); }</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;            <span class="keywordtype">int</span>* tmpOrder = <span class="keyword">new</span> <span class="keywordtype">int</span>[napart];</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;            tmpOrder[0] = i1; tmpOrder[1] = i2;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctr=2;</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipart=0; ipart&lt;napart; ipart++){ <span class="keywordflow">if</span> (ctr&lt;napart &amp;&amp; pApartOrder[ipart]!=i1 &amp;&amp; pApartOrder[ipart]!=i2){ tmpOrder[ctr] = pApartOrder[ipart]; ctr++; } }</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;            <span class="keyword">delete</span>[] pApartOrder; pApartOrder = tmpOrder;</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;            hasZnn=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;          }</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;          <span class="keywordflow">if</span> (hasZll || hasZnn) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;        }</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      }</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iout=6;</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jout=7;</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;      <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        <span class="keywordtype">int</span> qqvvqq_apartordering[2]={ -1, -1 };</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        <a class="code" href="namespaceTMCFMUtils.html#aef81a55fd97ffadcaabc57015b59e4ee">TMCFMUtils::AssociatedParticleOrdering_QQVVQQAny</a>(</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;          mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(0).first, mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(1).first,</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;          pApartId[pApartOrder[0]], pApartId[pApartOrder[1]],</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;          qqvvqq_apartordering</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;          );</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        <span class="keywordflow">if</span> (qqvvqq_apartordering[0]==-1 || qqvvqq_apartordering[1]==-1) result=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (qqvvqq_apartordering[0]&gt;qqvvqq_apartordering[1]){</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;          swap(iout, jout);</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;          swap(pApartOrder[0], pApartOrder[1]);</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;        }</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;      }</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;      <span class="keywordflow">if</span> (hasZll){</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;        strplabel[iout]=<span class="stringliteral">&quot;el&quot;</span>;</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;        strplabel[jout]=<span class="stringliteral">&quot;ea&quot;</span>;</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;      }</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hasZnn){</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;        strplabel[iout]=<span class="stringliteral">&quot;nl&quot;</span>;</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;        strplabel[jout]=<span class="stringliteral">&quot;na&quot;</span>;</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;      }</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;      <span class="keywordflow">else</span> result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    }</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((isWW || isZZ) &amp;&amp; napart&gt;=2 &amp;&amp; (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a>)){</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.channeltoggle_stu = <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a>)*2 + <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a>)*1 + <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a>)*0;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.vvhvvtoggle_vbfvh = 1;</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160; </div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655">TVar::bkgWWZZ_SMHiggs</a>){</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        <span class="keywordtype">string</span> strrun = <a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring;</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;        <span class="keywordflow">if</span> (isWW &amp;&amp; (!hasZ1 || !hasZ2)) strrun += <span class="stringliteral">&quot;_ww&quot;</span>;</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isZZ &amp;&amp; (!hasW1 || !hasW2)) strrun += <span class="stringliteral">&quot;_zz&quot;</span>;</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        sprintf(<a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring, strrun.c_str());</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;      }</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160; </div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;      <span class="keywordtype">bool</span> hasWplus=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;      <span class="keywordtype">bool</span> hasWminus=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;napart; ix++){</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(pApartId[ix])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iy=ix+1; iy&lt;napart; iy++){</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(pApartId[iy])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;          <span class="keywordtype">int</span> Vid = <a class="code" href="namespacePDGHelpers.html#a524d028bd6c958101639b40c8bfc5622">PDGHelpers::getCoupledVertex</a>(pApartId[ix], pApartId[iy]);</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;            <a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(Vid)</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;            (</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;            (<a class="code" href="namespacePDGHelpers.html#a6f98f45dbd53233287193ec3fe987746">PDGHelpers::isALepton</a>(pApartId[ix]) &amp;&amp; pApartId[ix]&lt;0)</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;            ||</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;            (<a class="code" href="namespacePDGHelpers.html#a6f98f45dbd53233287193ec3fe987746">PDGHelpers::isALepton</a>(pApartId[iy]) &amp;&amp; pApartId[iy]&lt;0)</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;            )</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;            ){</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;            <span class="keywordtype">int</span> i1=ix; <span class="keywordtype">int</span> i2=iy;</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;            <span class="keywordflow">if</span> (pApartId[ix]&lt;0){ swap(i1, i2); }</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;            <span class="keywordtype">int</span>* tmpOrder = <span class="keyword">new</span> <span class="keywordtype">int</span>[napart];</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;            tmpOrder[0] = i1; tmpOrder[1] = i2;</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctr=2;</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipart=0; ipart&lt;napart; ipart++){ <span class="keywordflow">if</span> (ctr&lt;napart &amp;&amp; pApartOrder[ipart]!=i1 &amp;&amp; pApartOrder[ipart]!=i2){ tmpOrder[ctr] = pApartOrder[ipart]; ctr++; } }</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;            <span class="keyword">delete</span>[] pApartOrder; pApartOrder = tmpOrder;</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;            hasWplus=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;          }</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;            <a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(Vid)</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;            (</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;            (<a class="code" href="namespacePDGHelpers.html#a6f98f45dbd53233287193ec3fe987746">PDGHelpers::isALepton</a>(pApartId[ix]) &amp;&amp; pApartId[ix]&gt;0)</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;            ||</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;            (<a class="code" href="namespacePDGHelpers.html#a6f98f45dbd53233287193ec3fe987746">PDGHelpers::isALepton</a>(pApartId[iy]) &amp;&amp; pApartId[iy]&gt;0)</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;            )</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;            ){</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;            <span class="keywordtype">int</span> i1=ix; <span class="keywordtype">int</span> i2=iy;</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;            <span class="keywordflow">if</span> (pApartId[ix]&lt;0){ swap(i1, i2); }</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;            <span class="keywordtype">int</span>* tmpOrder = <span class="keyword">new</span> <span class="keywordtype">int</span>[napart];</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;            tmpOrder[0] = i1; tmpOrder[1] = i2;</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctr=2;</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipart=0; ipart&lt;napart; ipart++){ <span class="keywordflow">if</span> (ctr&lt;napart &amp;&amp; pApartOrder[ipart]!=i1 &amp;&amp; pApartOrder[ipart]!=i2){ tmpOrder[ctr] = pApartOrder[ipart]; ctr++; } }</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;            <span class="keyword">delete</span>[] pApartOrder; pApartOrder = tmpOrder;</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;            hasWminus=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;          }</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;        }</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;        <span class="keywordflow">if</span> (hasWplus || hasWminus) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;      }</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iout=6;</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jout=7;</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;      <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;        <span class="keywordtype">int</span> qqvvqq_apartordering[2]={ -1, -1 };</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;        <a class="code" href="namespaceTMCFMUtils.html#aef81a55fd97ffadcaabc57015b59e4ee">TMCFMUtils::AssociatedParticleOrdering_QQVVQQAny</a>(</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;          mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(0).first, mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(1).first,</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;          pApartId[pApartOrder[0]], pApartId[pApartOrder[1]],</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;          qqvvqq_apartordering</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;          );</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;        <span class="keywordflow">if</span> (qqvvqq_apartordering[0]==-1 || qqvvqq_apartordering[1]==-1) result=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (qqvvqq_apartordering[0]&gt;qqvvqq_apartordering[1]){</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;          swap(iout, jout);</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;          swap(pApartOrder[0], pApartOrder[1]);</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;        }</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;      }</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;      <span class="keywordflow">if</span> (hasWplus){ <span class="comment">// W+</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;        strplabel[iout]=<span class="stringliteral">&quot;nl&quot;</span>;</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;        strplabel[jout]=<span class="stringliteral">&quot;ea&quot;</span>;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;      }</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hasWminus){ <span class="comment">// W-</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;        strplabel[iout]=<span class="stringliteral">&quot;el&quot;</span>;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;        strplabel[jout]=<span class="stringliteral">&quot;na&quot;</span>;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;      }</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;      <span class="keywordflow">else</span> result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    }</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((isWW || isZZ) &amp;&amp; napart&gt;=2 &amp;&amp; (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a>)){</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.channeltoggle_stu = <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a>)*2 + <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a>)*1 + <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a>)*0;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.vvhvvtoggle_vbfvh = 1;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160; </div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655">TVar::bkgWWZZ_SMHiggs</a>){</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;        <span class="keywordtype">string</span> strrun = <a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring;</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        <span class="keywordflow">if</span> (isWW &amp;&amp; (!hasZ1 || !hasZ2)) strrun += <span class="stringliteral">&quot;_ww&quot;</span>;</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isZZ &amp;&amp; (!hasW1 || !hasW2)) strrun += <span class="stringliteral">&quot;_zz&quot;</span>;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;        sprintf(<a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring, strrun.c_str());</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;      }</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160; </div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;      <span class="keywordtype">bool</span> hasZuu=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;      <span class="keywordtype">bool</span> hasZdd=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;      <span class="keywordtype">bool</span> hasZjj=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;napart; ix++){</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(pApartId[ix])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iy=ix+1; iy&lt;napart; iy++){</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(pApartId[iy])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;          <span class="keywordtype">int</span> Vid;</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pApartId[ix]) &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pApartId[iy])) Vid = <a class="code" href="namespacePDGHelpers.html#a524d028bd6c958101639b40c8bfc5622">PDGHelpers::getCoupledVertex</a>(pApartId[ix], pApartId[iy]);</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;          <span class="keywordflow">else</span> Vid = 23;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(Vid) &amp;&amp; (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(pApartId[ix]) || <a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(pApartId[iy]))){</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;            <span class="keywordtype">int</span> i1=ix; <span class="keywordtype">int</span> i2=iy;</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;            <span class="keywordflow">if</span> (pApartId[ix]&lt;0 || pApartId[iy]&gt;0){ swap(i1, i2); }</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;            <span class="keywordtype">int</span>* tmpOrder = <span class="keyword">new</span> <span class="keywordtype">int</span>[napart];</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;            tmpOrder[0] = i1; tmpOrder[1] = i2;</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctr=2;</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipart=0; ipart&lt;napart; ipart++){ <span class="keywordflow">if</span> (ctr&lt;napart &amp;&amp; pApartOrder[ipart]!=i1 &amp;&amp; pApartOrder[ipart]!=i2){ tmpOrder[ctr] = pApartOrder[ipart]; ctr++; } }</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;            <span class="keyword">delete</span>[] pApartOrder; pApartOrder = tmpOrder;</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;            hasZuu=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;          }</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(Vid) &amp;&amp; (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(pApartId[ix]) || <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(pApartId[iy]))){</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;            <span class="keywordtype">int</span> i1=ix; <span class="keywordtype">int</span> i2=iy;</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;            <span class="keywordflow">if</span> (pApartId[ix]&lt;0 || pApartId[iy]&gt;0){ swap(i1, i2); }</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;            <span class="keywordtype">int</span>* tmpOrder = <span class="keyword">new</span> <span class="keywordtype">int</span>[napart];</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;            tmpOrder[0] = i1; tmpOrder[1] = i2;</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctr=2;</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipart=0; ipart&lt;napart; ipart++){ <span class="keywordflow">if</span> (ctr&lt;napart &amp;&amp; pApartOrder[ipart]!=i1 &amp;&amp; pApartOrder[ipart]!=i2){ tmpOrder[ctr] = pApartOrder[ipart]; ctr++; } }</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;            <span class="keyword">delete</span>[] pApartOrder; pApartOrder = tmpOrder;</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;            hasZdd=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;          }</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(Vid)){</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;            <span class="keywordtype">int</span> i1=ix; <span class="keywordtype">int</span> i2=iy;</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;            <span class="keywordtype">int</span>* tmpOrder = <span class="keyword">new</span> <span class="keywordtype">int</span>[napart];</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;            tmpOrder[0] = i1; tmpOrder[1] = i2;</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctr=2;</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipart=0; ipart&lt;napart; ipart++){ <span class="keywordflow">if</span> (ctr&lt;napart &amp;&amp; pApartOrder[ipart]!=i1 &amp;&amp; pApartOrder[ipart]!=i2){ tmpOrder[ctr] = pApartOrder[ipart]; ctr++; } }</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;            <span class="keyword">delete</span>[] pApartOrder; pApartOrder = tmpOrder;</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;            hasZjj=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;          }</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;          <span class="keywordflow">if</span> (hasZuu || hasZdd || hasZjj) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;        }</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      }</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;      <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;        <span class="keywordtype">int</span> qqvvqq_apartordering[2]={ -1, -1 };</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;        <a class="code" href="namespaceTMCFMUtils.html#aef81a55fd97ffadcaabc57015b59e4ee">TMCFMUtils::AssociatedParticleOrdering_QQVVQQAny</a>(</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;          mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(0).first, mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(1).first,</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;          pApartId[pApartOrder[0]], pApartId[pApartOrder[1]],</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;          qqvvqq_apartordering</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;          );</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;        <span class="keywordflow">if</span> (qqvvqq_apartordering[0]==-1 || qqvvqq_apartordering[1]==-1) result=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (qqvvqq_apartordering[0]&gt;qqvvqq_apartordering[1]) swap(pApartOrder[0], pApartOrder[1]);</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;      }</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;      <span class="keywordflow">if</span> (hasZuu || hasZdd){</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;        strplabel[6]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pApartId[pApartOrder[0]], <span class="keyword">true</span>, useQQVVQQany);</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;        strplabel[7]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pApartId[pApartOrder[1]], <span class="keyword">true</span>, useQQVVQQany);</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;      }</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hasZjj){</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;        strplabel[6]=<span class="stringliteral">&quot;qj&quot;</span>;</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;        strplabel[7]=<span class="stringliteral">&quot;qj&quot;</span>;</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;      }</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;      <span class="keywordflow">else</span> result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    }</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((isWW || isZZ) &amp;&amp; napart&gt;=2 &amp;&amp; (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a>)){</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.channeltoggle_stu = <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a>)*2 + <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a>)*1 + <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a>)*0;</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.vvhvvtoggle_vbfvh = 1;</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160; </div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655">TVar::bkgWWZZ_SMHiggs</a>){</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;        <span class="keywordtype">string</span> strrun = <a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring;</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        <span class="keywordflow">if</span> (isWW &amp;&amp; (!hasZ1 || !hasZ2)) strrun += <span class="stringliteral">&quot;_ww&quot;</span>;</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isZZ &amp;&amp; (!hasW1 || !hasW2)) strrun += <span class="stringliteral">&quot;_zz&quot;</span>;</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;        sprintf(<a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring, strrun.c_str());</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;      }</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160; </div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;      <span class="keywordtype">bool</span> hasWplus=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;      <span class="keywordtype">bool</span> hasWminus=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;      <span class="keywordtype">bool</span> hasWjj=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;napart; ix++){</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(pApartId[ix])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iy=ix+1; iy&lt;napart; iy++){</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(pApartId[iy])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;          <span class="keywordtype">int</span> Vid;</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pApartId[ix]) &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pApartId[iy])) Vid = <a class="code" href="namespacePDGHelpers.html#a524d028bd6c958101639b40c8bfc5622">PDGHelpers::getCoupledVertex</a>(pApartId[ix], pApartId[iy]);</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;            (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(pApartId[ix]) &amp;&amp; pApartId[ix]&lt;0) || (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(pApartId[iy]) &amp;&amp; pApartId[iy]&lt;0) ||</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;            (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(pApartId[ix]) &amp;&amp; pApartId[ix]&gt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(pApartId[iy]) &amp;&amp; pApartId[iy]&gt;0)</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;            ) Vid=-24;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;          <span class="keywordflow">else</span> Vid = 24;</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;            <a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(Vid)</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;            (</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;            ((<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(pApartId[ix]) &amp;&amp; pApartId[ix]&lt;0) || (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(pApartId[iy]) &amp;&amp; pApartId[iy]&gt;0))</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;            ||</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;            ((<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(pApartId[iy]) &amp;&amp; pApartId[iy]&lt;0) || (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(pApartId[ix]) &amp;&amp; pApartId[ix]&gt;0))</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;            )</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;            ){</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;            <span class="keywordtype">int</span> i1=ix; <span class="keywordtype">int</span> i2=iy;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;            <span class="keywordflow">if</span> (pApartId[ix]&lt;0 || pApartId[iy]&gt;0){ swap(i1, i2); }</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;            <span class="keywordtype">int</span>* tmpOrder = <span class="keyword">new</span> <span class="keywordtype">int</span>[napart];</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;            tmpOrder[0] = i1; tmpOrder[1] = i2;</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctr=2;</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipart=0; ipart&lt;napart; ipart++){ <span class="keywordflow">if</span> (ctr&lt;napart &amp;&amp; pApartOrder[ipart]!=i1 &amp;&amp; pApartOrder[ipart]!=i2){ tmpOrder[ctr] = pApartOrder[ipart]; ctr++; } }</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;            <span class="keyword">delete</span>[] pApartOrder; pApartOrder = tmpOrder;</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;            hasWplus=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;          }</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;            <a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(Vid)</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;            (</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;            ((<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(pApartId[ix]) &amp;&amp; pApartId[ix]&gt;0) || (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(pApartId[iy]) &amp;&amp; pApartId[iy]&lt;0))</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;            ||</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;            ((<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(pApartId[iy]) &amp;&amp; pApartId[iy]&gt;0) || (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(pApartId[ix]) &amp;&amp; pApartId[ix]&lt;0))</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;            )</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;            ){</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;            <span class="keywordtype">int</span> i1=ix; <span class="keywordtype">int</span> i2=iy;</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;            <span class="keywordflow">if</span> (pApartId[ix]&lt;0 || pApartId[iy]&gt;0){ swap(i1, i2); }</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;            <span class="keywordtype">int</span>* tmpOrder = <span class="keyword">new</span> <span class="keywordtype">int</span>[napart];</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;            tmpOrder[0] = i1; tmpOrder[1] = i2;</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctr=2;</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipart=0; ipart&lt;napart; ipart++){ <span class="keywordflow">if</span> (ctr&lt;napart &amp;&amp; pApartOrder[ipart]!=i1 &amp;&amp; pApartOrder[ipart]!=i2){ tmpOrder[ctr] = pApartOrder[ipart]; ctr++; } }</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;            <span class="keyword">delete</span>[] pApartOrder; pApartOrder = tmpOrder;</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;            hasWminus=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;          }</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(Vid)){</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;            <span class="keywordtype">int</span> i1=ix; <span class="keywordtype">int</span> i2=iy;</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;            <span class="keywordtype">int</span>* tmpOrder = <span class="keyword">new</span> <span class="keywordtype">int</span>[napart];</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;            tmpOrder[0] = i1; tmpOrder[1] = i2;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctr=2;</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipart=0; ipart&lt;napart; ipart++){ <span class="keywordflow">if</span> (ctr&lt;napart &amp;&amp; pApartOrder[ipart]!=i1 &amp;&amp; pApartOrder[ipart]!=i2){ tmpOrder[ctr] = pApartOrder[ipart]; ctr++; } }</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;            <span class="keyword">delete</span>[] pApartOrder; pApartOrder = tmpOrder;</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;            hasWjj=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;          }</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;        }</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;        <span class="keywordflow">if</span> (hasWplus || hasWminus || hasWjj) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;      }</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;      <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;        <span class="keywordtype">int</span> qqvvqq_apartordering[2]={ -1, -1 };</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;        <a class="code" href="namespaceTMCFMUtils.html#aef81a55fd97ffadcaabc57015b59e4ee">TMCFMUtils::AssociatedParticleOrdering_QQVVQQAny</a>(</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;          mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(0).first, mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(1).first,</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;          pApartId[pApartOrder[0]], pApartId[pApartOrder[1]],</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;          qqvvqq_apartordering</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;          );</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        <span class="keywordflow">if</span> (qqvvqq_apartordering[0]==-1 || qqvvqq_apartordering[1]==-1) result=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (qqvvqq_apartordering[0]&gt;qqvvqq_apartordering[1]) swap(pApartOrder[0], pApartOrder[1]);</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      }</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;      <span class="keywordflow">if</span> (hasWplus || hasWminus){ <span class="comment">// W+ or W-</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;        strplabel[6]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pApartId[pApartOrder[0]], <span class="keyword">true</span>, useQQVVQQany);</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;        strplabel[7]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pApartId[pApartOrder[1]], <span class="keyword">true</span>, useQQVVQQany);</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;      }</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hasWjj){ <span class="comment">// W+/-</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;        strplabel[6]=<span class="stringliteral">&quot;qj&quot;</span>;</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;        strplabel[7]=<span class="stringliteral">&quot;qj&quot;</span>;</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;      }</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;      <span class="keywordflow">else</span> result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;    }</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((isWW || isZZ) &amp;&amp; napart&gt;=2 &amp;&amp; (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac09ee14d8ad516b27397f28eee642c62">TVar::JJQCD_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca832b9995c64912826d4e5f60e86f35ed">TVar::JJQCD_TU</a>)){</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.channeltoggle_stu = <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a>)*2 + <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca832b9995c64912826d4e5f60e86f35ed">TVar::JJQCD_TU</a>)*1 + <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac09ee14d8ad516b27397f28eee642c62">TVar::JJQCD_S</a>)*0;;</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.vvhvvtoggle_vbfvh = 2; <span class="comment">// Doesn&#39;t matter, already JJQCD</span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160; </div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a><span class="comment">/* || process == TVar::HSMHiggs_WWZZ || process == TVar::bkgWWZZ_SMHiggs*/</span>){</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;        <span class="keywordtype">string</span> strrun = <a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring;</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        <span class="keywordflow">if</span> (isWW &amp;&amp; (!hasZ1 || !hasZ2)) strrun += <span class="stringliteral">&quot;_ww&quot;</span>;</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isZZ &amp;&amp; (!hasW1 || !hasW2)) strrun += <span class="stringliteral">&quot;_zz&quot;</span>;</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        sprintf(<a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring, strrun.c_str());</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;      }</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160; </div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;      <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;        <span class="keywordtype">int</span> qqvvqq_apartordering[2]={ -1, -1 };</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;        <a class="code" href="namespaceTMCFMUtils.html#aef81a55fd97ffadcaabc57015b59e4ee">TMCFMUtils::AssociatedParticleOrdering_QQVVQQAny</a>(</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;          mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(0).first, mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(1).first,</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;          pApartId[pApartOrder[0]], pApartId[pApartOrder[1]],</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;          qqvvqq_apartordering</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;          );</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;        <span class="keywordflow">if</span> (qqvvqq_apartordering[0]==-1 || qqvvqq_apartordering[1]==-1) result=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (qqvvqq_apartordering[0]&gt;qqvvqq_apartordering[1]) swap(pApartOrder[0], pApartOrder[1]);</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;      }</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;      strplabel[6]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pApartId[pApartOrder[0]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;      strplabel[7]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pApartId[pApartOrder[1]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    }</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((isWW || isZZ) &amp;&amp; napart&gt;=2 &amp;&amp; (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca902db21776e8b4069184189a3d35976a">TVar::JJVBF_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca100a3d28b2ee4efd9227a4068543848f">TVar::JJVBF_TU</a>)){</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.channeltoggle_stu = <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a>)*2 + <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca100a3d28b2ee4efd9227a4068543848f">TVar::JJVBF_TU</a>)*1 + <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca902db21776e8b4069184189a3d35976a">TVar::JJVBF_S</a>)*0;;</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.vvhvvtoggle_vbfvh = 0; <span class="comment">// VBF-only process</span></div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160; </div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655">TVar::bkgWWZZ_SMHiggs</a>){</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;        <span class="keywordtype">string</span> strrun = <a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring;</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;        <span class="keywordflow">if</span> (isWW &amp;&amp; (!hasZ1 || !hasZ2)) strrun += <span class="stringliteral">&quot;_ww&quot;</span>;</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isZZ &amp;&amp; (!hasW1 || !hasW2)) strrun += <span class="stringliteral">&quot;_zz&quot;</span>;</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;        sprintf(<a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring, strrun.c_str());</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;      }</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160; </div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;      <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;        <span class="keywordtype">int</span> qqvvqq_apartordering[2]={ -1, -1 };</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;        <a class="code" href="namespaceTMCFMUtils.html#aef81a55fd97ffadcaabc57015b59e4ee">TMCFMUtils::AssociatedParticleOrdering_QQVVQQAny</a>(</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;          mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(0).first, mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(1).first,</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;          pApartId[pApartOrder[0]], pApartId[pApartOrder[1]],</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;          qqvvqq_apartordering</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;          );</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;        <span class="keywordflow">if</span> (qqvvqq_apartordering[0]==-1 || qqvvqq_apartordering[1]==-1) result=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (qqvvqq_apartordering[0]&gt;qqvvqq_apartordering[1]) swap(pApartOrder[0], pApartOrder[1]);</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;      }</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;      strplabel[6]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pApartId[pApartOrder[0]], <span class="keyword">true</span>, useQQVVQQany);</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;      strplabel[7]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pApartId[pApartOrder[1]], <span class="keyword">true</span>, useQQVVQQany);</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;    }</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((isWW || isZZ) &amp;&amp; napart&gt;=2 &amp;&amp; (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca89a5439f5d7527b48dfb23d3042e8d29">TVar::JJEW</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca936aef1ef89c04b5586ccb862544363a">TVar::JJEWQCD</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca78112f139715de80da62332b06c94926">TVar::JJEW_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cada9ae823e21061c18721960aadabee2c">TVar::JJEWQCD_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caf04b7e8e4c0900b0206ceaa88dc50271">TVar::JJEW_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4c10b0b90ea432d42a32a4ac8a099a1b">TVar::JJEWQCD_TU</a>)){</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.channeltoggle_stu = <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca936aef1ef89c04b5586ccb862544363a">TVar::JJEWQCD</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca89a5439f5d7527b48dfb23d3042e8d29">TVar::JJEW</a>)*2 + <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4c10b0b90ea432d42a32a4ac8a099a1b">TVar::JJEWQCD_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caf04b7e8e4c0900b0206ceaa88dc50271">TVar::JJEW_TU</a>)*1 + <a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cada9ae823e21061c18721960aadabee2c">TVar::JJEWQCD_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca78112f139715de80da62332b06c94926">TVar::JJEW_S</a>)*0;;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.vvhvvtoggle_vbfvh = 2; <span class="comment">// VBF+VH process</span></div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160; </div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655">TVar::bkgWWZZ_SMHiggs</a>){</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;        <span class="keywordtype">string</span> strrun = <a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring;</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        <span class="keywordflow">if</span> (isWW &amp;&amp; (!hasZ1 || !hasZ2)) strrun += <span class="stringliteral">&quot;_ww&quot;</span>;</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isZZ &amp;&amp; (!hasW1 || !hasW2)) strrun += <span class="stringliteral">&quot;_zz&quot;</span>;</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;        sprintf(<a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring, strrun.c_str());</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;      }</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160; </div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;      <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;        <span class="keywordtype">int</span> qqvvqq_apartordering[2]={ -1, -1 };</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        <a class="code" href="namespaceTMCFMUtils.html#aef81a55fd97ffadcaabc57015b59e4ee">TMCFMUtils::AssociatedParticleOrdering_QQVVQQAny</a>(</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;          mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(0).first, mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(1).first,</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;          pApartId[pApartOrder[0]], pApartId[pApartOrder[1]],</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;          qqvvqq_apartordering</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;          );</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;        <span class="keywordflow">if</span> (qqvvqq_apartordering[0]==-1 || qqvvqq_apartordering[1]==-1) result=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (qqvvqq_apartordering[0]&gt;qqvvqq_apartordering[1]) swap(pApartOrder[0], pApartOrder[1]);</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;      }</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;      strplabel[6]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pApartId[pApartOrder[0]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;      strplabel[7]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pApartId[pApartOrder[1]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    }</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160; </div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    <span class="comment">// Couplings for Z1</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    <span class="keywordflow">if</span> (isWW &amp;&amp; (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a>) &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a>){} <span class="comment">// Skip this one, already handled above</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hasZ1){</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a6f98f45dbd53233287193ec3fe987746">PDGHelpers::isALepton</a>(pId[pZOrder[0]]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a6f98f45dbd53233287193ec3fe987746">PDGHelpers::isALepton</a>(pId[pZOrder[1]])){</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;        <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;- Setting Z1-&gt;ll couplings.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160; </div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;        <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.q1=-1.0;</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;        <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l1=<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.le;</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;        <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r1=<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.re;</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160; </div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;        <span class="comment">// Special Z1-&gt;ll cases</span></div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;        <span class="keywordflow">if</span> (useQQBZGAM){</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;          strplabel[2]=<span class="stringliteral">&quot;el&quot;</span>;</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;          strplabel[3]=<span class="stringliteral">&quot;ea&quot;</span>;</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;        }</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;          strplabel[2]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[0]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;          strplabel[3]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[1]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;        }</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.AllowAnomalousZffCouplings == 1){</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;          strplabel[2]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;          strplabel[3]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;        }</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;        <span class="comment">// End special Z1-&gt;ll cases</span></div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;      }</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a68ffb179226737e2006fb7b0870dae6a">PDGHelpers::isANeutrino</a>(pId[pZOrder[0]]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a68ffb179226737e2006fb7b0870dae6a">PDGHelpers::isANeutrino</a>(pId[pZOrder[1]])){</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;        <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;- Setting Z1-&gt;nn couplings.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160; </div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;        <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.q1=0;</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;        <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l1=<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.ln;</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;        <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r1=<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.rn;</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160; </div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;        <span class="comment">// Special Z1-&gt;nn cases</span></div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;        <span class="keywordflow">if</span> (useQQBZGAM){</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;          strplabel[2]=<span class="stringliteral">&quot;nl&quot;</span>;</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;          strplabel[3]=<span class="stringliteral">&quot;na&quot;</span>;</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;        }</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;          strplabel[2]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[0]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;          strplabel[3]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[1]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;        }</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.AllowAnomalousZffCouplings == 1){</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;          strplabel[2]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;          strplabel[3]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;        }</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;        <span class="comment">// End special Z1-&gt;nn cases</span></div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;      }</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(pId[pZOrder[0]]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(pId[pZOrder[1]])){</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;        <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;- Setting Z1-&gt;jj couplings.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160; </div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;        <a class="code" href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a>.nqcdjets += 2;</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;        <span class="keywordtype">int</span> jetid=(<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pId[pZOrder[0]]) ? abs(pId[pZOrder[1]]) : abs(pId[pZOrder[0]]));</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(jetid)){</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;          <span class="keywordflow">if</span> (jetid==6) jetid = 2;</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.q1=<a class="code" href="TMCFM_8hh.html#acbd6a89aeedf5d91b0a3345f180652a1">ewcharge_</a>.Q[5+jetid];</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l1=<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l[-1+jetid];</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r1=<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r[-1+jetid];</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160; </div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;          <span class="comment">// Special Z1-&gt;qq cases</span></div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;          <span class="keywordflow">if</span> (useQQBZGAM){</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;            strplabel[2]=<span class="stringliteral">&quot;el&quot;</span>;<span class="comment">// Trick MCFM, not implemented properly</span></div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;            strplabel[3]=<span class="stringliteral">&quot;ea&quot;</span>;</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;          }</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;            strplabel[2]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[0]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;            strplabel[3]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[1]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;          }</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.AllowAnomalousZffCouplings == 1){</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;            strplabel[2]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;            strplabel[3]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;          }</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;        }</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;        <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;          <span class="keywordtype">double</span> gV_up = (<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l[-1+2]+<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r[-1+2])/2.;</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;          <span class="keywordtype">double</span> gV_dn = (<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l[-1+1]+<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r[-1+1])/2.;</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;          <span class="keywordtype">double</span> gA_up = (<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l[-1+2]-<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r[-1+2])/2.;</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;          <span class="keywordtype">double</span> gA_dn = (<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l[-1+1]-<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r[-1+1])/2.;</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;          <span class="keywordtype">double</span> yy_up = pow(gV_up, 2) + pow(gA_up, 2);</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;          <span class="keywordtype">double</span> yy_dn = pow(gV_dn, 2) + pow(gA_dn, 2);</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;          <span class="keywordtype">double</span> xx_up = gV_up*gA_up;</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;          <span class="keywordtype">double</span> xx_dn = gV_dn*gA_dn;</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;          <span class="keywordtype">double</span> yy = (2.*yy_up+3.*yy_dn);</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;          <span class="keywordtype">double</span> xx = (2.*xx_up+3.*xx_dn);</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;          <span class="keywordtype">double</span> discriminant = pow(yy, 2)-4.*pow(xx, 2);</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;          <span class="keywordtype">double</span> gVsq = (yy+sqrt(fabs(discriminant)))/2.;</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;          <span class="keywordtype">double</span> gAsq = pow(xx, 2)/gVsq;</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;          <span class="keywordtype">double</span> gV=-sqrt(gVsq);</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;          <span class="keywordtype">double</span> gA=-sqrt(gAsq);</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l1 = (gV+gA);</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r1 = (gV-gA);</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.q1=sqrt(pow(<a class="code" href="TMCFM_8hh.html#acbd6a89aeedf5d91b0a3345f180652a1">ewcharge_</a>.Q[5+1], 2)*3.+pow(<a class="code" href="TMCFM_8hh.html#acbd6a89aeedf5d91b0a3345f180652a1">ewcharge_</a>.Q[5+2], 2)*2.);</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160; </div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;          <span class="comment">// Special Z1-&gt;qq cases</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;          <span class="keywordflow">if</span> (useQQBZGAM){</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;            strplabel[2]=<span class="stringliteral">&quot;el&quot;</span>;<span class="comment">// Trick MCFM, not implemented properly</span></div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;            strplabel[3]=<span class="stringliteral">&quot;ea&quot;</span>;</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;          }</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;            strplabel[2]=<span class="stringliteral">&quot;qj&quot;</span>;</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;            strplabel[3]=<span class="stringliteral">&quot;qj&quot;</span>;</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;          }</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.AllowAnomalousZffCouplings == 1){</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;            strplabel[2]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;            strplabel[3]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;          }</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;        }</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;        <span class="keywordflow">if</span> (!useQQVVQQany){ <span class="comment">// colfac34_56 handles all couplings instead of this simple scaling (Reason: WW final states)</span></div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l1 *= sqrt(3.);</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r1 *= sqrt(3.);</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.q1 *= sqrt(3.);</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;        }</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;      } <span class="comment">// End Z1 daughter id tests</span></div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;    } <span class="comment">// End ZZ/ZG/ZJJ Z1 couplings</span></div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;      strplabel[2]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[0]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;      strplabel[3]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[1]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    }</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.AllowAnomalousZffCouplings == 1){</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;      strplabel[2]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;      strplabel[3]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    }</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160; </div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;    <span class="comment">// Couplings for Z2</span></div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;      (isWW &amp;&amp; (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a>) &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a>) <span class="comment">// Skip this one, already handled above</span></div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;      ||</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;      (isZJJ &amp;&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a> &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad2933b84082d269af9a836d4646aeefd">TVar::bkgZJets</a>) <span class="comment">// No need to handle</span></div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;      ){}</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hasZ2){</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a6f98f45dbd53233287193ec3fe987746">PDGHelpers::isALepton</a>(pId[pZOrder[2]]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a6f98f45dbd53233287193ec3fe987746">PDGHelpers::isALepton</a>(pId[pZOrder[3]])){</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;        <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;- Setting Z2-&gt;ll couplings.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;        <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.q2=-1.0;</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;        <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l2=<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.le;</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;        <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r2=<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.re;</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160; </div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;        <span class="comment">// Special Z2-&gt;ll cases</span></div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;        <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;          strplabel[4]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;          strplabel[5]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[3]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;        }</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.AllowAnomalousZffCouplings == 1){</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;          strplabel[4]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;          strplabel[5]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;        }</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;        <span class="comment">// End special Z2-&gt;ll cases</span></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;      }</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a68ffb179226737e2006fb7b0870dae6a">PDGHelpers::isANeutrino</a>(pId[pZOrder[2]]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a68ffb179226737e2006fb7b0870dae6a">PDGHelpers::isANeutrino</a>(pId[pZOrder[3]])){</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;        <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;- Setting Z2-&gt;nn couplings.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;        <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.q2=0;</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;        <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l2=<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.ln;</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;        <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r2=<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.rn;</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160; </div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;        <span class="comment">// Special Z2-&gt;nn cases</span></div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;        <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;          strplabel[4]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;          strplabel[5]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[3]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;        }</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.AllowAnomalousZffCouplings == 1){</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;          strplabel[4]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;          strplabel[5]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;        }</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;        <span class="comment">// End special Z2-&gt;nn cases</span></div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;      }</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(pId[pZOrder[2]]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(pId[pZOrder[3]])){</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;        <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;- Setting Z2-&gt;jj couplings.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160; </div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;        <a class="code" href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a>.nqcdjets += 2;</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;        <span class="keywordtype">int</span> jetid=(<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pId[pZOrder[2]]) ? abs(pId[pZOrder[3]]) : abs(pId[pZOrder[2]]));</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(jetid)){</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;          <span class="keywordflow">if</span> (jetid==6) jetid = 2;</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.q2=<a class="code" href="TMCFM_8hh.html#acbd6a89aeedf5d91b0a3345f180652a1">ewcharge_</a>.Q[5+jetid];</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l2=<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l[-1+jetid];</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r2=<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r[-1+jetid];</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160; </div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;          <span class="comment">// Special Z2-&gt;qq cases</span></div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;          <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;            strplabel[4]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;            strplabel[5]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[3]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;          }</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.AllowAnomalousZffCouplings == 1){</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;            strplabel[4]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;            strplabel[5]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;          }</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;        }</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;        <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;          <span class="keywordtype">double</span> gV_up = (<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l[-1+2]+<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r[-1+2])/2.;</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;          <span class="keywordtype">double</span> gV_dn = (<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l[-1+1]+<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r[-1+1])/2.;</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;          <span class="keywordtype">double</span> gA_up = (<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l[-1+2]-<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r[-1+2])/2.;</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;          <span class="keywordtype">double</span> gA_dn = (<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l[-1+1]-<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r[-1+1])/2.;</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;          <span class="keywordtype">double</span> yy_up = pow(gV_up, 2) + pow(gA_up, 2);</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;          <span class="keywordtype">double</span> yy_dn = pow(gV_dn, 2) + pow(gA_dn, 2);</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;          <span class="keywordtype">double</span> xx_up = gV_up*gA_up;</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;          <span class="keywordtype">double</span> xx_dn = gV_dn*gA_dn;</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;          <span class="keywordtype">double</span> yy = (2.*yy_up+3.*yy_dn);</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;          <span class="keywordtype">double</span> xx = (2.*xx_up+3.*xx_dn);</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;          <span class="keywordtype">double</span> discriminant = pow(yy, 2)-4.*pow(xx, 2);</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;          <span class="keywordtype">double</span> gVsq = (yy+sqrt(fabs(discriminant)))/2.;</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;          <span class="keywordtype">double</span> gAsq = pow(xx, 2)/gVsq;</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;          <span class="keywordtype">double</span> gV=-sqrt(gVsq);</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;          <span class="keywordtype">double</span> gA=-sqrt(gAsq);</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l2 = (gV+gA);</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r2 = (gV-gA);</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.q2=sqrt(pow(<a class="code" href="TMCFM_8hh.html#acbd6a89aeedf5d91b0a3345f180652a1">ewcharge_</a>.Q[5+1], 2)*3.+pow(<a class="code" href="TMCFM_8hh.html#acbd6a89aeedf5d91b0a3345f180652a1">ewcharge_</a>.Q[5+2], 2)*2.);</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160; </div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;          <span class="comment">// Special Z2-&gt;qq cases</span></div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;          <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;            strplabel[4]=<span class="stringliteral">&quot;qj&quot;</span>;</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;            strplabel[5]=<span class="stringliteral">&quot;qj&quot;</span>;</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;          }</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.AllowAnomalousZffCouplings == 1){</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;            strplabel[4]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;            strplabel[5]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;          }</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;        }</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;        <span class="keywordflow">if</span> (!useQQVVQQany){ <span class="comment">// colfac34_56 handles all couplings instead of this simple scaling (Reason: WW Final states)</span></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l2 *= sqrt(3.);</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r2 *= sqrt(3.);</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;          <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.q2 *= sqrt(3.);</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;        }</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;      } <span class="comment">// End Z2 daughter id tests</span></div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;    } <span class="comment">// End ZZ Z2 couplings</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (useQQVVQQany){</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;      strplabel[4]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;      strplabel[5]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[3]], <span class="keyword">false</span>, useQQVVQQany);</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;    }</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.AllowAnomalousZffCouplings == 1){</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;      strplabel[4]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;      strplabel[5]=<a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(pId[pZOrder[2]], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;    }</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160; </div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;  } <span class="comment">// End check WW, ZZ, ZG etc.</span></div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160; </div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;  <span class="keywordtype">int</span>* ordering=<span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;  <span class="keywordflow">if</span> (ndau&lt;=2){</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4539519c2d018fd29228bdd605c76c47">TVar::ZZGG</a>){</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4baafc289948916b0b531aa85e8f896f">TVar::bkgGammaGamma</a>){ ordering = pOrder; <span class="keywordflow">if</span> (!isGG) result = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;    }</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a>){</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4baafc289948916b0b531aa85e8f896f">TVar::bkgGammaGamma</a>){ ordering = pZOrder; <span class="keywordflow">if</span> (!isGG) result = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a2f26259ffb9387326573b0b1c4f2c700">TVar::bkgZGamma</a>){ ordering = pZOrder; <span class="keywordflow">if</span> (!hasZ1 || !isZG) result = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;    }</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a>){</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad2933b84082d269af9a836d4646aeefd">TVar::bkgZJets</a>){ ordering = pZOrder; <span class="keywordflow">if</span> (!hasZ1 || !isZJJ) result = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;    }</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;  }</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ndau&lt;=3){</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a>){</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a2f26259ffb9387326573b0b1c4f2c700">TVar::bkgZGamma</a>){ ordering = pZOrder; <span class="keywordflow">if</span> (!hasZ1 || !isZG) result = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;    }</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;  }</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160; </div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;      (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a>)</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;      ||</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;      ((<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7f06d733c2cecc34c7fcd2b665ff8b79">TVar::ZZQQB_STU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3ae97ff9bcb97541f88b75dc6b28c2af">TVar::ZZQQB_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caa8167833dfafdcfe495089716e6c1e0b">TVar::ZZQQB_TU</a>) &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a>)</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;      ){</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;      <span class="comment">// Just get the default ordering</span></div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a>){</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a2f26259ffb9387326573b0b1c4f2c700">TVar::bkgZGamma</a>){ ordering = pZOrder; <span class="keywordflow">if</span> (!hasZ1) result = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a>){ ordering = pZOrder; <span class="keywordflow">if</span> (!hasZ1 || !hasZ2) result = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a>){ ordering = pWOrder; <span class="keywordflow">if</span> (!hasW1 || !hasW2) result = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;      }</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;      <span class="comment">// bkgZZ process with S/T+U/STU separation needs ZZ ordering</span></div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;      <span class="keywordflow">else</span>{ ordering = pZOrder; <span class="keywordflow">if</span> (!hasZ1 || !hasZ2) result = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;    }</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4539519c2d018fd29228bdd605c76c47">TVar::ZZGG</a>){</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;      <span class="comment">// ggZZ/WW/VV</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;      <span class="comment">// All of these require ZZ ordering since they use either ZZ ME or VV ME</span></div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4cc74ca92572b408de0ce370a51f64e5">TVar::bkgZZ_SMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a>){</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;        ordering = pZOrder;</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;        <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;          !(</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;          (hasZ1 &amp;&amp; hasZ2)</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;          ||</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;          (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a> &amp;&amp; hasW1 &amp;&amp; hasW2)</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;          )</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;          ) result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;      }</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655">TVar::bkgWWZZ_SMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a>){</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;        ordering = pZOrder;</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;        <span class="keywordflow">if</span> (!hasZ1 || !hasZ2 || !hasW1 || !hasW2) result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;      }</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ac616ffacd90b7e38f875512989d62e5d">TVar::bkgWW_SMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a>){</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;        ordering = pZOrder;</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;        <span class="keywordflow">if</span> (!hasW1 || !hasW2) result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;      }</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;    }</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;      <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a></div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a></div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a></div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca89a5439f5d7527b48dfb23d3042e8d29">TVar::JJEW</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca936aef1ef89c04b5586ccb862544363a">TVar::JJEWQCD</a></div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca902db21776e8b4069184189a3d35976a">TVar::JJVBF_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca78112f139715de80da62332b06c94926">TVar::JJEW_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cada9ae823e21061c18721960aadabee2c">TVar::JJEWQCD_S</a></div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca100a3d28b2ee4efd9227a4068543848f">TVar::JJVBF_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caf04b7e8e4c0900b0206ceaa88dc50271">TVar::JJEW_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4c10b0b90ea432d42a32a4ac8a099a1b">TVar::JJEWQCD_TU</a></div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac09ee14d8ad516b27397f28eee642c62">TVar::JJQCD_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca832b9995c64912826d4e5f60e86f35ed">TVar::JJQCD_TU</a></div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;      ){</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;      <span class="comment">// Z+2 jets</span></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;      <span class="comment">// Just get the default ordering</span></div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad2933b84082d269af9a836d4646aeefd">TVar::bkgZJets</a>){ ordering = pZOrder; <span class="keywordflow">if</span> (!hasZ1 || !isZJJ) result = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;      <span class="comment">// VBF or QCD MCFM SBI, S or B</span></div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;      <span class="comment">// All of these require ZZ ordering since they use either ZZ ME or VV ME</span></div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4cc74ca92572b408de0ce370a51f64e5">TVar::bkgZZ_SMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a>){</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;        ordering = pZOrder;</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;        <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;          !(</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;          (hasZ1 &amp;&amp; hasZ2)</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;          ||</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;          (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a> &amp;&amp; hasW1 &amp;&amp; hasW2)</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;          )</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;          ) result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;      }</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655">TVar::bkgWWZZ_SMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a>){</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;        ordering = pZOrder;</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;        <span class="keywordflow">if</span> (!hasZ1 || !hasZ2 || !hasW1 || !hasW2) result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;      }</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ac616ffacd90b7e38f875512989d62e5d">TVar::bkgWW_SMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a>){</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;        ordering = pZOrder;</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;        <span class="keywordflow">if</span> (!hasW1 || !hasW2) result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;      }</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;    }</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160; </div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;  }</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160; </div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;  <span class="keywordflow">if</span> (partOrder &amp;&amp; ordering) { <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;ndau; ip++) partOrder-&gt;push_back(ordering[ip]); }</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;  <span class="keywordflow">if</span> (apartOrder &amp;&amp; pApartOrder) { <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;napart; ip++) apartOrder-&gt;push_back(pApartOrder[ip]); }</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) sprintf((<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip], strplabel[ip].Data());</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160; </div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::MCFM_SetupParticleCouplings: Summary (result=&quot;</span> &lt;&lt; (<a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>)result &lt;&lt; <span class="stringliteral">&quot;):\n&quot;</span>;</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160; </div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\trunstring=&quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring &lt;&lt; endl;</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160; </div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;    <span class="keywordflow">if</span> (hasZ1) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tProcess found a Z1.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    <span class="keywordflow">if</span> (hasZ2) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tProcess found a Z2.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;    <span class="keywordflow">if</span> (hasW1) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tProcess found a W1.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;    <span class="keywordflow">if</span> (hasW2) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tProcess found a W2.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t(l1, l2) = (&quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l1 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l2 &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t(r1, r2) = (&quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r1 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r2 &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t(q1, q2) = (&quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.q1 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.q2 &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160; </div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tplabels:\n&quot;</span>;</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip] &lt;&lt; endl;</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;    <span class="keywordflow">if</span> (partOrder){</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;      <span class="keywordflow">if</span> (!partOrder-&gt;empty()) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tpartOrder[&quot;</span> &lt;&lt; partOrder-&gt;size() &lt;&lt; <span class="stringliteral">&quot;]:\n&quot;</span>;</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;partOrder-&gt;size(); ip++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;] -&gt; &quot;</span> &lt;&lt; partOrder-&gt;at(ip) &lt;&lt; endl;</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;    }</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;    <span class="keywordflow">if</span> (apartOrder){</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;      <span class="keywordflow">if</span> (!apartOrder-&gt;empty()) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tapartOrder[&quot;</span> &lt;&lt; apartOrder-&gt;size() &lt;&lt; <span class="stringliteral">&quot;]:\n&quot;</span>;</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;apartOrder-&gt;size(); ip++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;] -&gt; &quot;</span> &lt;&lt; apartOrder-&gt;at(ip) &lt;&lt; endl;</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;    }</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;  }</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160; </div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;  <span class="keyword">delete</span>[] pId;</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;  <span class="keyword">delete</span>[] pWOrder;</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;  <span class="keyword">delete</span>[] pZOrder;</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;  <span class="keyword">delete</span>[] pOrder;</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;  <span class="keywordflow">if</span> (pApartOrder) <span class="keyword">delete</span>[] pApartOrder;</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;  <span class="keywordflow">if</span> (pApartId) <span class="keyword">delete</span>[] pApartId;</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;}</div>
<div class="line"><a name="l03249"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99"> 3249</a></span>&#160;TString <a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; pid, <span class="keywordtype">bool</span> useQJ, <span class="keywordtype">bool</span> useExtendedConventions){</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(pid)){</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;    <span class="keywordflow">if</span> (useQJ) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;qj&quot;</span>);</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;pp&quot;</span>);</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;  }</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(pid)) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;ig&quot;</span>);</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==1) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;dq&quot;</span>);</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==2) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;uq&quot;</span>);</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==3) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;sq&quot;</span>);</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==4) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;cq&quot;</span>);</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==5) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;bq&quot;</span>);</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==-1) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;da&quot;</span>);</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==-2) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;ua&quot;</span>);</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==-3) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;sa&quot;</span>);</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==-4) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;ca&quot;</span>);</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==-5) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;ba&quot;</span>);</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (abs(pid)==6) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;qj&quot;</span>); <span class="comment">// No tops!</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==11) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;el&quot;</span>);</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==13) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;ml&quot;</span>);</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==15) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;tl&quot;</span>);</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==-11) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;ea&quot;</span>);</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==-13) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;ma&quot;</span>);</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==-15) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;ta&quot;</span>);</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::abs(pid)&gt;=12 &amp;&amp; std::abs(pid)&lt;=16){</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;    <span class="keywordflow">if</span> (!useExtendedConventions){</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;      <span class="keywordflow">if</span> (pid&gt;0) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;nl&quot;</span>);</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;na&quot;</span>);</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;    }</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;      <span class="keywordflow">if</span> (pid==12) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;ne&quot;</span>);</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==14) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;nm&quot;</span>);</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==16) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;nt&quot;</span>);</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==-12) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;ke&quot;</span>);</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid==-14) <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;km&quot;</span>);</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;      <span class="keywordflow">else</span><span class="comment">/* if (pid==-16)*/</span> <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;kt&quot;</span>);</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;    }</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;  }</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">return</span> TString(<span class="stringliteral">&quot;  &quot;</span>);</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;}</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160; </div>
<div class="line"><a name="l03289"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#ae2cf0c66b72320a09e280aa5681d4f19"> 3289</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceTUtil.html#ae2cf0c66b72320a09e280aa5681d4f19">TUtil::MCFM_masscuts</a>(<span class="keywordtype">double</span> s[][<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>], <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1">TVar::Process</a>&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>){</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;  <span class="keywordtype">double</span> minZmassSqr=10*10;</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;    <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a></div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;    (s[2][3]&lt;minZmassSqr || s[4][5]&lt;minZmassSqr)</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;    ) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;}</div>
<div class="line"><a name="l03298"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a009f1369c2ba692d3fa2ceb2097ef2cc"> 3298</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceTUtil.html#a009f1369c2ba692d3fa2ceb2097ef2cc">TUtil::MCFM_smalls</a>(<span class="keywordtype">double</span> s[][<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>], <span class="keywordtype">int</span> <a class="code" href="TMCFM_8hh.html#a8852a945ad0b8536ee161f7ddb1e4be0">npart</a>){</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160; </div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;  <span class="comment">// Reject event if any s(i,j) is too small</span></div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;  <span class="comment">// cutoff is defined in technical.Dat</span></div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160; </div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;    <a class="code" href="TMCFM_8hh.html#a8852a945ad0b8536ee161f7ddb1e4be0">npart</a> == 3 &amp;&amp;</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;    (</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;    (-s[5-1][1-1]&lt; <a class="code" href="TMCFM_8hh.html#a929427f793907f66912124e594384151">cutoff_</a>.cutoff)  <span class="comment">//gamma p1</span></div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;    || (-s[5-1][2-1]&lt; <a class="code" href="TMCFM_8hh.html#a929427f793907f66912124e594384151">cutoff_</a>.cutoff)  <span class="comment">//gamma p2</span></div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;    || (-s[4-1][1-1]&lt; <a class="code" href="TMCFM_8hh.html#a929427f793907f66912124e594384151">cutoff_</a>.cutoff)  <span class="comment">//e+    p1</span></div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;    || (-s[4-1][2-1]&lt; <a class="code" href="TMCFM_8hh.html#a929427f793907f66912124e594384151">cutoff_</a>.cutoff)  <span class="comment">//e-    p2</span></div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;    || (-s[3-1][1-1]&lt; <a class="code" href="TMCFM_8hh.html#a929427f793907f66912124e594384151">cutoff_</a>.cutoff)  <span class="comment">//nu    p1</span></div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;    || (-s[3-1][2-1]&lt; <a class="code" href="TMCFM_8hh.html#a929427f793907f66912124e594384151">cutoff_</a>.cutoff)  <span class="comment">//nu    p2</span></div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    || (+s[5-1][4-1]&lt; <a class="code" href="TMCFM_8hh.html#a929427f793907f66912124e594384151">cutoff_</a>.cutoff)  <span class="comment">//gamma e+</span></div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;    || (+s[5-1][3-1]&lt; <a class="code" href="TMCFM_8hh.html#a929427f793907f66912124e594384151">cutoff_</a>.cutoff)  <span class="comment">//gamma nu</span></div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;    || (+s[4-1][3-1]&lt; <a class="code" href="TMCFM_8hh.html#a929427f793907f66912124e594384151">cutoff_</a>.cutoff)  <span class="comment">//e+    nu</span></div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;    )</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;    )</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160; </div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;    <a class="code" href="TMCFM_8hh.html#a8852a945ad0b8536ee161f7ddb1e4be0">npart</a> == 4 &amp;&amp;</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;    (</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;    (-s[5-1][1-1]&lt; <a class="code" href="TMCFM_8hh.html#a929427f793907f66912124e594384151">cutoff_</a>.cutoff)  <span class="comment">//e-    p1</span></div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;    || (-s[5-1][2-1]&lt; <a class="code" href="TMCFM_8hh.html#a929427f793907f66912124e594384151">cutoff_</a>.cutoff)  <span class="comment">//e-    p2</span></div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;    || (-s[6-1][1-1]&lt; <a class="code" href="TMCFM_8hh.html#a929427f793907f66912124e594384151">cutoff_</a>.cutoff)  <span class="comment">//nb    p1</span></div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;    || (-s[6-1][2-1]&lt; <a class="code" href="TMCFM_8hh.html#a929427f793907f66912124e594384151">cutoff_</a>.cutoff)  <span class="comment">//nb    p2</span></div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;    || (+s[6-1][5-1]&lt; <a class="code" href="TMCFM_8hh.html#a929427f793907f66912124e594384151">cutoff_</a>.cutoff)  <span class="comment">//e-    nb</span></div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;    )</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160; </div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;    )</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160; </div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160; </div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;}</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160; </div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160; </div>
<div class="line"><a name="l03337"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a8b3783c74e8947c4c7f5c1bb2d6cef5e"> 3337</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a8b3783c74e8947c4c7f5c1bb2d6cef5e">TUtil::InitJHUGenMELA</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* pathtoPDFSet, <span class="keywordtype">int</span> PDFMember, <span class="keywordtype">double</span> collider_sqrts){</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> GeV = 1./100.;</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;  collider_sqrts *= GeV; <span class="comment">// GeV units in JHUGen</span></div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160; </div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;  <span class="keywordtype">char</span> path_pdf_c[200];</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;  sprintf(path_pdf_c, <span class="stringliteral">&quot;%s&quot;</span>, pathtoPDFSet);</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;  <span class="keywordtype">int</span> pathpdfLength = strlen(path_pdf_c);</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160; </div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;  <a class="code" href="TModJHUGen_8hh.html#af882f865345973a4ccbdf9545ed4f866">__modjhugen_MOD_initfirsttime</a>(path_pdf_c, &amp;pathpdfLength, &amp;PDFMember, &amp;collider_sqrts);</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;}</div>
<div class="line"><a name="l03347"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#ae8313a38acdcb638b50a63bf04bc472f"> 3347</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#ae8313a38acdcb638b50a63bf04bc472f">TUtil::SetJHUGenHiggsMassWidth</a>(<span class="keywordtype">double</span> MReso, <span class="keywordtype">double</span> GaReso){</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> GeV = 1./100.;</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;  MReso *= GeV; <span class="comment">// GeV units in JHUGen</span></div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;  GaReso *= GeV; <span class="comment">// GeV units in JHUGen</span></div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;  <a class="code" href="TModJHUGenMELA_8hh.html#a94c24efd1a82cedd7e36b24a08741f51">__modjhugenmela_MOD_sethiggsmasswidth</a>(&amp;MReso, &amp;GaReso);</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;}</div>
<div class="line"><a name="l03353"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#ac6fdb5a1ca4802adaaee14c1c052efd4"> 3353</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#ac6fdb5a1ca4802adaaee14c1c052efd4">TUtil::SetJHUGenDistinguishWWCouplings</a>(<span class="keywordtype">bool</span> doAllow){</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;  <span class="keywordtype">int</span> iAllow = (doAllow ? 1 : 0);</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;  <a class="code" href="TModJHUGenMELA_8hh.html#ad64c7f7d10b1a0ac889b00b32cf1f53f">__modjhugenmela_MOD_setdistinguishwwcouplingsflag</a>(&amp;iAllow);</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;}</div>
<div class="line"><a name="l03357"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a2e1b502237f00dd823a0ef37b49e7aaa"> 3357</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a2e1b502237f00dd823a0ef37b49e7aaa">TUtil::ResetAmplitudeIncludes</a>(){</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;  <a class="code" href="TModJHUGenMELA_8hh.html#a16dceeb2bfcab516a854b963eec02e79">__modjhugenmela_MOD_resetamplitudeincludes</a>();</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;}</div>
<div class="line"><a name="l03360"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a45366db1a43b30a467e146dc8477f771"> 3360</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a45366db1a43b30a467e146dc8477f771">TUtil::SetMCFMSpinZeroCouplings</a>(<span class="keywordtype">bool</span> useBSM, <a class="code" href="classSpinZeroCouplings.html">SpinZeroCouplings</a> <span class="keyword">const</span>* Hcouplings, <span class="keywordtype">bool</span> forceZZ){</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;  <span class="keywordflow">if</span> (!useBSM){</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.AllowAnomalousCouplings = 0;</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.distinguish_HWWcouplings = 0;</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160; </div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;<span class="comment">    /***** REGULAR RESONANCE *****/</span></div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.cz_q1sq = 0;</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z11 = 100;</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z21 = 100;</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z31 = 100;</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z41 = 100;</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.cz_q2sq = 0;</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z12 = 100;</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z22 = 100;</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z32 = 100;</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z42 = 100;</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.cz_q12sq = 0;</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z10 = 100;</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z20 = 100;</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z30 = 100;</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z40 = 100;</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.cw_q1sq = 0;</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w11 = 100;</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w21 = 100;</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w31 = 100;</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w41 = 100;</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.cw_q2sq = 0;</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w12 = 100;</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w22 = 100;</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w32 = 100;</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w42 = 100;</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.cw_q12sq = 0;</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w10 = 100;</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w20 = 100;</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w30 = 100;</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w40 = 100;</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;    <span class="comment">// Just in case, not really needed to set to the default value</span></div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_top[0] = 1; <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_top[1] = 0;</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_bot[0] = 1; <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_bot[1] = 0;</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1[0] = 1; <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1[1] = 0;</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1[0] = 1; <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1[1] = 0;</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im=0; im&lt;2; im++){</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_tilde_top[im] = 0;</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_tilde_bot[im] = 0;</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghg2[im] = 0;</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghg3[im] = 0;</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghg4[im] = 0;</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_4gen_top[im] = 0;</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_4gen_bot[im] = 0;</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_tilde_4gen_top[im] = 0;</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_tilde_4gen_bot[im] = 0;</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghg2_4gen[im] = 0;</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghg3_4gen[im] = 0;</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghg4_4gen[im] = 0;</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz2[im] = 0;</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz3[im] = 0;</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz4[im] = 0;</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1_prime[im] = 0;</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1_prime2[im] = 0;</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1_prime3[im] = 0;</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1_prime4[im] = 0;</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1_prime5[im] = 0;</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1_prime6[im] = 0;</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1_prime7[im] = 0;</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz2_prime[im] = 0;</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz2_prime2[im] = 0;</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz2_prime3[im] = 0;</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz2_prime4[im] = 0;</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz2_prime5[im] = 0;</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz2_prime6[im] = 0;</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz2_prime7[im] = 0;</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz3_prime[im] = 0;</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz3_prime2[im] = 0;</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz3_prime3[im] = 0;</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz3_prime4[im] = 0;</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz3_prime5[im] = 0;</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz3_prime6[im] = 0;</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz3_prime7[im] = 0;</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz4_prime[im] = 0;</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz4_prime2[im] = 0;</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz4_prime3[im] = 0;</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz4_prime4[im] = 0;</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz4_prime5[im] = 0;</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz4_prime6[im] = 0;</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz4_prime7[im] = 0;</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghzgs1_prime2[im] = 0;</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghzgs2[im] = 0;</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghzgs3[im] = 0;</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghzgs4[im] = 0;</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghgsgs2[im] = 0;</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghgsgs3[im] = 0;</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghgsgs4[im] = 0;</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2[im] =  0;</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3[im] =  0;</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4[im] =  0;</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime[im] = 0;</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime2[im] = 0;</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime3[im] = 0;</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime4[im] = 0;</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime5[im] = 0;</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime6[im] = 0;</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime7[im] = 0;</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime[im] = 0;</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime2[im] = 0;</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime3[im] = 0;</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime4[im] = 0;</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime5[im] = 0;</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime6[im] = 0;</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime7[im] = 0;</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime[im] = 0;</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime2[im] = 0;</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime3[im] = 0;</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime4[im] = 0;</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime5[im] = 0;</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime6[im] = 0;</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime7[im] = 0;</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime[im] = 0;</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime2[im] = 0;</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime3[im] = 0;</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime4[im] = 0;</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime5[im] = 0;</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime6[im] = 0;</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime7[im] = 0;</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160; </div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;    }</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;<span class="comment">    /***** END REGULAR RESONANCE *****/</span></div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;<span class="comment">    /***** SECOND RESONANCE *****/</span></div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.c2z_q1sq = 0;</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z11 = 100;</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z21 = 100;</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z31 = 100;</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z41 = 100;</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.c2z_q2sq = 0;</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z12 = 100;</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z22 = 100;</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z32 = 100;</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z42 = 100;</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.c2z_q12sq = 0;</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z10 = 100;</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z20 = 100;</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z30 = 100;</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z40 = 100;</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.c2w_q1sq = 0;</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w11 = 100;</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w21 = 100;</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w31 = 100;</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w41 = 100;</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.c2w_q2sq = 0;</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w12 = 100;</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w22 = 100;</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w32 = 100;</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w42 = 100;</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.c2w_q12sq = 0;</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w10 = 100;</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w20 = 100;</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w30 = 100;</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w40 = 100;</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;    <span class="comment">// AllowAnomalousCouplings==0, so these are still treated as 1 when h2mass&gt;=0</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_top[0] = 0; <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_top[1] = 0;</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_bot[0] = 0; <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_bot[1] = 0;</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1[0] = 0; <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1[1] = 0;</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1[0] = 0; <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1[1] = 0;</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im=0; im&lt;2; im++){</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_tilde_top[im] = 0;</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_tilde_bot[im] = 0;</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2g2[im] = 0;</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2g3[im] = 0;</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2g4[im] = 0;</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_4gen_top[im] = 0;</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_4gen_bot[im] = 0;</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_tilde_4gen_top[im] = 0;</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_tilde_4gen_bot[im] = 0;</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2g2_4gen[im] = 0;</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2g3_4gen[im] = 0;</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2g4_4gen[im] = 0;</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z2[im] = 0;</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z3[im] = 0;</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z4[im] = 0;</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1_prime[im] = 0;</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1_prime2[im] = 0;</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1_prime3[im] = 0;</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1_prime4[im] = 0;</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1_prime5[im] = 0;</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1_prime6[im] = 0;</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1_prime7[im] = 0;</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z2_prime[im] = 0;</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z2_prime2[im] = 0;</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z2_prime3[im] = 0;</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z2_prime4[im] = 0;</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z2_prime5[im] = 0;</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z2_prime6[im] = 0;</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z2_prime7[im] = 0;</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z3_prime[im] = 0;</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z3_prime2[im] = 0;</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z3_prime3[im] = 0;</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z3_prime4[im] = 0;</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z3_prime5[im] = 0;</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z3_prime6[im] = 0;</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z3_prime7[im] = 0;</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z4_prime[im] = 0;</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z4_prime2[im] = 0;</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z4_prime3[im] = 0;</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z4_prime4[im] = 0;</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z4_prime5[im] = 0;</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z4_prime6[im] = 0;</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z4_prime7[im] = 0;</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2zgs1_prime2[im] = 0;</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2zgs2[im] = 0;</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2zgs3[im] = 0;</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2zgs4[im] = 0;</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2gsgs2[im] = 0;</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2gsgs3[im] = 0;</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2gsgs4[im] = 0;</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2[im] =  0;</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3[im] =  0;</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4[im] =  0;</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime[im] = 0;</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime2[im] = 0;</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime3[im] = 0;</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime4[im] = 0;</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime5[im] = 0;</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime6[im] = 0;</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime7[im] = 0;</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime[im] = 0;</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime2[im] = 0;</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime3[im] = 0;</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime4[im] = 0;</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime5[im] = 0;</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime6[im] = 0;</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime7[im] = 0;</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime[im] = 0;</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime2[im] = 0;</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime3[im] = 0;</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime4[im] = 0;</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime5[im] = 0;</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime6[im] = 0;</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime7[im] = 0;</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime[im] = 0;</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime2[im] = 0;</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime3[im] = 0;</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime4[im] = 0;</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime5[im] = 0;</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime6[im] = 0;</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime7[im] = 0;</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;    }</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;<span class="comment">    /***** END SECOND RESONANCE *****/</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;  }</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.AllowAnomalousCouplings = 1;</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.distinguish_HWWcouplings = ((Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#acf09ac549e89a616531ccb0e4a40fb1c">separateWWZZcouplings</a> &amp;&amp; !forceZZ) ? 1 : 0);</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160; </div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;<span class="comment">    /***** REGULAR RESONANCE *****/</span></div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.cz_q1sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#aa69dd3491d25f1ef9989029781e2d4d3">HzzCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z11 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z21 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z31 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z41 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.cz_q2sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#aa69dd3491d25f1ef9989029781e2d4d3">HzzCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z12 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z22 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z32 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z42 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.cz_q12sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#aa69dd3491d25f1ef9989029781e2d4d3">HzzCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z10 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z20 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z30 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_z40 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im=0; im&lt;2; im++){</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_top[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1acee4cbfd07a8bc33651da48059afa4">Httcoupl</a>)[gHIGGS_KAPPA][im];</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_bot[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ada8254257e17d5213268aa8bdabc6b72">Hbbcoupl</a>)[gHIGGS_KAPPA][im];</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_tilde_top[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1acee4cbfd07a8bc33651da48059afa4">Httcoupl</a>)[gHIGGS_KAPPA_TILDE][im];</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_tilde_bot[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ada8254257e17d5213268aa8bdabc6b72">Hbbcoupl</a>)[gHIGGS_KAPPA_TILDE][im];</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghg2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#abba2bc9db0b21f6a1bc11aa0f75d8854">Hggcoupl</a>)[gHIGGS_GG_2][im];</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghg3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#abba2bc9db0b21f6a1bc11aa0f75d8854">Hggcoupl</a>)[gHIGGS_GG_3][im];</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghg4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#abba2bc9db0b21f6a1bc11aa0f75d8854">Hggcoupl</a>)[gHIGGS_GG_4][im];</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_4gen_top[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a22237a18d3917271f0aa5296bfb8bb8e">Ht4t4coupl</a>)[gHIGGS_KAPPA][im];</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_4gen_bot[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ae680a3c75129b19b6ba276b49194e84a">Hb4b4coupl</a>)[gHIGGS_KAPPA][im];</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_tilde_4gen_top[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a22237a18d3917271f0aa5296bfb8bb8e">Ht4t4coupl</a>)[gHIGGS_KAPPA_TILDE][im];</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa_tilde_4gen_bot[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ae680a3c75129b19b6ba276b49194e84a">Hb4b4coupl</a>)[gHIGGS_KAPPA_TILDE][im];</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghg2_4gen[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#aff55bde64f7d5ab91410b05f1aa42198">Hg4g4coupl</a>)[gHIGGS_GG_2][im];</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghg3_4gen[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#aff55bde64f7d5ab91410b05f1aa42198">Hg4g4coupl</a>)[gHIGGS_GG_3][im];</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghg4_4gen[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#aff55bde64f7d5ab91410b05f1aa42198">Hg4g4coupl</a>)[gHIGGS_GG_4][im];</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_1][im];</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_2][im];</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_3][im];</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_4][im];</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_1_PRIME][im];</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_1_PRIME2][im];</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_1_PRIME3][im];</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_1_PRIME4][im];</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_1_PRIME5][im];</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_1_PRIME6][im];</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz1_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_1_PRIME7][im];</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz2_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_2_PRIME][im];</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz2_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_2_PRIME2][im];</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz2_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_2_PRIME3][im];</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz2_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_2_PRIME4][im];</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz2_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_2_PRIME5][im];</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz2_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_2_PRIME6][im];</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz2_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_2_PRIME7][im];</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz3_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_3_PRIME][im];</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz3_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_3_PRIME2][im];</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz3_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_3_PRIME3][im];</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz3_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_3_PRIME4][im];</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz3_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_3_PRIME5][im];</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz3_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_3_PRIME6][im];</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz3_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_3_PRIME7][im];</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz4_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_4_PRIME][im];</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz4_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_4_PRIME2][im];</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz4_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_4_PRIME3][im];</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz4_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_4_PRIME4][im];</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz4_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_4_PRIME5][im];</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz4_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_4_PRIME6][im];</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghz4_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_4_PRIME7][im];</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghzgs1_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_ZA_1_PRIME2][im];</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghzgs2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_ZA_2][im];</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghzgs3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_ZA_3][im];</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghzgs4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_ZA_4][im];</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghgsgs2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_AA_2][im];</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghgsgs3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_AA_3][im];</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghgsgs4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_AA_4][im];</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;    }</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.distinguish_HWWcouplings==1){</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.cw_q1sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a59e3b4abd4b8e417005f2dc9f0a2b94b">HwwCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w11 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a12429010d42886dad7844bb0b2cb8efc">HwwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w21 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a12429010d42886dad7844bb0b2cb8efc">HwwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w31 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a12429010d42886dad7844bb0b2cb8efc">HwwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w41 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a12429010d42886dad7844bb0b2cb8efc">HwwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.cw_q2sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a59e3b4abd4b8e417005f2dc9f0a2b94b">HwwCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w12 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a12429010d42886dad7844bb0b2cb8efc">HwwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w22 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a12429010d42886dad7844bb0b2cb8efc">HwwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w32 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a12429010d42886dad7844bb0b2cb8efc">HwwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w42 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a12429010d42886dad7844bb0b2cb8efc">HwwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.cw_q12sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a59e3b4abd4b8e417005f2dc9f0a2b94b">HwwCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w10 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a12429010d42886dad7844bb0b2cb8efc">HwwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w20 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a12429010d42886dad7844bb0b2cb8efc">HwwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w30 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a12429010d42886dad7844bb0b2cb8efc">HwwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w40 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a12429010d42886dad7844bb0b2cb8efc">HwwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im=0; im&lt;2; im++){</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_1][im];</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_2][im];</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_3][im];</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_4][im];</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_1_PRIME][im];</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_1_PRIME2][im];</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_1_PRIME3][im];</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_1_PRIME4][im];</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_1_PRIME5][im];</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_1_PRIME6][im];</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_1_PRIME7][im];</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_2_PRIME][im];</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_2_PRIME2][im];</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_2_PRIME3][im];</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_2_PRIME4][im];</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_2_PRIME5][im];</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_2_PRIME6][im];</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_2_PRIME7][im];</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_3_PRIME][im];</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_3_PRIME2][im];</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_3_PRIME3][im];</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_3_PRIME4][im];</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_3_PRIME5][im];</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_3_PRIME6][im];</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_3_PRIME7][im];</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_4_PRIME][im];</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_4_PRIME2][im];</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_4_PRIME3][im];</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_4_PRIME4][im];</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_4_PRIME5][im];</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_4_PRIME6][im];</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">Hwwcoupl</a>)[gHIGGS_VV_4_PRIME7][im];</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;      }</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;    }</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.cw_q1sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#aa69dd3491d25f1ef9989029781e2d4d3">HzzCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w11 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w21 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w31 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w41 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.cw_q2sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#aa69dd3491d25f1ef9989029781e2d4d3">HzzCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w12 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w22 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w32 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w42 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.cw_q12sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#aa69dd3491d25f1ef9989029781e2d4d3">HzzCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w10 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w20 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w30 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda_w40 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">HzzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im=0; im&lt;2; im++){</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_1][im];</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_2][im];</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_3][im];</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_4][im];</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_1_PRIME][im];</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_1_PRIME2][im];</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_1_PRIME3][im];</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_1_PRIME4][im];</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_1_PRIME5][im];</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_1_PRIME6][im];</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw1_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_1_PRIME7][im];</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_2_PRIME][im];</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_2_PRIME2][im];</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_2_PRIME3][im];</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_2_PRIME4][im];</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_2_PRIME5][im];</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_2_PRIME6][im];</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw2_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_2_PRIME7][im];</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_3_PRIME][im];</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_3_PRIME2][im];</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_3_PRIME3][im];</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_3_PRIME4][im];</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_3_PRIME5][im];</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_3_PRIME6][im];</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw3_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_3_PRIME7][im];</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_4_PRIME][im];</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_4_PRIME2][im];</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_4_PRIME3][im];</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_4_PRIME4][im];</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_4_PRIME5][im];</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_4_PRIME6][im];</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.ghw4_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">Hzzcoupl</a>)[gHIGGS_VV_4_PRIME7][im];</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;      }</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;    }</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;<span class="comment">    /***** END REGULAR RESONANCE *****/</span></div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;<span class="comment">    /***** SECOND RESONANCE *****/</span></div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.c2z_q1sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ab6f80a869b7d926071b8fb28ca4fc39f">H2zzCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z11 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z21 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z31 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z41 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.c2z_q2sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ab6f80a869b7d926071b8fb28ca4fc39f">H2zzCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z12 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z22 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z32 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z42 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.c2z_q12sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ab6f80a869b7d926071b8fb28ca4fc39f">H2zzCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z10 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z20 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z30 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;    <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_z40 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im=0; im&lt;2; im++){</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_top[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ac2de2325a37bdded726f16460fd79a0f">H2ttcoupl</a>)[gHIGGS_KAPPA][im];</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_bot[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a9a17477cf1cc3230436d923bbce9bc9b">H2bbcoupl</a>)[gHIGGS_KAPPA][im];</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_tilde_top[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ac2de2325a37bdded726f16460fd79a0f">H2ttcoupl</a>)[gHIGGS_KAPPA_TILDE][im];</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_tilde_bot[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a9a17477cf1cc3230436d923bbce9bc9b">H2bbcoupl</a>)[gHIGGS_KAPPA_TILDE][im];</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2g2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a189ac5469f2eed474ccd6403a82766e3">H2ggcoupl</a>)[gHIGGS_GG_2][im];</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2g3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a189ac5469f2eed474ccd6403a82766e3">H2ggcoupl</a>)[gHIGGS_GG_3][im];</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2g4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a189ac5469f2eed474ccd6403a82766e3">H2ggcoupl</a>)[gHIGGS_GG_4][im];</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_4gen_top[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a6fa253fbbe5c57ec1cb7a11d2d5542d4">H2t4t4coupl</a>)[gHIGGS_KAPPA][im];</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_4gen_bot[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a3a28fafa6eb3b86527ab7eab167f5101">H2b4b4coupl</a>)[gHIGGS_KAPPA][im];</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_tilde_4gen_top[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a6fa253fbbe5c57ec1cb7a11d2d5542d4">H2t4t4coupl</a>)[gHIGGS_KAPPA_TILDE][im];</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.kappa2_tilde_4gen_bot[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a3a28fafa6eb3b86527ab7eab167f5101">H2b4b4coupl</a>)[gHIGGS_KAPPA_TILDE][im];</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2g2_4gen[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#af5be27557b712d2424494e8ef8933e08">H2g4g4coupl</a>)[gHIGGS_GG_2][im];</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2g3_4gen[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#af5be27557b712d2424494e8ef8933e08">H2g4g4coupl</a>)[gHIGGS_GG_3][im];</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2g4_4gen[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#af5be27557b712d2424494e8ef8933e08">H2g4g4coupl</a>)[gHIGGS_GG_4][im];</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_1][im];</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_2][im];</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_3][im];</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_4][im];</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_1_PRIME][im];</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_1_PRIME2][im];</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_1_PRIME3][im];</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_1_PRIME4][im];</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_1_PRIME5][im];</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_1_PRIME6][im];</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z1_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_1_PRIME7][im];</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z2_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_2_PRIME][im];</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z2_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_2_PRIME2][im];</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z2_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_2_PRIME3][im];</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z2_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_2_PRIME4][im];</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z2_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_2_PRIME5][im];</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z2_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_2_PRIME6][im];</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z2_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_2_PRIME7][im];</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z3_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_3_PRIME][im];</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z3_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_3_PRIME2][im];</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z3_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_3_PRIME3][im];</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z3_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_3_PRIME4][im];</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z3_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_3_PRIME5][im];</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z3_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_3_PRIME6][im];</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z3_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_3_PRIME7][im];</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z4_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_4_PRIME][im];</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z4_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_4_PRIME2][im];</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z4_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_4_PRIME3][im];</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z4_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_4_PRIME4][im];</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z4_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_4_PRIME5][im];</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z4_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_4_PRIME6][im];</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2z4_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_4_PRIME7][im];</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2zgs1_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_ZA_1_PRIME2][im];</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2zgs2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_ZA_2][im];</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2zgs3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_ZA_3][im];</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2zgs4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_ZA_4][im];</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2gsgs2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_AA_2][im];</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2gsgs3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_AA_3][im];</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2gsgs4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_AA_4][im];</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;    }</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.distinguish_HWWcouplings==1){</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.c2w_q1sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#af926a87ba8e82a650b0fbc3edf1c942f">H2wwCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w11 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#addd41c09a8c4a1fa871ea344b48ef74d">H2wwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w21 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#addd41c09a8c4a1fa871ea344b48ef74d">H2wwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w31 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#addd41c09a8c4a1fa871ea344b48ef74d">H2wwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w41 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#addd41c09a8c4a1fa871ea344b48ef74d">H2wwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.c2w_q2sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#af926a87ba8e82a650b0fbc3edf1c942f">H2wwCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w12 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#addd41c09a8c4a1fa871ea344b48ef74d">H2wwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w22 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#addd41c09a8c4a1fa871ea344b48ef74d">H2wwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w32 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#addd41c09a8c4a1fa871ea344b48ef74d">H2wwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w42 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#addd41c09a8c4a1fa871ea344b48ef74d">H2wwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.c2w_q12sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#af926a87ba8e82a650b0fbc3edf1c942f">H2wwCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w10 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#addd41c09a8c4a1fa871ea344b48ef74d">H2wwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w20 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#addd41c09a8c4a1fa871ea344b48ef74d">H2wwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w30 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#addd41c09a8c4a1fa871ea344b48ef74d">H2wwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w40 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#addd41c09a8c4a1fa871ea344b48ef74d">H2wwLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im=0; im&lt;2; im++){</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_1][im];</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_2][im];</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_3][im];</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_4][im];</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_1_PRIME][im];</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_1_PRIME2][im];</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_1_PRIME3][im];</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_1_PRIME4][im];</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_1_PRIME5][im];</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_1_PRIME6][im];</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_1_PRIME7][im];</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_2_PRIME][im];</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_2_PRIME2][im];</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_2_PRIME3][im];</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_2_PRIME4][im];</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_2_PRIME5][im];</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_2_PRIME6][im];</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_2_PRIME7][im];</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_3_PRIME][im];</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_3_PRIME2][im];</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_3_PRIME3][im];</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_3_PRIME4][im];</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_3_PRIME5][im];</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_3_PRIME6][im];</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_3_PRIME7][im];</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_4_PRIME][im];</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_4_PRIME2][im];</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_4_PRIME3][im];</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_4_PRIME4][im];</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_4_PRIME5][im];</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_4_PRIME6][im];</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">H2wwcoupl</a>)[gHIGGS_VV_4_PRIME7][im];</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;      }</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;    }</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.c2w_q1sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ab6f80a869b7d926071b8fb28ca4fc39f">H2zzCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w11 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w21 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w31 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w41 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ1];</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.c2w_q2sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ab6f80a869b7d926071b8fb28ca4fc39f">H2zzCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w12 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w22 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w32 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w42 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ2];</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.c2w_q12sq = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ab6f80a869b7d926071b8fb28ca4fc39f">H2zzCLambda_qsq</a>)[cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w10 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_1][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w20 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_2][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w30 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_3][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.Lambda2_w40 = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">H2zzLambda_qsq</a>)[LambdaHIGGS_QSQ_VV_4][cLambdaHIGGS_VV_QSQ12];</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im=0; im&lt;2; im++){</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_1][im];</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_2][im];</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_3][im];</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_4][im];</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_1_PRIME][im];</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_1_PRIME2][im];</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_1_PRIME3][im];</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_1_PRIME4][im];</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_1_PRIME5][im];</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_1_PRIME6][im];</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w1_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_1_PRIME7][im];</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_2_PRIME][im];</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_2_PRIME2][im];</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_2_PRIME3][im];</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_2_PRIME4][im];</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_2_PRIME5][im];</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_2_PRIME6][im];</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w2_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_2_PRIME7][im];</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_3_PRIME][im];</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_3_PRIME2][im];</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_3_PRIME3][im];</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_3_PRIME4][im];</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_3_PRIME5][im];</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_3_PRIME6][im];</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w3_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_3_PRIME7][im];</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_4_PRIME][im];</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime2[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_4_PRIME2][im];</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime3[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_4_PRIME3][im];</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime4[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_4_PRIME4][im];</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime5[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_4_PRIME5][im];</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime6[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_4_PRIME6][im];</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.gh2w4_prime7[im] = (Hcouplings-&gt;<a class="code" href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">H2zzcoupl</a>)[gHIGGS_VV_4_PRIME7][im];</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;      }</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;    }</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;<span class="comment">    /***** END SECOND RESONANCE *****/</span></div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;  }</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;}</div>
<div class="line"><a name="l03993"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#ac48c90afbcdf62150abcc380ea428eef"> 3993</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#ac48c90afbcdf62150abcc380ea428eef">TUtil::SetMCFMaTQGCCouplings</a>(<span class="keywordtype">bool</span> useBSM, <a class="code" href="classaTQGCCouplings.html">aTQGCCouplings</a> <span class="keyword">const</span>* <a class="code" href="namespacemela.html#aab83238ea47f824af8b4c4a4c3e2fff0">couplings</a>){</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;  <span class="keywordflow">if</span> (!useBSM){</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im=0; im&lt;2; im++){</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;      <span class="keywordflow">if</span> (im==0){</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dV_A[im] = 1;</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dP_A[im] = 1;</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dM_A[im] = 1;</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160; </div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dV_Z[im] = 1;</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dP_Z[im] = 1;</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dM_Z[im] = 1;</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160; </div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dZZWpWm[im] = 1;</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dZAWpWm[im] = 1;</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dAAWpWm[im] = 1;</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;      }</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dV_A[im] = 0;</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dP_A[im] = 0;</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dM_A[im] = 0;</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160; </div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dV_Z[im] = 0;</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dP_Z[im] = 0;</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dM_Z[im] = 0;</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160; </div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dZZWpWm[im] = 0;</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dZAWpWm[im] = 0;</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;        <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dAAWpWm[im] = 0;</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;      }</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dFour_A[im] = 0;</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dFour_Z[im] = 0;</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;    }</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;  }</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im=0; im&lt;2; im++){</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dV_A[im] = (<a class="code" href="namespacemela.html#aab83238ea47f824af8b4c4a4c3e2fff0">couplings</a>-&gt;aTQGCcoupl)[gATQGC_dVA][im];</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dP_A[im] = (<a class="code" href="namespacemela.html#aab83238ea47f824af8b4c4a4c3e2fff0">couplings</a>-&gt;aTQGCcoupl)[gATQGC_dPA][im];</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dM_A[im] = (<a class="code" href="namespacemela.html#aab83238ea47f824af8b4c4a4c3e2fff0">couplings</a>-&gt;aTQGCcoupl)[gATQGC_dMA][im];</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dFour_A[im] = (<a class="code" href="namespacemela.html#aab83238ea47f824af8b4c4a4c3e2fff0">couplings</a>-&gt;aTQGCcoupl)[gATQGC_dFourA][im];</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160; </div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dV_Z[im] = (<a class="code" href="namespacemela.html#aab83238ea47f824af8b4c4a4c3e2fff0">couplings</a>-&gt;aTQGCcoupl)[gATQGC_dVZ][im];</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dP_Z[im] = (<a class="code" href="namespacemela.html#aab83238ea47f824af8b4c4a4c3e2fff0">couplings</a>-&gt;aTQGCcoupl)[gATQGC_dPZ][im];</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dM_Z[im] = (<a class="code" href="namespacemela.html#aab83238ea47f824af8b4c4a4c3e2fff0">couplings</a>-&gt;aTQGCcoupl)[gATQGC_dMZ][im];</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dFour_Z[im] = (<a class="code" href="namespacemela.html#aab83238ea47f824af8b4c4a4c3e2fff0">couplings</a>-&gt;aTQGCcoupl)[gATQGC_dFourZ][im];</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160; </div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dAAWpWm[im] = (<a class="code" href="namespacemela.html#aab83238ea47f824af8b4c4a4c3e2fff0">couplings</a>-&gt;aTQGCcoupl)[gATQGC_dAAWpWm][im];</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dZAWpWm[im] = (<a class="code" href="namespacemela.html#aab83238ea47f824af8b4c4a4c3e2fff0">couplings</a>-&gt;aTQGCcoupl)[gATQGC_dZAWpWm][im];</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;      <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.dZZWpWm[im] = (<a class="code" href="namespacemela.html#aab83238ea47f824af8b4c4a4c3e2fff0">couplings</a>-&gt;aTQGCcoupl)[gATQGC_dZZWpWm][im];</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;    }</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;  }</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;}</div>
<div class="line"><a name="l04044"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a345c5ae46930918d36cb7ca55b01c853"> 4044</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a345c5ae46930918d36cb7ca55b01c853">TUtil::SetMCFMAZffCouplings</a>(<span class="keywordtype">bool</span> useBSM, <a class="code" href="classAZffCouplings.html">AZffCouplings</a> <span class="keyword">const</span>* Zcouplings){</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;  <span class="keywordflow">if</span> (useBSM){</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;    <span class="comment">// BSM (all imaginary parts = 0 =&gt; unset, only setting the real parts)</span></div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.AllowAnomalousZffCouplings = 1;</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.reZ = (Zcouplings-&gt;<a class="code" href="classAZffCouplings.html#aa964188c2116027c391aa525fdd6418c">AZffcoupl</a>)[gAZff_ZllRH][0];</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.leZ = (Zcouplings-&gt;<a class="code" href="classAZffCouplings.html#aa964188c2116027c391aa525fdd6418c">AZffcoupl</a>)[gAZff_ZllLH][0];</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.rquZ = (Zcouplings-&gt;<a class="code" href="classAZffCouplings.html#aa964188c2116027c391aa525fdd6418c">AZffcoupl</a>)[gAZff_ZuuRH][0];</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.lquZ = (Zcouplings-&gt;<a class="code" href="classAZffCouplings.html#aa964188c2116027c391aa525fdd6418c">AZffcoupl</a>)[gAZff_ZuuLH][0];</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.rqdZ = (Zcouplings-&gt;<a class="code" href="classAZffCouplings.html#aa964188c2116027c391aa525fdd6418c">AZffcoupl</a>)[gAZff_ZddRH][0];</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.lqdZ = (Zcouplings-&gt;<a class="code" href="classAZffCouplings.html#aa964188c2116027c391aa525fdd6418c">AZffcoupl</a>)[gAZff_ZddLH][0];</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.rnZ = (Zcouplings-&gt;<a class="code" href="classAZffCouplings.html#aa964188c2116027c391aa525fdd6418c">AZffcoupl</a>)[gAZff_ZnunuRH][0];</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.lnZ = (Zcouplings-&gt;<a class="code" href="classAZffCouplings.html#aa964188c2116027c391aa525fdd6418c">AZffcoupl</a>)[gAZff_ZnunuLH][0];</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.clanou = (Zcouplings-&gt;<a class="code" href="classAZffCouplings.html#aa964188c2116027c391aa525fdd6418c">AZffcoupl</a>)[gAZff_uZLH][0];</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.cranou = (Zcouplings-&gt;<a class="code" href="classAZffCouplings.html#aa964188c2116027c391aa525fdd6418c">AZffcoupl</a>)[gAZff_uZRH][0];</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.clanod = (Zcouplings-&gt;<a class="code" href="classAZffCouplings.html#aa964188c2116027c391aa525fdd6418c">AZffcoupl</a>)[gAZff_dZLH][0];</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.cranod = (Zcouplings-&gt;<a class="code" href="classAZffCouplings.html#aa964188c2116027c391aa525fdd6418c">AZffcoupl</a>)[gAZff_dZRH][0];</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;  }</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;    <span class="comment">// SM</span></div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.AllowAnomalousZffCouplings = 0;</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.reZ = 0;</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.leZ = 0;</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.rquZ = 0;</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.lquZ = 0;</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.rqdZ = 0;</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.lqdZ = 0;</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.rnZ = 0;</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.lnZ = 0;</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.clanou = 0;</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.cranou = 0;</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.clanod = 0;</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;    <a class="code" href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a>.cranod = 0;</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;  }</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;}</div>
<div class="line"><a name="l04078"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a1706a661b9c70c8a8e5e3180e8ff676f"> 4078</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a1706a661b9c70c8a8e5e3180e8ff676f">TUtil::SetJHUGenSpinZeroVVCouplings</a>(<span class="keywordtype">double</span> Hvvcoupl[SIZE_HVV][2], <span class="keywordtype">double</span> Hvvpcoupl[SIZE_HVV][2], <span class="keywordtype">double</span> Hvpvpcoupl[SIZE_HVV][2], <span class="keywordtype">int</span> Hvvcoupl_cqsq[SIZE_HVV_CQSQ], <span class="keywordtype">double</span> HvvLambda_qsq[SIZE_HVV_LAMBDAQSQ][SIZE_HVV_CQSQ], <span class="keywordtype">bool</span> useWWcoupl){</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> GeV = 1./100.;</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;  <span class="keywordtype">int</span> iWWcoupl = (useWWcoupl ? 1 : 0);</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;SIZE_HVV_LAMBDAQSQ; c++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;SIZE_HVV_CQSQ; k++) HvvLambda_qsq[c][k] *= GeV; } <span class="comment">// GeV units in JHUGen</span></div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;  <a class="code" href="TModJHUGenMELA_8hh.html#a315e4d6c9a7433f82c692166e8da2b9d">__modjhugenmela_MOD_setspinzerovvcouplings</a>(Hvvcoupl, Hvvpcoupl, Hvpvpcoupl, Hvvcoupl_cqsq, HvvLambda_qsq, &amp;iWWcoupl);</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;}</div>
<div class="line"><a name="l04084"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a534d1442fc379e1a036eb23050c13c5b"> 4084</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a534d1442fc379e1a036eb23050c13c5b">TUtil::SetJHUGenSpinZeroGGCouplings</a>(<span class="keywordtype">double</span> Hggcoupl[SIZE_HGG][2]){ <a class="code" href="TModJHUGenMELA_8hh.html#a6400ff69dd1db36c40f04160c8ab9af9">__modjhugenmela_MOD_setspinzeroggcouplings</a>(Hggcoupl); }</div>
<div class="line"><a name="l04085"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#ac5984b5d69c38cd854dc9368ba0d66ef"> 4085</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#ac5984b5d69c38cd854dc9368ba0d66ef">TUtil::SetJHUGenSpinZeroQQCouplings</a>(<span class="keywordtype">double</span> Hqqcoupl[SIZE_HQQ][2]){ <a class="code" href="TModJHUGenMELA_8hh.html#a5c02b31b13777e326cdfa9531ba871aa">__modjhugenmela_MOD_setspinzeroqqcouplings</a>(Hqqcoupl); }</div>
<div class="line"><a name="l04086"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#aa7944801377c33a4e6b405058c03e1c7"> 4086</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#aa7944801377c33a4e6b405058c03e1c7">TUtil::SetJHUGenSpinOneCouplings</a>(<span class="keywordtype">double</span> Zqqcoupl[SIZE_ZQQ][2], <span class="keywordtype">double</span> Zvvcoupl[SIZE_ZVV][2]){ <a class="code" href="TModJHUGenMELA_8hh.html#a37c6cad193fe8886ac9fc33913b7ace0">__modjhugenmela_MOD_setspinonecouplings</a>(Zqqcoupl, Zvvcoupl); }</div>
<div class="line"><a name="l04087"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a9153965831508e074e8ef8fdc0c261b8"> 4087</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a9153965831508e074e8ef8fdc0c261b8">TUtil::SetJHUGenSpinTwoCouplings</a>(<span class="keywordtype">double</span> Gacoupl[SIZE_GGG][2], <span class="keywordtype">double</span> Gvvcoupl[SIZE_GVV][2], <span class="keywordtype">double</span> Gvvpcoupl[SIZE_GVV][2], <span class="keywordtype">double</span> Gvpvpcoupl[SIZE_GVV][2], <span class="keywordtype">double</span> qLeftRightcoupl[SIZE_GQQ][2]){</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;  <a class="code" href="TModJHUGenMELA_8hh.html#a4e91f71cb0ac836cda7d874438325c2e">__modjhugenmela_MOD_setspintwocouplings</a>(Gacoupl, Gvvcoupl, Gvvpcoupl, Gvpvpcoupl, qLeftRightcoupl);</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;}</div>
<div class="line"><a name="l04090"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a1c600f2c3dcc37a9512d659f46a364aa"> 4090</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a1c600f2c3dcc37a9512d659f46a364aa">TUtil::SetJHUGenVprimeContactCouplings</a>(<span class="keywordtype">double</span> Zpffcoupl[SIZE_Vpff][2], <span class="keywordtype">double</span> Wpffcoupl[SIZE_Vpff][2]){</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;  <a class="code" href="TModJHUGenMELA_8hh.html#a75b28dfc18a2abd947beb996f9cf63dd">__modjhugenmela_MOD_setvprimecontactcouplings</a>(Zpffcoupl, Wpffcoupl);</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;}</div>
<div class="line"><a name="l04093"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a89b248250ed67dd79baf7e0a911473d2"> 4093</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a89b248250ed67dd79baf7e0a911473d2">TUtil::SetJHUGenAZffCouplings</a>(<span class="keywordtype">bool</span> needAZff, <span class="keywordtype">double</span> AZffcoupl[SIZE_AZff][2]){</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;  <a class="code" href="TModParameters_8hh.html#aac294ed0754a29f2a41928bb46a04259">__modparameters_MOD_computeewvariables</a>();</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;  <span class="keywordflow">if</span> (needAZff) <a class="code" href="TModJHUGenMELA_8hh.html#a99aa222231438639d87fc30e6c417071">__modjhugenmela_MOD_setazffcouplings</a>(AZffcoupl);</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;}</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160; </div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;<span class="comment">//Make sure</span></div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;<span class="comment">// 1. tot Energy Sum &lt; 2EBEAM</span></div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;<span class="comment">// 2. PartonEnergy Fraction minimum&lt;x0,x1&lt;1</span></div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;<span class="comment">// 3. number of final state particle is defined</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l04103"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a460b9061f340996162890fcbdbef34b9"> 4103</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceTUtil.html#a460b9061f340996162890fcbdbef34b9">TUtil::SumMatrixElementPDF</a>(</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1">TVar::Process</a>&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28c">TVar::Production</a>&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815f">TVar::MatrixElement</a>&amp; matrixElement, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a2599e53f6f03e850b83dd83d6c296fec">TVar::LeptonInterference</a>&amp; leptonInterf,</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;  <a class="code" href="structTVar_1_1event__scales__type.html">event_scales_type</a>* event_scales, <a class="code" href="classMelaIO.html">MelaIO</a>* RcdME,</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; EBEAM,</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;  <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049">TVar::VerbosityLevel</a> verbosity</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;  ){</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Begin SumMatrixElementPDF&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;  <span class="keywordtype">double</span> msqjk=0;</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160; </div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;  <span class="keywordtype">int</span> nRequested_AssociatedJets=0;</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;  <span class="keywordtype">int</span> nRequested_AssociatedLeptons=0;</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;  <span class="keywordtype">int</span> AssociationVCompatibility=0;</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;  <span class="keywordtype">int</span> partIncCode=<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777bad10522f5bc41f80ca8edf7c195cdb858">TVar::kNoAssociated</a>; <span class="comment">// Do not use associated particles in the pT=0 frame boost</span></div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3706a5c493f245b1f6231e93e31383ea">TVar::JQCD</a>){ <span class="comment">// Use asociated jets in the pT=0 frame boost</span></div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;    partIncCode=<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba73861ec433a26ae79407bfe3f2f7b71a">TVar::kUseAssociated_Jets</a>;</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;    nRequested_AssociatedJets = 1;</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: Requesting &quot;</span> &lt;&lt; nRequested_AssociatedJets &lt;&lt; <span class="stringliteral">&quot; jets&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;  }</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;    <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a></div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca89a5439f5d7527b48dfb23d3042e8d29">TVar::JJEW</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca936aef1ef89c04b5586ccb862544363a">TVar::JJEWQCD</a></div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a></div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca902db21776e8b4069184189a3d35976a">TVar::JJVBF_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca78112f139715de80da62332b06c94926">TVar::JJEW_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cada9ae823e21061c18721960aadabee2c">TVar::JJEWQCD_S</a></div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a></div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca100a3d28b2ee4efd9227a4068543848f">TVar::JJVBF_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caf04b7e8e4c0900b0206ceaa88dc50271">TVar::JJEW_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4c10b0b90ea432d42a32a4ac8a099a1b">TVar::JJEWQCD_TU</a></div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;    || ((<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a>) &amp;&amp; (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac09ee14d8ad516b27397f28eee642c62">TVar::JJQCD_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca832b9995c64912826d4e5f60e86f35ed">TVar::JJQCD_TU</a>))</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;    || (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad2933b84082d269af9a836d4646aeefd">TVar::bkgZJets</a> &amp;&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a> &amp;&amp; RcdME-&gt;<a class="code" href="classMelaIO.html#aebe453b6e0a6bf08d7aa68c1927ae48f">melaCand</a>-&gt;<a class="code" href="classMELACandidate.html#a5c9c2090d9da51250048c0b70f4a29f3">getDecayMode</a>()==<a class="code" href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4abf438fbd5ea78acf6ed796714b309583">TVar::CandidateDecay_ff</a>)</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;    ){ <span class="comment">// Use associated jets in the pT=0 frame boost</span></div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;    partIncCode=<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba73861ec433a26ae79407bfe3f2f7b71a">TVar::kUseAssociated_Jets</a>;</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;    nRequested_AssociatedJets = 2;</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: Requesting &quot;</span> &lt;&lt; nRequested_AssociatedJets &lt;&lt; <span class="stringliteral">&quot; jets&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;  }</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;    <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a></div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a></div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a></div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;    ){ <span class="comment">// Only use associated leptons(+)neutrinos</span></div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;    partIncCode=<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777bad693ed4c2007493918e2772261311b29">TVar::kUseAssociated_Leptons</a>;</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;    nRequested_AssociatedLeptons = 2;</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;  }</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;    <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a></div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a></div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a></div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;    ) AssociationVCompatibility=24;</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;    <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a></div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a></div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a></div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;    ) AssociationVCompatibility=23;</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;  <a class="code" href="structTVar_1_1simple__event__record.html">simple_event_record</a> mela_event;</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a743a8c341936dbaa10ce50a5b8d87eba">AssociationCode</a>=partIncCode;</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a210cc509a3d155a23d69c94ea4558f87">AssociationVCompatibility</a>=AssociationVCompatibility;</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aca54cfc4690b7f0ba78f5af03d0f1ddf">nRequested_AssociatedJets</a>=nRequested_AssociatedJets;</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a3051f9440dc00a0a74b80997e898a5f5">nRequested_AssociatedLeptons</a>=nRequested_AssociatedLeptons;</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;  <a class="code" href="namespaceTUtil.html#a2bfa5115b0bf398c2fae3cc36aedf9f5">GetBoostedParticleVectors</a>(</div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;    RcdME-&gt;<a class="code" href="classMelaIO.html#aebe453b6e0a6bf08d7aa68c1927ae48f">melaCand</a>,</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;    mela_event,</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;    verbosity</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;    );</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160; </div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;  <span class="keywordtype">double</span> xx[2]={ 0 };</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;  vector&lt;int&gt; partOrder;</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;  vector&lt;int&gt; apartOrder;</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;  <span class="keywordtype">bool</span> doProceed =</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;    <a class="code" href="namespaceTUtil.html#af6d616d949d1a340c25d2ed39edd5ddd">CheckPartonMomFraction</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(0).second, mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(1).second, xx, EBEAM, verbosity) <span class="comment">// Check momentum transfers</span></div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;    &amp;&amp;</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;    <a class="code" href="namespaceTUtil.html#a5a527eeac9cb1eef2572d69f647e1e30">TUtil::MCFM_chooser</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>, <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, leptonInterf, verbosity, mela_event); <span class="comment">// Set some of the specifics of the process through this function</span></div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;  <span class="keywordflow">if</span> (doProceed) doProceed = <a class="code" href="namespaceTUtil.html#a886fd38c76f045c4d516492ecf1cb0ce">TUtil::MCFM_SetupParticleCouplings</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>, <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, verbosity, mela_event, &amp;partOrder, &amp;apartOrder); <span class="comment">// Set the specifics of the daughter or associated particle couplings through this function</span></div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;  <span class="keywordflow">if</span> (doProceed){</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;    <span class="keywordflow">if</span> (partOrder.size()!=mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size()){</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;      <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>){</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;        <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: Ordering size &quot;</span> &lt;&lt; partOrder.size() &lt;&lt; <span class="stringliteral">&quot; and number of daughter particles &quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size() &lt;&lt; <span class="stringliteral">&quot; are not the same!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;        <a class="code" href="namespaceTUtil.html#a7f6ec9418811fe987c034629691182af">TUtil::PrintCandidateSummary</a>(&amp;mela_event);</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;      }</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;      doProceed=<span class="keyword">false</span>;</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;    }</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;    <span class="keywordflow">if</span> (apartOrder.size()!=mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.size()){</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;      <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>){</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;        <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: Ordering size &quot;</span> &lt;&lt; apartOrder.size() &lt;&lt; <span class="stringliteral">&quot; and number of associated particles &quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.size() &lt;&lt; <span class="stringliteral">&quot; are not the same!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;        <a class="code" href="namespaceTUtil.html#a7f6ec9418811fe987c034629691182af">TUtil::PrintCandidateSummary</a>(&amp;mela_event);</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;      }</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;      doProceed=<span class="keyword">false</span>;</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;    }</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;  }</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;  <span class="keywordflow">if</span> (doProceed){</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;    <span class="keywordtype">int</span> NPart=<a class="code" href="TMCFM_8hh.html#a54213f196c3344b9508ae4cb9eab0ea0">npart_</a>.npart+2; <span class="comment">// +2 for mothers</span></div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;    <span class="keywordtype">double</span> p4[4][<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>]={ { 0 } };</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;    <span class="keywordtype">double</span> p4_tmp[4][<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>]={ { 0 } };</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;    <span class="keywordtype">int</span> <span class="keywordtype">id</span>[<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>]; <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ipar=0; ipar&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ipar++) <span class="keywordtype">id</span>[ipar]=-9000;</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>][<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>]={ { 0 } };</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;    <span class="keywordtype">double</span> msq_tmp[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>][<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>]={ { 0 } };</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;    <span class="keywordtype">int</span> channeltoggle=0;</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160; </div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;    TLorentzVector MomStore[<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>];</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; i++) MomStore[i].SetXYZT(0, 0, 0, 0);</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160; </div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;    <span class="comment">//Convert TLorentzVector into 4xNPart Matrix</span></div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;    <span class="comment">//reverse sign of incident partons</span></div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ipar=0; ipar&lt;2; ipar++){</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;      <span class="keywordflow">if</span> (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.T()&gt;0.){</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;        p4[0][ipar] = -mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.X();</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;        p4[1][ipar] = -mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.Y();</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;        p4[2][ipar] = -mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.Z();</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;        p4[3][ipar] = -mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.T();</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;        MomStore[ipar] = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second;</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;        <span class="keywordtype">id</span>[ipar] = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).first;</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;      }</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;        p4[0][ipar] = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.X();</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;        p4[1][ipar] = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.Y();</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;        p4[2][ipar] = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.Z();</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;        p4[3][ipar] = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.T();</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;        MomStore[ipar] = -mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second;</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;        <span class="keywordtype">id</span>[ipar] = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).first;</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;      }</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;    }</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160; </div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;    <span class="comment">// Determine if the decay mode involves WW or ZZ, to be used for ZZ or WW-specific signal MEs</span></div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;    <span class="comment">//bool isZG = (PDGHelpers::isAZBoson(mela_event.intermediateVid.at(0)) &amp;&amp; PDGHelpers::isAPhoton(mela_event.intermediateVid.at(1)));</span></div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;    <span class="keywordtype">bool</span> isWW = (<a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1)));</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;    <span class="keywordtype">bool</span> isZZ = (<a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1)));</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;    <span class="keywordtype">bool</span> isGG = (<a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1)));</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;    <span class="comment">//initialize decayed particles</span></div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix=0; ix&lt;(<a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>)partOrder.size(); ix++){</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;      <span class="keywordtype">int</span> ipar = min((<span class="keywordtype">int</span>)<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>, min(NPart, 2))+ix;</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;      <span class="keywordflow">if</span> (ipar&gt;=<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;      TLorentzVector* momTmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.at(partOrder.at(ix)).second);</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;      p4[0][ipar] = momTmp-&gt;X();</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;      p4[1][ipar] = momTmp-&gt;Y();</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;      p4[2][ipar] = momTmp-&gt;Z();</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;      p4[3][ipar] = momTmp-&gt;T();</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;      MomStore[ipar]=*momTmp;</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;      <span class="keywordtype">id</span>[ipar] = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.at(partOrder.at(ix)).first;</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;    }</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix=0; ix&lt;(<a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>)apartOrder.size(); ix++){</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;      <span class="keywordtype">int</span> ipar = min((<span class="keywordtype">int</span>)<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>, min(NPart, (<span class="keywordtype">int</span>)(partOrder.size()+2)))+ix;</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;      <span class="keywordflow">if</span> (ipar&gt;=<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;      TLorentzVector* momTmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.at(apartOrder.at(ix)).second);</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;      p4[0][ipar] = momTmp-&gt;X();</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;      p4[1][ipar] = momTmp-&gt;Y();</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;      p4[2][ipar] = momTmp-&gt;Z();</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;      p4[3][ipar] = momTmp-&gt;T();</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;      MomStore[ipar]=*momTmp;</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;      <span class="keywordtype">id</span>[ipar] = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.at(apartOrder.at(ix)).first;</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;    }</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160; </div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;    <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;NPart; i++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;p[&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;] (Px, Py, Pz, E):\t&quot;</span> &lt;&lt; p4[0][i] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; p4[1][i] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; p4[2][i] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; p4[3][i] &lt;&lt; endl; }</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160; </div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;    <span class="keywordtype">double</span> defaultRenScale = <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale;</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;    <span class="keywordtype">double</span> defaultFacScale = <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale;</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;    <span class="keywordtype">int</span> defaultNloop = <a class="code" href="TMCFM_8hh.html#a819542dc6ff812e041d403592a6b8990">nlooprun_</a>.nlooprun;</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;    <span class="keywordtype">int</span> defaultNflav = <a class="code" href="TMCFM_8hh.html#a55930b5d389dfae39115156b2bc9a692">nflav_</a>.nflav;</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;    <span class="keywordtype">string</span> defaultPdflabel = <a class="code" href="TMCFM_8hh.html#a4ff35855efcab9061a55f428e228e7dd">pdlabel_</a>.pdlabel;</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;    <span class="keywordtype">double</span> renQ = <a class="code" href="namespaceTUtil.html#a4a00d03fa1abeb4335b6abd9fae90663">InterpretScaleScheme</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, matrixElement, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#aabb9b35b555961e98acc8855bc6c2159">renomalizationScheme</a>, MomStore);</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;    <span class="keywordtype">double</span> facQ = <a class="code" href="namespaceTUtil.html#a4a00d03fa1abeb4335b6abd9fae90663">InterpretScaleScheme</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, matrixElement, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a403e32d8e1aab756f9c2b3ff4863139f">factorizationScheme</a>, MomStore);</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;    <a class="code" href="namespaceTUtil.html#ab551562aaa197841cd0a638f1f38b0ff">SetAlphaS</a>(renQ, facQ, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a7fe18004bd29525d34dcd6cb2b42a5b8">ren_scale_factor</a>, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a82661b3b8d040c36284a99bde2df79ce">fac_scale_factor</a>, 1, 5, <span class="stringliteral">&quot;cteq6_l&quot;</span>);</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;    <span class="keywordtype">double</span> alphasVal, alphasmzVal;</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;    <a class="code" href="namespaceTUtil.html#a2f0fce2b3d66f17b673f2e75d87adf00">GetAlphaS</a>(&amp;alphasVal, &amp;alphasmzVal);</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;    RcdME-&gt;<a class="code" href="classMelaIO.html#ab63c4e79eba8f923423f2e97539ebeef">setRenormalizationScale</a>(renQ);</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;    RcdME-&gt;<a class="code" href="classMelaIO.html#a383d634378da53d000781f8376f31145">setFactorizationScale</a>(facQ);</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;    RcdME-&gt;<a class="code" href="classMelaIO.html#a47b8c8bb2137ecf3e3e1d1b873d3de0b">setAlphaS</a>(alphasVal);</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;    RcdME-&gt;<a class="code" href="classMelaIO.html#a8487223242ccff4de3677d673152c7f5">setAlphaSatMZ</a>(alphasmzVal);</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;    RcdME-&gt;<a class="code" href="classMelaIO.html#aa20a0b91511fceb3584ad3a7d1ca210a">setHiggsMassWidth</a>(<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hmass, <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hwidth, 0);</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;    RcdME-&gt;<a class="code" href="classMelaIO.html#aa20a0b91511fceb3584ad3a7d1ca210a">setHiggsMassWidth</a>(<a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.h2mass, <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.h2width, 1);</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: Set AlphaS:\n&quot;</span></div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\tBefore set, alphas scale: &quot;</span> &lt;&lt; defaultRenScale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; defaultFacScale &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\trenQ: &quot;</span> &lt;&lt; renQ &lt;&lt; <span class="stringliteral">&quot; ( x &quot;</span> &lt;&lt; event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a7fe18004bd29525d34dcd6cb2b42a5b8">ren_scale_factor</a> &lt;&lt; <span class="stringliteral">&quot;), facQ: &quot;</span> &lt;&lt; facQ &lt;&lt; <span class="stringliteral">&quot; ( x &quot;</span> &lt;&lt; event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a82661b3b8d040c36284a99bde2df79ce">fac_scale_factor</a> &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\tAfter set, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale &lt;&lt; <span class="stringliteral">&quot;, alphas(Qren): &quot;</span> &lt;&lt; alphasVal &lt;&lt; <span class="stringliteral">&quot;, alphas(MZ): &quot;</span> &lt;&lt; alphasmzVal &lt;&lt; endl;</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;    }</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160; </div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;    <span class="keywordtype">int</span> nInstances=0;</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;      (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a>)</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;      ||</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;      ((<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7f06d733c2cecc34c7fcd2b665ff8b79">TVar::ZZQQB_STU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3ae97ff9bcb97541f88b75dc6b28c2af">TVar::ZZQQB_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caa8167833dfafdcfe495089716e6c1e0b">TVar::ZZQQB_TU</a>) &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a>)</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;      ){</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a>){</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4baafc289948916b0b531aa85e8f896f">TVar::bkgGammaGamma</a>){ <a class="code" href="TMCFM_8hh.html#a73d36bb0f57c81dfb5316ddbc97c763d">qqb_gamgam_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]); <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[5][5]=0; } <span class="comment">// This function actually computes qqb/gg -&gt; GG, so need to set msq[g][g]=0</span></div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a2f26259ffb9387326573b0b1c4f2c700">TVar::bkgZGamma</a>) <a class="code" href="TMCFM_8hh.html#accd9f808b3c1418c23dd1261025ba5c8">qqb_zgam_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]);</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a>) <a class="code" href="TMCFM_8hh.html#a5ac253858407e89f0aec0203338a99ac">qqb_zz_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]);</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a>) <a class="code" href="TMCFM_8hh.html#ad182783475deccf0cb5769e44bc7c4b7">qqb_ww_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]);</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;      }</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7f06d733c2cecc34c7fcd2b665ff8b79">TVar::ZZQQB_STU</a>) channeltoggle=0;</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3ae97ff9bcb97541f88b75dc6b28c2af">TVar::ZZQQB_S</a>) channeltoggle=1;</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;        <span class="keywordflow">else</span><span class="comment">/* if (production == TVar::ZZQQB_TU)*/</span> channeltoggle=2;</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;        <a class="code" href="TMCFM_8hh.html#a0126f1ad7c0f276245e47e94209bb159">qqb_zz_stu_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0], &amp;channeltoggle);</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;      }</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;      nInstances=<a class="code" href="namespaceTUtil.html#a3e24aa1f4311876d507e30ff4162a1db">WipeMEArray</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>, <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, <span class="keywordtype">id</span>, <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>, verbosity);</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160; </div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;      <span class="comment">// Sum over valid MEs without PDF weights</span></div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;      <span class="comment">// By far the dominant contribution is uub initial state.</span></div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++){</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;            (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[0]) || (<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(<span class="keywordtype">id</span>[0]) &amp;&amp; iquark==0) || iquark==<span class="keywordtype">id</span>[0])</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;            (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[1]) || (<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(<span class="keywordtype">id</span>[1]) &amp;&amp; jquark==0) || jquark==<span class="keywordtype">id</span>[1])</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;            ){</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;              <a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[0])</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;              &amp;&amp;</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;              <a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[1])</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;              ) msqjk = <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[3][7]+<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[7][3]; <span class="comment">// Use only uub initial state</span></div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;              <a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[0])</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;              ) msqjk = <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][-jquark+5];</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;              <a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[1])</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;              ) msqjk = <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[-iquark+5][iquark+5];</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;            <span class="keywordflow">else</span> msqjk += <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5];</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;          }</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;        }</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;      }</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;      <a class="code" href="namespaceTUtil.html#adf7b61bc902b23177090ce6b48a7f026">SumMEPDF</a>(MomStore[0], MomStore[1], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>, RcdME, EBEAM, verbosity);</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;    }</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4539519c2d018fd29228bdd605c76c47">TVar::ZZGG</a>){</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;      <span class="keywordflow">if</span> (isZZ){</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a>) <a class="code" href="TMCFM_8hh.html#ac5f5b45e0d7308e50552ea6a1a5c1aa8">gg_hzz_tb_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]); <span class="comment">// |ggHZZ|**2</span></div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4cc74ca92572b408de0ce370a51f64e5">TVar::bkgZZ_SMHiggs</a>) <a class="code" href="TMCFM_8hh.html#ab4fa7bf65d1e93991c0da573e9f6a562">gg_zz_all_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]); <span class="comment">// |ggZZ + ggHZZ|**2</span></div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a>) <a class="code" href="TMCFM_8hh.html#a425258fa6a3f55bd3c0a40de32725023">gg_zz_</a>(p4[0], &amp;(<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[5][5])); <span class="comment">// |ggZZ|**2</span></div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;        <span class="comment">// The following WWZZ processes need no swapping because ZZ-&gt;4f (same type) is ordered such that 3/5 (C++: 2/4) swap gives W+W-.</span></div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a>) <a class="code" href="TMCFM_8hh.html#a26cbf0643a080b35caacdac8b3ca3a26">gg_hvv_tb_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]); <span class="comment">// |ggHZZ+WW|**2</span></div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655">TVar::bkgWWZZ_SMHiggs</a>) <a class="code" href="TMCFM_8hh.html#a0a013af3f51251118d97e436366df176">gg_vv_all_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]); <span class="comment">// |ggZZ + ggHZZ (+WW)|**2</span></div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a>) <a class="code" href="TMCFM_8hh.html#a8b1a2900f63cee7b8b7726fb5a6497ad">gg_vv_</a>(p4[0], &amp;(<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[5][5])); <span class="comment">// |ggZZ+WW|**2</span></div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160; </div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;        <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;          <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tTUtil::SumMatrixElementPDF: ZZGG &amp;&amp; ZZ/WW/ZZ+WW MEs using ZZ (runstring: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;NPart; i++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tp[&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;] (Px, Py, Pz, E):\t&quot;</span> &lt;&lt; p4[0][i] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; p4[1][i] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; p4[2][i] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; p4[3][i] &lt;&lt; endl;</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;        }</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;      }</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isWW){</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a>) <a class="code" href="TMCFM_8hh.html#a26cbf0643a080b35caacdac8b3ca3a26">gg_hvv_tb_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]); <span class="comment">// |ggHZZ+WW|**2</span></div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ac616ffacd90b7e38f875512989d62e5d">TVar::bkgWW_SMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655">TVar::bkgWWZZ_SMHiggs</a>) <a class="code" href="TMCFM_8hh.html#a0a013af3f51251118d97e436366df176">gg_vv_all_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]); <span class="comment">// |ggZZ + ggHZZ (+WW)|**2</span></div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a>) <a class="code" href="TMCFM_8hh.html#a8b1a2900f63cee7b8b7726fb5a6497ad">gg_vv_</a>(p4[0], &amp;(<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[5][5])); <span class="comment">// |ggZZ+WW|**2</span></div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;        <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;          <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tTUtil::SumMatrixElementPDF: ZZGG &amp;&amp; ZZ/WW/ZZ+WW MEs using WW (runstring: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a>.runstring &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;NPart; i++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tp[&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;] (Px, Py, Pz, E):\t&quot;</span> &lt;&lt; p4[0][i] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; p4[1][i] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; p4[2][i] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; p4[3][i] &lt;&lt; endl;</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;        }</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;      }</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isGG){</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4baafc289948916b0b531aa85e8f896f">TVar::bkgGammaGamma</a>){</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;          <a class="code" href="TMCFM_8hh.html#a73d36bb0f57c81dfb5316ddbc97c763d">qqb_gamgam_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]);</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++){</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;              <span class="keywordflow">if</span> (iquark==0 &amp;&amp; jquark==0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;              <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] = 0;</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;            }</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;          }</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;        }</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;      }</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160; </div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;      nInstances=<a class="code" href="namespaceTUtil.html#a3e24aa1f4311876d507e30ff4162a1db">WipeMEArray</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>, <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, <span class="keywordtype">id</span>, <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>, verbosity);</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;        (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[0]) || <a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(<span class="keywordtype">id</span>[0]))</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;        &amp;&amp;</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;        (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[1]) || <a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(<span class="keywordtype">id</span>[1]))</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;        ){</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;        msqjk = <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[5][5];</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;      }</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;      <a class="code" href="namespaceTUtil.html#adf7b61bc902b23177090ce6b48a7f026">SumMEPDF</a>(MomStore[0], MomStore[1], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>, RcdME, EBEAM, verbosity);</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;    }</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;      <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a></div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a></div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a></div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a></div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a></div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a></div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca89a5439f5d7527b48dfb23d3042e8d29">TVar::JJEW</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca936aef1ef89c04b5586ccb862544363a">TVar::JJEWQCD</a></div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca902db21776e8b4069184189a3d35976a">TVar::JJVBF_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca78112f139715de80da62332b06c94926">TVar::JJEW_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cada9ae823e21061c18721960aadabee2c">TVar::JJEWQCD_S</a></div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca100a3d28b2ee4efd9227a4068543848f">TVar::JJVBF_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caf04b7e8e4c0900b0206ceaa88dc50271">TVar::JJEW_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4c10b0b90ea432d42a32a4ac8a099a1b">TVar::JJEWQCD_TU</a></div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;      || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac09ee14d8ad516b27397f28eee642c62">TVar::JJQCD_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca832b9995c64912826d4e5f60e86f35ed">TVar::JJQCD_TU</a></div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;      ){</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;      <span class="comment">// Z+2 jets</span></div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad2933b84082d269af9a836d4646aeefd">TVar::bkgZJets</a>) <a class="code" href="TMCFM_8hh.html#a6365df768fe636a9b36f2a3d078ec25e">qqb_z2jet_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]);</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;      <span class="comment">// VBF or QCD MCFM SBI, S or B</span></div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isZZ &amp;&amp; (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4cc74ca92572b408de0ce370a51f64e5">TVar::bkgZZ_SMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a>)){</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;        <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;          <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a></div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a></div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a></div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a></div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a></div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a></div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca89a5439f5d7527b48dfb23d3042e8d29">TVar::JJEW</a></div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca902db21776e8b4069184189a3d35976a">TVar::JJVBF_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca78112f139715de80da62332b06c94926">TVar::JJEW_S</a></div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca100a3d28b2ee4efd9227a4068543848f">TVar::JJVBF_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caf04b7e8e4c0900b0206ceaa88dc50271">TVar::JJEW_TU</a></div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;          ){</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;          <span class="comment">/*</span></div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;<span class="comment">          if (process == TVar::bkgZZ){//</span></div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;<span class="comment">            qq_zzqq_bkg_(p4[0], msq[0]);</span></div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;<span class="comment">            if (PDGHelpers::isAnUnknownJet(id[partOrder.size()+2]) &amp;&amp; PDGHelpers::isAnUnknownJet(id[partOrder.size()+3])){</span></div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;<span class="comment">              for (unsigned int ix=0; ix&lt;4; ix++){</span></div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;<span class="comment">                for (int ip=0; ip&lt;mxpart; ip++) p4_tmp[ix][ip]=p4[ix][ip];</span></div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;<span class="comment">                swap(p4_tmp[ix][partOrder.size()+2], p4_tmp[ix][partOrder.size()+3]);</span></div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;<span class="comment">              }</span></div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;<span class="comment">              qq_zzqq_bkg_(p4_tmp[0], msq_tmp[0]);</span></div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;<span class="comment">              for (int iquark=-5; iquark&lt;=5; iquark++){ for (int jquark=-5; jquark&lt;=5; jquark++){ msq[jquark+5][iquark+5] = (msq[jquark+5][iquark+5] + msq_tmp[jquark+5][iquark+5]); if (iquark==jquark) msq[jquark+5][iquark+5]*=0.5; } }</span></div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;<span class="comment">          }</span></div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;<span class="comment">          else{//</span></div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;<span class="comment">            */</span></div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;            <a class="code" href="TMCFM_8hh.html#a617b10ef8551cd1cfb7edc30e90abb63">qq_zzqq_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]);</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+2]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+3])){</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;4; ix++){</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) p4_tmp[ix][ip]=p4[ix][ip];</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;                swap(p4_tmp[ix][partOrder.size()+2], p4_tmp[ix][partOrder.size()+3]);</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;              }</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;              <a class="code" href="TMCFM_8hh.html#a617b10ef8551cd1cfb7edc30e90abb63">qq_zzqq_</a>(p4_tmp[0], msq_tmp[0]);</div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++){ <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] = (<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] + msq_tmp[jquark+5][iquark+5]); <span class="keywordflow">if</span> (iquark==jquark) <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]*=0.5; } }</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;            }</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+2]) || <a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+3])){</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;4; ix++){</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) p4_tmp[ix][ip]=p4[ix][ip];</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;                swap(p4_tmp[ix][partOrder.size()+2], p4_tmp[ix][partOrder.size()+3]);</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;              }</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;              TString strlabel[2] ={ (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[7], (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[6] }; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> il=0; il&lt;2; il++) strlabel[il].Resize(2);</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++){</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;                <span class="keywordflow">if</span> (ip!=6 &amp;&amp; ip!=7) sprintf((<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip], (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip]);</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;                <span class="keywordflow">else</span> sprintf((<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip], strlabel[ip-6].Data());</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;              }</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;              <a class="code" href="TMCFM_8hh.html#a617b10ef8551cd1cfb7edc30e90abb63">qq_zzqq_</a>(p4_tmp[0], msq_tmp[0]);</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;              <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: Adding missing contributions:\n&quot;</span>;</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tplabels:\n&quot;</span>;</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip] &lt;&lt; endl;</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tMEsq initial:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;                  <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;                }</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tMEsq added:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; msq_tmp[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;                  <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;                }</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;              }</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++){</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]==0.) <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] = msq_tmp[jquark+5][iquark+5];</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;                }</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;              }</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;            }</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;          <span class="comment">//}//</span></div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;        }</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;          <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac09ee14d8ad516b27397f28eee642c62">TVar::JJQCD_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca832b9995c64912826d4e5f60e86f35ed">TVar::JJQCD_TU</a></div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;          ){</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;          <a class="code" href="TMCFM_8hh.html#ad7cff9081fee4fc231b7e4c55f85d54c">qq_zzqqstrong_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]);</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+2]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+3])){</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;4; ix++){</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) p4_tmp[ix][ip]=p4[ix][ip];</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;              swap(p4_tmp[ix][partOrder.size()+2], p4_tmp[ix][partOrder.size()+3]);</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;            }</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;            <a class="code" href="TMCFM_8hh.html#ad7cff9081fee4fc231b7e4c55f85d54c">qq_zzqqstrong_</a>(p4_tmp[0], msq_tmp[0]);</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++){ <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] = (<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] + msq_tmp[jquark+5][iquark+5]); <span class="keywordflow">if</span> (iquark==jquark &amp;&amp; iquark!=0) <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]*=0.5; } }</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;            <span class="comment">// Subtract qqb/qbq-&gt;gg that was counted twice.</span></div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;            TString gglabel = <a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(21, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++){</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;              <span class="keywordflow">if</span> (ip!=6 &amp;&amp; ip!=7) sprintf((<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip], (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip]);</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;              <span class="keywordflow">else</span> sprintf((<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip], gglabel.Data());</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;            }</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;            <a class="code" href="TMCFM_8hh.html#ad7cff9081fee4fc231b7e4c55f85d54c">qq_zzqqstrong_</a>(p4_tmp[0], msq_tmp[0]);</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){ <span class="keywordtype">int</span> jquark=-iquark; <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] = (<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] - msq_tmp[jquark+5][iquark+5]); }</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;            <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: Subtracting qqb/qbq-&gt;gg double-counted contribution:\n&quot;</span>;</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tplabels:\n&quot;</span>;</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip] &lt;&lt; endl;</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tMEsq:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; msq_tmp[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;              }</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;            }</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;          }</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+2]) || <a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+3])) &amp;&amp; !(<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(<span class="keywordtype">id</span>[partOrder.size()+2]) || <a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(<span class="keywordtype">id</span>[partOrder.size()+3]))){</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;4; ix++){</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) p4_tmp[ix][ip]=p4[ix][ip];</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;              swap(p4_tmp[ix][partOrder.size()+2], p4_tmp[ix][partOrder.size()+3]);</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;            }</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;            TString strlabel[2] ={ (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[7], (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[6] }; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> il=0; il&lt;2; il++) strlabel[il].Resize(2);</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++){</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;              <span class="keywordflow">if</span> (ip!=6 &amp;&amp; ip!=7) sprintf((<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip], (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip]);</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;              <span class="keywordflow">else</span> sprintf((<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip], strlabel[ip-6].Data());</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;            }</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;            <a class="code" href="TMCFM_8hh.html#ad7cff9081fee4fc231b7e4c55f85d54c">qq_zzqqstrong_</a>(p4_tmp[0], msq_tmp[0]);</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;            <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: Adding missing contributions:\n&quot;</span>;</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tplabels:\n&quot;</span>;</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip] &lt;&lt; endl;</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tMEsq initial:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;              }</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tMEsq added:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; msq_tmp[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;              }</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;            }</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){ </div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++){</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]==0.) <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] = msq_tmp[jquark+5][iquark+5];</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;              }</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;            }</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;          }</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;        }</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;      }</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isWW &amp;&amp; (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ac616ffacd90b7e38f875512989d62e5d">TVar::bkgWW_SMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a>)){</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;        <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;          <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a></div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a></div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a></div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a></div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a></div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a></div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca89a5439f5d7527b48dfb23d3042e8d29">TVar::JJEW</a></div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca902db21776e8b4069184189a3d35976a">TVar::JJVBF_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca78112f139715de80da62332b06c94926">TVar::JJEW_S</a></div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca100a3d28b2ee4efd9227a4068543848f">TVar::JJVBF_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caf04b7e8e4c0900b0206ceaa88dc50271">TVar::JJEW_TU</a></div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;          ){</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;          <a class="code" href="TMCFM_8hh.html#a914dc3178fb8eee8af06815fec8b6233">qq_wwqq_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]);</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+2]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+3])){</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;4; ix++){</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) p4_tmp[ix][ip]=p4[ix][ip];</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;              swap(p4_tmp[ix][partOrder.size()+2], p4_tmp[ix][partOrder.size()+3]);</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;            }</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;            <a class="code" href="TMCFM_8hh.html#a914dc3178fb8eee8af06815fec8b6233">qq_wwqq_</a>(p4_tmp[0], msq_tmp[0]);</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++){ <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] = (<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] + msq_tmp[jquark+5][iquark+5]); <span class="keywordflow">if</span> (iquark==jquark) <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]*=0.5; } }</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;          }</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+2]) || <a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+3])){</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;4; ix++){</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) p4_tmp[ix][ip]=p4[ix][ip];</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;              swap(p4_tmp[ix][partOrder.size()+2], p4_tmp[ix][partOrder.size()+3]);</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;            }</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;            TString strlabel[2] ={ (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[7], (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[6] }; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> il=0; il&lt;2; il++) strlabel[il].Resize(2);</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++){</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;              <span class="keywordflow">if</span> (ip!=6 &amp;&amp; ip!=7) sprintf((<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip], (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip]);</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;              <span class="keywordflow">else</span> sprintf((<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip], strlabel[ip-6].Data());</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;            }</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;            <a class="code" href="TMCFM_8hh.html#a914dc3178fb8eee8af06815fec8b6233">qq_wwqq_</a>(p4_tmp[0], msq_tmp[0]);</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;            <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: Adding missing contributions:\n&quot;</span>;</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tplabels:\n&quot;</span>;</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip] &lt;&lt; endl;</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tMEsq initial:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;              }</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tMEsq added:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; msq_tmp[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;              }</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;            }</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++){</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]==0.) <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] = msq_tmp[jquark+5][iquark+5];</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;              }</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;            }</div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;          }</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;        }</div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;          <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac09ee14d8ad516b27397f28eee642c62">TVar::JJQCD_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca832b9995c64912826d4e5f60e86f35ed">TVar::JJQCD_TU</a></div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;          ){</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;          <a class="code" href="TMCFM_8hh.html#a093e725b77d8d09e91509a3767b34faf">qq_wwqqstrong_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]);</div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+2]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+3])){</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;4; ix++){</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) p4_tmp[ix][ip]=p4[ix][ip];</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;              swap(p4_tmp[ix][partOrder.size()+2], p4_tmp[ix][partOrder.size()+3]);</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;            }</div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;            <a class="code" href="TMCFM_8hh.html#a093e725b77d8d09e91509a3767b34faf">qq_wwqqstrong_</a>(p4_tmp[0], msq_tmp[0]);</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++){ <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] = (<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] + msq_tmp[jquark+5][iquark+5]); <span class="keywordflow">if</span> (iquark==jquark &amp;&amp; iquark!=0) <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]*=0.5; } }</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;            <span class="comment">// Subtract qqb/qbq-&gt;gg that was counted twice.</span></div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;            TString gglabel = <a class="code" href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a>(21, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++){</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;              <span class="keywordflow">if</span> (ip!=6 &amp;&amp; ip!=7) sprintf((<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip], (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip]);</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;              <span class="keywordflow">else</span> sprintf((<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip], gglabel.Data());</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;            }</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;            <a class="code" href="TMCFM_8hh.html#a093e725b77d8d09e91509a3767b34faf">qq_wwqqstrong_</a>(p4_tmp[0], msq_tmp[0]);</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){ <span class="keywordtype">int</span> jquark=-iquark; <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] = (<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] - msq_tmp[jquark+5][iquark+5]); }</div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;            <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: Subtracting qqb/qbq-&gt;gg double-counted contribution:\n&quot;</span>;</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tplabels:\n&quot;</span>;</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip] &lt;&lt; endl;</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tMEsq:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; msq_tmp[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;              }</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;            }</div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;          }</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+2]) || <a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+3])) &amp;&amp; !(<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(<span class="keywordtype">id</span>[partOrder.size()+2]) || <a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(<span class="keywordtype">id</span>[partOrder.size()+3]))){</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;4; ix++){</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) p4_tmp[ix][ip]=p4[ix][ip];</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;              swap(p4_tmp[ix][partOrder.size()+2], p4_tmp[ix][partOrder.size()+3]);</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;            }</div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;            TString strlabel[2] ={ (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[7], (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[6] }; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> il=0; il&lt;2; il++) strlabel[il].Resize(2);</div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++){</div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;              <span class="keywordflow">if</span> (ip!=6 &amp;&amp; ip!=7) sprintf((<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip], (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip]);</div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;              <span class="keywordflow">else</span> sprintf((<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip], strlabel[ip-6].Data());</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;            }</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;            <a class="code" href="TMCFM_8hh.html#a093e725b77d8d09e91509a3767b34faf">qq_wwqqstrong_</a>(p4_tmp[0], msq_tmp[0]);</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;            <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: Adding missing contributions:\n&quot;</span>;</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tplabels:\n&quot;</span>;</div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip] &lt;&lt; endl;</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tMEsq initial:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;              }</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tMEsq added:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; msq_tmp[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;              }</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;            }</div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++){</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]==0.) <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] = msq_tmp[jquark+5][iquark+5];</div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;              }</div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;            }</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;          }</div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;        }</div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;      }</div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((isWW || isZZ) &amp;&amp; (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655">TVar::bkgWWZZ_SMHiggs</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a> || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a>)){</div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;        <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;          <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a></div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a></div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a></div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a></div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a></div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a></div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca89a5439f5d7527b48dfb23d3042e8d29">TVar::JJEW</a></div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca902db21776e8b4069184189a3d35976a">TVar::JJVBF_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca78112f139715de80da62332b06c94926">TVar::JJEW_S</a></div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;          || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca100a3d28b2ee4efd9227a4068543848f">TVar::JJVBF_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caf04b7e8e4c0900b0206ceaa88dc50271">TVar::JJEW_TU</a></div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;          ){</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;          <a class="code" href="TMCFM_8hh.html#ae0c2c9d5a9548eca306e58fb6fd57c9e">qq_vvqq_</a>(p4[0], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[0]);</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+2]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+3])){</div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;4; ix++){</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) p4_tmp[ix][ip]=p4[ix][ip];</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;              swap(p4_tmp[ix][partOrder.size()+2], p4_tmp[ix][partOrder.size()+3]);</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;            }</div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;            <a class="code" href="TMCFM_8hh.html#ae0c2c9d5a9548eca306e58fb6fd57c9e">qq_vvqq_</a>(p4_tmp[0], msq_tmp[0]);</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++){ <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] = (<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] + msq_tmp[jquark+5][iquark+5]); <span class="keywordflow">if</span> (iquark==jquark) <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]*=0.5; } }</div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;          }</div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+2]) || <a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[partOrder.size()+3])){</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;4; ix++){</div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) p4_tmp[ix][ip]=p4[ix][ip];</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;              swap(p4_tmp[ix][partOrder.size()+2], p4_tmp[ix][partOrder.size()+3]);</div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;            }</div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;            TString strlabel[2] ={ (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[7], (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[6] }; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> il=0; il&lt;2; il++) strlabel[il].Resize(2);</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++){</div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;              <span class="keywordflow">if</span> (ip!=6 &amp;&amp; ip!=7) sprintf((<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip], (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip]);</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;              <span class="keywordflow">else</span> sprintf((<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip], strlabel[ip-6].Data());</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;            }</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;            <a class="code" href="TMCFM_8hh.html#ae0c2c9d5a9548eca306e58fb6fd57c9e">qq_vvqq_</a>(p4_tmp[0], msq_tmp[0]);</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;            <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: Adding missing contributions:\n&quot;</span>;</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tplabels:\n&quot;</span>;</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; ip++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; (<a class="code" href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a>.plabel)[ip] &lt;&lt; endl;</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tMEsq initial:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;              }</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;              <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tMEsq added:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; msq_tmp[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;              }</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;            }</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++){</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]==0.) <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] = msq_tmp[jquark+5][iquark+5];</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;              }</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;            }</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;          }</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;        }</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;        <span class="comment">//else if (</span></div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;        <span class="comment">//  production == TVar::JJQCD || production == TVar::JJQCD_S || production == TVar::JJQCD_TU</span></div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;        <span class="comment">//  ); // No JJQCD-VV ME in MCFM</span></div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;      }</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160; </div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;      nInstances=<a class="code" href="namespaceTUtil.html#a3e24aa1f4311876d507e30ff4162a1db">WipeMEArray</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>, <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, <span class="keywordtype">id</span>, <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>, verbosity);</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;      msqjk = <a class="code" href="namespaceTUtil.html#adf7b61bc902b23177090ce6b48a7f026">SumMEPDF</a>(MomStore[0], MomStore[1], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>, RcdME, EBEAM, verbosity);</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;    }</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160; </div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;    <span class="comment">// Set aL/R 1,2 into RcdME</span></div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0))) RcdME-&gt;<a class="code" href="classMelaIO.html#a4949a3f6e4a6e6d4337f98bb00d9fd7a">setVDaughterCouplings</a>(<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l1, <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r1, 0);</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0))) RcdME-&gt;<a class="code" href="classMelaIO.html#a4949a3f6e4a6e6d4337f98bb00d9fd7a">setVDaughterCouplings</a>(1., 0., 0);</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;    <span class="keywordflow">else</span> RcdME-&gt;<a class="code" href="classMelaIO.html#a4949a3f6e4a6e6d4337f98bb00d9fd7a">setVDaughterCouplings</a>(0., 0., 0);</div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1))) RcdME-&gt;<a class="code" href="classMelaIO.html#a4949a3f6e4a6e6d4337f98bb00d9fd7a">setVDaughterCouplings</a>(<a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.l2, <a class="code" href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a>.r2, 1);</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1))) RcdME-&gt;<a class="code" href="classMelaIO.html#a4949a3f6e4a6e6d4337f98bb00d9fd7a">setVDaughterCouplings</a>(1., 0., 1);</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;    <span class="keywordflow">else</span> RcdME-&gt;<a class="code" href="classMelaIO.html#a4949a3f6e4a6e6d4337f98bb00d9fd7a">setVDaughterCouplings</a>(0., 0., 1);</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;    <span class="comment">// Reset some of these couplings if the decay is not actually ZZ or WW.</span></div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;      <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad2933b84082d269af9a836d4646aeefd">TVar::bkgZJets</a></div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;      ||</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;      <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a2f26259ffb9387326573b0b1c4f2c700">TVar::bkgZGamma</a></div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;      ) RcdME-&gt;<a class="code" href="classMelaIO.html#a4949a3f6e4a6e6d4337f98bb00d9fd7a">setVDaughterCouplings</a>(0., 0., 1);</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160; </div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;    <span class="keywordflow">if</span> (msqjk != msqjk){</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;      <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: &quot;</span>&lt;&lt; <a class="code" href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>) &lt;&lt; <span class="stringliteral">&quot; msqjk=&quot;</span>  &lt;&lt; msqjk &lt;&lt; endl;</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;NPart; i++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;p[&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;] (Px, Py, Pz, E):\t&quot;</span> &lt;&lt; p4[0][i] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; p4[1][i] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; p4[2][i] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; p4[3][i] &lt;&lt; endl;</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: The number of ME instances: &quot;</span> &lt;&lt; nInstances &lt;&lt; <span class="stringliteral">&quot;. MEsq[ip][jp] = &quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;        <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;      }</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;      msqjk=0;</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;    }</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: The number of ME instances: &quot;</span> &lt;&lt; nInstances &lt;&lt; <span class="stringliteral">&quot;. MEsq[ip][jp] = &quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;        <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;      }</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;    }</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160; </div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: Reset AlphaS:\n&quot;</span></div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\tBefore reset, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;        &lt;&lt; endl;</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;    <a class="code" href="namespaceTUtil.html#ab551562aaa197841cd0a638f1f38b0ff">SetAlphaS</a>(defaultRenScale, defaultFacScale, 1., 1., defaultNloop, defaultNflav, defaultPdflabel);</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMatrixElementPDF: Reset AlphaS result:\n&quot;</span></div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\tAfter reset, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;        &lt;&lt; endl;</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;  } <span class="comment">// End if doProceed</span></div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;End TUtil::SumMatrixElementPDF(&quot;</span> &lt;&lt; msqjk &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;  <span class="keywordflow">return</span> msqjk;</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;}</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160; </div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;<span class="comment">// ggHdec+0J or Hdec+0J</span></div>
<div class="line"><a name="l04746"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#ad2f4fde8f2c90dadebec96378b36144d"> 4746</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceTUtil.html#ad2f4fde8f2c90dadebec96378b36144d">TUtil::JHUGenMatEl</a>(</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1">TVar::Process</a>&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28c">TVar::Production</a>&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815f">TVar::MatrixElement</a>&amp; matrixElement,</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;  <a class="code" href="structTVar_1_1event__scales__type.html">event_scales_type</a>* event_scales, <a class="code" href="classMelaIO.html">MelaIO</a>* RcdME,</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; EBEAM,</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;  <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049">TVar::VerbosityLevel</a> verbosity</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;  ){</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> GeV=1./100.; <span class="comment">// JHUGen mom. scale factor</span></div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;  <span class="keywordtype">double</span> MatElSq=0; <span class="comment">// Return value</span></div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160; </div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;  <span class="keywordflow">if</span> (matrixElement!=<a class="code" href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815faba6e6b23b0115bbaa919563a0626be03">TVar::JHUGen</a>){ <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::JHUGenMatEl: Non-JHUGen MEs are not supported&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> MatElSq; }</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;  <span class="keywordtype">bool</span> isSpinZero = (</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;    <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a></div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a5f54fad3934038d99814fd0d7a56d4d6">TVar::H0minus</a></div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3d026c66fd17c64c1d9d03653cc1b6a8">TVar::H0hplus</a></div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1bae49de3ea6edb6a11ac5666243fb0f">TVar::H0_g1prime2</a></div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a803fb6597b0bc5a5e0e2c4b88c57307a">TVar::H0_Zgs</a></div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad029c08e5a58a9284a29aff6fe95ffe1">TVar::H0_gsgs</a></div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3484bfea5cba3a35baf703d223bacbe1">TVar::H0_Zgs_PS</a></div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a0a95bcbfd8f979abb0469b6c1b33f7dc">TVar::H0_gsgs_PS</a></div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a697cce026b792eb83c62dd2477e35d2a">TVar::H0_Zgsg1prime2</a></div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4850105ad013a92a4c9cbe6cfa97d794">TVar::SelfDefine_spin0</a></div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;    );</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;  <span class="keywordtype">bool</span> isSpinOne = (</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;    <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad581500114c5f4c08a35a82589bede5c">TVar::H1minus</a></div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a9d1a9f8e0e916dae095df1c0cf76ce90">TVar::H1plus</a></div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a76543bd66713a065a73ac619127b52e5">TVar::SelfDefine_spin1</a></div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;    );</div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;  <span class="keywordtype">bool</span> isSpinTwo = (</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;    <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a76d1115e990c3f9eaf2133cd840229e0">TVar::H2_g1g5</a></div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a0df8e93cbad9c2badc80d38e677517ce">TVar::H2_g1</a></div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a0f52c7dfb21e373a1e23e0741a82b1a5">TVar::H2_g8</a></div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a256dab2b7cb0550c98a8956864c9c70c">TVar::H2_g4</a></div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a90b871bcf11dd29b846ec66ff1d149c1">TVar::H2_g5</a></div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad4bc4f19b5b7ed614451e7e9dd9ebfec">TVar::H2_g2</a></div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1aa86ee768bc80563b0b09ea31c387a9b1">TVar::H2_g3</a></div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a9648f270b230cc027d720bbc5bb0b160">TVar::H2_g6</a></div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a28527257e5f1be3c6702dfbb44104c9b">TVar::H2_g7</a></div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a37afc06e4c298802bcf3594eef50e7c1">TVar::H2_g9</a></div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a9eaf6c4583168f2e344e0f51dd24378d">TVar::H2_g10</a></div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;    || <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a793e5b93f6642e3b03340b1a44711c90">TVar::SelfDefine_spin2</a></div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;    );</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;  <span class="keywordflow">if</span> (!(isSpinZero || isSpinOne || isSpinTwo)){ <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::JHUGenMatEl: Process &quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>) &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; <span class="stringliteral">&quot; not supported.&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> MatElSq; }</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::JHUGenMatEl: Process &quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a>(<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>) &lt;&lt; <span class="stringliteral">&quot; is computing a spin-&quot;</span>;</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;    <span class="keywordflow">if</span> (isSpinZero) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;0&quot;</span>;</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isSpinOne) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;1&quot;</span>;</div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isSpinTwo) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;2&quot;</span>;</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;?&quot;</span>;</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot; ME with production &quot;</span> &lt;&lt; <a class="code" href="namespaceTVar.html#a1225a4280a727b6456d225d3493e0e66">TVar::ProductionName</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>) &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;  }</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160; </div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>][<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>]={ { 0 } }; <span class="comment">// ME**2[parton2][parton1] for each incoming parton 1 and 2, used in RcdME</span></div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;  <span class="keywordtype">int</span> MYIDUP_tmp[4]={ 0 }; <span class="comment">// Initial assignment array, unconverted. 0==Unassigned</span></div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;  vector&lt;pair&lt;int, int&gt;&gt; idarray[2]; <span class="comment">// All possible ids for each daughter based on the value of MYIDUP_tmp[0:3] and the desired V ids taken from mela_event.intermediateVid.at(0:1)</span></div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;  <span class="keywordtype">int</span> MYIDUP[4]={ 0 }; <span class="comment">// &quot;Working&quot; assignment, converted</span></div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;  <span class="keywordtype">int</span> idfirst[2]={ 0 }; <span class="comment">// Used to set DecayMode1, = MYIDUP[0:1]</span></div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;  <span class="keywordtype">int</span> idsecond[2]={ 0 }; <span class="comment">// Used to set DecayMode2, = MYIDUP[2:3]</span></div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;  <span class="keywordtype">double</span> p4[6][4]={ { 0 } }; <span class="comment">// Mom (*GeV) to pass into JHUGen</span></div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;  TLorentzVector MomStore[<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>]; <span class="comment">// Mom (in natural units) to compute alphaS</span></div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; i++) MomStore[i].SetXYZT(0, 0, 0, 0);</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160; </div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;  <span class="comment">// Notice that partIncCode is specific for this subroutine</span></div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;  <span class="keywordtype">int</span> partIncCode=<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777bad10522f5bc41f80ca8edf7c195cdb858">TVar::kNoAssociated</a>; <span class="comment">// Do not use associated particles in the pT=0 frame boost</span></div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;  <a class="code" href="structTVar_1_1simple__event__record.html">simple_event_record</a> mela_event;</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a743a8c341936dbaa10ce50a5b8d87eba">AssociationCode</a>=partIncCode;</div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;  <a class="code" href="namespaceTUtil.html#a2bfa5115b0bf398c2fae3cc36aedf9f5">GetBoostedParticleVectors</a>(</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;    RcdME-&gt;<a class="code" href="classMelaIO.html#aebe453b6e0a6bf08d7aa68c1927ae48f">melaCand</a>,</div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;    mela_event,</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;    verbosity</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;    );</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;  <span class="keywordflow">if</span> (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size()&lt;2 || mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.size()!=2){</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::JHUGenMatEl: Number of daughters &quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size() &lt;&lt; <span class="stringliteral">&quot; or number of intermediate Vs &quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a> &lt;&lt; <span class="stringliteral">&quot; not supported!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;    <span class="keywordflow">return</span> MatElSq;</div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;  }</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160; </div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;  <span class="comment">// p(i,0:3) = (E(i),px(i),py(i),pz(i))</span></div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;  <span class="comment">// i=0,1: g1,g2 or q1, qb2 (outgoing convention)</span></div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;  <span class="comment">// i=2,3: correspond to MY_IDUP(0),MY_IDUP(1)</span></div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;  <span class="comment">// i=4,5: correspond to MY_IDUP(2),MY_IDUP(3)</span></div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ipar=0; ipar&lt;2; ipar++){</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;    <span class="keywordflow">if</span> (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.T()&gt;0.){</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;      p4[ipar][0] = -mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.T()*GeV;</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;      p4[ipar][1] = -mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.X()*GeV;</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;      p4[ipar][2] = -mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.Y()*GeV;</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;      p4[ipar][3] = -mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.Z()*GeV;</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;      MomStore[ipar] = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second;</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;    }</div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;      p4[ipar][0] = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.T()*GeV;</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;      p4[ipar][1] = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.X()*GeV;</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;      p4[ipar][2] = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.Y()*GeV;</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;      p4[ipar][3] = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second.Z()*GeV;</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;      MomStore[ipar] = -mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second;</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;    }</div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;    <span class="comment">// From Markus:</span></div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;    <span class="comment">// Note that the momentum no.2, p(1:4, 2), is a dummy which is not used in case production == TVar::ZZINDEPENDENT.</span></div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;    <span class="keywordflow">if</span> (ipar==1 &amp;&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a>){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix=0; ix&lt;4; ix++){ p4[0][ix] += p4[ipar][ix]; p4[ipar][ix]=0.; } }</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;  }</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;  <span class="comment">//initialize decayed particles</span></div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;  <span class="keywordflow">if</span> (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size()==2){</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar=0; ipar&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size(); ipar++){</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;      TLorentzVector* momTmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.at(ipar).second);</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;      <span class="keywordtype">int</span>* idtmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.at(ipar).first);</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160; </div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;      <span class="keywordtype">int</span> arrindex = 2*ipar;</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(*idtmp)) MYIDUP_tmp[arrindex] = *idtmp;</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;      <span class="keywordflow">else</span> MYIDUP_tmp[arrindex] = 0;</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;      MYIDUP_tmp[arrindex+1] = -9000;</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;      p4[arrindex+2][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;      p4[arrindex+2][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;      p4[arrindex+2][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;      p4[arrindex+2][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;      MomStore[arrindex+2] = *momTmp;</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;      <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;MYIDUP_tmp[&quot;</span> &lt;&lt; arrindex &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; ipar &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; MYIDUP_tmp[arrindex] &lt;&lt; endl;</div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;    }</div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;  }</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar=0; ipar&lt;4; ipar++){</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;      <span class="keywordflow">if</span> (ipar&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size()){</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;        TLorentzVector* momTmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.at(ipar).second);</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;        <span class="keywordtype">int</span>* idtmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.at(ipar).first);</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160; </div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(*idtmp)) MYIDUP_tmp[ipar] = *idtmp;</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;        <span class="keywordflow">else</span> MYIDUP_tmp[ipar] = 0;</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;        p4[ipar+2][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;        p4[ipar+2][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;        p4[ipar+2][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;        p4[ipar+2][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;        MomStore[ipar+2] = *momTmp;</div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;      }</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;      <span class="keywordflow">else</span> MYIDUP_tmp[ipar] = -9000; <span class="comment">// No need to set p4, which is already 0 by initialization</span></div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;      <span class="comment">// __modparameters_MOD_not_a_particle__?</span></div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;      <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;MYIDUP_tmp[&quot;</span> &lt;&lt; ipar &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; MYIDUP_tmp[ipar] &lt;&lt; endl;</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;    }</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;  }</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160; </div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;  <span class="comment">// Set alphas</span></div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;  <span class="keywordtype">double</span> defaultRenScale = <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale;</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;  <span class="keywordtype">double</span> defaultFacScale = <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale;</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;  <span class="keywordtype">int</span> defaultNloop = <a class="code" href="TMCFM_8hh.html#a819542dc6ff812e041d403592a6b8990">nlooprun_</a>.nlooprun;</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;  <span class="keywordtype">int</span> defaultNflav = <a class="code" href="TMCFM_8hh.html#a55930b5d389dfae39115156b2bc9a692">nflav_</a>.nflav;</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;  <span class="keywordtype">string</span> defaultPdflabel = <a class="code" href="TMCFM_8hh.html#a4ff35855efcab9061a55f428e228e7dd">pdlabel_</a>.pdlabel;</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;  <span class="keywordtype">double</span> renQ = <a class="code" href="namespaceTUtil.html#a4a00d03fa1abeb4335b6abd9fae90663">InterpretScaleScheme</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, matrixElement, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#aabb9b35b555961e98acc8855bc6c2159">renomalizationScheme</a>, MomStore);</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;  <span class="keywordtype">double</span> facQ = <a class="code" href="namespaceTUtil.html#a4a00d03fa1abeb4335b6abd9fae90663">InterpretScaleScheme</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, matrixElement, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a403e32d8e1aab756f9c2b3ff4863139f">factorizationScheme</a>, MomStore);</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;  <a class="code" href="namespaceTUtil.html#ab551562aaa197841cd0a638f1f38b0ff">SetAlphaS</a>(renQ, facQ, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a7fe18004bd29525d34dcd6cb2b42a5b8">ren_scale_factor</a>, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a82661b3b8d040c36284a99bde2df79ce">fac_scale_factor</a>, 1, 5, <span class="stringliteral">&quot;cteq6_l&quot;</span>); <span class="comment">// Set AlphaS(|Q|/2, mynloop, mynflav, mypartonPDF)</span></div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;  <span class="keywordtype">double</span> alphasVal, alphasmzVal;</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;  <a class="code" href="namespaceTUtil.html#a2f0fce2b3d66f17b673f2e75d87adf00">GetAlphaS</a>(&amp;alphasVal, &amp;alphasmzVal);</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#ab63c4e79eba8f923423f2e97539ebeef">setRenormalizationScale</a>(renQ);</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a383d634378da53d000781f8376f31145">setFactorizationScale</a>(facQ);</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a47b8c8bb2137ecf3e3e1d1b873d3de0b">setAlphaS</a>(alphasVal);</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a8487223242ccff4de3677d673152c7f5">setAlphaSatMZ</a>(alphasmzVal);</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#aa20a0b91511fceb3584ad3a7d1ca210a">setHiggsMassWidth</a>(<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hmass, <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hwidth, 0);</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#aa20a0b91511fceb3584ad3a7d1ca210a">setHiggsMassWidth</a>(<a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.h2mass, <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.h2width, 1);</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::JHUGenMatEl: Set AlphaS:\n&quot;</span></div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tBefore set, alphas scale: &quot;</span> &lt;&lt; defaultRenScale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; defaultFacScale &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\trenQ: &quot;</span> &lt;&lt; renQ &lt;&lt; <span class="stringliteral">&quot; ( x &quot;</span> &lt;&lt; event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a7fe18004bd29525d34dcd6cb2b42a5b8">ren_scale_factor</a> &lt;&lt; <span class="stringliteral">&quot;), facQ: &quot;</span> &lt;&lt; facQ &lt;&lt; <span class="stringliteral">&quot; ( x &quot;</span> &lt;&lt; event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a82661b3b8d040c36284a99bde2df79ce">fac_scale_factor</a> &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tAfter set, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale &lt;&lt; <span class="stringliteral">&quot;, alphas(Qren): &quot;</span> &lt;&lt; alphasVal &lt;&lt; <span class="stringliteral">&quot;, alphas(MZ): &quot;</span> &lt;&lt; alphasmzVal &lt;&lt; endl;</div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;  }</div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160; </div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;  <span class="comment">// Determine te actual ids to compute the ME. Assign ids if any are unknown.</span></div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iv=0; iv&lt;2; iv++){ <span class="comment">// Max. 2 vector bosons</span></div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;    <span class="keywordflow">if</span> (MYIDUP_tmp[2*iv+0]!=0 &amp;&amp; MYIDUP_tmp[2*iv+1]!=0){ <span class="comment">// Z-&gt;2l,2nu,2q, W-&gt;lnu,qq&#39;, G</span></div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;      <span class="comment">// OSSF pairs or just one &quot;V-daughter&quot;</span></div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;        TMath::Sign(1, MYIDUP_tmp[2*iv+0])==TMath::Sign(1, -MYIDUP_tmp[2*iv+1])</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;        ||</div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;        (MYIDUP_tmp[2*iv+0]==-9000 || MYIDUP_tmp[2*iv+1]==-9000)</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;        ) idarray[iv].push_back(pair&lt;int, int&gt;(MYIDUP_tmp[2*iv+0], MYIDUP_tmp[2*iv+1]));</div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;      <span class="comment">// SSSF pairs, ordered already by phi, so avoid the re-ordering inside the ME</span></div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MYIDUP_tmp[2*iv+0]&lt;0) idarray[iv].push_back(pair&lt;int, int&gt;(-MYIDUP_tmp[2*iv+0], MYIDUP_tmp[2*iv+1])); <span class="comment">// Reverse sign of first daughter if SS(--)SF pair</span></div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;      <span class="keywordflow">else</span> idarray[iv].push_back(pair&lt;int, int&gt;(MYIDUP_tmp[2*iv+0], -MYIDUP_tmp[2*iv+1])); <span class="comment">// Reverse sign of daughter if SS(++)SF pair</span></div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;    }</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MYIDUP_tmp[2*iv+0]!=0){ <span class="comment">// -&gt;f?,  one quark is known</span></div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(iv))){ <span class="comment">// (W+/-)-&gt;f?</span></div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[2*iv+0])){ <span class="comment">// (W+)-&gt;u?</span></div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;          <span class="keywordtype">int</span> id_dn = TMath::Sign(1, -MYIDUP_tmp[2*iv+0]);</div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;          <span class="keywordtype">int</span> id_st = TMath::Sign(3, -MYIDUP_tmp[2*iv+0]);</div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;          <span class="keywordtype">int</span> id_bt = TMath::Sign(5, -MYIDUP_tmp[2*iv+0]);</div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;          idarray[iv].push_back(pair&lt;int, int&gt;(MYIDUP_tmp[2*iv+0], id_dn));</div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;          idarray[iv].push_back(pair&lt;int, int&gt;(MYIDUP_tmp[2*iv+0], id_st));</div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;          idarray[iv].push_back(pair&lt;int, int&gt;(MYIDUP_tmp[2*iv+0], id_bt));</div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;        }</div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[2*iv+0])){ <span class="comment">// (W-)-&gt;d?</span></div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;          <span class="keywordtype">int</span> id_up = TMath::Sign(2, -MYIDUP_tmp[2*iv+0]);</div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;          <span class="keywordtype">int</span> id_ch = TMath::Sign(4, -MYIDUP_tmp[2*iv+0]);</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;          idarray[iv].push_back(pair&lt;int, int&gt;(MYIDUP_tmp[2*iv+0], id_up));</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;          idarray[iv].push_back(pair&lt;int, int&gt;(MYIDUP_tmp[2*iv+0], id_ch));</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;        }</div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;      }</div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(iv))){ <span class="comment">// Z-&gt;f?</span></div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;        idarray[iv].push_back(pair&lt;int, int&gt;(MYIDUP_tmp[2*iv+0], -MYIDUP_tmp[2*iv+0]));</div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;      }</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;    }</div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MYIDUP_tmp[2*iv+1]!=0){ <span class="comment">// -&gt;?fb,  one quark is known</span></div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(iv))){ <span class="comment">// (W+/-)-&gt;?fb</span></div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[2*iv+1])){ <span class="comment">// (W-)-&gt;?ub</span></div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;          <span class="keywordtype">int</span> id_dn = TMath::Sign(1, -MYIDUP_tmp[2*iv+1]);</div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;          <span class="keywordtype">int</span> id_st = TMath::Sign(3, -MYIDUP_tmp[2*iv+1]);</div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;          <span class="keywordtype">int</span> id_bt = TMath::Sign(5, -MYIDUP_tmp[2*iv+1]);</div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;          idarray[iv].push_back(pair&lt;int, int&gt;(id_dn, MYIDUP_tmp[2*iv+1]));</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;          idarray[iv].push_back(pair&lt;int, int&gt;(id_st, MYIDUP_tmp[2*iv+1]));</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;          idarray[iv].push_back(pair&lt;int, int&gt;(id_bt, MYIDUP_tmp[2*iv+1]));</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;        }</div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[2*iv+1])){ <span class="comment">// (W+)-&gt;?db</span></div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;          <span class="keywordtype">int</span> id_up = TMath::Sign(2, -MYIDUP_tmp[2*iv+1]);</div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;          <span class="keywordtype">int</span> id_ch = TMath::Sign(4, -MYIDUP_tmp[2*iv+1]);</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;          idarray[iv].push_back(pair&lt;int, int&gt;(id_up, MYIDUP_tmp[2*iv+1]));</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;          idarray[iv].push_back(pair&lt;int, int&gt;(id_ch, MYIDUP_tmp[2*iv+1]));</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;        }</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;      }</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(iv))){ <span class="comment">// Z-&gt;?fb</span></div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;        idarray[iv].push_back(pair&lt;int, int&gt;(-MYIDUP_tmp[2*iv+1], MYIDUP_tmp[2*iv+1]));</div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;      }</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;    }</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;    <span class="keywordflow">else</span>{ <span class="comment">// Both fermions unknown</span></div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(iv))){ <span class="comment">// (W+/-)-&gt;??</span></div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iqu=1; iqu&lt;=2; iqu++){</div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;          <span class="keywordtype">int</span> id_up = iqu*2;</div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iqd=1; iqd&lt;=3; iqd++){</div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;            <span class="keywordtype">int</span> id_dn = iqd*2-1;</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;            <span class="keywordflow">if</span> (iv==0){ idarray[iv].push_back(pair&lt;int, int&gt;(id_up, -id_dn)); idarray[iv].push_back(pair&lt;int, int&gt;(-id_dn, id_up)); }</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;            <span class="keywordflow">else</span>{ idarray[iv].push_back(pair&lt;int, int&gt;(id_dn, -id_up)); idarray[iv].push_back(pair&lt;int, int&gt;(-id_up, id_dn)); }</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;          }</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;        }</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;      }</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(iv))){ <span class="comment">// Z-&gt;??</span></div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq=1; iq&lt;=5; iq++){ idarray[iv].push_back(pair&lt;int, int&gt;(iq, -iq)); idarray[iv].push_back(pair&lt;int, int&gt;(-iq, iq)); }</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;      }</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;    }</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;  }</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160; </div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;  <span class="comment">// Variables to set L1/2 and R1/2 couplings into RcdME</span></div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> InvalidMode=-1, WWMode=0, ZZMode=1, ZgMode=5, ggMode=7;</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;  <span class="keywordtype">int</span> VVMode=InvalidMode;</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1))) VVMode=WWMode;</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1))) VVMode=ZZMode;</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1))) VVMode=ggMode;</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;    (<a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1)))</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;    ||</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;    (<a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1)) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0)))</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;    ) VVMode=ZgMode;</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;  <span class="keywordtype">double</span> aL1=0, aL2=0, aR1=0, aR2=0;</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160; </div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;  <span class="keywordtype">int</span> nNonZero=0;</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v1=0; v1&lt;idarray[0].size(); v1++){</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v2=0; v2&lt;idarray[1].size(); v2++){</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;      <span class="comment">// Convert the particle ids to JHU convention</span></div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;      <span class="keywordflow">if</span> (idarray[0].at(v1).first!=-9000) MYIDUP[0] = <a class="code" href="TModParameters_8hh.html#a00e07c5a686985e7a030b7349d0f4998">convertLHEreverse</a>(&amp;(idarray[0].at(v1).first));</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;      <span class="keywordflow">if</span> (idarray[0].at(v1).<a class="code" href="namespacemodparameters.html#ab25730bf36fa1669616bd6fbf66f8614">second</a>!=-9000) MYIDUP[1] = <a class="code" href="TModParameters_8hh.html#a00e07c5a686985e7a030b7349d0f4998">convertLHEreverse</a>(&amp;(idarray[0].at(v1).<a class="code" href="namespacemodparameters.html#ab25730bf36fa1669616bd6fbf66f8614">second</a>));</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;      <span class="keywordflow">if</span> (idarray[1].at(v2).first!=-9000) MYIDUP[2] = <a class="code" href="TModParameters_8hh.html#a00e07c5a686985e7a030b7349d0f4998">convertLHEreverse</a>(&amp;(idarray[1].at(v2).first));</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;      <span class="keywordflow">if</span> (idarray[1].at(v2).<a class="code" href="namespacemodparameters.html#ab25730bf36fa1669616bd6fbf66f8614">second</a>!=-9000) MYIDUP[3] = <a class="code" href="TModParameters_8hh.html#a00e07c5a686985e7a030b7349d0f4998">convertLHEreverse</a>(&amp;(idarray[1].at(v2).<a class="code" href="namespacemodparameters.html#ab25730bf36fa1669616bd6fbf66f8614">second</a>));</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160; </div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;      <span class="comment">// Check working ids</span></div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;      <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){ <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idau=0; idau&lt;4; idau++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;MYIDUP[&quot;</span> &lt;&lt; idau &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; MYIDUP[idau] &lt;&lt; endl; }</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160; </div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;      <span class="comment">// Determine M_V and Ga_V in JHUGen, needed for g1 vs everything else.</span></div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;2; ip++){ idfirst[ip]=MYIDUP[ip]; idsecond[ip]=MYIDUP[ip+2]; }</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;      <a class="code" href="TModJHUGenMELA_8hh.html#a3edf1b64527ef72ccfa6393ba3740408">__modjhugenmela_MOD_setdecaymodes</a>(idfirst, idsecond); <span class="comment">// Set M_V and Ga_V in JHUGen</span></div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;      <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;        <span class="keywordtype">double</span> mv, gv;</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;        <a class="code" href="TModJHUGenMELA_8hh.html#a4a1867add3675a9fa2482cff9f4537d3">__modjhugenmela_MOD_getmvgv</a>(&amp;mv, &amp;gv);</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;        <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::JHUGenMatEl: M_V=&quot;</span> &lt;&lt; mv/GeV &lt;&lt; <span class="stringliteral">&quot;, Ga_V=&quot;</span> &lt;&lt; gv/GeV &lt;&lt; endl;</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;        <a class="code" href="TModJHUGenMELA_8hh.html#aa6bfa1ec9233870bf10dbaeaa87d4e32">__modjhugenmela_MOD_getmvprimegvprime</a>(&amp;mv, &amp;gv);</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;        <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::JHUGenMatEl: M_Vprime=&quot;</span> &lt;&lt; mv/GeV &lt;&lt; <span class="stringliteral">&quot;, Ga_Vprime=&quot;</span> &lt;&lt; gv/GeV &lt;&lt; endl;</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;      }</div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160; </div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;      <span class="comment">// Sum over possible left/right couplings of the Vs</span></div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;      <span class="keywordtype">double</span> aLRtmp[4]={ 0 };</div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;      <a class="code" href="TModJHUGenMELA_8hh.html#a58ed96aa08541deafc3103feb3620675">__modjhugenmela_MOD_getdecaycouplings</a>(&amp;VVMode, MYIDUP, &amp;(aLRtmp[0]), &amp;(aLRtmp[1]), &amp;(aLRtmp[2]), &amp;(aLRtmp[3]));</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;      <span class="keywordflow">if</span> (idarray[0].size()&gt;1){</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;        aL1 = sqrt(pow(aL1, 2)+pow(aLRtmp[0], 2));</div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;        aR1 = sqrt(pow(aR1, 2)+pow(aLRtmp[1], 2));</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;      }</div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;        aL1 = aLRtmp[0];</div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;        aR1 = aLRtmp[1];</div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;      }</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;      <span class="keywordflow">if</span> (idarray[1].size()&gt;1){</div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;        aL2 = sqrt(pow(aL2, 2)+pow(aLRtmp[2], 2));</div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;        aR2 = sqrt(pow(aR2, 2)+pow(aLRtmp[3], 2));</div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;      }</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;        aL2 = aLRtmp[2];</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;        aR2 = aLRtmp[3];</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;      }</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160; </div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;      <span class="keywordtype">double</span> MatElTmp=0.;</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4539519c2d018fd29228bdd605c76c47">TVar::ZZGG</a>){</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;        <span class="keywordflow">if</span> (isSpinZero) <a class="code" href="TModHiggsMatEl_8hh.html#a0e6333bee6846f54f669b690120ce7d0">__modhiggs_MOD_evalamp_gg_h_vv</a>(p4, MYIDUP, &amp;MatElTmp);</div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isSpinTwo) <a class="code" href="TModGravitonMatEl_8hh.html#a8cd4f4f8e0f9b84bb35400f5f8ab5d7c">__modgraviton_MOD_evalamp_gg_g_vv</a>(p4, MYIDUP, &amp;MatElTmp);</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;      }</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a>){</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;        <span class="keywordflow">if</span> (isSpinOne) <a class="code" href="TModZprimeMatEl_8hh.html#a86ad8934941c5e677cbc8f1ed955bad8">__modzprime_MOD_evalamp_qqb_zprime_vv</a>(p4, MYIDUP, &amp;MatElTmp);</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isSpinTwo) <a class="code" href="TModGravitonMatEl_8hh.html#a996d17b7ea2ec245e2f96c2709a175e9">__modgraviton_MOD_evalamp_qqb_g_vv</a>(p4, MYIDUP, &amp;MatElTmp);</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;      }</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a>){</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;        <span class="keywordflow">if</span> (isSpinZero) <a class="code" href="TModHiggsMatEl_8hh.html#af823c96e0e093930152987df81ffcf2f">__modhiggs_MOD_evalamp_h_vv</a>(p4, MYIDUP, &amp;MatElTmp);</div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isSpinOne) <a class="code" href="TModZprimeMatEl_8hh.html#ac71b783c7df3cdd6cf98ab3419e6b2a2">__modzprime_MOD_evalamp_zprime_vv</a>(p4, MYIDUP, &amp;MatElTmp);</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isSpinTwo) <a class="code" href="TModGravitonMatEl_8hh.html#a8f773a5d358d8f4b82511644f951476f">__modgraviton_MOD_evalamp_g_vv</a>(p4, MYIDUP, &amp;MatElTmp);</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;      }</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;      <span class="comment">// Add CKM elements since they are not included</span></div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(0))) MatElTmp *= pow(<a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;(idarray[0].at(v1).first), &amp;(idarray[0].at(v1).<a class="code" href="namespacemodparameters.html#ab25730bf36fa1669616bd6fbf66f8614">second</a>)), 2);</div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(1))) MatElTmp *= pow(<a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;(idarray[1].at(v2).first), &amp;(idarray[1].at(v2).<a class="code" href="namespacemodparameters.html#ab25730bf36fa1669616bd6fbf66f8614">second</a>)), 2);</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160; </div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;      <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;=====\nTUtil::JHUGenMatEl: Instance MatElTmp = &quot;</span> &lt;&lt; MatElTmp &lt;&lt; <span class="stringliteral">&quot;\n=====&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;      MatElSq += MatElTmp;</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;      <span class="keywordflow">if</span> (MatElTmp&gt;0.) nNonZero++;</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;    }</div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;  }</div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;  <span class="keywordflow">if</span> (nNonZero&gt;0) MatElSq /= ((double)nNonZero);</div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;  <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::JHUGenMatEl: Number of matrix element instances computed: &quot;</span> &lt;&lt; nNonZero &lt;&lt; endl;</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::JHUGenMatEl: MatElSq after division = &quot;</span> &lt;&lt; MatElSq &lt;&lt; endl;</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;  }</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160; </div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;  <span class="comment">// Set aL/R 1,2 into RcdME</span></div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a4949a3f6e4a6e6d4337f98bb00d9fd7a">setVDaughterCouplings</a>(aL1, aR1, 0);</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a4949a3f6e4a6e6d4337f98bb00d9fd7a">setVDaughterCouplings</a>(aL2, aR2, 1);</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;  <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;TUtil::JHUGenMatEl: aL1, aR1, aL2, aR2: &quot;</span></div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;    &lt;&lt; aL1 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; aR1 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; aL2 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; aR2</div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;    &lt;&lt; endl;</div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160; </div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;  <span class="comment">// This constant is needed to account for the different units used in JHUGen compared to MCFM</span></div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;  <span class="keywordtype">int</span> GeVexponent_MEsq = 4-((<a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>)mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size())*2;</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a>) GeVexponent_MEsq += 2; <span class="comment">// Amplitude missing m from production and 1/m**2 from propagator == Amplitude missing 1/m == MEsq missing 1/m**2</span></div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;  <span class="keywordtype">double</span> constant = pow(GeV, -GeVexponent_MEsq);</div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;  MatElSq *= constant;</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160; </div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;  <span class="comment">// Set RcdME information for ME and parton distributions, taking into account the mothers if id!=0 (i.e. if not unknown).</span></div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;  <span class="keywordflow">if</span> (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(0).first!=0 &amp;&amp; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(1).first!=0){</div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;    <span class="keywordtype">int</span> ix=5, iy=5;</div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;    <span class="keywordflow">if</span> (abs(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(0).first)&lt;6) ix=mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(0).first + 5;</div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;    <span class="keywordflow">if</span> (abs(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(1).first)&lt;6) iy=mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(1).first + 5;</div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;    <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[iy][ix]=MatElSq; <span class="comment">// Note that SumMEPdf receives a transposed msq</span></div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;  }</div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4539519c2d018fd29228bdd605c76c47">TVar::ZZGG</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a>) <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[5][5]=MatElSq;</div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a>){</div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix=0; ix&lt;5; ix++){ <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[ix][10-ix]=MatElSq; <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[10-ix][ix]=MatElSq; }</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;    }</div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;  }</div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>!=<a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a>) <a class="code" href="namespaceTUtil.html#adf7b61bc902b23177090ce6b48a7f026">SumMEPDF</a>(MomStore[0], MomStore[1], <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>, RcdME, EBEAM, verbosity);</div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;  <span class="keywordflow">else</span>{ <span class="comment">// If production is ZZINDEPENDENT, only set gg index with fx1,2[g,g]=1.</span></div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;    <span class="keywordtype">double</span> fx_dummy[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>]={ 0 }; fx_dummy[5]=1.;</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;    RcdME-&gt;<a class="code" href="classMelaIO.html#a98676a9ef8bf3590b6f70a523dae212c">setPartonWeights</a>(fx_dummy, fx_dummy);</div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;    RcdME-&gt;<a class="code" href="classMelaIO.html#abe83c33dd9da5a5ae0eb622177a5bb5e">setMEArray</a>(<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;    RcdME-&gt;<a class="code" href="classMelaIO.html#afb45877052ee8742c8599476a6ef2a14">computeWeightedMEArray</a>();</div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;  }</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160; </div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;  <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::JHUGenMatEl: Final MatElSq = &quot;</span> &lt;&lt; MatElSq &lt;&lt; endl;</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160; </div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;  <span class="comment">// Reset alphas</span></div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::JHUGenMatEl: Reset AlphaS:\n&quot;</span></div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tBefore reset, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale &lt;&lt; endl;</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;  }</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;  <a class="code" href="namespaceTUtil.html#ab551562aaa197841cd0a638f1f38b0ff">SetAlphaS</a>(defaultRenScale, defaultFacScale, 1., 1., defaultNloop, defaultNflav, defaultPdflabel);</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;    <a class="code" href="namespaceTUtil.html#a2f0fce2b3d66f17b673f2e75d87adf00">GetAlphaS</a>(&amp;alphasVal, &amp;alphasmzVal);</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::JHUGenMatEl: Reset AlphaS result:\n&quot;</span></div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tAfter reset, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale &lt;&lt; <span class="stringliteral">&quot;, alphas(Qren): &quot;</span> &lt;&lt; alphasVal &lt;&lt; <span class="stringliteral">&quot;, alphas(MZ): &quot;</span> &lt;&lt; alphasmzVal &lt;&lt; endl;</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;  }</div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;  <span class="keywordflow">return</span> MatElSq;</div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;}</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160; </div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;<span class="comment">// VBF and HJJ (QCD), H undecayed, includes H BW</span></div>
<div class="line"><a name="l05118"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#ae53582caadc4362e0dc6f9519dede582"> 5118</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceTUtil.html#ae53582caadc4362e0dc6f9519dede582">TUtil::HJJMatEl</a>(</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1">TVar::Process</a>&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28c">TVar::Production</a>&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815f">TVar::MatrixElement</a>&amp; matrixElement,</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;  <a class="code" href="structTVar_1_1event__scales__type.html">event_scales_type</a>* event_scales, <a class="code" href="classMelaIO.html">MelaIO</a>* RcdME,</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; EBEAM,</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;  <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049">TVar::VerbosityLevel</a> verbosity</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;  ){</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> GeV=1./100.; <span class="comment">// JHUGen mom. scale factor</span></div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;  <span class="keywordtype">double</span> sum_msqjk = 0;</div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;  <span class="comment">// by default assume only gg productions</span></div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;  <span class="comment">// FOTRAN convention -5    -4   -3  -2    -1  0 1 2 3 4 5</span></div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;  <span class="comment">//     parton flavor bbar cbar sbar ubar dbar g d u s c b</span></div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;  <span class="comment">// C++ convention     0     1   2    3    4   5 6 7 8 9 10</span></div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;  <span class="comment">//2-D matrix is reversed in fortran</span></div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;  <span class="comment">// msq[ parton2 ] [ parton1 ]</span></div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;  <span class="comment">//      flavor_msq[jj][ii] = fx1[ii]*fx2[jj]*msq[jj][ii];</span></div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;  <span class="keywordtype">double</span> MatElsq[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>][<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>]={ { 0 } };</div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;  <span class="keywordtype">double</span> MatElsq_tmp[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>][<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>]={ { 0 } }; <span class="comment">// For H+J</span></div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;  <span class="keywordtype">double</span> msq_tmp=0; <span class="comment">// For &quot;*_exact&quot;</span></div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160; </div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;  <span class="keywordflow">if</span> (matrixElement!=<a class="code" href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815faba6e6b23b0115bbaa919563a0626be03">TVar::JHUGen</a>){ <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::HJJMatEl: Non-JHUGen MEs are not supported&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> sum_msqjk; }</div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;  <span class="keywordflow">if</span> (!(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3706a5c493f245b1f6231e93e31383ea">TVar::JQCD</a>)){ <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::HJJMatEl: Production is not supported!&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> sum_msqjk; }</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160; </div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;  <span class="comment">// Notice that partIncCode is specific for this subroutine</span></div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;  <span class="keywordtype">int</span> nRequested_AssociatedJets=2;</div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3706a5c493f245b1f6231e93e31383ea">TVar::JQCD</a>) nRequested_AssociatedJets=1;</div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;  <span class="keywordtype">int</span> partIncCode=<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba73861ec433a26ae79407bfe3f2f7b71a">TVar::kUseAssociated_Jets</a>; <span class="comment">// Only use associated partons in the pT=0 frame boost</span></div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;  <a class="code" href="structTVar_1_1simple__event__record.html">simple_event_record</a> mela_event;</div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a743a8c341936dbaa10ce50a5b8d87eba">AssociationCode</a>=partIncCode;</div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aca54cfc4690b7f0ba78f5af03d0f1ddf">nRequested_AssociatedJets</a>=nRequested_AssociatedJets;</div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;  <a class="code" href="namespaceTUtil.html#a2bfa5115b0bf398c2fae3cc36aedf9f5">GetBoostedParticleVectors</a>(</div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;    RcdME-&gt;<a class="code" href="classMelaIO.html#aebe453b6e0a6bf08d7aa68c1927ae48f">melaCand</a>,</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;    mela_event,</div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;    verbosity</div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;    );</div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;  <span class="keywordflow">if</span> (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.size()==0){ <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::HJJMatEl: Number of associated particles is 0!&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> sum_msqjk; }</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160; </div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;  <span class="keywordtype">int</span> MYIDUP_tmp[4]={ 0 }; <span class="comment">// &quot;Incoming&quot; partons 1, 2, &quot;outgoing&quot; partons 3, 4</span></div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;  <span class="keywordtype">double</span> p4[5][4]={ { 0 } };</div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;  <span class="keywordtype">double</span> pOneJet[4][4] ={ { 0 } }; <span class="comment">// For HJ</span></div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;  TLorentzVector MomStore[<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>];</div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; i++) MomStore[i].SetXYZT(0, 0, 0, 0);</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160; </div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;  <span class="comment">// p4(0:4,i) = (E(i),px(i),py(i),pz(i))</span></div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;  <span class="comment">// i=0,1: g1,g2 or q1, qb2 (outgoing convention)</span></div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;  <span class="comment">// i=2,3: J1, J2 in outgoing convention when possible</span></div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;  <span class="comment">// i=4: H</span></div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ipar=0; ipar&lt;2; ipar++){</div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;    TLorentzVector* momTmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second);</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;    <span class="keywordtype">int</span>* idtmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).first);</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(*idtmp)) MYIDUP_tmp[ipar] = *idtmp;</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;    <span class="keywordflow">else</span> MYIDUP_tmp[ipar] = 0;</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;    <span class="keywordflow">if</span> (momTmp-&gt;T()&gt;0.){</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;      p4[ipar][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;      p4[ipar][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;      p4[ipar][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;      p4[ipar][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;      MomStore[ipar] = (*momTmp);</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;    }</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;      p4[ipar][0] = -momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;      p4[ipar][1] = -momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;      p4[ipar][2] = -momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;      p4[ipar][3] = -momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;      MomStore[ipar] = -(*momTmp);</div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;      MYIDUP_tmp[ipar] = -MYIDUP_tmp[ipar];</div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;    }</div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;  }</div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar=0; ipar&lt;2; ipar++){</div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;    <span class="keywordflow">if</span> (ipar&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.size()){</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;      TLorentzVector* momTmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.at(ipar).second);</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;      <span class="keywordtype">int</span>* idtmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.at(ipar).first);</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(*idtmp)) MYIDUP_tmp[ipar+2] = *idtmp;</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;      <span class="keywordflow">else</span> MYIDUP_tmp[ipar+2] = 0;</div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;      p4[ipar+2][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;      p4[ipar+2][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;      p4[ipar+2][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;      p4[ipar+2][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;      MomStore[ipar+6] = (*momTmp); <span class="comment">// i==(2, 3, 4) is (J1, J2, H), recorded as MomStore (I1, I2, 0, 0, 0, H, J1, J2)</span></div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;    }</div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;    <span class="keywordflow">else</span> MYIDUP_tmp[ipar+2] = -9000; <span class="comment">// No need to set p4, which is already 0 by initialization</span></div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;  }</div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar=0; ipar&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size(); ipar++){</div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;    TLorentzVector* momTmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.at(ipar).second);</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;    p4[4][0] += momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;    p4[4][1] += momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;    p4[4][2] += momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;    p4[4][3] += momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;    MomStore[5] = MomStore[5] + (*momTmp); <span class="comment">// i==(2, 3, 4) is (J1, J2, H), recorded as MomStore (I1, I2, 0, 0, 0, H, J1, J2)</span></div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;  }</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;  <span class="comment">// Momenta for HJ</span></div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 4; i++){</div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;    <span class="keywordflow">if</span> (i&lt;2){ <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; 4; j++) pOneJet[i][j] = p4[i][j]; } <span class="comment">// p1 p2</span></div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i==2){ <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; 4; j++) pOneJet[i][j] = p4[4][j]; } <span class="comment">// H</span></div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;    <span class="keywordflow">else</span>{ <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; 4; j++) pOneJet[i][j] = p4[2][j]; } <span class="comment">// J1</span></div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;  }</div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;  <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){ </div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;5; i++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;p[&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;] (Px, Py, Pz, E, M):\t&quot;</span> &lt;&lt; p4[i][1]/GeV &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; p4[i][2]/GeV &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; p4[i][3]/GeV &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; p4[i][0]/GeV &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; sqrt(fabs(pow(p4[i][0], 2)-pow(p4[i][1], 2)-pow(p4[i][2], 2)-pow(p4[i][3], 2)))/GeV &lt;&lt; endl;</div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;One-jet momenta: &quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;4; i++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;pOneJet[&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;] (Px, Py, Pz, E, M):\t&quot;</span> &lt;&lt; pOneJet[i][1]/GeV &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; pOneJet[i][2]/GeV &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; pOneJet[i][3]/GeV &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; pOneJet[i][0]/GeV &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; sqrt(fabs(pow(pOneJet[i][0], 2)-pow(pOneJet[i][1], 2)-pow(pOneJet[i][2], 2)-pow(pOneJet[i][3], 2)))/GeV &lt;&lt; endl;</div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;  }</div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160; </div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;  <span class="keywordtype">double</span> defaultRenScale = <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale;</div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;  <span class="keywordtype">double</span> defaultFacScale = <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale;</div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;  <span class="keywordtype">int</span> defaultNloop = <a class="code" href="TMCFM_8hh.html#a819542dc6ff812e041d403592a6b8990">nlooprun_</a>.nlooprun;</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;  <span class="keywordtype">int</span> defaultNflav = <a class="code" href="TMCFM_8hh.html#a55930b5d389dfae39115156b2bc9a692">nflav_</a>.nflav;</div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;  <span class="keywordtype">string</span> defaultPdflabel = <a class="code" href="TMCFM_8hh.html#a4ff35855efcab9061a55f428e228e7dd">pdlabel_</a>.pdlabel;</div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;  <span class="keywordtype">double</span> renQ = <a class="code" href="namespaceTUtil.html#a4a00d03fa1abeb4335b6abd9fae90663">InterpretScaleScheme</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, matrixElement, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#aabb9b35b555961e98acc8855bc6c2159">renomalizationScheme</a>, MomStore);</div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;  <span class="keywordtype">double</span> facQ = <a class="code" href="namespaceTUtil.html#a4a00d03fa1abeb4335b6abd9fae90663">InterpretScaleScheme</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, matrixElement, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a403e32d8e1aab756f9c2b3ff4863139f">factorizationScheme</a>, MomStore);</div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;  <a class="code" href="namespaceTUtil.html#ab551562aaa197841cd0a638f1f38b0ff">SetAlphaS</a>(renQ, facQ, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a7fe18004bd29525d34dcd6cb2b42a5b8">ren_scale_factor</a>, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a82661b3b8d040c36284a99bde2df79ce">fac_scale_factor</a>, 1, 5, <span class="stringliteral">&quot;cteq6_l&quot;</span>);</div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;  <span class="keywordtype">double</span> alphasVal, alphasmzVal;</div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;  <a class="code" href="namespaceTUtil.html#a2f0fce2b3d66f17b673f2e75d87adf00">GetAlphaS</a>(&amp;alphasVal, &amp;alphasmzVal);</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#ab63c4e79eba8f923423f2e97539ebeef">setRenormalizationScale</a>(renQ);</div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a383d634378da53d000781f8376f31145">setFactorizationScale</a>(facQ);</div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a47b8c8bb2137ecf3e3e1d1b873d3de0b">setAlphaS</a>(alphasVal);</div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a8487223242ccff4de3677d673152c7f5">setAlphaSatMZ</a>(alphasmzVal);</div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#aa20a0b91511fceb3584ad3a7d1ca210a">setHiggsMassWidth</a>(<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hmass, <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hwidth, 0);</div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#aa20a0b91511fceb3584ad3a7d1ca210a">setHiggsMassWidth</a>(<a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.h2mass, <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.h2width, 1);</div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::HJJMatEl: Set AlphaS:\n&quot;</span></div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tBefore set, alphas scale: &quot;</span> &lt;&lt; defaultRenScale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; defaultFacScale &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\trenQ: &quot;</span> &lt;&lt; renQ &lt;&lt; <span class="stringliteral">&quot; ( x &quot;</span> &lt;&lt; event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a7fe18004bd29525d34dcd6cb2b42a5b8">ren_scale_factor</a> &lt;&lt; <span class="stringliteral">&quot;), facQ: &quot;</span> &lt;&lt; facQ &lt;&lt; <span class="stringliteral">&quot; ( x &quot;</span> &lt;&lt; event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a82661b3b8d040c36284a99bde2df79ce">fac_scale_factor</a> &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tAfter set, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale &lt;&lt; <span class="stringliteral">&quot;, alphas(Qren): &quot;</span> &lt;&lt; alphasVal &lt;&lt; <span class="stringliteral">&quot;, alphas(MZ): &quot;</span> &lt;&lt; alphasmzVal &lt;&lt; endl;</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;  }</div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160; </div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;  <span class="comment">// Since we have a lot of these checks, do them here.</span></div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;  <span class="keywordtype">bool</span> partonIsUnknown[4];</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;4; ip++) partonIsUnknown[ip] = (MYIDUP_tmp[ip]==0);</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160; </div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;  <span class="comment">// NOTE ON HJ AND HJJ CHANNEL HASHES:</span></div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;  <span class="comment">// THEY ONLY RETURN ISEL&gt;=JSEL CASES. ISEL&lt;JSEL NEEDS TO BE DONE MANUALLY.</span></div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3706a5c493f245b1f6231e93e31383ea">TVar::JQCD</a>){ <span class="comment">// Computation is already for all possible qqb/qg/qbg/gg, and incoming q, qb and g flavor have 1-1 correspondence to the outgoing jet flavor.</span></div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;    <a class="code" href="TModHiggsJMatEl_8hh.html#af791d297390be936ae83e21a176c34dd">__modhiggsj_MOD_evalamp_hj</a>(pOneJet, MatElsq_tmp);</div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isel=-5; isel&lt;=5; isel++){</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;      <span class="keywordflow">if</span> (!partonIsUnknown[0] &amp;&amp; !((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[0]) &amp;&amp; isel==0) || MYIDUP_tmp[0]==isel)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jsel=-5; jsel&lt;=5; jsel++){</div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;        <span class="keywordflow">if</span> (!partonIsUnknown[1] &amp;&amp; !((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[1]) &amp;&amp; jsel==0) || MYIDUP_tmp[1]==jsel)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;        <span class="keywordtype">int</span> rsel;</div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;        <span class="keywordflow">if</span> (isel!=0 &amp;&amp; jsel!=0) rsel=0; <span class="comment">// Covers qqb-&gt;Hg</span></div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isel==0) rsel=jsel; <span class="comment">// Covers gg-&gt;Hg, gq-&gt;Hq, gqb-&gt;Hqb</span></div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;        <span class="keywordflow">else</span> rsel=isel; <span class="comment">// Covers qg-&gt;Hq, qbg-&gt;Hqb</span></div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;        <span class="keywordflow">if</span> (!partonIsUnknown[2] &amp;&amp; !((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[2]) &amp;&amp; rsel==0) || MYIDUP_tmp[2]==rsel)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;        MatElsq[jsel+5][isel+5] = MatElsq_tmp[jsel+5][isel+5]; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;        <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; endl;</div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;      }</div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;    }</div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;  }</div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a>){</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;    <span class="keyword">const</span> std::vector&lt;TNumericUtil::intTriplet_t&gt;&amp; ijsel = <a class="code" href="namespaceTJHUGenUtils.html#addcc3291bfa0d4cfc3329f05ae43f929">Get_JHUGenHash_OnshellHJJHash</a>();</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;    <span class="keywordtype">int</span> nijchannels = ijsel.size();</div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ic=0; ic&lt;nijchannels; ic++){</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;      <span class="comment">// Emulate EvalWeighted_HJJ_test</span></div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;      <span class="keywordtype">int</span> isel = ijsel[ic][0];</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;      <span class="keywordtype">int</span> jsel = ijsel[ic][1];</div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;      <span class="keywordtype">int</span> code = ijsel[ic][2];</div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160; </div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;      <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;HJJ channel &quot;</span> &lt;&lt; ic &lt;&lt; <span class="stringliteral">&quot; code &quot;</span> &lt;&lt; code &lt;&lt; endl;</div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160; </div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;      <span class="comment">// Default assignments</span></div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;      <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;HJJ mother unswapped case&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;      <span class="keywordtype">int</span> rsel=isel;</div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;      <span class="keywordtype">int</span> ssel=jsel;</div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160; </div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;        (partonIsUnknown[0] || ((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[0]) &amp;&amp; isel==0) || MYIDUP_tmp[0]==isel))</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;        &amp;&amp;</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;        (partonIsUnknown[1] || ((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[1]) &amp;&amp; jsel==0) || MYIDUP_tmp[1]==jsel))</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;        ){ <span class="comment">// Do it this way to be able to swap isel and jsel later</span></div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160; </div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;        <span class="keywordflow">if</span> (isel==0 &amp;&amp; jsel==0){ <span class="comment">// gg-&gt;?</span></div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;          <span class="keywordflow">if</span> (code==2){ <span class="comment">// gg-&gt;qqb</span></div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;            <span class="comment">// Only compute u-ub. The amplitude is multiplied by nf=5</span></div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;            rsel=1;</div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;            ssel=-1;</div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;              (partonIsUnknown[2] || (<a class="code" href="namespacePDGHelpers.html#a01f8690aaafe2c1d9b2497a41270f56a">PDGHelpers::isAQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&gt;0))</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;              &amp;&amp;</div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;              (partonIsUnknown[3] || (<a class="code" href="namespacePDGHelpers.html#a01f8690aaafe2c1d9b2497a41270f56a">PDGHelpers::isAQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&lt;0))</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;              ){</div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;              <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;msq_tmp);</div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;              MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;              <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;            }</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;              (partonIsUnknown[2] || (<a class="code" href="namespacePDGHelpers.html#a01f8690aaafe2c1d9b2497a41270f56a">PDGHelpers::isAQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&lt;0))</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;              &amp;&amp;</div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;              (partonIsUnknown[3] || (<a class="code" href="namespacePDGHelpers.html#a01f8690aaafe2c1d9b2497a41270f56a">PDGHelpers::isAQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&gt;0))</div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;              ){</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;              <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;msq_tmp);</div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;              MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;              <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;            }</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;          }</div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;          <span class="keywordflow">else</span>{ <span class="comment">// gg-&gt;gg</span></div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;            <span class="comment">// rsel=ssel=g already</span></div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;              (partonIsUnknown[2] || (<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[2]) &amp;&amp; rsel==0))</div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;              &amp;&amp;</div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;              (partonIsUnknown[3] || (<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[3]) &amp;&amp; ssel==0))</div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;              ){</div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;              <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;msq_tmp);</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;              MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;              <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;            }</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;          }</div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;        }</div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isel==0 || jsel==0){ <span class="comment">// qg/qbg/gq/gqb-&gt;qg/qbg/gq/gqb</span></div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;            (partonIsUnknown[2] || ((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[2]) &amp;&amp; rsel==0) || MYIDUP_tmp[2]==rsel))</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;            (partonIsUnknown[3] || ((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[3]) &amp;&amp; ssel==0) || MYIDUP_tmp[3]==ssel))</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;            ){</div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;            <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;msq_tmp);</div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;            MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;            <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;          }</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;            (partonIsUnknown[2] || ((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[2]) &amp;&amp; ssel==0) || MYIDUP_tmp[2]==ssel))</div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;            (partonIsUnknown[3] || ((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[3]) &amp;&amp; rsel==0) || MYIDUP_tmp[3]==rsel))</div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;            ){</div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;            <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;msq_tmp);</div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;            MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;            <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;          }</div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;        }</div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((isel&gt;0 &amp;&amp; jsel&lt;0) || (isel&lt;0 &amp;&amp; jsel&gt;0)){ <span class="comment">// qQb/qbQ-&gt;?</span></div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;          <span class="keywordflow">if</span> (code==1 &amp;&amp; isel==-jsel){ <span class="comment">// qqb/qbq-&gt;gg</span></div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;            rsel=0; ssel=0;</div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;              (partonIsUnknown[2] || <a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[2]))</div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;              &amp;&amp;</div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;              (partonIsUnknown[3] || <a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[3]))</div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;              ){</div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;              <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;msq_tmp);</div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;              MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;              <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;            }</div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;          }</div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (code==3 &amp;&amp; isel==-jsel){ <span class="comment">// qqb-&gt;QQb</span></div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;            <span class="keywordflow">if</span> (abs(isel)!=1){ rsel=1; ssel=-1; } <span class="comment">// Make sure rsel, ssel are not of same flavor as isel, jsel</span></div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;            <span class="keywordflow">else</span>{ rsel=2; ssel=-2; }</div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;            <span class="comment">// The amplitude is aready multiplied by nf-1, so no need to calculate everything (nf-1) times.</span></div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;              (partonIsUnknown[2] &amp;&amp; partonIsUnknown[3])</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;              ||</div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;              (partonIsUnknown[2] &amp;&amp; std::abs(MYIDUP_tmp[3])!=std::abs(isel) &amp;&amp; MYIDUP_tmp[3]&lt;0)</div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;              ||</div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;              (std::abs(MYIDUP_tmp[2])!=std::abs(isel) &amp;&amp; MYIDUP_tmp[2]&gt;0 &amp;&amp; partonIsUnknown[3])</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;              ||</div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;              (std::abs(MYIDUP_tmp[2])!=std::abs(isel) &amp;&amp; MYIDUP_tmp[2]==-MYIDUP_tmp[3] &amp;&amp; MYIDUP_tmp[2]&gt;0)</div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;              ){</div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;              <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;msq_tmp);</div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;              MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;              <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;            }</div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;              (partonIsUnknown[2] &amp;&amp; partonIsUnknown[3])</div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;              ||</div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;              (partonIsUnknown[2] &amp;&amp; std::abs(MYIDUP_tmp[3])!=std::abs(isel) &amp;&amp; MYIDUP_tmp[3]&gt;0)</div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;              ||</div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;              (std::abs(MYIDUP_tmp[2])!=std::abs(isel) &amp;&amp; MYIDUP_tmp[2]&lt;0 &amp;&amp; partonIsUnknown[3])</div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;              ||</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;              (std::abs(MYIDUP_tmp[2])!=std::abs(isel) &amp;&amp; MYIDUP_tmp[2]==-MYIDUP_tmp[3] &amp;&amp; MYIDUP_tmp[2]&lt;0)</div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;              ){</div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;              <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;msq_tmp);</div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;              MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;              <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;            }</div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;          }</div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;          <span class="keywordflow">else</span>{ <span class="comment">// qQb/qbQ-&gt;qQb/qbQ</span></div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;              (partonIsUnknown[2] || MYIDUP_tmp[2]==rsel)</div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;              &amp;&amp;</div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;              (partonIsUnknown[3] || MYIDUP_tmp[3]==ssel)</div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;              ){</div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;              <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;msq_tmp);</div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;              MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;              <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;            }</div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;              (partonIsUnknown[2] || MYIDUP_tmp[2]==ssel)</div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;              &amp;&amp;</div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;              (partonIsUnknown[3] || MYIDUP_tmp[3]==rsel)</div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;              ){</div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;              <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;msq_tmp);</div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;              MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;              <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;            }</div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;          }</div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;        }</div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;        <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;            (partonIsUnknown[2] || MYIDUP_tmp[2]==rsel)</div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;            (partonIsUnknown[3] || MYIDUP_tmp[3]==ssel)</div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;            ){</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;            <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;msq_tmp);</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;            MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;            <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;          }</div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;            rsel!=ssel</div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;            (partonIsUnknown[2] || MYIDUP_tmp[2]==ssel)</div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;            (partonIsUnknown[3] || MYIDUP_tmp[3]==rsel)</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;            ){</div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;            <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;msq_tmp);</div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;            MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;            <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;          }</div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;        }</div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;      } <span class="comment">// End unswapped isel&gt;=jsel cases</span></div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160; </div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;      <span class="keywordflow">if</span> (isel==jsel) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;      isel = ijsel[ic][1];</div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;      jsel = ijsel[ic][0];</div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160; </div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;      <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;HJJ mother swapped case&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;      <span class="comment">// Reset to default assignments</span></div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;      rsel=isel;</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;      ssel=jsel;</div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160; </div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;        (partonIsUnknown[0] || ((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[0]) &amp;&amp; isel==0) || MYIDUP_tmp[0]==isel))</div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;        &amp;&amp;</div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;        (partonIsUnknown[1] || ((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[1]) &amp;&amp; jsel==0) || MYIDUP_tmp[1]==jsel))</div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;        ){</div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;        <span class="comment">// isel==jsel==0 is already eliminated by isel!=jsel condition</span></div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;        <span class="keywordflow">if</span> (isel==0 || jsel==0){ <span class="comment">// qg/qbg/gq/gqb-&gt;qg/qbg/gq/gqb</span></div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;            (partonIsUnknown[2] || ((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[2]) &amp;&amp; rsel==0) || MYIDUP_tmp[2]==rsel))</div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;            (partonIsUnknown[3] || ((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[3]) &amp;&amp; ssel==0) || MYIDUP_tmp[3]==ssel))</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;            ){</div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;            <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;msq_tmp);</div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;            MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;            <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;          }</div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;            (partonIsUnknown[2] || ((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[2]) &amp;&amp; ssel==0) || MYIDUP_tmp[2]==ssel))</div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;            (partonIsUnknown[3] || ((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[3]) &amp;&amp; rsel==0) || MYIDUP_tmp[3]==rsel))</div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;            ){</div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;            <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;msq_tmp);</div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;            MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;            <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;          }</div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;        }</div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((isel&gt;0 &amp;&amp; jsel&lt;0) || (isel&lt;0 &amp;&amp; jsel&gt;0)){ <span class="comment">// qQb/qbQ-&gt;?</span></div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;          <span class="keywordflow">if</span> (code==1 &amp;&amp; isel==-jsel){ <span class="comment">// qqb/qbq-&gt;gg</span></div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;            rsel=0; ssel=0;</div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;              (partonIsUnknown[2] || <a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[2]))</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;              &amp;&amp;</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;              (partonIsUnknown[3] || <a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[3]))</div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;              ){</div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;              <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;msq_tmp);</div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;              MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;              <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;            }</div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;          }</div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span>(code==3 &amp;&amp; isel==-jsel){ <span class="comment">// qqb-&gt;QQb</span></div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;            <span class="keywordflow">if</span> (abs(isel)!=1){ rsel=1; ssel=-1; } <span class="comment">// Make sure rsel, ssel are not of same flavor as isel, jsel</span></div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;            <span class="keywordflow">else</span>{ rsel=2; ssel=-2; }</div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;            <span class="comment">// The amplitude is aready multiplied by nf-1, so no need to calculate everything (nf-1) times.</span></div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;              (partonIsUnknown[2] &amp;&amp; partonIsUnknown[3])</div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;              ||</div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;              (partonIsUnknown[2] &amp;&amp; std::abs(MYIDUP_tmp[3])!=std::abs(isel) &amp;&amp; MYIDUP_tmp[3]&lt;0)</div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;              ||</div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;              (std::abs(MYIDUP_tmp[2])!=std::abs(isel) &amp;&amp; MYIDUP_tmp[2]&gt;0 &amp;&amp; partonIsUnknown[3])</div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;              ||</div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;              (std::abs(MYIDUP_tmp[2])!=std::abs(isel) &amp;&amp; MYIDUP_tmp[2]==-MYIDUP_tmp[3] &amp;&amp; MYIDUP_tmp[2]&gt;0)</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;              ){</div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;              <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;msq_tmp);</div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;              MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;              <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;            }</div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;              (partonIsUnknown[2] &amp;&amp; partonIsUnknown[3])</div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;              ||</div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;              (partonIsUnknown[2] &amp;&amp; std::abs(MYIDUP_tmp[3])!=std::abs(isel) &amp;&amp; MYIDUP_tmp[3]&gt;0)</div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;              ||</div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;              (std::abs(MYIDUP_tmp[2])!=std::abs(isel) &amp;&amp; MYIDUP_tmp[2]&lt;0 &amp;&amp; partonIsUnknown[3])</div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;              ||</div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;              (std::abs(MYIDUP_tmp[2])!=std::abs(isel) &amp;&amp; MYIDUP_tmp[2]==-MYIDUP_tmp[3] &amp;&amp; MYIDUP_tmp[2]&lt;0)</div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;              ){</div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;              <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;msq_tmp);</div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;              MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;              <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;            }</div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;          }</div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;          <span class="keywordflow">else</span>{ <span class="comment">// qQb/qbQ-&gt;qQb/qbQ</span></div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;              (partonIsUnknown[2] || MYIDUP_tmp[2]==rsel)</div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;              &amp;&amp;</div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;              (partonIsUnknown[3] || MYIDUP_tmp[3]==ssel)</div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;              ){</div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;              <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;msq_tmp);</div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;              MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;              <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;            }</div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;              (partonIsUnknown[2] || MYIDUP_tmp[2]==ssel)</div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;              &amp;&amp;</div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;              (partonIsUnknown[3] || MYIDUP_tmp[3]==rsel)</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;              ){</div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;              <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;msq_tmp);</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;              MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;              <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;            }</div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;          }</div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;        }</div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;        <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;            (partonIsUnknown[2] || MYIDUP_tmp[2]==rsel)</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;            (partonIsUnknown[3] || MYIDUP_tmp[3]==ssel)</div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;            ){</div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;            <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;msq_tmp);</div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;            MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;            <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;          }</div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;            rsel!=ssel</div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;            (partonIsUnknown[2] || MYIDUP_tmp[2]==ssel)</div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;            (partonIsUnknown[3] || MYIDUP_tmp[3]==rsel)</div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;            ){</div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;            <a class="code" href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;msq_tmp);</div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;            MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;            <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;          }</div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;        }</div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;      } <span class="comment">// End swapped isel&lt;jsel cases</span></div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;    } <span class="comment">// End loop over ic&lt;nijchannels</span></div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;  } <span class="comment">// End production == TVar::JJQCD</span></div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a>){</div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;    <span class="keywordtype">int</span> isel, jsel, rsel, ssel;</div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;<span class="comment">    1234/1243 [0] vs [1] correspond to transposing 12 and 34 at the same time.</span></div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;<span class="comment">    Eg. 12-&gt;34 == udbar-&gt;udbar</span></div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;<span class="comment">    1234[0] : 1=u, 2=dbar, 3=u, 4=dbar</span></div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;<span class="comment">    1243[0] : 1=u, 2=dbar, 4=u, 3=dbar</span></div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;<span class="comment">    1234[1] : 2=u, 1=dbar, 4=u, 3=dbar</span></div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;<span class="comment">    1243[1] : 2=u, 1=dbar, 3=u, 4=dbar</span></div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;    <span class="keywordtype">double</span> ckm_takeout=1;</div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;    <span class="keywordtype">double</span> msq_uu_zz_ijrs1234[2]={ 0 };</div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;    <span class="keywordtype">double</span> msq_uu_zz_ijrs1243[2]={ 0 };</div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;    <span class="keywordtype">double</span> msq_dd_zz_ijrs1234[2]={ 0 };</div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;    <span class="keywordtype">double</span> msq_dd_zz_ijrs1243[2]={ 0 };</div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;    <span class="keywordtype">double</span> msq_ubarubar_zz_ijrs1234[2]={ 0 };</div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;    <span class="keywordtype">double</span> msq_ubarubar_zz_ijrs1243[2]={ 0 };</div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;    <span class="keywordtype">double</span> msq_dbardbar_zz_ijrs1234[2]={ 0 };</div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;    <span class="keywordtype">double</span> msq_dbardbar_zz_ijrs1243[2]={ 0 };</div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;    <span class="keywordtype">double</span> msq_uu_zzid_ijrs1234[2]={ 0 };</div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;    <span class="keywordtype">double</span> msq_uu_zzid_ijrs1243[2]={ 0 };</div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;    <span class="keywordtype">double</span> msq_dd_zzid_ijrs1234[2]={ 0 };</div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;    <span class="keywordtype">double</span> msq_dd_zzid_ijrs1243[2]={ 0 };</div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;    <span class="keywordtype">double</span> msq_ubarubar_zzid_ijrs1234[2]={ 0 };</div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;    <span class="keywordtype">double</span> msq_ubarubar_zzid_ijrs1243[2]={ 0 };</div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;    <span class="keywordtype">double</span> msq_dbardbar_zzid_ijrs1234[2]={ 0 };</div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;    <span class="keywordtype">double</span> msq_dbardbar_zzid_ijrs1243[2]={ 0 };</div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;    <span class="keywordtype">double</span> msq_udbar_zz_ijrs1234[2]={ 0 };</div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;    <span class="keywordtype">double</span> msq_udbar_zz_ijrs1243[2]={ 0 };</div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;    <span class="keywordtype">double</span> msq_dubar_zz_ijrs1234[2]={ 0 };</div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;    <span class="keywordtype">double</span> msq_dubar_zz_ijrs1243[2]={ 0 };</div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160; </div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;    <span class="keywordtype">double</span> msq_uubar_zz_ijrs1234[2]={ 0 };</div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;    <span class="keywordtype">double</span> msq_uubar_zz_ijrs1243[2]={ 0 };</div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;    <span class="keywordtype">double</span> msq_ddbar_zz_ijrs1234[2]={ 0 };</div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;    <span class="keywordtype">double</span> msq_ddbar_zz_ijrs1243[2]={ 0 };</div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;    <span class="keywordtype">double</span> msq_uubar_ww_ijrs1234[2]={ 0 };</div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;    <span class="keywordtype">double</span> msq_uubar_ww_ijrs1243[2]={ 0 };</div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;    <span class="keywordtype">double</span> msq_ddbar_ww_ijrs1234[2]={ 0 };</div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;    <span class="keywordtype">double</span> msq_ddbar_ww_ijrs1243[2]={ 0 };</div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160; </div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;    <span class="keywordtype">double</span> msq_ud_wwonly_ijrs1234[2]={ 0 };</div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;    <span class="keywordtype">double</span> msq_ud_wwonly_ijrs1243[2]={ 0 };</div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;    <span class="keywordtype">double</span> msq_ubardbar_wwonly_ijrs1234[2]={ 0 };</div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;    <span class="keywordtype">double</span> msq_ubardbar_wwonly_ijrs1243[2]={ 0 };</div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;    <span class="comment">// ud, ubardbar ZZ(+)WW case to be added separately inside a loop.</span></div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;    </div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;    <span class="comment">// NOTE: The order should be u&gt;c&gt;d&gt;s&gt;b; particle&gt;antiparticle</span></div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;      (partonIsUnknown[0] || (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&gt;0))</div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;      (partonIsUnknown[1] || (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&gt;0))</div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;      (partonIsUnknown[2] || (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&gt;0))</div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;      (partonIsUnknown[3] || (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&gt;0))</div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;      ){</div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;      isel=2; jsel=4; <span class="comment">// uu&#39;-&gt;(ZZ)-&gt;uu&#39;</span></div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;      rsel=isel; ssel=jsel;</div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;(msq_uu_zz_ijrs1234[0]));</div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;(msq_uu_zz_ijrs1243[0]));</div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;      <span class="comment">// Swapping i/j vs r/s makes no physical difference here.</span></div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;      msq_uu_zz_ijrs1234[1] = msq_uu_zz_ijrs1234[0];</div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;      msq_uu_zz_ijrs1243[1] = msq_uu_zz_ijrs1243[0];</div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160; </div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;      isel=2; jsel=2; <span class="comment">// uu-&gt;(ZZ)-&gt;uu</span></div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;      rsel=isel; ssel=jsel;</div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;(msq_uu_zzid_ijrs1234[0]));</div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;(msq_uu_zzid_ijrs1243[0]));</div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;      <span class="comment">// Swapping i/j vs r/s makes no physical difference here.</span></div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;      msq_uu_zzid_ijrs1234[1] = msq_uu_zzid_ijrs1234[0];</div>
<div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;      msq_uu_zzid_ijrs1243[1] = msq_uu_zzid_ijrs1243[0];</div>
<div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;    }</div>
<div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160; </div>
<div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;      (partonIsUnknown[0] || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&gt;0))</div>
<div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;      (partonIsUnknown[1] || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&gt;0))</div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;      (partonIsUnknown[2] || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&gt;0))</div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;      (partonIsUnknown[3] || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&gt;0))</div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;      ){</div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;      isel=1; jsel=3; <span class="comment">// dd&#39;-&gt;(ZZ)-&gt;dd&#39;</span></div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;      rsel=isel; ssel=jsel;</div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;(msq_dd_zz_ijrs1234[0]));</div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;(msq_dd_zz_ijrs1243[0]));</div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;      <span class="comment">// Swapping i/j vs r/s makes no physical difference here.</span></div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;      msq_dd_zz_ijrs1234[1] = msq_dd_zz_ijrs1234[0];</div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;      msq_dd_zz_ijrs1243[1] = msq_dd_zz_ijrs1243[0];</div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160; </div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;      isel=1; jsel=1; <span class="comment">// dd-&gt;(ZZ)-&gt;dd</span></div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;      rsel=isel; ssel=jsel;</div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;(msq_dd_zzid_ijrs1234[0]));</div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;(msq_dd_zzid_ijrs1243[0]));</div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;      <span class="comment">// Swapping i/j vs r/s makes no physical difference here.</span></div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;      msq_dd_zzid_ijrs1234[1] = msq_dd_zzid_ijrs1234[0];</div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;      msq_dd_zzid_ijrs1243[1] = msq_dd_zzid_ijrs1243[0];</div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;    }</div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160; </div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;      (partonIsUnknown[0] || (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&lt;0))</div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;      (partonIsUnknown[1] || (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&lt;0))</div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;      (partonIsUnknown[2] || (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&lt;0))</div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;      (partonIsUnknown[3] || (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&lt;0))</div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;      ){</div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;      isel=-2; jsel=-4; <span class="comment">// ubarubar&#39;-&gt;(ZZ)-&gt;ubarubar&#39;</span></div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;      rsel=isel; ssel=jsel;</div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;(msq_ubarubar_zz_ijrs1234[0]));</div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;(msq_ubarubar_zz_ijrs1243[0]));</div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;      <span class="comment">// Swapping i/j vs r/s makes no physical difference here.</span></div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;      msq_ubarubar_zz_ijrs1234[1] = msq_ubarubar_zz_ijrs1234[0];</div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;      msq_ubarubar_zz_ijrs1243[1] = msq_ubarubar_zz_ijrs1243[0];</div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160; </div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;      isel=-2; jsel=-2; <span class="comment">// ubarubar-&gt;(ZZ)-&gt;ubarubar</span></div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;      rsel=isel; ssel=jsel;</div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;(msq_ubarubar_zzid_ijrs1234[0]));</div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;(msq_ubarubar_zzid_ijrs1243[0]));</div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;      <span class="comment">// Swapping i/j vs r/s makes no physical difference here.</span></div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;      msq_ubarubar_zzid_ijrs1234[1] = msq_ubarubar_zzid_ijrs1234[0];</div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;      msq_ubarubar_zzid_ijrs1243[1] = msq_ubarubar_zzid_ijrs1243[0];</div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;    }</div>
<div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160; </div>
<div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;      (partonIsUnknown[0] || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&lt;0))</div>
<div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;      (partonIsUnknown[1] || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&lt;0))</div>
<div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;      (partonIsUnknown[2] || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&lt;0))</div>
<div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;      (partonIsUnknown[3] || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&lt;0))</div>
<div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;      ){</div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;      isel=-1; jsel=-3; <span class="comment">// dbardbar&#39;-&gt;(ZZ)-&gt;dbardbar&#39;</span></div>
<div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;      rsel=isel; ssel=jsel;</div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;(msq_dbardbar_zz_ijrs1234[0]));</div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;(msq_dbardbar_zz_ijrs1243[0]));</div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;      <span class="comment">// Swapping i/j vs r/s makes no physical difference here.</span></div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;      msq_dbardbar_zz_ijrs1234[1] = msq_dbardbar_zz_ijrs1234[0];</div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;      msq_dbardbar_zz_ijrs1243[1] = msq_dbardbar_zz_ijrs1243[0];</div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160; </div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;      isel=-1; jsel=-1; <span class="comment">// dbardbar-&gt;(ZZ)-&gt;dbardbar</span></div>
<div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;      rsel=isel; ssel=jsel;</div>
<div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;(msq_dbardbar_zzid_ijrs1234[0]));</div>
<div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;(msq_dbardbar_zzid_ijrs1243[0]));</div>
<div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;      <span class="comment">// Swapping i/j vs r/s makes no physical difference here.</span></div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;      msq_dbardbar_zzid_ijrs1234[1] = msq_dbardbar_zzid_ijrs1234[0];</div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;      msq_dbardbar_zzid_ijrs1243[1] = msq_dbardbar_zzid_ijrs1243[0];</div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;    }</div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160; </div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;      (</div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;      (partonIsUnknown[0] &amp;&amp; partonIsUnknown[1])</div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;      ||</div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;      (</div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&gt;0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&lt;0)</div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;      ||</div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&gt;0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&lt;0)</div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;      )</div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;      ||</div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;      (partonIsUnknown[0] &amp;&amp; ((<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&gt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&lt;0)))</div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;      ||</div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;      (partonIsUnknown[1] &amp;&amp; ((<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&gt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&lt;0)))</div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;      )</div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;      (</div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;      (partonIsUnknown[2] &amp;&amp; partonIsUnknown[3])</div>
<div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;      ||</div>
<div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;      (</div>
<div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&gt;0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&lt;0)</div>
<div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;      ||</div>
<div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&gt;0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&lt;0)</div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;      )</div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;      ||</div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;      (partonIsUnknown[2] &amp;&amp; ((<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&gt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&lt;0)))</div>
<div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;      ||</div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;      (partonIsUnknown[3] &amp;&amp; ((<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&gt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&lt;0)))</div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;      )</div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;      ){</div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;      isel=2; jsel=-1; <span class="comment">// udbar-&gt;(ZZ)-&gt;udbar</span></div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;      rsel=isel; ssel=jsel;</div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;(msq_udbar_zz_ijrs1234[0]));</div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;(msq_udbar_zz_ijrs1243[0]));</div>
<div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;jsel, &amp;isel, &amp;ssel, &amp;rsel, &amp;(msq_udbar_zz_ijrs1234[1]));</div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;jsel, &amp;isel, &amp;rsel, &amp;ssel, &amp;(msq_udbar_zz_ijrs1243[1]));</div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;    }</div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160; </div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;      (</div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;      (partonIsUnknown[0] &amp;&amp; partonIsUnknown[1])</div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;      ||</div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;      (</div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&lt;0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&gt;0)</div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;      ||</div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&lt;0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&gt;0)</div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;      )</div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;      ||</div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;      (partonIsUnknown[0] &amp;&amp; ((<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&lt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&gt;0)))</div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;      ||</div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;      (partonIsUnknown[1] &amp;&amp; ((<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&lt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&gt;0)))</div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;      )</div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;      (</div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;      (partonIsUnknown[2] &amp;&amp; partonIsUnknown[3])</div>
<div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;      ||</div>
<div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;      (</div>
<div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&lt;0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&gt;0)</div>
<div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;      ||</div>
<div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&lt;0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&gt;0)</div>
<div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;      )</div>
<div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;      ||</div>
<div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;      (partonIsUnknown[2] &amp;&amp; ((<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&lt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&gt;0)))</div>
<div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;      ||</div>
<div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;      (partonIsUnknown[3] &amp;&amp; ((<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&lt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&gt;0)))</div>
<div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;      )</div>
<div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;      ){</div>
<div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;      isel=1; jsel=-2; <span class="comment">// dubar-&gt;(ZZ)-&gt;dubar</span></div>
<div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;      rsel=isel; ssel=jsel;</div>
<div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;(msq_dubar_zz_ijrs1234[0]));</div>
<div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;(msq_dubar_zz_ijrs1243[0]));</div>
<div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;jsel, &amp;isel, &amp;ssel, &amp;rsel, &amp;(msq_dubar_zz_ijrs1234[1]));</div>
<div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;      <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;jsel, &amp;isel, &amp;rsel, &amp;ssel, &amp;(msq_dubar_zz_ijrs1243[1]));</div>
<div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;    }</div>
<div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160; </div>
<div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;      (partonIsUnknown[0] &amp;&amp; partonIsUnknown[1])</div>
<div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;      ||</div>
<div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[0]*MYIDUP_tmp[1]&lt;0)</div>
<div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;      ||</div>
<div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;      (partonIsUnknown[0] &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[1]))</div>
<div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;      ||</div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;      (partonIsUnknown[1] &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[0]))</div>
<div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;      ){</div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;      isel=2; jsel=-2; <span class="comment">// uubar-&gt;(ZZ)-&gt;uubar</span></div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;        (partonIsUnknown[2] &amp;&amp; partonIsUnknown[3])</div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;        ||</div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;        (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[2]*MYIDUP_tmp[3]&lt;0)</div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;        ||</div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;        (partonIsUnknown[2] &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[3]))</div>
<div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;        ||</div>
<div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;        (partonIsUnknown[3] &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[2]))</div>
<div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;        ){</div>
<div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;        rsel=isel; ssel=jsel; <span class="comment">// uubar-&gt;(ZZ)-&gt;uubar</span></div>
<div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;        <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;(msq_uubar_zz_ijrs1234[0]));</div>
<div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;        <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;(msq_uubar_zz_ijrs1243[0]));</div>
<div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;        <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;jsel, &amp;isel, &amp;ssel, &amp;rsel, &amp;(msq_uubar_zz_ijrs1234[1]));</div>
<div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;        <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;jsel, &amp;isel, &amp;rsel, &amp;ssel, &amp;(msq_uubar_zz_ijrs1243[1]));</div>
<div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;      }</div>
<div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;        (partonIsUnknown[2] &amp;&amp; partonIsUnknown[3])</div>
<div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;        ||</div>
<div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;        (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[2]*MYIDUP_tmp[3]&lt;0)</div>
<div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;        ||</div>
<div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;        (partonIsUnknown[2] &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[3]))</div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;        ||</div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;        (partonIsUnknown[3] &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[2]))</div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;        ){</div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;        rsel=-1; ssel=1; <span class="comment">// uubar-&gt;(WW)-&gt;ddbar</span></div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;        <span class="keywordtype">double</span> ckm_ir = 0.;</div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;        <span class="keywordtype">double</span> ckm_js = 0.;</div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;        <span class="keywordflow">while</span> (ckm_ir==0.){</div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;          rsel += 2;</div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;          ssel -= 2;</div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;          <span class="keywordflow">if</span> (abs(rsel)&gt;=6){</div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;            rsel=-1; ssel=1;</div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;            isel+=2; jsel-=2;</div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;          }</div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;          <span class="keywordflow">if</span> (abs(isel)&gt;=6) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;          ckm_ir = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;isel, &amp;rsel);</div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;          ckm_js = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;jsel, &amp;ssel);</div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;        }</div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;        <span class="keywordflow">if</span> (ckm_ir!=0.){</div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;          <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;(msq_uubar_ww_ijrs1234[0]));</div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;          <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;(msq_uubar_ww_ijrs1243[0]));</div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;          <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;jsel, &amp;isel, &amp;ssel, &amp;rsel, &amp;(msq_uubar_ww_ijrs1234[1]));</div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;          <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;jsel, &amp;isel, &amp;rsel, &amp;ssel, &amp;(msq_uubar_ww_ijrs1243[1]));</div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;          ckm_takeout = pow(ckm_ir*ckm_js, 2);</div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iswap=0; iswap&lt;2; iswap++){</div>
<div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;            msq_uubar_ww_ijrs1234[iswap] /= ckm_takeout;</div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;            msq_uubar_ww_ijrs1243[iswap] /= ckm_takeout;</div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;          }</div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;        }</div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;      }</div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;    }</div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160; </div>
<div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;      (partonIsUnknown[0] &amp;&amp; partonIsUnknown[1])</div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;      ||</div>
<div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[0]*MYIDUP_tmp[1]&lt;0)</div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;      ||</div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;      (partonIsUnknown[0] &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[1]))</div>
<div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;      ||</div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;      (partonIsUnknown[1] &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[0]))</div>
<div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;      ){</div>
<div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;      isel=1; jsel=-1;</div>
<div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;        (partonIsUnknown[2] &amp;&amp; partonIsUnknown[3])</div>
<div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;        ||</div>
<div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;        (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[2]*MYIDUP_tmp[3]&lt;0)</div>
<div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;        ||</div>
<div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;        (partonIsUnknown[2] &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[3]))</div>
<div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;        ||</div>
<div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;        (partonIsUnknown[3] &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[2]))</div>
<div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;        ){</div>
<div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;        rsel=isel; ssel=jsel; <span class="comment">// ddbar-&gt;(ZZ)-&gt;ddbar</span></div>
<div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;        <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;(msq_ddbar_zz_ijrs1234[0]));</div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;        <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;(msq_ddbar_zz_ijrs1243[0]));</div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;        <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;jsel, &amp;isel, &amp;ssel, &amp;rsel, &amp;(msq_ddbar_zz_ijrs1234[1]));</div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;        <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;jsel, &amp;isel, &amp;rsel, &amp;ssel, &amp;(msq_ddbar_zz_ijrs1243[1]));</div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;      }</div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;        (partonIsUnknown[2] &amp;&amp; partonIsUnknown[3])</div>
<div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;        ||</div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;        (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[2]*MYIDUP_tmp[3]&lt;0)</div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;        ||</div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;        (partonIsUnknown[2] &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[3]))</div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;        ||</div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;        (partonIsUnknown[3] &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[2]))</div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;        ){</div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;        rsel=0; ssel=0; <span class="comment">// ddbar-&gt;(WW)-&gt;uubar</span></div>
<div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;        <span class="keywordtype">double</span> ckm_ir = 0.;</div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;        <span class="keywordtype">double</span> ckm_js = 0.;</div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;        <span class="keywordflow">while</span> (ckm_ir==0.){</div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;          rsel += 2;</div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;          ssel -= 2;</div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;          <span class="keywordflow">if</span> (abs(rsel)&gt;=6){</div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;            rsel=0; ssel=0;</div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;            isel+=2; jsel-=2;</div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;          }</div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;          <span class="keywordflow">if</span> (abs(isel)&gt;=6) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;          ckm_ir = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;isel, &amp;rsel);</div>
<div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;          ckm_js = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;jsel, &amp;ssel);</div>
<div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;        }</div>
<div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;        <span class="keywordflow">if</span> (ckm_ir!=0.){</div>
<div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;          <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;(msq_ddbar_ww_ijrs1234[0]));</div>
<div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;          <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;(msq_ddbar_ww_ijrs1243[0]));</div>
<div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;          <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;jsel, &amp;isel, &amp;ssel, &amp;rsel, &amp;(msq_ddbar_ww_ijrs1234[1]));</div>
<div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;          <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;jsel, &amp;isel, &amp;rsel, &amp;ssel, &amp;(msq_ddbar_ww_ijrs1243[1]));</div>
<div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;          ckm_takeout = pow(ckm_ir*ckm_js, 2);</div>
<div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iswap=0; iswap&lt;2; iswap++){</div>
<div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;            msq_ddbar_ww_ijrs1234[iswap] /= ckm_takeout;</div>
<div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;            msq_ddbar_ww_ijrs1243[iswap] /= ckm_takeout;</div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;          }</div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;        }</div>
<div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;      }</div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;    }</div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160; </div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;      (</div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;      (partonIsUnknown[0] &amp;&amp; partonIsUnknown[1])</div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;      ||</div>
<div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;      (</div>
<div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&gt;0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&gt;0)</div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;      ||</div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&gt;0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&gt;0)</div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;      )</div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;      ||</div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;      (partonIsUnknown[0] &amp;&amp; ((<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&gt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&gt;0)))</div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;      ||</div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;      (partonIsUnknown[1] &amp;&amp; ((<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&gt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&gt;0)))</div>
<div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;      )</div>
<div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;      (</div>
<div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;      (partonIsUnknown[2] &amp;&amp; partonIsUnknown[3])</div>
<div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;      ||</div>
<div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;      (</div>
<div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&gt;0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&gt;0)</div>
<div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;      ||</div>
<div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&gt;0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&gt;0)</div>
<div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;      )</div>
<div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;      ||</div>
<div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;      (partonIsUnknown[2] &amp;&amp; ((<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&gt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&gt;0)))</div>
<div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;      ||</div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;      (partonIsUnknown[3] &amp;&amp; ((<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&gt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&gt;0)))</div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;      )</div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;      ){</div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;      <span class="comment">// ud-&gt;(WW)-&gt;d&#39;u&#39;</span></div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;      <span class="keywordtype">double</span> ckm_ir = 0.;</div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;      <span class="keywordtype">double</span> ckm_js = 0.;</div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCombinations = 6;</div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;      <span class="keywordtype">int</span> ijrs_arr[nCombinations][4] ={</div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;        { 2, 3, 1, 4 },</div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;        { 2, 3, 5, 4 },</div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;        { 2, 5, 1, 4 },</div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;        { 2, 5, 3, 4 },</div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;        { 2, 1, 3, 4 },</div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;        { 2, 1, 5, 4 }</div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;      };</div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ijrs=0; ijrs&lt;nCombinations; ijrs++){</div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;        isel = ijrs_arr[ijrs][0];</div>
<div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;        jsel = ijrs_arr[ijrs][1];</div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;        rsel = ijrs_arr[ijrs][2];</div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;        ssel = ijrs_arr[ijrs][3];</div>
<div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;        ckm_ir = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;isel, &amp;rsel);</div>
<div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;        ckm_js = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;jsel, &amp;ssel);</div>
<div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;        <span class="keywordflow">if</span> (ckm_ir!=0. &amp;&amp; ckm_js!=0.) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;      }</div>
<div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;      <span class="keywordflow">if</span> (ckm_ir!=0. &amp;&amp; ckm_js!=0.){</div>
<div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;        <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;(msq_ud_wwonly_ijrs1234[0]));</div>
<div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;        <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;(msq_ud_wwonly_ijrs1243[0]));</div>
<div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;        <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;jsel, &amp;isel, &amp;ssel, &amp;rsel, &amp;(msq_ud_wwonly_ijrs1234[1]));</div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;        <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;jsel, &amp;isel, &amp;rsel, &amp;ssel, &amp;(msq_ud_wwonly_ijrs1243[1]));</div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;        ckm_takeout = pow(ckm_ir*ckm_js, 2);</div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iswap=0; iswap&lt;2; iswap++){</div>
<div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;          msq_ud_wwonly_ijrs1234[iswap] /= ckm_takeout;</div>
<div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;          msq_ud_wwonly_ijrs1243[iswap] /= ckm_takeout;</div>
<div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;        }</div>
<div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;      }</div>
<div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;    }</div>
<div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160; </div>
<div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;      (</div>
<div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;      (partonIsUnknown[0] &amp;&amp; partonIsUnknown[1])</div>
<div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;      ||</div>
<div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;      (</div>
<div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&lt;0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&lt;0)</div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;      ||</div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&lt;0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&lt;0)</div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;      )</div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;      ||</div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;      (partonIsUnknown[0] &amp;&amp; ((<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&lt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[1]) &amp;&amp; MYIDUP_tmp[1]&lt;0)))</div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;      ||</div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;      (partonIsUnknown[1] &amp;&amp; ((<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&lt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[0]) &amp;&amp; MYIDUP_tmp[0]&lt;0)))</div>
<div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;      )</div>
<div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;      (</div>
<div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;      (partonIsUnknown[2] &amp;&amp; partonIsUnknown[3])</div>
<div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;      ||</div>
<div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;      (</div>
<div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&lt;0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&lt;0)</div>
<div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;      ||</div>
<div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&lt;0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&lt;0)</div>
<div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;      )</div>
<div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;      ||</div>
<div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;      (partonIsUnknown[2] &amp;&amp; ((<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&lt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[3]) &amp;&amp; MYIDUP_tmp[3]&lt;0)))</div>
<div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;      ||</div>
<div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;      (partonIsUnknown[3] &amp;&amp; ((<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&lt;0) || (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_tmp[2]) &amp;&amp; MYIDUP_tmp[2]&lt;0)))</div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;      )</div>
<div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;      ){</div>
<div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;      <span class="comment">// ubardbar-&gt;(WW)-&gt;dbar&#39;ubar&#39;</span></div>
<div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;      <span class="keywordtype">double</span> ckm_ir = 0.;</div>
<div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;      <span class="keywordtype">double</span> ckm_js = 0.;</div>
<div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCombinations = 6;</div>
<div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;      <span class="keywordtype">int</span> ijrs_arr[nCombinations][4] ={</div>
<div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;        { -2, -3, -1, -4 },</div>
<div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;        { -2, -3, -5, -4 },</div>
<div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;        { -2, -5, -1, -4 },</div>
<div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;        { -2, -5, -3, -4 },</div>
<div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;        { -2, -1, -3, -4 },</div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;        { -2, -1, -5, -4 }</div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;      };</div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ijrs=0; ijrs&lt;nCombinations; ijrs++){</div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;        isel = ijrs_arr[ijrs][0];</div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;        jsel = ijrs_arr[ijrs][1];</div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;        rsel = ijrs_arr[ijrs][2];</div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;        ssel = ijrs_arr[ijrs][3];</div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;        ckm_ir = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;isel, &amp;rsel);</div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;        ckm_js = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;jsel, &amp;ssel);</div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;        <span class="keywordflow">if</span> (ckm_ir!=0. &amp;&amp; ckm_js!=0.) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;      }</div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;      <span class="keywordflow">if</span> (ckm_ir!=0. &amp;&amp; ckm_js!=0.){</div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;        <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;(msq_ubardbar_wwonly_ijrs1234[0]));</div>
<div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;        <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;(msq_ubardbar_wwonly_ijrs1243[0]));</div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;        <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;jsel, &amp;isel, &amp;ssel, &amp;rsel, &amp;(msq_ubardbar_wwonly_ijrs1234[1]));</div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;        <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;jsel, &amp;isel, &amp;rsel, &amp;ssel, &amp;(msq_ubardbar_wwonly_ijrs1243[1]));</div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;        ckm_takeout = pow(ckm_ir*ckm_js, 2);</div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iswap=0; iswap&lt;2; iswap++){</div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;          msq_ubardbar_wwonly_ijrs1234[iswap] /= ckm_takeout;</div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;          msq_ubardbar_wwonly_ijrs1243[iswap] /= ckm_takeout;</div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;        }</div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;      }</div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;    }</div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160; </div>
<div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>){</div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::HJJMatEl: The pre-computed MEs:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iswap=0; iswap&lt;2; iswap++){</div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;        <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_uu_zz_ijrs1234[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_uu_zz_ijrs1234[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_uu_zz_ijrs1243[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_uu_zz_ijrs1243[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_dd_zz_ijrs1234[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_dd_zz_ijrs1234[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_dd_zz_ijrs1243[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_dd_zz_ijrs1243[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_ubarubar_zz_ijrs1234[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_ubarubar_zz_ijrs1234[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_ubarubar_zz_ijrs1243[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_ubarubar_zz_ijrs1243[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_dbardbar_zz_ijrs1234[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_dbardbar_zz_ijrs1234[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_dbardbar_zz_ijrs1243[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_dbardbar_zz_ijrs1243[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_uu_zzid_ijrs1234[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_uu_zzid_ijrs1234[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_uu_zzid_ijrs1243[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_uu_zzid_ijrs1243[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_dd_zzid_ijrs1234[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_dd_zzid_ijrs1234[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_dd_zzid_ijrs1243[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_dd_zzid_ijrs1243[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_ubarubar_zzid_ijrs1234[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_ubarubar_zzid_ijrs1234[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_ubarubar_zzid_ijrs1243[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_ubarubar_zzid_ijrs1243[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_dbardbar_zzid_ijrs1234[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_dbardbar_zzid_ijrs1234[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_dbardbar_zzid_ijrs1243[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_dbardbar_zzid_ijrs1243[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_udbar_zz_ijrs1234[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_udbar_zz_ijrs1234[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_udbar_zz_ijrs1243[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_udbar_zz_ijrs1243[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_dubar_zz_ijrs1234[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_dubar_zz_ijrs1234[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_dubar_zz_ijrs1243[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_dubar_zz_ijrs1243[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_uubar_zz_ijrs1234[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_uubar_zz_ijrs1234[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_uubar_zz_ijrs1243[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_uubar_zz_ijrs1243[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_ddbar_zz_ijrs1234[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_ddbar_zz_ijrs1234[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_ddbar_zz_ijrs1243[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_ddbar_zz_ijrs1243[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_uubar_ww_ijrs1234[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_uubar_ww_ijrs1234[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_uubar_ww_ijrs1243[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_uubar_ww_ijrs1243[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_ddbar_ww_ijrs1234[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_ddbar_ww_ijrs1234[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_ddbar_ww_ijrs1243[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_ddbar_ww_ijrs1243[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_ud_wwonly_ijrs1234[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_ud_wwonly_ijrs1234[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_ud_wwonly_ijrs1243[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_ud_wwonly_ijrs1243[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_ubardbar_wwonly_ijrs1234[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_ubardbar_wwonly_ijrs1234[iswap] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\tmsq_ubardbar_wwonly_ijrs1243[&quot;</span> &lt;&lt; iswap &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; msq_ubardbar_wwonly_ijrs1243[iswap]</div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;          &lt;&lt; endl;</div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;      }</div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;    }</div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160; </div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;    <span class="keyword">const</span> std::vector&lt;TNumericUtil::intTriplet_t&gt;&amp; ijsel = <a class="code" href="namespaceTJHUGenUtils.html#a2a4e0c526348cefc7b22679883888607">Get_JHUGenHash_OnshellVBFHash</a>();</div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;    <span class="keywordtype">int</span> nijchannels = ijsel.size();</div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;    <span class="comment">// BEGIN COMPUTATION</span></div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ic=0; ic&lt;nijchannels; ic++){</div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;      <span class="comment">// Emulate EvalWeighted_HJJ_test</span></div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;      isel = ijsel[ic][0];</div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;      jsel = ijsel[ic][1];</div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;      <span class="keywordtype">int</span> code = ijsel[ic][2];</div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;      <span class="keywordtype">bool</span> ijselIsUpType[2];</div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;      <span class="keywordtype">bool</span> ijselIsDownType[2];</div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;      <span class="keywordtype">bool</span> ijselIsParticle[2];</div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;      <span class="keywordtype">bool</span> ijselIsAntiparticle[2];</div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160; </div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;      <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;VBF channel &quot;</span> &lt;&lt; ic &lt;&lt; <span class="stringliteral">&quot; code &quot;</span> &lt;&lt; code &lt;&lt; endl;</div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160; </div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;      <span class="comment">// Default assignments</span></div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;      <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;VBF mother unswapped case&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;      <span class="comment">// Set r=i, s=j default values</span></div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;      rsel=isel;</div>
<div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;      ssel=jsel;</div>
<div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;      <span class="comment">// Set i-j bools</span></div>
<div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;      ijselIsUpType[0] = (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(isel));</div>
<div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;      ijselIsUpType[1] = (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(jsel));</div>
<div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;      ijselIsDownType[0] = (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(isel));</div>
<div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;      ijselIsDownType[1] = (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(jsel));</div>
<div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;      ijselIsParticle[0] = (isel&gt;0); ijselIsAntiparticle[0] = (isel&lt;0);</div>
<div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;      ijselIsParticle[1] = (jsel&gt;0); ijselIsAntiparticle[1] = (jsel&lt;0);</div>
<div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160; </div>
<div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;        (partonIsUnknown[0] || MYIDUP_tmp[0]==isel)</div>
<div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;        &amp;&amp;</div>
<div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;        (partonIsUnknown[1] || MYIDUP_tmp[1]==jsel)</div>
<div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;        ){ <span class="comment">// Do it this way to be able to swap isel and jsel later</span></div>
<div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;        <span class="keywordflow">if</span> (code==1){ <span class="comment">// Only ZZ-&gt;H possible</span></div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;          <span class="comment">// rsel=isel and ssel=jsel already</span></div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;            (partonIsUnknown[2] || MYIDUP_tmp[2]==rsel)</div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;            (partonIsUnknown[3] || MYIDUP_tmp[3]==ssel)</div>
<div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;            ){</div>
<div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;            msq_tmp=0;</div>
<div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;            <span class="keywordflow">if</span> (ijselIsUpType[0] &amp;&amp; ijselIsUpType[1]){</div>
<div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;              <span class="keywordflow">if</span> (ijselIsParticle[0] &amp;&amp; ijselIsParticle[1]){</div>
<div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;                <span class="keywordflow">if</span> (isel!=jsel) msq_tmp = msq_uu_zz_ijrs1234[0];</div>
<div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;                <span class="keywordflow">else</span> msq_tmp = msq_uu_zzid_ijrs1234[0];</div>
<div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;              }</div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsAntiparticle[0] &amp;&amp; ijselIsAntiparticle[1]){</div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;                <span class="keywordflow">if</span> (isel!=jsel) msq_tmp = msq_ubarubar_zz_ijrs1234[0];</div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;                <span class="keywordflow">else</span> msq_tmp = msq_ubarubar_zzid_ijrs1234[0];</div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;              }</div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsParticle[0] &amp;&amp; ijselIsAntiparticle[1]) msq_tmp = msq_uubar_zz_ijrs1234[0];</div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;            }</div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[0] &amp;&amp; ijselIsDownType[1]){</div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;              <span class="keywordflow">if</span> (ijselIsParticle[0] &amp;&amp; ijselIsParticle[1]){</div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;                <span class="keywordflow">if</span> (isel!=jsel) msq_tmp = msq_dd_zz_ijrs1234[0];</div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;                <span class="keywordflow">else</span> msq_tmp = msq_dd_zzid_ijrs1234[0];</div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;              }</div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsAntiparticle[0] &amp;&amp; ijselIsAntiparticle[1]){</div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;                <span class="keywordflow">if</span> (isel!=jsel) msq_tmp = msq_dbardbar_zz_ijrs1234[0];</div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;                <span class="keywordflow">else</span> msq_tmp = msq_dbardbar_zzid_ijrs1234[0];</div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;              }</div>
<div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsParticle[0] &amp;&amp; ijselIsAntiparticle[1]) msq_tmp = msq_ddbar_zz_ijrs1234[0];</div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;            }</div>
<div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsUpType[0] &amp;&amp; ijselIsDownType[1] &amp;&amp; ijselIsParticle[0] &amp;&amp; ijselIsAntiparticle[1]) msq_tmp = msq_udbar_zz_ijrs1234[0];</div>
<div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[0] &amp;&amp; ijselIsUpType[1] &amp;&amp; ijselIsParticle[0] &amp;&amp; ijselIsAntiparticle[1]) msq_tmp = msq_dubar_zz_ijrs1234[0];</div>
<div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;            MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;            <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;          }</div>
<div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;            rsel!=ssel</div>
<div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;            (partonIsUnknown[2] || MYIDUP_tmp[2]==ssel)</div>
<div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;            (partonIsUnknown[3] || MYIDUP_tmp[3]==rsel)</div>
<div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;            ){</div>
<div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;            msq_tmp=0;</div>
<div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;            <span class="keywordflow">if</span> (ijselIsUpType[0] &amp;&amp; ijselIsUpType[1]){</div>
<div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;              <span class="keywordflow">if</span> (ijselIsParticle[0] &amp;&amp; ijselIsParticle[1]){</div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;                <span class="keywordflow">if</span> (isel!=jsel) msq_tmp = msq_uu_zz_ijrs1243[0];</div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;                <span class="keywordflow">else</span> msq_tmp = msq_uu_zzid_ijrs1243[0];</div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;              }</div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsAntiparticle[0] &amp;&amp; ijselIsAntiparticle[1]){</div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;                <span class="keywordflow">if</span> (isel!=jsel) msq_tmp = msq_ubarubar_zz_ijrs1243[0];</div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;                <span class="keywordflow">else</span> msq_tmp = msq_ubarubar_zzid_ijrs1243[0];</div>
<div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;              }</div>
<div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsParticle[0] &amp;&amp; ijselIsAntiparticle[1]) msq_tmp = msq_uubar_zz_ijrs1243[0];</div>
<div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;            }</div>
<div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[0] &amp;&amp; ijselIsDownType[1]){</div>
<div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;              <span class="keywordflow">if</span> (ijselIsParticle[0] &amp;&amp; ijselIsParticle[1]){</div>
<div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;                <span class="keywordflow">if</span> (isel!=jsel) msq_tmp = msq_dd_zz_ijrs1243[0];</div>
<div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;                <span class="keywordflow">else</span> msq_tmp = msq_dd_zzid_ijrs1243[0];</div>
<div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;              }</div>
<div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsAntiparticle[0] &amp;&amp; ijselIsAntiparticle[1]){</div>
<div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;                <span class="keywordflow">if</span> (isel!=jsel) msq_tmp = msq_dbardbar_zz_ijrs1243[0];</div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;                <span class="keywordflow">else</span> msq_tmp = msq_dbardbar_zzid_ijrs1243[0];</div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;              }</div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsParticle[0] &amp;&amp; ijselIsAntiparticle[1]) msq_tmp = msq_ddbar_zz_ijrs1243[0];</div>
<div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;            }</div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsUpType[0] &amp;&amp; ijselIsDownType[1] &amp;&amp; ijselIsParticle[0] &amp;&amp; ijselIsAntiparticle[1]) msq_tmp = msq_udbar_zz_ijrs1243[0];</div>
<div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[0] &amp;&amp; ijselIsUpType[1] &amp;&amp; ijselIsParticle[0] &amp;&amp; ijselIsAntiparticle[1]) msq_tmp = msq_dubar_zz_ijrs1243[0];</div>
<div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;            MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;            <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;          }</div>
<div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;        }</div>
<div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (code==0){ <span class="comment">// code==0 means WW-&gt;H is also possible with no interference to ZZ-&gt;H, for example u ub -&gt; d db.</span></div>
<div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;          vector&lt;int&gt; possible_rsel;</div>
<div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;          vector&lt;int&gt; possible_ssel;</div>
<div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;          vector&lt;double&gt; possible_Vsqir;</div>
<div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;          vector&lt;double&gt; possible_Vsqjs;</div>
<div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;          <span class="keywordflow">if</span> (ijselIsUpType[0]){ possible_rsel.push_back(1); possible_rsel.push_back(3); possible_rsel.push_back(5); }</div>
<div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[0]){ possible_rsel.push_back(2); possible_rsel.push_back(4); }</div>
<div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;possible_rsel.size(); ix++){</div>
<div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;            rsel=possible_rsel.at(ix);</div>
<div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;            <span class="keywordtype">double</span> ckmval = pow(<a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;isel, &amp;rsel), 2);</div>
<div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;            possible_Vsqir.push_back(ckmval);</div>
<div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;          }</div>
<div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;          <span class="keywordflow">if</span> (ijselIsUpType[1]){ possible_ssel.push_back(1); possible_ssel.push_back(3); possible_ssel.push_back(5); }</div>
<div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[1]){ possible_ssel.push_back(2); possible_ssel.push_back(4); }</div>
<div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iy=0; iy&lt;possible_ssel.size(); iy++){</div>
<div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;            ssel=possible_ssel.at(iy);</div>
<div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;            <span class="keywordtype">double</span> ckmval = pow(<a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;jsel, &amp;ssel), 2);</div>
<div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;            possible_Vsqjs.push_back(ckmval);</div>
<div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;          }</div>
<div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160; </div>
<div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;          <span class="comment">// Combine the ME and ME_swap based on actual ids</span></div>
<div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;possible_rsel.size(); ix++){</div>
<div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;            rsel=possible_rsel.at(ix)*TMath::Sign(1, isel);</div>
<div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iy=0; iy&lt;possible_ssel.size(); iy++){</div>
<div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;              ssel=possible_ssel.at(iy)*TMath::Sign(1, jsel);</div>
<div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;              <span class="keywordtype">double</span> ckmval = possible_Vsqir.at(ix)*possible_Vsqjs.at(iy);</div>
<div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;              <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;                (partonIsUnknown[2] || MYIDUP_tmp[2]==rsel)</div>
<div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;                &amp;&amp;</div>
<div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;                (partonIsUnknown[3] || MYIDUP_tmp[3]==ssel)</div>
<div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;                ){</div>
<div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;                msq_tmp=0;</div>
<div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;                <span class="keywordflow">if</span> (ijselIsUpType[0] &amp;&amp; ijselIsUpType[1] &amp;&amp; ijselIsParticle[0] &amp;&amp; ijselIsAntiparticle[1]) msq_tmp = msq_uubar_ww_ijrs1234[0];</div>
<div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[0] &amp;&amp; ijselIsDownType[1] &amp;&amp; ijselIsParticle[0] &amp;&amp; ijselIsAntiparticle[1]) msq_tmp = msq_ddbar_ww_ijrs1234[0];</div>
<div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;                msq_tmp *= ckmval;</div>
<div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;                MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;                <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;              }</div>
<div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;              <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;                rsel!=ssel</div>
<div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;                &amp;&amp;</div>
<div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;                (partonIsUnknown[2] || MYIDUP_tmp[2]==ssel)</div>
<div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;                &amp;&amp;</div>
<div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;                (partonIsUnknown[3] || MYIDUP_tmp[3]==rsel)</div>
<div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;                ){</div>
<div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;                msq_tmp=0;</div>
<div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;                <span class="keywordflow">if</span> (ijselIsUpType[0] &amp;&amp; ijselIsUpType[1] &amp;&amp; ijselIsParticle[0] &amp;&amp; ijselIsAntiparticle[1]) msq_tmp = msq_uubar_ww_ijrs1243[0];</div>
<div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[0] &amp;&amp; ijselIsDownType[1] &amp;&amp; ijselIsParticle[0] &amp;&amp; ijselIsAntiparticle[1]) msq_tmp = msq_ddbar_ww_ijrs1243[0];</div>
<div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;                msq_tmp *= ckmval;</div>
<div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;                MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;                <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;              }</div>
<div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;            }</div>
<div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;          }</div>
<div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;        }</div>
<div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;        <span class="keywordflow">else</span>{ <span class="comment">// code==2 means states with WW/ZZ interference allowed, for example u1 d2 -&gt; u3 d4 + d4 u3.</span></div>
<div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;          vector&lt;int&gt; possible_rsel;</div>
<div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;          vector&lt;int&gt; possible_ssel;</div>
<div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;          vector&lt;double&gt; possible_Vsqir;</div>
<div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;          vector&lt;double&gt; possible_Vsqjs;</div>
<div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;          <span class="keywordflow">if</span> (ijselIsUpType[0]){ possible_rsel.push_back(1); possible_rsel.push_back(3); possible_rsel.push_back(5); }</div>
<div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[0]){ possible_rsel.push_back(2); possible_rsel.push_back(4); }</div>
<div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;possible_rsel.size(); ix++){</div>
<div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;            rsel=possible_rsel.at(ix);</div>
<div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;            <span class="keywordtype">double</span> ckmval = pow(<a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;isel, &amp;rsel), 2);</div>
<div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;            possible_Vsqir.push_back(ckmval);</div>
<div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;          }</div>
<div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;          <span class="keywordflow">if</span> (ijselIsUpType[1]){ possible_ssel.push_back(1); possible_ssel.push_back(3); possible_ssel.push_back(5); }</div>
<div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[1]){ possible_ssel.push_back(2); possible_ssel.push_back(4); }</div>
<div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iy=0; iy&lt;possible_ssel.size(); iy++){</div>
<div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;            ssel=possible_ssel.at(iy);</div>
<div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;            <span class="keywordtype">double</span> ckmval = pow(<a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;jsel, &amp;ssel), 2);</div>
<div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;            possible_Vsqjs.push_back(ckmval);</div>
<div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;          }</div>
<div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160; </div>
<div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;          <span class="comment">// Loop over all possible combinations to get interference correct</span></div>
<div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;possible_rsel.size(); ix++){</div>
<div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;            rsel=possible_rsel.at(ix)*TMath::Sign(1, isel);</div>
<div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iy=0; iy&lt;possible_ssel.size(); iy++){</div>
<div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;              ssel=possible_ssel.at(iy)*TMath::Sign(1, jsel);</div>
<div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;              <span class="keywordtype">double</span> ckmval = possible_Vsqir.at(ix)*possible_Vsqjs.at(iy);</div>
<div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;              <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;                (partonIsUnknown[2] || MYIDUP_tmp[2]==rsel)</div>
<div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;                &amp;&amp;</div>
<div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;                (partonIsUnknown[3] || MYIDUP_tmp[3]==ssel)</div>
<div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;                ){</div>
<div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;                <span class="keywordflow">if</span> (rsel!=jsel &amp;&amp; ssel!=isel){</div>
<div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;                  msq_tmp=0;</div>
<div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;                  <span class="keywordflow">if</span> (ijselIsUpType[0] &amp;&amp; ijselIsDownType[1]){</div>
<div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;                    <span class="keywordflow">if</span> (ijselIsParticle[0] &amp;&amp; ijselIsParticle[1]) msq_tmp = msq_ud_wwonly_ijrs1234[0];</div>
<div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsAntiparticle[0] &amp;&amp; ijselIsAntiparticle[1]) msq_tmp = msq_ubardbar_wwonly_ijrs1234[0];</div>
<div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;                  }</div>
<div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;                  msq_tmp *= ckmval;</div>
<div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;                  MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;                  <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;                }</div>
<div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;                <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;                  <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;msq_tmp);</div>
<div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;                  MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;                  <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;                }</div>
<div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;              }</div>
<div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;              <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;                rsel!=ssel</div>
<div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;                &amp;&amp;</div>
<div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;                (partonIsUnknown[2] || MYIDUP_tmp[2]==ssel)</div>
<div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;                &amp;&amp;</div>
<div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;                (partonIsUnknown[3] || MYIDUP_tmp[3]==rsel)</div>
<div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;                ){</div>
<div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;                <span class="keywordflow">if</span> (rsel!=jsel &amp;&amp; ssel!=isel){</div>
<div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;                  msq_tmp=0;</div>
<div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;                  <span class="keywordflow">if</span> (ijselIsUpType[0] &amp;&amp; ijselIsDownType[1]){</div>
<div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;                    <span class="keywordflow">if</span> (ijselIsParticle[0] &amp;&amp; ijselIsParticle[1]) msq_tmp = msq_ud_wwonly_ijrs1243[0];</div>
<div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsAntiparticle[0] &amp;&amp; ijselIsAntiparticle[1]) msq_tmp = msq_ubardbar_wwonly_ijrs1243[0];</div>
<div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;                  }</div>
<div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;                  msq_tmp *= ckmval;</div>
<div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;                  MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;                  <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;                }</div>
<div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;                <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;                  <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;msq_tmp);</div>
<div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;                  MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;                  <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;                }</div>
<div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;              }</div>
<div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;            }</div>
<div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;          }</div>
<div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;        }</div>
<div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;      } <span class="comment">// End unswapped isel&gt;=jsel cases</span></div>
<div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160; </div>
<div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;      <span class="keywordflow">if</span> (isel==jsel) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;      isel = ijsel[ic][1];</div>
<div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;      jsel = ijsel[ic][0];</div>
<div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160; </div>
<div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;      <span class="comment">// Reset to default assignments</span></div>
<div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;      <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;VBF mother swapped case&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;      <span class="comment">// Set r=i, s=j default values</span></div>
<div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;      rsel=isel;</div>
<div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;      ssel=jsel;</div>
<div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;      <span class="comment">// Set i-j bools</span></div>
<div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;      ijselIsUpType[0] = (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(isel));</div>
<div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;      ijselIsUpType[1] = (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(jsel));</div>
<div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;      ijselIsDownType[0] = (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(isel));</div>
<div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;      ijselIsDownType[1] = (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(jsel));</div>
<div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;      ijselIsParticle[0] = (isel&gt;0); ijselIsAntiparticle[0] = (isel&lt;0);</div>
<div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;      ijselIsParticle[1] = (jsel&gt;0); ijselIsAntiparticle[1] = (jsel&lt;0);</div>
<div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160; </div>
<div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;        (partonIsUnknown[0] || ((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[0]) &amp;&amp; isel==0) || MYIDUP_tmp[0]==isel))</div>
<div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;        &amp;&amp;</div>
<div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;        (partonIsUnknown[1] || ((<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_tmp[1]) &amp;&amp; jsel==0) || MYIDUP_tmp[1]==jsel))</div>
<div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;        ){</div>
<div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;        <span class="comment">// isel==jsel==0 is already eliminated by isel!=jsel condition</span></div>
<div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;        <span class="keywordflow">if</span> (code==1){ <span class="comment">// Only ZZ-&gt;H possible</span></div>
<div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;          <span class="comment">// rsel=isel and ssel=jsel already</span></div>
<div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;            (partonIsUnknown[2] || MYIDUP_tmp[2]==rsel)</div>
<div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;            (partonIsUnknown[3] || MYIDUP_tmp[3]==ssel)</div>
<div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;            ){</div>
<div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;            msq_tmp=0;</div>
<div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;            <span class="keywordflow">if</span> (ijselIsUpType[1] &amp;&amp; ijselIsUpType[0]){</div>
<div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;              <span class="keywordflow">if</span> (ijselIsParticle[1] &amp;&amp; ijselIsParticle[0]){</div>
<div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;                <span class="keywordflow">if</span> (isel!=jsel) msq_tmp = msq_uu_zz_ijrs1234[1];</div>
<div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;                <span class="keywordflow">else</span> msq_tmp = msq_uu_zzid_ijrs1234[1];</div>
<div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;              }</div>
<div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsAntiparticle[1] &amp;&amp; ijselIsAntiparticle[0]){</div>
<div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;                <span class="keywordflow">if</span> (isel!=jsel) msq_tmp = msq_ubarubar_zz_ijrs1234[1];</div>
<div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;                <span class="keywordflow">else</span> msq_tmp = msq_ubarubar_zzid_ijrs1234[1];</div>
<div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;              }</div>
<div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsParticle[1] &amp;&amp; ijselIsAntiparticle[0]) msq_tmp = msq_uubar_zz_ijrs1234[1];</div>
<div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;            }</div>
<div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[1] &amp;&amp; ijselIsDownType[0]){</div>
<div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;              <span class="keywordflow">if</span> (ijselIsParticle[1] &amp;&amp; ijselIsParticle[0]){</div>
<div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;                <span class="keywordflow">if</span> (isel!=jsel) msq_tmp = msq_dd_zz_ijrs1234[1];</div>
<div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;                <span class="keywordflow">else</span> msq_tmp = msq_dd_zzid_ijrs1234[1];</div>
<div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;              }</div>
<div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsAntiparticle[1] &amp;&amp; ijselIsAntiparticle[0]){</div>
<div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;                <span class="keywordflow">if</span> (isel!=jsel) msq_tmp = msq_dbardbar_zz_ijrs1234[1];</div>
<div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;                <span class="keywordflow">else</span> msq_tmp = msq_dbardbar_zzid_ijrs1234[1];</div>
<div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;              }</div>
<div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsParticle[1] &amp;&amp; ijselIsAntiparticle[0]) msq_tmp = msq_ddbar_zz_ijrs1234[1];</div>
<div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;            }</div>
<div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsUpType[1] &amp;&amp; ijselIsDownType[0] &amp;&amp; ijselIsParticle[1] &amp;&amp; ijselIsAntiparticle[0]) msq_tmp = msq_udbar_zz_ijrs1234[1];</div>
<div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[1] &amp;&amp; ijselIsUpType[0] &amp;&amp; ijselIsParticle[1] &amp;&amp; ijselIsAntiparticle[0]) msq_tmp = msq_dubar_zz_ijrs1234[1];</div>
<div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;            MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;            <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;          }</div>
<div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;            rsel!=ssel</div>
<div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;            (partonIsUnknown[2] || MYIDUP_tmp[2]==ssel)</div>
<div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;            (partonIsUnknown[3] || MYIDUP_tmp[3]==rsel)</div>
<div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;            ){</div>
<div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;            msq_tmp=0;</div>
<div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;            <span class="keywordflow">if</span> (ijselIsUpType[1] &amp;&amp; ijselIsUpType[0]){</div>
<div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;              <span class="keywordflow">if</span> (ijselIsParticle[1] &amp;&amp; ijselIsParticle[0]){</div>
<div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;                <span class="keywordflow">if</span> (isel!=jsel) msq_tmp = msq_uu_zz_ijrs1243[1];</div>
<div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;                <span class="keywordflow">else</span> msq_tmp = msq_uu_zzid_ijrs1243[1];</div>
<div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;              }</div>
<div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsAntiparticle[1] &amp;&amp; ijselIsAntiparticle[0]){</div>
<div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;                <span class="keywordflow">if</span> (isel!=jsel) msq_tmp = msq_ubarubar_zz_ijrs1243[1];</div>
<div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;                <span class="keywordflow">else</span> msq_tmp = msq_ubarubar_zzid_ijrs1243[1];</div>
<div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;              }</div>
<div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsParticle[1] &amp;&amp; ijselIsAntiparticle[0]) msq_tmp = msq_uubar_zz_ijrs1243[1];</div>
<div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;            }</div>
<div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[1] &amp;&amp; ijselIsDownType[0]){</div>
<div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;              <span class="keywordflow">if</span> (ijselIsParticle[1] &amp;&amp; ijselIsParticle[0]){</div>
<div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;                <span class="keywordflow">if</span> (isel!=jsel) msq_tmp = msq_dd_zz_ijrs1243[1];</div>
<div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;                <span class="keywordflow">else</span> msq_tmp = msq_dd_zzid_ijrs1243[1];</div>
<div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;              }</div>
<div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsAntiparticle[1] &amp;&amp; ijselIsAntiparticle[0]){</div>
<div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;                <span class="keywordflow">if</span> (isel!=jsel) msq_tmp = msq_dbardbar_zz_ijrs1243[1];</div>
<div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;                <span class="keywordflow">else</span> msq_tmp = msq_dbardbar_zzid_ijrs1243[1];</div>
<div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;              }</div>
<div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsParticle[1] &amp;&amp; ijselIsAntiparticle[0]) msq_tmp = msq_ddbar_zz_ijrs1243[1];</div>
<div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;            }</div>
<div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsUpType[1] &amp;&amp; ijselIsDownType[0] &amp;&amp; ijselIsParticle[1] &amp;&amp; ijselIsAntiparticle[0]) msq_tmp = msq_udbar_zz_ijrs1243[1];</div>
<div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[1] &amp;&amp; ijselIsUpType[0] &amp;&amp; ijselIsParticle[1] &amp;&amp; ijselIsAntiparticle[0]) msq_tmp = msq_dubar_zz_ijrs1243[1];</div>
<div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;            MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;            <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;          }</div>
<div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;        }</div>
<div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (code==0){ <span class="comment">// code==0 means WW-&gt;H is also possible with no interference to ZZ-&gt;H, for example u ub -&gt; d db.</span></div>
<div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;          vector&lt;int&gt; possible_rsel;</div>
<div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;          vector&lt;int&gt; possible_ssel;</div>
<div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;          vector&lt;double&gt; possible_Vsqir;</div>
<div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;          vector&lt;double&gt; possible_Vsqjs;</div>
<div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;          <span class="keywordflow">if</span> (ijselIsUpType[0]){ possible_rsel.push_back(1); possible_rsel.push_back(3); possible_rsel.push_back(5); }</div>
<div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[0]){ possible_rsel.push_back(2); possible_rsel.push_back(4); }</div>
<div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;possible_rsel.size(); ix++){</div>
<div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;            rsel=possible_rsel.at(ix);</div>
<div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;            <span class="keywordtype">double</span> ckmval = pow(<a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;isel, &amp;rsel), 2);</div>
<div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;            possible_Vsqir.push_back(ckmval);</div>
<div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;          }</div>
<div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;          <span class="keywordflow">if</span> (ijselIsUpType[1]){ possible_ssel.push_back(1); possible_ssel.push_back(3); possible_ssel.push_back(5); }</div>
<div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[1]){ possible_ssel.push_back(2); possible_ssel.push_back(4); }</div>
<div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iy=0; iy&lt;possible_ssel.size(); iy++){</div>
<div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;            ssel=possible_ssel.at(iy);</div>
<div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;            <span class="keywordtype">double</span> ckmval = pow(<a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;jsel, &amp;ssel), 2);</div>
<div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;            possible_Vsqjs.push_back(ckmval);</div>
<div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;          }</div>
<div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160; </div>
<div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;          <span class="comment">// Combine the ME and ME_swap based on actual ids</span></div>
<div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;possible_rsel.size(); ix++){</div>
<div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;            rsel=possible_rsel.at(ix)*TMath::Sign(1, isel);</div>
<div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iy=0; iy&lt;possible_ssel.size(); iy++){</div>
<div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;              ssel=possible_ssel.at(iy)*TMath::Sign(1, jsel);</div>
<div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;              <span class="keywordtype">double</span> ckmval = possible_Vsqir.at(ix)*possible_Vsqjs.at(iy);</div>
<div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;              <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;                (partonIsUnknown[2] || MYIDUP_tmp[2]==rsel)</div>
<div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;                &amp;&amp;</div>
<div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;                (partonIsUnknown[3] || MYIDUP_tmp[3]==ssel)</div>
<div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;                ){</div>
<div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;                msq_tmp=0;</div>
<div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;                <span class="keywordflow">if</span> (ijselIsUpType[1] &amp;&amp; ijselIsUpType[0] &amp;&amp; ijselIsParticle[1] &amp;&amp; ijselIsAntiparticle[0]) msq_tmp = msq_uubar_ww_ijrs1234[1];</div>
<div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[1] &amp;&amp; ijselIsDownType[0] &amp;&amp; ijselIsParticle[1] &amp;&amp; ijselIsAntiparticle[0]) msq_tmp = msq_ddbar_ww_ijrs1234[1];</div>
<div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;                msq_tmp *= ckmval;</div>
<div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;                MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;                <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;              }</div>
<div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;              <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;                rsel!=ssel</div>
<div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;                &amp;&amp;</div>
<div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;                (partonIsUnknown[2] || MYIDUP_tmp[2]==ssel)</div>
<div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;                &amp;&amp;</div>
<div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;                (partonIsUnknown[3] || MYIDUP_tmp[3]==rsel)</div>
<div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;                ){</div>
<div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;                msq_tmp=0;</div>
<div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;                <span class="keywordflow">if</span> (ijselIsUpType[1] &amp;&amp; ijselIsUpType[0] &amp;&amp; ijselIsParticle[1] &amp;&amp; ijselIsAntiparticle[0]) msq_tmp = msq_uubar_ww_ijrs1243[1];</div>
<div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[1] &amp;&amp; ijselIsDownType[0] &amp;&amp; ijselIsParticle[1] &amp;&amp; ijselIsAntiparticle[0]) msq_tmp = msq_ddbar_ww_ijrs1243[1];</div>
<div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;                msq_tmp *= ckmval;</div>
<div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;                MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;                <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;              }</div>
<div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;            }</div>
<div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;          }</div>
<div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;        }</div>
<div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;        <span class="keywordflow">else</span>{ <span class="comment">// code==2 means states with WW/ZZ interference allowed, for example u1 d2 -&gt; u3 d4 + d4 u3.</span></div>
<div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;          vector&lt;int&gt; possible_rsel;</div>
<div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;          vector&lt;int&gt; possible_ssel;</div>
<div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;          vector&lt;double&gt; possible_Vsqir;</div>
<div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;          vector&lt;double&gt; possible_Vsqjs;</div>
<div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;          <span class="keywordflow">if</span> (ijselIsUpType[0]){ possible_rsel.push_back(1); possible_rsel.push_back(3); possible_rsel.push_back(5); }</div>
<div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[0]){ possible_rsel.push_back(2); possible_rsel.push_back(4); }</div>
<div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;possible_rsel.size(); ix++){</div>
<div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;            rsel=possible_rsel.at(ix);</div>
<div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;            <span class="keywordtype">double</span> ckmval = pow(<a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;isel, &amp;rsel), 2);</div>
<div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;            possible_Vsqir.push_back(ckmval);</div>
<div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;          }</div>
<div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;          <span class="keywordflow">if</span> (ijselIsUpType[1]){ possible_ssel.push_back(1); possible_ssel.push_back(3); possible_ssel.push_back(5); }</div>
<div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsDownType[1]){ possible_ssel.push_back(2); possible_ssel.push_back(4); }</div>
<div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iy=0; iy&lt;possible_ssel.size(); iy++){</div>
<div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;            ssel=possible_ssel.at(iy);</div>
<div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;            <span class="keywordtype">double</span> ckmval = pow(<a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;jsel, &amp;ssel), 2);</div>
<div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;            possible_Vsqjs.push_back(ckmval);</div>
<div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;          }</div>
<div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160; </div>
<div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;          <span class="comment">// Loop over all possible combinations to get interference correct</span></div>
<div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;possible_rsel.size(); ix++){</div>
<div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;            rsel=possible_rsel.at(ix)*TMath::Sign(1, isel);</div>
<div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iy=0; iy&lt;possible_ssel.size(); iy++){</div>
<div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;              ssel=possible_ssel.at(iy)*TMath::Sign(1, jsel);</div>
<div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;              <span class="keywordtype">double</span> ckmval = possible_Vsqir.at(ix)*possible_Vsqjs.at(iy);</div>
<div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;              <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;                (partonIsUnknown[2] || MYIDUP_tmp[2]==rsel)</div>
<div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;                &amp;&amp;</div>
<div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;                (partonIsUnknown[3] || MYIDUP_tmp[3]==ssel)</div>
<div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;                ){</div>
<div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;                <span class="keywordflow">if</span> (rsel!=jsel &amp;&amp; ssel!=isel){</div>
<div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;                  msq_tmp=0;</div>
<div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;                  <span class="keywordflow">if</span> (ijselIsUpType[1] &amp;&amp; ijselIsDownType[0]){</div>
<div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;                    <span class="keywordflow">if</span> (ijselIsParticle[1] &amp;&amp; ijselIsParticle[0]) msq_tmp = msq_ud_wwonly_ijrs1234[1];</div>
<div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsAntiparticle[1] &amp;&amp; ijselIsAntiparticle[0]) msq_tmp = msq_ubardbar_wwonly_ijrs1234[1];</div>
<div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;                  }</div>
<div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;                  msq_tmp *= ckmval;</div>
<div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;                  MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;                  <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;                }</div>
<div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;                <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;                  <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;rsel, &amp;ssel, &amp;msq_tmp);</div>
<div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;                  MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;                  <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;                }</div>
<div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;              }</div>
<div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;              <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;                rsel!=ssel</div>
<div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;                &amp;&amp;</div>
<div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;                (partonIsUnknown[2] || MYIDUP_tmp[2]==ssel)</div>
<div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;                &amp;&amp;</div>
<div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;                (partonIsUnknown[3] || MYIDUP_tmp[3]==rsel)</div>
<div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;                ){</div>
<div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;                <span class="keywordflow">if</span> (rsel!=jsel &amp;&amp; ssel!=isel){</div>
<div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;                  msq_tmp=0;</div>
<div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;                  <span class="keywordflow">if</span> (ijselIsUpType[1] &amp;&amp; ijselIsDownType[0]){</div>
<div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;                    <span class="keywordflow">if</span> (ijselIsParticle[1] &amp;&amp; ijselIsParticle[0]) msq_tmp = msq_ud_wwonly_ijrs1243[1];</div>
<div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ijselIsAntiparticle[1] &amp;&amp; ijselIsAntiparticle[0]) msq_tmp = msq_ubardbar_wwonly_ijrs1243[1];</div>
<div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;                  }</div>
<div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;                  msq_tmp *= ckmval;</div>
<div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;                  MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;                  <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;                }</div>
<div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;                <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;                  <a class="code" href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a>(p4, &amp;isel, &amp;jsel, &amp;ssel, &amp;rsel, &amp;msq_tmp);</div>
<div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;                  MatElsq[jsel+5][isel+5] += msq_tmp; <span class="comment">// Assign only those that match gen. info, if present at all.</span></div>
<div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;                  <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Channel (isel, jsel, rsel, ssel)=&quot;</span> &lt;&lt; isel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; jsel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ssel &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; rsel &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt;  msq_tmp &lt;&lt; endl;</div>
<div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;                }</div>
<div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;              }</div>
<div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;            }</div>
<div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;          }</div>
<div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;        }</div>
<div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;      } <span class="comment">// End swapped isel&lt;jsel cases</span></div>
<div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;    } <span class="comment">// End loop over ic&lt;nijchannels</span></div>
<div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;    <span class="comment">// END COMPUTATION</span></div>
<div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;  } <span class="comment">// End production == TVar::JJVBF</span></div>
<div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160; </div>
<div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;  <span class="keywordtype">int</span> GeVexponent_MEsq = 4-(1+nRequested_AssociatedJets)*2;</div>
<div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;  <span class="keywordtype">double</span> constant = pow(GeV, -GeVexponent_MEsq);</div>
<div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0; ii&lt;<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>; ii++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj=0; jj&lt;<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>; jj++) MatElsq[jj][ii] *= constant; }</div>
<div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;  <span class="comment">//    FOTRAN convention    -5    -4   -3   -2   -1    0   1   2   3  4  5</span></div>
<div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;  <span class="comment">//     parton flavor      bbar  cbar  sbar ubar dbar  g   d   u   s  c  b</span></div>
<div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;  <span class="comment">//      C++ convention     0      1    2    3    4    5   6   7   8  9  10</span></div>
<div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;  <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;MatElsq:\n&quot;</span>;</div>
<div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; <a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>; ii++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj &lt; <a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>; jj++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; MatElsq[jj][ii] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>; <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl; }</div>
<div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;  }</div>
<div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;  sum_msqjk = <a class="code" href="namespaceTUtil.html#adf7b61bc902b23177090ce6b48a7f026">SumMEPDF</a>(MomStore[0], MomStore[1], MatElsq, RcdME, EBEAM, verbosity);</div>
<div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;<span class="comment">  if (verbosity &gt;= TVar::ERROR &amp;&amp; (std::isnan(sum_msqjk) || std::isinf(sum_msqjk))){</span></div>
<div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;<span class="comment">    MELAout &lt;&lt; &quot;TUtil::HJJMatEl: FAILURE!&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;<span class="comment">    MELAout &lt;&lt; &quot;MatElsq:\n&quot;;</span></div>
<div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;<span class="comment">    for (int ii = 0; ii &lt; nmsq; ii++){ for (int jj = 0; jj &lt; nmsq; jj++) MELAout &lt;&lt; MatElsq[jj][ii] &lt;&lt; &#39;\t&#39;; MELAout &lt;&lt; endl; }</span></div>
<div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;<span class="comment">    double fx[2][nmsq];</span></div>
<div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;<span class="comment">    RcdME-&gt;getPartonWeights(fx[0], fx[1]);</span></div>
<div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;<span class="comment">    for (int ii = 0; ii &lt; nmsq; ii++){ for (int jj = 0; jj &lt; 2; jj++) MELAout &lt;&lt; fx[jj][ii] &lt;&lt; &#39;\t&#39;; MELAout &lt;&lt; endl; }</span></div>
<div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;<span class="comment">    for (int i=0; i&lt;5; i++) MELAout &lt;&lt; &quot;p[&quot;&lt;&lt;i&lt;&lt;&quot;] (Px, Py, Pz, E, M):\t&quot; &lt;&lt; p4[i][1]/GeV &lt;&lt; &#39;\t&#39; &lt;&lt; p4[i][2]/GeV &lt;&lt; &#39;\t&#39; &lt;&lt; p4[i][3]/GeV &lt;&lt; &#39;\t&#39; &lt;&lt; p4[i][0]/GeV &lt;&lt; &#39;\t&#39; &lt;&lt; sqrt(fabs(pow(p4[i][0], 2)-pow(p4[i][1], 2)-pow(p4[i][2], 2)-pow(p4[i][3], 2)))/GeV &lt;&lt; endl;</span></div>
<div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;<span class="comment">    TUtil::PrintCandidateSummary(RcdME-&gt;melaCand);</span></div>
<div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;<span class="comment">    MELAout &lt;&lt; endl;</span></div>
<div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;<span class="comment">  }</span></div>
<div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160; </div>
<div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::HJJMatEl: Reset AlphaS:\n&quot;</span></div>
<div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tBefore reset, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale &lt;&lt; endl;</div>
<div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;  }</div>
<div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;  <a class="code" href="namespaceTUtil.html#ab551562aaa197841cd0a638f1f38b0ff">SetAlphaS</a>(defaultRenScale, defaultFacScale, 1., 1., defaultNloop, defaultNflav, defaultPdflabel);</div>
<div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;    <a class="code" href="namespaceTUtil.html#a2f0fce2b3d66f17b673f2e75d87adf00">GetAlphaS</a>(&amp;alphasVal, &amp;alphasmzVal);</div>
<div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::HJJMatEl: Reset AlphaS result:\n&quot;</span></div>
<div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tAfter reset, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale &lt;&lt; <span class="stringliteral">&quot;, alphas(Qren): &quot;</span> &lt;&lt; alphasVal &lt;&lt; <span class="stringliteral">&quot;, alphas(MZ): &quot;</span> &lt;&lt; alphasmzVal &lt;&lt; endl;</div>
<div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;  }</div>
<div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;  <span class="keywordflow">return</span> sum_msqjk;</div>
<div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;}</div>
<div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160; </div>
<div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;<span class="comment">// VH, H undecayed or Hbb</span></div>
<div class="line"><a name="l06578"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a30b0f3cd4082fab9f6d057b0243f26de"> 6578</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceTUtil.html#a30b0f3cd4082fab9f6d057b0243f26de">TUtil::VHiggsMatEl</a>(</div>
<div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1">TVar::Process</a>&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28c">TVar::Production</a>&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815f">TVar::MatrixElement</a>&amp; matrixElement,</div>
<div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;  <a class="code" href="structTVar_1_1event__scales__type.html">event_scales_type</a>* event_scales, <a class="code" href="classMelaIO.html">MelaIO</a>* RcdME,</div>
<div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; EBEAM,</div>
<div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;  <span class="keywordtype">bool</span> includeHiggsDecay,</div>
<div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;  <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049">TVar::VerbosityLevel</a> verbosity</div>
<div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;  ){</div>
<div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> GeV=1./100.; <span class="comment">// JHUGen mom. scale factor</span></div>
<div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;  <span class="keywordtype">double</span> sum_msqjk = 0;</div>
<div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;  <span class="comment">// by default assume only gg productions</span></div>
<div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;  <span class="comment">// FOTRAN convention -5    -4   -3  -2    -1  0 1 2 3 4 5</span></div>
<div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;  <span class="comment">//     parton flavor bbar cbar sbar ubar dbar g d u s c b</span></div>
<div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;  <span class="comment">// C++ convention     0     1   2    3    4   5 6 7 8 9 10</span></div>
<div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;  <span class="comment">//2-D matrix is reversed in fortran</span></div>
<div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;  <span class="comment">// msq[ parton2 ] [ parton1 ]</span></div>
<div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;  <span class="comment">//      flavor_msq[jj][ii] = fx1[ii]*fx2[jj]*msq[jj][ii];</span></div>
<div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;  <span class="keywordtype">double</span> MatElsq[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>][<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>]={ { 0 } };</div>
<div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160; </div>
<div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;  <span class="keywordflow">if</span> (matrixElement!=<a class="code" href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815faba6e6b23b0115bbaa919563a0626be03">TVar::JHUGen</a>){ <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: Non-JHUGen MEs are not supported&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> sum_msqjk; }</div>
<div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;  <span class="keywordflow">if</span> (!(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a>)){ <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: Production is not supported!&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> sum_msqjk; }</div>
<div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160; </div>
<div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;  <span class="keywordtype">int</span> nRequested_AssociatedJets=0;</div>
<div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;  <span class="keywordtype">int</span> nRequested_AssociatedLeptons=0;</div>
<div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;  <span class="keywordtype">int</span> nRequested_AssociatedPhotons=0;</div>
<div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;  <span class="keywordtype">int</span> AssociationVCompatibility=0;</div>
<div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;  <span class="keywordtype">int</span> partIncCode=<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777bad10522f5bc41f80ca8edf7c195cdb858">TVar::kNoAssociated</a>; <span class="comment">// Just to avoid warnings</span></div>
<div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a>){ <span class="comment">// Only use associated partons</span></div>
<div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;    partIncCode=<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba73861ec433a26ae79407bfe3f2f7b71a">TVar::kUseAssociated_Jets</a>;</div>
<div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;    nRequested_AssociatedJets=2;</div>
<div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;  }</div>
<div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a>){ <span class="comment">// Only use associated leptons(+)neutrinos</span></div>
<div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;    partIncCode=<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777bad693ed4c2007493918e2772261311b29">TVar::kUseAssociated_Leptons</a>;</div>
<div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;    nRequested_AssociatedLeptons=2;</div>
<div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;  }</div>
<div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a>){ <span class="comment">// Only use associated photon</span></div>
<div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;    partIncCode=<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777bae499e0ec0e4765de3a71e6e6d13eb535">TVar::kUseAssociated_Photons</a>;</div>
<div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;    nRequested_AssociatedPhotons=1;</div>
<div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;  }</div>
<div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a>) AssociationVCompatibility=24;</div>
<div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a>) AssociationVCompatibility=23;</div>
<div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a>) AssociationVCompatibility=22;</div>
<div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;  <a class="code" href="structTVar_1_1simple__event__record.html">simple_event_record</a> mela_event;</div>
<div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a743a8c341936dbaa10ce50a5b8d87eba">AssociationCode</a>=partIncCode;</div>
<div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a210cc509a3d155a23d69c94ea4558f87">AssociationVCompatibility</a>=AssociationVCompatibility;</div>
<div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aca54cfc4690b7f0ba78f5af03d0f1ddf">nRequested_AssociatedJets</a>=nRequested_AssociatedJets;</div>
<div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a3051f9440dc00a0a74b80997e898a5f5">nRequested_AssociatedLeptons</a>=nRequested_AssociatedLeptons;</div>
<div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a47e6f6d74f1c60d73e0328d299467b4e">nRequested_AssociatedPhotons</a>=nRequested_AssociatedPhotons;</div>
<div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;  <a class="code" href="namespaceTUtil.html#a2bfa5115b0bf398c2fae3cc36aedf9f5">GetBoostedParticleVectors</a>(</div>
<div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;    RcdME-&gt;<a class="code" href="classMelaIO.html#aebe453b6e0a6bf08d7aa68c1927ae48f">melaCand</a>,</div>
<div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;    mela_event,</div>
<div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;    verbosity</div>
<div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;    );</div>
<div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;  <span class="keywordflow">if</span> ((mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.size()&lt;(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(nRequested_AssociatedJets+nRequested_AssociatedLeptons) &amp;&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>!=<a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a>) || (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.size()&lt;(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)nRequested_AssociatedPhotons &amp;&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a>)){</div>
<div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>){</div>
<div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: Number of associated particles (&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.size() &lt;&lt; <span class="stringliteral">&quot;) is less than &quot;</span>;</div>
<div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>!=<a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; (nRequested_AssociatedJets+nRequested_AssociatedLeptons);</div>
<div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;      <span class="keywordflow">else</span> <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; nRequested_AssociatedPhotons;</div>
<div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; endl;</div>
<div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;    }</div>
<div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;    <span class="keywordflow">return</span> sum_msqjk;</div>
<div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;  }</div>
<div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160; </div>
<div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;  <span class="keywordtype">int</span> MYIDUP_prod[4]={ 0 }; <span class="comment">// &quot;Incoming&quot; partons 1, 2, &quot;outgoing&quot; partons 3, 4</span></div>
<div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;  <span class="keywordtype">int</span> MYIDUP_dec[2]={ -9000, -9000 }; <span class="comment">// &quot;Outgoing&quot; partons 1, 2 from the Higgs (-&gt;bb)</span></div>
<div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;  <span class="keywordtype">double</span> p4[9][4] ={ { 0 } };</div>
<div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;  <span class="keywordtype">double</span> helicities[9] ={ 0 };</div>
<div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;  <span class="keywordtype">int</span> vh_ids[9] ={ 0 };</div>
<div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;  TLorentzVector MomStore[<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>];</div>
<div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; i++) MomStore[i].SetXYZT(0, 0, 0, 0);</div>
<div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160; </div>
<div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;  <span class="comment">// p4(0:8,i) = (E(i),px(i),py(i),pz(i))</span></div>
<div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;  <span class="comment">// i=0,1: q1, qb2 (outgoing convention)</span></div>
<div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;  <span class="comment">// i=2,3: V*, V</span></div>
<div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;  <span class="comment">// i=4: H</span></div>
<div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;  <span class="comment">// i=5,6: f, fb from V</span></div>
<div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;  <span class="comment">// i=7,8: b, bb from H</span></div>
<div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ipar=0; ipar&lt;2; ipar++){</div>
<div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;    TLorentzVector* momTmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second);</div>
<div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;    <span class="keywordtype">int</span>* idtmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).first);</div>
<div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(*idtmp)) MYIDUP_prod[ipar] = *idtmp;</div>
<div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;    <span class="keywordflow">else</span> MYIDUP_prod[ipar] = 0;</div>
<div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;    <span class="keywordflow">if</span> (momTmp-&gt;T()&gt;0.){</div>
<div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;      p4[ipar][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;      p4[ipar][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;      p4[ipar][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;      p4[ipar][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;      MomStore[ipar] = (*momTmp);</div>
<div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;    }</div>
<div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;      p4[ipar][0] = -momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;      p4[ipar][1] = -momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;      p4[ipar][2] = -momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;      p4[ipar][3] = -momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;      MomStore[ipar] = -(*momTmp);</div>
<div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;      MYIDUP_prod[ipar] = -MYIDUP_prod[ipar];</div>
<div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;    }</div>
<div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;  }</div>
<div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;  <span class="comment">// Associated particles</span></div>
<div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ipar=0; ipar&lt;(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>!=<a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a> ? 2 : 1); ipar++){</div>
<div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;    TLorentzVector* momTmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.at(ipar).second);</div>
<div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;    <span class="keywordtype">int</span>* idtmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.at(ipar).first);</div>
<div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(*idtmp)) MYIDUP_prod[ipar+2] = *idtmp;</div>
<div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;    <span class="keywordflow">else</span> MYIDUP_prod[ipar+2] = 0;</div>
<div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;    p4[ipar+5][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;    p4[ipar+5][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;    p4[ipar+5][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;    p4[ipar+5][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;    MomStore[ipar+6] = (*momTmp);</div>
<div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;  }</div>
<div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a>) MYIDUP_prod[3]=-9000;</div>
<div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160; </div>
<div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_prod[0]) || <a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_prod[1])){ <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a55570e17cba7f10ab11173ebb9d25125">TVar::INFO</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: Initial state gluons are not permitted!&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> sum_msqjk; }</div>
<div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_prod[2]) || <a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(MYIDUP_prod[3])){ <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a55570e17cba7f10ab11173ebb9d25125">TVar::INFO</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: Final state gluons are not permitted!&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> sum_msqjk; }</div>
<div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a> &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(MYIDUP_prod[2])){ <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: GammaH associated photon (id=&quot;</span> &lt;&lt; MYIDUP_prod[2] &lt;&lt; <span class="stringliteral">&quot;) is not a photon! Please fix its id.&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> sum_msqjk; }</div>
<div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160; </div>
<div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;  <span class="comment">// Decay V/f ids</span></div>
<div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;  <span class="comment">// MYIDUP_dec as size=2 because JHUGen supports b-bbar decay</span></div>
<div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iv=0; iv&lt;2; iv++){</div>
<div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;    <span class="keywordtype">int</span> idtmp = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(iv);</div>
<div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(idtmp)) MYIDUP_dec[iv] = idtmp;</div>
<div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;    <span class="keywordflow">else</span> MYIDUP_dec[iv] = 0;</div>
<div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;  }</div>
<div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;  <span class="comment">// Decay daughters</span></div>
<div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar=0; ipar&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size(); ipar++){</div>
<div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;    TLorentzVector* momTmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.at(ipar).second);</div>
<div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;    <span class="keywordflow">if</span> (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size()==1){</div>
<div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;      p4[ipar+7][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;      p4[ipar+7][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;      p4[ipar+7][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;      p4[ipar+7][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;      MomStore[5] = (*momTmp); <span class="comment">// 5</span></div>
<div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;    }</div>
<div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size()==2){</div>
<div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;      p4[ipar+7][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;      p4[ipar+7][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;      p4[ipar+7][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;      p4[ipar+7][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;      MomStore[2*ipar+2] = (*momTmp); <span class="comment">// 2,4</span></div>
<div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a01f8690aaafe2c1d9b2497a41270f56a">PDGHelpers::isAQuark</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.at(ipar).first)) MYIDUP_dec[ipar]=mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.at(ipar).first;</div>
<div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;    }</div>
<div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size()==3){</div>
<div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;      <span class="keywordflow">if</span> (ipar&lt;2){</div>
<div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;        p4[7][0] += momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;        p4[7][1] += momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;        p4[7][2] += momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;        p4[7][3] += momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160;      }</div>
<div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;        p4[8][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;        p4[8][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;        p4[8][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;        p4[8][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;      }</div>
<div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160;      MomStore[ipar+2] = (*momTmp); <span class="comment">// 2,3,4</span></div>
<div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;    }</div>
<div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size()==4){</div>
<div class="line"><a name="l06734"></a><span class="lineno"> 6734</span>&#160;      <span class="keywordflow">if</span> (ipar&lt;2){</div>
<div class="line"><a name="l06735"></a><span class="lineno"> 6735</span>&#160;        p4[7][0] += momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;        p4[7][1] += momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;        p4[7][2] += momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;        p4[7][3] += momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160;      }</div>
<div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;        p4[8][0] += momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160;        p4[8][1] += momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;        p4[8][2] += momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l06744"></a><span class="lineno"> 6744</span>&#160;        p4[8][3] += momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l06745"></a><span class="lineno"> 6745</span>&#160;      }</div>
<div class="line"><a name="l06746"></a><span class="lineno"> 6746</span>&#160;      MomStore[ipar+2] = (*momTmp); <span class="comment">// 2,3,4,5</span></div>
<div class="line"><a name="l06747"></a><span class="lineno"> 6747</span>&#160;    }</div>
<div class="line"><a name="l06748"></a><span class="lineno"> 6748</span>&#160;    <span class="keywordflow">else</span>{ <span class="comment">// Should never happen</span></div>
<div class="line"><a name="l06749"></a><span class="lineno"> 6749</span>&#160;      p4[7][0] += momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l06750"></a><span class="lineno"> 6750</span>&#160;      p4[7][1] += momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l06751"></a><span class="lineno"> 6751</span>&#160;      p4[7][2] += momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l06752"></a><span class="lineno"> 6752</span>&#160;      p4[7][3] += momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160;      MomStore[5] = MomStore[5] + (*momTmp);</div>
<div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160;    }</div>
<div class="line"><a name="l06755"></a><span class="lineno"> 6755</span>&#160;  }</div>
<div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix=0; ix&lt;4; ix++){</div>
<div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;    p4[3][ix] = p4[5][ix] + p4[6][ix];</div>
<div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;    p4[4][ix] = p4[7][ix] + p4[8][ix];</div>
<div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;    p4[2][ix] = p4[3][ix] + p4[4][ix];</div>
<div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;  }</div>
<div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160; </div>
<div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;  vh_ids[4] = 25;</div>
<div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a>) vh_ids[2] = 23;</div>
<div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a>) vh_ids[2] = 24; <span class="comment">// To be changed later</span></div>
<div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>!=<a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a>) vh_ids[3] = vh_ids[2]; <span class="comment">// To be changed later for WH</span></div>
<div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160;  <span class="keywordflow">else</span> vh_ids[3] = 22;</div>
<div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160; </div>
<div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;  <span class="comment">// H-&gt;ffb decay is turned off, so no need to loop over helicities[7]=helicities[8]=+-1</span></div>
<div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;  vh_ids[7] = 5; helicities[7] = 1;</div>
<div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;  vh_ids[8] = -5; helicities[8] = 1;</div>
<div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;  <span class="keywordtype">int</span> HDKon = 0;</div>
<div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160;  <span class="keywordflow">if</span> (includeHiggsDecay &amp;&amp; MYIDUP_dec[0]!=-9000 &amp;&amp; MYIDUP_dec[1]!=-9000 &amp;&amp; MYIDUP_dec[0]==-MYIDUP_dec[1]){ <span class="comment">// H-&gt;ffb</span></div>
<div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;    HDKon=1;</div>
<div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;    <a class="code" href="TModJHUGenMELA_8hh.html#a18c71227d200f0734a5a6f8d08304df7">__modjhugenmela_MOD_sethdk</a>(&amp;HDKon);</div>
<div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: HDKon&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;  }</div>
<div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a55570e17cba7f10ab11173ebb9d25125">TVar::INFO</a> &amp;&amp; includeHiggsDecay) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: includeHiggsDecay=true is not supported for the present decay mode.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160; </div>
<div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;9; i++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;p4(&quot;</span> &lt;&lt; vh_ids[i] &lt;&lt; <span class="stringliteral">&quot;) = &quot;</span>  &lt;&lt; p4[i][0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt;  p4[i][1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>  &lt;&lt;  p4[i][2] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>  &lt;&lt;  p4[i][3] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160;  }</div>
<div class="line"><a name="l06782"></a><span class="lineno"> 6782</span>&#160; </div>
<div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;  <span class="keywordtype">double</span> defaultRenScale = <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale;</div>
<div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160;  <span class="keywordtype">double</span> defaultFacScale = <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale;</div>
<div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;  <span class="keywordtype">int</span> defaultNloop = <a class="code" href="TMCFM_8hh.html#a819542dc6ff812e041d403592a6b8990">nlooprun_</a>.nlooprun;</div>
<div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160;  <span class="keywordtype">int</span> defaultNflav = <a class="code" href="TMCFM_8hh.html#a55930b5d389dfae39115156b2bc9a692">nflav_</a>.nflav;</div>
<div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160;  <span class="keywordtype">string</span> defaultPdflabel = <a class="code" href="TMCFM_8hh.html#a4ff35855efcab9061a55f428e228e7dd">pdlabel_</a>.pdlabel;</div>
<div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160;  <span class="keywordtype">double</span> renQ = <a class="code" href="namespaceTUtil.html#a4a00d03fa1abeb4335b6abd9fae90663">InterpretScaleScheme</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, matrixElement, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#aabb9b35b555961e98acc8855bc6c2159">renomalizationScheme</a>, MomStore);</div>
<div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;  <span class="keywordtype">double</span> facQ = <a class="code" href="namespaceTUtil.html#a4a00d03fa1abeb4335b6abd9fae90663">InterpretScaleScheme</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, matrixElement, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a403e32d8e1aab756f9c2b3ff4863139f">factorizationScheme</a>, MomStore);</div>
<div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;  <a class="code" href="namespaceTUtil.html#ab551562aaa197841cd0a638f1f38b0ff">SetAlphaS</a>(renQ, facQ, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a7fe18004bd29525d34dcd6cb2b42a5b8">ren_scale_factor</a>, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a82661b3b8d040c36284a99bde2df79ce">fac_scale_factor</a>, 1, 5, <span class="stringliteral">&quot;cteq6_l&quot;</span>);</div>
<div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;  <span class="keywordtype">double</span> alphasVal, alphasmzVal;</div>
<div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160;  <a class="code" href="namespaceTUtil.html#a2f0fce2b3d66f17b673f2e75d87adf00">GetAlphaS</a>(&amp;alphasVal, &amp;alphasmzVal);</div>
<div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#ab63c4e79eba8f923423f2e97539ebeef">setRenormalizationScale</a>(renQ);</div>
<div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a383d634378da53d000781f8376f31145">setFactorizationScale</a>(facQ);</div>
<div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a47b8c8bb2137ecf3e3e1d1b873d3de0b">setAlphaS</a>(alphasVal);</div>
<div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a8487223242ccff4de3677d673152c7f5">setAlphaSatMZ</a>(alphasmzVal);</div>
<div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#aa20a0b91511fceb3584ad3a7d1ca210a">setHiggsMassWidth</a>(<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hmass, <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hwidth, 0);</div>
<div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#aa20a0b91511fceb3584ad3a7d1ca210a">setHiggsMassWidth</a>(<a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.h2mass, <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.h2width, 1);</div>
<div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: Set AlphaS:\n&quot;</span></div>
<div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tBefore set, alphas scale: &quot;</span> &lt;&lt; defaultRenScale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; defaultFacScale &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\trenQ: &quot;</span> &lt;&lt; renQ &lt;&lt; <span class="stringliteral">&quot; ( x &quot;</span> &lt;&lt; event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a7fe18004bd29525d34dcd6cb2b42a5b8">ren_scale_factor</a> &lt;&lt; <span class="stringliteral">&quot;), facQ: &quot;</span> &lt;&lt; facQ &lt;&lt; <span class="stringliteral">&quot; ( x &quot;</span> &lt;&lt; event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a82661b3b8d040c36284a99bde2df79ce">fac_scale_factor</a> &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div>
<div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tAfter set, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale &lt;&lt; <span class="stringliteral">&quot;, alphas(Qren): &quot;</span> &lt;&lt; alphasVal &lt;&lt; <span class="stringliteral">&quot;, alphas(MZ): &quot;</span> &lt;&lt; alphasmzVal &lt;&lt; endl;</div>
<div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;  }</div>
<div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160; </div>
<div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;  <span class="comment">// Since we have a lot of these checks, do them here.</span></div>
<div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;  <span class="keywordtype">bool</span> partonIsKnown[4];</div>
<div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;4; ip++) partonIsKnown[ip] = (MYIDUP_prod[ip]!=0);</div>
<div class="line"><a name="l06810"></a><span class="lineno"> 6810</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a>) &amp;&amp; !(partonIsKnown[2] &amp;&amp; partonIsKnown[3])){ <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a55570e17cba7f10ab11173ebb9d25125">TVar::INFO</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: Final state particles in leptonic/photonic VH have to have a definite id!&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> sum_msqjk; }</div>
<div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160; </div>
<div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> allowed_helicities[2] ={ -1, 1 }; <span class="comment">// L,R</span></div>
<div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160;  <span class="comment">// Setup outgoing H decay products (H-&gt;f fbar), templated with H-&gt;b bar if both fermions are unknown.</span></div>
<div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160;  vector&lt;pair&lt;int, int&gt;&gt; Hffparticles;</div>
<div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160;  <span class="keywordtype">double</span> Hffscale=1;</div>
<div class="line"><a name="l06816"></a><span class="lineno"> 6816</span>&#160;  <span class="keywordflow">if</span> (HDKon!=0){</div>
<div class="line"><a name="l06817"></a><span class="lineno"> 6817</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(MYIDUP_dec[0]) || !<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(MYIDUP_dec[1])){ <span class="comment">// If one particle is known, pick that line</span></div>
<div class="line"><a name="l06818"></a><span class="lineno"> 6818</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(MYIDUP_dec[0])) Hffparticles.push_back(pair&lt;int, int&gt;(MYIDUP_dec[0], -MYIDUP_dec[0]));</div>
<div class="line"><a name="l06819"></a><span class="lineno"> 6819</span>&#160;      <span class="keywordflow">else</span> Hffparticles.push_back(pair&lt;int, int&gt;(-MYIDUP_dec[1], MYIDUP_dec[1]));</div>
<div class="line"><a name="l06820"></a><span class="lineno"> 6820</span>&#160;    }</div>
<div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;    <span class="keywordflow">else</span>{ <span class="comment">// Else loop over possible quark lines</span></div>
<div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;      <span class="keywordtype">double</span> Hffscalesum=0;</div>
<div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> hquark=1; hquark&lt;=5; hquark++){</div>
<div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160;        <span class="keywordtype">double</span> Hffmass = <a class="code" href="TModParameters_8hh.html#ad03682febeb063859a8c4dd746245ed7">__modparameters_MOD_getmass</a>(&amp;hquark);</div>
<div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160;        Hffscalesum += Hffmass;</div>
<div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160;        <span class="keywordflow">if</span> (hquark==5){</div>
<div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160;          Hffparticles.push_back(pair&lt;int, int&gt;(hquark, -hquark));</div>
<div class="line"><a name="l06828"></a><span class="lineno"> 6828</span>&#160;          Hffparticles.push_back(pair&lt;int, int&gt;(-hquark, hquark));</div>
<div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160;          Hffscale /= Hffmass;</div>
<div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160;        }</div>
<div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160;      }</div>
<div class="line"><a name="l06832"></a><span class="lineno"> 6832</span>&#160;      Hffscale *= Hffscalesum;</div>
<div class="line"><a name="l06833"></a><span class="lineno"> 6833</span>&#160;    }</div>
<div class="line"><a name="l06834"></a><span class="lineno"> 6834</span>&#160;  }</div>
<div class="line"><a name="l06835"></a><span class="lineno"> 6835</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l06836"></a><span class="lineno"> 6836</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: Outgoing H-&gt; f fbar particles to compute for the ME template:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l06837"></a><span class="lineno"> 6837</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihf=0; ihf&lt;Hffparticles.size(); ihf++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t - (id8, id9) = (&quot;</span> &lt;&lt; Hffparticles.at(ihf).first &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; Hffparticles.at(ihf).second &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l06838"></a><span class="lineno"> 6838</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: ME scale for the H-&gt; f fbar particles: &quot;</span> &lt;&lt; Hffscale &lt;&lt; endl;</div>
<div class="line"><a name="l06839"></a><span class="lineno"> 6839</span>&#160;  }</div>
<div class="line"><a name="l06840"></a><span class="lineno"> 6840</span>&#160; </div>
<div class="line"><a name="l06841"></a><span class="lineno"> 6841</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a>){</div>
<div class="line"><a name="l06842"></a><span class="lineno"> 6842</span>&#160;    <span class="comment">// Setup incoming partons</span></div>
<div class="line"><a name="l06843"></a><span class="lineno"> 6843</span>&#160;    vector&lt;pair&lt;int, int&gt;&gt; incomingPartons;</div>
<div class="line"><a name="l06844"></a><span class="lineno"> 6844</span>&#160;    <span class="keywordflow">if</span> (partonIsKnown[0] &amp;&amp; partonIsKnown[1]) incomingPartons.push_back(pair&lt;int, int&gt;(MYIDUP_prod[0], MYIDUP_prod[1])); <span class="comment">// Parton 0 and 1 are both known</span></div>
<div class="line"><a name="l06845"></a><span class="lineno"> 6845</span>&#160;    <span class="comment">// FIXME: The following 2/1 assignments assume the CKM element for this pair is non-zero (there are divisions by Vckmsq_in/out later on).</span></div>
<div class="line"><a name="l06846"></a><span class="lineno"> 6846</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!partonIsKnown[0] &amp;&amp; !partonIsKnown[1]){ <span class="comment">// Parton 0 and 1 are unknown</span></div>
<div class="line"><a name="l06847"></a><span class="lineno"> 6847</span>&#160;      <span class="comment">// Consider all 4 incoming cases: d au, au d, u ad, ad u</span></div>
<div class="line"><a name="l06848"></a><span class="lineno"> 6848</span>&#160;      incomingPartons.push_back(pair&lt;int, int&gt;(1, -2)); <span class="comment">// du~ -&gt; W-</span></div>
<div class="line"><a name="l06849"></a><span class="lineno"> 6849</span>&#160;      incomingPartons.push_back(pair&lt;int, int&gt;(-2, 1)); <span class="comment">// u~d -&gt; W-</span></div>
<div class="line"><a name="l06850"></a><span class="lineno"> 6850</span>&#160;      incomingPartons.push_back(pair&lt;int, int&gt;(2, -1)); <span class="comment">// ud~ -&gt; W+</span></div>
<div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;      incomingPartons.push_back(pair&lt;int, int&gt;(-1, 2)); <span class="comment">// d~u -&gt; W+</span></div>
<div class="line"><a name="l06852"></a><span class="lineno"> 6852</span>&#160;    }</div>
<div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!partonIsKnown[1] &amp;&amp; partonIsKnown[0]){ <span class="comment">// Parton 0 is known</span></div>
<div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160;      <span class="comment">// Consider the only possible general cases</span></div>
<div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_prod[0])){ <span class="comment">// ud~ or u~d</span></div>
<div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iqf=1; iqf&lt;=5; iqf++){</div>
<div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;          <span class="keywordflow">if</span> (iqf%2==0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160;          <span class="keywordtype">int</span> jqf = -TMath::Sign(iqf, MYIDUP_prod[0]);</div>
<div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;          <span class="keywordtype">double</span> ckm_test = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;(MYIDUP_prod[0]), &amp;jqf);</div>
<div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;          <span class="keywordflow">if</span> (ckm_test!=0.){ incomingPartons.push_back(pair&lt;int, int&gt;(MYIDUP_prod[0], jqf)); <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;        }</div>
<div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;      }</div>
<div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_prod[0])){ <span class="comment">// du~ or d~u</span></div>
<div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iqf=2; iqf&lt;=4; iqf++){</div>
<div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;          <span class="keywordflow">if</span> (iqf%2==1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;          <span class="keywordtype">int</span> jqf = -TMath::Sign(iqf, MYIDUP_prod[0]);</div>
<div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;          <span class="keywordtype">double</span> ckm_test = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;(MYIDUP_prod[0]), &amp;jqf);</div>
<div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;          <span class="keywordflow">if</span> (ckm_test!=0.){ incomingPartons.push_back(pair&lt;int, int&gt;(MYIDUP_prod[0], jqf)); <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;        }</div>
<div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;      }</div>
<div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;    }</div>
<div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;    <span class="keywordflow">else</span><span class="comment">/* if (!partonIsKnown[0] &amp;&amp; partonIsKnown[1])*/</span>{ <span class="comment">// Parton 1 is known</span></div>
<div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160;      <span class="comment">// Consider the only possible general cases</span></div>
<div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_prod[1])){ <span class="comment">// ud~ or u~d</span></div>
<div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iqf=1; iqf&lt;=5; iqf++){</div>
<div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;          <span class="keywordflow">if</span> (iqf%2==0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160;          <span class="keywordtype">int</span> jqf = -TMath::Sign(iqf, MYIDUP_prod[1]);</div>
<div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;          <span class="keywordtype">double</span> ckm_test = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;jqf, &amp;(MYIDUP_prod[1]));</div>
<div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;          <span class="keywordflow">if</span> (ckm_test!=0.){ incomingPartons.push_back(pair&lt;int, int&gt;(jqf, MYIDUP_prod[1])); <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160;        }</div>
<div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160;      }</div>
<div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_prod[1])){ <span class="comment">// du~ or d~u</span></div>
<div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iqf=2; iqf&lt;=4; iqf++){</div>
<div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160;          <span class="keywordflow">if</span> (iqf%2==1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160;          <span class="keywordtype">int</span> jqf = -TMath::Sign(iqf, MYIDUP_prod[1]);</div>
<div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;          <span class="keywordtype">double</span> ckm_test = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;jqf, &amp;(MYIDUP_prod[1]));</div>
<div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;          <span class="keywordflow">if</span> (ckm_test!=0.){ incomingPartons.push_back(pair&lt;int, int&gt;(jqf, MYIDUP_prod[1])); <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160;        }</div>
<div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;      }</div>
<div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;    }</div>
<div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: Incoming partons to compute for the ME template:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; inpart:incomingPartons) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t - (id1, id2) = (&quot;</span> &lt;&lt; inpart.first &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; inpart.second &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;    }</div>
<div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160; </div>
<div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;    <span class="comment">// Setup outgoing partons</span></div>
<div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;    vector&lt;pair&lt;int, int&gt;&gt; outgoingPartons;</div>
<div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;    <span class="keywordflow">if</span> (partonIsKnown[2] &amp;&amp; partonIsKnown[3]) outgoingPartons.push_back(pair&lt;int, int&gt;(MYIDUP_prod[2], MYIDUP_prod[3])); <span class="comment">// Parton 0 and 1 are both known or Lep_WH</span></div>
<div class="line"><a name="l06899"></a><span class="lineno"> 6899</span>&#160;    <span class="comment">// FIXME: The following 2/1 assignments assume the CKM element for this pair is non-zero (there are divisions by Vckmsq_in/out later on).</span></div>
<div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!partonIsKnown[2] &amp;&amp; !partonIsKnown[3]){ <span class="comment">// Parton 0 and 1 are unknown</span></div>
<div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160;      <span class="comment">// Consider all 4 outgoing cases: d au, au d, u ad, ad u</span></div>
<div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;      outgoingPartons.push_back(pair&lt;int, int&gt;(1, -2)); <span class="comment">// W- -&gt; du~</span></div>
<div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160;      outgoingPartons.push_back(pair&lt;int, int&gt;(-2, 1)); <span class="comment">// W- -&gt; u~d</span></div>
<div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;      outgoingPartons.push_back(pair&lt;int, int&gt;(2, -1)); <span class="comment">// W+ -&gt; ud~</span></div>
<div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160;      outgoingPartons.push_back(pair&lt;int, int&gt;(-1, 2)); <span class="comment">// W+ -&gt; d~u</span></div>
<div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;    }</div>
<div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!partonIsKnown[3] &amp;&amp; partonIsKnown[2]){ <span class="comment">// Parton 0 is known</span></div>
<div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;      <span class="comment">// Consider the only possible general cases</span></div>
<div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_prod[2])){ <span class="comment">// ud~ or u~d</span></div>
<div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iqf=1; iqf&lt;=5; iqf++){</div>
<div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160;          <span class="keywordflow">if</span> (iqf%2==0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;          <span class="keywordtype">int</span> jqf = -TMath::Sign(iqf, MYIDUP_prod[2]);</div>
<div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;          <span class="keywordtype">double</span> ckm_test = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;(MYIDUP_prod[2]), &amp;jqf);</div>
<div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;          <span class="keywordflow">if</span> (ckm_test!=0.){ outgoingPartons.push_back(pair&lt;int, int&gt;(MYIDUP_prod[2], jqf)); <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;        }</div>
<div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;      }</div>
<div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_prod[2])){ <span class="comment">// du~ or d~u</span></div>
<div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iqf=2; iqf&lt;=4; iqf++){</div>
<div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;          <span class="keywordflow">if</span> (iqf%2==1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160;          <span class="keywordtype">int</span> jqf = -TMath::Sign(iqf, MYIDUP_prod[2]);</div>
<div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;          <span class="keywordtype">double</span> ckm_test = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;(MYIDUP_prod[2]), &amp;jqf);</div>
<div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160;          <span class="keywordflow">if</span> (ckm_test!=0.){ outgoingPartons.push_back(pair&lt;int, int&gt;(MYIDUP_prod[2], jqf)); <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160;        }</div>
<div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160;      }</div>
<div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;    }</div>
<div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160;    <span class="keywordflow">else</span><span class="comment">/* if (!partonIsKnown[2] &amp;&amp; partonIsKnown[3])*/</span>{ <span class="comment">// Parton 1 is known</span></div>
<div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160;      <span class="comment">// Consider the only possible general cases</span></div>
<div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(MYIDUP_prod[3])){ <span class="comment">// ud~ or u~d</span></div>
<div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iqf=1; iqf&lt;=5; iqf++){</div>
<div class="line"><a name="l06930"></a><span class="lineno"> 6930</span>&#160;          <span class="keywordflow">if</span> (iqf%2==0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;          <span class="keywordtype">int</span> jqf = -TMath::Sign(iqf, MYIDUP_prod[3]);</div>
<div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160;          <span class="keywordtype">double</span> ckm_test = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;jqf, &amp;(MYIDUP_prod[3]));</div>
<div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160;          <span class="keywordflow">if</span> (ckm_test!=0.){ outgoingPartons.push_back(pair&lt;int, int&gt;(jqf, MYIDUP_prod[3])); <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;        }</div>
<div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160;      }</div>
<div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(MYIDUP_prod[3])){ <span class="comment">// du~ or d~u</span></div>
<div class="line"><a name="l06937"></a><span class="lineno"> 6937</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iqf=2; iqf&lt;=4; iqf++){</div>
<div class="line"><a name="l06938"></a><span class="lineno"> 6938</span>&#160;          <span class="keywordflow">if</span> (iqf%2==1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;          <span class="keywordtype">int</span> jqf = -TMath::Sign(iqf, MYIDUP_prod[3]);</div>
<div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160;          <span class="keywordtype">double</span> ckm_test = <a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;jqf, &amp;(MYIDUP_prod[3]));</div>
<div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160;          <span class="keywordflow">if</span> (ckm_test!=0.){ outgoingPartons.push_back(pair&lt;int, int&gt;(jqf, MYIDUP_prod[3])); <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160;        }</div>
<div class="line"><a name="l06943"></a><span class="lineno"> 6943</span>&#160;      }</div>
<div class="line"><a name="l06944"></a><span class="lineno"> 6944</span>&#160;    }</div>
<div class="line"><a name="l06945"></a><span class="lineno"> 6945</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l06946"></a><span class="lineno"> 6946</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: Outgoing particles to compute for the ME template:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l06947"></a><span class="lineno"> 6947</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; outpart:outgoingPartons) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t - (id6, id7) = (&quot;</span> &lt;&lt; outpart.first &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; outpart.second &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l06948"></a><span class="lineno"> 6948</span>&#160;    }</div>
<div class="line"><a name="l06949"></a><span class="lineno"> 6949</span>&#160; </div>
<div class="line"><a name="l06950"></a><span class="lineno"> 6950</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; inpart:incomingPartons){</div>
<div class="line"><a name="l06951"></a><span class="lineno"> 6951</span>&#160;      vh_ids[0] = inpart.first;</div>
<div class="line"><a name="l06952"></a><span class="lineno"> 6952</span>&#160;      vh_ids[1] = inpart.second;</div>
<div class="line"><a name="l06953"></a><span class="lineno"> 6953</span>&#160;      vh_ids[2] = <a class="code" href="namespacePDGHelpers.html#a524d028bd6c958101639b40c8bfc5622">PDGHelpers::getCoupledVertex</a>(vh_ids[0], vh_ids[1]);</div>
<div class="line"><a name="l06954"></a><span class="lineno"> 6954</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a>(vh_ids[2])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06955"></a><span class="lineno"> 6955</span>&#160;      <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tIncoming &quot;</span> &lt;&lt; vh_ids[0] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; vh_ids[1] &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt; vh_ids[2] &lt;&lt; endl;</div>
<div class="line"><a name="l06956"></a><span class="lineno"> 6956</span>&#160; </div>
<div class="line"><a name="l06957"></a><span class="lineno"> 6957</span>&#160;      <span class="keywordtype">double</span> Vckmsq_in = pow(<a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;(vh_ids[0]), &amp;(vh_ids[1])), 2);</div>
<div class="line"><a name="l06958"></a><span class="lineno"> 6958</span>&#160;      <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tNeed to divide the ME by |VCKM_incoming|**2 = &quot;</span> &lt;&lt; Vckmsq_in &lt;&lt; endl;</div>
<div class="line"><a name="l06959"></a><span class="lineno"> 6959</span>&#160; </div>
<div class="line"><a name="l06960"></a><span class="lineno"> 6960</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; outpart:outgoingPartons){</div>
<div class="line"><a name="l06961"></a><span class="lineno"> 6961</span>&#160;        vh_ids[5] = outpart.first;</div>
<div class="line"><a name="l06962"></a><span class="lineno"> 6962</span>&#160;        vh_ids[6] = outpart.second;</div>
<div class="line"><a name="l06963"></a><span class="lineno"> 6963</span>&#160;        vh_ids[3] = <a class="code" href="namespacePDGHelpers.html#a524d028bd6c958101639b40c8bfc5622">PDGHelpers::getCoupledVertex</a>(vh_ids[5], vh_ids[6]);</div>
<div class="line"><a name="l06964"></a><span class="lineno"> 6964</span>&#160;        <span class="keywordflow">if</span> (vh_ids[2]!=vh_ids[3]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06965"></a><span class="lineno"> 6965</span>&#160;        <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t\tOutgoing &quot;</span> &lt;&lt; vh_ids[3] &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt; vh_ids[5] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; vh_ids[6] &lt;&lt; endl;</div>
<div class="line"><a name="l06966"></a><span class="lineno"> 6966</span>&#160; </div>
<div class="line"><a name="l06967"></a><span class="lineno"> 6967</span>&#160;        <span class="comment">// Compute a raw ME</span></div>
<div class="line"><a name="l06968"></a><span class="lineno"> 6968</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>=0;</div>
<div class="line"><a name="l06969"></a><span class="lineno"> 6969</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> h01 = 0; h01 &lt; 2; h01++){</div>
<div class="line"><a name="l06970"></a><span class="lineno"> 6970</span>&#160;          helicities[0] = allowed_helicities[h01];</div>
<div class="line"><a name="l06971"></a><span class="lineno"> 6971</span>&#160;          helicities[1] = -helicities[0];</div>
<div class="line"><a name="l06972"></a><span class="lineno"> 6972</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> h56 = 0; h56 &lt; 2; h56++){</div>
<div class="line"><a name="l06973"></a><span class="lineno"> 6973</span>&#160;            helicities[5] = allowed_helicities[h56];</div>
<div class="line"><a name="l06974"></a><span class="lineno"> 6974</span>&#160;            helicities[6] = -helicities[5];</div>
<div class="line"><a name="l06975"></a><span class="lineno"> 6975</span>&#160; </div>
<div class="line"><a name="l06976"></a><span class="lineno"> 6976</span>&#160;            <span class="keywordtype">double</span> msq_inst=0;</div>
<div class="line"><a name="l06977"></a><span class="lineno"> 6977</span>&#160;            <span class="keywordflow">if</span> (HDKon==0) <a class="code" href="TModVHiggsMatEl_8hh.html#ad58177e08a88e14c8aba3a90e95a23da">__modvhiggs_MOD_evalamp_vhiggs</a>(vh_ids, helicities, p4, &amp;msq_inst);</div>
<div class="line"><a name="l06978"></a><span class="lineno"> 6978</span>&#160;            <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l06979"></a><span class="lineno"> 6979</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> h78=0; h78&lt;2; h78++){</div>
<div class="line"><a name="l06980"></a><span class="lineno"> 6980</span>&#160;                helicities[7]=allowed_helicities[h78];</div>
<div class="line"><a name="l06981"></a><span class="lineno"> 6981</span>&#160;                helicities[8]=allowed_helicities[h78];</div>
<div class="line"><a name="l06982"></a><span class="lineno"> 6982</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihf=0; ihf&lt;Hffparticles.size(); ihf++){</div>
<div class="line"><a name="l06983"></a><span class="lineno"> 6983</span>&#160;                  vh_ids[7]=Hffparticles.at(ihf).first;</div>
<div class="line"><a name="l06984"></a><span class="lineno"> 6984</span>&#160;                  vh_ids[8]=Hffparticles.at(ihf).second;</div>
<div class="line"><a name="l06985"></a><span class="lineno"> 6985</span>&#160;                  <span class="keywordtype">double</span> msq_inst_LR=0;</div>
<div class="line"><a name="l06986"></a><span class="lineno"> 6986</span>&#160;                  <a class="code" href="TModVHiggsMatEl_8hh.html#ad58177e08a88e14c8aba3a90e95a23da">__modvhiggs_MOD_evalamp_vhiggs</a>(vh_ids, helicities, p4, &amp;msq_inst_LR);</div>
<div class="line"><a name="l06987"></a><span class="lineno"> 6987</span>&#160;                  msq_inst += msq_inst_LR;</div>
<div class="line"><a name="l06988"></a><span class="lineno"> 6988</span>&#160;                } <span class="comment">// End loop over template H-&gt;f fbar products</span></div>
<div class="line"><a name="l06989"></a><span class="lineno"> 6989</span>&#160;              } <span class="comment">// End loop over the spin of H-&gt;f fbar line</span></div>
<div class="line"><a name="l06990"></a><span class="lineno"> 6990</span>&#160;              msq_inst *= Hffscale;</div>
<div class="line"><a name="l06991"></a><span class="lineno"> 6991</span>&#160;            } <span class="comment">// End HDKon!=0</span></div>
<div class="line"><a name="l06992"></a><span class="lineno"> 6992</span>&#160;            <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a> += msq_inst;</div>
<div class="line"><a name="l06993"></a><span class="lineno"> 6993</span>&#160;          } <span class="comment">// End loop over h56</span></div>
<div class="line"><a name="l06994"></a><span class="lineno"> 6994</span>&#160;        } <span class="comment">// End loop over h01</span></div>
<div class="line"><a name="l06995"></a><span class="lineno"> 6995</span>&#160; </div>
<div class="line"><a name="l06996"></a><span class="lineno"> 6996</span>&#160;        <span class="comment">// Determine the outgoing scale</span></div>
<div class="line"><a name="l06997"></a><span class="lineno"> 6997</span>&#160;        <span class="keywordtype">double</span> scalesum_out=0;</div>
<div class="line"><a name="l06998"></a><span class="lineno"> 6998</span>&#160;        <span class="keywordflow">if</span> (!(partonIsKnown[2] &amp;&amp; partonIsKnown[3])){</div>
<div class="line"><a name="l06999"></a><span class="lineno"> 6999</span>&#160;          <span class="keywordtype">double</span> Vckmsq_out = pow(<a class="code" href="TModParameters_8hh.html#a4b21539bdadfc0331f2ef8372721c755">__modparameters_MOD_ckm</a>(&amp;(vh_ids[5]), &amp;(vh_ids[6])), 2);</div>
<div class="line"><a name="l07000"></a><span class="lineno"> 7000</span>&#160;          <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t\tDividing ME by |VCKM_outgoing|**2 = &quot;</span> &lt;&lt; Vckmsq_out &lt;&lt; endl;</div>
<div class="line"><a name="l07001"></a><span class="lineno"> 7001</span>&#160;          <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a> /= Vckmsq_out;</div>
<div class="line"><a name="l07002"></a><span class="lineno"> 7002</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> outgoing1=1; outgoing1&lt;=<a class="code" href="TMCFM_8hh.html#aba01db17f4a2bfbc3db60dc172972a25a9ef27f05549f71d70319d03789242cea">nf</a>; outgoing1++){</div>
<div class="line"><a name="l07003"></a><span class="lineno"> 7003</span>&#160;            <span class="keywordflow">if</span> (partonIsKnown[2] &amp;&amp; outgoing1!=abs(vh_ids[5])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07004"></a><span class="lineno"> 7004</span>&#160;            <span class="keywordflow">if</span> (outgoing1%2!=abs(vh_ids[5])%2 || outgoing1==6) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07005"></a><span class="lineno"> 7005</span>&#160;            <span class="keywordtype">int</span> iout = outgoing1 * TMath::Sign(1, vh_ids[5]);</div>
<div class="line"><a name="l07006"></a><span class="lineno"> 7006</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> outgoing2=1; outgoing2&lt;=<a class="code" href="TMCFM_8hh.html#aba01db17f4a2bfbc3db60dc172972a25a9ef27f05549f71d70319d03789242cea">nf</a>; outgoing2++){</div>
<div class="line"><a name="l07007"></a><span class="lineno"> 7007</span>&#160;              <span class="keywordflow">if</span> (partonIsKnown[3] &amp;&amp; outgoing2!=abs(vh_ids[6])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07008"></a><span class="lineno"> 7008</span>&#160;              <span class="keywordflow">if</span> (outgoing2%2!=abs(vh_ids[6])%2 || outgoing2==6) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07009"></a><span class="lineno"> 7009</span>&#160;              <span class="keywordtype">int</span> jout = outgoing2 * TMath::Sign(1, vh_ids[6]);</div>
<div class="line"><a name="l07010"></a><span class="lineno"> 7010</span>&#160;              scalesum_out += pow(<a class="code" href="TModParameters_8hh.html#a4b21539bdadfc0331f2ef8372721c755">__modparameters_MOD_ckm</a>(&amp;(iout), &amp;(jout)), 2);</div>
<div class="line"><a name="l07011"></a><span class="lineno"> 7011</span>&#160;            }</div>
<div class="line"><a name="l07012"></a><span class="lineno"> 7012</span>&#160;          }</div>
<div class="line"><a name="l07013"></a><span class="lineno"> 7013</span>&#160;        }</div>
<div class="line"><a name="l07014"></a><span class="lineno"> 7014</span>&#160;        <span class="keywordflow">else</span> scalesum_out = 1;</div>
<div class="line"><a name="l07015"></a><span class="lineno"> 7015</span>&#160;        <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t\tScale for outgoing particles: &quot;</span> &lt;&lt; scalesum_out &lt;&lt; endl;</div>
<div class="line"><a name="l07016"></a><span class="lineno"> 7016</span>&#160; </div>
<div class="line"><a name="l07017"></a><span class="lineno"> 7017</span>&#160;        <span class="comment">// Divide ME by the incoming scale factor (will be multiplied again inside the loop)</span></div>
<div class="line"><a name="l07018"></a><span class="lineno"> 7018</span>&#160;        <span class="keywordflow">if</span> (!partonIsKnown[0] || !partonIsKnown[1]){</div>
<div class="line"><a name="l07019"></a><span class="lineno"> 7019</span>&#160;          <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t\tDividing ME by |VCKM_incoming|**2 = &quot;</span> &lt;&lt; Vckmsq_in &lt;&lt; endl;</div>
<div class="line"><a name="l07020"></a><span class="lineno"> 7020</span>&#160;          <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a> /= Vckmsq_in;</div>
<div class="line"><a name="l07021"></a><span class="lineno"> 7021</span>&#160;        }</div>
<div class="line"><a name="l07022"></a><span class="lineno"> 7022</span>&#160; </div>
<div class="line"><a name="l07023"></a><span class="lineno"> 7023</span>&#160;        <span class="comment">// Sum all possible combinations</span></div>
<div class="line"><a name="l07024"></a><span class="lineno"> 7024</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> incoming1=1; incoming1&lt;=<a class="code" href="TMCFM_8hh.html#aba01db17f4a2bfbc3db60dc172972a25a9ef27f05549f71d70319d03789242cea">nf</a>; incoming1++){</div>
<div class="line"><a name="l07025"></a><span class="lineno"> 7025</span>&#160;          <span class="keywordflow">if</span> (partonIsKnown[0] &amp;&amp; incoming1!=abs(vh_ids[0])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07026"></a><span class="lineno"> 7026</span>&#160;          <span class="keywordflow">if</span> (incoming1%2!=abs(vh_ids[0])%2 || incoming1==6) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07027"></a><span class="lineno"> 7027</span>&#160;          <span class="keywordtype">int</span> iin = incoming1 * TMath::Sign(1, vh_ids[0]);</div>
<div class="line"><a name="l07028"></a><span class="lineno"> 7028</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> incoming2=1; incoming2&lt;=<a class="code" href="TMCFM_8hh.html#aba01db17f4a2bfbc3db60dc172972a25a9ef27f05549f71d70319d03789242cea">nf</a>; incoming2++){</div>
<div class="line"><a name="l07029"></a><span class="lineno"> 7029</span>&#160;            <span class="keywordflow">if</span> (partonIsKnown[1] &amp;&amp; incoming2!=abs(vh_ids[1])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07030"></a><span class="lineno"> 7030</span>&#160;            <span class="keywordflow">if</span> (incoming2%2!=abs(vh_ids[1])%2 || incoming2==6) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07031"></a><span class="lineno"> 7031</span>&#160;            <span class="keywordtype">int</span> jin = incoming2 * TMath::Sign(1, vh_ids[1]);</div>
<div class="line"><a name="l07032"></a><span class="lineno"> 7032</span>&#160;            <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t\t\tiin,jin = &quot;</span> &lt;&lt; iin &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; jin &lt;&lt; endl;</div>
<div class="line"><a name="l07033"></a><span class="lineno"> 7033</span>&#160;            <span class="keywordtype">double</span> scale_in=1;</div>
<div class="line"><a name="l07034"></a><span class="lineno"> 7034</span>&#160;            <span class="keywordflow">if</span> (!partonIsKnown[0] || !partonIsKnown[1]){</div>
<div class="line"><a name="l07035"></a><span class="lineno"> 7035</span>&#160;              scale_in = pow(<a class="code" href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a>(&amp;(iin), &amp;(jin)), 2);</div>
<div class="line"><a name="l07036"></a><span class="lineno"> 7036</span>&#160;              <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t\tScale for incoming particles: &quot;</span> &lt;&lt; scale_in &lt;&lt; endl;</div>
<div class="line"><a name="l07037"></a><span class="lineno"> 7037</span>&#160;            }</div>
<div class="line"><a name="l07038"></a><span class="lineno"> 7038</span>&#160;            MatElsq[jin+5][iin+5] += <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a> * 0.25 * scale_in *scalesum_out;</div>
<div class="line"><a name="l07039"></a><span class="lineno"> 7039</span>&#160;          }</div>
<div class="line"><a name="l07040"></a><span class="lineno"> 7040</span>&#160;        }</div>
<div class="line"><a name="l07041"></a><span class="lineno"> 7041</span>&#160;        <span class="comment">// msq is now added to MatElSq.</span></div>
<div class="line"><a name="l07042"></a><span class="lineno"> 7042</span>&#160;      } <span class="comment">// End loop over outgoing particle templates</span></div>
<div class="line"><a name="l07043"></a><span class="lineno"> 7043</span>&#160;    } <span class="comment">// End loop over incoming parton templates</span></div>
<div class="line"><a name="l07044"></a><span class="lineno"> 7044</span>&#160;  } <span class="comment">// End WH</span></div>
<div class="line"><a name="l07045"></a><span class="lineno"> 7045</span>&#160;  <span class="keywordflow">else</span>{ <span class="comment">// ZH, GammaH</span></div>
<div class="line"><a name="l07046"></a><span class="lineno"> 7046</span>&#160;    <span class="comment">// Setup incoming partons</span></div>
<div class="line"><a name="l07047"></a><span class="lineno"> 7047</span>&#160;    vector&lt;pair&lt;int, int&gt;&gt; incomingPartons;</div>
<div class="line"><a name="l07048"></a><span class="lineno"> 7048</span>&#160;    <span class="keywordflow">if</span> (partonIsKnown[0] &amp;&amp; partonIsKnown[1]) incomingPartons.push_back(pair&lt;int, int&gt;(MYIDUP_prod[0], MYIDUP_prod[1])); <span class="comment">// Parton 0 and 1 are both known</span></div>
<div class="line"><a name="l07049"></a><span class="lineno"> 7049</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!partonIsKnown[0] &amp;&amp; !partonIsKnown[1]){ <span class="comment">// Parton 0 and 1 are unknown</span></div>
<div class="line"><a name="l07050"></a><span class="lineno"> 7050</span>&#160;      <span class="comment">// Consider all 4 incoming cases: d ad, ad d, u au, au u</span></div>
<div class="line"><a name="l07051"></a><span class="lineno"> 7051</span>&#160;      incomingPartons.push_back(pair&lt;int, int&gt;(1, -1)); <span class="comment">// dd~ -&gt; Z</span></div>
<div class="line"><a name="l07052"></a><span class="lineno"> 7052</span>&#160;      incomingPartons.push_back(pair&lt;int, int&gt;(-1, 1)); <span class="comment">// d~d -&gt; Z</span></div>
<div class="line"><a name="l07053"></a><span class="lineno"> 7053</span>&#160;      incomingPartons.push_back(pair&lt;int, int&gt;(2, -2)); <span class="comment">// uu~ -&gt; Z</span></div>
<div class="line"><a name="l07054"></a><span class="lineno"> 7054</span>&#160;      incomingPartons.push_back(pair&lt;int, int&gt;(-2, 2)); <span class="comment">// u~u -&gt; Z</span></div>
<div class="line"><a name="l07055"></a><span class="lineno"> 7055</span>&#160;    }</div>
<div class="line"><a name="l07056"></a><span class="lineno"> 7056</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!partonIsKnown[1] &amp;&amp; partonIsKnown[0]) <span class="comment">// Parton 0 is known</span></div>
<div class="line"><a name="l07057"></a><span class="lineno"> 7057</span>&#160;      incomingPartons.push_back(pair&lt;int, int&gt;(MYIDUP_prod[0], -MYIDUP_prod[0])); <span class="comment">// id1, -id1</span></div>
<div class="line"><a name="l07058"></a><span class="lineno"> 7058</span>&#160;    <span class="keywordflow">else</span><span class="comment">/* if (!partonIsKnown[0] &amp;&amp; partonIsKnown[1])*/</span> <span class="comment">// Parton 1 is known</span></div>
<div class="line"><a name="l07059"></a><span class="lineno"> 7059</span>&#160;      incomingPartons.push_back(pair&lt;int, int&gt;(-MYIDUP_prod[1], MYIDUP_prod[1])); <span class="comment">// -id2, id2</span></div>
<div class="line"><a name="l07060"></a><span class="lineno"> 7060</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07061"></a><span class="lineno"> 7061</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: Incoming partons to compute for the ME template:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l07062"></a><span class="lineno"> 7062</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; inpart:incomingPartons) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t - (id1, id2) = (&quot;</span> &lt;&lt; inpart.first &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; inpart.second &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l07063"></a><span class="lineno"> 7063</span>&#160;    }</div>
<div class="line"><a name="l07064"></a><span class="lineno"> 7064</span>&#160; </div>
<div class="line"><a name="l07065"></a><span class="lineno"> 7065</span>&#160;    <span class="comment">// Setup outgoing partons</span></div>
<div class="line"><a name="l07066"></a><span class="lineno"> 7066</span>&#160;    vector&lt;pair&lt;int, int&gt;&gt; outgoingPartons;</div>
<div class="line"><a name="l07067"></a><span class="lineno"> 7067</span>&#160;    <span class="keywordflow">if</span> ((partonIsKnown[2] &amp;&amp; partonIsKnown[3]) || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a>) outgoingPartons.push_back(pair&lt;int, int&gt;(MYIDUP_prod[2], MYIDUP_prod[3])); <span class="comment">// Parton 0 and 1 are both known or Lep_ZH</span></div>
<div class="line"><a name="l07068"></a><span class="lineno"> 7068</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!partonIsKnown[2] &amp;&amp; !partonIsKnown[3]){ <span class="comment">// Parton 0 and 1 are unknown</span></div>
<div class="line"><a name="l07069"></a><span class="lineno"> 7069</span>&#160;      <span class="comment">// Consider all 4 outgoing cases: d au, au d, u ad, ad u</span></div>
<div class="line"><a name="l07070"></a><span class="lineno"> 7070</span>&#160;      outgoingPartons.push_back(pair&lt;int, int&gt;(1, -1)); <span class="comment">// Z -&gt; dd~</span></div>
<div class="line"><a name="l07071"></a><span class="lineno"> 7071</span>&#160;      outgoingPartons.push_back(pair&lt;int, int&gt;(-1, 1)); <span class="comment">// Z -&gt; d~d</span></div>
<div class="line"><a name="l07072"></a><span class="lineno"> 7072</span>&#160;      outgoingPartons.push_back(pair&lt;int, int&gt;(2, -2)); <span class="comment">// Z -&gt; uu~</span></div>
<div class="line"><a name="l07073"></a><span class="lineno"> 7073</span>&#160;      outgoingPartons.push_back(pair&lt;int, int&gt;(-2, 2)); <span class="comment">// Z -&gt; u~u</span></div>
<div class="line"><a name="l07074"></a><span class="lineno"> 7074</span>&#160;    }</div>
<div class="line"><a name="l07075"></a><span class="lineno"> 7075</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!partonIsKnown[3] &amp;&amp; partonIsKnown[2]) <span class="comment">// Parton 0 is known</span></div>
<div class="line"><a name="l07076"></a><span class="lineno"> 7076</span>&#160;      outgoingPartons.push_back(pair&lt;int, int&gt;(MYIDUP_prod[2], -MYIDUP_prod[2])); <span class="comment">// id1, -id1</span></div>
<div class="line"><a name="l07077"></a><span class="lineno"> 7077</span>&#160;    <span class="keywordflow">else</span><span class="comment">/* if (!partonIsKnown[2] &amp;&amp; partonIsKnown[3])*/</span> <span class="comment">// Parton 1 is known</span></div>
<div class="line"><a name="l07078"></a><span class="lineno"> 7078</span>&#160;      outgoingPartons.push_back(pair&lt;int, int&gt;(-MYIDUP_prod[3], MYIDUP_prod[3])); <span class="comment">// -id2, id2</span></div>
<div class="line"><a name="l07079"></a><span class="lineno"> 7079</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07080"></a><span class="lineno"> 7080</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: Outgoing particles to compute for the ME template:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l07081"></a><span class="lineno"> 7081</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> op=0; op&lt;outgoingPartons.size(); op++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t - (id6, id7) = (&quot;</span> &lt;&lt; outgoingPartons.at(op).first &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; outgoingPartons.at(op).second &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l07082"></a><span class="lineno"> 7082</span>&#160;    }</div>
<div class="line"><a name="l07083"></a><span class="lineno"> 7083</span>&#160; </div>
<div class="line"><a name="l07084"></a><span class="lineno"> 7084</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; inpart:incomingPartons){</div>
<div class="line"><a name="l07085"></a><span class="lineno"> 7085</span>&#160;      vh_ids[0] = inpart.first;</div>
<div class="line"><a name="l07086"></a><span class="lineno"> 7086</span>&#160;      vh_ids[1] = inpart.second;</div>
<div class="line"><a name="l07087"></a><span class="lineno"> 7087</span>&#160;      vh_ids[2] = <a class="code" href="namespacePDGHelpers.html#a524d028bd6c958101639b40c8bfc5622">PDGHelpers::getCoupledVertex</a>(vh_ids[0], vh_ids[1]);</div>
<div class="line"><a name="l07088"></a><span class="lineno"> 7088</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a>(vh_ids[2])) <span class="keywordflow">continue</span>; <span class="comment">// Notice, Z-&gt; Gamma + H should also have the id of the Z!</span></div>
<div class="line"><a name="l07089"></a><span class="lineno"> 7089</span>&#160;      <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tIncoming &quot;</span> &lt;&lt; vh_ids[0] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; vh_ids[1] &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt; vh_ids[2] &lt;&lt; endl;</div>
<div class="line"><a name="l07090"></a><span class="lineno"> 7090</span>&#160; </div>
<div class="line"><a name="l07091"></a><span class="lineno"> 7091</span>&#160;      <span class="comment">// Scale for the incoming state is 1</span></div>
<div class="line"><a name="l07092"></a><span class="lineno"> 7092</span>&#160; </div>
<div class="line"><a name="l07093"></a><span class="lineno"> 7093</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; outpart:outgoingPartons){</div>
<div class="line"><a name="l07094"></a><span class="lineno"> 7094</span>&#160;        vh_ids[5] = outpart.first;</div>
<div class="line"><a name="l07095"></a><span class="lineno"> 7095</span>&#160;        vh_ids[6] = outpart.second;</div>
<div class="line"><a name="l07096"></a><span class="lineno"> 7096</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a>) vh_ids[3] = 22;</div>
<div class="line"><a name="l07097"></a><span class="lineno"> 7097</span>&#160;        <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l07098"></a><span class="lineno"> 7098</span>&#160;          vh_ids[3] = <a class="code" href="namespacePDGHelpers.html#a524d028bd6c958101639b40c8bfc5622">PDGHelpers::getCoupledVertex</a>(vh_ids[5], vh_ids[6]);</div>
<div class="line"><a name="l07099"></a><span class="lineno"> 7099</span>&#160;          <span class="keywordflow">if</span> (vh_ids[2]!=vh_ids[3]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07100"></a><span class="lineno"> 7100</span>&#160;        }</div>
<div class="line"><a name="l07101"></a><span class="lineno"> 7101</span>&#160;        <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t\tOutgoing &quot;</span> &lt;&lt; vh_ids[3] &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt; vh_ids[5] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; vh_ids[6] &lt;&lt; endl;</div>
<div class="line"><a name="l07102"></a><span class="lineno"> 7102</span>&#160; </div>
<div class="line"><a name="l07103"></a><span class="lineno"> 7103</span>&#160;        <span class="comment">// Compute a raw ME</span></div>
<div class="line"><a name="l07104"></a><span class="lineno"> 7104</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>=0;</div>
<div class="line"><a name="l07105"></a><span class="lineno"> 7105</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> h01 = 0; h01 &lt; 2; h01++){</div>
<div class="line"><a name="l07106"></a><span class="lineno"> 7106</span>&#160;          helicities[0] = allowed_helicities[h01];</div>
<div class="line"><a name="l07107"></a><span class="lineno"> 7107</span>&#160;          helicities[1] = -helicities[0];</div>
<div class="line"><a name="l07108"></a><span class="lineno"> 7108</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> h56 = 0; h56 &lt; 2; h56++){</div>
<div class="line"><a name="l07109"></a><span class="lineno"> 7109</span>&#160;            helicities[5] = allowed_helicities[h56];</div>
<div class="line"><a name="l07110"></a><span class="lineno"> 7110</span>&#160;            helicities[6] = -helicities[5];</div>
<div class="line"><a name="l07111"></a><span class="lineno"> 7111</span>&#160; </div>
<div class="line"><a name="l07112"></a><span class="lineno"> 7112</span>&#160;            <span class="keywordtype">double</span> msq_inst=0;</div>
<div class="line"><a name="l07113"></a><span class="lineno"> 7113</span>&#160;            <span class="keywordflow">if</span> (HDKon==0) <a class="code" href="TModVHiggsMatEl_8hh.html#ad58177e08a88e14c8aba3a90e95a23da">__modvhiggs_MOD_evalamp_vhiggs</a>(vh_ids, helicities, p4, &amp;msq_inst);</div>
<div class="line"><a name="l07114"></a><span class="lineno"> 7114</span>&#160;            <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l07115"></a><span class="lineno"> 7115</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> h78=0; h78&lt;2; h78++){</div>
<div class="line"><a name="l07116"></a><span class="lineno"> 7116</span>&#160;                helicities[7]=allowed_helicities[h78];</div>
<div class="line"><a name="l07117"></a><span class="lineno"> 7117</span>&#160;                helicities[8]=allowed_helicities[h78];</div>
<div class="line"><a name="l07118"></a><span class="lineno"> 7118</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ihf=0; ihf&lt;Hffparticles.size(); ihf++){</div>
<div class="line"><a name="l07119"></a><span class="lineno"> 7119</span>&#160;                  vh_ids[7]=Hffparticles.at(ihf).first;</div>
<div class="line"><a name="l07120"></a><span class="lineno"> 7120</span>&#160;                  vh_ids[8]=Hffparticles.at(ihf).second;</div>
<div class="line"><a name="l07121"></a><span class="lineno"> 7121</span>&#160;                  <span class="keywordtype">double</span> msq_inst_LR=0;</div>
<div class="line"><a name="l07122"></a><span class="lineno"> 7122</span>&#160;                  <a class="code" href="TModVHiggsMatEl_8hh.html#ad58177e08a88e14c8aba3a90e95a23da">__modvhiggs_MOD_evalamp_vhiggs</a>(vh_ids, helicities, p4, &amp;msq_inst_LR);</div>
<div class="line"><a name="l07123"></a><span class="lineno"> 7123</span>&#160;                  msq_inst += msq_inst_LR;</div>
<div class="line"><a name="l07124"></a><span class="lineno"> 7124</span>&#160;                } <span class="comment">// End loop over template H-&gt;f fbar products</span></div>
<div class="line"><a name="l07125"></a><span class="lineno"> 7125</span>&#160;              } <span class="comment">// End loop over the spin of H-&gt;f fbar line</span></div>
<div class="line"><a name="l07126"></a><span class="lineno"> 7126</span>&#160;              msq_inst *= Hffscale;</div>
<div class="line"><a name="l07127"></a><span class="lineno"> 7127</span>&#160;            } <span class="comment">// End HDKon!=0</span></div>
<div class="line"><a name="l07128"></a><span class="lineno"> 7128</span>&#160;            <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a> += msq_inst;</div>
<div class="line"><a name="l07129"></a><span class="lineno"> 7129</span>&#160;          } <span class="comment">// End loop over h56</span></div>
<div class="line"><a name="l07130"></a><span class="lineno"> 7130</span>&#160;        } <span class="comment">// End loop over h01</span></div>
<div class="line"><a name="l07131"></a><span class="lineno"> 7131</span>&#160; </div>
<div class="line"><a name="l07132"></a><span class="lineno"> 7132</span>&#160;        <span class="comment">// Determine the outgoing scale</span></div>
<div class="line"><a name="l07133"></a><span class="lineno"> 7133</span>&#160;        <span class="keywordtype">double</span> scale_out=1;</div>
<div class="line"><a name="l07134"></a><span class="lineno"> 7134</span>&#160;        <span class="keywordflow">if</span> (!partonIsKnown[2] &amp;&amp; !partonIsKnown[3] &amp;&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>!=<a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a>){</div>
<div class="line"><a name="l07135"></a><span class="lineno"> 7135</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(vh_ids[5])) scale_out=3;</div>
<div class="line"><a name="l07136"></a><span class="lineno"> 7136</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(vh_ids[5])) scale_out=2;</div>
<div class="line"><a name="l07137"></a><span class="lineno"> 7137</span>&#160;        }</div>
<div class="line"><a name="l07138"></a><span class="lineno"> 7138</span>&#160;        <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t\tScale for outgoing particles: &quot;</span> &lt;&lt; scale_out &lt;&lt; endl;</div>
<div class="line"><a name="l07139"></a><span class="lineno"> 7139</span>&#160; </div>
<div class="line"><a name="l07140"></a><span class="lineno"> 7140</span>&#160;        <span class="comment">// Sum all possible combinations</span></div>
<div class="line"><a name="l07141"></a><span class="lineno"> 7141</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> incoming1=1; incoming1&lt;=<a class="code" href="TMCFM_8hh.html#aba01db17f4a2bfbc3db60dc172972a25a9ef27f05549f71d70319d03789242cea">nf</a>; incoming1++){</div>
<div class="line"><a name="l07142"></a><span class="lineno"> 7142</span>&#160;          <span class="keywordflow">if</span> (partonIsKnown[0] &amp;&amp; incoming1!=abs(vh_ids[0])) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07143"></a><span class="lineno"> 7143</span>&#160;          <span class="keywordflow">if</span> (incoming1%2!=abs(vh_ids[0])%2 || incoming1==6) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07144"></a><span class="lineno"> 7144</span>&#160;          <span class="keywordtype">int</span> iin = incoming1 * TMath::Sign(1, vh_ids[0]);</div>
<div class="line"><a name="l07145"></a><span class="lineno"> 7145</span>&#160;          <span class="keywordtype">int</span> jin=-iin;</div>
<div class="line"><a name="l07146"></a><span class="lineno"> 7146</span>&#160;          <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t\t\tiin,jin = &quot;</span> &lt;&lt; iin &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; jin &lt;&lt; endl;</div>
<div class="line"><a name="l07147"></a><span class="lineno"> 7147</span>&#160;          MatElsq[jin+5][iin+5] += <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a> * 0.25 * scale_out; <span class="comment">// No incoming state scale</span></div>
<div class="line"><a name="l07148"></a><span class="lineno"> 7148</span>&#160;        }</div>
<div class="line"><a name="l07149"></a><span class="lineno"> 7149</span>&#160;        <span class="comment">// msq is now added to MatElSq.</span></div>
<div class="line"><a name="l07150"></a><span class="lineno"> 7150</span>&#160;      } <span class="comment">// End loop over outgoing particle templates</span></div>
<div class="line"><a name="l07151"></a><span class="lineno"> 7151</span>&#160;    } <span class="comment">// End loop over incoming parton templates</span></div>
<div class="line"><a name="l07152"></a><span class="lineno"> 7152</span>&#160;  } <span class="comment">// End ZH, GammaH</span></div>
<div class="line"><a name="l07153"></a><span class="lineno"> 7153</span>&#160; </div>
<div class="line"><a name="l07154"></a><span class="lineno"> 7154</span>&#160;  <span class="keywordtype">int</span> GeVexponent_MEsq;</div>
<div class="line"><a name="l07155"></a><span class="lineno"> 7155</span>&#160;  <span class="keywordflow">if</span> (HDKon==0) GeVexponent_MEsq = 4-(1+nRequested_AssociatedJets+nRequested_AssociatedLeptons+nRequested_AssociatedPhotons)*2-4; <span class="comment">// Amplitude has additional 1/m**2 from propagator == MEsq has additional 1/m**4</span></div>
<div class="line"><a name="l07156"></a><span class="lineno"> 7156</span>&#160;  <span class="keywordflow">else</span> GeVexponent_MEsq = 4-(2+nRequested_AssociatedJets+nRequested_AssociatedLeptons+nRequested_AssociatedPhotons)*2;</div>
<div class="line"><a name="l07157"></a><span class="lineno"> 7157</span>&#160;  <span class="keywordtype">double</span> constant = pow(GeV, -GeVexponent_MEsq);</div>
<div class="line"><a name="l07158"></a><span class="lineno"> 7158</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0; ii&lt;<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>; ii++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj=0; jj&lt;<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>; jj++) MatElsq[jj][ii] *= constant; }</div>
<div class="line"><a name="l07159"></a><span class="lineno"> 7159</span>&#160;  <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07160"></a><span class="lineno"> 7160</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;MatElsq:\n&quot;</span>;</div>
<div class="line"><a name="l07161"></a><span class="lineno"> 7161</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; <a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>; ii++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj &lt; <a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>; jj++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; MatElsq[jj][ii] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>; <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl; }</div>
<div class="line"><a name="l07162"></a><span class="lineno"> 7162</span>&#160;  }</div>
<div class="line"><a name="l07163"></a><span class="lineno"> 7163</span>&#160;  sum_msqjk = <a class="code" href="namespaceTUtil.html#adf7b61bc902b23177090ce6b48a7f026">SumMEPDF</a>(MomStore[0], MomStore[1], MatElsq, RcdME, EBEAM, verbosity);</div>
<div class="line"><a name="l07164"></a><span class="lineno"> 7164</span>&#160; </div>
<div class="line"><a name="l07165"></a><span class="lineno"> 7165</span>&#160;  <span class="comment">// Turn H_DK off</span></div>
<div class="line"><a name="l07166"></a><span class="lineno"> 7166</span>&#160;  <span class="keywordflow">if</span> (HDKon!=0){</div>
<div class="line"><a name="l07167"></a><span class="lineno"> 7167</span>&#160;    HDKon=0;</div>
<div class="line"><a name="l07168"></a><span class="lineno"> 7168</span>&#160;    <a class="code" href="TModJHUGenMELA_8hh.html#a18c71227d200f0734a5a6f8d08304df7">__modjhugenmela_MOD_sethdk</a>(&amp;HDKon);</div>
<div class="line"><a name="l07169"></a><span class="lineno"> 7169</span>&#160;  }</div>
<div class="line"><a name="l07170"></a><span class="lineno"> 7170</span>&#160; </div>
<div class="line"><a name="l07171"></a><span class="lineno"> 7171</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07172"></a><span class="lineno"> 7172</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l07173"></a><span class="lineno"> 7173</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: Reset AlphaS:\n&quot;</span></div>
<div class="line"><a name="l07174"></a><span class="lineno"> 7174</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tBefore reset, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale &lt;&lt; endl;</div>
<div class="line"><a name="l07175"></a><span class="lineno"> 7175</span>&#160;  }</div>
<div class="line"><a name="l07176"></a><span class="lineno"> 7176</span>&#160;  <a class="code" href="namespaceTUtil.html#ab551562aaa197841cd0a638f1f38b0ff">SetAlphaS</a>(defaultRenScale, defaultFacScale, 1., 1., defaultNloop, defaultNflav, defaultPdflabel);</div>
<div class="line"><a name="l07177"></a><span class="lineno"> 7177</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07178"></a><span class="lineno"> 7178</span>&#160;    <a class="code" href="namespaceTUtil.html#a2f0fce2b3d66f17b673f2e75d87adf00">GetAlphaS</a>(&amp;alphasVal, &amp;alphasmzVal);</div>
<div class="line"><a name="l07179"></a><span class="lineno"> 7179</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l07180"></a><span class="lineno"> 7180</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::VHiggsMatEl: Reset AlphaS result:\n&quot;</span></div>
<div class="line"><a name="l07181"></a><span class="lineno"> 7181</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tAfter reset, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale &lt;&lt; <span class="stringliteral">&quot;, alphas(Qren): &quot;</span> &lt;&lt; alphasVal &lt;&lt; <span class="stringliteral">&quot;, alphas(MZ): &quot;</span> &lt;&lt; alphasmzVal &lt;&lt; endl;</div>
<div class="line"><a name="l07182"></a><span class="lineno"> 7182</span>&#160;  }</div>
<div class="line"><a name="l07183"></a><span class="lineno"> 7183</span>&#160;  <span class="keywordflow">return</span> sum_msqjk;</div>
<div class="line"><a name="l07184"></a><span class="lineno"> 7184</span>&#160;}</div>
<div class="line"><a name="l07185"></a><span class="lineno"> 7185</span>&#160; </div>
<div class="line"><a name="l07186"></a><span class="lineno"> 7186</span>&#160;<span class="comment">// ttH, H undecayed</span></div>
<div class="line"><a name="l07187"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#ae18db0378d82ee0e0efb6dab7216690b"> 7187</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceTUtil.html#ae18db0378d82ee0e0efb6dab7216690b">TUtil::TTHiggsMatEl</a>(</div>
<div class="line"><a name="l07188"></a><span class="lineno"> 7188</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1">TVar::Process</a>&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28c">TVar::Production</a>&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815f">TVar::MatrixElement</a>&amp; matrixElement,</div>
<div class="line"><a name="l07189"></a><span class="lineno"> 7189</span>&#160;  <a class="code" href="structTVar_1_1event__scales__type.html">event_scales_type</a>* event_scales, <a class="code" href="classMelaIO.html">MelaIO</a>* RcdME,</div>
<div class="line"><a name="l07190"></a><span class="lineno"> 7190</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; EBEAM,</div>
<div class="line"><a name="l07191"></a><span class="lineno"> 7191</span>&#160;  <span class="keywordtype">int</span> topDecay, <span class="keywordtype">int</span> topProcess,</div>
<div class="line"><a name="l07192"></a><span class="lineno"> 7192</span>&#160;  <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049">TVar::VerbosityLevel</a> verbosity</div>
<div class="line"><a name="l07193"></a><span class="lineno"> 7193</span>&#160;  ){</div>
<div class="line"><a name="l07194"></a><span class="lineno"> 7194</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> GeV=1./100.; <span class="comment">// JHUGen mom. scale factor</span></div>
<div class="line"><a name="l07195"></a><span class="lineno"> 7195</span>&#160;  <span class="keywordtype">double</span> sum_msqjk = 0;</div>
<div class="line"><a name="l07196"></a><span class="lineno"> 7196</span>&#160;  <span class="keywordtype">double</span> MatElsq[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>][<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>]={ { 0 } };</div>
<div class="line"><a name="l07197"></a><span class="lineno"> 7197</span>&#160; </div>
<div class="line"><a name="l07198"></a><span class="lineno"> 7198</span>&#160;  <span class="keywordflow">if</span> (matrixElement!=<a class="code" href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815faba6e6b23b0115bbaa919563a0626be03">TVar::JHUGen</a>){ <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::TTHiggsMatEl: Non-JHUGen MEs are not supported.&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> sum_msqjk; }</div>
<div class="line"><a name="l07199"></a><span class="lineno"> 7199</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>!=<a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca57c0e01faf9fc912284d7b1951fee889">TVar::ttH</a>){ <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::TTHiggsMatEl: Only ttH is supported.&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> sum_msqjk; }</div>
<div class="line"><a name="l07200"></a><span class="lineno"> 7200</span>&#160; </div>
<div class="line"><a name="l07201"></a><span class="lineno"> 7201</span>&#160;  <span class="keywordtype">int</span> partIncCode;</div>
<div class="line"><a name="l07202"></a><span class="lineno"> 7202</span>&#160;  <span class="keywordtype">int</span> nRequested_Tops=1;</div>
<div class="line"><a name="l07203"></a><span class="lineno"> 7203</span>&#160;  <span class="keywordtype">int</span> nRequested_Antitops=1;</div>
<div class="line"><a name="l07204"></a><span class="lineno"> 7204</span>&#160;  <span class="keywordflow">if</span> (topDecay&gt;0) partIncCode=<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba9dc7858ba1f4e25c5a0d3d914dcda75f">TVar::kUseAssociated_UnstableTops</a>; <span class="comment">// Look for unstable tops</span></div>
<div class="line"><a name="l07205"></a><span class="lineno"> 7205</span>&#160;  <span class="keywordflow">else</span> partIncCode=<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba4551ea50273466da7a30f958650ebfe7">TVar::kUseAssociated_StableTops</a>; <span class="comment">// Look for stable tops</span></div>
<div class="line"><a name="l07206"></a><span class="lineno"> 7206</span>&#160; </div>
<div class="line"><a name="l07207"></a><span class="lineno"> 7207</span>&#160;  <a class="code" href="structTVar_1_1simple__event__record.html">simple_event_record</a> mela_event;</div>
<div class="line"><a name="l07208"></a><span class="lineno"> 7208</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a743a8c341936dbaa10ce50a5b8d87eba">AssociationCode</a>=partIncCode;</div>
<div class="line"><a name="l07209"></a><span class="lineno"> 7209</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a056a397d9afaee97f896feadbe37b6a9">nRequested_Tops</a>=nRequested_Tops;</div>
<div class="line"><a name="l07210"></a><span class="lineno"> 7210</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5885d87c8c2e5dd520b9541e479d71bd">nRequested_Antitops</a>=nRequested_Antitops;</div>
<div class="line"><a name="l07211"></a><span class="lineno"> 7211</span>&#160;  <a class="code" href="namespaceTUtil.html#a2bfa5115b0bf398c2fae3cc36aedf9f5">GetBoostedParticleVectors</a>(</div>
<div class="line"><a name="l07212"></a><span class="lineno"> 7212</span>&#160;    RcdME-&gt;<a class="code" href="classMelaIO.html#aebe453b6e0a6bf08d7aa68c1927ae48f">melaCand</a>,</div>
<div class="line"><a name="l07213"></a><span class="lineno"> 7213</span>&#160;    mela_event,</div>
<div class="line"><a name="l07214"></a><span class="lineno"> 7214</span>&#160;    verbosity</div>
<div class="line"><a name="l07215"></a><span class="lineno"> 7215</span>&#160;    );</div>
<div class="line"><a name="l07216"></a><span class="lineno"> 7216</span>&#160; </div>
<div class="line"><a name="l07217"></a><span class="lineno"> 7217</span>&#160; </div>
<div class="line"><a name="l07218"></a><span class="lineno"> 7218</span>&#160;  <span class="keywordflow">if</span> (topDecay==0 &amp;&amp; (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a2261821b9391dd5f9e8f19f7c225212e">pStableTops</a>.size()&lt;1 || mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a1f9fa9f2c882417f3de782dce28a5840">pStableAntitops</a>.size()&lt;1)){</div>
<div class="line"><a name="l07219"></a><span class="lineno"> 7219</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a></div>
<div class="line"><a name="l07220"></a><span class="lineno"> 7220</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::TTHiggsMatEl: Number of stable tops (&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a2261821b9391dd5f9e8f19f7c225212e">pStableTops</a>.size() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l07221"></a><span class="lineno"> 7221</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; and number of stable antitops (&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a1f9fa9f2c882417f3de782dce28a5840">pStableAntitops</a>.size() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l07222"></a><span class="lineno"> 7222</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; in ttH process are not 1!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l07223"></a><span class="lineno"> 7223</span>&#160;    <span class="keywordflow">return</span> sum_msqjk;</div>
<div class="line"><a name="l07224"></a><span class="lineno"> 7224</span>&#160;  }</div>
<div class="line"><a name="l07225"></a><span class="lineno"> 7225</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (topDecay&gt;0 &amp;&amp; (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aa83c10b512e0f7e778dddf8a969fbfe6">pTopDaughters</a>.size()&lt;1 || mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#ab39f490ca0e69323fbbdbabfcb394306">pAntitopDaughters</a>.size()&lt;1)){</div>
<div class="line"><a name="l07226"></a><span class="lineno"> 7226</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a></div>
<div class="line"><a name="l07227"></a><span class="lineno"> 7227</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::TTHiggsMatEl: Number of set of top daughters (&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aa83c10b512e0f7e778dddf8a969fbfe6">pTopDaughters</a>.size() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l07228"></a><span class="lineno"> 7228</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; and number of set of antitop daughters (&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#ab39f490ca0e69323fbbdbabfcb394306">pAntitopDaughters</a>.size() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l07229"></a><span class="lineno"> 7229</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; in ttH process are not 1!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l07230"></a><span class="lineno"> 7230</span>&#160;    <span class="keywordflow">return</span> sum_msqjk;</div>
<div class="line"><a name="l07231"></a><span class="lineno"> 7231</span>&#160;  }</div>
<div class="line"><a name="l07232"></a><span class="lineno"> 7232</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (topDecay&gt;0 &amp;&amp; (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aa83c10b512e0f7e778dddf8a969fbfe6">pTopDaughters</a>.at(0).size()!=3 || mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#ab39f490ca0e69323fbbdbabfcb394306">pAntitopDaughters</a>.at(0).size()!=3)){</div>
<div class="line"><a name="l07233"></a><span class="lineno"> 7233</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a></div>
<div class="line"><a name="l07234"></a><span class="lineno"> 7234</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::TTHiggsMatEl: Number of top daughters (&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aa83c10b512e0f7e778dddf8a969fbfe6">pTopDaughters</a>.at(0).size() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l07235"></a><span class="lineno"> 7235</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; and number of antitop daughters (&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#ab39f490ca0e69323fbbdbabfcb394306">pAntitopDaughters</a>.at(0).size() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l07236"></a><span class="lineno"> 7236</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; in ttH process are not 3!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l07237"></a><span class="lineno"> 7237</span>&#160;    <span class="keywordflow">return</span> sum_msqjk;</div>
<div class="line"><a name="l07238"></a><span class="lineno"> 7238</span>&#160;  }</div>
<div class="line"><a name="l07239"></a><span class="lineno"> 7239</span>&#160; </div>
<div class="line"><a name="l07240"></a><span class="lineno"> 7240</span>&#160;  <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> topDaughters;</div>
<div class="line"><a name="l07241"></a><span class="lineno"> 7241</span>&#160;  <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> antitopDaughters;</div>
<div class="line"><a name="l07242"></a><span class="lineno"> 7242</span>&#160;  <span class="keywordtype">bool</span> isUnknown[2]={ <span class="keyword">true</span>, <span class="keyword">true</span> };</div>
<div class="line"><a name="l07243"></a><span class="lineno"> 7243</span>&#160; </div>
<div class="line"><a name="l07244"></a><span class="lineno"> 7244</span>&#160;  <span class="keywordflow">if</span> (topDecay&gt;0){</div>
<div class="line"><a name="l07245"></a><span class="lineno"> 7245</span>&#160;    <span class="comment">// Daughters are assumed to have been ordered as b, Wf, Wfb already.</span></div>
<div class="line"><a name="l07246"></a><span class="lineno"> 7246</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> itd=0; itd&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aa83c10b512e0f7e778dddf8a969fbfe6">pTopDaughters</a>.at(0).size(); itd++) topDaughters.push_back(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aa83c10b512e0f7e778dddf8a969fbfe6">pTopDaughters</a>.at(0).at(itd));</div>
<div class="line"><a name="l07247"></a><span class="lineno"> 7247</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> itd=0; itd&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#ab39f490ca0e69323fbbdbabfcb394306">pAntitopDaughters</a>.at(0).size(); itd++) antitopDaughters.push_back(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#ab39f490ca0e69323fbbdbabfcb394306">pAntitopDaughters</a>.at(0).at(itd));</div>
<div class="line"><a name="l07248"></a><span class="lineno"> 7248</span>&#160;  }</div>
<div class="line"><a name="l07249"></a><span class="lineno"> 7249</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l07250"></a><span class="lineno"> 7250</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> itop=0; itop&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a2261821b9391dd5f9e8f19f7c225212e">pStableTops</a>.size(); itop++) topDaughters.push_back(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a2261821b9391dd5f9e8f19f7c225212e">pStableTops</a>.at(itop));</div>
<div class="line"><a name="l07251"></a><span class="lineno"> 7251</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> itop=0; itop&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a1f9fa9f2c882417f3de782dce28a5840">pStableAntitops</a>.size(); itop++) antitopDaughters.push_back(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a1f9fa9f2c882417f3de782dce28a5840">pStableAntitops</a>.at(itop));</div>
<div class="line"><a name="l07252"></a><span class="lineno"> 7252</span>&#160;  }</div>
<div class="line"><a name="l07253"></a><span class="lineno"> 7253</span>&#160;  <span class="comment">// Check if either top is definitely identified</span></div>
<div class="line"><a name="l07254"></a><span class="lineno"> 7254</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> itd=0; itd&lt;topDaughters.size(); itd++){ <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(topDaughters.at(itd).first)){ isUnknown[0]=<span class="keyword">false</span>; <span class="keywordflow">break</span>; } }</div>
<div class="line"><a name="l07255"></a><span class="lineno"> 7255</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> itd=0; itd&lt;antitopDaughters.size(); itd++){ <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(antitopDaughters.at(itd).first)){ isUnknown[1]=<span class="keyword">false</span>; <span class="keywordflow">break</span>; } }</div>
<div class="line"><a name="l07256"></a><span class="lineno"> 7256</span>&#160; </div>
<div class="line"><a name="l07257"></a><span class="lineno"> 7257</span>&#160;  <span class="comment">// Start assigning the momenta</span></div>
<div class="line"><a name="l07258"></a><span class="lineno"> 7258</span>&#160;  <span class="comment">// 0,1: p1 p2</span></div>
<div class="line"><a name="l07259"></a><span class="lineno"> 7259</span>&#160;  <span class="comment">// 2-4: H,tb,t</span></div>
<div class="line"><a name="l07260"></a><span class="lineno"> 7260</span>&#160;  <span class="comment">// 5-8: bb,W-,f,fb</span></div>
<div class="line"><a name="l07261"></a><span class="lineno"> 7261</span>&#160;  <span class="comment">// 9-12: b,W+,fb,f</span></div>
<div class="line"><a name="l07262"></a><span class="lineno"> 7262</span>&#160;  <span class="keywordtype">double</span> p4[13][4]={ { 0 } };</div>
<div class="line"><a name="l07263"></a><span class="lineno"> 7263</span>&#160;  <span class="keywordtype">double</span> MYIDUP_prod[2]={ 0 };</div>
<div class="line"><a name="l07264"></a><span class="lineno"> 7264</span>&#160;  TLorentzVector MomStore[<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>];</div>
<div class="line"><a name="l07265"></a><span class="lineno"> 7265</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; i++) MomStore[i].SetXYZT(0, 0, 0, 0);</div>
<div class="line"><a name="l07266"></a><span class="lineno"> 7266</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ipar=0; ipar&lt;2; ipar++){</div>
<div class="line"><a name="l07267"></a><span class="lineno"> 7267</span>&#160;    TLorentzVector* momTmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second);</div>
<div class="line"><a name="l07268"></a><span class="lineno"> 7268</span>&#160;    <span class="keywordtype">int</span>* idtmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).first);</div>
<div class="line"><a name="l07269"></a><span class="lineno"> 7269</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(*idtmp)) MYIDUP_prod[ipar] = *idtmp;</div>
<div class="line"><a name="l07270"></a><span class="lineno"> 7270</span>&#160;    <span class="keywordflow">else</span> MYIDUP_prod[ipar] = 0;</div>
<div class="line"><a name="l07271"></a><span class="lineno"> 7271</span>&#160;    <span class="keywordflow">if</span> (momTmp-&gt;T()&gt;0.){</div>
<div class="line"><a name="l07272"></a><span class="lineno"> 7272</span>&#160;      p4[ipar][0] = -momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l07273"></a><span class="lineno"> 7273</span>&#160;      p4[ipar][1] = -momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l07274"></a><span class="lineno"> 7274</span>&#160;      p4[ipar][2] = -momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l07275"></a><span class="lineno"> 7275</span>&#160;      p4[ipar][3] = -momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l07276"></a><span class="lineno"> 7276</span>&#160;      MomStore[ipar] = (*momTmp);</div>
<div class="line"><a name="l07277"></a><span class="lineno"> 7277</span>&#160;    }</div>
<div class="line"><a name="l07278"></a><span class="lineno"> 7278</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l07279"></a><span class="lineno"> 7279</span>&#160;      p4[ipar][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l07280"></a><span class="lineno"> 7280</span>&#160;      p4[ipar][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l07281"></a><span class="lineno"> 7281</span>&#160;      p4[ipar][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l07282"></a><span class="lineno"> 7282</span>&#160;      p4[ipar][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l07283"></a><span class="lineno"> 7283</span>&#160;      MomStore[ipar] = -(*momTmp);</div>
<div class="line"><a name="l07284"></a><span class="lineno"> 7284</span>&#160;      MYIDUP_prod[ipar] = -MYIDUP_prod[ipar];</div>
<div class="line"><a name="l07285"></a><span class="lineno"> 7285</span>&#160;    }</div>
<div class="line"><a name="l07286"></a><span class="lineno"> 7286</span>&#160;  }</div>
<div class="line"><a name="l07287"></a><span class="lineno"> 7287</span>&#160; </div>
<div class="line"><a name="l07288"></a><span class="lineno"> 7288</span>&#160;  <span class="comment">// Assign top momenta</span></div>
<div class="line"><a name="l07289"></a><span class="lineno"> 7289</span>&#160;  <span class="comment">// t(4) -&gt; b(9) W+(10) (-&gt; f(12) fb(11))</span></div>
<div class="line"><a name="l07290"></a><span class="lineno"> 7290</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> t_pos=4;</div>
<div class="line"><a name="l07291"></a><span class="lineno"> 7291</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> b_pos=9;</div>
<div class="line"><a name="l07292"></a><span class="lineno"> 7292</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Wp_pos=10;</div>
<div class="line"><a name="l07293"></a><span class="lineno"> 7293</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Wpf_pos=12;</div>
<div class="line"><a name="l07294"></a><span class="lineno"> 7294</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Wpfb_pos=11;</div>
<div class="line"><a name="l07295"></a><span class="lineno"> 7295</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar=0; ipar&lt;topDaughters.size(); ipar++){</div>
<div class="line"><a name="l07296"></a><span class="lineno"> 7296</span>&#160;    TLorentzVector* momTmp = &amp;(topDaughters.at(ipar).second);</div>
<div class="line"><a name="l07297"></a><span class="lineno"> 7297</span>&#160;    <span class="keywordflow">if</span> (topDaughters.size()==1){</div>
<div class="line"><a name="l07298"></a><span class="lineno"> 7298</span>&#160;      p4[t_pos][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l07299"></a><span class="lineno"> 7299</span>&#160;      p4[t_pos][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l07300"></a><span class="lineno"> 7300</span>&#160;      p4[t_pos][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l07301"></a><span class="lineno"> 7301</span>&#160;      p4[t_pos][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l07302"></a><span class="lineno"> 7302</span>&#160;    }</div>
<div class="line"><a name="l07303"></a><span class="lineno"> 7303</span>&#160;    <span class="comment">// size==3</span></div>
<div class="line"><a name="l07304"></a><span class="lineno"> 7304</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipar==0){ <span class="comment">// b</span></div>
<div class="line"><a name="l07305"></a><span class="lineno"> 7305</span>&#160;      p4[b_pos][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l07306"></a><span class="lineno"> 7306</span>&#160;      p4[b_pos][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l07307"></a><span class="lineno"> 7307</span>&#160;      p4[b_pos][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l07308"></a><span class="lineno"> 7308</span>&#160;      p4[b_pos][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l07309"></a><span class="lineno"> 7309</span>&#160;    }</div>
<div class="line"><a name="l07310"></a><span class="lineno"> 7310</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipar==2){ <span class="comment">// Wfb</span></div>
<div class="line"><a name="l07311"></a><span class="lineno"> 7311</span>&#160;      p4[Wpfb_pos][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l07312"></a><span class="lineno"> 7312</span>&#160;      p4[Wpfb_pos][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l07313"></a><span class="lineno"> 7313</span>&#160;      p4[Wpfb_pos][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l07314"></a><span class="lineno"> 7314</span>&#160;      p4[Wpfb_pos][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l07315"></a><span class="lineno"> 7315</span>&#160;      p4[Wp_pos][0] += p4[Wpfb_pos][0];</div>
<div class="line"><a name="l07316"></a><span class="lineno"> 7316</span>&#160;      p4[Wp_pos][1] += p4[Wpfb_pos][1];</div>
<div class="line"><a name="l07317"></a><span class="lineno"> 7317</span>&#160;      p4[Wp_pos][2] += p4[Wpfb_pos][2];</div>
<div class="line"><a name="l07318"></a><span class="lineno"> 7318</span>&#160;      p4[Wp_pos][3] += p4[Wpfb_pos][3];</div>
<div class="line"><a name="l07319"></a><span class="lineno"> 7319</span>&#160;    }</div>
<div class="line"><a name="l07320"></a><span class="lineno"> 7320</span>&#160;    <span class="keywordflow">else</span><span class="comment">/* if (ipar==1)*/</span>{ <span class="comment">// Wf</span></div>
<div class="line"><a name="l07321"></a><span class="lineno"> 7321</span>&#160;      p4[Wpf_pos][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l07322"></a><span class="lineno"> 7322</span>&#160;      p4[Wpf_pos][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l07323"></a><span class="lineno"> 7323</span>&#160;      p4[Wpf_pos][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l07324"></a><span class="lineno"> 7324</span>&#160;      p4[Wpf_pos][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l07325"></a><span class="lineno"> 7325</span>&#160;      p4[Wp_pos][0] += p4[Wpf_pos][0];</div>
<div class="line"><a name="l07326"></a><span class="lineno"> 7326</span>&#160;      p4[Wp_pos][1] += p4[Wpf_pos][1];</div>
<div class="line"><a name="l07327"></a><span class="lineno"> 7327</span>&#160;      p4[Wp_pos][2] += p4[Wpf_pos][2];</div>
<div class="line"><a name="l07328"></a><span class="lineno"> 7328</span>&#160;      p4[Wp_pos][3] += p4[Wpf_pos][3];</div>
<div class="line"><a name="l07329"></a><span class="lineno"> 7329</span>&#160;    }</div>
<div class="line"><a name="l07330"></a><span class="lineno"> 7330</span>&#160;    MomStore[6] = MomStore[6] + (*momTmp); <span class="comment">// MomStore (I1, I2, 0, 0, 0, H, J1, J2)</span></div>
<div class="line"><a name="l07331"></a><span class="lineno"> 7331</span>&#160;  }</div>
<div class="line"><a name="l07332"></a><span class="lineno"> 7332</span>&#160;  <span class="keywordflow">if</span> (topDaughters.size()!=1){ <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;4; ix++){ <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=b_pos; ip&lt;=Wp_pos; ip++) p4[t_pos][ix] = p4[ip][ix]; } }</div>
<div class="line"><a name="l07333"></a><span class="lineno"> 7333</span>&#160; </div>
<div class="line"><a name="l07334"></a><span class="lineno"> 7334</span>&#160;  <span class="comment">// Assign antitop momenta</span></div>
<div class="line"><a name="l07335"></a><span class="lineno"> 7335</span>&#160;  <span class="comment">// tb(3) -&gt; bb(5) W-(6) (-&gt; f(7) fb(8))</span></div>
<div class="line"><a name="l07336"></a><span class="lineno"> 7336</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tb_pos=3;</div>
<div class="line"><a name="l07337"></a><span class="lineno"> 7337</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bb_pos=5;</div>
<div class="line"><a name="l07338"></a><span class="lineno"> 7338</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Wm_pos=6;</div>
<div class="line"><a name="l07339"></a><span class="lineno"> 7339</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Wmf_pos=7;</div>
<div class="line"><a name="l07340"></a><span class="lineno"> 7340</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Wmfb_pos=8;</div>
<div class="line"><a name="l07341"></a><span class="lineno"> 7341</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar=0; ipar&lt;antitopDaughters.size(); ipar++){</div>
<div class="line"><a name="l07342"></a><span class="lineno"> 7342</span>&#160;    TLorentzVector* momTmp = &amp;(antitopDaughters.at(ipar).second);</div>
<div class="line"><a name="l07343"></a><span class="lineno"> 7343</span>&#160;    <span class="keywordflow">if</span> (antitopDaughters.size()==1){</div>
<div class="line"><a name="l07344"></a><span class="lineno"> 7344</span>&#160;      p4[tb_pos][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l07345"></a><span class="lineno"> 7345</span>&#160;      p4[tb_pos][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l07346"></a><span class="lineno"> 7346</span>&#160;      p4[tb_pos][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l07347"></a><span class="lineno"> 7347</span>&#160;      p4[tb_pos][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l07348"></a><span class="lineno"> 7348</span>&#160;    }</div>
<div class="line"><a name="l07349"></a><span class="lineno"> 7349</span>&#160;    <span class="comment">// size==3</span></div>
<div class="line"><a name="l07350"></a><span class="lineno"> 7350</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipar==0){ <span class="comment">// bb</span></div>
<div class="line"><a name="l07351"></a><span class="lineno"> 7351</span>&#160;      p4[bb_pos][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l07352"></a><span class="lineno"> 7352</span>&#160;      p4[bb_pos][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l07353"></a><span class="lineno"> 7353</span>&#160;      p4[bb_pos][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l07354"></a><span class="lineno"> 7354</span>&#160;      p4[bb_pos][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l07355"></a><span class="lineno"> 7355</span>&#160;    }</div>
<div class="line"><a name="l07356"></a><span class="lineno"> 7356</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipar==1){ <span class="comment">// Wf</span></div>
<div class="line"><a name="l07357"></a><span class="lineno"> 7357</span>&#160;      p4[Wmf_pos][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l07358"></a><span class="lineno"> 7358</span>&#160;      p4[Wmf_pos][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l07359"></a><span class="lineno"> 7359</span>&#160;      p4[Wmf_pos][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l07360"></a><span class="lineno"> 7360</span>&#160;      p4[Wmf_pos][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l07361"></a><span class="lineno"> 7361</span>&#160;      p4[Wm_pos][0] += p4[Wmf_pos][0];</div>
<div class="line"><a name="l07362"></a><span class="lineno"> 7362</span>&#160;      p4[Wm_pos][1] += p4[Wmf_pos][1];</div>
<div class="line"><a name="l07363"></a><span class="lineno"> 7363</span>&#160;      p4[Wm_pos][2] += p4[Wmf_pos][2];</div>
<div class="line"><a name="l07364"></a><span class="lineno"> 7364</span>&#160;      p4[Wm_pos][3] += p4[Wmf_pos][3];</div>
<div class="line"><a name="l07365"></a><span class="lineno"> 7365</span>&#160;    }</div>
<div class="line"><a name="l07366"></a><span class="lineno"> 7366</span>&#160;    <span class="keywordflow">else</span><span class="comment">/* if (ipar==1)*/</span>{ <span class="comment">// Wfb</span></div>
<div class="line"><a name="l07367"></a><span class="lineno"> 7367</span>&#160;      p4[Wmfb_pos][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l07368"></a><span class="lineno"> 7368</span>&#160;      p4[Wmfb_pos][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l07369"></a><span class="lineno"> 7369</span>&#160;      p4[Wmfb_pos][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l07370"></a><span class="lineno"> 7370</span>&#160;      p4[Wmfb_pos][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l07371"></a><span class="lineno"> 7371</span>&#160;      p4[Wm_pos][0] += p4[Wmfb_pos][0];</div>
<div class="line"><a name="l07372"></a><span class="lineno"> 7372</span>&#160;      p4[Wm_pos][1] += p4[Wmfb_pos][1];</div>
<div class="line"><a name="l07373"></a><span class="lineno"> 7373</span>&#160;      p4[Wm_pos][2] += p4[Wmfb_pos][2];</div>
<div class="line"><a name="l07374"></a><span class="lineno"> 7374</span>&#160;      p4[Wm_pos][3] += p4[Wmfb_pos][3];</div>
<div class="line"><a name="l07375"></a><span class="lineno"> 7375</span>&#160;    }</div>
<div class="line"><a name="l07376"></a><span class="lineno"> 7376</span>&#160;    MomStore[7] = MomStore[7] + (*momTmp); <span class="comment">// MomStore (I1, I2, 0, 0, 0, H, J1, J2)</span></div>
<div class="line"><a name="l07377"></a><span class="lineno"> 7377</span>&#160;  }</div>
<div class="line"><a name="l07378"></a><span class="lineno"> 7378</span>&#160;  <span class="keywordflow">if</span> (antitopDaughters.size()!=1){ <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;4; ix++){ <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=5; ip&lt;=6; ip++) p4[tb_pos][ix] = p4[ip][ix]; } }</div>
<div class="line"><a name="l07379"></a><span class="lineno"> 7379</span>&#160; </div>
<div class="line"><a name="l07380"></a><span class="lineno"> 7380</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar=0; ipar&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size(); ipar++){</div>
<div class="line"><a name="l07381"></a><span class="lineno"> 7381</span>&#160;    TLorentzVector* momTmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.at(ipar).second);</div>
<div class="line"><a name="l07382"></a><span class="lineno"> 7382</span>&#160;    p4[2][0] += momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l07383"></a><span class="lineno"> 7383</span>&#160;    p4[2][1] += momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l07384"></a><span class="lineno"> 7384</span>&#160;    p4[2][2] += momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l07385"></a><span class="lineno"> 7385</span>&#160;    p4[2][3] += momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l07386"></a><span class="lineno"> 7386</span>&#160;    MomStore[5] = MomStore[5] + (*momTmp); <span class="comment">// i==(2, 3, 4) is (J1, J2, H), recorded as MomStore (I1, I2, 0, 0, 0, H, J1, J2)</span></div>
<div class="line"><a name="l07387"></a><span class="lineno"> 7387</span>&#160;  }</div>
<div class="line"><a name="l07388"></a><span class="lineno"> 7388</span>&#160; </div>
<div class="line"><a name="l07389"></a><span class="lineno"> 7389</span>&#160;  <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07390"></a><span class="lineno"> 7390</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0; ii&lt;13; ii++){ <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;p4[&quot;</span> &lt;&lt; ii &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span>; <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj=0; jj&lt;4; jj++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; p4[ii][jj]/GeV &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>; <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl; }</div>
<div class="line"><a name="l07391"></a><span class="lineno"> 7391</span>&#160;  }</div>
<div class="line"><a name="l07392"></a><span class="lineno"> 7392</span>&#160; </div>
<div class="line"><a name="l07393"></a><span class="lineno"> 7393</span>&#160;  <span class="keywordtype">double</span> defaultRenScale = <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale;</div>
<div class="line"><a name="l07394"></a><span class="lineno"> 7394</span>&#160;  <span class="keywordtype">double</span> defaultFacScale = <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale;</div>
<div class="line"><a name="l07395"></a><span class="lineno"> 7395</span>&#160;  <span class="keywordtype">int</span> defaultNloop = <a class="code" href="TMCFM_8hh.html#a819542dc6ff812e041d403592a6b8990">nlooprun_</a>.nlooprun;</div>
<div class="line"><a name="l07396"></a><span class="lineno"> 7396</span>&#160;  <span class="keywordtype">int</span> defaultNflav = <a class="code" href="TMCFM_8hh.html#a55930b5d389dfae39115156b2bc9a692">nflav_</a>.nflav;</div>
<div class="line"><a name="l07397"></a><span class="lineno"> 7397</span>&#160;  <span class="keywordtype">string</span> defaultPdflabel = <a class="code" href="TMCFM_8hh.html#a4ff35855efcab9061a55f428e228e7dd">pdlabel_</a>.pdlabel;</div>
<div class="line"><a name="l07398"></a><span class="lineno"> 7398</span>&#160;  <span class="keywordtype">double</span> renQ = <a class="code" href="namespaceTUtil.html#a4a00d03fa1abeb4335b6abd9fae90663">InterpretScaleScheme</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, matrixElement, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#aabb9b35b555961e98acc8855bc6c2159">renomalizationScheme</a>, MomStore);</div>
<div class="line"><a name="l07399"></a><span class="lineno"> 7399</span>&#160;  <span class="keywordtype">double</span> facQ = <a class="code" href="namespaceTUtil.html#a4a00d03fa1abeb4335b6abd9fae90663">InterpretScaleScheme</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, matrixElement, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a403e32d8e1aab756f9c2b3ff4863139f">factorizationScheme</a>, MomStore);</div>
<div class="line"><a name="l07400"></a><span class="lineno"> 7400</span>&#160;  <a class="code" href="namespaceTUtil.html#ab551562aaa197841cd0a638f1f38b0ff">SetAlphaS</a>(renQ, facQ, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a7fe18004bd29525d34dcd6cb2b42a5b8">ren_scale_factor</a>, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a82661b3b8d040c36284a99bde2df79ce">fac_scale_factor</a>, 1, 5, <span class="stringliteral">&quot;cteq6_l&quot;</span>);</div>
<div class="line"><a name="l07401"></a><span class="lineno"> 7401</span>&#160;  <span class="keywordtype">double</span> alphasVal, alphasmzVal;</div>
<div class="line"><a name="l07402"></a><span class="lineno"> 7402</span>&#160;  <a class="code" href="namespaceTUtil.html#a2f0fce2b3d66f17b673f2e75d87adf00">GetAlphaS</a>(&amp;alphasVal, &amp;alphasmzVal);</div>
<div class="line"><a name="l07403"></a><span class="lineno"> 7403</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#ab63c4e79eba8f923423f2e97539ebeef">setRenormalizationScale</a>(renQ);</div>
<div class="line"><a name="l07404"></a><span class="lineno"> 7404</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a383d634378da53d000781f8376f31145">setFactorizationScale</a>(facQ);</div>
<div class="line"><a name="l07405"></a><span class="lineno"> 7405</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a47b8c8bb2137ecf3e3e1d1b873d3de0b">setAlphaS</a>(alphasVal);</div>
<div class="line"><a name="l07406"></a><span class="lineno"> 7406</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a8487223242ccff4de3677d673152c7f5">setAlphaSatMZ</a>(alphasmzVal);</div>
<div class="line"><a name="l07407"></a><span class="lineno"> 7407</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#aa20a0b91511fceb3584ad3a7d1ca210a">setHiggsMassWidth</a>(<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hmass, <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hwidth, 0);</div>
<div class="line"><a name="l07408"></a><span class="lineno"> 7408</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#aa20a0b91511fceb3584ad3a7d1ca210a">setHiggsMassWidth</a>(<a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.h2mass, <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.h2width, 1);</div>
<div class="line"><a name="l07409"></a><span class="lineno"> 7409</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07410"></a><span class="lineno"> 7410</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l07411"></a><span class="lineno"> 7411</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::TTHiggsMatEl: Set AlphaS:\n&quot;</span></div>
<div class="line"><a name="l07412"></a><span class="lineno"> 7412</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tBefore set, alphas scale: &quot;</span> &lt;&lt; defaultRenScale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; defaultFacScale &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l07413"></a><span class="lineno"> 7413</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\trenQ: &quot;</span> &lt;&lt; renQ &lt;&lt; <span class="stringliteral">&quot; ( x &quot;</span> &lt;&lt; event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a7fe18004bd29525d34dcd6cb2b42a5b8">ren_scale_factor</a> &lt;&lt; <span class="stringliteral">&quot;), facQ: &quot;</span> &lt;&lt; facQ &lt;&lt; <span class="stringliteral">&quot; ( x &quot;</span> &lt;&lt; event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a82661b3b8d040c36284a99bde2df79ce">fac_scale_factor</a> &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div>
<div class="line"><a name="l07414"></a><span class="lineno"> 7414</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tAfter set, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale &lt;&lt; <span class="stringliteral">&quot;, alphas(Qren): &quot;</span> &lt;&lt; alphasVal &lt;&lt; <span class="stringliteral">&quot;, alphas(MZ): &quot;</span> &lt;&lt; alphasmzVal &lt;&lt; endl;</div>
<div class="line"><a name="l07415"></a><span class="lineno"> 7415</span>&#160;  }</div>
<div class="line"><a name="l07416"></a><span class="lineno"> 7416</span>&#160; </div>
<div class="line"><a name="l07417"></a><span class="lineno"> 7417</span>&#160;  <a class="code" href="TModJHUGenMELA_8hh.html#a5ba6679a0f52b8b512295bc107e7bb24">__modjhugenmela_MOD_settopdecays</a>(&amp;topDecay);</div>
<div class="line"><a name="l07418"></a><span class="lineno"> 7418</span>&#160;<span class="comment">  /***** BEGIN TTH ME CALCULATION *****/</span></div>
<div class="line"><a name="l07419"></a><span class="lineno"> 7419</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ib1=0; ib1&lt;3; ib1++){</div>
<div class="line"><a name="l07420"></a><span class="lineno"> 7420</span>&#160;    <span class="keywordflow">if</span> (topDaughters.size()==1 &amp;&amp; ib1!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07421"></a><span class="lineno"> 7421</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (topDaughters.size()==3 &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(topDaughters.at(0).first) &amp;&amp; ib1!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07422"></a><span class="lineno"> 7422</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> b1index;</div>
<div class="line"><a name="l07423"></a><span class="lineno"> 7423</span>&#160;    <span class="keywordflow">if</span> (ib1==0) b1index = b_pos;</div>
<div class="line"><a name="l07424"></a><span class="lineno"> 7424</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ib1==1) b1index = Wpf_pos;</div>
<div class="line"><a name="l07425"></a><span class="lineno"> 7425</span>&#160;    <span class="keywordflow">else</span> b1index = Wpfb_pos;</div>
<div class="line"><a name="l07426"></a><span class="lineno"> 7426</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> if1=0; if1&lt;3; if1++){</div>
<div class="line"><a name="l07427"></a><span class="lineno"> 7427</span>&#160;      <span class="keywordflow">if</span> (topDaughters.size()==1 &amp;&amp; if1!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07428"></a><span class="lineno"> 7428</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (topDaughters.size()==3 &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(topDaughters.at(1).first) &amp;&amp; if1!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07429"></a><span class="lineno"> 7429</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f1index;</div>
<div class="line"><a name="l07430"></a><span class="lineno"> 7430</span>&#160;      <span class="keywordflow">if</span> (if1==0) f1index = Wpf_pos;</div>
<div class="line"><a name="l07431"></a><span class="lineno"> 7431</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (if1==2) f1index = b_pos;</div>
<div class="line"><a name="l07432"></a><span class="lineno"> 7432</span>&#160;      <span class="keywordflow">else</span> f1index = Wpfb_pos;</div>
<div class="line"><a name="l07433"></a><span class="lineno"> 7433</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ifb1=0; ifb1&lt;3; ifb1++){</div>
<div class="line"><a name="l07434"></a><span class="lineno"> 7434</span>&#160;        <span class="keywordflow">if</span> (topDaughters.size()==1 &amp;&amp; ifb1!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07435"></a><span class="lineno"> 7435</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (topDaughters.size()==3 &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(topDaughters.at(2).first) &amp;&amp; ifb1!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07436"></a><span class="lineno"> 7436</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fb1index;</div>
<div class="line"><a name="l07437"></a><span class="lineno"> 7437</span>&#160;        <span class="keywordflow">if</span> (ifb1==2) fb1index = Wpf_pos;</div>
<div class="line"><a name="l07438"></a><span class="lineno"> 7438</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ifb1==1) fb1index = b_pos;</div>
<div class="line"><a name="l07439"></a><span class="lineno"> 7439</span>&#160;        <span class="keywordflow">else</span> fb1index = Wpfb_pos;</div>
<div class="line"><a name="l07440"></a><span class="lineno"> 7440</span>&#160; </div>
<div class="line"><a name="l07441"></a><span class="lineno"> 7441</span>&#160;        <span class="keywordflow">if</span> (b1index==f1index || b1index==fb1index || f1index==fb1index) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07442"></a><span class="lineno"> 7442</span>&#160; </div>
<div class="line"><a name="l07443"></a><span class="lineno"> 7443</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ib2=0; ib2&lt;3; ib2++){</div>
<div class="line"><a name="l07444"></a><span class="lineno"> 7444</span>&#160;          <span class="keywordflow">if</span> (antitopDaughters.size()==1 &amp;&amp; ib2!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07445"></a><span class="lineno"> 7445</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (antitopDaughters.size()==3 &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(antitopDaughters.at(0).first) &amp;&amp; ib2!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07446"></a><span class="lineno"> 7446</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> b2index;</div>
<div class="line"><a name="l07447"></a><span class="lineno"> 7447</span>&#160;          <span class="keywordflow">if</span> (ib2==0) b2index = bb_pos;</div>
<div class="line"><a name="l07448"></a><span class="lineno"> 7448</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ib2==1) b2index = Wmf_pos;</div>
<div class="line"><a name="l07449"></a><span class="lineno"> 7449</span>&#160;          <span class="keywordflow">else</span> b2index = Wmfb_pos;</div>
<div class="line"><a name="l07450"></a><span class="lineno"> 7450</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> if2=0; if2&lt;3; if2++){</div>
<div class="line"><a name="l07451"></a><span class="lineno"> 7451</span>&#160;            <span class="keywordflow">if</span> (antitopDaughters.size()==1 &amp;&amp; if2!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07452"></a><span class="lineno"> 7452</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (antitopDaughters.size()==3 &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(antitopDaughters.at(1).first) &amp;&amp; if2!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07453"></a><span class="lineno"> 7453</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f2index;</div>
<div class="line"><a name="l07454"></a><span class="lineno"> 7454</span>&#160;            <span class="keywordflow">if</span> (if2==0) f2index = Wmf_pos;</div>
<div class="line"><a name="l07455"></a><span class="lineno"> 7455</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (if2==2) f2index = bb_pos;</div>
<div class="line"><a name="l07456"></a><span class="lineno"> 7456</span>&#160;            <span class="keywordflow">else</span> f2index = Wmfb_pos;</div>
<div class="line"><a name="l07457"></a><span class="lineno"> 7457</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ifb2=0; ifb2&lt;3; ifb2++){</div>
<div class="line"><a name="l07458"></a><span class="lineno"> 7458</span>&#160;              <span class="keywordflow">if</span> (antitopDaughters.size()==1 &amp;&amp; ifb2!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07459"></a><span class="lineno"> 7459</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (antitopDaughters.size()==3 &amp;&amp; !<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(antitopDaughters.at(2).first) &amp;&amp; ifb2!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07460"></a><span class="lineno"> 7460</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fb2index;</div>
<div class="line"><a name="l07461"></a><span class="lineno"> 7461</span>&#160;              <span class="keywordflow">if</span> (ifb2==2) fb2index = Wmf_pos;</div>
<div class="line"><a name="l07462"></a><span class="lineno"> 7462</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ifb2==1) fb2index = bb_pos;</div>
<div class="line"><a name="l07463"></a><span class="lineno"> 7463</span>&#160;              <span class="keywordflow">else</span> fb2index = Wmfb_pos;</div>
<div class="line"><a name="l07464"></a><span class="lineno"> 7464</span>&#160; </div>
<div class="line"><a name="l07465"></a><span class="lineno"> 7465</span>&#160;              <span class="keywordflow">if</span> (b2index==f2index || b2index==fb2index || f2index==fb2index) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07466"></a><span class="lineno"> 7466</span>&#160; </div>
<div class="line"><a name="l07467"></a><span class="lineno"> 7467</span>&#160;              <span class="keywordtype">double</span> p4_current[13][4]={ { 0 } };</div>
<div class="line"><a name="l07468"></a><span class="lineno"> 7468</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;4; ix++){</div>
<div class="line"><a name="l07469"></a><span class="lineno"> 7469</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;=2; ip++) p4_current[ip][ix] = p4[ip][ix]; <span class="comment">// I1, I2, H do not change.</span></div>
<div class="line"><a name="l07470"></a><span class="lineno"> 7470</span>&#160;                p4_current[t_pos][ix] = p4[t_pos][ix]; <span class="comment">// t does not change.</span></div>
<div class="line"><a name="l07471"></a><span class="lineno"> 7471</span>&#160;                p4_current[b1index][ix] = p4[b_pos][ix]; <span class="comment">// Assign b to different position.</span></div>
<div class="line"><a name="l07472"></a><span class="lineno"> 7472</span>&#160;                p4_current[f1index][ix] = p4[Wpf_pos][ix]; <span class="comment">// Assign Wp-&gt;f? to different position.</span></div>
<div class="line"><a name="l07473"></a><span class="lineno"> 7473</span>&#160;                p4_current[fb1index][ix] = p4[Wpfb_pos][ix]; <span class="comment">// Assign Wp-&gt;?fb to different position.</span></div>
<div class="line"><a name="l07474"></a><span class="lineno"> 7474</span>&#160;                p4_current[Wp_pos][ix] = p4_current[Wpf_pos][ix] + p4_current[Wpfb_pos][ix]; <span class="comment">// Re-sum W+ momentum.</span></div>
<div class="line"><a name="l07475"></a><span class="lineno"> 7475</span>&#160; </div>
<div class="line"><a name="l07476"></a><span class="lineno"> 7476</span>&#160;                p4_current[tb_pos][ix] = p4[tb_pos][ix]; <span class="comment">// tb does not change.</span></div>
<div class="line"><a name="l07477"></a><span class="lineno"> 7477</span>&#160;                p4_current[b2index][ix] = p4[bb_pos][ix]; <span class="comment">// Assign bb to different position.</span></div>
<div class="line"><a name="l07478"></a><span class="lineno"> 7478</span>&#160;                p4_current[f2index][ix] = p4[Wmf_pos][ix]; <span class="comment">// Assign Wm-&gt;f? to different position.</span></div>
<div class="line"><a name="l07479"></a><span class="lineno"> 7479</span>&#160;                p4_current[fb2index][ix] = p4[Wmfb_pos][ix]; <span class="comment">// Assign Wm-&gt;?fb to different position.</span></div>
<div class="line"><a name="l07480"></a><span class="lineno"> 7480</span>&#160;                p4_current[Wm_pos][ix] = p4_current[Wmf_pos][ix] + p4_current[Wmfb_pos][ix]; <span class="comment">// Re-sum W- momentum.</span></div>
<div class="line"><a name="l07481"></a><span class="lineno"> 7481</span>&#160;              }</div>
<div class="line"><a name="l07482"></a><span class="lineno"> 7482</span>&#160;              <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07483"></a><span class="lineno"> 7483</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l07484"></a><span class="lineno"> 7484</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;TUtil::TTHiggsMatEl: Unswapped instance for &quot;</span></div>
<div class="line"><a name="l07485"></a><span class="lineno"> 7485</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;b(&quot;</span> &lt;&lt; b_pos &lt;&lt; <span class="stringliteral">&quot;) -&gt; &quot;</span> &lt;&lt; b1index &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l07486"></a><span class="lineno"> 7486</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Wpf(&quot;</span> &lt;&lt; Wpf_pos &lt;&lt; <span class="stringliteral">&quot;) -&gt; &quot;</span> &lt;&lt; f1index &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l07487"></a><span class="lineno"> 7487</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Wpfb(&quot;</span> &lt;&lt; Wpfb_pos &lt;&lt; <span class="stringliteral">&quot;) -&gt; &quot;</span> &lt;&lt; fb1index &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l07488"></a><span class="lineno"> 7488</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;bb(&quot;</span> &lt;&lt; bb_pos &lt;&lt; <span class="stringliteral">&quot;) -&gt; &quot;</span> &lt;&lt; b2index &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l07489"></a><span class="lineno"> 7489</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Wmf(&quot;</span> &lt;&lt; Wmf_pos &lt;&lt; <span class="stringliteral">&quot;) -&gt; &quot;</span> &lt;&lt; f2index &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l07490"></a><span class="lineno"> 7490</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Wmfb(&quot;</span> &lt;&lt; Wmfb_pos &lt;&lt; <span class="stringliteral">&quot;) -&gt; &quot;</span> &lt;&lt; fb2index &lt;&lt; endl;</div>
<div class="line"><a name="l07491"></a><span class="lineno"> 7491</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0; ii&lt;13; ii++){ <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;p4_instance[&quot;</span> &lt;&lt; ii &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span>; <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj=0; jj&lt;4; jj++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; p4_current[ii][jj]/GeV &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>; <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl; }</div>
<div class="line"><a name="l07492"></a><span class="lineno"> 7492</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l07493"></a><span class="lineno"> 7493</span>&#160;              }</div>
<div class="line"><a name="l07494"></a><span class="lineno"> 7494</span>&#160; </div>
<div class="line"><a name="l07495"></a><span class="lineno"> 7495</span>&#160;              <span class="keywordtype">double</span> MatElsq_tmp[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>][<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>]={ { 0 } };</div>
<div class="line"><a name="l07496"></a><span class="lineno"> 7496</span>&#160;              <span class="keywordtype">double</span> MatElsq_tmp_swap[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>][<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>]={ { 0 } };</div>
<div class="line"><a name="l07497"></a><span class="lineno"> 7497</span>&#160;              <a class="code" href="TModTTBHMatEl_8hh.html#a1103926096f38f0f19d326995fadbc81">__modttbhiggs_MOD_evalxsec_pp_ttbh</a>(p4_current, &amp;topProcess, MatElsq_tmp);</div>
<div class="line"><a name="l07498"></a><span class="lineno"> 7498</span>&#160;              <span class="keywordflow">if</span> (isUnknown[0] &amp;&amp; isUnknown[1]){</div>
<div class="line"><a name="l07499"></a><span class="lineno"> 7499</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;4; ix++){</div>
<div class="line"><a name="l07500"></a><span class="lineno"> 7500</span>&#160;                  swap(p4_current[t_pos][ix], p4_current[tb_pos][ix]);</div>
<div class="line"><a name="l07501"></a><span class="lineno"> 7501</span>&#160;                  swap(p4_current[b_pos][ix], p4_current[bb_pos][ix]);</div>
<div class="line"><a name="l07502"></a><span class="lineno"> 7502</span>&#160;                  swap(p4_current[Wp_pos][ix], p4_current[Wm_pos][ix]);</div>
<div class="line"><a name="l07503"></a><span class="lineno"> 7503</span>&#160;                  swap(p4_current[Wpf_pos][ix], p4_current[Wmf_pos][ix]);</div>
<div class="line"><a name="l07504"></a><span class="lineno"> 7504</span>&#160;                  swap(p4_current[Wpfb_pos][ix], p4_current[Wmfb_pos][ix]);</div>
<div class="line"><a name="l07505"></a><span class="lineno"> 7505</span>&#160;                }</div>
<div class="line"><a name="l07506"></a><span class="lineno"> 7506</span>&#160;                <a class="code" href="TModTTBHMatEl_8hh.html#a1103926096f38f0f19d326995fadbc81">__modttbhiggs_MOD_evalxsec_pp_ttbh</a>(p4_current, &amp;topProcess, MatElsq_tmp_swap);</div>
<div class="line"><a name="l07507"></a><span class="lineno"> 7507</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix=0; ix&lt;11; ix++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy=0; iy&lt;11; iy++) MatElsq_tmp[iy][ix] = (MatElsq_tmp[iy][ix]+MatElsq_tmp_swap[iy][ix])/2.; }</div>
<div class="line"><a name="l07508"></a><span class="lineno"> 7508</span>&#160;              }</div>
<div class="line"><a name="l07509"></a><span class="lineno"> 7509</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix=0; ix&lt;11; ix++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy=0; iy&lt;11; iy++) MatElsq[iy][ix] += MatElsq_tmp[iy][ix]; }</div>
<div class="line"><a name="l07510"></a><span class="lineno"> 7510</span>&#160;              <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07511"></a><span class="lineno"> 7511</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l07512"></a><span class="lineno"> 7512</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;TUtil::TTHiggsMatEl: Swapped instance for &quot;</span></div>
<div class="line"><a name="l07513"></a><span class="lineno"> 7513</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;b(&quot;</span> &lt;&lt; b_pos &lt;&lt; <span class="stringliteral">&quot;) -&gt; &quot;</span> &lt;&lt; b1index &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l07514"></a><span class="lineno"> 7514</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Wpf(&quot;</span> &lt;&lt; Wpf_pos &lt;&lt; <span class="stringliteral">&quot;) -&gt; &quot;</span> &lt;&lt; f1index &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l07515"></a><span class="lineno"> 7515</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Wpfb(&quot;</span> &lt;&lt; Wpfb_pos &lt;&lt; <span class="stringliteral">&quot;) -&gt; &quot;</span> &lt;&lt; fb1index &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l07516"></a><span class="lineno"> 7516</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;bb(&quot;</span> &lt;&lt; bb_pos &lt;&lt; <span class="stringliteral">&quot;) -&gt; &quot;</span> &lt;&lt; b2index &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l07517"></a><span class="lineno"> 7517</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Wmf(&quot;</span> &lt;&lt; Wmf_pos &lt;&lt; <span class="stringliteral">&quot;) -&gt; &quot;</span> &lt;&lt; f2index &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l07518"></a><span class="lineno"> 7518</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Wmfb(&quot;</span> &lt;&lt; Wmfb_pos &lt;&lt; <span class="stringliteral">&quot;) -&gt; &quot;</span> &lt;&lt; fb2index &lt;&lt; endl;</div>
<div class="line"><a name="l07519"></a><span class="lineno"> 7519</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0; ii&lt;13; ii++){ <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;p4_instance[&quot;</span> &lt;&lt; ii &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span>; <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj=0; jj&lt;4; jj++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; p4_current[ii][jj]/GeV &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>; <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl; }</div>
<div class="line"><a name="l07520"></a><span class="lineno"> 7520</span>&#160;                <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l07521"></a><span class="lineno"> 7521</span>&#160;              }</div>
<div class="line"><a name="l07522"></a><span class="lineno"> 7522</span>&#160;            } <span class="comment">// End loop over ifb2</span></div>
<div class="line"><a name="l07523"></a><span class="lineno"> 7523</span>&#160;          } <span class="comment">// End loop over if2</span></div>
<div class="line"><a name="l07524"></a><span class="lineno"> 7524</span>&#160;        } <span class="comment">// End loop over ib2</span></div>
<div class="line"><a name="l07525"></a><span class="lineno"> 7525</span>&#160;      } <span class="comment">// End loop over ifb1</span></div>
<div class="line"><a name="l07526"></a><span class="lineno"> 7526</span>&#160;    } <span class="comment">// End loop over if1</span></div>
<div class="line"><a name="l07527"></a><span class="lineno"> 7527</span>&#160;  } <span class="comment">// End loop over ib1</span></div>
<div class="line"><a name="l07528"></a><span class="lineno"> 7528</span>&#160;<span class="comment">  /***** END TTH ME CALCULATION *****/</span></div>
<div class="line"><a name="l07529"></a><span class="lineno"> 7529</span>&#160;  <span class="keywordtype">int</span> defaultTopDecay=-1;</div>
<div class="line"><a name="l07530"></a><span class="lineno"> 7530</span>&#160;  <a class="code" href="TModJHUGenMELA_8hh.html#a5ba6679a0f52b8b512295bc107e7bb24">__modjhugenmela_MOD_settopdecays</a>(&amp;defaultTopDecay); <span class="comment">// reset top decay</span></div>
<div class="line"><a name="l07531"></a><span class="lineno"> 7531</span>&#160; </div>
<div class="line"><a name="l07532"></a><span class="lineno"> 7532</span>&#160;  <span class="keywordtype">int</span> GeVexponent_MEsq;</div>
<div class="line"><a name="l07533"></a><span class="lineno"> 7533</span>&#160;  <span class="keywordflow">if</span> (topDecay&gt;0) GeVexponent_MEsq = 4-(1+3*(nRequested_Tops+nRequested_Antitops))*2;</div>
<div class="line"><a name="l07534"></a><span class="lineno"> 7534</span>&#160;  <span class="keywordflow">else</span> GeVexponent_MEsq = 4-(1+nRequested_Tops+nRequested_Antitops)*2;</div>
<div class="line"><a name="l07535"></a><span class="lineno"> 7535</span>&#160;  <span class="keywordtype">double</span> constant = pow(GeV, -GeVexponent_MEsq);</div>
<div class="line"><a name="l07536"></a><span class="lineno"> 7536</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0; ii&lt;<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>; ii++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj=0; jj&lt;<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>; jj++) MatElsq[jj][ii] *= constant; }</div>
<div class="line"><a name="l07537"></a><span class="lineno"> 7537</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07538"></a><span class="lineno"> 7538</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::TTHiggsMatEl: MEsq[ip][jp] = &quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l07539"></a><span class="lineno"> 7539</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l07540"></a><span class="lineno"> 7540</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; MatElsq[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l07541"></a><span class="lineno"> 7541</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l07542"></a><span class="lineno"> 7542</span>&#160;    }</div>
<div class="line"><a name="l07543"></a><span class="lineno"> 7543</span>&#160;  }</div>
<div class="line"><a name="l07544"></a><span class="lineno"> 7544</span>&#160;  sum_msqjk = <a class="code" href="namespaceTUtil.html#adf7b61bc902b23177090ce6b48a7f026">SumMEPDF</a>(MomStore[0], MomStore[1], MatElsq, RcdME, EBEAM, verbosity);</div>
<div class="line"><a name="l07545"></a><span class="lineno"> 7545</span>&#160; </div>
<div class="line"><a name="l07546"></a><span class="lineno"> 7546</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07547"></a><span class="lineno"> 7547</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l07548"></a><span class="lineno"> 7548</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::TTHiggsMatEl: Reset AlphaS:\n&quot;</span></div>
<div class="line"><a name="l07549"></a><span class="lineno"> 7549</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tBefore reset, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale &lt;&lt; endl;</div>
<div class="line"><a name="l07550"></a><span class="lineno"> 7550</span>&#160;  }</div>
<div class="line"><a name="l07551"></a><span class="lineno"> 7551</span>&#160;  <a class="code" href="namespaceTUtil.html#ab551562aaa197841cd0a638f1f38b0ff">SetAlphaS</a>(defaultRenScale, defaultFacScale, 1., 1., defaultNloop, defaultNflav, defaultPdflabel);</div>
<div class="line"><a name="l07552"></a><span class="lineno"> 7552</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07553"></a><span class="lineno"> 7553</span>&#160;    <a class="code" href="namespaceTUtil.html#a2f0fce2b3d66f17b673f2e75d87adf00">GetAlphaS</a>(&amp;alphasVal, &amp;alphasmzVal);</div>
<div class="line"><a name="l07554"></a><span class="lineno"> 7554</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l07555"></a><span class="lineno"> 7555</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::TTHiggsMatEl: Reset AlphaS result:\n&quot;</span></div>
<div class="line"><a name="l07556"></a><span class="lineno"> 7556</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tAfter reset, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale &lt;&lt; <span class="stringliteral">&quot;, alphas(Qren): &quot;</span> &lt;&lt; alphasVal &lt;&lt; <span class="stringliteral">&quot;, alphas(MZ): &quot;</span> &lt;&lt; alphasmzVal &lt;&lt; endl;</div>
<div class="line"><a name="l07557"></a><span class="lineno"> 7557</span>&#160;  }</div>
<div class="line"><a name="l07558"></a><span class="lineno"> 7558</span>&#160;  <span class="keywordflow">return</span> sum_msqjk;</div>
<div class="line"><a name="l07559"></a><span class="lineno"> 7559</span>&#160;}</div>
<div class="line"><a name="l07560"></a><span class="lineno"> 7560</span>&#160; </div>
<div class="line"><a name="l07561"></a><span class="lineno"> 7561</span>&#160;<span class="comment">// bbH, H undecayed</span></div>
<div class="line"><a name="l07562"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a4812281815c3cd3df59c9575878c76e6"> 7562</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceTUtil.html#a4812281815c3cd3df59c9575878c76e6">TUtil::BBHiggsMatEl</a>(</div>
<div class="line"><a name="l07563"></a><span class="lineno"> 7563</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1">TVar::Process</a>&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28c">TVar::Production</a>&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815f">TVar::MatrixElement</a>&amp; matrixElement,</div>
<div class="line"><a name="l07564"></a><span class="lineno"> 7564</span>&#160;  <a class="code" href="structTVar_1_1event__scales__type.html">event_scales_type</a>* event_scales, <a class="code" href="classMelaIO.html">MelaIO</a>* RcdME,</div>
<div class="line"><a name="l07565"></a><span class="lineno"> 7565</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; EBEAM,</div>
<div class="line"><a name="l07566"></a><span class="lineno"> 7566</span>&#160;  <span class="keywordtype">int</span> botProcess,</div>
<div class="line"><a name="l07567"></a><span class="lineno"> 7567</span>&#160;  <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049">TVar::VerbosityLevel</a> verbosity</div>
<div class="line"><a name="l07568"></a><span class="lineno"> 7568</span>&#160;  ){</div>
<div class="line"><a name="l07569"></a><span class="lineno"> 7569</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> GeV=1./100.; <span class="comment">// JHUGen mom. scale factor</span></div>
<div class="line"><a name="l07570"></a><span class="lineno"> 7570</span>&#160;  <span class="keywordtype">double</span> sum_msqjk = 0;</div>
<div class="line"><a name="l07571"></a><span class="lineno"> 7571</span>&#160;  <span class="keywordtype">double</span> MatElsq[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>][<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>]={ { 0 } };</div>
<div class="line"><a name="l07572"></a><span class="lineno"> 7572</span>&#160;  <span class="keywordtype">double</span> MatElsq_tmp[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>][<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>]={ { 0 } };</div>
<div class="line"><a name="l07573"></a><span class="lineno"> 7573</span>&#160; </div>
<div class="line"><a name="l07574"></a><span class="lineno"> 7574</span>&#160;  <span class="keywordflow">if</span> (matrixElement!=<a class="code" href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815faba6e6b23b0115bbaa919563a0626be03">TVar::JHUGen</a>){ <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::BBHiggsMatEl: Non-JHUGen MEs are not supported.&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> sum_msqjk; }</div>
<div class="line"><a name="l07575"></a><span class="lineno"> 7575</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>!=<a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca1ae680405479fddfedd3314339a47b01">TVar::bbH</a>){ <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::BBHiggsMatEl: Only bbH is supported.&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> sum_msqjk; }</div>
<div class="line"><a name="l07576"></a><span class="lineno"> 7576</span>&#160; </div>
<div class="line"><a name="l07577"></a><span class="lineno"> 7577</span>&#160;  <span class="keywordtype">int</span> partIncCode=<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba73861ec433a26ae79407bfe3f2f7b71a">TVar::kUseAssociated_Jets</a>; <span class="comment">// Look for jets</span></div>
<div class="line"><a name="l07578"></a><span class="lineno"> 7578</span>&#160;  <span class="keywordtype">int</span> nRequested_AssociatedJets=2;</div>
<div class="line"><a name="l07579"></a><span class="lineno"> 7579</span>&#160; </div>
<div class="line"><a name="l07580"></a><span class="lineno"> 7580</span>&#160;  <a class="code" href="structTVar_1_1simple__event__record.html">simple_event_record</a> mela_event;</div>
<div class="line"><a name="l07581"></a><span class="lineno"> 7581</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a743a8c341936dbaa10ce50a5b8d87eba">AssociationCode</a>=partIncCode;</div>
<div class="line"><a name="l07582"></a><span class="lineno"> 7582</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aca54cfc4690b7f0ba78f5af03d0f1ddf">nRequested_AssociatedJets</a>=nRequested_AssociatedJets;</div>
<div class="line"><a name="l07583"></a><span class="lineno"> 7583</span>&#160;  <a class="code" href="namespaceTUtil.html#a2bfa5115b0bf398c2fae3cc36aedf9f5">GetBoostedParticleVectors</a>(</div>
<div class="line"><a name="l07584"></a><span class="lineno"> 7584</span>&#160;    RcdME-&gt;<a class="code" href="classMelaIO.html#aebe453b6e0a6bf08d7aa68c1927ae48f">melaCand</a>,</div>
<div class="line"><a name="l07585"></a><span class="lineno"> 7585</span>&#160;    mela_event,</div>
<div class="line"><a name="l07586"></a><span class="lineno"> 7586</span>&#160;    verbosity</div>
<div class="line"><a name="l07587"></a><span class="lineno"> 7587</span>&#160;    );</div>
<div class="line"><a name="l07588"></a><span class="lineno"> 7588</span>&#160; </div>
<div class="line"><a name="l07589"></a><span class="lineno"> 7589</span>&#160;  <span class="keywordflow">if</span> (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.size()&lt;2){</div>
<div class="line"><a name="l07590"></a><span class="lineno"> 7590</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a></div>
<div class="line"><a name="l07591"></a><span class="lineno"> 7591</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::BBHiggsMatEl: Number of stable bs (&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.size() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l07592"></a><span class="lineno"> 7592</span>&#160;      &lt;&lt;<span class="stringliteral">&quot; in bbH process is not 2!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l07593"></a><span class="lineno"> 7593</span>&#160;    <span class="keywordflow">return</span> sum_msqjk;</div>
<div class="line"><a name="l07594"></a><span class="lineno"> 7594</span>&#160;  }</div>
<div class="line"><a name="l07595"></a><span class="lineno"> 7595</span>&#160; </div>
<div class="line"><a name="l07596"></a><span class="lineno"> 7596</span>&#160;  <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> topDaughters;</div>
<div class="line"><a name="l07597"></a><span class="lineno"> 7597</span>&#160;  <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> antitopDaughters;</div>
<div class="line"><a name="l07598"></a><span class="lineno"> 7598</span>&#160;  <span class="keywordtype">bool</span> isUnknown[2]; isUnknown[0]=<span class="keyword">false</span>; isUnknown[1]=<span class="keyword">false</span>;</div>
<div class="line"><a name="l07599"></a><span class="lineno"> 7599</span>&#160; </div>
<div class="line"><a name="l07600"></a><span class="lineno"> 7600</span>&#160;  <span class="keywordflow">if</span> (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.at(0).first&gt;=0){ topDaughters.push_back(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.at(0)); isUnknown[0]=(<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.at(0).first)); }</div>
<div class="line"><a name="l07601"></a><span class="lineno"> 7601</span>&#160;  <span class="keywordflow">else</span> antitopDaughters.push_back(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.at(0));</div>
<div class="line"><a name="l07602"></a><span class="lineno"> 7602</span>&#160;  <span class="keywordflow">if</span> (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.at(1).first&lt;=0){ antitopDaughters.push_back(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.at(1)); isUnknown[1]=(<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.at(1).first)); }</div>
<div class="line"><a name="l07603"></a><span class="lineno"> 7603</span>&#160;  <span class="keywordflow">else</span> topDaughters.push_back(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.at(1));</div>
<div class="line"><a name="l07604"></a><span class="lineno"> 7604</span>&#160; </div>
<div class="line"><a name="l07605"></a><span class="lineno"> 7605</span>&#160;  <span class="comment">// Start assigning the momenta</span></div>
<div class="line"><a name="l07606"></a><span class="lineno"> 7606</span>&#160;  <span class="comment">// 0,1: p1 p2</span></div>
<div class="line"><a name="l07607"></a><span class="lineno"> 7607</span>&#160;  <span class="comment">// 2-4: H,tb,t</span></div>
<div class="line"><a name="l07608"></a><span class="lineno"> 7608</span>&#160;  <span class="comment">// 5-8: bb,W-,f,fb</span></div>
<div class="line"><a name="l07609"></a><span class="lineno"> 7609</span>&#160;  <span class="comment">// 9-12: b,W+,fb,f</span></div>
<div class="line"><a name="l07610"></a><span class="lineno"> 7610</span>&#160;  <span class="keywordtype">double</span> p4[13][4]={ { 0 } };</div>
<div class="line"><a name="l07611"></a><span class="lineno"> 7611</span>&#160;  <span class="keywordtype">double</span> MYIDUP_prod[2]={ 0 };</div>
<div class="line"><a name="l07612"></a><span class="lineno"> 7612</span>&#160;  TLorentzVector MomStore[<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>];</div>
<div class="line"><a name="l07613"></a><span class="lineno"> 7613</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>; i++) MomStore[i].SetXYZT(0, 0, 0, 0);</div>
<div class="line"><a name="l07614"></a><span class="lineno"> 7614</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ipar=0; ipar&lt;2; ipar++){</div>
<div class="line"><a name="l07615"></a><span class="lineno"> 7615</span>&#160;    TLorentzVector* momTmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).second);</div>
<div class="line"><a name="l07616"></a><span class="lineno"> 7616</span>&#160;    <span class="keywordtype">int</span>* idtmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ipar).first);</div>
<div class="line"><a name="l07617"></a><span class="lineno"> 7617</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(*idtmp)) MYIDUP_prod[ipar] = *idtmp;</div>
<div class="line"><a name="l07618"></a><span class="lineno"> 7618</span>&#160;    <span class="keywordflow">else</span> MYIDUP_prod[ipar] = 0;</div>
<div class="line"><a name="l07619"></a><span class="lineno"> 7619</span>&#160;    <span class="keywordflow">if</span> (momTmp-&gt;T()&gt;0.){</div>
<div class="line"><a name="l07620"></a><span class="lineno"> 7620</span>&#160;      p4[ipar][0] = -momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l07621"></a><span class="lineno"> 7621</span>&#160;      p4[ipar][1] = -momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l07622"></a><span class="lineno"> 7622</span>&#160;      p4[ipar][2] = -momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l07623"></a><span class="lineno"> 7623</span>&#160;      p4[ipar][3] = -momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l07624"></a><span class="lineno"> 7624</span>&#160;      MomStore[ipar] = (*momTmp);</div>
<div class="line"><a name="l07625"></a><span class="lineno"> 7625</span>&#160;    }</div>
<div class="line"><a name="l07626"></a><span class="lineno"> 7626</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l07627"></a><span class="lineno"> 7627</span>&#160;      p4[ipar][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l07628"></a><span class="lineno"> 7628</span>&#160;      p4[ipar][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l07629"></a><span class="lineno"> 7629</span>&#160;      p4[ipar][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l07630"></a><span class="lineno"> 7630</span>&#160;      p4[ipar][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l07631"></a><span class="lineno"> 7631</span>&#160;      MomStore[ipar] = -(*momTmp);</div>
<div class="line"><a name="l07632"></a><span class="lineno"> 7632</span>&#160;      MYIDUP_prod[ipar] = -MYIDUP_prod[ipar];</div>
<div class="line"><a name="l07633"></a><span class="lineno"> 7633</span>&#160;    }</div>
<div class="line"><a name="l07634"></a><span class="lineno"> 7634</span>&#160;  }</div>
<div class="line"><a name="l07635"></a><span class="lineno"> 7635</span>&#160; </div>
<div class="line"><a name="l07636"></a><span class="lineno"> 7636</span>&#160;  <span class="comment">// Assign b momenta</span></div>
<div class="line"><a name="l07637"></a><span class="lineno"> 7637</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar=0; ipar&lt;topDaughters.size(); ipar++){</div>
<div class="line"><a name="l07638"></a><span class="lineno"> 7638</span>&#160;    TLorentzVector* momTmp = &amp;(topDaughters.at(ipar).second);</div>
<div class="line"><a name="l07639"></a><span class="lineno"> 7639</span>&#160;    p4[4][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l07640"></a><span class="lineno"> 7640</span>&#160;    p4[4][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l07641"></a><span class="lineno"> 7641</span>&#160;    p4[4][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l07642"></a><span class="lineno"> 7642</span>&#160;    p4[4][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l07643"></a><span class="lineno"> 7643</span>&#160;    MomStore[6] = MomStore[6] + (*momTmp); <span class="comment">// MomStore (I1, I2, 0, 0, 0, H, J1, J2)</span></div>
<div class="line"><a name="l07644"></a><span class="lineno"> 7644</span>&#160;  }</div>
<div class="line"><a name="l07645"></a><span class="lineno"> 7645</span>&#160; </div>
<div class="line"><a name="l07646"></a><span class="lineno"> 7646</span>&#160;  <span class="comment">// Assign bb momenta</span></div>
<div class="line"><a name="l07647"></a><span class="lineno"> 7647</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar=0; ipar&lt;antitopDaughters.size(); ipar++){</div>
<div class="line"><a name="l07648"></a><span class="lineno"> 7648</span>&#160;    TLorentzVector* momTmp = &amp;(antitopDaughters.at(ipar).second);</div>
<div class="line"><a name="l07649"></a><span class="lineno"> 7649</span>&#160;    p4[3][0] = momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l07650"></a><span class="lineno"> 7650</span>&#160;    p4[3][1] = momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l07651"></a><span class="lineno"> 7651</span>&#160;    p4[3][2] = momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l07652"></a><span class="lineno"> 7652</span>&#160;    p4[3][3] = momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l07653"></a><span class="lineno"> 7653</span>&#160;    MomStore[7] = MomStore[7] + (*momTmp); <span class="comment">// MomStore (I1, I2, 0, 0, 0, H, J1, J2)</span></div>
<div class="line"><a name="l07654"></a><span class="lineno"> 7654</span>&#160;  }</div>
<div class="line"><a name="l07655"></a><span class="lineno"> 7655</span>&#160; </div>
<div class="line"><a name="l07656"></a><span class="lineno"> 7656</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar=0; ipar&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size(); ipar++){</div>
<div class="line"><a name="l07657"></a><span class="lineno"> 7657</span>&#160;    TLorentzVector* momTmp = &amp;(mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.at(ipar).second);</div>
<div class="line"><a name="l07658"></a><span class="lineno"> 7658</span>&#160;    p4[2][0] += momTmp-&gt;T()*GeV;</div>
<div class="line"><a name="l07659"></a><span class="lineno"> 7659</span>&#160;    p4[2][1] += momTmp-&gt;X()*GeV;</div>
<div class="line"><a name="l07660"></a><span class="lineno"> 7660</span>&#160;    p4[2][2] += momTmp-&gt;Y()*GeV;</div>
<div class="line"><a name="l07661"></a><span class="lineno"> 7661</span>&#160;    p4[2][3] += momTmp-&gt;Z()*GeV;</div>
<div class="line"><a name="l07662"></a><span class="lineno"> 7662</span>&#160;    MomStore[5] = MomStore[5] + (*momTmp); <span class="comment">// i==(2, 3, 4) is (J1, J2, H), recorded as MomStore (I1, I2, 0, 0, 0, H, J1, J2)</span></div>
<div class="line"><a name="l07663"></a><span class="lineno"> 7663</span>&#160;  }</div>
<div class="line"><a name="l07664"></a><span class="lineno"> 7664</span>&#160; </div>
<div class="line"><a name="l07665"></a><span class="lineno"> 7665</span>&#160;  <span class="keywordflow">if</span> (verbosity &gt;= <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07666"></a><span class="lineno"> 7666</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0; ii&lt;13; ii++){ <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;p4[&quot;</span> &lt;&lt; ii &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span>; <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj=0; jj&lt;4; jj++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; p4[ii][jj]/GeV &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>; <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl; }</div>
<div class="line"><a name="l07667"></a><span class="lineno"> 7667</span>&#160;  }</div>
<div class="line"><a name="l07668"></a><span class="lineno"> 7668</span>&#160; </div>
<div class="line"><a name="l07669"></a><span class="lineno"> 7669</span>&#160;  <span class="keywordtype">double</span> defaultRenScale = <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale;</div>
<div class="line"><a name="l07670"></a><span class="lineno"> 7670</span>&#160;  <span class="keywordtype">double</span> defaultFacScale = <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale;</div>
<div class="line"><a name="l07671"></a><span class="lineno"> 7671</span>&#160;  <span class="comment">//MELAout &lt;&lt; &quot;Default scales: &quot; &lt;&lt; defaultRenScale &lt;&lt; &#39;\t&#39; &lt;&lt; defaultFacScale &lt;&lt; endl;</span></div>
<div class="line"><a name="l07672"></a><span class="lineno"> 7672</span>&#160;  <span class="keywordtype">int</span> defaultNloop = <a class="code" href="TMCFM_8hh.html#a819542dc6ff812e041d403592a6b8990">nlooprun_</a>.nlooprun;</div>
<div class="line"><a name="l07673"></a><span class="lineno"> 7673</span>&#160;  <span class="keywordtype">int</span> defaultNflav = <a class="code" href="TMCFM_8hh.html#a55930b5d389dfae39115156b2bc9a692">nflav_</a>.nflav;</div>
<div class="line"><a name="l07674"></a><span class="lineno"> 7674</span>&#160;  <span class="keywordtype">string</span> defaultPdflabel = <a class="code" href="TMCFM_8hh.html#a4ff35855efcab9061a55f428e228e7dd">pdlabel_</a>.pdlabel;</div>
<div class="line"><a name="l07675"></a><span class="lineno"> 7675</span>&#160;  <span class="keywordtype">double</span> renQ = <a class="code" href="namespaceTUtil.html#a4a00d03fa1abeb4335b6abd9fae90663">InterpretScaleScheme</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, matrixElement, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#aabb9b35b555961e98acc8855bc6c2159">renomalizationScheme</a>, MomStore);</div>
<div class="line"><a name="l07676"></a><span class="lineno"> 7676</span>&#160;  <span class="keywordtype">double</span> facQ = <a class="code" href="namespaceTUtil.html#a4a00d03fa1abeb4335b6abd9fae90663">InterpretScaleScheme</a>(<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, matrixElement, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a403e32d8e1aab756f9c2b3ff4863139f">factorizationScheme</a>, MomStore);</div>
<div class="line"><a name="l07677"></a><span class="lineno"> 7677</span>&#160;  <a class="code" href="namespaceTUtil.html#ab551562aaa197841cd0a638f1f38b0ff">SetAlphaS</a>(renQ, facQ, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a7fe18004bd29525d34dcd6cb2b42a5b8">ren_scale_factor</a>, event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a82661b3b8d040c36284a99bde2df79ce">fac_scale_factor</a>, 1, 5, <span class="stringliteral">&quot;cteq6_l&quot;</span>);</div>
<div class="line"><a name="l07678"></a><span class="lineno"> 7678</span>&#160;  <span class="keywordtype">double</span> alphasVal, alphasmzVal;</div>
<div class="line"><a name="l07679"></a><span class="lineno"> 7679</span>&#160;  <a class="code" href="namespaceTUtil.html#a2f0fce2b3d66f17b673f2e75d87adf00">GetAlphaS</a>(&amp;alphasVal, &amp;alphasmzVal);</div>
<div class="line"><a name="l07680"></a><span class="lineno"> 7680</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#ab63c4e79eba8f923423f2e97539ebeef">setRenormalizationScale</a>(renQ);</div>
<div class="line"><a name="l07681"></a><span class="lineno"> 7681</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a383d634378da53d000781f8376f31145">setFactorizationScale</a>(facQ);</div>
<div class="line"><a name="l07682"></a><span class="lineno"> 7682</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a47b8c8bb2137ecf3e3e1d1b873d3de0b">setAlphaS</a>(alphasVal);</div>
<div class="line"><a name="l07683"></a><span class="lineno"> 7683</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a8487223242ccff4de3677d673152c7f5">setAlphaSatMZ</a>(alphasmzVal);</div>
<div class="line"><a name="l07684"></a><span class="lineno"> 7684</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#aa20a0b91511fceb3584ad3a7d1ca210a">setHiggsMassWidth</a>(<a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hmass, <a class="code" href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a>.hwidth, 0);</div>
<div class="line"><a name="l07685"></a><span class="lineno"> 7685</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#aa20a0b91511fceb3584ad3a7d1ca210a">setHiggsMassWidth</a>(<a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.h2mass, <a class="code" href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a>.h2width, 1);</div>
<div class="line"><a name="l07686"></a><span class="lineno"> 7686</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07687"></a><span class="lineno"> 7687</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l07688"></a><span class="lineno"> 7688</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::BBHiggsMatEl: Set AlphaS:\n&quot;</span></div>
<div class="line"><a name="l07689"></a><span class="lineno"> 7689</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tBefore set, alphas scale: &quot;</span> &lt;&lt; defaultRenScale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; defaultFacScale &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l07690"></a><span class="lineno"> 7690</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\trenQ: &quot;</span> &lt;&lt; renQ &lt;&lt; <span class="stringliteral">&quot; ( x &quot;</span> &lt;&lt; event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a7fe18004bd29525d34dcd6cb2b42a5b8">ren_scale_factor</a> &lt;&lt; <span class="stringliteral">&quot;), facQ: &quot;</span> &lt;&lt; facQ &lt;&lt; <span class="stringliteral">&quot; ( x &quot;</span> &lt;&lt; event_scales-&gt;<a class="code" href="structTVar_1_1event__scales__type.html#a82661b3b8d040c36284a99bde2df79ce">fac_scale_factor</a> &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span></div>
<div class="line"><a name="l07691"></a><span class="lineno"> 7691</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tAfter set, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale &lt;&lt; <span class="stringliteral">&quot;, alphas(Qren): &quot;</span> &lt;&lt; alphasVal &lt;&lt; <span class="stringliteral">&quot;, alphas(MZ): &quot;</span> &lt;&lt; alphasmzVal &lt;&lt; endl;</div>
<div class="line"><a name="l07692"></a><span class="lineno"> 7692</span>&#160;  }</div>
<div class="line"><a name="l07693"></a><span class="lineno"> 7693</span>&#160; </div>
<div class="line"><a name="l07694"></a><span class="lineno"> 7694</span>&#160;  <a class="code" href="TModTTBHMatEl_8hh.html#aa11e2b7b8c645dddc5147f976d1d603b">__modttbhiggs_MOD_evalxsec_pp_bbbh</a>(p4, &amp;botProcess, MatElsq);</div>
<div class="line"><a name="l07695"></a><span class="lineno"> 7695</span>&#160;  <span class="keywordflow">if</span> (isUnknown[0] &amp;&amp; isUnknown[1]){</div>
<div class="line"><a name="l07696"></a><span class="lineno"> 7696</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix=0; ix&lt;4; ix++) swap(p4[3][ix], p4[4][ix]);</div>
<div class="line"><a name="l07697"></a><span class="lineno"> 7697</span>&#160;    <a class="code" href="TModTTBHMatEl_8hh.html#aa11e2b7b8c645dddc5147f976d1d603b">__modttbhiggs_MOD_evalxsec_pp_bbbh</a>(p4, &amp;botProcess, MatElsq_tmp);</div>
<div class="line"><a name="l07698"></a><span class="lineno"> 7698</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix=0; ix&lt;11; ix++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy=0; iy&lt;11; iy++) MatElsq[iy][ix] = (MatElsq[iy][ix]+MatElsq_tmp[iy][ix])/2.; }</div>
<div class="line"><a name="l07699"></a><span class="lineno"> 7699</span>&#160;  }</div>
<div class="line"><a name="l07700"></a><span class="lineno"> 7700</span>&#160; </div>
<div class="line"><a name="l07701"></a><span class="lineno"> 7701</span>&#160;  <span class="keywordtype">int</span> GeVexponent_MEsq = 4-(1+nRequested_AssociatedJets)*2;</div>
<div class="line"><a name="l07702"></a><span class="lineno"> 7702</span>&#160;  <span class="keywordtype">double</span> constant = pow(GeV, -GeVexponent_MEsq);</div>
<div class="line"><a name="l07703"></a><span class="lineno"> 7703</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0; ii&lt;<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>; ii++){ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj=0; jj&lt;<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>; jj++) MatElsq[jj][ii] *= constant; }</div>
<div class="line"><a name="l07704"></a><span class="lineno"> 7704</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07705"></a><span class="lineno"> 7705</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::BBHiggsMatEl: MEsq[ip][jp] = &quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l07706"></a><span class="lineno"> 7706</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l07707"></a><span class="lineno"> 7707</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; MatElsq[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l07708"></a><span class="lineno"> 7708</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l07709"></a><span class="lineno"> 7709</span>&#160;    }</div>
<div class="line"><a name="l07710"></a><span class="lineno"> 7710</span>&#160;  }</div>
<div class="line"><a name="l07711"></a><span class="lineno"> 7711</span>&#160;  sum_msqjk = <a class="code" href="namespaceTUtil.html#adf7b61bc902b23177090ce6b48a7f026">SumMEPDF</a>(MomStore[0], MomStore[1], MatElsq, RcdME, EBEAM, verbosity);</div>
<div class="line"><a name="l07712"></a><span class="lineno"> 7712</span>&#160; </div>
<div class="line"><a name="l07713"></a><span class="lineno"> 7713</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07714"></a><span class="lineno"> 7714</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l07715"></a><span class="lineno"> 7715</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::BBHiggsMatEl: Reset AlphaS:\n&quot;</span></div>
<div class="line"><a name="l07716"></a><span class="lineno"> 7716</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tBefore reset, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale &lt;&lt; endl;</div>
<div class="line"><a name="l07717"></a><span class="lineno"> 7717</span>&#160;  }</div>
<div class="line"><a name="l07718"></a><span class="lineno"> 7718</span>&#160;  <a class="code" href="namespaceTUtil.html#ab551562aaa197841cd0a638f1f38b0ff">SetAlphaS</a>(defaultRenScale, defaultFacScale, 1., 1., defaultNloop, defaultNflav, defaultPdflabel);</div>
<div class="line"><a name="l07719"></a><span class="lineno"> 7719</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07720"></a><span class="lineno"> 7720</span>&#160;    <a class="code" href="namespaceTUtil.html#a2f0fce2b3d66f17b673f2e75d87adf00">GetAlphaS</a>(&amp;alphasVal, &amp;alphasmzVal);</div>
<div class="line"><a name="l07721"></a><span class="lineno"> 7721</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l07722"></a><span class="lineno"> 7722</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;TUtil::BBHiggsMatEl: Reset AlphaS result:\n&quot;</span></div>
<div class="line"><a name="l07723"></a><span class="lineno"> 7723</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\tAfter reset, alphas scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a>.scale &lt;&lt; <span class="stringliteral">&quot;, PDF scale: &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a>.facscale &lt;&lt; <span class="stringliteral">&quot;, alphas(Qren): &quot;</span> &lt;&lt; alphasVal &lt;&lt; <span class="stringliteral">&quot;, alphas(MZ): &quot;</span> &lt;&lt; alphasmzVal &lt;&lt; endl;</div>
<div class="line"><a name="l07724"></a><span class="lineno"> 7724</span>&#160;  }</div>
<div class="line"><a name="l07725"></a><span class="lineno"> 7725</span>&#160;  <span class="keywordflow">return</span> sum_msqjk;</div>
<div class="line"><a name="l07726"></a><span class="lineno"> 7726</span>&#160;}</div>
<div class="line"><a name="l07727"></a><span class="lineno"> 7727</span>&#160; </div>
<div class="line"><a name="l07728"></a><span class="lineno"> 7728</span>&#160;<span class="comment">// Wipe MEs</span></div>
<div class="line"><a name="l07729"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a3e24aa1f4311876d507e30ff4162a1db"> 7729</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceTUtil.html#a3e24aa1f4311876d507e30ff4162a1db">TUtil::WipeMEArray</a>(<span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1">TVar::Process</a>&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a>, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28c">TVar::Production</a>&amp; <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span>[<a class="code" href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a>], <span class="keywordtype">double</span> <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>][<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>], <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049">TVar::VerbosityLevel</a>&amp; verbosity){</div>
<div class="line"><a name="l07730"></a><span class="lineno"> 7730</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07731"></a><span class="lineno"> 7731</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::WipeMEArray: Initial MEsq:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l07732"></a><span class="lineno"> 7732</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l07733"></a><span class="lineno"> 7733</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5] &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line"><a name="l07734"></a><span class="lineno"> 7734</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; endl;</div>
<div class="line"><a name="l07735"></a><span class="lineno"> 7735</span>&#160;    }</div>
<div class="line"><a name="l07736"></a><span class="lineno"> 7736</span>&#160;  }</div>
<div class="line"><a name="l07737"></a><span class="lineno"> 7737</span>&#160;  <span class="keywordtype">int</span> nInstances=0;</div>
<div class="line"><a name="l07738"></a><span class="lineno"> 7738</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l07739"></a><span class="lineno"> 7739</span>&#160;    (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a>)</div>
<div class="line"><a name="l07740"></a><span class="lineno"> 7740</span>&#160;    ||</div>
<div class="line"><a name="l07741"></a><span class="lineno"> 7741</span>&#160;    ((<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7f06d733c2cecc34c7fcd2b665ff8b79">TVar::ZZQQB_STU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3ae97ff9bcb97541f88b75dc6b28c2af">TVar::ZZQQB_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caa8167833dfafdcfe495089716e6c1e0b">TVar::ZZQQB_TU</a>) &amp;&amp; <a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a>)</div>
<div class="line"><a name="l07742"></a><span class="lineno"> 7742</span>&#160;    ){</div>
<div class="line"><a name="l07743"></a><span class="lineno"> 7743</span>&#160;    <span class="comment">// Sum over valid MEs without PDF weights</span></div>
<div class="line"><a name="l07744"></a><span class="lineno"> 7744</span>&#160;    <span class="comment">// By far the dominant contribution is uub initial state.</span></div>
<div class="line"><a name="l07745"></a><span class="lineno"> 7745</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l07746"></a><span class="lineno"> 7746</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++){</div>
<div class="line"><a name="l07747"></a><span class="lineno"> 7747</span>&#160;        <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l07748"></a><span class="lineno"> 7748</span>&#160;          (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[0]) || (<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(<span class="keywordtype">id</span>[0]) &amp;&amp; iquark==0) || iquark==<span class="keywordtype">id</span>[0])</div>
<div class="line"><a name="l07749"></a><span class="lineno"> 7749</span>&#160;          &amp;&amp;</div>
<div class="line"><a name="l07750"></a><span class="lineno"> 7750</span>&#160;          (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[1]) || (<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(<span class="keywordtype">id</span>[1]) &amp;&amp; jquark==0) || jquark==<span class="keywordtype">id</span>[1])</div>
<div class="line"><a name="l07751"></a><span class="lineno"> 7751</span>&#160;          ){</div>
<div class="line"><a name="l07752"></a><span class="lineno"> 7752</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]&gt;0.) nInstances++;</div>
<div class="line"><a name="l07753"></a><span class="lineno"> 7753</span>&#160;        }</div>
<div class="line"><a name="l07754"></a><span class="lineno"> 7754</span>&#160;        <span class="keywordflow">else</span> <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]=0; <span class="comment">// Kill the ME instance if mothers are known and their ids do not match the PDF indices.</span></div>
<div class="line"><a name="l07755"></a><span class="lineno"> 7755</span>&#160;      }</div>
<div class="line"><a name="l07756"></a><span class="lineno"> 7756</span>&#160;    }</div>
<div class="line"><a name="l07757"></a><span class="lineno"> 7757</span>&#160;  }</div>
<div class="line"><a name="l07758"></a><span class="lineno"> 7758</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4539519c2d018fd29228bdd605c76c47">TVar::ZZGG</a>){</div>
<div class="line"><a name="l07759"></a><span class="lineno"> 7759</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l07760"></a><span class="lineno"> 7760</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[0]) || <a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(<span class="keywordtype">id</span>[0]))</div>
<div class="line"><a name="l07761"></a><span class="lineno"> 7761</span>&#160;      &amp;&amp;</div>
<div class="line"><a name="l07762"></a><span class="lineno"> 7762</span>&#160;      (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[1]) || <a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(<span class="keywordtype">id</span>[1]))</div>
<div class="line"><a name="l07763"></a><span class="lineno"> 7763</span>&#160;      ){</div>
<div class="line"><a name="l07764"></a><span class="lineno"> 7764</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[5][5]&gt;0.) nInstances=1;</div>
<div class="line"><a name="l07765"></a><span class="lineno"> 7765</span>&#160;    }</div>
<div class="line"><a name="l07766"></a><span class="lineno"> 7766</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[5][5]=0; <span class="comment">// Kill the ME instance if mothers are known and their ids do not match to gluons.</span></div>
<div class="line"><a name="l07767"></a><span class="lineno"> 7767</span>&#160;  }</div>
<div class="line"><a name="l07768"></a><span class="lineno"> 7768</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l07769"></a><span class="lineno"> 7769</span>&#160;    <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a></div>
<div class="line"><a name="l07770"></a><span class="lineno"> 7770</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a></div>
<div class="line"><a name="l07771"></a><span class="lineno"> 7771</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a></div>
<div class="line"><a name="l07772"></a><span class="lineno"> 7772</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a></div>
<div class="line"><a name="l07773"></a><span class="lineno"> 7773</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a></div>
<div class="line"><a name="l07774"></a><span class="lineno"> 7774</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a></div>
<div class="line"><a name="l07775"></a><span class="lineno"> 7775</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca89a5439f5d7527b48dfb23d3042e8d29">TVar::JJEW</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca936aef1ef89c04b5586ccb862544363a">TVar::JJEWQCD</a></div>
<div class="line"><a name="l07776"></a><span class="lineno"> 7776</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca902db21776e8b4069184189a3d35976a">TVar::JJVBF_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca78112f139715de80da62332b06c94926">TVar::JJEW_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cada9ae823e21061c18721960aadabee2c">TVar::JJEWQCD_S</a></div>
<div class="line"><a name="l07777"></a><span class="lineno"> 7777</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca100a3d28b2ee4efd9227a4068543848f">TVar::JJVBF_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caf04b7e8e4c0900b0206ceaa88dc50271">TVar::JJEW_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4c10b0b90ea432d42a32a4ac8a099a1b">TVar::JJEWQCD_TU</a></div>
<div class="line"><a name="l07778"></a><span class="lineno"> 7778</span>&#160;    || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac09ee14d8ad516b27397f28eee642c62">TVar::JJQCD_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca832b9995c64912826d4e5f60e86f35ed">TVar::JJQCD_TU</a></div>
<div class="line"><a name="l07779"></a><span class="lineno"> 7779</span>&#160;    ){</div>
<div class="line"><a name="l07780"></a><span class="lineno"> 7780</span>&#160;    <span class="comment">// Z+2 jets</span></div>
<div class="line"><a name="l07781"></a><span class="lineno"> 7781</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">process</a> == <a class="code" href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad2933b84082d269af9a836d4646aeefd">TVar::bkgZJets</a>){</div>
<div class="line"><a name="l07782"></a><span class="lineno"> 7782</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l07783"></a><span class="lineno"> 7783</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++){</div>
<div class="line"><a name="l07784"></a><span class="lineno"> 7784</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l07785"></a><span class="lineno"> 7785</span>&#160;            (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[0]) || (<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(<span class="keywordtype">id</span>[0]) &amp;&amp; iquark==0) || iquark==<span class="keywordtype">id</span>[0])</div>
<div class="line"><a name="l07786"></a><span class="lineno"> 7786</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l07787"></a><span class="lineno"> 7787</span>&#160;            (<a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[1]) || (<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(<span class="keywordtype">id</span>[1]) &amp;&amp; jquark==0) || jquark==<span class="keywordtype">id</span>[1])</div>
<div class="line"><a name="l07788"></a><span class="lineno"> 7788</span>&#160;            ){</div>
<div class="line"><a name="l07789"></a><span class="lineno"> 7789</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]&gt;0.) nInstances++;</div>
<div class="line"><a name="l07790"></a><span class="lineno"> 7790</span>&#160;          }</div>
<div class="line"><a name="l07791"></a><span class="lineno"> 7791</span>&#160;          <span class="keywordflow">else</span> <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]=0; <span class="comment">// Kill the ME instance if mothers are known and their ids do not match the PDF indices.</span></div>
<div class="line"><a name="l07792"></a><span class="lineno"> 7792</span>&#160;        }</div>
<div class="line"><a name="l07793"></a><span class="lineno"> 7793</span>&#160;      }</div>
<div class="line"><a name="l07794"></a><span class="lineno"> 7794</span>&#160;    }</div>
<div class="line"><a name="l07795"></a><span class="lineno"> 7795</span>&#160;    <span class="comment">// VBF or QCD MCFM SBI, S or B</span></div>
<div class="line"><a name="l07796"></a><span class="lineno"> 7796</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l07797"></a><span class="lineno"> 7797</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iquark=-5; iquark&lt;=5; iquark++){</div>
<div class="line"><a name="l07798"></a><span class="lineno"> 7798</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jquark=-5; jquark&lt;=5; jquark++){</div>
<div class="line"><a name="l07799"></a><span class="lineno"> 7799</span>&#160;          <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l07800"></a><span class="lineno"> 7800</span>&#160;            (</div>
<div class="line"><a name="l07801"></a><span class="lineno"> 7801</span>&#160;            <a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[0]) || (<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(<span class="keywordtype">id</span>[0]) &amp;&amp; iquark==0) || iquark==<span class="keywordtype">id</span>[0]</div>
<div class="line"><a name="l07802"></a><span class="lineno"> 7802</span>&#160;            )</div>
<div class="line"><a name="l07803"></a><span class="lineno"> 7803</span>&#160;            &amp;&amp;</div>
<div class="line"><a name="l07804"></a><span class="lineno"> 7804</span>&#160;            (</div>
<div class="line"><a name="l07805"></a><span class="lineno"> 7805</span>&#160;            <a class="code" href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a>(<span class="keywordtype">id</span>[1]) || (<a class="code" href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a>(<span class="keywordtype">id</span>[1]) &amp;&amp; jquark==0) || jquark==<span class="keywordtype">id</span>[1]</div>
<div class="line"><a name="l07806"></a><span class="lineno"> 7806</span>&#160;            )</div>
<div class="line"><a name="l07807"></a><span class="lineno"> 7807</span>&#160;            ){</div>
<div class="line"><a name="l07808"></a><span class="lineno"> 7808</span>&#160;            <span class="comment">// Kill all non-VH initial parton states</span></div>
<div class="line"><a name="l07809"></a><span class="lineno"> 7809</span>&#160;            <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l07810"></a><span class="lineno"> 7810</span>&#160;              (</div>
<div class="line"><a name="l07811"></a><span class="lineno"> 7811</span>&#160;              (</div>
<div class="line"><a name="l07812"></a><span class="lineno"> 7812</span>&#160;              <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a></div>
<div class="line"><a name="l07813"></a><span class="lineno"> 7813</span>&#160;              || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a></div>
<div class="line"><a name="l07814"></a><span class="lineno"> 7814</span>&#160;              || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a></div>
<div class="line"><a name="l07815"></a><span class="lineno"> 7815</span>&#160;              )</div>
<div class="line"><a name="l07816"></a><span class="lineno"> 7816</span>&#160;              &amp;&amp;</div>
<div class="line"><a name="l07817"></a><span class="lineno"> 7817</span>&#160;              (</div>
<div class="line"><a name="l07818"></a><span class="lineno"> 7818</span>&#160;              (TMath::Sign(1, iquark)==TMath::Sign(1, jquark))</div>
<div class="line"><a name="l07819"></a><span class="lineno"> 7819</span>&#160;              ||</div>
<div class="line"><a name="l07820"></a><span class="lineno"> 7820</span>&#160;              (<a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(iquark) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a>(jquark))</div>
<div class="line"><a name="l07821"></a><span class="lineno"> 7821</span>&#160;              ||</div>
<div class="line"><a name="l07822"></a><span class="lineno"> 7822</span>&#160;              (<a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(iquark) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a>(jquark))</div>
<div class="line"><a name="l07823"></a><span class="lineno"> 7823</span>&#160;              )</div>
<div class="line"><a name="l07824"></a><span class="lineno"> 7824</span>&#160;              )</div>
<div class="line"><a name="l07825"></a><span class="lineno"> 7825</span>&#160;              ||</div>
<div class="line"><a name="l07826"></a><span class="lineno"> 7826</span>&#160;              (</div>
<div class="line"><a name="l07827"></a><span class="lineno"> 7827</span>&#160;              (</div>
<div class="line"><a name="l07828"></a><span class="lineno"> 7828</span>&#160;              <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a></div>
<div class="line"><a name="l07829"></a><span class="lineno"> 7829</span>&#160;              || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a></div>
<div class="line"><a name="l07830"></a><span class="lineno"> 7830</span>&#160;              || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a> || <a class="code" href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">production</a> == <a class="code" href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a></div>
<div class="line"><a name="l07831"></a><span class="lineno"> 7831</span>&#160;              )</div>
<div class="line"><a name="l07832"></a><span class="lineno"> 7832</span>&#160;              &amp;&amp;</div>
<div class="line"><a name="l07833"></a><span class="lineno"> 7833</span>&#160;              (iquark!=-jquark)</div>
<div class="line"><a name="l07834"></a><span class="lineno"> 7834</span>&#160;              )</div>
<div class="line"><a name="l07835"></a><span class="lineno"> 7835</span>&#160;              ) <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]=0;</div>
<div class="line"><a name="l07836"></a><span class="lineno"> 7836</span>&#160; </div>
<div class="line"><a name="l07837"></a><span class="lineno"> 7837</span>&#160;            <span class="comment">// Check against a hash</span></div>
<div class="line"><a name="l07838"></a><span class="lineno"> 7838</span>&#160;            <span class="keywordtype">int</span> order[2]={ -1, -1 };</div>
<div class="line"><a name="l07839"></a><span class="lineno"> 7839</span>&#160;            <a class="code" href="namespaceTMCFMUtils.html#aef81a55fd97ffadcaabc57015b59e4ee">TMCFMUtils::AssociatedParticleOrdering_QQVVQQAny</a>(iquark, jquark, <span class="keywordtype">id</span>[6], <span class="keywordtype">id</span>[7], order);</div>
<div class="line"><a name="l07840"></a><span class="lineno"> 7840</span>&#160;            <span class="keywordflow">if</span> (order[0]&lt;0 || order[1]&lt;0) <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]=0;</div>
<div class="line"><a name="l07841"></a><span class="lineno"> 7841</span>&#160; </div>
<div class="line"><a name="l07842"></a><span class="lineno"> 7842</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]&gt;0.) nInstances++;</div>
<div class="line"><a name="l07843"></a><span class="lineno"> 7843</span>&#160;          }</div>
<div class="line"><a name="l07844"></a><span class="lineno"> 7844</span>&#160;          <span class="keywordflow">else</span> <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[jquark+5][iquark+5]=0; <span class="comment">// Kill the ME instance if mothers are known and their ids do not match the PDF indices.</span></div>
<div class="line"><a name="l07845"></a><span class="lineno"> 7845</span>&#160;        }</div>
<div class="line"><a name="l07846"></a><span class="lineno"> 7846</span>&#160;      }</div>
<div class="line"><a name="l07847"></a><span class="lineno"> 7847</span>&#160;    }</div>
<div class="line"><a name="l07848"></a><span class="lineno"> 7848</span>&#160;  }</div>
<div class="line"><a name="l07849"></a><span class="lineno"> 7849</span>&#160;  <span class="keywordflow">return</span> nInstances;</div>
<div class="line"><a name="l07850"></a><span class="lineno"> 7850</span>&#160;}</div>
<div class="line"><a name="l07851"></a><span class="lineno"> 7851</span>&#160;<span class="comment">// CheckPartonMomFraction computes xx[0:1] based on p0, p1</span></div>
<div class="line"><a name="l07852"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#af6d616d949d1a340c25d2ed39edd5ddd"> 7852</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceTUtil.html#af6d616d949d1a340c25d2ed39edd5ddd">TUtil::CheckPartonMomFraction</a>(<span class="keyword">const</span> TLorentzVector&amp; p0, <span class="keyword">const</span> TLorentzVector&amp; p1, <span class="keywordtype">double</span> xx[2], <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; EBEAM, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049">TVar::VerbosityLevel</a>&amp; verbosity){</div>
<div class="line"><a name="l07853"></a><span class="lineno"> 7853</span>&#160;  <span class="comment">//Make sure parton Level Energy fraction is [0,1]</span></div>
<div class="line"><a name="l07854"></a><span class="lineno"> 7854</span>&#160;  <span class="comment">//phase space function already makes sure the parton energy fraction between [min,1]</span></div>
<div class="line"><a name="l07855"></a><span class="lineno"> 7855</span>&#160;  xx[0]=p0.P()/EBEAM;</div>
<div class="line"><a name="l07856"></a><span class="lineno"> 7856</span>&#160;  xx[1]=p1.P()/EBEAM;</div>
<div class="line"><a name="l07857"></a><span class="lineno"> 7857</span>&#160;  <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l07858"></a><span class="lineno"> 7858</span>&#160;    xx[0]&gt;1. || xx[0]&lt;=<a class="code" href="TMCFM_8hh.html#a59a4f7792e48fb024a873510ce50e04d">xmin_</a>.xmin</div>
<div class="line"><a name="l07859"></a><span class="lineno"> 7859</span>&#160;    ||</div>
<div class="line"><a name="l07860"></a><span class="lineno"> 7860</span>&#160;    xx[1]&gt;1. || xx[1]&lt;=<a class="code" href="TMCFM_8hh.html#a59a4f7792e48fb024a873510ce50e04d">xmin_</a>.xmin</div>
<div class="line"><a name="l07861"></a><span class="lineno"> 7861</span>&#160;    ||</div>
<div class="line"><a name="l07862"></a><span class="lineno"> 7862</span>&#160;    EBEAM&lt;=0.</div>
<div class="line"><a name="l07863"></a><span class="lineno"> 7863</span>&#160;    ){</div>
<div class="line"><a name="l07864"></a><span class="lineno"> 7864</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a>){</div>
<div class="line"><a name="l07865"></a><span class="lineno"> 7865</span>&#160;      <span class="keywordflow">if</span> (xx[0]&gt;1. || xx[1]&gt;1.) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::CheckPartonMomFraction: At least one of the parton momentum fractions is greater than 1.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l07866"></a><span class="lineno"> 7866</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (xx[0]&lt;=<a class="code" href="TMCFM_8hh.html#a59a4f7792e48fb024a873510ce50e04d">xmin_</a>.xmin || xx[1]&lt;=<a class="code" href="TMCFM_8hh.html#a59a4f7792e48fb024a873510ce50e04d">xmin_</a>.xmin) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::CheckPartonMomFraction: At least one of the parton momentum fractions is less than or equal to &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a59a4f7792e48fb024a873510ce50e04d">xmin_</a>.xmin &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l07867"></a><span class="lineno"> 7867</span>&#160;      <span class="keywordflow">else</span> <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::CheckPartonMomFraction: EBEAM=&quot;</span> &lt;&lt; EBEAM &lt;&lt; <span class="stringliteral">&quot;&lt;=0.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l07868"></a><span class="lineno"> 7868</span>&#160;    }</div>
<div class="line"><a name="l07869"></a><span class="lineno"> 7869</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l07870"></a><span class="lineno"> 7870</span>&#160;  }</div>
<div class="line"><a name="l07871"></a><span class="lineno"> 7871</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l07872"></a><span class="lineno"> 7872</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::CheckPartonMomFraction: xx[0]: &quot;</span> &lt;&lt; xx[0] &lt;&lt; <span class="stringliteral">&quot;, xx[1] = &quot;</span> &lt;&lt; xx[1] &lt;&lt; <span class="stringliteral">&quot;, xmin = &quot;</span> &lt;&lt; <a class="code" href="TMCFM_8hh.html#a59a4f7792e48fb024a873510ce50e04d">xmin_</a>.xmin &lt;&lt; endl;</div>
<div class="line"><a name="l07873"></a><span class="lineno"> 7873</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l07874"></a><span class="lineno"> 7874</span>&#160;  }</div>
<div class="line"><a name="l07875"></a><span class="lineno"> 7875</span>&#160;}</div>
<div class="line"><a name="l07876"></a><span class="lineno"> 7876</span>&#160;<span class="comment">// ComputePDF does the PDF computation</span></div>
<div class="line"><a name="l07877"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a90b6428b41acb4a3ca30d2307d1de436"> 7877</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a90b6428b41acb4a3ca30d2307d1de436">TUtil::ComputePDF</a>(<span class="keyword">const</span> TLorentzVector&amp; p0, <span class="keyword">const</span> TLorentzVector&amp; p1, <span class="keywordtype">double</span> fx1[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>], <span class="keywordtype">double</span> fx2[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>], <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; EBEAM, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049">TVar::VerbosityLevel</a>&amp; verbosity){</div>
<div class="line"><a name="l07878"></a><span class="lineno"> 7878</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Begin TUtil::ComputePDF&quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l07879"></a><span class="lineno"> 7879</span>&#160;  <span class="keywordtype">double</span> xx[2]={ 0 };</div>
<div class="line"><a name="l07880"></a><span class="lineno"> 7880</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceTUtil.html#af6d616d949d1a340c25d2ed39edd5ddd">CheckPartonMomFraction</a>(p0, p1, xx, EBEAM, verbosity)){</div>
<div class="line"><a name="l07882"></a><span class="lineno"> 7882</span>&#160;    <span class="keywordtype">double</span> fx1x2_jhu[2][13]={ { 0 } };</div>
<div class="line"><a name="l07883"></a><span class="lineno"> 7883</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::ComputePDF: Calling setpdfs with xx[0]: &quot;</span> &lt;&lt; xx[0] &lt;&lt; <span class="stringliteral">&quot;, xx[1] = &quot;</span> &lt;&lt; xx[1] &lt;&lt; endl;</div>
<div class="line"><a name="l07884"></a><span class="lineno"> 7884</span>&#160;    <a class="code" href="TModKinematics_8hh.html#a4866c0f1b950b078bcd08db14c1faff7">__modkinematics_MOD_setpdfs</a>(&amp;(xx[0]), &amp;(xx[1]), fx1x2_jhu);</div>
<div class="line"><a name="l07885"></a><span class="lineno"> 7885</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::ComputePDF: called&quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l07886"></a><span class="lineno"> 7886</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=-6; ip&lt;=6; ip++){</div>
<div class="line"><a name="l07887"></a><span class="lineno"> 7887</span>&#160;      <span class="comment">// JHUGen assignment is in JHU id coventions (up &lt;-&gt; down, g==g)</span></div>
<div class="line"><a name="l07888"></a><span class="lineno"> 7888</span>&#160;      <span class="keywordtype">int</span> fac=0;</div>
<div class="line"><a name="l07889"></a><span class="lineno"> 7889</span>&#160;      <span class="keywordflow">if</span> (ip!=0 &amp;&amp; (abs(ip)%2==0)) fac=-1;</div>
<div class="line"><a name="l07890"></a><span class="lineno"> 7890</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ip!=0) fac=+1;</div>
<div class="line"><a name="l07891"></a><span class="lineno"> 7891</span>&#160;      <span class="keywordflow">if</span> (ip&lt;0) fac=-fac;</div>
<div class="line"><a name="l07892"></a><span class="lineno"> 7892</span>&#160;      <span class="keywordtype">int</span> jp=ip+fac;</div>
<div class="line"><a name="l07893"></a><span class="lineno"> 7893</span>&#160;      fx1[jp+5]=fx1x2_jhu[0][ip+6];</div>
<div class="line"><a name="l07894"></a><span class="lineno"> 7894</span>&#160;      fx2[jp+5]=fx1x2_jhu[1][ip+6];</div>
<div class="line"><a name="l07895"></a><span class="lineno"> 7895</span>&#160;    }</div>
<div class="line"><a name="l07896"></a><span class="lineno"> 7896</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l07898"></a><span class="lineno"> 7898</span>&#160;<span class="comment">    //Calculate Pdf</span></div>
<div class="line"><a name="l07899"></a><span class="lineno"> 7899</span>&#160;<span class="comment">    //Parton Density Function is always evalualted at pT=0 frame</span></div>
<div class="line"><a name="l07900"></a><span class="lineno"> 7900</span>&#160;<span class="comment">    //Always pass address through fortran function</span></div>
<div class="line"><a name="l07901"></a><span class="lineno"> 7901</span>&#160;<span class="comment">    fdist_(&amp;density_.ih1, &amp;xx[0], &amp;facscale_.facscale, fx1);</span></div>
<div class="line"><a name="l07902"></a><span class="lineno"> 7902</span>&#160;<span class="comment">    fdist_(&amp;density_.ih2, &amp;xx[1], &amp;facscale_.facscale, fx2);</span></div>
<div class="line"><a name="l07903"></a><span class="lineno"> 7903</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l07904"></a><span class="lineno"> 7904</span>&#160;  }</div>
<div class="line"><a name="l07905"></a><span class="lineno"> 7905</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l07906"></a><span class="lineno"> 7906</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;End TUtil::ComputePDF:&quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l07907"></a><span class="lineno"> 7907</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=-<a class="code" href="TMCFM_8hh.html#aba01db17f4a2bfbc3db60dc172972a25a9ef27f05549f71d70319d03789242cea">nf</a>; ip&lt;=<a class="code" href="TMCFM_8hh.html#aba01db17f4a2bfbc3db60dc172972a25a9ef27f05549f71d70319d03789242cea">nf</a>; ip++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;(fx1, fx2)[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;] = (&quot;</span> &lt;&lt; fx1[ip+5] &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; fx2[ip+5] &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l07908"></a><span class="lineno"> 7908</span>&#160;  }</div>
<div class="line"><a name="l07909"></a><span class="lineno"> 7909</span>&#160;}</div>
<div class="line"><a name="l07910"></a><span class="lineno"> 7910</span>&#160;<span class="comment">// SumMEPDF sums over all production parton flavors according to PDF and calls ComputePDF</span></div>
<div class="line"><a name="l07911"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#adf7b61bc902b23177090ce6b48a7f026"> 7911</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceTUtil.html#adf7b61bc902b23177090ce6b48a7f026">TUtil::SumMEPDF</a>(<span class="keyword">const</span> TLorentzVector&amp; p0, <span class="keyword">const</span> TLorentzVector&amp; p1, <span class="keywordtype">double</span> <a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>][<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>], <a class="code" href="classMelaIO.html">MelaIO</a>* RcdME, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; EBEAM, <span class="keyword">const</span> <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049">TVar::VerbosityLevel</a>&amp; verbosity){</div>
<div class="line"><a name="l07912"></a><span class="lineno"> 7912</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Begin TUtil::SumMEPDF&quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l07913"></a><span class="lineno"> 7913</span>&#160;  <span class="keywordtype">double</span> fx1[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>]={ 0 };</div>
<div class="line"><a name="l07914"></a><span class="lineno"> 7914</span>&#160;  <span class="keywordtype">double</span> fx2[<a class="code" href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a>]={ 0 };</div>
<div class="line"><a name="l07915"></a><span class="lineno"> 7915</span>&#160;  <span class="comment">//double wgt_msq[nmsq][nmsq]={ { 0 } };</span></div>
<div class="line"><a name="l07916"></a><span class="lineno"> 7916</span>&#160; </div>
<div class="line"><a name="l07917"></a><span class="lineno"> 7917</span>&#160;  <a class="code" href="namespaceTUtil.html#a90b6428b41acb4a3ca30d2307d1de436">ComputePDF</a>(p0, p1, fx1, fx2, EBEAM, verbosity);</div>
<div class="line"><a name="l07918"></a><span class="lineno"> 7918</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::SumMEPDF: Setting RcdME&quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l07919"></a><span class="lineno"> 7919</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#a98676a9ef8bf3590b6f70a523dae212c">setPartonWeights</a>(fx1, fx2);</div>
<div class="line"><a name="l07920"></a><span class="lineno"> 7920</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#abe83c33dd9da5a5ae0eb622177a5bb5e">setMEArray</a>(<a class="code" href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">msq</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l07921"></a><span class="lineno"> 7921</span>&#160;  RcdME-&gt;<a class="code" href="classMelaIO.html#afb45877052ee8742c8599476a6ef2a14">computeWeightedMEArray</a>();</div>
<div class="line"><a name="l07922"></a><span class="lineno"> 7922</span>&#160;  <span class="comment">//RcdME-&gt;getWeightedMEArray(wgt_msq);</span></div>
<div class="line"><a name="l07923"></a><span class="lineno"> 7923</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;End TUtil::SumMEPDF&quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l07924"></a><span class="lineno"> 7924</span>&#160;  <span class="keywordflow">return</span> RcdME-&gt;<a class="code" href="classMelaIO.html#a49449bc12b427fa2abd96a33e53ac274">getSumME</a>();</div>
<div class="line"><a name="l07925"></a><span class="lineno"> 7925</span>&#160;}</div>
<div class="line"><a name="l07926"></a><span class="lineno"> 7926</span>&#160; </div>
<div class="line"><a name="l07927"></a><span class="lineno"> 7927</span>&#160; </div>
<div class="line"><a name="l07928"></a><span class="lineno"> 7928</span>&#160;<span class="comment">// Propagator reweighting</span></div>
<div class="line"><a name="l07929"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a7ed7b2d062c0a1fbb809e065e6752cce"> 7929</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespaceTUtil.html#a7ed7b2d062c0a1fbb809e065e6752cce">TUtil::ResonancePropagator</a>(<span class="keywordtype">double</span> <span class="keyword">const</span>&amp; <a class="code" href="TMCFM_8hh.html#abf7be34aa9d044bc74b481967e5e1245">sqrts</a>, <a class="code" href="namespaceTVar.html#ac79830020a0eed4f6dcd3a62a496b016">TVar::ResonancePropagatorScheme</a> scheme){</div>
<div class="line"><a name="l07930"></a><span class="lineno"> 7930</span>&#160;  <a class="code" href="TModJHUGenMELA_8hh.html#a44ca02e7e9531918e7b76e9e6cafb254">__modjhugenmela_MOD_resetmubarhgabarh</a>();</div>
<div class="line"><a name="l07931"></a><span class="lineno"> 7931</span>&#160; </div>
<div class="line"><a name="l07932"></a><span class="lineno"> 7932</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> GeV=1./100.; <span class="comment">// JHUGen mom. scale factor</span></div>
<div class="line"><a name="l07933"></a><span class="lineno"> 7933</span>&#160;  <span class="keywordtype">int</span> isch=(<a class="code" href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">int</a>)scheme;</div>
<div class="line"><a name="l07934"></a><span class="lineno"> 7934</span>&#160;  <span class="keywordtype">double</span> shat_jhu = pow(<a class="code" href="TMCFM_8hh.html#abf7be34aa9d044bc74b481967e5e1245">sqrts</a>*GeV, 2);</div>
<div class="line"><a name="l07935"></a><span class="lineno"> 7935</span>&#160;  <span class="keywordtype">double</span> prop = <a class="code" href="TModKinematics_8hh.html#a73f3e00258b646b5d30697ce71d76af3">__modkinematics_MOD_getbwpropagator</a>(&amp;shat_jhu, &amp;isch);</div>
<div class="line"><a name="l07936"></a><span class="lineno"> 7936</span>&#160;  <span class="keywordflow">if</span> (scheme!=<a class="code" href="namespaceTVar.html#ac79830020a0eed4f6dcd3a62a496b016a0730f7b0d30d7559cef4f727cd4533e1">TVar::NoPropagator</a>) prop *= pow(GeV, 4);</div>
<div class="line"><a name="l07937"></a><span class="lineno"> 7937</span>&#160;  <span class="keywordflow">return</span> prop;</div>
<div class="line"><a name="l07938"></a><span class="lineno"> 7938</span>&#160;}</div>
<div class="line"><a name="l07939"></a><span class="lineno"> 7939</span>&#160; </div>
<div class="line"><a name="l07940"></a><span class="lineno"> 7940</span>&#160; </div>
<div class="line"><a name="l07941"></a><span class="lineno"> 7941</span>&#160;<span class="comment">// GetBoostedParticleVectors decomposes the MELACandidate object melaCand into mothers, daughters, associateds and tops</span></div>
<div class="line"><a name="l07942"></a><span class="lineno"> 7942</span>&#160;<span class="comment">// and boosts them to the pT=0 frame for the particular mela_event.AssociationCode, which is a product of TVar::kUseAssociated* (prime numbers).</span></div>
<div class="line"><a name="l07943"></a><span class="lineno"> 7943</span>&#160;<span class="comment">// If no mothers are present, it assigns mothers as Z&gt;0, Z&lt;0. If they are present, it orders them as &quot;incoming&quot; q-qbar / g-qbar / q-g / g-g</span></div>
<div class="line"><a name="l07944"></a><span class="lineno"> 7944</span>&#160;<span class="comment">// Associated particles passed are different based on the code. If code==1, no associated particles are passed.</span></div>
<div class="line"><a name="l07945"></a><span class="lineno"> 7945</span>&#160;<span class="comment">// mela_event.intermediateVids are needed to keep track of the decay mode. TVar::Process or TVar::Production do not keep track of the V/f decay modes.</span></div>
<div class="line"><a name="l07946"></a><span class="lineno"> 7946</span>&#160;<span class="comment">// This is the major replacement functionality of the TVar lepton flavors.</span></div>
<div class="line"><a name="l07947"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a2bfa5115b0bf398c2fae3cc36aedf9f5"> 7947</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a2bfa5115b0bf398c2fae3cc36aedf9f5">TUtil::GetBoostedParticleVectors</a>(</div>
<div class="line"><a name="l07948"></a><span class="lineno"> 7948</span>&#160;  <a class="code" href="classMELACandidate.html">MELACandidate</a>* melaCand,</div>
<div class="line"><a name="l07949"></a><span class="lineno"> 7949</span>&#160;  <a class="code" href="structTVar_1_1simple__event__record.html">simple_event_record</a>&amp; mela_event,</div>
<div class="line"><a name="l07950"></a><span class="lineno"> 7950</span>&#160;  <a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049">TVar::VerbosityLevel</a> verbosity</div>
<div class="line"><a name="l07951"></a><span class="lineno"> 7951</span>&#160;  ){</div>
<div class="line"><a name="l07952"></a><span class="lineno"> 7952</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Begin GetBoostedParticleVectors&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l07953"></a><span class="lineno"> 7953</span>&#160;  <span class="comment">// This is the beginning of one long function.</span></div>
<div class="line"><a name="l07954"></a><span class="lineno"> 7954</span>&#160; </div>
<div class="line"><a name="l07955"></a><span class="lineno"> 7955</span>&#160;  <span class="keywordtype">int</span> <span class="keyword">const</span>&amp; code = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a743a8c341936dbaa10ce50a5b8d87eba">AssociationCode</a>;</div>
<div class="line"><a name="l07956"></a><span class="lineno"> 7956</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: code=&quot;</span> &lt;&lt; code &lt;&lt; endl;</div>
<div class="line"><a name="l07957"></a><span class="lineno"> 7957</span>&#160;  <span class="keywordtype">int</span> <span class="keyword">const</span>&amp; aVhypo = mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a210cc509a3d155a23d69c94ea4558f87">AssociationVCompatibility</a>;</div>
<div class="line"><a name="l07958"></a><span class="lineno"> 7958</span>&#160;  TLorentzVector <span class="keyword">const</span> nullFourVector(0, 0, 0, 0);</div>
<div class="line"><a name="l07959"></a><span class="lineno"> 7959</span>&#160; </div>
<div class="line"><a name="l07960"></a><span class="lineno"> 7960</span>&#160;  <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>;</div>
<div class="line"><a name="l07961"></a><span class="lineno"> 7961</span>&#160;  vector&lt;int&gt; idVstar; idVstar.reserve(2);</div>
<div class="line"><a name="l07962"></a><span class="lineno"> 7962</span>&#160;  <span class="keywordflow">if</span> (melaCand-&gt;<a class="code" href="classMELAParticle.html#af888923eb993c0115a0f952820f820f3">getNDaughters</a>()==0){</div>
<div class="line"><a name="l07963"></a><span class="lineno"> 7963</span>&#160;    <span class="comment">// Undecayed Higgs has V1=H, V2=empty, no sortedDaughters!</span></div>
<div class="line"><a name="l07964"></a><span class="lineno"> 7964</span>&#160;    <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(melaCand-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>, melaCand-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>));</div>
<div class="line"><a name="l07965"></a><span class="lineno"> 7965</span>&#160;    idVstar.push_back(melaCand-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>);</div>
<div class="line"><a name="l07966"></a><span class="lineno"> 7966</span>&#160;    idVstar.push_back(-9000);</div>
<div class="line"><a name="l07967"></a><span class="lineno"> 7967</span>&#160;  }</div>
<div class="line"><a name="l07968"></a><span class="lineno"> 7968</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l07969"></a><span class="lineno"> 7969</span>&#160;    <span class="comment">// H-&gt;ffb has V1=f-&gt;f, V2=fb-&gt;fb</span></div>
<div class="line"><a name="l07970"></a><span class="lineno"> 7970</span>&#160;    <span class="comment">// H-&gt;GG has V1=G-&gt;G, V2=G-&gt;G</span></div>
<div class="line"><a name="l07971"></a><span class="lineno"> 7971</span>&#160;    <span class="comment">// H-&gt;ZG has V1=Z-&gt;ffb, V2=G-&gt;G</span></div>
<div class="line"><a name="l07972"></a><span class="lineno"> 7972</span>&#160;    <span class="comment">// Everything else is as expected.</span></div>
<div class="line"><a name="l07973"></a><span class="lineno"> 7973</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> iv=0; iv&lt;2; iv++){ <span class="comment">// 2 Vs are guaranteed in MELACandidate.</span></div>
<div class="line"><a name="l07974"></a><span class="lineno"> 7974</span>&#160;      <a class="code" href="classMELAParticle.html">MELAParticle</a>* Vdau = melaCand-&gt;<a class="code" href="classMELACandidate.html#af8501fe7cf1f00ef037a125cc5165d7a">getSortedV</a>(iv);</div>
<div class="line"><a name="l07975"></a><span class="lineno"> 7975</span>&#160;      <span class="keywordflow">if</span> (Vdau){</div>
<div class="line"><a name="l07976"></a><span class="lineno"> 7976</span>&#160;        <span class="keywordtype">int</span> idtmp = Vdau-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>;</div>
<div class="line"><a name="l07977"></a><span class="lineno"> 7977</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classMELAParticle.html">MELAParticle</a>* Vdau_i:Vdau-&gt;<a class="code" href="classMELAParticle.html#a7b091a138709e28de0ca4d843b755efd">getDaughters</a>()){</div>
<div class="line"><a name="l07978"></a><span class="lineno"> 7978</span>&#160;          <span class="keywordflow">if</span> (Vdau_i &amp;&amp; Vdau_i-&gt;passSelection) <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(Vdau_i-&gt;id, Vdau_i-&gt;p4));</div>
<div class="line"><a name="l07979"></a><span class="lineno"> 7979</span>&#160;        }</div>
<div class="line"><a name="l07980"></a><span class="lineno"> 7980</span>&#160;        <span class="keywordflow">if</span> (idtmp!=0 || Vdau-&gt;<a class="code" href="classMELAParticle.html#af888923eb993c0115a0f952820f820f3">getNDaughters</a>()&gt;0){ <span class="comment">// Avoid &quot;empty&quot; intermediate Vs of the MELACandidate object</span></div>
<div class="line"><a name="l07981"></a><span class="lineno"> 7981</span>&#160;          <span class="keywordflow">if</span> (Vdau-&gt;<a class="code" href="classMELAParticle.html#af888923eb993c0115a0f952820f820f3">getNDaughters</a>()&gt;=2 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(idtmp)) idtmp=23; <span class="comment">// Special case to avoid V-&gt;2f with massless decay mode (could happen by mistake)</span></div>
<div class="line"><a name="l07982"></a><span class="lineno"> 7982</span>&#160;          idVstar.push_back(idtmp);</div>
<div class="line"><a name="l07983"></a><span class="lineno"> 7983</span>&#160;        }</div>
<div class="line"><a name="l07984"></a><span class="lineno"> 7984</span>&#160;      }</div>
<div class="line"><a name="l07985"></a><span class="lineno"> 7985</span>&#160;      <span class="keywordflow">else</span> idVstar.push_back(-9000);</div>
<div class="line"><a name="l07986"></a><span class="lineno"> 7986</span>&#160;    }</div>
<div class="line"><a name="l07987"></a><span class="lineno"> 7987</span>&#160;  }</div>
<div class="line"><a name="l07988"></a><span class="lineno"> 7988</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.size()&gt;=2){</div>
<div class="line"><a name="l07989"></a><span class="lineno"> 7989</span>&#160;    <span class="keywordtype">size_t</span> nffs = <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.size()/2;</div>
<div class="line"><a name="l07990"></a><span class="lineno"> 7990</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iv=0; iv&lt;nffs; iv++){</div>
<div class="line"><a name="l07991"></a><span class="lineno"> 7991</span>&#160;      pair&lt;TLorentzVector, TLorentzVector&gt; corrPair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(</div>
<div class="line"><a name="l07992"></a><span class="lineno"> 7992</span>&#160;        <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(2*iv+0).second, <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(2*iv+0).first,</div>
<div class="line"><a name="l07993"></a><span class="lineno"> 7993</span>&#160;        <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(2*iv+1).second, <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(2*iv+1).first</div>
<div class="line"><a name="l07994"></a><span class="lineno"> 7994</span>&#160;        );</div>
<div class="line"><a name="l07995"></a><span class="lineno"> 7995</span>&#160;      <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(2*iv+0).second = corrPair.first;</div>
<div class="line"><a name="l07996"></a><span class="lineno"> 7996</span>&#160;      <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(2*iv+1).second = corrPair.second;</div>
<div class="line"><a name="l07997"></a><span class="lineno"> 7997</span>&#160;    }</div>
<div class="line"><a name="l07998"></a><span class="lineno"> 7998</span>&#160;    <span class="keywordflow">if</span> (2*nffs&lt;<a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.size()){</div>
<div class="line"><a name="l07999"></a><span class="lineno"> 7999</span>&#160;      TLorentzVector tmp = nullFourVector;</div>
<div class="line"><a name="l08000"></a><span class="lineno"> 8000</span>&#160;      <a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>&amp; lastDau = <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.back();</div>
<div class="line"><a name="l08001"></a><span class="lineno"> 8001</span>&#160;      pair&lt;TLorentzVector, TLorentzVector&gt; corrPair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(</div>
<div class="line"><a name="l08002"></a><span class="lineno"> 8002</span>&#160;        lastDau.second, lastDau.first,</div>
<div class="line"><a name="l08003"></a><span class="lineno"> 8003</span>&#160;        tmp, -9000</div>
<div class="line"><a name="l08004"></a><span class="lineno"> 8004</span>&#160;        );</div>
<div class="line"><a name="l08005"></a><span class="lineno"> 8005</span>&#160;      lastDau.second = corrPair.first;</div>
<div class="line"><a name="l08006"></a><span class="lineno"> 8006</span>&#160;    }</div>
<div class="line"><a name="l08007"></a><span class="lineno"> 8007</span>&#160;  }</div>
<div class="line"><a name="l08008"></a><span class="lineno"> 8008</span>&#160; </div>
<div class="line"><a name="l08009"></a><span class="lineno"> 8009</span>&#160;<span class="comment">  /***** ASSOCIATED PARTICLES *****/</span></div>
<div class="line"><a name="l08010"></a><span class="lineno"> 8010</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l08011"></a><span class="lineno"> 8011</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: nRequestedLeps=&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a3051f9440dc00a0a74b80997e898a5f5">nRequested_AssociatedLeptons</a> &lt;&lt; endl;</div>
<div class="line"><a name="l08012"></a><span class="lineno"> 8012</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: nRequestedJets=&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aca54cfc4690b7f0ba78f5af03d0f1ddf">nRequested_AssociatedJets</a> &lt;&lt; endl;</div>
<div class="line"><a name="l08013"></a><span class="lineno"> 8013</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: nRequestedPhotons=&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a47e6f6d74f1c60d73e0328d299467b4e">nRequested_AssociatedPhotons</a> &lt;&lt; endl;</div>
<div class="line"><a name="l08014"></a><span class="lineno"> 8014</span>&#160;  }</div>
<div class="line"><a name="l08015"></a><span class="lineno"> 8015</span>&#160;  <span class="keywordtype">int</span> nsatisfied_jets=0;</div>
<div class="line"><a name="l08016"></a><span class="lineno"> 8016</span>&#160;  <span class="keywordtype">int</span> nsatisfied_lnus=0;</div>
<div class="line"><a name="l08017"></a><span class="lineno"> 8017</span>&#160;  <span class="keywordtype">int</span> nsatisfied_gammas=0;</div>
<div class="line"><a name="l08018"></a><span class="lineno"> 8018</span>&#160;  vector&lt;MELAParticle*&gt; candidateVs; <span class="comment">// Used if aVhypo!=0</span></div>
<div class="line"><a name="l08019"></a><span class="lineno"> 8019</span>&#160;  <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> <a class="code" href="namespacemela.html#a79188ef3c30f518072a2d36f510a5655">associated</a>;</div>
<div class="line"><a name="l08020"></a><span class="lineno"> 8020</span>&#160;  <span class="keywordflow">if</span> (aVhypo!=0){</div>
<div class="line"><a name="l08021"></a><span class="lineno"> 8021</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: aVhypo!=0 case start&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08022"></a><span class="lineno"> 8022</span>&#160; </div>
<div class="line"><a name="l08023"></a><span class="lineno"> 8023</span>&#160;    vector&lt;MELAParticle*&gt; asortedVs = melaCand-&gt;<a class="code" href="classMELACandidate.html#afd1a968bd5724d6333b9cc9194412b8b">getAssociatedSortedVs</a>();</div>
<div class="line"><a name="l08024"></a><span class="lineno"> 8024</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classMELAParticle.html">MELAParticle</a>* Vdau:asortedVs){ <span class="comment">// Loop over associated Vs</span></div>
<div class="line"><a name="l08025"></a><span class="lineno"> 8025</span>&#160;      <span class="keywordflow">if</span> (Vdau){</div>
<div class="line"><a name="l08026"></a><span class="lineno"> 8026</span>&#160;        <span class="keywordtype">bool</span> doAdd=<span class="keyword">false</span>;</div>
<div class="line"><a name="l08027"></a><span class="lineno"> 8027</span>&#160;        <span class="keywordtype">int</span> idV = Vdau-&gt;id;</div>
<div class="line"><a name="l08028"></a><span class="lineno"> 8028</span>&#160;        <span class="keywordflow">if</span> ((abs(idV)==aVhypo || idV==0) &amp;&amp; Vdau-&gt;getNDaughters()&gt;0 &amp;&amp; Vdau-&gt;passSelection){ <span class="comment">// If the V is unknown or compatible with the requested hypothesis</span></div>
<div class="line"><a name="l08029"></a><span class="lineno"> 8029</span>&#160;          doAdd=<span class="keyword">true</span>;</div>
<div class="line"><a name="l08030"></a><span class="lineno"> 8030</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="classMELAParticle.html">MELAParticle</a>* Vdau_i:Vdau-&gt;<a class="code" href="classMELAParticle.html#a7b091a138709e28de0ca4d843b755efd">getDaughters</a>()){ <span class="comment">// Loop over the daughters of V</span></div>
<div class="line"><a name="l08031"></a><span class="lineno"> 8031</span>&#160;            <span class="keywordflow">if</span> (!Vdau_i){ doAdd=<span class="keyword">false</span>; <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l08032"></a><span class="lineno"> 8032</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l08033"></a><span class="lineno"> 8033</span>&#160;              (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a3051f9440dc00a0a74b80997e898a5f5">nRequested_AssociatedLeptons</a>==0 &amp;&amp; (<a class="code" href="namespacePDGHelpers.html#a6f98f45dbd53233287193ec3fe987746">PDGHelpers::isALepton</a>(Vdau_i-&gt;id) || <a class="code" href="namespacePDGHelpers.html#a68ffb179226737e2006fb7b0870dae6a">PDGHelpers::isANeutrino</a>(Vdau_i-&gt;id)))</div>
<div class="line"><a name="l08034"></a><span class="lineno"> 8034</span>&#160;              ||</div>
<div class="line"><a name="l08035"></a><span class="lineno"> 8035</span>&#160;              (mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aca54cfc4690b7f0ba78f5af03d0f1ddf">nRequested_AssociatedJets</a>==0 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(Vdau_i-&gt;id))</div>
<div class="line"><a name="l08036"></a><span class="lineno"> 8036</span>&#160;              ||</div>
<div class="line"><a name="l08037"></a><span class="lineno"> 8037</span>&#160;              !Vdau_i-&gt;passSelection <span class="comment">// Protection against incorrect Vdau passSelection flag</span></div>
<div class="line"><a name="l08038"></a><span class="lineno"> 8038</span>&#160;              ){</div>
<div class="line"><a name="l08039"></a><span class="lineno"> 8039</span>&#160;              doAdd=<span class="keyword">false</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08040"></a><span class="lineno"> 8040</span>&#160;            }</div>
<div class="line"><a name="l08041"></a><span class="lineno"> 8041</span>&#160;          }</div>
<div class="line"><a name="l08042"></a><span class="lineno"> 8042</span>&#160;        }</div>
<div class="line"><a name="l08043"></a><span class="lineno"> 8043</span>&#160;        <span class="keywordflow">if</span> (doAdd) candidateVs.push_back(Vdau);</div>
<div class="line"><a name="l08044"></a><span class="lineno"> 8044</span>&#160;      }</div>
<div class="line"><a name="l08045"></a><span class="lineno"> 8045</span>&#160;    } <span class="comment">// End loop over associated Vs</span></div>
<div class="line"><a name="l08046"></a><span class="lineno"> 8046</span>&#160; </div>
<div class="line"><a name="l08047"></a><span class="lineno"> 8047</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: candidateVs size = &quot;</span> &lt;&lt; candidateVs.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08048"></a><span class="lineno"> 8048</span>&#160; </div>
<div class="line"><a name="l08049"></a><span class="lineno"> 8049</span>&#160;    <span class="comment">// Pick however many candidates necessary to fill up the requested number of jets or lepton(+)neutrinos</span></div>
<div class="line"><a name="l08050"></a><span class="lineno"> 8050</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classMELAParticle.html">MELAParticle</a>* Vdau:candidateVs){</div>
<div class="line"><a name="l08051"></a><span class="lineno"> 8051</span>&#160;      <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> associated_tmp;</div>
<div class="line"><a name="l08052"></a><span class="lineno"> 8052</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMELAParticle.html">MELAParticle</a>* part:Vdau-&gt;<a class="code" href="classMELAParticle.html#a7b091a138709e28de0ca4d843b755efd">getDaughters</a>()){ <span class="comment">// Loop over the daughters of V</span></div>
<div class="line"><a name="l08053"></a><span class="lineno"> 8053</span>&#160;        <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l08054"></a><span class="lineno"> 8054</span>&#160;          part-&gt;passSelection</div>
<div class="line"><a name="l08055"></a><span class="lineno"> 8055</span>&#160;          &amp;&amp;</div>
<div class="line"><a name="l08056"></a><span class="lineno"> 8056</span>&#160;          (<a class="code" href="namespacePDGHelpers.html#a6f98f45dbd53233287193ec3fe987746">PDGHelpers::isALepton</a>(part-&gt;id) || <a class="code" href="namespacePDGHelpers.html#a68ffb179226737e2006fb7b0870dae6a">PDGHelpers::isANeutrino</a>(part-&gt;id))</div>
<div class="line"><a name="l08057"></a><span class="lineno"> 8057</span>&#160;          &amp;&amp;</div>
<div class="line"><a name="l08058"></a><span class="lineno"> 8058</span>&#160;          nsatisfied_lnus&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a3051f9440dc00a0a74b80997e898a5f5">nRequested_AssociatedLeptons</a></div>
<div class="line"><a name="l08059"></a><span class="lineno"> 8059</span>&#160;          ){</div>
<div class="line"><a name="l08060"></a><span class="lineno"> 8060</span>&#160;          nsatisfied_lnus++;</div>
<div class="line"><a name="l08061"></a><span class="lineno"> 8061</span>&#160;          associated_tmp.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(part-&gt;id, part-&gt;p4));</div>
<div class="line"><a name="l08062"></a><span class="lineno"> 8062</span>&#160;        }</div>
<div class="line"><a name="l08063"></a><span class="lineno"> 8063</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l08064"></a><span class="lineno"> 8064</span>&#160;          part-&gt;passSelection</div>
<div class="line"><a name="l08065"></a><span class="lineno"> 8065</span>&#160;          &amp;&amp;</div>
<div class="line"><a name="l08066"></a><span class="lineno"> 8066</span>&#160;          <a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(part-&gt;id)</div>
<div class="line"><a name="l08067"></a><span class="lineno"> 8067</span>&#160;          &amp;&amp;</div>
<div class="line"><a name="l08068"></a><span class="lineno"> 8068</span>&#160;          nsatisfied_jets&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aca54cfc4690b7f0ba78f5af03d0f1ddf">nRequested_AssociatedJets</a></div>
<div class="line"><a name="l08069"></a><span class="lineno"> 8069</span>&#160;          ){</div>
<div class="line"><a name="l08070"></a><span class="lineno"> 8070</span>&#160;          nsatisfied_jets++;</div>
<div class="line"><a name="l08071"></a><span class="lineno"> 8071</span>&#160;          associated_tmp.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(part-&gt;id, part-&gt;p4));</div>
<div class="line"><a name="l08072"></a><span class="lineno"> 8072</span>&#160;        }</div>
<div class="line"><a name="l08073"></a><span class="lineno"> 8073</span>&#160;      }</div>
<div class="line"><a name="l08074"></a><span class="lineno"> 8074</span>&#160;      <span class="comment">// Add the id of the intermediate V into the idVstar array</span></div>
<div class="line"><a name="l08075"></a><span class="lineno"> 8075</span>&#160;      <span class="keywordflow">if</span> (associated_tmp.size()&gt;=2 || (associated_tmp.size()==1 &amp;&amp; <a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(associated_tmp.at(0).first))) idVstar.push_back(Vdau-&gt;id); <span class="comment">// Only add the V-id of pairs that passed</span></div>
<div class="line"><a name="l08076"></a><span class="lineno"> 8076</span>&#160;      <span class="comment">// Adjust the kinematics of associated V-originating particles</span></div>
<div class="line"><a name="l08077"></a><span class="lineno"> 8077</span>&#160;      <span class="keywordflow">if</span> (associated_tmp.size()&gt;=2){ <span class="comment">// ==1 means a photon, so omit it here.</span></div>
<div class="line"><a name="l08078"></a><span class="lineno"> 8078</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nffs = associated_tmp.size()/2;</div>
<div class="line"><a name="l08079"></a><span class="lineno"> 8079</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iv=0; iv&lt;nffs; iv++){</div>
<div class="line"><a name="l08080"></a><span class="lineno"> 8080</span>&#160;          pair&lt;TLorentzVector, TLorentzVector&gt; corrPair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(</div>
<div class="line"><a name="l08081"></a><span class="lineno"> 8081</span>&#160;            associated_tmp.at(2*iv+0).second, associated_tmp.at(2*iv+0).first,</div>
<div class="line"><a name="l08082"></a><span class="lineno"> 8082</span>&#160;            associated_tmp.at(2*iv+1).second, associated_tmp.at(2*iv+1).first</div>
<div class="line"><a name="l08083"></a><span class="lineno"> 8083</span>&#160;            );</div>
<div class="line"><a name="l08084"></a><span class="lineno"> 8084</span>&#160;          associated_tmp.at(2*iv+0).second = corrPair.first;</div>
<div class="line"><a name="l08085"></a><span class="lineno"> 8085</span>&#160;          associated_tmp.at(2*iv+1).second = corrPair.second;</div>
<div class="line"><a name="l08086"></a><span class="lineno"> 8086</span>&#160;        }</div>
<div class="line"><a name="l08087"></a><span class="lineno"> 8087</span>&#160;        <span class="keywordflow">if</span> (2*nffs&lt;associated_tmp.size()){</div>
<div class="line"><a name="l08088"></a><span class="lineno"> 8088</span>&#160;          TLorentzVector tmp = nullFourVector;</div>
<div class="line"><a name="l08089"></a><span class="lineno"> 8089</span>&#160;          pair&lt;TLorentzVector, TLorentzVector&gt; corrPair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(</div>
<div class="line"><a name="l08090"></a><span class="lineno"> 8090</span>&#160;            associated_tmp.at(associated_tmp.size()-1).second, associated_tmp.at(associated_tmp.size()-1).first,</div>
<div class="line"><a name="l08091"></a><span class="lineno"> 8091</span>&#160;            tmp, -9000</div>
<div class="line"><a name="l08092"></a><span class="lineno"> 8092</span>&#160;            );</div>
<div class="line"><a name="l08093"></a><span class="lineno"> 8093</span>&#160;          associated_tmp.at(associated_tmp.size()-1).second = corrPair.first;</div>
<div class="line"><a name="l08094"></a><span class="lineno"> 8094</span>&#160;        }</div>
<div class="line"><a name="l08095"></a><span class="lineno"> 8095</span>&#160;      }</div>
<div class="line"><a name="l08096"></a><span class="lineno"> 8096</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>&amp; sp:associated_tmp) <a class="code" href="namespacemela.html#a79188ef3c30f518072a2d36f510a5655">associated</a>.push_back(sp); <span class="comment">// Fill associated at the last step</span></div>
<div class="line"><a name="l08097"></a><span class="lineno"> 8097</span>&#160;    }</div>
<div class="line"><a name="l08098"></a><span class="lineno"> 8098</span>&#160; </div>
<div class="line"><a name="l08099"></a><span class="lineno"> 8099</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: aVhypo!=0 case associated.size=&quot;</span> &lt;&lt; <a class="code" href="namespacemela.html#a79188ef3c30f518072a2d36f510a5655">associated</a>.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08100"></a><span class="lineno"> 8100</span>&#160;  }</div>
<div class="line"><a name="l08101"></a><span class="lineno"> 8101</span>&#160;  <span class="keywordflow">else</span>{ <span class="comment">// Could be split to aVhypo==0 and aVhypo&lt;0 if associated V+jets is needed</span></div>
<div class="line"><a name="l08102"></a><span class="lineno"> 8102</span>&#160;    <span class="comment">// Associated leptons</span></div>
<div class="line"><a name="l08103"></a><span class="lineno"> 8103</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: aVhypo==0 case begin&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08104"></a><span class="lineno"> 8104</span>&#160; </div>
<div class="line"><a name="l08105"></a><span class="lineno"> 8105</span>&#160;    <span class="keywordflow">if</span> (code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777bad693ed4c2007493918e2772261311b29">TVar::kUseAssociated_Leptons</a>==0){</div>
<div class="line"><a name="l08106"></a><span class="lineno"> 8106</span>&#160;      <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> associated_tmp;</div>
<div class="line"><a name="l08107"></a><span class="lineno"> 8107</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMELAParticle.html">MELAParticle</a>* part:melaCand-&gt;<a class="code" href="classMELACandidate.html#a3b992b0d3078afb9ae7b6aab29d648d6">getAssociatedLeptons</a>()){</div>
<div class="line"><a name="l08108"></a><span class="lineno"> 8108</span>&#160;        <span class="keywordflow">if</span> (part &amp;&amp; part-&gt;passSelection &amp;&amp; nsatisfied_lnus&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a3051f9440dc00a0a74b80997e898a5f5">nRequested_AssociatedLeptons</a>){</div>
<div class="line"><a name="l08109"></a><span class="lineno"> 8109</span>&#160;          nsatisfied_lnus++;</div>
<div class="line"><a name="l08110"></a><span class="lineno"> 8110</span>&#160;          associated_tmp.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(part-&gt;id, part-&gt;p4));</div>
<div class="line"><a name="l08111"></a><span class="lineno"> 8111</span>&#160;        }</div>
<div class="line"><a name="l08112"></a><span class="lineno"> 8112</span>&#160;      }</div>
<div class="line"><a name="l08113"></a><span class="lineno"> 8113</span>&#160; </div>
<div class="line"><a name="l08114"></a><span class="lineno"> 8114</span>&#160;      <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: aVhypo==0 lep case associated_tmp.size=&quot;</span> &lt;&lt; associated_tmp.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08115"></a><span class="lineno"> 8115</span>&#160; </div>
<div class="line"><a name="l08116"></a><span class="lineno"> 8116</span>&#160;      <span class="comment">// Adjust the kinematics of associated non-V-originating particles</span></div>
<div class="line"><a name="l08117"></a><span class="lineno"> 8117</span>&#160;      <span class="keywordflow">if</span> (associated_tmp.size()&gt;=1){</div>
<div class="line"><a name="l08118"></a><span class="lineno"> 8118</span>&#160;        <span class="keywordtype">size_t</span> nffs = associated_tmp.size()/2;</div>
<div class="line"><a name="l08119"></a><span class="lineno"> 8119</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iv=0; iv&lt;nffs; iv++){</div>
<div class="line"><a name="l08120"></a><span class="lineno"> 8120</span>&#160;          <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: Removing mass from lepton pair &quot;</span> &lt;&lt; 2*iv+0 &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; 2*iv+1 &lt;&lt; endl;</div>
<div class="line"><a name="l08121"></a><span class="lineno"> 8121</span>&#160;          pair&lt;TLorentzVector, TLorentzVector&gt; corrPair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(</div>
<div class="line"><a name="l08122"></a><span class="lineno"> 8122</span>&#160;            associated_tmp.at(2*iv+0).second, associated_tmp.at(2*iv+0).first,</div>
<div class="line"><a name="l08123"></a><span class="lineno"> 8123</span>&#160;            associated_tmp.at(2*iv+1).second, associated_tmp.at(2*iv+1).first</div>
<div class="line"><a name="l08124"></a><span class="lineno"> 8124</span>&#160;            );</div>
<div class="line"><a name="l08125"></a><span class="lineno"> 8125</span>&#160;          associated_tmp.at(2*iv+0).second = corrPair.first;</div>
<div class="line"><a name="l08126"></a><span class="lineno"> 8126</span>&#160;          associated_tmp.at(2*iv+1).second = corrPair.second;</div>
<div class="line"><a name="l08127"></a><span class="lineno"> 8127</span>&#160;        }</div>
<div class="line"><a name="l08128"></a><span class="lineno"> 8128</span>&#160;        <span class="keywordflow">if</span> (2*nffs&lt;associated_tmp.size()){</div>
<div class="line"><a name="l08129"></a><span class="lineno"> 8129</span>&#160;          <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: Removing mass from last lepton  &quot;</span> &lt;&lt; associated_tmp.size()-1 &lt;&lt; endl;</div>
<div class="line"><a name="l08130"></a><span class="lineno"> 8130</span>&#160;          TLorentzVector tmp = nullFourVector;</div>
<div class="line"><a name="l08131"></a><span class="lineno"> 8131</span>&#160;          <a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>&amp; lastAssociated = associated_tmp.at(associated_tmp.size()-1);</div>
<div class="line"><a name="l08132"></a><span class="lineno"> 8132</span>&#160;          pair&lt;TLorentzVector, TLorentzVector&gt; corrPair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(</div>
<div class="line"><a name="l08133"></a><span class="lineno"> 8133</span>&#160;            lastAssociated.second, lastAssociated.first,</div>
<div class="line"><a name="l08134"></a><span class="lineno"> 8134</span>&#160;            tmp, -9000</div>
<div class="line"><a name="l08135"></a><span class="lineno"> 8135</span>&#160;            );</div>
<div class="line"><a name="l08136"></a><span class="lineno"> 8136</span>&#160;          lastAssociated.second = corrPair.first;</div>
<div class="line"><a name="l08137"></a><span class="lineno"> 8137</span>&#160;        }</div>
<div class="line"><a name="l08138"></a><span class="lineno"> 8138</span>&#160;      }</div>
<div class="line"><a name="l08139"></a><span class="lineno"> 8139</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>&amp; sp:associated_tmp) <a class="code" href="namespacemela.html#a79188ef3c30f518072a2d36f510a5655">associated</a>.push_back(sp); <span class="comment">// Fill associated at the last step</span></div>
<div class="line"><a name="l08140"></a><span class="lineno"> 8140</span>&#160;    }</div>
<div class="line"><a name="l08141"></a><span class="lineno"> 8141</span>&#160;    <span class="comment">// Associated jets</span></div>
<div class="line"><a name="l08142"></a><span class="lineno"> 8142</span>&#160;    <span class="keywordflow">if</span> (code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba73861ec433a26ae79407bfe3f2f7b71a">TVar::kUseAssociated_Jets</a>==0){</div>
<div class="line"><a name="l08143"></a><span class="lineno"> 8143</span>&#160;      <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> associated_tmp;</div>
<div class="line"><a name="l08144"></a><span class="lineno"> 8144</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classMELAParticle.html">MELAParticle</a>* part:melaCand-&gt;<a class="code" href="classMELACandidate.html#a8d1ea43958f7a2ecf1f35006eb8152e8">getAssociatedJets</a>()){</div>
<div class="line"><a name="l08145"></a><span class="lineno"> 8145</span>&#160;        <span class="keywordflow">if</span> (part &amp;&amp; part-&gt;passSelection &amp;&amp; nsatisfied_jets&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aca54cfc4690b7f0ba78f5af03d0f1ddf">nRequested_AssociatedJets</a>){</div>
<div class="line"><a name="l08146"></a><span class="lineno"> 8146</span>&#160;          nsatisfied_jets++;</div>
<div class="line"><a name="l08147"></a><span class="lineno"> 8147</span>&#160;          associated_tmp.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(part-&gt;id, part-&gt;p4));</div>
<div class="line"><a name="l08148"></a><span class="lineno"> 8148</span>&#160;        }</div>
<div class="line"><a name="l08149"></a><span class="lineno"> 8149</span>&#160;      }</div>
<div class="line"><a name="l08150"></a><span class="lineno"> 8150</span>&#160; </div>
<div class="line"><a name="l08151"></a><span class="lineno"> 8151</span>&#160;      <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: aVhypo==0 jet case associated_tmp.size=&quot;</span> &lt;&lt; associated_tmp.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08152"></a><span class="lineno"> 8152</span>&#160; </div>
<div class="line"><a name="l08153"></a><span class="lineno"> 8153</span>&#160;      <span class="comment">// Adjust the kinematics of associated non-V-originating particles</span></div>
<div class="line"><a name="l08154"></a><span class="lineno"> 8154</span>&#160;      <span class="keywordflow">if</span> (associated_tmp.size()&gt;=1){</div>
<div class="line"><a name="l08155"></a><span class="lineno"> 8155</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nffs = associated_tmp.size()/2;</div>
<div class="line"><a name="l08156"></a><span class="lineno"> 8156</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iv=0; iv&lt;nffs; iv++){</div>
<div class="line"><a name="l08157"></a><span class="lineno"> 8157</span>&#160;          <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: Removing mass from jet pair &quot;</span> &lt;&lt; 2*iv+0 &lt;&lt; <span class="charliteral">&#39;\t&#39;</span> &lt;&lt; 2*iv+1 &lt;&lt; endl;</div>
<div class="line"><a name="l08158"></a><span class="lineno"> 8158</span>&#160;          pair&lt;TLorentzVector, TLorentzVector&gt; corrPair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(</div>
<div class="line"><a name="l08159"></a><span class="lineno"> 8159</span>&#160;            associated_tmp.at(2*iv+0).second, associated_tmp.at(2*iv+0).first,</div>
<div class="line"><a name="l08160"></a><span class="lineno"> 8160</span>&#160;            associated_tmp.at(2*iv+1).second, associated_tmp.at(2*iv+1).first</div>
<div class="line"><a name="l08161"></a><span class="lineno"> 8161</span>&#160;            );</div>
<div class="line"><a name="l08162"></a><span class="lineno"> 8162</span>&#160;          associated_tmp.at(2*iv+0).second = corrPair.first;</div>
<div class="line"><a name="l08163"></a><span class="lineno"> 8163</span>&#160;          associated_tmp.at(2*iv+1).second = corrPair.second;</div>
<div class="line"><a name="l08164"></a><span class="lineno"> 8164</span>&#160;        }</div>
<div class="line"><a name="l08165"></a><span class="lineno"> 8165</span>&#160;        <span class="keywordflow">if</span> (2*nffs&lt;associated_tmp.size()){</div>
<div class="line"><a name="l08166"></a><span class="lineno"> 8166</span>&#160;          <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: Removing mass from last jet  &quot;</span> &lt;&lt; associated_tmp.size()-1 &lt;&lt; endl;</div>
<div class="line"><a name="l08167"></a><span class="lineno"> 8167</span>&#160;          TLorentzVector tmp = nullFourVector;</div>
<div class="line"><a name="l08168"></a><span class="lineno"> 8168</span>&#160;          <a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>&amp; lastAssociated = associated_tmp.at(associated_tmp.size()-1);</div>
<div class="line"><a name="l08169"></a><span class="lineno"> 8169</span>&#160;          pair&lt;TLorentzVector, TLorentzVector&gt; corrPair = <a class="code" href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a>(</div>
<div class="line"><a name="l08170"></a><span class="lineno"> 8170</span>&#160;            lastAssociated.second, lastAssociated.first,</div>
<div class="line"><a name="l08171"></a><span class="lineno"> 8171</span>&#160;            tmp, -9000</div>
<div class="line"><a name="l08172"></a><span class="lineno"> 8172</span>&#160;            );</div>
<div class="line"><a name="l08173"></a><span class="lineno"> 8173</span>&#160;          lastAssociated.second = corrPair.first;</div>
<div class="line"><a name="l08174"></a><span class="lineno"> 8174</span>&#160;        }</div>
<div class="line"><a name="l08175"></a><span class="lineno"> 8175</span>&#160;      }</div>
<div class="line"><a name="l08176"></a><span class="lineno"> 8176</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>&amp; sp:associated_tmp) <a class="code" href="namespacemela.html#a79188ef3c30f518072a2d36f510a5655">associated</a>.push_back(sp); <span class="comment">// Fill associated at the last step</span></div>
<div class="line"><a name="l08177"></a><span class="lineno"> 8177</span>&#160;    }</div>
<div class="line"><a name="l08178"></a><span class="lineno"> 8178</span>&#160; </div>
<div class="line"><a name="l08179"></a><span class="lineno"> 8179</span>&#160;  } <span class="comment">// End if(aVhypo!=0)-else statement</span></div>
<div class="line"><a name="l08180"></a><span class="lineno"> 8180</span>&#160; </div>
<div class="line"><a name="l08181"></a><span class="lineno"> 8181</span>&#160;  <span class="keywordflow">if</span> (code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777bae499e0ec0e4765de3a71e6e6d13eb535">TVar::kUseAssociated_Photons</a>==0){</div>
<div class="line"><a name="l08182"></a><span class="lineno"> 8182</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classMELAParticle.html">MELAParticle</a>* part:melaCand-&gt;<a class="code" href="classMELACandidate.html#a0562974f62f15834e9cfd0d147d4fccd">getAssociatedPhotons</a>()){</div>
<div class="line"><a name="l08183"></a><span class="lineno"> 8183</span>&#160;      <span class="keywordflow">if</span> (part &amp;&amp; part-&gt;passSelection &amp;&amp; nsatisfied_gammas&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a47e6f6d74f1c60d73e0328d299467b4e">nRequested_AssociatedPhotons</a>){</div>
<div class="line"><a name="l08184"></a><span class="lineno"> 8184</span>&#160;        nsatisfied_gammas++;</div>
<div class="line"><a name="l08185"></a><span class="lineno"> 8185</span>&#160;        <a class="code" href="namespacemela.html#a79188ef3c30f518072a2d36f510a5655">associated</a>.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(part-&gt;id, part-&gt;p4));</div>
<div class="line"><a name="l08186"></a><span class="lineno"> 8186</span>&#160;      }</div>
<div class="line"><a name="l08187"></a><span class="lineno"> 8187</span>&#160;    }</div>
<div class="line"><a name="l08188"></a><span class="lineno"> 8188</span>&#160;  }</div>
<div class="line"><a name="l08189"></a><span class="lineno"> 8189</span>&#160;<span class="comment">  /***** END ASSOCIATED PARTICLES *****/</span></div>
<div class="line"><a name="l08190"></a><span class="lineno"> 8190</span>&#160; </div>
<div class="line"><a name="l08191"></a><span class="lineno"> 8191</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: associated.size=&quot;</span> &lt;&lt; <a class="code" href="namespacemela.html#a79188ef3c30f518072a2d36f510a5655">associated</a>.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08192"></a><span class="lineno"> 8192</span>&#160; </div>
<div class="line"><a name="l08193"></a><span class="lineno"> 8193</span>&#160;<span class="comment">  /***** ASSOCIATED TOP OBJECTS *****/</span></div>
<div class="line"><a name="l08194"></a><span class="lineno"> 8194</span>&#160;  <span class="keywordtype">int</span> nsatisfied_tops=0;</div>
<div class="line"><a name="l08195"></a><span class="lineno"> 8195</span>&#160;  <span class="keywordtype">int</span> nsatisfied_antitops=0;</div>
<div class="line"><a name="l08196"></a><span class="lineno"> 8196</span>&#160;  vector&lt;SimpleParticleCollection_t&gt; topDaughters;</div>
<div class="line"><a name="l08197"></a><span class="lineno"> 8197</span>&#160;  vector&lt;SimpleParticleCollection_t&gt; antitopDaughters;</div>
<div class="line"><a name="l08198"></a><span class="lineno"> 8198</span>&#160;  <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> stableTops;</div>
<div class="line"><a name="l08199"></a><span class="lineno"> 8199</span>&#160;  <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> stableAntitops;</div>
<div class="line"><a name="l08200"></a><span class="lineno"> 8200</span>&#160; </div>
<div class="line"><a name="l08201"></a><span class="lineno"> 8201</span>&#160;  vector&lt;MELATopCandidate_t*&gt; tops;</div>
<div class="line"><a name="l08202"></a><span class="lineno"> 8202</span>&#160;  vector&lt;MELATopCandidate_t*&gt; topbars;</div>
<div class="line"><a name="l08203"></a><span class="lineno"> 8203</span>&#160;  vector&lt;MELATopCandidate_t*&gt; unknowntops;</div>
<div class="line"><a name="l08204"></a><span class="lineno"> 8204</span>&#160;  <span class="keywordflow">if</span> (code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba4551ea50273466da7a30f958650ebfe7">TVar::kUseAssociated_StableTops</a>==0 &amp;&amp; code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba9dc7858ba1f4e25c5a0d3d914dcda75f">TVar::kUseAssociated_UnstableTops</a>==0 &amp;&amp; verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a55570e17cba7f10ab11173ebb9d25125">TVar::INFO</a>) <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: Stable and unstable tops are not supported at the same time!&quot;</span>  &lt;&lt; endl;</div>
<div class="line"><a name="l08205"></a><span class="lineno"> 8205</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba4551ea50273466da7a30f958650ebfe7">TVar::kUseAssociated_StableTops</a>==0 || code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba9dc7858ba1f4e25c5a0d3d914dcda75f">TVar::kUseAssociated_UnstableTops</a>==0){</div>
<div class="line"><a name="l08206"></a><span class="lineno"> 8206</span>&#160; </div>
<div class="line"><a name="l08207"></a><span class="lineno"> 8207</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classMELAThreeBodyDecayCandidate.html">MELATopCandidate_t</a>* theTop:melaCand-&gt;<a class="code" href="classMELACandidate.html#a53709194c53932ee53830e5308f41fb2">getAssociatedTops</a>()){</div>
<div class="line"><a name="l08208"></a><span class="lineno"> 8208</span>&#160;      <span class="keywordflow">if</span> (theTop &amp;&amp; theTop-&gt;passSelection){</div>
<div class="line"><a name="l08209"></a><span class="lineno"> 8209</span>&#160;        vector&lt;MELATopCandidate_t*&gt;* particleArray;</div>
<div class="line"><a name="l08210"></a><span class="lineno"> 8210</span>&#160;        <span class="keywordflow">if</span> (theTop-&gt;id==6) particleArray = &amp;tops;</div>
<div class="line"><a name="l08211"></a><span class="lineno"> 8211</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (theTop-&gt;id==-6) particleArray = &amp;topbars;</div>
<div class="line"><a name="l08212"></a><span class="lineno"> 8212</span>&#160;        <span class="keywordflow">else</span> particleArray = &amp;unknowntops;</div>
<div class="line"><a name="l08213"></a><span class="lineno"> 8213</span>&#160;        <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l08214"></a><span class="lineno"> 8214</span>&#160;          (code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba4551ea50273466da7a30f958650ebfe7">TVar::kUseAssociated_StableTops</a>==0)</div>
<div class="line"><a name="l08215"></a><span class="lineno"> 8215</span>&#160;          ||</div>
<div class="line"><a name="l08216"></a><span class="lineno"> 8216</span>&#160;          (theTop-&gt;getNDaughters()==3 &amp;&amp; code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba9dc7858ba1f4e25c5a0d3d914dcda75f">TVar::kUseAssociated_UnstableTops</a>==0)</div>
<div class="line"><a name="l08217"></a><span class="lineno"> 8217</span>&#160;          ) particleArray-&gt;push_back(theTop);</div>
<div class="line"><a name="l08218"></a><span class="lineno"> 8218</span>&#160;      }</div>
<div class="line"><a name="l08219"></a><span class="lineno"> 8219</span>&#160;    }</div>
<div class="line"><a name="l08220"></a><span class="lineno"> 8220</span>&#160;    <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){ <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: tops.size=&quot;</span> &lt;&lt; tops.size() &lt;&lt; <span class="stringliteral">&quot;, topbars.size=&quot;</span> &lt;&lt; topbars.size() &lt;&lt; <span class="stringliteral">&quot;, unknowntops.size=&quot;</span> &lt;&lt; unknowntops.size() &lt;&lt; endl; }</div>
<div class="line"><a name="l08221"></a><span class="lineno"> 8221</span>&#160; </div>
<div class="line"><a name="l08222"></a><span class="lineno"> 8222</span>&#160;    <span class="comment">// Fill the stable/unstable top arrays</span></div>
<div class="line"><a name="l08223"></a><span class="lineno"> 8223</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classMELAThreeBodyDecayCandidate.html">MELATopCandidate_t</a>* theTop:tops){</div>
<div class="line"><a name="l08224"></a><span class="lineno"> 8224</span>&#160;      <span class="keywordflow">if</span> (code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba4551ea50273466da7a30f958650ebfe7">TVar::kUseAssociated_StableTops</a>==0 &amp;&amp; nsatisfied_tops&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a056a397d9afaee97f896feadbe37b6a9">nRequested_Tops</a>){ <span class="comment">// Case with no daughters needed</span></div>
<div class="line"><a name="l08225"></a><span class="lineno"> 8225</span>&#160;        nsatisfied_tops++;</div>
<div class="line"><a name="l08226"></a><span class="lineno"> 8226</span>&#160;        stableTops.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(theTop-&gt;id, theTop-&gt;p4));</div>
<div class="line"><a name="l08227"></a><span class="lineno"> 8227</span>&#160;      }</div>
<div class="line"><a name="l08228"></a><span class="lineno"> 8228</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba9dc7858ba1f4e25c5a0d3d914dcda75f">TVar::kUseAssociated_UnstableTops</a>==0 &amp;&amp; theTop-&gt;getNDaughters()==3 &amp;&amp; nsatisfied_tops&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a056a397d9afaee97f896feadbe37b6a9">nRequested_Tops</a>){ <span class="comment">// Case with daughters needed</span></div>
<div class="line"><a name="l08229"></a><span class="lineno"> 8229</span>&#160;        nsatisfied_tops++;</div>
<div class="line"><a name="l08230"></a><span class="lineno"> 8230</span>&#160;        <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> vdaughters;</div>
<div class="line"><a name="l08231"></a><span class="lineno"> 8231</span>&#160; </div>
<div class="line"><a name="l08232"></a><span class="lineno"> 8232</span>&#160;        <a class="code" href="classMELAParticle.html">MELAParticle</a>* bottom = theTop-&gt;getPartnerParticle();</div>
<div class="line"><a name="l08233"></a><span class="lineno"> 8233</span>&#160;        <a class="code" href="classMELAParticle.html">MELAParticle</a>* Wf = theTop-&gt;getWFermion();</div>
<div class="line"><a name="l08234"></a><span class="lineno"> 8234</span>&#160;        <a class="code" href="classMELAParticle.html">MELAParticle</a>* Wfb = theTop-&gt;getWAntifermion();</div>
<div class="line"><a name="l08235"></a><span class="lineno"> 8235</span>&#160;        <span class="keywordflow">if</span> (bottom) vdaughters.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(bottom-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>, bottom-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>));</div>
<div class="line"><a name="l08236"></a><span class="lineno"> 8236</span>&#160;        <span class="keywordflow">if</span> (Wf) vdaughters.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(Wf-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>, Wf-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>));</div>
<div class="line"><a name="l08237"></a><span class="lineno"> 8237</span>&#160;        <span class="keywordflow">if</span> (Wfb) vdaughters.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(Wfb-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>, Wfb-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>));</div>
<div class="line"><a name="l08238"></a><span class="lineno"> 8238</span>&#160; </div>
<div class="line"><a name="l08239"></a><span class="lineno"> 8239</span>&#160;        <a class="code" href="namespaceTUtil.html#a22ae65dea83b7d412dd94f09ac3b7de7">TUtil::adjustTopDaughters</a>(vdaughters); <span class="comment">// Adjust top daughter kinematics</span></div>
<div class="line"><a name="l08240"></a><span class="lineno"> 8240</span>&#160;        <span class="keywordflow">if</span> (vdaughters.size()==3) topDaughters.push_back(vdaughters);</div>
<div class="line"><a name="l08241"></a><span class="lineno"> 8241</span>&#160;      }</div>
<div class="line"><a name="l08242"></a><span class="lineno"> 8242</span>&#160;    }</div>
<div class="line"><a name="l08243"></a><span class="lineno"> 8243</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classMELAThreeBodyDecayCandidate.html">MELATopCandidate_t</a>* theTop:topbars){</div>
<div class="line"><a name="l08244"></a><span class="lineno"> 8244</span>&#160;      <span class="keywordflow">if</span> (code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba4551ea50273466da7a30f958650ebfe7">TVar::kUseAssociated_StableTops</a>==0 &amp;&amp; nsatisfied_antitops&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5885d87c8c2e5dd520b9541e479d71bd">nRequested_Antitops</a>){ <span class="comment">// Case with no daughters needed</span></div>
<div class="line"><a name="l08245"></a><span class="lineno"> 8245</span>&#160;        nsatisfied_antitops++;</div>
<div class="line"><a name="l08246"></a><span class="lineno"> 8246</span>&#160;        stableAntitops.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(theTop-&gt;id, theTop-&gt;p4));</div>
<div class="line"><a name="l08247"></a><span class="lineno"> 8247</span>&#160;      }</div>
<div class="line"><a name="l08248"></a><span class="lineno"> 8248</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba9dc7858ba1f4e25c5a0d3d914dcda75f">TVar::kUseAssociated_UnstableTops</a>==0 &amp;&amp; nsatisfied_antitops&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5885d87c8c2e5dd520b9541e479d71bd">nRequested_Antitops</a>){ <span class="comment">// Case with daughters needed</span></div>
<div class="line"><a name="l08249"></a><span class="lineno"> 8249</span>&#160;        nsatisfied_antitops++;</div>
<div class="line"><a name="l08250"></a><span class="lineno"> 8250</span>&#160;        <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> vdaughters;</div>
<div class="line"><a name="l08251"></a><span class="lineno"> 8251</span>&#160; </div>
<div class="line"><a name="l08252"></a><span class="lineno"> 8252</span>&#160;        <a class="code" href="classMELAParticle.html">MELAParticle</a>* bottom = theTop-&gt;getPartnerParticle();</div>
<div class="line"><a name="l08253"></a><span class="lineno"> 8253</span>&#160;        <a class="code" href="classMELAParticle.html">MELAParticle</a>* Wf = theTop-&gt;getWFermion();</div>
<div class="line"><a name="l08254"></a><span class="lineno"> 8254</span>&#160;        <a class="code" href="classMELAParticle.html">MELAParticle</a>* Wfb = theTop-&gt;getWAntifermion();</div>
<div class="line"><a name="l08255"></a><span class="lineno"> 8255</span>&#160;        <span class="keywordflow">if</span> (bottom) vdaughters.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(bottom-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>, bottom-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>));</div>
<div class="line"><a name="l08256"></a><span class="lineno"> 8256</span>&#160;        <span class="keywordflow">if</span> (Wf) vdaughters.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(Wf-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>, Wf-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>));</div>
<div class="line"><a name="l08257"></a><span class="lineno"> 8257</span>&#160;        <span class="keywordflow">if</span> (Wfb) vdaughters.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(Wfb-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>, Wfb-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>));</div>
<div class="line"><a name="l08258"></a><span class="lineno"> 8258</span>&#160; </div>
<div class="line"><a name="l08259"></a><span class="lineno"> 8259</span>&#160;        <a class="code" href="namespaceTUtil.html#a22ae65dea83b7d412dd94f09ac3b7de7">TUtil::adjustTopDaughters</a>(vdaughters); <span class="comment">// Adjust top daughter kinematics</span></div>
<div class="line"><a name="l08260"></a><span class="lineno"> 8260</span>&#160;        <span class="keywordflow">if</span> (vdaughters.size()==3) antitopDaughters.push_back(vdaughters);</div>
<div class="line"><a name="l08261"></a><span class="lineno"> 8261</span>&#160;      }</div>
<div class="line"><a name="l08262"></a><span class="lineno"> 8262</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08263"></a><span class="lineno"> 8263</span>&#160;    }</div>
<div class="line"><a name="l08264"></a><span class="lineno"> 8264</span>&#160;    <span class="comment">// Loop over the unknown-id tops</span></div>
<div class="line"><a name="l08265"></a><span class="lineno"> 8265</span>&#160;    <span class="comment">// Fill tops, then antitops from the unknown tops</span></div>
<div class="line"><a name="l08266"></a><span class="lineno"> 8266</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classMELAThreeBodyDecayCandidate.html">MELATopCandidate_t</a>* theTop:unknowntops){</div>
<div class="line"><a name="l08267"></a><span class="lineno"> 8267</span>&#160;      <span class="comment">// t, then tb cases with no daughters needed</span></div>
<div class="line"><a name="l08268"></a><span class="lineno"> 8268</span>&#160;      <span class="keywordflow">if</span> (code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba4551ea50273466da7a30f958650ebfe7">TVar::kUseAssociated_StableTops</a>==0 &amp;&amp; nsatisfied_tops&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a056a397d9afaee97f896feadbe37b6a9">nRequested_Tops</a>){</div>
<div class="line"><a name="l08269"></a><span class="lineno"> 8269</span>&#160;        nsatisfied_tops++;</div>
<div class="line"><a name="l08270"></a><span class="lineno"> 8270</span>&#160;        stableTops.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(theTop-&gt;id, theTop-&gt;p4));</div>
<div class="line"><a name="l08271"></a><span class="lineno"> 8271</span>&#160;      }</div>
<div class="line"><a name="l08272"></a><span class="lineno"> 8272</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba4551ea50273466da7a30f958650ebfe7">TVar::kUseAssociated_StableTops</a>==0 &amp;&amp; nsatisfied_antitops&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5885d87c8c2e5dd520b9541e479d71bd">nRequested_Antitops</a>){</div>
<div class="line"><a name="l08273"></a><span class="lineno"> 8273</span>&#160;        nsatisfied_antitops++;</div>
<div class="line"><a name="l08274"></a><span class="lineno"> 8274</span>&#160;        stableAntitops.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(theTop-&gt;id, theTop-&gt;p4));</div>
<div class="line"><a name="l08275"></a><span class="lineno"> 8275</span>&#160;      }</div>
<div class="line"><a name="l08276"></a><span class="lineno"> 8276</span>&#160;      <span class="comment">// t, then tb cases with daughters needed</span></div>
<div class="line"><a name="l08277"></a><span class="lineno"> 8277</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba9dc7858ba1f4e25c5a0d3d914dcda75f">TVar::kUseAssociated_UnstableTops</a>==0 &amp;&amp; nsatisfied_tops&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a056a397d9afaee97f896feadbe37b6a9">nRequested_Tops</a>){</div>
<div class="line"><a name="l08278"></a><span class="lineno"> 8278</span>&#160;        nsatisfied_tops++;</div>
<div class="line"><a name="l08279"></a><span class="lineno"> 8279</span>&#160;        <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> vdaughters;</div>
<div class="line"><a name="l08280"></a><span class="lineno"> 8280</span>&#160; </div>
<div class="line"><a name="l08281"></a><span class="lineno"> 8281</span>&#160;        <a class="code" href="classMELAParticle.html">MELAParticle</a>* bottom = theTop-&gt;getPartnerParticle();</div>
<div class="line"><a name="l08282"></a><span class="lineno"> 8282</span>&#160;        <a class="code" href="classMELAParticle.html">MELAParticle</a>* Wf = theTop-&gt;getWFermion();</div>
<div class="line"><a name="l08283"></a><span class="lineno"> 8283</span>&#160;        <a class="code" href="classMELAParticle.html">MELAParticle</a>* Wfb = theTop-&gt;getWAntifermion();</div>
<div class="line"><a name="l08284"></a><span class="lineno"> 8284</span>&#160;        <span class="keywordflow">if</span> (bottom) vdaughters.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(bottom-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>, bottom-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>));</div>
<div class="line"><a name="l08285"></a><span class="lineno"> 8285</span>&#160;        <span class="keywordflow">if</span> (Wf) vdaughters.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(Wf-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>, Wf-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>));</div>
<div class="line"><a name="l08286"></a><span class="lineno"> 8286</span>&#160;        <span class="keywordflow">if</span> (Wfb) vdaughters.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(Wfb-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>, Wfb-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>));</div>
<div class="line"><a name="l08287"></a><span class="lineno"> 8287</span>&#160; </div>
<div class="line"><a name="l08288"></a><span class="lineno"> 8288</span>&#160;        <a class="code" href="namespaceTUtil.html#a22ae65dea83b7d412dd94f09ac3b7de7">TUtil::adjustTopDaughters</a>(vdaughters); <span class="comment">// Adjust top daughter kinematics</span></div>
<div class="line"><a name="l08289"></a><span class="lineno"> 8289</span>&#160;        <span class="keywordflow">if</span> (vdaughters.size()==3) topDaughters.push_back(vdaughters);</div>
<div class="line"><a name="l08290"></a><span class="lineno"> 8290</span>&#160;      }</div>
<div class="line"><a name="l08291"></a><span class="lineno"> 8291</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (code%<a class="code" href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba9dc7858ba1f4e25c5a0d3d914dcda75f">TVar::kUseAssociated_UnstableTops</a>==0 &amp;&amp; nsatisfied_antitops&lt;mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5885d87c8c2e5dd520b9541e479d71bd">nRequested_Antitops</a>){</div>
<div class="line"><a name="l08292"></a><span class="lineno"> 8292</span>&#160;        nsatisfied_antitops++;</div>
<div class="line"><a name="l08293"></a><span class="lineno"> 8293</span>&#160;        <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> vdaughters;</div>
<div class="line"><a name="l08294"></a><span class="lineno"> 8294</span>&#160; </div>
<div class="line"><a name="l08295"></a><span class="lineno"> 8295</span>&#160;        <a class="code" href="classMELAParticle.html">MELAParticle</a>* bottom = theTop-&gt;getPartnerParticle();</div>
<div class="line"><a name="l08296"></a><span class="lineno"> 8296</span>&#160;        <a class="code" href="classMELAParticle.html">MELAParticle</a>* Wf = theTop-&gt;getWFermion();</div>
<div class="line"><a name="l08297"></a><span class="lineno"> 8297</span>&#160;        <a class="code" href="classMELAParticle.html">MELAParticle</a>* Wfb = theTop-&gt;getWAntifermion();</div>
<div class="line"><a name="l08298"></a><span class="lineno"> 8298</span>&#160;        <span class="keywordflow">if</span> (bottom) vdaughters.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(bottom-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>, bottom-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>));</div>
<div class="line"><a name="l08299"></a><span class="lineno"> 8299</span>&#160;        <span class="keywordflow">if</span> (Wf) vdaughters.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(Wf-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>, Wf-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>));</div>
<div class="line"><a name="l08300"></a><span class="lineno"> 8300</span>&#160;        <span class="keywordflow">if</span> (Wfb) vdaughters.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(Wfb-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>, Wfb-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>));</div>
<div class="line"><a name="l08301"></a><span class="lineno"> 8301</span>&#160; </div>
<div class="line"><a name="l08302"></a><span class="lineno"> 8302</span>&#160;        <a class="code" href="namespaceTUtil.html#a22ae65dea83b7d412dd94f09ac3b7de7">TUtil::adjustTopDaughters</a>(vdaughters); <span class="comment">// Adjust top daughter kinematics</span></div>
<div class="line"><a name="l08303"></a><span class="lineno"> 8303</span>&#160;        <span class="keywordflow">if</span> (vdaughters.size()==3) antitopDaughters.push_back(vdaughters);</div>
<div class="line"><a name="l08304"></a><span class="lineno"> 8304</span>&#160;      }</div>
<div class="line"><a name="l08305"></a><span class="lineno"> 8305</span>&#160;    }</div>
<div class="line"><a name="l08306"></a><span class="lineno"> 8306</span>&#160; </div>
<div class="line"><a name="l08307"></a><span class="lineno"> 8307</span>&#160;  }</div>
<div class="line"><a name="l08308"></a><span class="lineno"> 8308</span>&#160;<span class="comment">  /***** END ASSOCIATED TOP OBJECTS *****/</span></div>
<div class="line"><a name="l08309"></a><span class="lineno"> 8309</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l08310"></a><span class="lineno"> 8310</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: stableTops.size=&quot;</span> &lt;&lt; stableTops.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08311"></a><span class="lineno"> 8311</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: stableAntitops.size=&quot;</span> &lt;&lt; stableAntitops.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08312"></a><span class="lineno"> 8312</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: topDaughters.size=&quot;</span> &lt;&lt; topDaughters.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08313"></a><span class="lineno"> 8313</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> itop=0; itop&lt;topDaughters.size(); itop++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: topDaughters.at(&quot;</span> &lt;&lt; itop &lt;&lt; <span class="stringliteral">&quot;).size=&quot;</span> &lt;&lt; topDaughters.at(itop).size() &lt;&lt; endl;</div>
<div class="line"><a name="l08314"></a><span class="lineno"> 8314</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: antitopDaughters.size=&quot;</span> &lt;&lt; antitopDaughters.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08315"></a><span class="lineno"> 8315</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> itop=0; itop&lt;antitopDaughters.size(); itop++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors: antitopDaughters.at(&quot;</span> &lt;&lt; itop &lt;&lt; <span class="stringliteral">&quot;).size=&quot;</span> &lt;&lt; antitopDaughters.at(itop).size() &lt;&lt; endl;</div>
<div class="line"><a name="l08316"></a><span class="lineno"> 8316</span>&#160;  }</div>
<div class="line"><a name="l08317"></a><span class="lineno"> 8317</span>&#160; </div>
<div class="line"><a name="l08318"></a><span class="lineno"> 8318</span>&#160;<span class="comment">  /***** BOOSTS TO THE CORRECT PT=0 FRAME *****/</span></div>
<div class="line"><a name="l08319"></a><span class="lineno"> 8319</span>&#160;  <span class="comment">// Gather all final state particles collected for this frame</span></div>
<div class="line"><a name="l08320"></a><span class="lineno"> 8320</span>&#160;  TLorentzVector pTotal(0, 0, 0, 0);</div>
<div class="line"><a name="l08321"></a><span class="lineno"> 8321</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a> <span class="keyword">const</span>&amp; sp:<a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>) pTotal = pTotal + sp.second;</div>
<div class="line"><a name="l08322"></a><span class="lineno"> 8322</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a> <span class="keyword">const</span>&amp; sp:<a class="code" href="namespacemela.html#a79188ef3c30f518072a2d36f510a5655">associated</a>) pTotal = pTotal + sp.second;</div>
<div class="line"><a name="l08323"></a><span class="lineno"> 8323</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a> <span class="keyword">const</span>&amp; sp:stableTops) pTotal = pTotal + sp.second;</div>
<div class="line"><a name="l08324"></a><span class="lineno"> 8324</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a> <span class="keyword">const</span>&amp; sp:stableAntitops) pTotal = pTotal + sp.second;</div>
<div class="line"><a name="l08325"></a><span class="lineno"> 8325</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> <span class="keyword">const</span>&amp; spc:topDaughters){ <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a> <span class="keyword">const</span>&amp; sp:spc) pTotal = pTotal + sp.second; }</div>
<div class="line"><a name="l08326"></a><span class="lineno"> 8326</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a> <span class="keyword">const</span>&amp; spc:antitopDaughters){ <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a> <span class="keyword">const</span>&amp; sp:spc) pTotal = pTotal + sp.second; }</div>
<div class="line"><a name="l08327"></a><span class="lineno"> 8327</span>&#160; </div>
<div class="line"><a name="l08328"></a><span class="lineno"> 8328</span>&#160;  <span class="comment">// Get the boost vector and boost all final state particles</span></div>
<div class="line"><a name="l08329"></a><span class="lineno"> 8329</span>&#160;  <span class="keywordtype">double</span> qX = pTotal.X();</div>
<div class="line"><a name="l08330"></a><span class="lineno"> 8330</span>&#160;  <span class="keywordtype">double</span> qY = pTotal.Y();</div>
<div class="line"><a name="l08331"></a><span class="lineno"> 8331</span>&#160;  <span class="keywordtype">double</span> qE = pTotal.T();</div>
<div class="line"><a name="l08332"></a><span class="lineno"> 8332</span>&#160;  <span class="keywordflow">if</span> ((qX*qX+qY*qY)&gt;0.){</div>
<div class="line"><a name="l08333"></a><span class="lineno"> 8333</span>&#160;    TVector3 boostV(-qX/qE, -qY/qE, 0.);</div>
<div class="line"><a name="l08334"></a><span class="lineno"> 8334</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>&amp; sp:<a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>) sp.second.Boost(boostV);</div>
<div class="line"><a name="l08335"></a><span class="lineno"> 8335</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>&amp; sp:<a class="code" href="namespacemela.html#a79188ef3c30f518072a2d36f510a5655">associated</a>) sp.second.Boost(boostV);</div>
<div class="line"><a name="l08336"></a><span class="lineno"> 8336</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>&amp; sp:stableTops) sp.second.Boost(boostV);</div>
<div class="line"><a name="l08337"></a><span class="lineno"> 8337</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>&amp; sp:stableAntitops) sp.second.Boost(boostV);</div>
<div class="line"><a name="l08338"></a><span class="lineno"> 8338</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a>&amp; spc:topDaughters){ <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>&amp; sp:spc) sp.second.Boost(boostV); }</div>
<div class="line"><a name="l08339"></a><span class="lineno"> 8339</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a>&amp; spc:antitopDaughters){ <span class="keywordflow">for</span> (<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>&amp; sp:spc) sp.second.Boost(boostV); }</div>
<div class="line"><a name="l08340"></a><span class="lineno"> 8340</span>&#160;    pTotal.Boost(boostV);</div>
<div class="line"><a name="l08341"></a><span class="lineno"> 8341</span>&#160;  }</div>
<div class="line"><a name="l08342"></a><span class="lineno"> 8342</span>&#160; </div>
<div class="line"><a name="l08343"></a><span class="lineno"> 8343</span>&#160;  <span class="comment">// Mothers need special treatment:</span></div>
<div class="line"><a name="l08344"></a><span class="lineno"> 8344</span>&#160;  <span class="comment">// In case they are undefined, mother id is unknown, and mothers are ordered as M1==(pz&gt;0) and M2==(pz&lt;0).</span></div>
<div class="line"><a name="l08345"></a><span class="lineno"> 8345</span>&#160;  <span class="comment">// In case they are defined, mothers are first matched to the assumed momenta through their pz&#39;s.</span></div>
<div class="line"><a name="l08346"></a><span class="lineno"> 8346</span>&#160;  <span class="comment">// They are ordered by M1==f, M2==fb afterward if this is possible.</span></div>
<div class="line"><a name="l08347"></a><span class="lineno"> 8347</span>&#160;  <span class="comment">// Notice that the momenta of the mother objects are not actually used. If the event is truly a gen. particle, everything would be in the pT=0 frame to begin with, and everybody is happy in reweighting.</span></div>
<div class="line"><a name="l08348"></a><span class="lineno"> 8348</span>&#160;  <span class="keywordtype">double</span> sysPz= pTotal.Z();</div>
<div class="line"><a name="l08349"></a><span class="lineno"> 8349</span>&#160;  <span class="keywordtype">double</span> sysE = pTotal.T();</div>
<div class="line"><a name="l08350"></a><span class="lineno"> 8350</span>&#160;  <span class="keywordtype">double</span> pz0 = (sysE+sysPz)/2.;</div>
<div class="line"><a name="l08351"></a><span class="lineno"> 8351</span>&#160;  <span class="keywordtype">double</span> pz1 = -(sysE-sysPz)/2.;</div>
<div class="line"><a name="l08352"></a><span class="lineno"> 8352</span>&#160;  <span class="keywordtype">double</span> E0 = pz0;</div>
<div class="line"><a name="l08353"></a><span class="lineno"> 8353</span>&#160;  <span class="keywordtype">double</span> E1 = -pz1;</div>
<div class="line"><a name="l08354"></a><span class="lineno"> 8354</span>&#160;  <span class="keywordtype">int</span> motherId[2]={ 0, 0 };</div>
<div class="line"><a name="l08355"></a><span class="lineno"> 8355</span>&#160;  <span class="keywordflow">if</span> (melaCand-&gt;<a class="code" href="classMELAParticle.html#a793d2d9fbebea5e9a0a7b7c3205d4d43">getNMothers</a>()==2){</div>
<div class="line"><a name="l08356"></a><span class="lineno"> 8356</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip=0; ip&lt;2; ip++) motherId[ip]=melaCand-&gt;<a class="code" href="classMELAParticle.html#afca775f013fab57b11b4e586df949236">getMother</a>(ip)-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>;</div>
<div class="line"><a name="l08357"></a><span class="lineno"> 8357</span>&#160;    <span class="comment">// Match the &quot;assumed&quot; M&#39;1==(larger signed pz) and M&#39;2==(smaller signed pz) to the pz of the actual mothers:</span></div>
<div class="line"><a name="l08358"></a><span class="lineno"> 8358</span>&#160;    <span class="comment">// Swap pZs to get the correct momentum matching default M1, M2.</span></div>
<div class="line"><a name="l08359"></a><span class="lineno"> 8359</span>&#160;    <span class="keywordflow">if</span> (TMath::Sign(1., melaCand-&gt;<a class="code" href="classMELAParticle.html#afca775f013fab57b11b4e586df949236">getMother</a>(0)-&gt;<a class="code" href="classMELAParticle.html#a681ce5a5168b0ec3e210e9fc4894cebf">z</a>()-melaCand-&gt;<a class="code" href="classMELAParticle.html#afca775f013fab57b11b4e586df949236">getMother</a>(1)-&gt;<a class="code" href="classMELAParticle.html#a681ce5a5168b0ec3e210e9fc4894cebf">z</a>())!=TMath::Sign(1., pz0-pz1)){ swap(pz0, pz1); swap(E0, E1); }</div>
<div class="line"><a name="l08360"></a><span class="lineno"> 8360</span>&#160;    <span class="comment">// Swap the ids of mothers and their pT=0-assumed momenta to achieve ordering as &quot;incoming&quot; q-qbar</span></div>
<div class="line"><a name="l08361"></a><span class="lineno"> 8361</span>&#160;    <span class="keywordflow">if</span> ((motherId[0]&lt;0 &amp;&amp; motherId[1]&gt;=0) || (motherId[1]&gt;0 &amp;&amp; motherId[0]&lt;=0)){</div>
<div class="line"><a name="l08362"></a><span class="lineno"> 8362</span>&#160;      swap(pz0, pz1);</div>
<div class="line"><a name="l08363"></a><span class="lineno"> 8363</span>&#160;      swap(E0, E1);</div>
<div class="line"><a name="l08364"></a><span class="lineno"> 8364</span>&#160;      swap(motherId[0], motherId[1]);</div>
<div class="line"><a name="l08365"></a><span class="lineno"> 8365</span>&#160;    }</div>
<div class="line"><a name="l08366"></a><span class="lineno"> 8366</span>&#160;  }</div>
<div class="line"><a name="l08367"></a><span class="lineno"> 8367</span>&#160;  TLorentzVector pM[2];</div>
<div class="line"><a name="l08368"></a><span class="lineno"> 8368</span>&#160;  pM[0].SetXYZT(0., 0., pz0, E0);</div>
<div class="line"><a name="l08369"></a><span class="lineno"> 8369</span>&#160;  pM[1].SetXYZT(0., 0., pz1, E1);</div>
<div class="line"><a name="l08370"></a><span class="lineno"> 8370</span>&#160; </div>
<div class="line"><a name="l08371"></a><span class="lineno"> 8371</span>&#160;  <span class="comment">// Fill the ids of the V intermediates to the candidate daughters</span></div>
<div class="line"><a name="l08372"></a><span class="lineno"> 8372</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.clear();</div>
<div class="line"><a name="l08373"></a><span class="lineno"> 8373</span>&#160;  <a class="code" href="namespaceTUtilHelpers.html#ad3d14e2f2ee73f5f85403a15b71895f3">TUtilHelpers::copyVector</a>(idVstar, mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>);</div>
<div class="line"><a name="l08374"></a><span class="lineno"> 8374</span>&#160;  <span class="comment">// Fill the mothers</span></div>
<div class="line"><a name="l08375"></a><span class="lineno"> 8375</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.clear();</div>
<div class="line"><a name="l08376"></a><span class="lineno"> 8376</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;2; ip++){ mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.push_back(<a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>(motherId[ip], pM[ip])); }</div>
<div class="line"><a name="l08377"></a><span class="lineno"> 8377</span>&#160;  <span class="comment">// Fill the daughters</span></div>
<div class="line"><a name="l08378"></a><span class="lineno"> 8378</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.clear();</div>
<div class="line"><a name="l08379"></a><span class="lineno"> 8379</span>&#160;  <a class="code" href="namespaceTUtilHelpers.html#ad3d14e2f2ee73f5f85403a15b71895f3">TUtilHelpers::copyVector</a>(<a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>, mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>);</div>
<div class="line"><a name="l08380"></a><span class="lineno"> 8380</span>&#160;  <span class="comment">// Fill the associated particles</span></div>
<div class="line"><a name="l08381"></a><span class="lineno"> 8381</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.clear();</div>
<div class="line"><a name="l08382"></a><span class="lineno"> 8382</span>&#160;  <a class="code" href="namespaceTUtilHelpers.html#ad3d14e2f2ee73f5f85403a15b71895f3">TUtilHelpers::copyVector</a>(<a class="code" href="namespacemela.html#a79188ef3c30f518072a2d36f510a5655">associated</a>, mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>);</div>
<div class="line"><a name="l08383"></a><span class="lineno"> 8383</span>&#160;  <span class="comment">// Fill the stable tops and antitops</span></div>
<div class="line"><a name="l08384"></a><span class="lineno"> 8384</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a2261821b9391dd5f9e8f19f7c225212e">pStableTops</a>.clear();</div>
<div class="line"><a name="l08385"></a><span class="lineno"> 8385</span>&#160;  <a class="code" href="namespaceTUtilHelpers.html#ad3d14e2f2ee73f5f85403a15b71895f3">TUtilHelpers::copyVector</a>(stableTops, mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a2261821b9391dd5f9e8f19f7c225212e">pStableTops</a>);</div>
<div class="line"><a name="l08386"></a><span class="lineno"> 8386</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a1f9fa9f2c882417f3de782dce28a5840">pStableAntitops</a>.clear();</div>
<div class="line"><a name="l08387"></a><span class="lineno"> 8387</span>&#160;  <a class="code" href="namespaceTUtilHelpers.html#ad3d14e2f2ee73f5f85403a15b71895f3">TUtilHelpers::copyVector</a>(stableAntitops, mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a1f9fa9f2c882417f3de782dce28a5840">pStableAntitops</a>);</div>
<div class="line"><a name="l08388"></a><span class="lineno"> 8388</span>&#160;  <span class="comment">// Fill the daughters of unstable tops and antitops</span></div>
<div class="line"><a name="l08389"></a><span class="lineno"> 8389</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aa83c10b512e0f7e778dddf8a969fbfe6">pTopDaughters</a>.clear();</div>
<div class="line"><a name="l08390"></a><span class="lineno"> 8390</span>&#160;  <a class="code" href="namespaceTUtilHelpers.html#ad3d14e2f2ee73f5f85403a15b71895f3">TUtilHelpers::copyVector</a>(topDaughters, mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aa83c10b512e0f7e778dddf8a969fbfe6">pTopDaughters</a>);</div>
<div class="line"><a name="l08391"></a><span class="lineno"> 8391</span>&#160;  mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#ab39f490ca0e69323fbbdbabfcb394306">pAntitopDaughters</a>.clear();</div>
<div class="line"><a name="l08392"></a><span class="lineno"> 8392</span>&#160;  <a class="code" href="namespaceTUtilHelpers.html#ad3d14e2f2ee73f5f85403a15b71895f3">TUtilHelpers::copyVector</a>(antitopDaughters, mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#ab39f490ca0e69323fbbdbabfcb394306">pAntitopDaughters</a>);</div>
<div class="line"><a name="l08393"></a><span class="lineno"> 8393</span>&#160; </div>
<div class="line"><a name="l08394"></a><span class="lineno"> 8394</span>&#160;  <span class="comment">// This is the end of one long function.</span></div>
<div class="line"><a name="l08395"></a><span class="lineno"> 8395</span>&#160;  <span class="keywordflow">if</span> (verbosity&gt;=<a class="code" href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a>){</div>
<div class="line"><a name="l08396"></a><span class="lineno"> 8396</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors mela_event.intermediateVid.size=&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08397"></a><span class="lineno"> 8397</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors mela_event.pMothers.size=&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08398"></a><span class="lineno"> 8398</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors mela_event.pDaughters.size=&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08399"></a><span class="lineno"> 8399</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors mela_event.pAssociated.size=&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08400"></a><span class="lineno"> 8400</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors mela_event.pStableTops.size=&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a2261821b9391dd5f9e8f19f7c225212e">pStableTops</a>.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08401"></a><span class="lineno"> 8401</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors mela_event.pStableAntitops.size=&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#a1f9fa9f2c882417f3de782dce28a5840">pStableAntitops</a>.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08402"></a><span class="lineno"> 8402</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors mela_event.pTopDaughters.size=&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#aa83c10b512e0f7e778dddf8a969fbfe6">pTopDaughters</a>.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08403"></a><span class="lineno"> 8403</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::GetBoostedParticleVectors mela_event.pAntitopDaughters.size=&quot;</span> &lt;&lt; mela_event.<a class="code" href="structTVar_1_1simple__event__record.html#ab39f490ca0e69323fbbdbabfcb394306">pAntitopDaughters</a>.size() &lt;&lt; endl;</div>
<div class="line"><a name="l08404"></a><span class="lineno"> 8404</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;End GetBoostedParticleVectors&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08405"></a><span class="lineno"> 8405</span>&#160;  }</div>
<div class="line"><a name="l08406"></a><span class="lineno"> 8406</span>&#160;}</div>
<div class="line"><a name="l08407"></a><span class="lineno"> 8407</span>&#160; </div>
<div class="line"><a name="l08408"></a><span class="lineno"> 8408</span>&#160;<span class="comment">// Convert vectors of simple particles to MELAParticles and create a MELACandidate</span></div>
<div class="line"><a name="l08409"></a><span class="lineno"> 8409</span>&#160;<span class="comment">// The output lists could be members of TEvtProb directly.</span></div>
<div class="line"><a name="l08410"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#accabe530df4828c083abd7ea98bf5da2"> 8410</a></span>&#160;<a class="code" href="classMELACandidate.html">MELACandidate</a>* <a class="code" href="namespaceTUtil.html#accabe530df4828c083abd7ea98bf5da2">TUtil::ConvertVectorFormat</a>(</div>
<div class="line"><a name="l08411"></a><span class="lineno"> 8411</span>&#160;  <span class="comment">// Inputs</span></div>
<div class="line"><a name="l08412"></a><span class="lineno"> 8412</span>&#160;  <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a>* pDaughters,</div>
<div class="line"><a name="l08413"></a><span class="lineno"> 8413</span>&#160;  <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a>* pAssociated,</div>
<div class="line"><a name="l08414"></a><span class="lineno"> 8414</span>&#160;  <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a>* pMothers,</div>
<div class="line"><a name="l08415"></a><span class="lineno"> 8415</span>&#160;  <span class="keywordtype">bool</span> isGen,</div>
<div class="line"><a name="l08416"></a><span class="lineno"> 8416</span>&#160;  <span class="comment">// Outputs</span></div>
<div class="line"><a name="l08417"></a><span class="lineno"> 8417</span>&#160;  std::vector&lt;MELAParticle*&gt;* particleList,</div>
<div class="line"><a name="l08418"></a><span class="lineno"> 8418</span>&#160;  std::vector&lt;MELACandidate*&gt;* candList</div>
<div class="line"><a name="l08419"></a><span class="lineno"> 8419</span>&#160;  ){</div>
<div class="line"><a name="l08420"></a><span class="lineno"> 8420</span>&#160;  <a class="code" href="classMELACandidate.html">MELACandidate</a>* cand=<span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l08421"></a><span class="lineno"> 8421</span>&#160; </div>
<div class="line"><a name="l08422"></a><span class="lineno"> 8422</span>&#160;  <span class="keywordflow">if</span> (!pDaughters){ <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::ConvertVectorFormat: No daughters!&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> cand; }</div>
<div class="line"><a name="l08423"></a><span class="lineno"> 8423</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pDaughters-&gt;size()==0){ <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::ConvertVectorFormat: Daughter size==0!&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> cand; }</div>
<div class="line"><a name="l08424"></a><span class="lineno"> 8424</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pDaughters-&gt;size()&gt;4){ <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::ConvertVectorFormat: Daughter size &quot;</span> &lt;&lt; pDaughters-&gt;size() &lt;&lt; <span class="stringliteral">&quot;&gt;4 is not supported!&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> cand; }</div>
<div class="line"><a name="l08425"></a><span class="lineno"> 8425</span>&#160;  <span class="keywordflow">if</span> (pMothers &amp;&amp; pMothers-&gt;size()!=2){ <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::ConvertVectorFormat: Mothers momentum size (&quot;</span> &lt;&lt; pMothers-&gt;size() &lt;&lt; <span class="stringliteral">&quot;) has to have had been 2! Continuing by omitting mothers.&quot;</span> &lt;&lt; endl; <span class="comment">/*return cand;*/</span> }</div>
<div class="line"><a name="l08426"></a><span class="lineno"> 8426</span>&#160; </div>
<div class="line"><a name="l08427"></a><span class="lineno"> 8427</span>&#160;  <span class="comment">// Create mother, daughter and associated particle MELAParticle objects</span></div>
<div class="line"><a name="l08428"></a><span class="lineno"> 8428</span>&#160;  std::vector&lt;MELAParticle*&gt; <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>;</div>
<div class="line"><a name="l08429"></a><span class="lineno"> 8429</span>&#160;  std::vector&lt;MELAParticle*&gt; aparticles;</div>
<div class="line"><a name="l08430"></a><span class="lineno"> 8430</span>&#160;  std::vector&lt;MELAParticle*&gt; <a class="code" href="namespacemela.html#aed44237203997859afcf9aa344bff4af">mothers</a>;</div>
<div class="line"><a name="l08431"></a><span class="lineno"> 8431</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; spart:(*pDaughters)){</div>
<div class="line"><a name="l08432"></a><span class="lineno"> 8432</span>&#160;    <a class="code" href="classMELAParticle.html">MELAParticle</a>* onePart = <span class="keyword">new</span> <a class="code" href="classMELAParticle.html">MELAParticle</a>(spart.first, spart.second);</div>
<div class="line"><a name="l08433"></a><span class="lineno"> 8433</span>&#160;    onePart-&gt;<a class="code" href="classMELAParticle.html#a4acf2bbd01994e54cd9514b8ce7d5c95">setGenStatus</a>(1); <span class="comment">// Final state status</span></div>
<div class="line"><a name="l08434"></a><span class="lineno"> 8434</span>&#160;    <span class="keywordflow">if</span> (particleList) particleList-&gt;push_back(onePart);</div>
<div class="line"><a name="l08435"></a><span class="lineno"> 8435</span>&#160;    <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.push_back(onePart);</div>
<div class="line"><a name="l08436"></a><span class="lineno"> 8436</span>&#160;  }</div>
<div class="line"><a name="l08437"></a><span class="lineno"> 8437</span>&#160;  <span class="keywordflow">if</span> (pAssociated){</div>
<div class="line"><a name="l08438"></a><span class="lineno"> 8438</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; spart:(*pAssociated)){</div>
<div class="line"><a name="l08439"></a><span class="lineno"> 8439</span>&#160;      <a class="code" href="classMELAParticle.html">MELAParticle</a>* onePart = <span class="keyword">new</span> <a class="code" href="classMELAParticle.html">MELAParticle</a>(spart.first, spart.second);</div>
<div class="line"><a name="l08440"></a><span class="lineno"> 8440</span>&#160;      onePart-&gt;<a class="code" href="classMELAParticle.html#a4acf2bbd01994e54cd9514b8ce7d5c95">setGenStatus</a>(1); <span class="comment">// Final state status</span></div>
<div class="line"><a name="l08441"></a><span class="lineno"> 8441</span>&#160;      <span class="keywordflow">if</span> (particleList) particleList-&gt;push_back(onePart);</div>
<div class="line"><a name="l08442"></a><span class="lineno"> 8442</span>&#160;      aparticles.push_back(onePart);</div>
<div class="line"><a name="l08443"></a><span class="lineno"> 8443</span>&#160;    }</div>
<div class="line"><a name="l08444"></a><span class="lineno"> 8444</span>&#160;  }</div>
<div class="line"><a name="l08445"></a><span class="lineno"> 8445</span>&#160;  <span class="keywordflow">if</span> (pMothers &amp;&amp; pMothers-&gt;size()==2){</div>
<div class="line"><a name="l08446"></a><span class="lineno"> 8446</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; spart:(*pMothers)){</div>
<div class="line"><a name="l08447"></a><span class="lineno"> 8447</span>&#160;      <a class="code" href="classMELAParticle.html">MELAParticle</a>* onePart = <span class="keyword">new</span> <a class="code" href="classMELAParticle.html">MELAParticle</a>(spart.first, spart.second);</div>
<div class="line"><a name="l08448"></a><span class="lineno"> 8448</span>&#160;      onePart-&gt;<a class="code" href="classMELAParticle.html#a4acf2bbd01994e54cd9514b8ce7d5c95">setGenStatus</a>(-1); <span class="comment">// Mother status</span></div>
<div class="line"><a name="l08449"></a><span class="lineno"> 8449</span>&#160;      <span class="keywordflow">if</span> (particleList) particleList-&gt;push_back(onePart);</div>
<div class="line"><a name="l08450"></a><span class="lineno"> 8450</span>&#160;      <a class="code" href="namespacemela.html#aed44237203997859afcf9aa344bff4af">mothers</a>.push_back(onePart);</div>
<div class="line"><a name="l08451"></a><span class="lineno"> 8451</span>&#160;    }</div>
<div class="line"><a name="l08452"></a><span class="lineno"> 8452</span>&#160;  }</div>
<div class="line"><a name="l08453"></a><span class="lineno"> 8453</span>&#160; </div>
<div class="line"><a name="l08454"></a><span class="lineno"> 8454</span>&#160;  <span class="comment">// Create the candidate</span></div>
<div class="line"><a name="l08455"></a><span class="lineno"> 8455</span>&#160;<span class="comment">  /***** Adaptation of LHEAnalyzer::Event::constructVVCandidates *****/</span></div>
<div class="line"><a name="l08456"></a><span class="lineno"> 8456</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l08457"></a><span class="lineno"> 8457</span>&#160;<span class="comment">  The assumption is that the daughters make sense for either ffb, gamgam, Zgam, ZZ or WW.</span></div>
<div class="line"><a name="l08458"></a><span class="lineno"> 8458</span>&#160;<span class="comment">  No checking is done on whether particle-antiparticle pairing is correct when necessary.</span></div>
<div class="line"><a name="l08459"></a><span class="lineno"> 8459</span>&#160;<span class="comment">  If not, you will get a seg. fault!</span></div>
<div class="line"><a name="l08460"></a><span class="lineno"> 8460</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l08461"></a><span class="lineno"> 8461</span>&#160; </div>
<div class="line"><a name="l08462"></a><span class="lineno"> 8462</span>&#160;  <span class="comment">// Undecayed Higgs</span></div>
<div class="line"><a name="l08463"></a><span class="lineno"> 8463</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.size()==1){</div>
<div class="line"><a name="l08464"></a><span class="lineno"> 8464</span>&#160;    cand = <span class="keyword">new</span> <a class="code" href="classMELACandidate.html">MELACandidate</a>(25, (<a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(0))-&gt;p4); <span class="comment">// No sorting!</span></div>
<div class="line"><a name="l08465"></a><span class="lineno"> 8465</span>&#160;    cand-&gt;<a class="code" href="classMELACandidate.html#abcae02e1f9b8f920878d436c42a1a685">setDecayMode</a>(<a class="code" href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4a309d83a82eccce4e136622efb4b6271f">TVar::CandidateDecay_Stable</a>); <span class="comment">// Explicitly set the decay mode in case the default of MELACandidate changes in the future</span></div>
<div class="line"><a name="l08466"></a><span class="lineno"> 8466</span>&#160;  }</div>
<div class="line"><a name="l08467"></a><span class="lineno"> 8467</span>&#160;  <span class="comment">// GG / ff final states</span></div>
<div class="line"><a name="l08468"></a><span class="lineno"> 8468</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.size()==2){</div>
<div class="line"><a name="l08469"></a><span class="lineno"> 8469</span>&#160;    <a class="code" href="classMELAParticle.html">MELAParticle</a>* F1 = <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(0);</div>
<div class="line"><a name="l08470"></a><span class="lineno"> 8470</span>&#160;    <a class="code" href="classMELAParticle.html">MELAParticle</a>* F2 = <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(1);</div>
<div class="line"><a name="l08471"></a><span class="lineno"> 8471</span>&#160;    TLorentzVector pH = F1-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>+F2-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>;</div>
<div class="line"><a name="l08472"></a><span class="lineno"> 8472</span>&#160;    cand = <span class="keyword">new</span> <a class="code" href="classMELACandidate.html">MELACandidate</a>(25, pH);</div>
<div class="line"><a name="l08473"></a><span class="lineno"> 8473</span>&#160;    cand-&gt;<a class="code" href="classMELAParticle.html#a555dda1d36e3cf9801de88ad38a6c6de">addDaughter</a>(F1);</div>
<div class="line"><a name="l08474"></a><span class="lineno"> 8474</span>&#160;    cand-&gt;<a class="code" href="classMELAParticle.html#a555dda1d36e3cf9801de88ad38a6c6de">addDaughter</a>(F2);</div>
<div class="line"><a name="l08475"></a><span class="lineno"> 8475</span>&#160;    <a class="code" href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4">TVar::CandidateDecayMode</a> defaultHDecayMode = <a class="code" href="namespacePDGHelpers.html#ad093a6206d20114f4716a631777a93ff">PDGHelpers::HDecayMode</a>;</div>
<div class="line"><a name="l08476"></a><span class="lineno"> 8476</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(F1-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>) &amp;&amp; <a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(F2-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>)) <a class="code" href="namespacePDGHelpers.html#af92acaa64c96e22a6dca8b60076a40ec">PDGHelpers::setCandidateDecayMode</a>(<a class="code" href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4abb1917a08ff9507cf02938700ad23d7a">TVar::CandidateDecay_GG</a>);</div>
<div class="line"><a name="l08477"></a><span class="lineno"> 8477</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="namespacePDGHelpers.html#af92acaa64c96e22a6dca8b60076a40ec">PDGHelpers::setCandidateDecayMode</a>(<a class="code" href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4abf438fbd5ea78acf6ed796714b309583">TVar::CandidateDecay_ff</a>);</div>
<div class="line"><a name="l08478"></a><span class="lineno"> 8478</span>&#160;    cand-&gt;<a class="code" href="classMELACandidate.html#a85ab0d1d29d443ea8fa3957e7262e57e">sortDaughters</a>();</div>
<div class="line"><a name="l08479"></a><span class="lineno"> 8479</span>&#160;    <a class="code" href="namespacePDGHelpers.html#af92acaa64c96e22a6dca8b60076a40ec">PDGHelpers::setCandidateDecayMode</a>(defaultHDecayMode);</div>
<div class="line"><a name="l08480"></a><span class="lineno"> 8480</span>&#160;  }</div>
<div class="line"><a name="l08481"></a><span class="lineno"> 8481</span>&#160;  <span class="comment">// ZG / WG</span></div>
<div class="line"><a name="l08482"></a><span class="lineno"> 8482</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.size()==3){</div>
<div class="line"><a name="l08483"></a><span class="lineno"> 8483</span>&#160;    <a class="code" href="classMELAParticle.html">MELAParticle</a>* F1 = <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(0);</div>
<div class="line"><a name="l08484"></a><span class="lineno"> 8484</span>&#160;    <a class="code" href="classMELAParticle.html">MELAParticle</a>* F2 = <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(1);</div>
<div class="line"><a name="l08485"></a><span class="lineno"> 8485</span>&#160;    <a class="code" href="classMELAParticle.html">MELAParticle</a>* gamma = <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(2);</div>
<div class="line"><a name="l08486"></a><span class="lineno"> 8486</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(F1-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>)){</div>
<div class="line"><a name="l08487"></a><span class="lineno"> 8487</span>&#160;      <a class="code" href="classMELAParticle.html">MELAParticle</a>* tmp = F1;</div>
<div class="line"><a name="l08488"></a><span class="lineno"> 8488</span>&#160;      F1 = gamma;</div>
<div class="line"><a name="l08489"></a><span class="lineno"> 8489</span>&#160;      gamma = tmp;</div>
<div class="line"><a name="l08490"></a><span class="lineno"> 8490</span>&#160;    }</div>
<div class="line"><a name="l08491"></a><span class="lineno"> 8491</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(F2-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>)){</div>
<div class="line"><a name="l08492"></a><span class="lineno"> 8492</span>&#160;      <a class="code" href="classMELAParticle.html">MELAParticle</a>* tmp = F2;</div>
<div class="line"><a name="l08493"></a><span class="lineno"> 8493</span>&#160;      F2 = gamma;</div>
<div class="line"><a name="l08494"></a><span class="lineno"> 8494</span>&#160;      gamma = tmp;</div>
<div class="line"><a name="l08495"></a><span class="lineno"> 8495</span>&#160;    }</div>
<div class="line"><a name="l08496"></a><span class="lineno"> 8496</span>&#160;    TLorentzVector pH = F1-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>+F2-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>+gamma-&gt;<a class="code" href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">p4</a>;</div>
<div class="line"><a name="l08497"></a><span class="lineno"> 8497</span>&#160;    <span class="keywordtype">double</span> charge = F1-&gt;<a class="code" href="classMELAParticle.html#a4766d9d6fec92de6a5ea19bdc745c460">charge</a>()+F2-&gt;<a class="code" href="classMELAParticle.html#a4766d9d6fec92de6a5ea19bdc745c460">charge</a>()+gamma-&gt;<a class="code" href="classMELAParticle.html#a4766d9d6fec92de6a5ea19bdc745c460">charge</a>();</div>
<div class="line"><a name="l08498"></a><span class="lineno"> 8498</span>&#160;    cand = <span class="keyword">new</span> <a class="code" href="classMELACandidate.html">MELACandidate</a>(25, pH);</div>
<div class="line"><a name="l08499"></a><span class="lineno"> 8499</span>&#160;    cand-&gt;<a class="code" href="classMELAParticle.html#a555dda1d36e3cf9801de88ad38a6c6de">addDaughter</a>(F1);</div>
<div class="line"><a name="l08500"></a><span class="lineno"> 8500</span>&#160;    cand-&gt;<a class="code" href="classMELAParticle.html#a555dda1d36e3cf9801de88ad38a6c6de">addDaughter</a>(F2);</div>
<div class="line"><a name="l08501"></a><span class="lineno"> 8501</span>&#160;    cand-&gt;<a class="code" href="classMELAParticle.html#a555dda1d36e3cf9801de88ad38a6c6de">addDaughter</a>(gamma);</div>
<div class="line"><a name="l08502"></a><span class="lineno"> 8502</span>&#160;    <a class="code" href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4">TVar::CandidateDecayMode</a> defaultHDecayMode = <a class="code" href="namespacePDGHelpers.html#ad093a6206d20114f4716a631777a93ff">PDGHelpers::HDecayMode</a>;</div>
<div class="line"><a name="l08503"></a><span class="lineno"> 8503</span>&#160;    <span class="keywordflow">if</span> (fabs(charge)&lt;0.01) <a class="code" href="namespacePDGHelpers.html#af92acaa64c96e22a6dca8b60076a40ec">PDGHelpers::setCandidateDecayMode</a>(<a class="code" href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4af659c7d971f5ab1b23825efde3335ccf">TVar::CandidateDecay_ZG</a>); <span class="comment">// ZG</span></div>
<div class="line"><a name="l08504"></a><span class="lineno"> 8504</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="namespacePDGHelpers.html#af92acaa64c96e22a6dca8b60076a40ec">PDGHelpers::setCandidateDecayMode</a>(<a class="code" href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4aac6fd43f6de5b9ae55ebf0c6e8e11a8f">TVar::CandidateDecay_WG</a>); <span class="comment">// WG, un-tested</span></div>
<div class="line"><a name="l08505"></a><span class="lineno"> 8505</span>&#160;    cand-&gt;<a class="code" href="classMELACandidate.html#a85ab0d1d29d443ea8fa3957e7262e57e">sortDaughters</a>();</div>
<div class="line"><a name="l08506"></a><span class="lineno"> 8506</span>&#160;    <a class="code" href="namespacePDGHelpers.html#af92acaa64c96e22a6dca8b60076a40ec">PDGHelpers::setCandidateDecayMode</a>(defaultHDecayMode);</div>
<div class="line"><a name="l08507"></a><span class="lineno"> 8507</span>&#160;  }</div>
<div class="line"><a name="l08508"></a><span class="lineno"> 8508</span>&#160;  <span class="comment">// ZZ / WW / ZW (!)</span></div>
<div class="line"><a name="l08509"></a><span class="lineno"> 8509</span>&#160;  <span class="keywordflow">else</span><span class="comment">/* if (daughters.size()==4)*/</span>{</div>
<div class="line"><a name="l08510"></a><span class="lineno"> 8510</span>&#160;    TLorentzVector pH(0, 0, 0, 0);</div>
<div class="line"><a name="l08511"></a><span class="lineno"> 8511</span>&#160;    <span class="keywordtype">double</span> charge = 0.;</div>
<div class="line"><a name="l08512"></a><span class="lineno"> 8512</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ip=0; ip&lt;4; ip++){ pH = pH + (<a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(ip))-&gt;p4; charge += (<a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(ip))-&gt;charge(); }</div>
<div class="line"><a name="l08513"></a><span class="lineno"> 8513</span>&#160;    cand = <span class="keyword">new</span> <a class="code" href="classMELACandidate.html">MELACandidate</a>(25, pH);</div>
<div class="line"><a name="l08514"></a><span class="lineno"> 8514</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ip=0; ip&lt;4; ip++) cand-&gt;<a class="code" href="classMELAParticle.html#a555dda1d36e3cf9801de88ad38a6c6de">addDaughter</a>(<a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.at(ip));</div>
<div class="line"><a name="l08515"></a><span class="lineno"> 8515</span>&#160;    <span class="comment">// FIXME/REIMPLEMENT: ZW trickier than I thought: Summing over charges over all 4f is not enough, affects SSSF pairing in ZZ</span></div>
<div class="line"><a name="l08516"></a><span class="lineno"> 8516</span>&#160;    <span class="comment">//TVar::CandidateDecayMode defaultHDecayMode = PDGHelpers::HDecayMode;</span></div>
<div class="line"><a name="l08517"></a><span class="lineno"> 8517</span>&#160;    <span class="comment">//if (fabs(charge)&gt;0.01) PDGHelpers::setCandidateDecayMode(TVar::CandidateDecay_ZW);</span></div>
<div class="line"><a name="l08518"></a><span class="lineno"> 8518</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l08519"></a><span class="lineno"> 8519</span>&#160;      <a class="code" href="namespacePDGHelpers.html#ad093a6206d20114f4716a631777a93ff">PDGHelpers::HDecayMode</a>!=<a class="code" href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4a772474648ce9adde8a9266b2de923dcb">TVar::CandidateDecay_WW</a></div>
<div class="line"><a name="l08520"></a><span class="lineno"> 8520</span>&#160;      &amp;&amp; <a class="code" href="namespacePDGHelpers.html#ad093a6206d20114f4716a631777a93ff">PDGHelpers::HDecayMode</a>!=<a class="code" href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4ac0c27bc9239fab096f3b6efefd813036">TVar::CandidateDecay_ZZ</a></div>
<div class="line"><a name="l08521"></a><span class="lineno"> 8521</span>&#160;      &amp;&amp; <a class="code" href="namespacePDGHelpers.html#ad093a6206d20114f4716a631777a93ff">PDGHelpers::HDecayMode</a>!=<a class="code" href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4aa5f0b613a63c439258383fba8746376a">TVar::CandidateDecay_ZW</a></div>
<div class="line"><a name="l08522"></a><span class="lineno"> 8522</span>&#160;      ){</div>
<div class="line"><a name="l08523"></a><span class="lineno"> 8523</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::ConvertVectorFormat: PDGHelpers::HDecayMode = &quot;</span> &lt;&lt; <a class="code" href="namespacePDGHelpers.html#ad093a6206d20114f4716a631777a93ff">PDGHelpers::HDecayMode</a> &lt;&lt; <span class="stringliteral">&quot; is set incorrectly for Ndaughters=&quot;</span> &lt;&lt; <a class="code" href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">daughters</a>.size() &lt;&lt; <span class="stringliteral">&quot;. There is no automatic mechnism for this scenario. &quot;</span>;</div>
<div class="line"><a name="l08524"></a><span class="lineno"> 8524</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;Suggestion: Call PDGHelpers::setCandidateDecayMode(TVar::CandidateDecay_XY) before this call.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08525"></a><span class="lineno"> 8525</span>&#160;      assert(0);</div>
<div class="line"><a name="l08526"></a><span class="lineno"> 8526</span>&#160;    }</div>
<div class="line"><a name="l08527"></a><span class="lineno"> 8527</span>&#160;    cand-&gt;<a class="code" href="classMELACandidate.html#a85ab0d1d29d443ea8fa3957e7262e57e">sortDaughters</a>();</div>
<div class="line"><a name="l08528"></a><span class="lineno"> 8528</span>&#160;    <span class="comment">//PDGHelpers::setCandidateDecayMode(defaultHDecayMode);</span></div>
<div class="line"><a name="l08529"></a><span class="lineno"> 8529</span>&#160;  }</div>
<div class="line"><a name="l08530"></a><span class="lineno"> 8530</span>&#160; </div>
<div class="line"><a name="l08531"></a><span class="lineno"> 8531</span>&#160;<span class="comment">  /***** Adaptation of LHEAnalyzer::Event::addVVCandidateMother *****/</span></div>
<div class="line"><a name="l08532"></a><span class="lineno"> 8532</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacemela.html#aed44237203997859afcf9aa344bff4af">mothers</a>.empty()){ <span class="comment">// ==2</span></div>
<div class="line"><a name="l08533"></a><span class="lineno"> 8533</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; part:<a class="code" href="namespacemela.html#aed44237203997859afcf9aa344bff4af">mothers</a>) cand-&gt;<a class="code" href="classMELAParticle.html#a842ee69ede2f6fbdd62517bc4bcf8946">addMother</a>(part);</div>
<div class="line"><a name="l08534"></a><span class="lineno"> 8534</span>&#160;    <span class="keywordflow">if</span> (isGen) cand-&gt;<a class="code" href="classMELAParticle.html#a4acf2bbd01994e54cd9514b8ce7d5c95">setGenStatus</a>(-1); <span class="comment">// Candidate is a gen. particle!</span></div>
<div class="line"><a name="l08535"></a><span class="lineno"> 8535</span>&#160;  }</div>
<div class="line"><a name="l08536"></a><span class="lineno"> 8536</span>&#160;<span class="comment">  /***** Adaptation of LHEAnalyzer::Event::addVVCandidateAppendages *****/</span></div>
<div class="line"><a name="l08537"></a><span class="lineno"> 8537</span>&#160;  <span class="keywordflow">if</span> (!aparticles.empty()){</div>
<div class="line"><a name="l08538"></a><span class="lineno"> 8538</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; part:aparticles){</div>
<div class="line"><a name="l08539"></a><span class="lineno"> 8539</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; partId = part-&gt;id;</div>
<div class="line"><a name="l08540"></a><span class="lineno"> 8540</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a6f98f45dbd53233287193ec3fe987746">PDGHelpers::isALepton</a>(partId)) cand-&gt;<a class="code" href="classMELACandidate.html#a349e3a335ea7e75dbbee3d558c6aa2c3">addAssociatedLepton</a>(part);</div>
<div class="line"><a name="l08541"></a><span class="lineno"> 8541</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a68ffb179226737e2006fb7b0870dae6a">PDGHelpers::isANeutrino</a>(partId)) cand-&gt;<a class="code" href="classMELACandidate.html#ade6ff983fa4cd82b8c1102ed1688d985">addAssociatedNeutrino</a>(part); <span class="comment">// Be careful: Neutrinos are neutrinos, but also &quot;leptons&quot; in MELACandidate!</span></div>
<div class="line"><a name="l08542"></a><span class="lineno"> 8542</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a>(partId)) cand-&gt;<a class="code" href="classMELACandidate.html#a3debcffc164edcc882df3cc60fbb059d">addAssociatedPhoton</a>(part);</div>
<div class="line"><a name="l08543"></a><span class="lineno"> 8543</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a>(partId)) cand-&gt;<a class="code" href="classMELACandidate.html#a2b0f61b5ae35b253e222278710e40e06">addAssociatedJet</a>(part);</div>
<div class="line"><a name="l08544"></a><span class="lineno"> 8544</span>&#160;    }</div>
<div class="line"><a name="l08545"></a><span class="lineno"> 8545</span>&#160;    cand-&gt;<a class="code" href="classMELACandidate.html#a2bc7e8b045eea81dcf096502f8079d45">addAssociatedVs</a>(); <span class="comment">// For the VH topology</span></div>
<div class="line"><a name="l08546"></a><span class="lineno"> 8546</span>&#160;  }</div>
<div class="line"><a name="l08547"></a><span class="lineno"> 8547</span>&#160; </div>
<div class="line"><a name="l08548"></a><span class="lineno"> 8548</span>&#160;  <span class="keywordflow">if</span> (candList &amp;&amp; cand) candList-&gt;push_back(cand);</div>
<div class="line"><a name="l08549"></a><span class="lineno"> 8549</span>&#160;  <span class="keywordflow">return</span> cand;</div>
<div class="line"><a name="l08550"></a><span class="lineno"> 8550</span>&#160;}</div>
<div class="line"><a name="l08551"></a><span class="lineno"> 8551</span>&#160; </div>
<div class="line"><a name="l08552"></a><span class="lineno"> 8552</span>&#160;<span class="comment">// Convert the vector of three body decay daughters (as simple particles) to MELAParticles and create a MELAThreeBodyDecayCandidate</span></div>
<div class="line"><a name="l08553"></a><span class="lineno"> 8553</span>&#160;<span class="comment">// The output lists could be members of TEvtProb directly.</span></div>
<div class="line"><a name="l08554"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a34005f7891c27c535153be4ab35211f0"> 8554</a></span>&#160;<a class="code" href="classMELAThreeBodyDecayCandidate.html">MELAThreeBodyDecayCandidate</a>* <a class="code" href="namespaceTUtil.html#a34005f7891c27c535153be4ab35211f0">TUtil::ConvertThreeBodyDecayCandidate</a>(</div>
<div class="line"><a name="l08555"></a><span class="lineno"> 8555</span>&#160;  <span class="comment">// Input</span></div>
<div class="line"><a name="l08556"></a><span class="lineno"> 8556</span>&#160;  <a class="code" href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a>* tbdDaughters,</div>
<div class="line"><a name="l08557"></a><span class="lineno"> 8557</span>&#160;  <span class="comment">// Outputs</span></div>
<div class="line"><a name="l08558"></a><span class="lineno"> 8558</span>&#160;  std::vector&lt;MELAParticle*&gt;* particleList,</div>
<div class="line"><a name="l08559"></a><span class="lineno"> 8559</span>&#160;  std::vector&lt;MELAThreeBodyDecayCandidate*&gt;* tbdCandList</div>
<div class="line"><a name="l08560"></a><span class="lineno"> 8560</span>&#160;  ){</div>
<div class="line"><a name="l08561"></a><span class="lineno"> 8561</span>&#160;  <a class="code" href="classMELAThreeBodyDecayCandidate.html">MELAThreeBodyDecayCandidate</a>* cand=<span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l08562"></a><span class="lineno"> 8562</span>&#160; </div>
<div class="line"><a name="l08563"></a><span class="lineno"> 8563</span>&#160;  <span class="keywordflow">if</span> (!tbdDaughters){ <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::ConvertThreeBodyDecayCandidate: No daughters!&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> cand; }</div>
<div class="line"><a name="l08564"></a><span class="lineno"> 8564</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tbdDaughters-&gt;empty()){ <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::ConvertThreeBodyDecayCandidate: Daughter size==0!&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> cand; }</div>
<div class="line"><a name="l08565"></a><span class="lineno"> 8565</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!(tbdDaughters-&gt;size()==1 || tbdDaughters-&gt;size()==3)){ <a class="code" href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAerr</a> &lt;&lt; <span class="stringliteral">&quot;TUtil::ConvertThreeBodyDecayCandidate: Daughter size &quot;</span> &lt;&lt; tbdDaughters-&gt;size() &lt;&lt; <span class="stringliteral">&quot;!=1 or 3 is not supported!&quot;</span> &lt;&lt; endl; <span class="keywordflow">return</span> cand; }</div>
<div class="line"><a name="l08566"></a><span class="lineno"> 8566</span>&#160; </div>
<div class="line"><a name="l08567"></a><span class="lineno"> 8567</span>&#160;  <span class="keywordflow">if</span> (tbdDaughters-&gt;size()==1){</div>
<div class="line"><a name="l08568"></a><span class="lineno"> 8568</span>&#160;    <span class="keywordflow">if</span> (abs((tbdDaughters-&gt;at(0)).first)==6 || (tbdDaughters-&gt;at(0)).first==0){</div>
<div class="line"><a name="l08569"></a><span class="lineno"> 8569</span>&#160;      cand = <span class="keyword">new</span> <a class="code" href="classMELAThreeBodyDecayCandidate.html">MELAThreeBodyDecayCandidate</a>((tbdDaughters-&gt;at(0)).first, (tbdDaughters-&gt;at(0)).second);</div>
<div class="line"><a name="l08570"></a><span class="lineno"> 8570</span>&#160;      tbdCandList-&gt;push_back(cand);</div>
<div class="line"><a name="l08571"></a><span class="lineno"> 8571</span>&#160;    }</div>
<div class="line"><a name="l08572"></a><span class="lineno"> 8572</span>&#160;  }</div>
<div class="line"><a name="l08573"></a><span class="lineno"> 8573</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tbdDaughters-&gt;size()==3){</div>
<div class="line"><a name="l08574"></a><span class="lineno"> 8574</span>&#160;    <a class="code" href="classMELAParticle.html">MELAParticle</a>* partnerPart = <span class="keyword">new</span> <a class="code" href="classMELAParticle.html">MELAParticle</a>((tbdDaughters-&gt;at(0)).first, (tbdDaughters-&gt;at(0)).second);</div>
<div class="line"><a name="l08575"></a><span class="lineno"> 8575</span>&#160;    <a class="code" href="classMELAParticle.html">MELAParticle</a>* Wf = <span class="keyword">new</span> <a class="code" href="classMELAParticle.html">MELAParticle</a>((tbdDaughters-&gt;at(1)).first, (tbdDaughters-&gt;at(1)).second);</div>
<div class="line"><a name="l08576"></a><span class="lineno"> 8576</span>&#160;    <a class="code" href="classMELAParticle.html">MELAParticle</a>* Wfb = <span class="keyword">new</span> <a class="code" href="classMELAParticle.html">MELAParticle</a>((tbdDaughters-&gt;at(2)).first, (tbdDaughters-&gt;at(2)).second);</div>
<div class="line"><a name="l08577"></a><span class="lineno"> 8577</span>&#160; </div>
<div class="line"><a name="l08578"></a><span class="lineno"> 8578</span>&#160;    <span class="keywordflow">if</span> (Wf-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>&lt;0 || Wfb-&gt;<a class="code" href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">id</a>&gt;0) std::swap(Wf, Wfb);</div>
<div class="line"><a name="l08579"></a><span class="lineno"> 8579</span>&#160; </div>
<div class="line"><a name="l08580"></a><span class="lineno"> 8580</span>&#160;    particleList-&gt;push_back(partnerPart);</div>
<div class="line"><a name="l08581"></a><span class="lineno"> 8581</span>&#160;    particleList-&gt;push_back(Wf);</div>
<div class="line"><a name="l08582"></a><span class="lineno"> 8582</span>&#160;    particleList-&gt;push_back(Wfb);</div>
<div class="line"><a name="l08583"></a><span class="lineno"> 8583</span>&#160; </div>
<div class="line"><a name="l08584"></a><span class="lineno"> 8584</span>&#160;    cand = <span class="keyword">new</span> <a class="code" href="classMELAThreeBodyDecayCandidate.html">MELAThreeBodyDecayCandidate</a>(partnerPart, Wf, Wfb);</div>
<div class="line"><a name="l08585"></a><span class="lineno"> 8585</span>&#160;    tbdCandList-&gt;push_back(cand);</div>
<div class="line"><a name="l08586"></a><span class="lineno"> 8586</span>&#160;  }</div>
<div class="line"><a name="l08587"></a><span class="lineno"> 8587</span>&#160;  <span class="keywordflow">return</span> cand;</div>
<div class="line"><a name="l08588"></a><span class="lineno"> 8588</span>&#160;}</div>
<div class="line"><a name="l08589"></a><span class="lineno"> 8589</span>&#160; </div>
<div class="line"><a name="l08590"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a7f6ec9418811fe987c034629691182af"> 8590</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a7f6ec9418811fe987c034629691182af">TUtil::PrintCandidateSummary</a>(<a class="code" href="classMELACandidate.html">MELACandidate</a>* cand){</div>
<div class="line"><a name="l08591"></a><span class="lineno"> 8591</span>&#160;  <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;***** TUtil::PrintCandidateSummary *****&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08592"></a><span class="lineno"> 8592</span>&#160;  <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Candidate: &quot;</span> &lt;&lt; cand &lt;&lt; endl;</div>
<div class="line"><a name="l08593"></a><span class="lineno"> 8593</span>&#160;  <span class="keywordflow">if</span> (cand) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; *cand;</div>
<div class="line"><a name="l08594"></a><span class="lineno"> 8594</span>&#160;}</div>
<div class="line"><a name="l08595"></a><span class="lineno"> 8595</span>&#160; </div>
<div class="line"><a name="l08596"></a><span class="lineno"><a class="line" href="namespaceTUtil.html#a12cc275df4bf912ec19b38f3fbe936f0"> 8596</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceTUtil.html#a7f6ec9418811fe987c034629691182af">TUtil::PrintCandidateSummary</a>(<a class="code" href="structTVar_1_1simple__event__record.html">simple_event_record</a>* cand){</div>
<div class="line"><a name="l08597"></a><span class="lineno"> 8597</span>&#160;  <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;***** TUtil::PrintCandidateSummary (Simple Event Record) *****&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08598"></a><span class="lineno"> 8598</span>&#160;  <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;Candidate: &quot;</span> &lt;&lt; cand &lt;&lt; endl;</div>
<div class="line"><a name="l08599"></a><span class="lineno"> 8599</span>&#160;  <span class="keywordflow">if</span> (cand){</div>
<div class="line"><a name="l08600"></a><span class="lineno"> 8600</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tAssociationCode: &quot;</span> &lt;&lt; cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a743a8c341936dbaa10ce50a5b8d87eba">AssociationCode</a> &lt;&lt; endl;</div>
<div class="line"><a name="l08601"></a><span class="lineno"> 8601</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tAssociationVCompatibility: &quot;</span> &lt;&lt; cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a210cc509a3d155a23d69c94ea4558f87">AssociationVCompatibility</a> &lt;&lt; endl;</div>
<div class="line"><a name="l08602"></a><span class="lineno"> 8602</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tnRequested_AssociatedJets: &quot;</span> &lt;&lt; cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#aca54cfc4690b7f0ba78f5af03d0f1ddf">nRequested_AssociatedJets</a> &lt;&lt; endl;</div>
<div class="line"><a name="l08603"></a><span class="lineno"> 8603</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tnRequested_AssociatedLeptons: &quot;</span> &lt;&lt; cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a3051f9440dc00a0a74b80997e898a5f5">nRequested_AssociatedLeptons</a> &lt;&lt; endl;</div>
<div class="line"><a name="l08604"></a><span class="lineno"> 8604</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tnRequested_AssociatedPhotons: &quot;</span> &lt;&lt; cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a47e6f6d74f1c60d73e0328d299467b4e">nRequested_AssociatedPhotons</a> &lt;&lt; endl;</div>
<div class="line"><a name="l08605"></a><span class="lineno"> 8605</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tnRequested_Tops: &quot;</span> &lt;&lt; cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a056a397d9afaee97f896feadbe37b6a9">nRequested_Tops</a> &lt;&lt; endl;</div>
<div class="line"><a name="l08606"></a><span class="lineno"> 8606</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tnRequested_Antitops: &quot;</span> &lt;&lt; cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a5885d87c8c2e5dd520b9541e479d71bd">nRequested_Antitops</a> &lt;&lt; endl;</div>
<div class="line"><a name="l08607"></a><span class="lineno"> 8607</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tHas &quot;</span> &lt;&lt; cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.size() &lt;&lt; <span class="stringliteral">&quot; mothers&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08608"></a><span class="lineno"> 8608</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.size(); ip++){</div>
<div class="line"><a name="l08609"></a><span class="lineno"> 8609</span>&#160;      <a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>* part = &amp;(cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">pMothers</a>.at(ip));</div>
<div class="line"><a name="l08610"></a><span class="lineno"> 8610</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l08611"></a><span class="lineno"> 8611</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\t\tV&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; part-&gt;first &lt;&lt; <span class="stringliteral">&quot;) (X,Y,Z,T)=( &quot;</span></div>
<div class="line"><a name="l08612"></a><span class="lineno"> 8612</span>&#160;        &lt;&lt; part-&gt;second.X() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08613"></a><span class="lineno"> 8613</span>&#160;        &lt;&lt; part-&gt;second.Y() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08614"></a><span class="lineno"> 8614</span>&#160;        &lt;&lt; part-&gt;second.Z() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08615"></a><span class="lineno"> 8615</span>&#160;        &lt;&lt; part-&gt;second.T() &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08616"></a><span class="lineno"> 8616</span>&#160;    }</div>
<div class="line"><a name="l08617"></a><span class="lineno"> 8617</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tHas &quot;</span> &lt;&lt; cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.size() &lt;&lt; <span class="stringliteral">&quot; sorted daughter Vs&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08618"></a><span class="lineno"> 8618</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iv=0; iv&lt;cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.size(); iv++) <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t\tV&quot;</span> &lt;&lt; iv &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">intermediateVid</a>.at(iv) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08619"></a><span class="lineno"> 8619</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tHas &quot;</span> &lt;&lt; cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size() &lt;&lt; <span class="stringliteral">&quot; daughters&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08620"></a><span class="lineno"> 8620</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.size(); ip++){</div>
<div class="line"><a name="l08621"></a><span class="lineno"> 8621</span>&#160;      <a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>* part = &amp;(cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">pDaughters</a>.at(ip));</div>
<div class="line"><a name="l08622"></a><span class="lineno"> 8622</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l08623"></a><span class="lineno"> 8623</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\t\tDau[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;] (&quot;</span> &lt;&lt; part-&gt;first &lt;&lt; <span class="stringliteral">&quot;) (X,Y,Z,T)=( &quot;</span></div>
<div class="line"><a name="l08624"></a><span class="lineno"> 8624</span>&#160;        &lt;&lt; part-&gt;second.X() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08625"></a><span class="lineno"> 8625</span>&#160;        &lt;&lt; part-&gt;second.Y() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08626"></a><span class="lineno"> 8626</span>&#160;        &lt;&lt; part-&gt;second.Z() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08627"></a><span class="lineno"> 8627</span>&#160;        &lt;&lt; part-&gt;second.T() &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08628"></a><span class="lineno"> 8628</span>&#160;    }</div>
<div class="line"><a name="l08629"></a><span class="lineno"> 8629</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tHas &quot;</span> &lt;&lt; cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.size() &lt;&lt; <span class="stringliteral">&quot; associated particles&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08630"></a><span class="lineno"> 8630</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.size(); ip++){</div>
<div class="line"><a name="l08631"></a><span class="lineno"> 8631</span>&#160;      <a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>* part = &amp;(cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">pAssociated</a>.at(ip));</div>
<div class="line"><a name="l08632"></a><span class="lineno"> 8632</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l08633"></a><span class="lineno"> 8633</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\t\tAPart[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;] (&quot;</span> &lt;&lt; part-&gt;first &lt;&lt; <span class="stringliteral">&quot;) (X,Y,Z,T)=( &quot;</span></div>
<div class="line"><a name="l08634"></a><span class="lineno"> 8634</span>&#160;        &lt;&lt; part-&gt;second.X() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08635"></a><span class="lineno"> 8635</span>&#160;        &lt;&lt; part-&gt;second.Y() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08636"></a><span class="lineno"> 8636</span>&#160;        &lt;&lt; part-&gt;second.Z() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08637"></a><span class="lineno"> 8637</span>&#160;        &lt;&lt; part-&gt;second.T() &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08638"></a><span class="lineno"> 8638</span>&#160;    }</div>
<div class="line"><a name="l08639"></a><span class="lineno"> 8639</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tHas &quot;</span> &lt;&lt; cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a2261821b9391dd5f9e8f19f7c225212e">pStableTops</a>.size() &lt;&lt; <span class="stringliteral">&quot; stable tops&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08640"></a><span class="lineno"> 8640</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a2261821b9391dd5f9e8f19f7c225212e">pStableTops</a>.size(); ip++){</div>
<div class="line"><a name="l08641"></a><span class="lineno"> 8641</span>&#160;      <a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>* part = &amp;(cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a2261821b9391dd5f9e8f19f7c225212e">pStableTops</a>.at(ip));</div>
<div class="line"><a name="l08642"></a><span class="lineno"> 8642</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l08643"></a><span class="lineno"> 8643</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\t\tAPart[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;] (&quot;</span> &lt;&lt; part-&gt;first &lt;&lt; <span class="stringliteral">&quot;) (X,Y,Z,T)=( &quot;</span></div>
<div class="line"><a name="l08644"></a><span class="lineno"> 8644</span>&#160;        &lt;&lt; part-&gt;second.X() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08645"></a><span class="lineno"> 8645</span>&#160;        &lt;&lt; part-&gt;second.Y() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08646"></a><span class="lineno"> 8646</span>&#160;        &lt;&lt; part-&gt;second.Z() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08647"></a><span class="lineno"> 8647</span>&#160;        &lt;&lt; part-&gt;second.T() &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08648"></a><span class="lineno"> 8648</span>&#160;    }</div>
<div class="line"><a name="l08649"></a><span class="lineno"> 8649</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tHas &quot;</span> &lt;&lt; cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a1f9fa9f2c882417f3de782dce28a5840">pStableAntitops</a>.size() &lt;&lt; <span class="stringliteral">&quot; stable antitops&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08650"></a><span class="lineno"> 8650</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a1f9fa9f2c882417f3de782dce28a5840">pStableAntitops</a>.size(); ip++){</div>
<div class="line"><a name="l08651"></a><span class="lineno"> 8651</span>&#160;      <a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>* part = &amp;(cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#a1f9fa9f2c882417f3de782dce28a5840">pStableAntitops</a>.at(ip));</div>
<div class="line"><a name="l08652"></a><span class="lineno"> 8652</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l08653"></a><span class="lineno"> 8653</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\t\tAPart[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;] (&quot;</span> &lt;&lt; part-&gt;first &lt;&lt; <span class="stringliteral">&quot;) (X,Y,Z,T)=( &quot;</span></div>
<div class="line"><a name="l08654"></a><span class="lineno"> 8654</span>&#160;        &lt;&lt; part-&gt;second.X() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08655"></a><span class="lineno"> 8655</span>&#160;        &lt;&lt; part-&gt;second.Y() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08656"></a><span class="lineno"> 8656</span>&#160;        &lt;&lt; part-&gt;second.Z() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08657"></a><span class="lineno"> 8657</span>&#160;        &lt;&lt; part-&gt;second.T() &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08658"></a><span class="lineno"> 8658</span>&#160;    }</div>
<div class="line"><a name="l08659"></a><span class="lineno"> 8659</span>&#160; </div>
<div class="line"><a name="l08660"></a><span class="lineno"> 8660</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tHas &quot;</span> &lt;&lt; cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#aa83c10b512e0f7e778dddf8a969fbfe6">pTopDaughters</a>.size() &lt;&lt; <span class="stringliteral">&quot; unstable tops&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08661"></a><span class="lineno"> 8661</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#aa83c10b512e0f7e778dddf8a969fbfe6">pTopDaughters</a>.size(); ip++){</div>
<div class="line"><a name="l08662"></a><span class="lineno"> 8662</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t\tTop[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;] daughters:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08663"></a><span class="lineno"> 8663</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jp=0; jp&lt;cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#aa83c10b512e0f7e778dddf8a969fbfe6">pTopDaughters</a>.at(ip).size(); jp++){</div>
<div class="line"><a name="l08664"></a><span class="lineno"> 8664</span>&#160;        <a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>* part = &amp;(cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#aa83c10b512e0f7e778dddf8a969fbfe6">pTopDaughters</a>.at(ip).at(jp));</div>
<div class="line"><a name="l08665"></a><span class="lineno"> 8665</span>&#160;        <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l08666"></a><span class="lineno"> 8666</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\t\t- Top daughter[&quot;</span> &lt;&lt; ip &lt;&lt; jp &lt;&lt; <span class="stringliteral">&quot;] (&quot;</span> &lt;&lt; part-&gt;first &lt;&lt; <span class="stringliteral">&quot;) (X,Y,Z,T)=( &quot;</span></div>
<div class="line"><a name="l08667"></a><span class="lineno"> 8667</span>&#160;          &lt;&lt; part-&gt;second.X() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08668"></a><span class="lineno"> 8668</span>&#160;          &lt;&lt; part-&gt;second.Y() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08669"></a><span class="lineno"> 8669</span>&#160;          &lt;&lt; part-&gt;second.Z() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08670"></a><span class="lineno"> 8670</span>&#160;          &lt;&lt; part-&gt;second.T() &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08671"></a><span class="lineno"> 8671</span>&#160;      }</div>
<div class="line"><a name="l08672"></a><span class="lineno"> 8672</span>&#160;    }</div>
<div class="line"><a name="l08673"></a><span class="lineno"> 8673</span>&#160;    <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\tHas &quot;</span> &lt;&lt; cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#ab39f490ca0e69323fbbdbabfcb394306">pAntitopDaughters</a>.size() &lt;&lt; <span class="stringliteral">&quot; unstable antitops&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08674"></a><span class="lineno"> 8674</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ip=0; ip&lt;cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#ab39f490ca0e69323fbbdbabfcb394306">pAntitopDaughters</a>.size(); ip++){</div>
<div class="line"><a name="l08675"></a><span class="lineno"> 8675</span>&#160;      <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a> &lt;&lt; <span class="stringliteral">&quot;\t\tAntitop[&quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot;] daughters:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08676"></a><span class="lineno"> 8676</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jp=0; jp&lt;cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#ab39f490ca0e69323fbbdbabfcb394306">pAntitopDaughters</a>.at(ip).size(); jp++){</div>
<div class="line"><a name="l08677"></a><span class="lineno"> 8677</span>&#160;        <a class="code" href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a>* part = &amp;(cand-&gt;<a class="code" href="structTVar_1_1simple__event__record.html#ab39f490ca0e69323fbbdbabfcb394306">pAntitopDaughters</a>.at(ip).at(jp));</div>
<div class="line"><a name="l08678"></a><span class="lineno"> 8678</span>&#160;        <a class="code" href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAout</a></div>
<div class="line"><a name="l08679"></a><span class="lineno"> 8679</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\t\t- Antitop daughter[&quot;</span> &lt;&lt; ip &lt;&lt; jp &lt;&lt; <span class="stringliteral">&quot;] (&quot;</span> &lt;&lt; part-&gt;first &lt;&lt; <span class="stringliteral">&quot;) (X,Y,Z,T)=( &quot;</span></div>
<div class="line"><a name="l08680"></a><span class="lineno"> 8680</span>&#160;          &lt;&lt; part-&gt;second.X() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08681"></a><span class="lineno"> 8681</span>&#160;          &lt;&lt; part-&gt;second.Y() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08682"></a><span class="lineno"> 8682</span>&#160;          &lt;&lt; part-&gt;second.Z() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a name="l08683"></a><span class="lineno"> 8683</span>&#160;          &lt;&lt; part-&gt;second.T() &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l08684"></a><span class="lineno"> 8684</span>&#160;      }</div>
<div class="line"><a name="l08685"></a><span class="lineno"> 8685</span>&#160;    }</div>
<div class="line"><a name="l08686"></a><span class="lineno"> 8686</span>&#160;  }</div>
<div class="line"><a name="l08687"></a><span class="lineno"> 8687</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespaceTVar_html_a8dbe2bd8efad9a9d5d55e43c0c6f777bae499e0ec0e4765de3a71e6e6d13eb535"><div class="ttname"><a href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777bae499e0ec0e4765de3a71e6e6d13eb535">TVar::kUseAssociated_Photons</a></div><div class="ttdeci">@ kUseAssociated_Photons</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00032">TVar.hh:32</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a9d1a9f8e0e916dae095df1c0cf76ce90"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a9d1a9f8e0e916dae095df1c0cf76ce90">TVar::H1plus</a></div><div class="ttdeci">@ H1plus</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00149">TVar.hh:149</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_aa69dd3491d25f1ef9989029781e2d4d3"><div class="ttname"><a href="classSpinZeroCouplings.html#aa69dd3491d25f1ef9989029781e2d4d3">SpinZeroCouplings::HzzCLambda_qsq</a></div><div class="ttdeci">int HzzCLambda_qsq[SIZE_HVV_CQSQ]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00039">TCouplings.hh:39</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48"><div class="ttname"><a href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049af5804d7b9529b89da002d2092242cc48">TVar::ERROR</a></div><div class="ttdeci">@ ERROR</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00049">TVar.hh:49</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1ac616ffacd90b7e38f875512989d62e5d"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ac616ffacd90b7e38f875512989d62e5d">TVar::bkgWW_SMHiggs</a></div><div class="ttdeci">@ bkgWW_SMHiggs</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00171">TVar.hh:171</a></div></div>
<div class="ttc" id="aclassMelaIO_html_abe83c33dd9da5a5ae0eb622177a5bb5e"><div class="ttname"><a href="classMelaIO.html#abe83c33dd9da5a5ae0eb622177a5bb5e">MelaIO::setMEArray</a></div><div class="ttdeci">void setMEArray(double MEsq_[nmsq][nmsq], bool transpose=false)</div><div class="ttdef"><b>Definition:</b> <a href="MelaIO_8h_source.html#l00063">MelaIO.h:63</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_aa0c0c6e5953247793844f2959d19cbf8"><div class="ttname"><a href="TMCFM_8hh.html#aa0c0c6e5953247793844f2959d19cbf8">flags_</a></div><div class="ttdeci">struct @21 flags_</div></div>
<div class="ttc" id="aTVar_8hh_html_a2bc0c1a02f5152697e55ab2bbda40aff"><div class="ttname"><a href="TVar_8hh.html#a2bc0c1a02f5152697e55ab2bbda40aff">SimpleParticle_t</a></div><div class="ttdeci">std::pair&lt; int, TLorentzVector &gt; SimpleParticle_t</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00024">TVar.hh:24</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_ab0e969365520b20156c39c71b1f4706b"><div class="ttname"><a href="namespaceTUtil.html#ab0e969365520b20156c39c71b1f4706b">TUtil::scaleMomentumToEnergy</a></div><div class="ttdeci">void scaleMomentumToEnergy(const TLorentzVector &amp;massiveJet, TLorentzVector &amp;masslessJet, double mass=0)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00066">TUtil.cc:66</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a5a527eeac9cb1eef2572d69f647e1e30"><div class="ttname"><a href="namespaceTUtil.html#a5a527eeac9cb1eef2572d69f647e1e30">TUtil::MCFM_chooser</a></div><div class="ttdeci">bool MCFM_chooser(const TVar::Process &amp;process, const TVar::Production &amp;production, const TVar::LeptonInterference &amp;leptonInterf, const TVar::VerbosityLevel &amp;verbosity, const TVar::simple_event_record &amp;mela_event)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l01802">TUtil.cc:1802</a></div></div>
<div class="ttc" id="aclassMelaIO_html_a383d634378da53d000781f8376f31145"><div class="ttname"><a href="classMelaIO.html#a383d634378da53d000781f8376f31145">MelaIO::setFactorizationScale</a></div><div class="ttdeci">void setFactorizationScale(const double &amp;val)</div><div class="ttdef"><b>Definition:</b> <a href="MelaIO_8h_source.html#l00135">MelaIO.h:135</a></div></div>
<div class="ttc" id="aTModHiggsMatEl_8hh_html_af823c96e0e093930152987df81ffcf2f"><div class="ttname"><a href="TModHiggsMatEl_8hh.html#af823c96e0e093930152987df81ffcf2f">__modhiggs_MOD_evalamp_h_vv</a></div><div class="ttdeci">void __modhiggs_MOD_evalamp_h_vv(double P[6][4], int *MYIDUP, double *MatElSq)</div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cabc07d9db0167d4ad17cc45036802280c">TVar::JJVBF</a></div><div class="ttdeci">@ JJVBF</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00072">TVar.hh:72</a></div></div>
<div class="ttc" id="anamespacePDGHelpers_html_a6f98f45dbd53233287193ec3fe987746"><div class="ttname"><a href="namespacePDGHelpers.html#a6f98f45dbd53233287193ec3fe987746">PDGHelpers::isALepton</a></div><div class="ttdeci">bool isALepton(const int id)</div><div class="ttdef"><b>Definition:</b> <a href="PDGHelpers_8cc_source.html#l00062">PDGHelpers.cc:62</a></div></div>
<div class="ttc" id="anamespaceTVar_html_ab9fe70f6c2d4abb0f3fa561abc04805ca0e0dbb110275d4b68b0696ec0d4fbcb6"><div class="ttname"><a href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805ca0e0dbb110275d4b68b0696ec0d4fbcb6">TVar::Dynamic_qJJ_qH</a></div><div class="ttdeci">@ Dynamic_qJJ_qH</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00207">TVar.hh:207</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a7ed7b2d062c0a1fbb809e065e6752cce"><div class="ttname"><a href="namespaceTUtil.html#a7ed7b2d062c0a1fbb809e065e6752cce">TUtil::ResonancePropagator</a></div><div class="ttdeci">double ResonancePropagator(double const &amp;sqrts, TVar::ResonancePropagatorScheme scheme)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l07929">TUtil.cc:7929</a></div></div>
<div class="ttc" id="astructTVar_1_1simple__event__record_html_aa83c10b512e0f7e778dddf8a969fbfe6"><div class="ttname"><a href="structTVar_1_1simple__event__record.html#aa83c10b512e0f7e778dddf8a969fbfe6">TVar::simple_event_record::pTopDaughters</a></div><div class="ttdeci">std::vector&lt; SimpleParticleCollection_t &gt; pTopDaughters</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00242">TVar.hh:242</a></div></div>
<div class="ttc" id="aclassaTQGCCouplings_html"><div class="ttname"><a href="classaTQGCCouplings.html">aTQGCCouplings</a></div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00128">TCouplings.hh:128</a></div></div>
<div class="ttc" id="astructTVar_1_1simple__event__record_html_a1f9fa9f2c882417f3de782dce28a5840"><div class="ttname"><a href="structTVar_1_1simple__event__record.html#a1f9fa9f2c882417f3de782dce28a5840">TVar::simple_event_record::pStableAntitops</a></div><div class="ttdeci">SimpleParticleCollection_t pStableAntitops</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00245">TVar.hh:245</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a534d1442fc379e1a036eb23050c13c5b"><div class="ttname"><a href="namespaceTUtil.html#a534d1442fc379e1a036eb23050c13c5b">TUtil::SetJHUGenSpinZeroGGCouplings</a></div><div class="ttdeci">void SetJHUGenSpinZeroGGCouplings(double Hggcoupl[SIZE_HGG][2])</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l04084">TUtil.cc:4084</a></div></div>
<div class="ttc" id="anamespacePDGHelpers_html_ad093a6206d20114f4716a631777a93ff"><div class="ttname"><a href="namespacePDGHelpers.html#ad093a6206d20114f4716a631777a93ff">PDGHelpers::HDecayMode</a></div><div class="ttdeci">TVar::CandidateDecayMode HDecayMode</div><div class="ttdef"><b>Definition:</b> <a href="PDGHelpers_8cc_source.html#l00011">PDGHelpers.cc:11</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca9e87aa5c4ef53a86281b46ffbf67dd3a">TVar::Had_ZH_S</a></div><div class="ttdeci">@ Had_ZH_S</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00086">TVar.hh:86</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a3e24aa1f4311876d507e30ff4162a1db"><div class="ttname"><a href="namespaceTUtil.html#a3e24aa1f4311876d507e30ff4162a1db">TUtil::WipeMEArray</a></div><div class="ttdeci">int WipeMEArray(const TVar::Process &amp;process, const TVar::Production &amp;production, const int id[mxpart], double msq[nmsq][nmsq], const TVar::VerbosityLevel &amp;verbosity)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l07729">TUtil.cc:7729</a></div></div>
<div class="ttc" id="anamespacemela_html_a0944c7e72a30532e078afc17c62df400"><div class="ttname"><a href="namespacemela.html#a0944c7e72a30532e078afc17c62df400">mela.daughters</a></div><div class="ttdeci">string daughters</div><div class="ttdef"><b>Definition:</b> <a href="mela_8py_source.html#l00767">mela.py:767</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a9725014132a3701b15e4b3b0ae454288"><div class="ttname"><a href="namespaceTVar.html#a9725014132a3701b15e4b3b0ae454288">TVar::FermionMassRemoval</a></div><div class="ttdeci">FermionMassRemoval</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00111">TVar.hh:111</a></div></div>
<div class="ttc" id="aclassMelaIO_html"><div class="ttname"><a href="classMelaIO.html">MelaIO</a></div><div class="ttdef"><b>Definition:</b> <a href="MelaIO_8h_source.html#l00008">MelaIO.h:8</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a2599e53f6f03e850b83dd83d6c296fec"><div class="ttname"><a href="namespaceTVar.html#a2599e53f6f03e850b83dd83d6c296fec">TVar::LeptonInterference</a></div><div class="ttdeci">LeptonInterference</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00106">TVar.hh:106</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a3484bfea5cba3a35baf703d223bacbe1"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3484bfea5cba3a35baf703d223bacbe1">TVar::H0_Zgs_PS</a></div><div class="ttdeci">@ H0_Zgs_PS</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00132">TVar.hh:132</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a8dbe2bd8efad9a9d5d55e43c0c6f777ba73861ec433a26ae79407bfe3f2f7b71a"><div class="ttname"><a href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba73861ec433a26ae79407bfe3f2f7b71a">TVar::kUseAssociated_Jets</a></div><div class="ttdeci">@ kUseAssociated_Jets</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00033">TVar.hh:33</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a009f1369c2ba692d3fa2ceb2097ef2cc"><div class="ttname"><a href="namespaceTUtil.html#a009f1369c2ba692d3fa2ceb2097ef2cc">TUtil::MCFM_smalls</a></div><div class="ttdeci">bool MCFM_smalls(double s[][mxpart], int npart)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l03298">TUtil.cc:3298</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a159a43323e3b4e8a2dcfdc2ac09e2049"><div class="ttname"><a href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049">TVar::VerbosityLevel</a></div><div class="ttdeci">VerbosityLevel</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00047">TVar.hh:47</a></div></div>
<div class="ttc" id="aclassMelaIO_html_afb45877052ee8742c8599476a6ef2a14"><div class="ttname"><a href="classMelaIO.html#afb45877052ee8742c8599476a6ef2a14">MelaIO::computeWeightedMEArray</a></div><div class="ttdeci">void computeWeightedMEArray()</div><div class="ttdef"><b>Definition:</b> <a href="MelaIO_8h_source.html#l00094">MelaIO.h:94</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_ad20fc2036f3b865fbf09a7046f5e8496"><div class="ttname"><a href="classSpinZeroCouplings.html#ad20fc2036f3b865fbf09a7046f5e8496">SpinZeroCouplings::H2zzcoupl</a></div><div class="ttdeci">double H2zzcoupl[SIZE_HVV][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00050">TCouplings.hh:50</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_adf7b61bc902b23177090ce6b48a7f026"><div class="ttname"><a href="namespaceTUtil.html#adf7b61bc902b23177090ce6b48a7f026">TUtil::SumMEPDF</a></div><div class="ttdeci">double SumMEPDF(const TLorentzVector &amp;p0, const TLorentzVector &amp;p1, double msq[nmsq][nmsq], MelaIO *RcdME, const double &amp;EBEAM, const TVar::VerbosityLevel &amp;verbosity)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l07911">TUtil.cc:7911</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a1e72dbf082de5b3d5b384a09a1c83d75"><div class="ttname"><a href="TMCFM_8hh.html#a1e72dbf082de5b3d5b384a09a1c83d75">vsymfact_</a></div><div class="ttdeci">struct @31 vsymfact_</div></div>
<div class="ttc" id="aclassMELACandidate_html_a2b0f61b5ae35b253e222278710e40e06"><div class="ttname"><a href="classMELACandidate.html#a2b0f61b5ae35b253e222278710e40e06">MELACandidate::addAssociatedJet</a></div><div class="ttdeci">void addAssociatedJet(MELAParticle *myParticle)</div><div class="ttdef"><b>Definition:</b> <a href="MELACandidate_8cc_source.html#l00616">MELACandidate.cc:616</a></div></div>
<div class="ttc" id="aclassMelaIO_html_a49449bc12b427fa2abd96a33e53ac274"><div class="ttname"><a href="classMelaIO.html#a49449bc12b427fa2abd96a33e53ac274">MelaIO::getSumME</a></div><div class="ttdeci">double getSumME() const</div><div class="ttdef"><b>Definition:</b> <a href="MelaIO_8h_source.html#l00107">MelaIO.h:107</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a1046865d1362c1576fb32935533c6af2"><div class="ttname"><a href="TMCFM_8hh.html#a1046865d1362c1576fb32935533c6af2">runstring_</a></div><div class="ttdeci">struct @55 runstring_</div></div>
<div class="ttc" id="aTJHUGenUtils_8hh_html"><div class="ttname"><a href="TJHUGenUtils_8hh.html">TJHUGenUtils.hh</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a4812281815c3cd3df59c9575878c76e6"><div class="ttname"><a href="namespaceTUtil.html#a4812281815c3cd3df59c9575878c76e6">TUtil::BBHiggsMatEl</a></div><div class="ttdeci">double BBHiggsMatEl(const TVar::Process &amp;process, const TVar::Production &amp;production, const TVar::MatrixElement &amp;matrixElement, TVar::event_scales_type *event_scales, MelaIO *RcdME, const double &amp;EBEAM, int botProcess, TVar::VerbosityLevel verbosity)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l07562">TUtil.cc:7562</a></div></div>
<div class="ttc" id="anamespaceTVar_html_ab9fe70f6c2d4abb0f3fa561abc04805ca6072646de5d43decee41caf8444bb209"><div class="ttname"><a href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805ca6072646de5d43decee41caf8444bb209">TVar::Fixed_mH</a></div><div class="ttdeci">@ Fixed_mH</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00198">TVar.hh:198</a></div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a315e4d6c9a7433f82c692166e8da2b9d"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a315e4d6c9a7433f82c692166e8da2b9d">__modjhugenmela_MOD_setspinzerovvcouplings</a></div><div class="ttdeci">void __modjhugenmela_MOD_setspinzerovvcouplings(double vvcoupl[SIZE_HVV][2], double vvpcoupl[SIZE_HVV][2], double vpvpcoupl[SIZE_HVV][2], int cqsq[SIZE_HVV_CQSQ], double Lambda_qsq[SIZE_HVV_LAMBDAQSQ][SIZE_HVV_CQSQ], int *usewwcoupl)</div></div>
<div class="ttc" id="anamespaceTJHUGenUtils_html_a2a4e0c526348cefc7b22679883888607"><div class="ttname"><a href="namespaceTJHUGenUtils.html#a2a4e0c526348cefc7b22679883888607">TJHUGenUtils::Get_JHUGenHash_OnshellVBFHash</a></div><div class="ttdeci">const std::vector&lt; TNumericUtil::intTriplet_t &gt; &amp; Get_JHUGenHash_OnshellVBFHash()</div><div class="ttdef"><b>Definition:</b> <a href="TJHUGenUtils_8cc_source.html#l00042">TJHUGenUtils.cc:42</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca936aef1ef89c04b5586ccb862544363a"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca936aef1ef89c04b5586ccb862544363a">TVar::JJEWQCD</a></div><div class="ttdeci">@ JJEWQCD</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00074">TVar.hh:74</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a5f54fad3934038d99814fd0d7a56d4d6"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a5f54fad3934038d99814fd0d7a56d4d6">TVar::H0minus</a></div><div class="ttdeci">@ H0minus</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00129">TVar.hh:129</a></div></div>
<div class="ttc" id="aclassMelaIO_html_a47b8c8bb2137ecf3e3e1d1b873d3de0b"><div class="ttname"><a href="classMelaIO.html#a47b8c8bb2137ecf3e3e1d1b873d3de0b">MelaIO::setAlphaS</a></div><div class="ttdeci">void setAlphaS(const double &amp;val)</div><div class="ttdef"><b>Definition:</b> <a href="MelaIO_8h_source.html#l00137">MelaIO.h:137</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a4a00d03fa1abeb4335b6abd9fae90663"><div class="ttname"><a href="namespaceTUtil.html#a4a00d03fa1abeb4335b6abd9fae90663">TUtil::InterpretScaleScheme</a></div><div class="ttdeci">double InterpretScaleScheme(const TVar::Production &amp;production, const TVar::MatrixElement &amp;matrixElement, const TVar::EventScaleScheme &amp;scheme, TLorentzVector p[mxpart])</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l01601">TUtil.cc:1601</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a71a2597822d7f2646209498585c4bbc4ac0c27bc9239fab096f3b6efefd813036"><div class="ttname"><a href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4ac0c27bc9239fab096f3b6efefd813036">TVar::CandidateDecay_ZZ</a></div><div class="ttdeci">@ CandidateDecay_ZZ</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00041">TVar.hh:41</a></div></div>
<div class="ttc" id="aclassMelaIO_html_a8487223242ccff4de3677d673152c7f5"><div class="ttname"><a href="classMelaIO.html#a8487223242ccff4de3677d673152c7f5">MelaIO::setAlphaSatMZ</a></div><div class="ttdeci">void setAlphaSatMZ(const double &amp;val)</div><div class="ttdef"><b>Definition:</b> <a href="MelaIO_8h_source.html#l00139">MelaIO.h:139</a></div></div>
<div class="ttc" id="aclassMELAParticle_html_af888923eb993c0115a0f952820f820f3"><div class="ttname"><a href="classMELAParticle.html#af888923eb993c0115a0f952820f820f3">MELAParticle::getNDaughters</a></div><div class="ttdeci">int getNDaughters() const</div><div class="ttdef"><b>Definition:</b> <a href="MELAParticle_8h_source.html#l00050">MELAParticle.h:50</a></div></div>
<div class="ttc" id="astructTVar_1_1simple__event__record_html_aca54cfc4690b7f0ba78f5af03d0f1ddf"><div class="ttname"><a href="structTVar_1_1simple__event__record.html#aca54cfc4690b7f0ba78f5af03d0f1ddf">TVar::simple_event_record::nRequested_AssociatedJets</a></div><div class="ttdeci">int nRequested_AssociatedJets</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00230">TVar.hh:230</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_ae8313a38acdcb638b50a63bf04bc472f"><div class="ttname"><a href="namespaceTUtil.html#ae8313a38acdcb638b50a63bf04bc472f">TUtil::SetJHUGenHiggsMassWidth</a></div><div class="ttdeci">void SetJHUGenHiggsMassWidth(double MReso, double GaReso)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l03347">TUtil.cc:3347</a></div></div>
<div class="ttc" id="anamespaceTVar_html_ab9fe70f6c2d4abb0f3fa561abc04805ca42a0672e541b92585667e2df57b4d958"><div class="ttname"><a href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805ca42a0672e541b92585667e2df57b4d958">TVar::Fixed_mWPlusmH</a></div><div class="ttdeci">@ Fixed_mWPlusmH</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00201">TVar.hh:201</a></div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a99aa222231438639d87fc30e6c417071"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a99aa222231438639d87fc30e6c417071">__modjhugenmela_MOD_setazffcouplings</a></div><div class="ttdeci">void __modjhugenmela_MOD_setazffcouplings(double AZffcoupl[SIZE_AZff][2])</div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a4baafc289948916b0b531aa85e8f896f"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4baafc289948916b0b531aa85e8f896f">TVar::bkgGammaGamma</a></div><div class="ttdeci">@ bkgGammaGamma</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00163">TVar.hh:163</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_ae53582caadc4362e0dc6f9519dede582"><div class="ttname"><a href="namespaceTUtil.html#ae53582caadc4362e0dc6f9519dede582">TUtil::HJJMatEl</a></div><div class="ttdeci">double HJJMatEl(const TVar::Process &amp;process, const TVar::Production &amp;production, const TVar::MatrixElement &amp;matrixElement, TVar::event_scales_type *event_scales, MelaIO *RcdME, const double &amp;EBEAM, TVar::VerbosityLevel verbosity)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l05118">TUtil.cc:5118</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a9082c83a90005205bb355123c1c24875"><div class="ttname"><a href="namespaceTUtil.html#a9082c83a90005205bb355123c1c24875">TUtil::SetCKMElements</a></div><div class="ttdeci">void SetCKMElements(double *invckm_ud, double *invckm_us, double *invckm_cd, double *invckm_cs, double *invckm_ts, double *invckm_tb, double *invckm_ub=0, double *invckm_cb=0, double *invckm_td=0)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l01507">TUtil.cc:1507</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a345c5ae46930918d36cb7ca55b01c853"><div class="ttname"><a href="namespaceTUtil.html#a345c5ae46930918d36cb7ca55b01c853">TUtil::SetMCFMAZffCouplings</a></div><div class="ttdeci">void SetMCFMAZffCouplings(bool useBSM, AZffCouplings const *Zcouplings)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l04044">TUtil.cc:4044</a></div></div>
<div class="ttc" id="astructTVar_1_1event__scales__type_html"><div class="ttname"><a href="structTVar_1_1event__scales__type.html">TVar::event_scales_type</a></div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00260">TVar.hh:260</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a54213f196c3344b9508ae4cb9eab0ea0"><div class="ttname"><a href="TMCFM_8hh.html#a54213f196c3344b9508ae4cb9eab0ea0">npart_</a></div><div class="ttdeci">struct @29 npart_</div></div>
<div class="ttc" id="anamespaceTVar_html_a159a43323e3b4e8a2dcfdc2ac09e2049a55570e17cba7f10ab11173ebb9d25125"><div class="ttname"><a href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a55570e17cba7f10ab11173ebb9d25125">TVar::INFO</a></div><div class="ttdeci">@ INFO</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00050">TVar.hh:50</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7191ba68085050421169c48d03c81948">TVar::Lep_WH_S</a></div><div class="ttdeci">@ Lep_WH_S</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00089">TVar.hh:89</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a8dbe2bd8efad9a9d5d55e43c0c6f777ba9dc7858ba1f4e25c5a0d3d914dcda75f"><div class="ttname"><a href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba9dc7858ba1f4e25c5a0d3d914dcda75f">TVar::kUseAssociated_UnstableTops</a></div><div class="ttdeci">@ kUseAssociated_UnstableTops</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00034">TVar.hh:34</a></div></div>
<div class="ttc" id="aclassMELAParticle_html_a7b091a138709e28de0ca4d843b755efd"><div class="ttname"><a href="classMELAParticle.html#a7b091a138709e28de0ca4d843b755efd">MELAParticle::getDaughters</a></div><div class="ttdeci">std::vector&lt; MELAParticle * &gt; &amp; getDaughters()</div><div class="ttdef"><b>Definition:</b> <a href="MELAParticle_8h_source.html#l00059">MELAParticle.h:59</a></div></div>
<div class="ttc" id="aclassMELACandidate_html_af8501fe7cf1f00ef037a125cc5165d7a"><div class="ttname"><a href="classMELACandidate.html#af8501fe7cf1f00ef037a125cc5165d7a">MELACandidate::getSortedV</a></div><div class="ttdeci">MELAParticle * getSortedV(int index) const</div><div class="ttdef"><b>Definition:</b> <a href="MELACandidate_8cc_source.html#l00152">MELACandidate.cc:152</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_accd9f808b3c1418c23dd1261025ba5c8"><div class="ttname"><a href="TMCFM_8hh.html#accd9f808b3c1418c23dd1261025ba5c8">qqb_zgam_</a></div><div class="ttdeci">void qqb_zgam_(double *p, double *msq)</div></div>
<div class="ttc" id="aclassAZffCouplings_html"><div class="ttname"><a href="classAZffCouplings.html">AZffCouplings</a></div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00143">TCouplings.hh:143</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_a22237a18d3917271f0aa5296bfb8bb8e"><div class="ttname"><a href="classSpinZeroCouplings.html#a22237a18d3917271f0aa5296bfb8bb8e">SpinZeroCouplings::Ht4t4coupl</a></div><div class="ttdeci">double Ht4t4coupl[SIZE_HQQ][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00032">TCouplings.hh:32</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1225a4280a727b6456d225d3493e0e66"><div class="ttname"><a href="namespaceTVar.html#a1225a4280a727b6456d225d3493e0e66">TVar::ProductionName</a></div><div class="ttdeci">TString ProductionName(TVar::Production temp)</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8cc_source.html#l00064">TVar.cc:64</a></div></div>
<div class="ttc" id="aclassMELACandidate_html_ade6ff983fa4cd82b8c1102ed1688d985"><div class="ttname"><a href="classMELACandidate.html#ade6ff983fa4cd82b8c1102ed1688d985">MELACandidate::addAssociatedNeutrino</a></div><div class="ttdeci">void addAssociatedNeutrino(MELAParticle *myParticle)</div><div class="ttdef"><b>Definition:</b> <a href="MELACandidate_8cc_source.html#l00609">MELACandidate.cc:609</a></div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a58ed96aa08541deafc3103feb3620675"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a58ed96aa08541deafc3103feb3620675">__modjhugenmela_MOD_getdecaycouplings</a></div><div class="ttdeci">void __modjhugenmela_MOD_getdecaycouplings(int *VVMode, int idordered[4], double *aL1, double *aR1, double *aL2, double *aR2)</div></div>
<div class="ttc" id="aclassMELAParticle_html_a4acf2bbd01994e54cd9514b8ce7d5c95"><div class="ttname"><a href="classMELAParticle.html#a4acf2bbd01994e54cd9514b8ce7d5c95">MELAParticle::setGenStatus</a></div><div class="ttdeci">void setGenStatus(int status_)</div><div class="ttdef"><b>Definition:</b> <a href="MELAParticle_8h_source.html#l00043">MELAParticle.h:43</a></div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a5c02b31b13777e326cdfa9531ba871aa"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a5c02b31b13777e326cdfa9531ba871aa">__modjhugenmela_MOD_setspinzeroqqcouplings</a></div><div class="ttdeci">void __modjhugenmela_MOD_setspinzeroqqcouplings(double qqcoupl[SIZE_HQQ][2])</div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae9bc4589f789547d42910a3b6128d225">TVar::GammaH</a></div><div class="ttdeci">@ GammaH</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00102">TVar.hh:102</a></div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_aa157e1ca3fd32232d0937bcf2363988c"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#aa157e1ca3fd32232d0937bcf2363988c">__modjhugenmela_MOD_getalphasalphasmz</a></div><div class="ttdeci">void __modjhugenmela_MOD_getalphasalphasmz(double *val_as, double *val_asmz)</div></div>
<div class="ttc" id="anamespaceTUtil_html_ab551562aaa197841cd0a638f1f38b0ff"><div class="ttname"><a href="namespaceTUtil.html#ab551562aaa197841cd0a638f1f38b0ff">TUtil::SetAlphaS</a></div><div class="ttdeci">void SetAlphaS(double &amp;Q_ren, double &amp;Q_fac, double multiplier_ren, double multiplier_fac, int mynloop, int mynflav, std::string mypartons)</div></div>
<div class="ttc" id="anamespaceTVar_html_ab9fe70f6c2d4abb0f3fa561abc04805cace84f5ea3afdb116da2543edbad91560"><div class="ttname"><a href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805cace84f5ea3afdb116da2543edbad91560">TVar::Dynamic_HT</a></div><div class="ttdeci">@ Dynamic_HT</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00209">TVar.hh:209</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a73d36bb0f57c81dfb5316ddbc97c763d"><div class="ttname"><a href="TMCFM_8hh.html#a73d36bb0f57c81dfb5316ddbc97c763d">qqb_gamgam_</a></div><div class="ttdeci">void qqb_gamgam_(double *p, double *msq)</div></div>
<div class="ttc" id="anamespaceTVar_html_a71a2597822d7f2646209498585c4bbc4"><div class="ttname"><a href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4">TVar::CandidateDecayMode</a></div><div class="ttdeci">CandidateDecayMode</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00037">TVar.hh:37</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a617b10ef8551cd1cfb7edc30e90abb63"><div class="ttname"><a href="TMCFM_8hh.html#a617b10ef8551cd1cfb7edc30e90abb63">qq_zzqq_</a></div><div class="ttdeci">void qq_zzqq_(double *p, double *msq)</div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a9eaf6c4583168f2e344e0f51dd24378d"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a9eaf6c4583168f2e344e0f51dd24378d">TVar::H2_g10</a></div><div class="ttdeci">@ H2_g10</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00161">TVar.hh:161</a></div></div>
<div class="ttc" id="anamespacetestME__all_html_ad8d22342dc3abc8c0fff43d649ac4655"><div class="ttname"><a href="namespacetestME__all.html#ad8d22342dc3abc8c0fff43d649ac4655">testME_all.production</a></div><div class="ttdeci">def production</div><div class="ttdef"><b>Definition:</b> <a href="testME__all_8py_source.html#l00115">testME_all.py:115</a></div></div>
<div class="ttc" id="aclassMelaIO_html_ab63c4e79eba8f923423f2e97539ebeef"><div class="ttname"><a href="classMelaIO.html#ab63c4e79eba8f923423f2e97539ebeef">MelaIO::setRenormalizationScale</a></div><div class="ttdeci">void setRenormalizationScale(const double &amp;val)</div><div class="ttdef"><b>Definition:</b> <a href="MelaIO_8h_source.html#l00133">MelaIO.h:133</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a8f220424c5f98ce6e208bb834ecd55a6"><div class="ttname"><a href="namespaceTUtil.html#a8f220424c5f98ce6e208bb834ecd55a6">TUtil::computeTTHAngles</a></div><div class="ttdeci">void computeTTHAngles(float &amp;hs, float &amp;hincoming, float &amp;hTT, float &amp;PhiTT, float &amp;Phi1, float &amp;hbb, float &amp;hWW, float &amp;Phibb, float &amp;Phi1bb, float &amp;hWplusf, float &amp;PhiWplusf, float &amp;hWminusf, float &amp;PhiWminusf, TLorentzVector p4M11, int Z1_lept1Id, TLorentzVector p4M12, int Z1_lept2Id, TLorentzVector p4M21, int Z2_lept1Id, TLorentzVector p4M22, int Z2_lept2Id, TLorentzVector b, int bId, TLorentzVector Wplusf, int WplusfId, TLorentzVector Wplusfb, int WplusfbId, TLorentzVector bbar, int bbarId, TLorentzVector Wminusf, int WminusfId, TLorentzVector Wminusfb, int WminusfbId, TLorentzVector *injet1=0, int injet1Id=0, TLorentzVector *injet2=0, int injet2Id=0)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00989">TUtil.cc:989</a></div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a18c71227d200f0734a5a6f8d08304df7"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a18c71227d200f0734a5a6f8d08304df7">__modjhugenmela_MOD_sethdk</a></div><div class="ttdeci">void __modjhugenmela_MOD_sethdk(int *flag)</div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a793e5b93f6642e3b03340b1a44711c90"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a793e5b93f6642e3b03340b1a44711c90">TVar::SelfDefine_spin2</a></div><div class="ttdeci">@ SelfDefine_spin2</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00182">TVar.hh:182</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a71a2597822d7f2646209498585c4bbc4a309d83a82eccce4e136622efb4b6271f"><div class="ttname"><a href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4a309d83a82eccce4e136622efb4b6271f">TVar::CandidateDecay_Stable</a></div><div class="ttdeci">@ CandidateDecay_Stable</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00038">TVar.hh:38</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1ad2933b84082d269af9a836d4646aeefd"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad2933b84082d269af9a836d4646aeefd">TVar::bkgZJets</a></div><div class="ttdeci">@ bkgZJets</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00165">TVar.hh:165</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a6bfd5cb46a29544d71df3919c5e75071"><div class="ttname"><a href="TMCFM_8hh.html#a6bfd5cb46a29544d71df3919c5e75071">breit_</a></div><div class="ttdeci">struct @26 breit_</div></div>
<div class="ttc" id="aTMCFM_8hh_html_a0a013af3f51251118d97e436366df176"><div class="ttname"><a href="TMCFM_8hh.html#a0a013af3f51251118d97e436366df176">gg_vv_all_</a></div><div class="ttdeci">void gg_vv_all_(double *p, double *msq)</div></div>
<div class="ttc" id="anamespaceTUtil_html_a4824d6613cde741139ec5bc7e199ac57"><div class="ttname"><a href="namespaceTUtil.html#a4824d6613cde741139ec5bc7e199ac57">TUtil::applyLeptonMassCorrection</a></div><div class="ttdeci">void applyLeptonMassCorrection(bool flag=true)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00035">TUtil.cc:35</a></div></div>
<div class="ttc" id="anamespaceTJHUGenUtils_html"><div class="ttname"><a href="namespaceTJHUGenUtils.html">TJHUGenUtils</a></div><div class="ttdef"><b>Definition:</b> <a href="TJHUGenUtils_8hh_source.html#l00013">TJHUGenUtils.hh:13</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae2cc1a38671c72b7bdf657180d1e16f4">TVar::ZZINDEPENDENT</a></div><div class="ttdeci">@ ZZINDEPENDENT</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00064">TVar.hh:64</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a51c225f177937798f635f16e7999af99"><div class="ttname"><a href="namespaceTUtil.html#a51c225f177937798f635f16e7999af99">TUtil::SetMass</a></div><div class="ttdeci">void SetMass(double inmass, int ipart)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l01445">TUtil.cc:1445</a></div></div>
<div class="ttc" id="astructTVar_1_1simple__event__record_html_a99f74862afbea6076bb784a3ff2d8af6"><div class="ttname"><a href="structTVar_1_1simple__event__record.html#a99f74862afbea6076bb784a3ff2d8af6">TVar::simple_event_record::pDaughters</a></div><div class="ttdeci">SimpleParticleCollection_t pDaughters</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00238">TVar.hh:238</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1">TVar::Process</a></div><div class="ttdeci">Process</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00125">TVar.hh:125</a></div></div>
<div class="ttc" id="aTModParameters_8hh_html_a4b21539bdadfc0331f2ef8372721c755"><div class="ttname"><a href="TModParameters_8hh.html#a4b21539bdadfc0331f2ef8372721c755">__modparameters_MOD_ckm</a></div><div class="ttdeci">double __modparameters_MOD_ckm(int *id1in, int *id2in)</div></div>
<div class="ttc" id="anamespaceTVar_html_ab9fe70f6c2d4abb0f3fa561abc04805c"><div class="ttname"><a href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805c">TVar::EventScaleScheme</a></div><div class="ttdeci">EventScaleScheme</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00196">TVar.hh:196</a></div></div>
<div class="ttc" id="aclassMELACandidate_html_a2bc7e8b045eea81dcf096502f8079d45"><div class="ttname"><a href="classMELACandidate.html#a2bc7e8b045eea81dcf096502f8079d45">MELACandidate::addAssociatedVs</a></div><div class="ttdeci">void addAssociatedVs()</div><div class="ttdef"><b>Definition:</b> <a href="MELACandidate_8cc_source.html#l00639">MELACandidate.cc:639</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac0c573d4bbf26795b6c05f5ad5036309">TVar::JJQCD</a></div><div class="ttdeci">@ JJQCD</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00071">TVar.hh:71</a></div></div>
<div class="ttc" id="aTModGravitonMatEl_8hh_html_a996d17b7ea2ec245e2f96c2709a175e9"><div class="ttname"><a href="TModGravitonMatEl_8hh.html#a996d17b7ea2ec245e2f96c2709a175e9">__modgraviton_MOD_evalamp_qqb_g_vv</a></div><div class="ttdeci">void __modgraviton_MOD_evalamp_qqb_g_vv(double P[6][4], int *MYIDUP, double *MatElSq)</div></div>
<div class="ttc" id="anamespaceTUtil_html_a1c600f2c3dcc37a9512d659f46a364aa"><div class="ttname"><a href="namespaceTUtil.html#a1c600f2c3dcc37a9512d659f46a364aa">TUtil::SetJHUGenVprimeContactCouplings</a></div><div class="ttdeci">void SetJHUGenVprimeContactCouplings(double Zpffcoupl[SIZE_Vpff][2], double Wpffcoupl[SIZE_Vpff][2])</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l04090">TUtil.cc:4090</a></div></div>
<div class="ttc" id="aclassMelaIO_html_a98676a9ef8bf3590b6f70a523dae212c"><div class="ttname"><a href="classMelaIO.html#a98676a9ef8bf3590b6f70a523dae212c">MelaIO::setPartonWeights</a></div><div class="ttdeci">void setPartonWeights(double partonOneWeight_[nmsq], double partonTwoWeight_[nmsq])</div><div class="ttdef"><b>Definition:</b> <a href="MelaIO_8h_source.html#l00054">MelaIO.h:54</a></div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a6400ff69dd1db36c40f04160c8ab9af9"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a6400ff69dd1db36c40f04160c8ab9af9">__modjhugenmela_MOD_setspinzeroggcouplings</a></div><div class="ttdeci">void __modjhugenmela_MOD_setspinzeroggcouplings(double ggcoupl[SIZE_HGG][2])</div></div>
<div class="ttc" id="aTMCFM_8hh_html_a0126f1ad7c0f276245e47e94209bb159"><div class="ttname"><a href="TMCFM_8hh.html#a0126f1ad7c0f276245e47e94209bb159">qqb_zz_stu_</a></div><div class="ttdeci">void qqb_zz_stu_(double *p, double *msq, int *channeltoggle)</div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_a3a28fafa6eb3b86527ab7eab167f5101"><div class="ttname"><a href="classSpinZeroCouplings.html#a3a28fafa6eb3b86527ab7eab167f5101">SpinZeroCouplings::H2b4b4coupl</a></div><div class="ttdeci">double H2b4b4coupl[SIZE_HQQ][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00048">TCouplings.hh:48</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a6ef8ab8d12864b3376f525ab0bcccff7">TVar::HSMHiggs_WWZZ</a></div><div class="ttdeci">@ HSMHiggs_WWZZ</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00174">TVar.hh:174</a></div></div>
<div class="ttc" id="anamespacetestME__all_html_abd1c8f4cc0e2aff091dcab1c877bdf9b"><div class="ttname"><a href="namespacetestME__all.html#abd1c8f4cc0e2aff091dcab1c877bdf9b">testME_all.p</a></div><div class="ttdeci">p</div><div class="ttdef"><b>Definition:</b> <a href="testME__all_8py_source.html#l00011">testME_all.py:11</a></div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a020cbe585463df7e05300b1cb081b4be"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a020cbe585463df7e05300b1cb081b4be">__modjhugenmela_MOD_setmurenfac</a></div><div class="ttdeci">void __modjhugenmela_MOD_setmurenfac(double *muren, double *mufac)</div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caadcf7f0a83b7115068947fc704e41aea">TVar::ZZQQB</a></div><div class="ttdeci">@ ZZQQB</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00062">TVar.hh:62</a></div></div>
<div class="ttc" id="anamespacemela_html_a42a9f6ba8d6c9cec91eb11b999fea95e"><div class="ttname"><a href="namespacemela.html#a42a9f6ba8d6c9cec91eb11b999fea95e">mela.m</a></div><div class="ttdeci">m</div><div class="ttdef"><b>Definition:</b> <a href="mela_8py_source.html#l00715">mela.py:715</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_a12429010d42886dad7844bb0b2cb8efc"><div class="ttname"><a href="classSpinZeroCouplings.html#a12429010d42886dad7844bb0b2cb8efc">SpinZeroCouplings::HwwLambda_qsq</a></div><div class="ttdeci">double HwwLambda_qsq[SIZE_HVV_LAMBDAQSQ][SIZE_HVV_CQSQ]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00038">TCouplings.hh:38</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a71a2597822d7f2646209498585c4bbc4a772474648ce9adde8a9266b2de923dcb"><div class="ttname"><a href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4a772474648ce9adde8a9266b2de923dcb">TVar::CandidateDecay_WW</a></div><div class="ttdeci">@ CandidateDecay_WW</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00040">TVar.hh:40</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_ace316759a46920794a772ae644254576"><div class="ttname"><a href="TMCFM_8hh.html#ace316759a46920794a772ae644254576">noglue_</a></div><div class="ttdeci">struct @46 noglue_</div></div>
<div class="ttc" id="anamespaceTUtil_html_a7f6ec9418811fe987c034629691182af"><div class="ttname"><a href="namespaceTUtil.html#a7f6ec9418811fe987c034629691182af">TUtil::PrintCandidateSummary</a></div><div class="ttdeci">void PrintCandidateSummary(MELACandidate *cand)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l08590">TUtil.cc:8590</a></div></div>
<div class="ttc" id="aTModZprimeMatEl_8hh_html_a86ad8934941c5e677cbc8f1ed955bad8"><div class="ttname"><a href="TModZprimeMatEl_8hh.html#a86ad8934941c5e677cbc8f1ed955bad8">__modzprime_MOD_evalamp_qqb_zprime_vv</a></div><div class="ttdeci">void __modzprime_MOD_evalamp_qqb_zprime_vv(double P[6][4], int *MYIDUP, double *MatElSq)</div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1ad581500114c5f4c08a35a82589bede5c"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad581500114c5f4c08a35a82589bede5c">TVar::H1minus</a></div><div class="ttdeci">@ H1minus</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00148">TVar.hh:148</a></div></div>
<div class="ttc" id="aclassMELACandidate_html_a3debcffc164edcc882df3cc60fbb059d"><div class="ttname"><a href="classMELACandidate.html#a3debcffc164edcc882df3cc60fbb059d">MELACandidate::addAssociatedPhoton</a></div><div class="ttdeci">void addAssociatedPhoton(MELAParticle *myParticle)</div><div class="ttdef"><b>Definition:</b> <a href="MELACandidate_8cc_source.html#l00613">MELACandidate.cc:613</a></div></div>
<div class="ttc" id="anamespacePDGHelpers_html_a46f4e810ad2fb213e757e3e76499900a"><div class="ttname"><a href="namespacePDGHelpers.html#a46f4e810ad2fb213e757e3e76499900a">PDGHelpers::isAZBoson</a></div><div class="ttdeci">bool isAZBoson(const int id)</div><div class="ttdef"><b>Definition:</b> <a href="PDGHelpers_8cc_source.html#l00076">PDGHelpers.cc:76</a></div></div>
<div class="ttc" id="astructTVar_1_1simple__event__record_html_a47e6f6d74f1c60d73e0328d299467b4e"><div class="ttname"><a href="structTVar_1_1simple__event__record.html#a47e6f6d74f1c60d73e0328d299467b4e">TVar::simple_event_record::nRequested_AssociatedPhotons</a></div><div class="ttdeci">int nRequested_AssociatedPhotons</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00232">TVar.hh:232</a></div></div>
<div class="ttc" id="aTModHiggsJMatEl_8hh_html_af791d297390be936ae83e21a176c34dd"><div class="ttname"><a href="TModHiggsJMatEl_8hh.html#af791d297390be936ae83e21a176c34dd">__modhiggsj_MOD_evalamp_hj</a></div><div class="ttdeci">void __modhiggsj_MOD_evalamp_hj(double P[4][4], double MatElSq[11][11])</div></div>
<div class="ttc" id="anamespaceTUtil_html_a45366db1a43b30a467e146dc8477f771"><div class="ttname"><a href="namespaceTUtil.html#a45366db1a43b30a467e146dc8477f771">TUtil::SetMCFMSpinZeroCouplings</a></div><div class="ttdeci">void SetMCFMSpinZeroCouplings(bool useBSM, SpinZeroCouplings const *Hcouplings, bool forceZZ)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l03360">TUtil.cc:3360</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a59a4f7792e48fb024a873510ce50e04d"><div class="ttname"><a href="TMCFM_8hh.html#a59a4f7792e48fb024a873510ce50e04d">xmin_</a></div><div class="ttdeci">struct @28 xmin_</div></div>
<div class="ttc" id="aTMCFM_8hh_html_ad7cff9081fee4fc231b7e4c55f85d54c"><div class="ttname"><a href="TMCFM_8hh.html#ad7cff9081fee4fc231b7e4c55f85d54c">qq_zzqqstrong_</a></div><div class="ttdeci">void qq_zzqqstrong_(double *p, double *msq)</div></div>
<div class="ttc" id="anamespacemodparameters_html_ab25730bf36fa1669616bd6fbf66f8614"><div class="ttname"><a href="namespacemodparameters.html#ab25730bf36fa1669616bd6fbf66f8614">modparameters::second</a></div><div class="ttdeci">real(8), parameter, public second</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l00105">mod_Parameters.F90:105</a></div></div>
<div class="ttc" id="anamespacemodmisc_html_aec88f7154cdc627bd8c823597a684073"><div class="ttname"><a href="namespacemodmisc.html#aec88f7154cdc627bd8c823597a684073">modmisc::isnan</a></div><div class="ttdeci">logical function isnan(x)</div><div class="ttdef"><b>Definition:</b> <a href="mod__Misc_8F90_source.html#l00380">mod_Misc.F90:380</a></div></div>
<div class="ttc" id="anamespacePDGHelpers_html_a59b8114b6bae55ada5228045303defa7"><div class="ttname"><a href="namespacePDGHelpers.html#a59b8114b6bae55ada5228045303defa7">PDGHelpers::isAnUnknownJet</a></div><div class="ttdeci">bool isAnUnknownJet(const int id)</div><div class="ttdef"><b>Definition:</b> <a href="PDGHelpers_8cc_source.html#l00022">PDGHelpers.cc:22</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4"><div class="ttname"><a href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049aa3c1f17028cdaf8d06a2c69be73084b4">TVar::DEBUG_VERBOSE</a></div><div class="ttdeci">@ DEBUG_VERBOSE</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00052">TVar.hh:52</a></div></div>
<div class="ttc" id="anamespacehto__masses_html_a3684febfe1693403a850a784be51abda"><div class="ttname"><a href="namespacehto__masses.html#a3684febfe1693403a850a784be51abda">hto_masses::msq</a></div><div class="ttdeci">real *8, parameter msq</div><div class="ttdef"><b>Definition:</b> <a href="CALLING__cpHTO_8f_source.html#l00083">CALLING_cpHTO.f:83</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_aa7944801377c33a4e6b405058c03e1c7"><div class="ttname"><a href="namespaceTUtil.html#aa7944801377c33a4e6b405058c03e1c7">TUtil::SetJHUGenSpinOneCouplings</a></div><div class="ttdeci">void SetJHUGenSpinOneCouplings(double Zqqcoupl[SIZE_ZQQ][2], double Zvvcoupl[SIZE_ZVV][2])</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l04086">TUtil.cc:4086</a></div></div>
<div class="ttc" id="anamespacePDGHelpers_html_a01f8690aaafe2c1d9b2497a41270f56a"><div class="ttname"><a href="namespacePDGHelpers.html#a01f8690aaafe2c1d9b2497a41270f56a">PDGHelpers::isAQuark</a></div><div class="ttdeci">bool isAQuark(const int id)</div><div class="ttdef"><b>Definition:</b> <a href="PDGHelpers_8cc_source.html#l00035">PDGHelpers.cc:35</a></div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a16dceeb2bfcab516a854b963eec02e79"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a16dceeb2bfcab516a854b963eec02e79">__modjhugenmela_MOD_resetamplitudeincludes</a></div><div class="ttdeci">void __modjhugenmela_MOD_resetamplitudeincludes()</div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a28527257e5f1be3c6702dfbb44104c9b"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a28527257e5f1be3c6702dfbb44104c9b">TVar::H2_g7</a></div><div class="ttdeci">@ H2_g7</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00158">TVar.hh:158</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_afd769e0556af6d51531e549c9f683e9a"><div class="ttname"><a href="namespaceTUtil.html#afd769e0556af6d51531e549c9f683e9a">TUtil::forbidMassiveLeptons</a></div><div class="ttdeci">bool forbidMassiveLeptons</div><div class="ttdoc">Remove fermion mass if the flag is set to true.</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00025">TUtil.cc:25</a></div></div>
<div class="ttc" id="astructTVar_1_1simple__event__record_html_a210cc509a3d155a23d69c94ea4558f87"><div class="ttname"><a href="structTVar_1_1simple__event__record.html#a210cc509a3d155a23d69c94ea4558f87">TVar::simple_event_record::AssociationVCompatibility</a></div><div class="ttdeci">int AssociationVCompatibility</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00229">TVar.hh:229</a></div></div>
<div class="ttc" id="anamespacemela_html_aed44237203997859afcf9aa344bff4af"><div class="ttname"><a href="namespacemela.html#aed44237203997859afcf9aa344bff4af">mela.mothers</a></div><div class="ttdeci">string mothers</div><div class="ttdef"><b>Definition:</b> <a href="mela_8py_source.html#l00777">mela.py:777</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a2f0fce2b3d66f17b673f2e75d87adf00"><div class="ttname"><a href="namespaceTUtil.html#a2f0fce2b3d66f17b673f2e75d87adf00">TUtil::GetAlphaS</a></div><div class="ttdeci">void GetAlphaS(double *alphas_, double *alphasmz_)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l01794">TUtil.cc:1794</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28caa8167833dfafdcfe495089716e6c1e0b"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caa8167833dfafdcfe495089716e6c1e0b">TVar::ZZQQB_TU</a></div><div class="ttdeci">@ ZZQQB_TU</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00092">TVar.hh:92</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_acf09ac549e89a616531ccb0e4a40fb1c"><div class="ttname"><a href="classSpinZeroCouplings.html#acf09ac549e89a616531ccb0e4a40fb1c">SpinZeroCouplings::separateWWZZcouplings</a></div><div class="ttdeci">bool separateWWZZcouplings</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00062">TCouplings.hh:62</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_a1acee4cbfd07a8bc33651da48059afa4"><div class="ttname"><a href="classSpinZeroCouplings.html#a1acee4cbfd07a8bc33651da48059afa4">SpinZeroCouplings::Httcoupl</a></div><div class="ttdeci">double Httcoupl[SIZE_HQQ][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00029">TCouplings.hh:29</a></div></div>
<div class="ttc" id="anamespacePDGHelpers_html_a68ffb179226737e2006fb7b0870dae6a"><div class="ttname"><a href="namespacePDGHelpers.html#a68ffb179226737e2006fb7b0870dae6a">PDGHelpers::isANeutrino</a></div><div class="ttdeci">bool isANeutrino(const int id)</div><div class="ttdef"><b>Definition:</b> <a href="PDGHelpers_8cc_source.html#l00067">PDGHelpers.cc:67</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_af2f4d9e772c5b03b8554ecbd6778f623"><div class="ttname"><a href="namespaceTUtil.html#af2f4d9e772c5b03b8554ecbd6778f623">TUtil::SetDecayWidth</a></div><div class="ttdeci">void SetDecayWidth(double inwidth, int ipart)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l01491">TUtil.cc:1491</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca4539519c2d018fd29228bdd605c76c47"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4539519c2d018fd29228bdd605c76c47">TVar::ZZGG</a></div><div class="ttdeci">@ ZZGG</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00061">TVar.hh:61</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_aba01db17f4a2bfbc3db60dc172972a25a9ef27f05549f71d70319d03789242cea"><div class="ttname"><a href="TMCFM_8hh.html#aba01db17f4a2bfbc3db60dc172972a25a9ef27f05549f71d70319d03789242cea">nf</a></div><div class="ttdeci">@ nf</div><div class="ttdef"><b>Definition:</b> <a href="TMCFM_8hh_source.html#l00017">TMCFM.hh:17</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a77f3e2ffaa541eb39f8540eaf69dd8ad"><div class="ttname"><a href="namespaceTVar.html#a77f3e2ffaa541eb39f8540eaf69dd8ad">TVar::ProcessName</a></div><div class="ttdeci">TString ProcessName(TVar::Process temp)</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8cc_source.html#l00006">TVar.cc:6</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a9725014132a3701b15e4b3b0ae454288a92ca30ccc4c56e5c0bb63fd87c1a4c87"><div class="ttname"><a href="namespaceTVar.html#a9725014132a3701b15e4b3b0ae454288a92ca30ccc4c56e5c0bb63fd87c1a4c87">TVar::MomentumToEnergy</a></div><div class="ttdeci">@ MomentumToEnergy</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00114">TVar.hh:114</a></div></div>
<div class="ttc" id="anamespaceTJHUGenUtils_html_addcc3291bfa0d4cfc3329f05ae43f929"><div class="ttname"><a href="namespaceTJHUGenUtils.html#addcc3291bfa0d4cfc3329f05ae43f929">TJHUGenUtils::Get_JHUGenHash_OnshellHJJHash</a></div><div class="ttdeci">const std::vector&lt; TNumericUtil::intTriplet_t &gt; &amp; Get_JHUGenHash_OnshellHJJHash()</div><div class="ttdef"><b>Definition:</b> <a href="TJHUGenUtils_8cc_source.html#l00041">TJHUGenUtils.cc:41</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_ae2cf0c66b72320a09e280aa5681d4f19"><div class="ttname"><a href="namespaceTUtil.html#ae2cf0c66b72320a09e280aa5681d4f19">TUtil::MCFM_masscuts</a></div><div class="ttdeci">bool MCFM_masscuts(double s[][mxpart], const TVar::Process &amp;process)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l03289">TUtil.cc:3289</a></div></div>
<div class="ttc" id="anamespacePDGHelpers_html_af9c70c52922e73d3870e6111c1c02a5f"><div class="ttname"><a href="namespacePDGHelpers.html#af9c70c52922e73d3870e6111c1c02a5f">PDGHelpers::isAPhoton</a></div><div class="ttdeci">bool isAPhoton(const int id)</div><div class="ttdef"><b>Definition:</b> <a href="PDGHelpers_8cc_source.html#l00072">PDGHelpers.cc:72</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a8a1a325f3bb025d57fa9b649a31c93d2"><div class="ttname"><a href="namespaceTUtil.html#a8a1a325f3bb025d57fa9b649a31c93d2">TUtil::setLeptonMassScheme</a></div><div class="ttdeci">void setLeptonMassScheme(TVar::FermionMassRemoval scheme=TVar::ConserveDifermionMass)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00037">TUtil.cc:37</a></div></div>
<div class="ttc" id="aclassMelaIO_html_aa20a0b91511fceb3584ad3a7d1ca210a"><div class="ttname"><a href="classMelaIO.html#aa20a0b91511fceb3584ad3a7d1ca210a">MelaIO::setHiggsMassWidth</a></div><div class="ttdeci">void setHiggsMassWidth(const double &amp;mass_, const double &amp;width_, int jh)</div><div class="ttdef"><b>Definition:</b> <a href="MelaIO_8h_source.html#l00143">MelaIO.h:143</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a697cce026b792eb83c62dd2477e35d2a"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a697cce026b792eb83c62dd2477e35d2a">TVar::H0_Zgsg1prime2</a></div><div class="ttdeci">@ H0_Zgsg1prime2</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00130">TVar.hh:130</a></div></div>
<div class="ttc" id="astructTVar_1_1simple__event__record_html_a056a397d9afaee97f896feadbe37b6a9"><div class="ttname"><a href="structTVar_1_1simple__event__record.html#a056a397d9afaee97f896feadbe37b6a9">TVar::simple_event_record::nRequested_Tops</a></div><div class="ttdeci">int nRequested_Tops</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00233">TVar.hh:233</a></div></div>
<div class="ttc" id="anamespaceMELAStreamHelpers_html_a540da07450fb5154e684e182766cd72d"><div class="ttname"><a href="namespaceMELAStreamHelpers.html#a540da07450fb5154e684e182766cd72d">MELAStreamHelpers::MELAout</a></div><div class="ttdeci">MELAOutputStreamer MELAout</div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_aff55bde64f7d5ab91410b05f1aa42198"><div class="ttname"><a href="classSpinZeroCouplings.html#aff55bde64f7d5ab91410b05f1aa42198">SpinZeroCouplings::Hg4g4coupl</a></div><div class="ttdeci">double Hg4g4coupl[SIZE_HGG][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00031">TCouplings.hh:31</a></div></div>
<div class="ttc" id="astructTVar_1_1simple__event__record_html_a5ad00c4240605d33b10f082d06796865"><div class="ttname"><a href="structTVar_1_1simple__event__record.html#a5ad00c4240605d33b10f082d06796865">TVar::simple_event_record::pMothers</a></div><div class="ttdeci">SimpleParticleCollection_t pMothers</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00240">TVar.hh:240</a></div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a44ca02e7e9531918e7b76e9e6cafb254"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a44ca02e7e9531918e7b76e9e6cafb254">__modjhugenmela_MOD_resetmubarhgabarh</a></div><div class="ttdeci">void __modjhugenmela_MOD_resetmubarhgabarh()</div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4c7f8e84ec90eb05c2f94e765fe27ef4">TVar::bkgWW</a></div><div class="ttdeci">@ bkgWW</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00167">TVar.hh:167</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a8dbe2bd8efad9a9d5d55e43c0c6f777bad10522f5bc41f80ca8edf7c195cdb858"><div class="ttname"><a href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777bad10522f5bc41f80ca8edf7c195cdb858">TVar::kNoAssociated</a></div><div class="ttdeci">@ kNoAssociated</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00030">TVar.hh:30</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a2599e53f6f03e850b83dd83d6c296feca92cbe92f4215368249033082e6671aa6"><div class="ttname"><a href="namespaceTVar.html#a2599e53f6f03e850b83dd83d6c296feca92cbe92f4215368249033082e6671aa6">TVar::DefaultLeptonInterf</a></div><div class="ttdeci">@ DefaultLeptonInterf</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00107">TVar.hh:107</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a90b871bcf11dd29b846ec66ff1d149c1"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a90b871bcf11dd29b846ec66ff1d149c1">TVar::H2_g5</a></div><div class="ttdeci">@ H2_g5</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00155">TVar.hh:155</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a9153965831508e074e8ef8fdc0c261b8"><div class="ttname"><a href="namespaceTUtil.html#a9153965831508e074e8ef8fdc0c261b8">TUtil::SetJHUGenSpinTwoCouplings</a></div><div class="ttdeci">void SetJHUGenSpinTwoCouplings(double Gacoupl[SIZE_GGG][2], double Gvvcoupl[SIZE_GVV][2], double Gvvpcoupl[SIZE_GVV][2], double Gvpvpcoupl[SIZE_GVV][2], double qLeftRightcoupl[SIZE_GQQ][2])</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l04087">TUtil.cc:4087</a></div></div>
<div class="ttc" id="aclassMELACandidate_html_a0562974f62f15834e9cfd0d147d4fccd"><div class="ttname"><a href="classMELACandidate.html#a0562974f62f15834e9cfd0d147d4fccd">MELACandidate::getAssociatedPhotons</a></div><div class="ttdeci">std::vector&lt; MELAParticle * &gt; &amp; getAssociatedPhotons()</div><div class="ttdef"><b>Definition:</b> <a href="MELACandidate_8cc_source.html#l00181">MELACandidate.cc:181</a></div></div>
<div class="ttc" id="anamespacePDGHelpers_html_aee1aa3a1dad6c5368cd3334202096328"><div class="ttname"><a href="namespacePDGHelpers.html#aee1aa3a1dad6c5368cd3334202096328">PDGHelpers::isDownTypeQuark</a></div><div class="ttdeci">bool isDownTypeQuark(const int id)</div><div class="ttdef"><b>Definition:</b> <a href="PDGHelpers_8cc_source.html#l00045">PDGHelpers.cc:45</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1d06d440023ad1c1f2a417f80ef3f1b4">TVar::bkgWWZZ</a></div><div class="ttdeci">@ bkgWWZZ</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00168">TVar.hh:168</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a1bae49de3ea6edb6a11ac5666243fb0f"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a1bae49de3ea6edb6a11ac5666243fb0f">TVar::H0_g1prime2</a></div><div class="ttdeci">@ H0_g1prime2</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00127">TVar.hh:127</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_accabe530df4828c083abd7ea98bf5da2"><div class="ttname"><a href="namespaceTUtil.html#accabe530df4828c083abd7ea98bf5da2">TUtil::ConvertVectorFormat</a></div><div class="ttdeci">MELACandidate * ConvertVectorFormat(SimpleParticleCollection_t *pDaughters, SimpleParticleCollection_t *pAssociated, SimpleParticleCollection_t *pMothers, bool isGen, std::vector&lt; MELAParticle * &gt; *particleList, std::vector&lt; MELACandidate * &gt; *candList)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l08410">TUtil.cc:8410</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a7d1fa9afb94e77cd82a7edd6d02abcd4"><div class="ttname"><a href="TMCFM_8hh.html#a7d1fa9afb94e77cd82a7edd6d02abcd4">ewscheme_</a></div><div class="ttdeci">struct @36 ewscheme_</div></div>
<div class="ttc" id="anamespacePDGHelpers_html_ab98f91f00daa234b2d34eaec820cf49f"><div class="ttname"><a href="namespacePDGHelpers.html#ab98f91f00daa234b2d34eaec820cf49f">PDGHelpers::isATopQuark</a></div><div class="ttdeci">bool isATopQuark(const int id)</div><div class="ttdef"><b>Definition:</b> <a href="PDGHelpers_8cc_source.html#l00050">PDGHelpers.cc:50</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a6365df768fe636a9b36f2a3d078ec25e"><div class="ttname"><a href="TMCFM_8hh.html#a6365df768fe636a9b36f2a3d078ec25e">qqb_z2jet_</a></div><div class="ttdeci">void qqb_z2jet_(double *p, double *msq)</div></div>
<div class="ttc" id="anamespaceTVar_html_a8dbe2bd8efad9a9d5d55e43c0c6f777bad693ed4c2007493918e2772261311b29"><div class="ttname"><a href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777bad693ed4c2007493918e2772261311b29">TVar::kUseAssociated_Leptons</a></div><div class="ttdeci">@ kUseAssociated_Leptons</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00031">TVar.hh:31</a></div></div>
<div class="ttc" id="aclassMELACandidate_html_afd1a968bd5724d6333b9cc9194412b8b"><div class="ttname"><a href="classMELACandidate.html#afd1a968bd5724d6333b9cc9194412b8b">MELACandidate::getAssociatedSortedVs</a></div><div class="ttdeci">std::vector&lt; MELAParticle * &gt; getAssociatedSortedVs()</div><div class="ttdef"><b>Definition:</b> <a href="MELACandidate_8cc_source.html#l00193">MELACandidate.cc:193</a></div></div>
<div class="ttc" id="aclassMELAParticle_html_ad4924857d4bf0679c844a652f90c65e6"><div class="ttname"><a href="classMELAParticle.html#ad4924857d4bf0679c844a652f90c65e6">MELAParticle::p4</a></div><div class="ttdeci">TLorentzVector p4</div><div class="ttdef"><b>Definition:</b> <a href="MELAParticle_8h_source.html#l00018">MELAParticle.h:18</a></div></div>
<div class="ttc" id="astructTVar_1_1simple__event__record_html_aacb9500889ee015adae1e4a96abbc138"><div class="ttname"><a href="structTVar_1_1simple__event__record.html#aacb9500889ee015adae1e4a96abbc138">TVar::simple_event_record::intermediateVid</a></div><div class="ttdeci">std::vector&lt; int &gt; intermediateVid</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00237">TVar.hh:237</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1aa86ee768bc80563b0b09ea31c387a9b1"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1aa86ee768bc80563b0b09ea31c387a9b1">TVar::H2_g3</a></div><div class="ttdeci">@ H2_g3</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00153">TVar.hh:153</a></div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a5ba6679a0f52b8b512295bc107e7bb24"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a5ba6679a0f52b8b512295bc107e7bb24">__modjhugenmela_MOD_settopdecays</a></div><div class="ttdeci">void __modjhugenmela_MOD_settopdecays(int *flag)</div></div>
<div class="ttc" id="aTMCFM_8hh_html_af8cdb99be9a8b3fc5881cc93f0e4b6cd"><div class="ttname"><a href="TMCFM_8hh.html#af8cdb99be9a8b3fc5881cc93f0e4b6cd">interference_</a></div><div class="ttdeci">struct @32 interference_</div></div>
<div class="ttc" id="aTMCFM_8hh_html_ab4fa7bf65d1e93991c0da573e9f6a562"><div class="ttname"><a href="TMCFM_8hh.html#ab4fa7bf65d1e93991c0da573e9f6a562">gg_zz_all_</a></div><div class="ttdeci">void gg_zz_all_(double *p, double *msq)</div></div>
<div class="ttc" id="aclassMELAParticle_html_a681ce5a5168b0ec3e210e9fc4894cebf"><div class="ttname"><a href="classMELAParticle.html#a681ce5a5168b0ec3e210e9fc4894cebf">MELAParticle::z</a></div><div class="ttdeci">double z() const</div><div class="ttdef"><b>Definition:</b> <a href="MELAParticle_8h_source.html#l00069">MELAParticle.h:69</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_ae52badace9e1a1c65ac4463569eed5e9"><div class="ttname"><a href="TMCFM_8hh.html#ae52badace9e1a1c65ac4463569eed5e9">nqcdjets_</a></div><div class="ttdeci">struct @27 nqcdjets_</div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a4e91f71cb0ac836cda7d874438325c2e"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a4e91f71cb0ac836cda7d874438325c2e">__modjhugenmela_MOD_setspintwocouplings</a></div><div class="ttdeci">void __modjhugenmela_MOD_setspintwocouplings(double acoupl[SIZE_GGG][2], double vvcoupl[SIZE_GVV][2], double vvpcoupl[SIZE_GVV][2], double vpvpcoupl[SIZE_GVV][2], double qlr[SIZE_GQQ][2])</div></div>
<div class="ttc" id="anamespacetestME__all_html_a2f9c5cba6551dc41bae400ced29c30b3"><div class="ttname"><a href="namespacetestME__all.html#a2f9c5cba6551dc41bae400ced29c30b3">testME_all.int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition:</b> <a href="testME__all_8py_source.html#l00013">testME_all.py:13</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a1706a661b9c70c8a8e5e3180e8ff676f"><div class="ttname"><a href="namespaceTUtil.html#a1706a661b9c70c8a8e5e3180e8ff676f">TUtil::SetJHUGenSpinZeroVVCouplings</a></div><div class="ttdeci">void SetJHUGenSpinZeroVVCouplings(double Hvvcoupl[SIZE_HVV][2], double Hvvpcoupl[SIZE_HVV][2], double Hvpvpcoupl[SIZE_HVV][2], int Hvvcoupl_cqsq[SIZE_HVV_CQSQ], double HvvLambda_qsq[SIZE_HVV_LAMBDAQSQ][SIZE_HVV_CQSQ], bool useWWcoupl)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l04078">TUtil.cc:4078</a></div></div>
<div class="ttc" id="astructTVar_1_1simple__event__record_html_a743a8c341936dbaa10ce50a5b8d87eba"><div class="ttname"><a href="structTVar_1_1simple__event__record.html#a743a8c341936dbaa10ce50a5b8d87eba">TVar::simple_event_record::AssociationCode</a></div><div class="ttdeci">int AssociationCode</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00228">TVar.hh:228</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a425258fa6a3f55bd3c0a40de32725023"><div class="ttname"><a href="TMCFM_8hh.html#a425258fa6a3f55bd3c0a40de32725023">gg_zz_</a></div><div class="ttdeci">void gg_zz_(double *p, double *msq)</div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a0a95bcbfd8f979abb0469b6c1b33f7dc"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a0a95bcbfd8f979abb0469b6c1b33f7dc">TVar::H0_gsgs_PS</a></div><div class="ttdeci">@ H0_gsgs_PS</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00134">TVar.hh:134</a></div></div>
<div class="ttc" id="anamespacetestME__all_html_acfc17ef972d1823c2bdf158421c2caf7"><div class="ttname"><a href="namespacetestME__all.html#acfc17ef972d1823c2bdf158421c2caf7">testME_all.ratio</a></div><div class="ttdeci">ratio</div><div class="ttdef"><b>Definition:</b> <a href="testME__all_8py_source.html#l00136">testME_all.py:136</a></div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_aa6bfa1ec9233870bf10dbaeaa87d4e32"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#aa6bfa1ec9233870bf10dbaeaa87d4e32">__modjhugenmela_MOD_getmvprimegvprime</a></div><div class="ttdeci">void __modjhugenmela_MOD_getmvprimegvprime(double *mv, double *gv)</div></div>
<div class="ttc" id="anamespaceTUtil_html_ac6fdb5a1ca4802adaaee14c1c052efd4"><div class="ttname"><a href="namespaceTUtil.html#ac6fdb5a1ca4802adaaee14c1c052efd4">TUtil::SetJHUGenDistinguishWWCouplings</a></div><div class="ttdeci">void SetJHUGenDistinguishWWCouplings(bool doAllow)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l03353">TUtil.cc:3353</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a929427f793907f66912124e594384151"><div class="ttname"><a href="TMCFM_8hh.html#a929427f793907f66912124e594384151">cutoff_</a></div><div class="ttdeci">struct @33 cutoff_</div></div>
<div class="ttc" id="aTMCFM_8hh_html_acdd562a884d144c74b551ff9afa89cb5"><div class="ttname"><a href="TMCFM_8hh.html#acdd562a884d144c74b551ff9afa89cb5">anomzffcouplings_</a></div><div class="ttdeci">struct @44 anomzffcouplings_</div></div>
<div class="ttc" id="anamespacePDGHelpers_html_a524d028bd6c958101639b40c8bfc5622"><div class="ttname"><a href="namespacePDGHelpers.html#a524d028bd6c958101639b40c8bfc5622">PDGHelpers::getCoupledVertex</a></div><div class="ttdeci">int getCoupledVertex(const int idfirst, const int idsecond, int *hel=0, int *useAHcoupl=0)</div><div class="ttdef"><b>Definition:</b> <a href="PDGHelpers_8cc_source.html#l00235">PDGHelpers.cc:235</a></div></div>
<div class="ttc" id="astructTVar_1_1simple__event__record_html_a2261821b9391dd5f9e8f19f7c225212e"><div class="ttname"><a href="structTVar_1_1simple__event__record.html#a2261821b9391dd5f9e8f19f7c225212e">TVar::simple_event_record::pStableTops</a></div><div class="ttdeci">SimpleParticleCollection_t pStableTops</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00244">TVar.hh:244</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a698cab07ea0defb1d164f4cd17d8b681">TVar::HSMHiggs</a></div><div class="ttdeci">@ HSMHiggs</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00126">TVar.hh:126</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1ad4bc4f19b5b7ed614451e7e9dd9ebfec"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad4bc4f19b5b7ed614451e7e9dd9ebfec">TVar::H2_g2</a></div><div class="ttdeci">@ H2_g2</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00152">TVar.hh:152</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a89b248250ed67dd79baf7e0a911473d2"><div class="ttname"><a href="namespaceTUtil.html#a89b248250ed67dd79baf7e0a911473d2">TUtil::SetJHUGenAZffCouplings</a></div><div class="ttdeci">void SetJHUGenAZffCouplings(bool needAZff, double AZffcoupl[SIZE_AZff][2])</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l04093">TUtil.cc:4093</a></div></div>
<div class="ttc" id="anamespacePDGHelpers_html_a1af3488542122be4701bbdbc558d8bc9"><div class="ttname"><a href="namespacePDGHelpers.html#a1af3488542122be4701bbdbc558d8bc9">PDGHelpers::isAWBoson</a></div><div class="ttdeci">bool isAWBoson(const int id)</div><div class="ttdef"><b>Definition:</b> <a href="PDGHelpers_8cc_source.html#l00080">PDGHelpers.cc:80</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_afbf621553f2be237dab5b05a1f7c4bbd"><div class="ttname"><a href="TMCFM_8hh.html#afbf621553f2be237dab5b05a1f7c4bbd">facscale_</a></div><div class="ttdeci">struct @25 facscale_</div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac8b095c1530f65c8e129bf0ea249c11c">TVar::Lep_WH_TU</a></div><div class="ttdeci">@ Lep_WH_TU</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00100">TVar.hh:100</a></div></div>
<div class="ttc" id="aclassMELAParticle_html_a4766d9d6fec92de6a5ea19bdc745c460"><div class="ttname"><a href="classMELAParticle.html#a4766d9d6fec92de6a5ea19bdc745c460">MELAParticle::charge</a></div><div class="ttdeci">double charge() const</div><div class="ttdef"><b>Definition:</b> <a href="MELAParticle_8cc_source.html#l00090">MELAParticle.cc:90</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_ada8254257e17d5213268aa8bdabc6b72"><div class="ttname"><a href="classSpinZeroCouplings.html#ada8254257e17d5213268aa8bdabc6b72">SpinZeroCouplings::Hbbcoupl</a></div><div class="ttdeci">double Hbbcoupl[SIZE_HQQ][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00030">TCouplings.hh:30</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a2f26259ffb9387326573b0b1c4f2c700"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a2f26259ffb9387326573b0b1c4f2c700">TVar::bkgZGamma</a></div><div class="ttdeci">@ bkgZGamma</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00164">TVar.hh:164</a></div></div>
<div class="ttc" id="aclassAZffCouplings_html_aa964188c2116027c391aa525fdd6418c"><div class="ttname"><a href="classAZffCouplings.html#aa964188c2116027c391aa525fdd6418c">AZffCouplings::AZffcoupl</a></div><div class="ttdeci">double AZffcoupl[SIZE_AZff][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00155">TCouplings.hh:155</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a37afc06e4c298802bcf3594eef50e7c1"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a37afc06e4c298802bcf3594eef50e7c1">TVar::H2_g9</a></div><div class="ttdeci">@ H2_g9</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00160">TVar.hh:160</a></div></div>
<div class="ttc" id="aTModParameters_8hh_html_ad03682febeb063859a8c4dd746245ed7"><div class="ttname"><a href="TModParameters_8hh.html#ad03682febeb063859a8c4dd746245ed7">__modparameters_MOD_getmass</a></div><div class="ttdeci">double __modparameters_MOD_getmass(int *part)</div></div>
<div class="ttc" id="aTMCFM_8hh_html_a4f6a5b3ceab297482e3ab5f300d8008a"><div class="ttname"><a href="TMCFM_8hh.html#a4f6a5b3ceab297482e3ab5f300d8008a">ckmfill_</a></div><div class="ttdeci">void ckmfill_(int *nwz)</div></div>
<div class="ttc" id="aTModParameters_8hh_html_a870d3d3ae6653e7784e4699e3247d628"><div class="ttname"><a href="TModParameters_8hh.html#a870d3d3ae6653e7784e4699e3247d628">__modparameters_MOD_computeckmelements</a></div><div class="ttdeci">void __modparameters_MOD_computeckmelements(double *invckm_ud, double *invckm_us, double *invckm_cd, double *invckm_cs, double *invckm_ts, double *invckm_tb, double *invckm_ub=0, double *invckm_cb=0, double *invckm_td=0)</div></div>
<div class="ttc" id="aTModHiggsMatEl_8hh_html_a0e6333bee6846f54f669b690120ce7d0"><div class="ttname"><a href="TModHiggsMatEl_8hh.html#a0e6333bee6846f54f669b690120ce7d0">__modhiggs_MOD_evalamp_gg_h_vv</a></div><div class="ttdeci">void __modhiggs_MOD_evalamp_gg_h_vv(double P[6][4], int *MYIDUP, double *MatElSq)</div></div>
<div class="ttc" id="anamespaceTVar_html_ab9fe70f6c2d4abb0f3fa561abc04805caa8b7f54e0391e3747b7565a584f57acb"><div class="ttname"><a href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805caa8b7f54e0391e3747b7565a584f57acb">TVar::Fixed_mZPlusmH</a></div><div class="ttdeci">@ Fixed_mZPlusmH</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00202">TVar.hh:202</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1ad029c08e5a58a9284a29aff6fe95ffe1"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1ad029c08e5a58a9284a29aff6fe95ffe1">TVar::H0_gsgs</a></div><div class="ttdeci">@ H0_gsgs</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00133">TVar.hh:133</a></div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a13ab47e1feba00f34a37fe3ffbd6e081"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a13ab47e1feba00f34a37fe3ffbd6e081">__modjhugenmela_MOD_setewparameters</a></div><div class="ttdeci">void __modjhugenmela_MOD_setewparameters(double *inMZ, double *inMW, double *inGf, double *inalpha_QED, double *inxw)</div></div>
<div class="ttc" id="anamespaceTUtil_html_a2abfaba12b321c4f89447482105635a5"><div class="ttname"><a href="namespaceTUtil.html#a2abfaba12b321c4f89447482105635a5">TUtil::GetDecayWidth</a></div><div class="ttdeci">double GetDecayWidth(int ipart)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l01566">TUtil.cc:1566</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a8cff275aa36f42dd114b266e6f8dcd74"><div class="ttname"><a href="namespaceTUtil.html#a8cff275aa36f42dd114b266e6f8dcd74">TUtil::GetCKMElement</a></div><div class="ttdeci">double GetCKMElement(int iquark, int jquark)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l01525">TUtil.cc:1525</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a72bd21a66d7e545ed43e0d91f2f4fbcf"><div class="ttname"><a href="TMCFM_8hh.html#a72bd21a66d7e545ed43e0d91f2f4fbcf">scale_</a></div><div class="ttdeci">struct @24 scale_</div></div>
<div class="ttc" id="aclassMELACandidate_html_a3b992b0d3078afb9ae7b6aab29d648d6"><div class="ttname"><a href="classMELACandidate.html#a3b992b0d3078afb9ae7b6aab29d648d6">MELACandidate::getAssociatedLeptons</a></div><div class="ttdeci">std::vector&lt; MELAParticle * &gt; &amp; getAssociatedLeptons()</div><div class="ttdef"><b>Definition:</b> <a href="MELACandidate_8cc_source.html#l00179">MELACandidate.cc:179</a></div></div>
<div class="ttc" id="aTModTTBHMatEl_8hh_html_a1103926096f38f0f19d326995fadbc81"><div class="ttname"><a href="TModTTBHMatEl_8hh.html#a1103926096f38f0f19d326995fadbc81">__modttbhiggs_MOD_evalxsec_pp_ttbh</a></div><div class="ttdeci">void __modttbhiggs_MOD_evalxsec_pp_ttbh(double Ptth[13][4], int *SelectProcess, double MatElSq[11][11])</div></div>
<div class="ttc" id="aclassMELACandidate_html_abcae02e1f9b8f920878d436c42a1a685"><div class="ttname"><a href="classMELACandidate.html#abcae02e1f9b8f920878d436c42a1a685">MELACandidate::setDecayMode</a></div><div class="ttdeci">void setDecayMode(TVar::CandidateDecayMode flag)</div><div class="ttdef"><b>Definition:</b> <a href="MELACandidate_8cc_source.html#l00112">MELACandidate.cc:112</a></div></div>
<div class="ttc" id="aTModHiggsJJMatEl_8hh_html_a741fd1c45a7cf9fa76a9873e4e2c0d1a"><div class="ttname"><a href="TModHiggsJJMatEl_8hh.html#a741fd1c45a7cf9fa76a9873e4e2c0d1a">__modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact</a></div><div class="ttdeci">void __modhiggsjj_MOD_evalamp_sbfh_unsymm_sa_select_exact(double P[5][4], int *iSel, int *jSel, int *rSel, int *sSel, double *MatElSq)</div></div>
<div class="ttc" id="anamespaceTUtil_html_aec249fff7743f70229476d9a17dadf99"><div class="ttname"><a href="namespaceTUtil.html#aec249fff7743f70229476d9a17dadf99">TUtil::GetMCFMParticleLabel</a></div><div class="ttdeci">TString GetMCFMParticleLabel(const int &amp;pid, bool useQJ, bool useExtendedConventions)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l03249">TUtil.cc:3249</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a928302e7a9815e5777eeea1fcd832a6e"><div class="ttname"><a href="namespaceTUtil.html#a928302e7a9815e5777eeea1fcd832a6e">TUtil::computeVHAngles</a></div><div class="ttdeci">void computeVHAngles(float &amp;costhetastar, float &amp;costheta1, float &amp;costheta2, float &amp;Phi, float &amp;Phi1, float &amp;m1, float &amp;m2, TLorentzVector p4M11, int Z1_lept1Id, TLorentzVector p4M12, int Z1_lept2Id, TLorentzVector p4M21, int Z2_lept1Id, TLorentzVector p4M22, int Z2_lept2Id, TLorentzVector jet1, int jet1Id, TLorentzVector jet2, int jet2Id, TLorentzVector *injet1=0, int injet1Id=0, TLorentzVector *injet2=0, int injet2Id=0)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00873">TUtil.cc:873</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_ab6f80a869b7d926071b8fb28ca4fc39f"><div class="ttname"><a href="classSpinZeroCouplings.html#ab6f80a869b7d926071b8fb28ca4fc39f">SpinZeroCouplings::H2zzCLambda_qsq</a></div><div class="ttdeci">int H2zzCLambda_qsq[SIZE_HVV_CQSQ]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00054">TCouplings.hh:54</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cafdcc8966139806d683f19545622485c2">TVar::Had_ZH_TU</a></div><div class="ttdeci">@ Had_ZH_TU</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00097">TVar.hh:97</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a3d91617913b8024e8b41f4711196815fa23f6a5a26e1e59a26957f95f3b252455"><div class="ttname"><a href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815fa23f6a5a26e1e59a26957f95f3b252455">TVar::MCFM</a></div><div class="ttdeci">@ MCFM</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00056">TVar.hh:56</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3783c9d76eb247e970204db132f049b2">TVar::Lep_ZH_S</a></div><div class="ttdeci">@ Lep_ZH_S</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00088">TVar.hh:88</a></div></div>
<div class="ttc" id="aclassMELAParticle_html"><div class="ttname"><a href="classMELAParticle.html">MELAParticle</a></div><div class="ttdef"><b>Definition:</b> <a href="MELAParticle_8h_source.html#l00013">MELAParticle.h:13</a></div></div>
<div class="ttc" id="anamespacemela_html_a79188ef3c30f518072a2d36f510a5655"><div class="ttname"><a href="namespacemela.html#a79188ef3c30f518072a2d36f510a5655">mela.associated</a></div><div class="ttdeci">string associated</div><div class="ttdef"><b>Definition:</b> <a href="mela_8py_source.html#l00773">mela.py:773</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a4ff35855efcab9061a55f428e228e7dd"><div class="ttname"><a href="TMCFM_8hh.html#a4ff35855efcab9061a55f428e228e7dd">pdlabel_</a></div><div class="ttdeci">struct @56 pdlabel_</div></div>
<div class="ttc" id="aTUtil_8hh_html"><div class="ttname"><a href="TUtil_8hh.html">TUtil.hh</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_a94a2a3ef54a3db5d3f9dc105bf66457f"><div class="ttname"><a href="classSpinZeroCouplings.html#a94a2a3ef54a3db5d3f9dc105bf66457f">SpinZeroCouplings::Hzzcoupl</a></div><div class="ttdeci">double Hzzcoupl[SIZE_HVV][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00035">TCouplings.hh:35</a></div></div>
<div class="ttc" id="anamespaceTUtilHelpers_html_ad3d14e2f2ee73f5f85403a15b71895f3"><div class="ttname"><a href="namespaceTUtilHelpers.html#ad3d14e2f2ee73f5f85403a15b71895f3">TUtilHelpers::copyVector</a></div><div class="ttdeci">void copyVector(std::vector&lt; T &gt; const &amp;input, std::vector&lt; T &gt; &amp;target)</div><div class="ttdef"><b>Definition:</b> <a href="TUtilHelpers_8hh_source.html#l00024">TUtilHelpers.hh:24</a></div></div>
<div class="ttc" id="aTModGravitonMatEl_8hh_html_a8f773a5d358d8f4b82511644f951476f"><div class="ttname"><a href="TModGravitonMatEl_8hh.html#a8f773a5d358d8f4b82511644f951476f">__modgraviton_MOD_evalamp_g_vv</a></div><div class="ttdeci">void __modgraviton_MOD_evalamp_g_vv(double P[6][4], int *MYIDUP, double *MatElSq)</div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca78112f139715de80da62332b06c94926"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca78112f139715de80da62332b06c94926">TVar::JJEW_S</a></div><div class="ttdeci">@ JJEW_S</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00084">TVar.hh:84</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a71a2597822d7f2646209498585c4bbc4aa5f0b613a63c439258383fba8746376a"><div class="ttname"><a href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4aa5f0b613a63c439258383fba8746376a">TVar::CandidateDecay_ZW</a></div><div class="ttdeci">@ CandidateDecay_ZW</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00042">TVar.hh:42</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a90f048ead599709198fca273d41c03c9"><div class="ttname"><a href="TMCFM_8hh.html#a90f048ead599709198fca273d41c03c9">couple_</a></div><div class="ttdeci">struct @34 couple_</div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_a71a2f6f21e8a75ae64e2341c84cb64ad"><div class="ttname"><a href="classSpinZeroCouplings.html#a71a2f6f21e8a75ae64e2341c84cb64ad">SpinZeroCouplings::H2wwcoupl</a></div><div class="ttdeci">double H2wwcoupl[SIZE_HVV][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00051">TCouplings.hh:51</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_aac5f9447172754e1d437b7b004e0ccbf"><div class="ttname"><a href="TMCFM_8hh.html#aac5f9447172754e1d437b7b004e0ccbf">coupling_</a></div><div class="ttdeci">void coupling_()</div></div>
<div class="ttc" id="anamespaceTUtil_html_afa81b178917557f2d5440957bbf5f08b"><div class="ttname"><a href="namespaceTUtil.html#afa81b178917557f2d5440957bbf5f08b">TUtil::computeAngles</a></div><div class="ttdeci">void computeAngles(float &amp;costhetastar, float &amp;costheta1, float &amp;costheta2, float &amp;Phi, float &amp;Phi1, TLorentzVector Z1_lept1, int Z1_lept1Id, TLorentzVector Z1_lept2, int Z1_lept2Id, TLorentzVector Z2_lept1, int Z2_lept1Id, TLorentzVector Z2_lept2, int Z2_lept2Id)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00208">TUtil.cc:208</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a30ecd7cb8ba8ecd70fc2f18c0d7d56ee"><div class="ttname"><a href="namespaceTUtil.html#a30ecd7cb8ba8ecd70fc2f18c0d7d56ee">TUtil::ComplexBoost</a></div><div class="ttdeci">std::pair&lt; TLorentzVector, TLorentzVector &gt; ComplexBoost(TVector3 const &amp;beta, TLorentzVector const &amp;p4)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00166">TUtil.cc:166</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_ab719f9b19416aa6c8df52515ac6a6db4"><div class="ttname"><a href="namespaceTUtil.html#ab719f9b19416aa6c8df52515ac6a6db4">TUtil::SetEwkCouplingParameters</a></div><div class="ttdeci">void SetEwkCouplingParameters(double ext_Gf, double ext_aemmz, double ext_mW, double ext_mZ, double ext_xW, int ext_ewscheme)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l01386">TUtil.cc:1386</a></div></div>
<div class="ttc" id="aTModGravitonMatEl_8hh_html_a8cd4f4f8e0f9b84bb35400f5f8ab5d7c"><div class="ttname"><a href="TModGravitonMatEl_8hh.html#a8cd4f4f8e0f9b84bb35400f5f8ab5d7c">__modgraviton_MOD_evalamp_gg_g_vv</a></div><div class="ttdeci">void __modgraviton_MOD_evalamp_gg_g_vv(double P[6][4], int *MYIDUP, double *MatElSq)</div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a94c24efd1a82cedd7e36b24a08741f51"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a94c24efd1a82cedd7e36b24a08741f51">__modjhugenmela_MOD_sethiggsmasswidth</a></div><div class="ttdeci">void __modjhugenmela_MOD_sethiggsmasswidth(double *mass, double *width)</div></div>
<div class="ttc" id="anamespaceTVar_html_ab9fe70f6c2d4abb0f3fa561abc04805caeddd119fddfd7123176ceb49cf90d1a0"><div class="ttname"><a href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805caeddd119fddfd7123176ceb49cf90d1a0">TVar::Dynamic_qJ_qJ_qH</a></div><div class="ttdeci">@ Dynamic_qJ_qJ_qH</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00208">TVar.hh:208</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_a1182278e790b0eb4383cfe3a8a0ed3e6"><div class="ttname"><a href="classSpinZeroCouplings.html#a1182278e790b0eb4383cfe3a8a0ed3e6">SpinZeroCouplings::H2zzLambda_qsq</a></div><div class="ttdeci">double H2zzLambda_qsq[SIZE_HVV_LAMBDAQSQ][SIZE_HVV_CQSQ]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00052">TCouplings.hh:52</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a9725014132a3701b15e4b3b0ae454288a170700978feec9d94d7fadfdbf36161d"><div class="ttname"><a href="namespaceTVar.html#a9725014132a3701b15e4b3b0ae454288a170700978feec9d94d7fadfdbf36161d">TVar::ConserveDifermionMass</a></div><div class="ttdeci">@ ConserveDifermionMass</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00113">TVar.hh:113</a></div></div>
<div class="ttc" id="anamespaceTVar_html_ab9fe70f6c2d4abb0f3fa561abc04805ca9e7d08a46d59cf452ead5bcb211f8e45"><div class="ttname"><a href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805ca9e7d08a46d59cf452ead5bcb211f8e45">TVar::Dynamic_Softest_pTJ</a></div><div class="ttdeci">@ Dynamic_Softest_pTJ</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00211">TVar.hh:211</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a71a2597822d7f2646209498585c4bbc4af659c7d971f5ab1b23825efde3335ccf"><div class="ttname"><a href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4af659c7d971f5ab1b23825efde3335ccf">TVar::CandidateDecay_ZG</a></div><div class="ttdeci">@ CandidateDecay_ZG</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00043">TVar.hh:43</a></div></div>
<div class="ttc" id="anamespacePDGHelpers_html_af92acaa64c96e22a6dca8b60076a40ec"><div class="ttname"><a href="namespacePDGHelpers.html#af92acaa64c96e22a6dca8b60076a40ec">PDGHelpers::setCandidateDecayMode</a></div><div class="ttdeci">void setCandidateDecayMode(TVar::CandidateDecayMode mode)</div><div class="ttdef"><b>Definition:</b> <a href="PDGHelpers_8cc_source.html#l00232">PDGHelpers.cc:232</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a97664aaabcea7347c605799618ed1764"><div class="ttname"><a href="namespaceTUtil.html#a97664aaabcea7347c605799618ed1764">TUtil::computeAnglesCS</a></div><div class="ttdeci">void computeAnglesCS(float const &amp;pbeam, float &amp;costhetastar, float &amp;costheta1, float &amp;costheta2, float &amp;Phi, float &amp;Phi1, TLorentzVector Z1_lept1, int Z1_lept1Id, TLorentzVector Z1_lept2, int Z1_lept2Id, TLorentzVector Z2_lept1, int Z2_lept1Id, TLorentzVector Z2_lept2, int Z2_lept2Id)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00374">TUtil.cc:374</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a3d91617913b8024e8b41f4711196815f"><div class="ttname"><a href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815f">TVar::MatrixElement</a></div><div class="ttdeci">MatrixElement</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00055">TVar.hh:55</a></div></div>
<div class="ttc" id="astructTVar_1_1event__scales__type_html_a403e32d8e1aab756f9c2b3ff4863139f"><div class="ttname"><a href="structTVar_1_1event__scales__type.html#a403e32d8e1aab756f9c2b3ff4863139f">TVar::event_scales_type::factorizationScheme</a></div><div class="ttdeci">TVar::EventScaleScheme factorizationScheme</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00262">TVar.hh:262</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_addd41c09a8c4a1fa871ea344b48ef74d"><div class="ttname"><a href="classSpinZeroCouplings.html#addd41c09a8c4a1fa871ea344b48ef74d">SpinZeroCouplings::H2wwLambda_qsq</a></div><div class="ttdeci">double H2wwLambda_qsq[SIZE_HVV_LAMBDAQSQ][SIZE_HVV_CQSQ]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00053">TCouplings.hh:53</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_aa296823e617af50b03e6df133187896c"><div class="ttname"><a href="TMCFM_8hh.html#aa296823e617af50b03e6df133187896c">em_</a></div><div class="ttdeci">struct @39 em_</div></div>
<div class="ttc" id="aclassMELACandidate_html_a349e3a335ea7e75dbbee3d558c6aa2c3"><div class="ttname"><a href="classMELACandidate.html#a349e3a335ea7e75dbbee3d558c6aa2c3">MELACandidate::addAssociatedLepton</a></div><div class="ttdeci">void addAssociatedLepton(MELAParticle *myParticle)</div><div class="ttdef"><b>Definition:</b> <a href="MELACandidate_8cc_source.html#l00606">MELACandidate.cc:606</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_a533523154894dc5ceaf772026c431bd0"><div class="ttname"><a href="classSpinZeroCouplings.html#a533523154894dc5ceaf772026c431bd0">SpinZeroCouplings::HzzLambda_qsq</a></div><div class="ttdeci">double HzzLambda_qsq[SIZE_HVV_LAMBDAQSQ][SIZE_HVV_CQSQ]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00037">TCouplings.hh:37</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a98c4e12891441fb50d745cd9c75ec833"><div class="ttname"><a href="TMCFM_8hh.html#a98c4e12891441fb50d745cd9c75ec833">plabel_</a></div><div class="ttdeci">struct @57 plabel_</div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca7f06d733c2cecc34c7fcd2b665ff8b79"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca7f06d733c2cecc34c7fcd2b665ff8b79">TVar::ZZQQB_STU</a></div><div class="ttdeci">@ ZZQQB_STU</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00063">TVar.hh:63</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca100a3d28b2ee4efd9227a4068543848f"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca100a3d28b2ee4efd9227a4068543848f">TVar::JJVBF_TU</a></div><div class="ttdeci">@ JJVBF_TU</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00094">TVar.hh:94</a></div></div>
<div class="ttc" id="astructTVar_1_1event__scales__type_html_a82661b3b8d040c36284a99bde2df79ce"><div class="ttname"><a href="structTVar_1_1event__scales__type.html#a82661b3b8d040c36284a99bde2df79ce">TVar::event_scales_type::fac_scale_factor</a></div><div class="ttdeci">double fac_scale_factor</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00264">TVar.hh:264</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a0df8e93cbad9c2badc80d38e677517ce"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a0df8e93cbad9c2badc80d38e677517ce">TVar::H2_g1</a></div><div class="ttdeci">@ H2_g1</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00151">TVar.hh:151</a></div></div>
<div class="ttc" id="anamespaceTVar_html_ab9fe70f6c2d4abb0f3fa561abc04805ca910aef428690314035df7e6f359f4f61"><div class="ttname"><a href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805ca910aef428690314035df7e6f359f4f61">TVar::Fixed_mZ</a></div><div class="ttdeci">@ Fixed_mZ</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00200">TVar.hh:200</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111"><div class="ttname"><a href="TMCFM_8hh.html#a6b7b47dd702d9e331586d485013fd1eaa0e114837eeba529282c4225945283111">nmsq</a></div><div class="ttdeci">@ nmsq</div><div class="ttdef"><b>Definition:</b> <a href="TMCFM_8hh_source.html#l00024">TMCFM.hh:24</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_a93f78f3f059edcbcaecfdaa486ac7be5"><div class="ttname"><a href="classSpinZeroCouplings.html#a93f78f3f059edcbcaecfdaa486ac7be5">SpinZeroCouplings::Hwwcoupl</a></div><div class="ttdeci">double Hwwcoupl[SIZE_HVV][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00036">TCouplings.hh:36</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_afa7eed75a1c5dfc02d8c068efffe18e7"><div class="ttname"><a href="namespaceTUtil.html#afa7eed75a1c5dfc02d8c068efffe18e7">TUtil::removeMassFromPair</a></div><div class="ttdeci">std::pair&lt; TLorentzVector, TLorentzVector &gt; removeMassFromPair(TLorentzVector const &amp;jet1, int const &amp;jet1Id, TLorentzVector const &amp;jet2, int const &amp;jet2Id, double m1=0, double m2=0)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00074">TUtil.cc:74</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a9587d963d5224d712e16278a297f6983"><div class="ttname"><a href="TMCFM_8hh.html#a9587d963d5224d712e16278a297f6983">srdiags_</a></div><div class="ttdeci">struct @45 srdiags_</div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3b5f612a62ae6eb227bd26af17375655">TVar::bkgWWZZ_SMHiggs</a></div><div class="ttdeci">@ bkgWWZZ_SMHiggs</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00172">TVar.hh:172</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a026e5022c0a942b5d6ea06f02fb8339a"><div class="ttname"><a href="namespaceTUtil.html#a026e5022c0a942b5d6ea06f02fb8339a">TUtil::LeptonMassScheme</a></div><div class="ttdeci">TVar::FermionMassRemoval LeptonMassScheme</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00027">TUtil.cc:27</a></div></div>
<div class="ttc" id="anamespaceTVar_html_ac79830020a0eed4f6dcd3a62a496b016a0730f7b0d30d7559cef4f727cd4533e1"><div class="ttname"><a href="namespaceTVar.html#ac79830020a0eed4f6dcd3a62a496b016a0730f7b0d30d7559cef4f727cd4533e1">TVar::NoPropagator</a></div><div class="ttdeci">@ NoPropagator</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00118">TVar.hh:118</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a3d91617913b8024e8b41f4711196815faba6e6b23b0115bbaa919563a0626be03"><div class="ttname"><a href="namespaceTVar.html#a3d91617913b8024e8b41f4711196815faba6e6b23b0115bbaa919563a0626be03">TVar::JHUGen</a></div><div class="ttdeci">@ JHUGen</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00057">TVar.hh:57</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a72e7c71bfda18734d90f846c43f0e0a5"><div class="ttname"><a href="namespaceTUtil.html#a72e7c71bfda18734d90f846c43f0e0a5">TUtil::GetMassWidth</a></div><div class="ttdeci">void GetMassWidth(int ipart, double &amp;m, double &amp;ga)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l01592">TUtil.cc:1592</a></div></div>
<div class="ttc" id="aclassMELACandidate_html_a53709194c53932ee53830e5308f41fb2"><div class="ttname"><a href="classMELACandidate.html#a53709194c53932ee53830e5308f41fb2">MELACandidate::getAssociatedTops</a></div><div class="ttdeci">std::vector&lt; MELATopCandidate_t * &gt; &amp; getAssociatedTops()</div><div class="ttdef"><b>Definition:</b> <a href="MELACandidate_8cc_source.html#l00183">MELACandidate.cc:183</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca2323942ae07ec12f3d8188e2122b189d">TVar::Had_ZH</a></div><div class="ttdeci">@ Had_ZH</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00075">TVar.hh:75</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a093e725b77d8d09e91509a3767b34faf"><div class="ttname"><a href="TMCFM_8hh.html#a093e725b77d8d09e91509a3767b34faf">qq_wwqqstrong_</a></div><div class="ttdeci">void qq_wwqqstrong_(double *p, double *msq)</div></div>
<div class="ttc" id="anamespaceTVar_html_a9725014132a3701b15e4b3b0ae454288a504d28683182f56661c4f1a590419ff2"><div class="ttname"><a href="namespaceTVar.html#a9725014132a3701b15e4b3b0ae454288a504d28683182f56661c4f1a590419ff2">TVar::NoRemoval</a></div><div class="ttdeci">@ NoRemoval</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00112">TVar.hh:112</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a76d1115e990c3f9eaf2133cd840229e0"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a76d1115e990c3f9eaf2133cd840229e0">TVar::H2_g1g5</a></div><div class="ttdeci">@ H2_g1g5</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00156">TVar.hh:156</a></div></div>
<div class="ttc" id="aTModTTBHMatEl_8hh_html_aa11e2b7b8c645dddc5147f976d1d603b"><div class="ttname"><a href="TModTTBHMatEl_8hh.html#aa11e2b7b8c645dddc5147f976d1d603b">__modttbhiggs_MOD_evalxsec_pp_bbbh</a></div><div class="ttdeci">void __modttbhiggs_MOD_evalxsec_pp_bbbh(double Ptth[13][4], int *SelectProcess, double MatElSq[11][11])</div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a0f52c7dfb21e373a1e23e0741a82b1a5"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a0f52c7dfb21e373a1e23e0741a82b1a5">TVar::H2_g8</a></div><div class="ttdeci">@ H2_g8</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00159">TVar.hh:159</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a34005f7891c27c535153be4ab35211f0"><div class="ttname"><a href="namespaceTUtil.html#a34005f7891c27c535153be4ab35211f0">TUtil::ConvertThreeBodyDecayCandidate</a></div><div class="ttdeci">MELAThreeBodyDecayCandidate * ConvertThreeBodyDecayCandidate(SimpleParticleCollection_t *tbdDaughters, std::vector&lt; MELAParticle * &gt; *particleList, std::vector&lt; MELAThreeBodyDecayCandidate * &gt; *tbdCandList)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l08554">TUtil.cc:8554</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_af5be27557b712d2424494e8ef8933e08"><div class="ttname"><a href="classSpinZeroCouplings.html#af5be27557b712d2424494e8ef8933e08">SpinZeroCouplings::H2g4g4coupl</a></div><div class="ttdeci">double H2g4g4coupl[SIZE_HGG][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00046">TCouplings.hh:46</a></div></div>
<div class="ttc" id="aclassMELAParticle_html_a842ee69ede2f6fbdd62517bc4bcf8946"><div class="ttname"><a href="classMELAParticle.html#a842ee69ede2f6fbdd62517bc4bcf8946">MELAParticle::addMother</a></div><div class="ttdeci">void addMother(MELAParticle *myParticle)</div><div class="ttdef"><b>Definition:</b> <a href="MELAParticle_8cc_source.html#l00062">MELAParticle.cc:62</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a90b6428b41acb4a3ca30d2307d1de436"><div class="ttname"><a href="namespaceTUtil.html#a90b6428b41acb4a3ca30d2307d1de436">TUtil::ComputePDF</a></div><div class="ttdeci">void ComputePDF(const TLorentzVector &amp;p0, const TLorentzVector &amp;p1, double fx1[nmsq], double fx2[nmsq], const double &amp;EBEAM, const TVar::VerbosityLevel &amp;verbosity)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l07877">TUtil.cc:7877</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_af0a7eb81fc049eae88e8be0e72e27451"><div class="ttname"><a href="namespaceTUtil.html#af0a7eb81fc049eae88e8be0e72e27451">TUtil::GetMass</a></div><div class="ttdeci">double GetMass(int ipart)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l01529">TUtil.cc:1529</a></div></div>
<div class="ttc" id="aTModParameters_8hh_html_a2e797b8b4578c30bfcb0cc7f97017e31"><div class="ttname"><a href="TModParameters_8hh.html#a2e797b8b4578c30bfcb0cc7f97017e31">__modparameters_MOD_evalalphas</a></div><div class="ttdeci">void __modparameters_MOD_evalalphas()</div></div>
<div class="ttc" id="aTMCFM_8hh_html_aa02e79dcd0ed143ac3f2ba0e37c72468"><div class="ttname"><a href="TMCFM_8hh.html#aa02e79dcd0ed143ac3f2ba0e37c72468">zcouple_</a></div><div class="ttdeci">struct @47 zcouple_</div></div>
<div class="ttc" id="aTModVHiggsMatEl_8hh_html_ad58177e08a88e14c8aba3a90e95a23da"><div class="ttname"><a href="TModVHiggsMatEl_8hh.html#ad58177e08a88e14c8aba3a90e95a23da">__modvhiggs_MOD_evalamp_vhiggs</a></div><div class="ttdeci">void __modvhiggs_MOD_evalamp_vhiggs(int id[9], double helicity[9], double MomExt[9][4], double *me2)</div></div>
<div class="ttc" id="anamespaceMELAStreamHelpers_html_a48e6b604de686a3c2033bdcf75c51f6f"><div class="ttname"><a href="namespaceMELAStreamHelpers.html#a48e6b604de686a3c2033bdcf75c51f6f">MELAStreamHelpers::MELAerr</a></div><div class="ttdeci">MELAOutputStreamer MELAerr</div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_a9a17477cf1cc3230436d923bbce9bc9b"><div class="ttname"><a href="classSpinZeroCouplings.html#a9a17477cf1cc3230436d923bbce9bc9b">SpinZeroCouplings::H2bbcoupl</a></div><div class="ttdeci">double H2bbcoupl[SIZE_HQQ][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00045">TCouplings.hh:45</a></div></div>
<div class="ttc" id="aTModParameters_8hh_html_aac294ed0754a29f2a41928bb46a04259"><div class="ttname"><a href="TModParameters_8hh.html#aac294ed0754a29f2a41928bb46a04259">__modparameters_MOD_computeewvariables</a></div><div class="ttdeci">void __modparameters_MOD_computeewvariables()</div></div>
<div class="ttc" id="aTMCFM_8hh_html_a99d8a0731137b4ecdedb853dc716dd9d"><div class="ttname"><a href="TMCFM_8hh.html#a99d8a0731137b4ecdedb853dc716dd9d">spinzerohiggs_anomcoupl_</a></div><div class="ttdeci">struct @43 spinzerohiggs_anomcoupl_</div></div>
<div class="ttc" id="anamespaceTVar_html_ac79830020a0eed4f6dcd3a62a496b016"><div class="ttname"><a href="namespaceTVar.html#ac79830020a0eed4f6dcd3a62a496b016">TVar::ResonancePropagatorScheme</a></div><div class="ttdeci">ResonancePropagatorScheme</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00117">TVar.hh:117</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a7166ca25e90c8884ec236febf53bf4c4"><div class="ttname"><a href="TMCFM_8hh.html#a7166ca25e90c8884ec236febf53bf4c4">alphas_</a></div><div class="ttdeci">double alphas_(double *q, double *amz, int *nloop)</div></div>
<div class="ttc" id="anamespaceTUtil_html_a886fd38c76f045c4d516492ecf1cb0ce"><div class="ttname"><a href="namespaceTUtil.html#a886fd38c76f045c4d516492ecf1cb0ce">TUtil::MCFM_SetupParticleCouplings</a></div><div class="ttdeci">bool MCFM_SetupParticleCouplings(const TVar::Process &amp;process, const TVar::Production &amp;production, const TVar::VerbosityLevel &amp;verbosity, const TVar::simple_event_record &amp;mela_event, std::vector&lt; int &gt; *partOrder, std::vector&lt; int &gt; *apartOrder)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l02227">TUtil.cc:2227</a></div></div>
<div class="ttc" id="anamespaceTVar_html_ab9fe70f6c2d4abb0f3fa561abc04805cabc1bc15cd2b43d878d0f3b433cafb392"><div class="ttname"><a href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805cabc1bc15cd2b43d878d0f3b433cafb392">TVar::Dynamic_qH</a></div><div class="ttdeci">@ Dynamic_qH</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00205">TVar.hh:205</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caeaa3caadaa8c091717a24337287cb6ce">TVar::Had_WH_S</a></div><div class="ttdeci">@ Had_WH_S</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00087">TVar.hh:87</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10"><div class="ttname"><a href="TMCFM_8hh.html#aaf105ae5beaca1dee30ae54530691fceaa807e6e258b5a07d460f300f873eab10">mxpart</a></div><div class="ttdeci">@ mxpart</div><div class="ttdef"><b>Definition:</b> <a href="TMCFM_8hh_source.html#l00019">TMCFM.hh:19</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca89a5439f5d7527b48dfb23d3042e8d29"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca89a5439f5d7527b48dfb23d3042e8d29">TVar::JJEW</a></div><div class="ttdeci">@ JJEW</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00073">TVar.hh:73</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a5908ccfb76dc006556fffda3fb26898a"><div class="ttname"><a href="namespaceTUtil.html#a5908ccfb76dc006556fffda3fb26898a">TUtil::forbidMassiveJets</a></div><div class="ttdeci">bool forbidMassiveJets</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00026">TUtil.cc:26</a></div></div>
<div class="ttc" id="anamespacemodparameters_html_a07c57cc6e137206a0865bbad7e6fe289"><div class="ttname"><a href="namespacemodparameters.html#a07c57cc6e137206a0865bbad7e6fe289">modparameters::b2</a></div><div class="ttdeci">complex(8), public b2</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l00937">mod_Parameters.F90:937</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_ac48c90afbcdf62150abcc380ea428eef"><div class="ttname"><a href="namespaceTUtil.html#ac48c90afbcdf62150abcc380ea428eef">TUtil::SetMCFMaTQGCCouplings</a></div><div class="ttdeci">void SetMCFMaTQGCCouplings(bool useBSM, aTQGCCouplings const *couplings)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l03993">TUtil.cc:3993</a></div></div>
<div class="ttc" id="aTModKinematics_8hh_html_a4866c0f1b950b078bcd08db14c1faff7"><div class="ttname"><a href="TModKinematics_8hh.html#a4866c0f1b950b078bcd08db14c1faff7">__modkinematics_MOD_setpdfs</a></div><div class="ttdeci">void __modkinematics_MOD_setpdfs(double *x1, double *x2, double pdf[2][13])</div></div>
<div class="ttc" id="aTUtilHelpers_8hh_html"><div class="ttname"><a href="TUtilHelpers_8hh.html">TUtilHelpers.hh</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a4cc74ca92572b408de0ce370a51f64e5"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4cc74ca92572b408de0ce370a51f64e5">TVar::bkgZZ_SMHiggs</a></div><div class="ttdeci">@ bkgZZ_SMHiggs</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00170">TVar.hh:170</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_ae0c2c9d5a9548eca306e58fb6fd57c9e"><div class="ttname"><a href="TMCFM_8hh.html#ae0c2c9d5a9548eca306e58fb6fd57c9e">qq_vvqq_</a></div><div class="ttdeci">void qq_vvqq_(double *p, double *msq)</div></div>
<div class="ttc" id="anamespaceTUtil_html_aad23bf004cb07fe852407f58e64dabd1"><div class="ttname"><a href="namespaceTUtil.html#aad23bf004cb07fe852407f58e64dabd1">TUtil::computeFakeJet</a></div><div class="ttdeci">void computeFakeJet(TLorentzVector const &amp;realJet, TLorentzVector const &amp;others, TLorentzVector &amp;fakeJet)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00156">TUtil.cc:156</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a71a2597822d7f2646209498585c4bbc4aac6fd43f6de5b9ae55ebf0c6e8e11a8f"><div class="ttname"><a href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4aac6fd43f6de5b9ae55ebf0c6e8e11a8f">TVar::CandidateDecay_WG</a></div><div class="ttdeci">@ CandidateDecay_WG</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00044">TVar.hh:44</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a86a446def8e436c64eed71210f26c8c8">TVar::bkgZZ</a></div><div class="ttdeci">@ bkgZZ</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00166">TVar.hh:166</a></div></div>
<div class="ttc" id="astructTVar_1_1simple__event__record_html_a5885d87c8c2e5dd520b9541e479d71bd"><div class="ttname"><a href="structTVar_1_1simple__event__record.html#a5885d87c8c2e5dd520b9541e479d71bd">TVar::simple_event_record::nRequested_Antitops</a></div><div class="ttdeci">int nRequested_Antitops</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00234">TVar.hh:234</a></div></div>
<div class="ttc" id="aTModParameters_8hh_html_a00e07c5a686985e7a030b7349d0f4998"><div class="ttname"><a href="TModParameters_8hh.html#a00e07c5a686985e7a030b7349d0f4998">convertLHEreverse</a></div><div class="ttdeci">#define convertLHEreverse</div><div class="ttdef"><b>Definition:</b> <a href="TModParameters_8hh_source.html#l00012">TModParameters.hh:12</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_ae18db0378d82ee0e0efb6dab7216690b"><div class="ttname"><a href="namespaceTUtil.html#ae18db0378d82ee0e0efb6dab7216690b">TUtil::TTHiggsMatEl</a></div><div class="ttdeci">double TTHiggsMatEl(const TVar::Process &amp;process, const TVar::Production &amp;production, const TVar::MatrixElement &amp;matrixElement, TVar::event_scales_type *event_scales, MelaIO *RcdME, const double &amp;EBEAM, int topDecay, int topProcess, TVar::VerbosityLevel verbosity)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l07187">TUtil.cc:7187</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a2599e53f6f03e850b83dd83d6c296feca45bd1efd7db2e2687aa602c8a5d1b890"><div class="ttname"><a href="namespaceTVar.html#a2599e53f6f03e850b83dd83d6c296feca45bd1efd7db2e2687aa602c8a5d1b890">TVar::InterfOn</a></div><div class="ttdeci">@ InterfOn</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00108">TVar.hh:108</a></div></div>
<div class="ttc" id="aTModParameters_8hh_html_a45ffcbcc635c30ebcdf7d580a5581314"><div class="ttname"><a href="TModParameters_8hh.html#a45ffcbcc635c30ebcdf7d580a5581314">__modparameters_MOD_ckmbare</a></div><div class="ttdeci">double __modparameters_MOD_ckmbare(int *id1in, int *id2in)</div></div>
<div class="ttc" id="aTModHiggsJJMatEl_8hh_html_acb6833a54c6376230b2a79144dda5c6d"><div class="ttname"><a href="TModHiggsJJMatEl_8hh.html#acb6833a54c6376230b2a79144dda5c6d">__modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact</a></div><div class="ttdeci">void __modhiggsjj_MOD_evalamp_wbfh_unsymm_sa_select_exact(double P[5][4], int *iSel, int *jSel, int *rSel, int *sSel, double *MatElSq)</div></div>
<div class="ttc" id="anamespaceTVar_html_ab9fe70f6c2d4abb0f3fa561abc04805ca81c1d236842e99c1fb6180ad5cb17639"><div class="ttname"><a href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805ca81c1d236842e99c1fb6180ad5cb17639">TVar::Fixed_mW</a></div><div class="ttdeci">@ Fixed_mW</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00199">TVar.hh:199</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a9dabf236e23c4ae39f05d575a1e501f9"><div class="ttname"><a href="namespaceTUtil.html#a9dabf236e23c4ae39f05d575a1e501f9">TUtil::constrainedRemovePairMass</a></div><div class="ttdeci">void constrainedRemovePairMass(TLorentzVector &amp;p1, TLorentzVector &amp;p2, double m1=0, double m2=0)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00039">TUtil.cc:39</a></div></div>
<div class="ttc" id="aTModParameters_8hh_html_a1cad26d34fd7583002925e2456af0380"><div class="ttname"><a href="TModParameters_8hh.html#a1cad26d34fd7583002925e2456af0380">__modparameters_MOD_setmass</a></div><div class="ttdeci">void __modparameters_MOD_setmass(double *mass, int *ipart)</div></div>
<div class="ttc" id="anamespaceTVar_html_ab9fe70f6c2d4abb0f3fa561abc04805ca2413e8a5281007717850721f61459dc3"><div class="ttname"><a href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805ca2413e8a5281007717850721f61459dc3">TVar::Fixed_TwomtPlusmH</a></div><div class="ttdeci">@ Fixed_TwomtPlusmH</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00203">TVar.hh:203</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cae32695dfc129ff6200862b4da8c94f90">TVar::Had_WH_TU</a></div><div class="ttdeci">@ Had_WH_TU</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00098">TVar.hh:98</a></div></div>
<div class="ttc" id="astructTVar_1_1event__scales__type_html_a7fe18004bd29525d34dcd6cb2b42a5b8"><div class="ttname"><a href="structTVar_1_1event__scales__type.html#a7fe18004bd29525d34dcd6cb2b42a5b8">TVar::event_scales_type::ren_scale_factor</a></div><div class="ttdeci">double ren_scale_factor</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00263">TVar.hh:263</a></div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a4a1867add3675a9fa2482cff9f4537d3"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a4a1867add3675a9fa2482cff9f4537d3">__modjhugenmela_MOD_getmvgv</a></div><div class="ttdeci">void __modjhugenmela_MOD_getmvgv(double *mv, double *gv)</div></div>
<div class="ttc" id="aTMCFM_8hh_html_a914dc3178fb8eee8af06815fec8b6233"><div class="ttname"><a href="TMCFM_8hh.html#a914dc3178fb8eee8af06815fec8b6233">qq_wwqq_</a></div><div class="ttdeci">void qq_wwqq_(double *p, double *msq)</div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a803fb6597b0bc5a5e0e2c4b88c57307a"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a803fb6597b0bc5a5e0e2c4b88c57307a">TVar::H0_Zgs</a></div><div class="ttdeci">@ H0_Zgs</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00131">TVar.hh:131</a></div></div>
<div class="ttc" id="aclassMELACandidate_html_a8d1ea43958f7a2ecf1f35006eb8152e8"><div class="ttname"><a href="classMELACandidate.html#a8d1ea43958f7a2ecf1f35006eb8152e8">MELACandidate::getAssociatedJets</a></div><div class="ttdeci">std::vector&lt; MELAParticle * &gt; &amp; getAssociatedJets()</div><div class="ttdef"><b>Definition:</b> <a href="MELACandidate_8cc_source.html#l00182">MELACandidate.cc:182</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca57c0e01faf9fc912284d7b1951fee889"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca57c0e01faf9fc912284d7b1951fee889">TVar::ttH</a></div><div class="ttdeci">@ ttH</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00066">TVar.hh:66</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html"><div class="ttname"><a href="classSpinZeroCouplings.html">SpinZeroCouplings</a></div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00007">TCouplings.hh:7</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a4850105ad013a92a4c9cbe6cfa97d794"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a4850105ad013a92a4c9cbe6cfa97d794">TVar::SelfDefine_spin0</a></div><div class="ttdeci">@ SelfDefine_spin0</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00180">TVar.hh:180</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a8b3783c74e8947c4c7f5c1bb2d6cef5e"><div class="ttname"><a href="namespaceTUtil.html#a8b3783c74e8947c4c7f5c1bb2d6cef5e">TUtil::InitJHUGenMELA</a></div><div class="ttdeci">void InitJHUGenMELA(const char *pathtoPDFSet, int PDFMember, double collider_sqrts)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l03337">TUtil.cc:3337</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_acbd6a89aeedf5d91b0a3345f180652a1"><div class="ttname"><a href="TMCFM_8hh.html#acbd6a89aeedf5d91b0a3345f180652a1">ewcharge_</a></div><div class="ttdeci">struct @40 ewcharge_</div></div>
<div class="ttc" id="anamespaceTUtil_html_a460b9061f340996162890fcbdbef34b9"><div class="ttname"><a href="namespaceTUtil.html#a460b9061f340996162890fcbdbef34b9">TUtil::SumMatrixElementPDF</a></div><div class="ttdeci">double SumMatrixElementPDF(const TVar::Process &amp;process, const TVar::Production &amp;production, const TVar::MatrixElement &amp;matrixElement, const TVar::LeptonInterference &amp;leptonInterf, TVar::event_scales_type *event_scales, MelaIO *RcdME, const double &amp;EBEAM, TVar::VerbosityLevel verbosity)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l04103">TUtil.cc:4103</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a26cbf0643a080b35caacdac8b3ca3a26"><div class="ttname"><a href="TMCFM_8hh.html#a26cbf0643a080b35caacdac8b3ca3a26">gg_hvv_tb_</a></div><div class="ttdeci">void gg_hvv_tb_(double *p, double *msq)</div></div>
<div class="ttc" id="anamespacePDGHelpers_html_aa131c0152ebf5bd159b177834aebc66f"><div class="ttname"><a href="namespacePDGHelpers.html#aa131c0152ebf5bd159b177834aebc66f">PDGHelpers::isAGluon</a></div><div class="ttdeci">bool isAGluon(const int id)</div><div class="ttdef"><b>Definition:</b> <a href="PDGHelpers_8cc_source.html#l00058">PDGHelpers.cc:58</a></div></div>
<div class="ttc" id="astructTVar_1_1simple__event__record_html_a53c971bb7cdfc390927309ca66fa77b4"><div class="ttname"><a href="structTVar_1_1simple__event__record.html#a53c971bb7cdfc390927309ca66fa77b4">TVar::simple_event_record::pAssociated</a></div><div class="ttdeci">SimpleParticleCollection_t pAssociated</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00239">TVar.hh:239</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca3706a5c493f245b1f6231e93e31383ea"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3706a5c493f245b1f6231e93e31383ea">TVar::JQCD</a></div><div class="ttdeci">@ JQCD</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00069">TVar.hh:69</a></div></div>
<div class="ttc" id="aclassMELAParticle_html_afca775f013fab57b11b4e586df949236"><div class="ttname"><a href="classMELAParticle.html#afca775f013fab57b11b4e586df949236">MELAParticle::getMother</a></div><div class="ttdeci">MELAParticle * getMother(int index) const</div><div class="ttdef"><b>Definition:</b> <a href="MELAParticle_8cc_source.html#l00064">MELAParticle.cc:64</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_a59e3b4abd4b8e417005f2dc9f0a2b94b"><div class="ttname"><a href="classSpinZeroCouplings.html#a59e3b4abd4b8e417005f2dc9f0a2b94b">SpinZeroCouplings::HwwCLambda_qsq</a></div><div class="ttdeci">int HwwCLambda_qsq[SIZE_HVV_CQSQ]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00040">TCouplings.hh:40</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a8852a945ad0b8536ee161f7ddb1e4be0"><div class="ttname"><a href="TMCFM_8hh.html#a8852a945ad0b8536ee161f7ddb1e4be0">npart</a></div><div class="ttdeci">int npart</div><div class="ttdef"><b>Definition:</b> <a href="TMCFM_8hh_source.html#l00077">TMCFM.hh:77</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_ac1527caab4673d577edefd7d64c6f9f9"><div class="ttname"><a href="namespaceTUtil.html#ac1527caab4673d577edefd7d64c6f9f9">TUtil::JetMassScheme</a></div><div class="ttdeci">TVar::FermionMassRemoval JetMassScheme</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00028">TUtil.cc:28</a></div></div>
<div class="ttc" id="aTModParameters_8hh_html_aa4ac2f250b3f0ccd7cfbce24aea16336"><div class="ttname"><a href="TModParameters_8hh.html#aa4ac2f250b3f0ccd7cfbce24aea16336">__modparameters_MOD_getdecaywidth</a></div><div class="ttdeci">double __modparameters_MOD_getdecaywidth(int *part)</div></div>
<div class="ttc" id="aTMCFM_8hh_html_ac7e93fc031845d323db73d275dee5d58"><div class="ttname"><a href="TMCFM_8hh.html#ac7e93fc031845d323db73d275dee5d58">ewcouple_</a></div><div class="ttdeci">struct @38 ewcouple_</div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a9648f270b230cc027d720bbc5bb0b160"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a9648f270b230cc027d720bbc5bb0b160">TVar::H2_g6</a></div><div class="ttdeci">@ H2_g6</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00157">TVar.hh:157</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_ad7d6c16e0c48f31d8508784342540479"><div class="ttname"><a href="TMCFM_8hh.html#ad7d6c16e0c48f31d8508784342540479">cabib_</a></div><div class="ttdeci">struct @49 cabib_</div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca161513eec8128c71971167ddb7e373bd">TVar::Lep_ZH</a></div><div class="ttdeci">@ Lep_ZH</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00077">TVar.hh:77</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_af687bb73fd90cec7409110c06be8a7de"><div class="ttname"><a href="TMCFM_8hh.html#af687bb73fd90cec7409110c06be8a7de">masses_mcfm_</a></div><div class="ttdeci">struct @42 masses_mcfm_</div></div>
<div class="ttc" id="aTMCFM_8hh_html_a6ffd3cf62c5a0b584e1890c65542bbed"><div class="ttname"><a href="TMCFM_8hh.html#a6ffd3cf62c5a0b584e1890c65542bbed">nwz_</a></div><div class="ttdeci">struct @48 nwz_</div></div>
<div class="ttc" id="aTModParameters_8hh_html_acbe6f52cddf3b91cceb15289fed004e7"><div class="ttname"><a href="TModParameters_8hh.html#acbe6f52cddf3b91cceb15289fed004e7">__modparameters_MOD_setdecaywidth</a></div><div class="ttdeci">void __modparameters_MOD_setdecaywidth(double *width, int *ipart)</div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a3edf1b64527ef72ccfa6393ba3740408"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a3edf1b64527ef72ccfa6393ba3740408">__modjhugenmela_MOD_setdecaymodes</a></div><div class="ttdeci">void __modjhugenmela_MOD_setdecaymodes(int idfirst[2], int idsecond[2])</div></div>
<div class="ttc" id="astructTVar_1_1event__scales__type_html_aabb9b35b555961e98acc8855bc6c2159"><div class="ttname"><a href="structTVar_1_1event__scales__type.html#aabb9b35b555961e98acc8855bc6c2159">TVar::event_scales_type::renomalizationScheme</a></div><div class="ttdeci">TVar::EventScaleScheme renomalizationScheme</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00261">TVar.hh:261</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a22ae65dea83b7d412dd94f09ac3b7de7"><div class="ttname"><a href="namespaceTUtil.html#a22ae65dea83b7d412dd94f09ac3b7de7">TUtil::adjustTopDaughters</a></div><div class="ttdeci">void adjustTopDaughters(SimpleParticleCollection_t &amp;daughters)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00132">TUtil.cc:132</a></div></div>
<div class="ttc" id="aclassMelaIO_html_a4949a3f6e4a6e6d4337f98bb00d9fd7a"><div class="ttname"><a href="classMelaIO.html#a4949a3f6e4a6e6d4337f98bb00d9fd7a">MelaIO::setVDaughterCouplings</a></div><div class="ttdeci">void setVDaughterCouplings(const double &amp;left, const double &amp;right, int iv)</div><div class="ttdef"><b>Definition:</b> <a href="MelaIO_8h_source.html#l00147">MelaIO.h:147</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca3ae97ff9bcb97541f88b75dc6b28c2af"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca3ae97ff9bcb97541f88b75dc6b28c2af">TVar::ZZQQB_S</a></div><div class="ttdeci">@ ZZQQB_S</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00081">TVar.hh:81</a></div></div>
<div class="ttc" id="aclassMELACandidate_html_a85ab0d1d29d443ea8fa3957e7262e57e"><div class="ttname"><a href="classMELACandidate.html#a85ab0d1d29d443ea8fa3957e7262e57e">MELACandidate::sortDaughters</a></div><div class="ttdeci">void sortDaughters()</div><div class="ttdef"><b>Definition:</b> <a href="MELACandidate_8cc_source.html#l00117">MELACandidate.cc:117</a></div></div>
<div class="ttc" id="astructTVar_1_1simple__event__record_html_ab39f490ca0e69323fbbdbabfcb394306"><div class="ttname"><a href="structTVar_1_1simple__event__record.html#ab39f490ca0e69323fbbdbabfcb394306">TVar::simple_event_record::pAntitopDaughters</a></div><div class="ttdeci">std::vector&lt; SimpleParticleCollection_t &gt; pAntitopDaughters</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00243">TVar.hh:243</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_acde6aecebe262c71d1c23d1460186a2e"><div class="ttname"><a href="TMCFM_8hh.html#acde6aecebe262c71d1c23d1460186a2e">Q</a></div><div class="ttdeci">double Q[11]</div><div class="ttdef"><b>Definition:</b> <a href="TMCFM_8hh_source.html#l00121">TMCFM.hh:121</a></div></div>
<div class="ttc" id="aclassMELACandidate_html"><div class="ttname"><a href="classMELACandidate.html">MELACandidate</a></div><div class="ttdef"><b>Definition:</b> <a href="MELACandidate_8h_source.html#l00007">MELACandidate.h:7</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_af6d616d949d1a340c25d2ed39edd5ddd"><div class="ttname"><a href="namespaceTUtil.html#af6d616d949d1a340c25d2ed39edd5ddd">TUtil::CheckPartonMomFraction</a></div><div class="ttdeci">bool CheckPartonMomFraction(const TLorentzVector &amp;p0, const TLorentzVector &amp;p1, double xx[2], const double &amp;EBEAM, const TVar::VerbosityLevel &amp;verbosity)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l07852">TUtil.cc:7852</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_ad182783475deccf0cb5769e44bc7c4b7"><div class="ttname"><a href="TMCFM_8hh.html#ad182783475deccf0cb5769e44bc7c4b7">qqb_ww_</a></div><div class="ttdeci">void qqb_ww_(double *p, double *msq)</div></div>
<div class="ttc" id="anamespaceTUtil_html_ac5984b5d69c38cd854dc9368ba0d66ef"><div class="ttname"><a href="namespaceTUtil.html#ac5984b5d69c38cd854dc9368ba0d66ef">TUtil::SetJHUGenSpinZeroQQCouplings</a></div><div class="ttdeci">void SetJHUGenSpinZeroQQCouplings(double Hqqcoupl[SIZE_HQQ][2])</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l04085">TUtil.cc:4085</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce"><div class="ttname"><a href="namespaceTVar.html#a159a43323e3b4e8a2dcfdc2ac09e2049a27ff6de5b957337eb890e47b185ed3ce">TVar::DEBUG</a></div><div class="ttdeci">@ DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00051">TVar.hh:51</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28cada9ae823e21061c18721960aadabee2c"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cada9ae823e21061c18721960aadabee2c">TVar::JJEWQCD_S</a></div><div class="ttdeci">@ JJEWQCD_S</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00085">TVar.hh:85</a></div></div>
<div class="ttc" id="anamespacemela_html_aab83238ea47f824af8b4c4a4c3e2fff0"><div class="ttname"><a href="namespacemela.html#aab83238ea47f824af8b4c4a4c3e2fff0">mela.couplings</a></div><div class="ttdeci">tuple couplings</div><div class="ttdef"><b>Definition:</b> <a href="mela_8py_source.html#l00791">mela.py:791</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_af926a87ba8e82a650b0fbc3edf1c942f"><div class="ttname"><a href="classSpinZeroCouplings.html#af926a87ba8e82a650b0fbc3edf1c942f">SpinZeroCouplings::H2wwCLambda_qsq</a></div><div class="ttdeci">int H2wwCLambda_qsq[SIZE_HVV_CQSQ]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00055">TCouplings.hh:55</a></div></div>
<div class="ttc" id="aMELAStreamHelpers_8hh_html"><div class="ttname"><a href="MELAStreamHelpers_8hh.html">MELAStreamHelpers.hh</a></div></div>
<div class="ttc" id="astructTVar_1_1simple__event__record_html_a3051f9440dc00a0a74b80997e898a5f5"><div class="ttname"><a href="structTVar_1_1simple__event__record.html#a3051f9440dc00a0a74b80997e898a5f5">TVar::simple_event_record::nRequested_AssociatedLeptons</a></div><div class="ttdeci">int nRequested_AssociatedLeptons</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00231">TVar.hh:231</a></div></div>
<div class="ttc" id="aclassMELAThreeBodyDecayCandidate_html"><div class="ttname"><a href="classMELAThreeBodyDecayCandidate.html">MELAThreeBodyDecayCandidate</a></div><div class="ttdef"><b>Definition:</b> <a href="MELAThreeBodyDecayCandidate_8h_source.html#l00007">MELAThreeBodyDecayCandidate.h:7</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a256dab2b7cb0550c98a8956864c9c70c"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a256dab2b7cb0550c98a8956864c9c70c">TVar::H2_g4</a></div><div class="ttdeci">@ H2_g4</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00154">TVar.hh:154</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_aac90f56581663b0c22980394abd0ad11"><div class="ttname"><a href="TMCFM_8hh.html#aac90f56581663b0c22980394abd0ad11">ewinput_</a></div><div class="ttdeci">struct @35 ewinput_</div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca4c10b0b90ea432d42a32a4ac8a099a1b"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca4c10b0b90ea432d42a32a4ac8a099a1b">TVar::JJEWQCD_TU</a></div><div class="ttdeci">@ JJEWQCD_TU</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00096">TVar.hh:96</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_aef44b17288a914b738c4fbdf55d64dbb"><div class="ttname"><a href="TMCFM_8hh.html#aef44b17288a914b738c4fbdf55d64dbb">lastphot_</a></div><div class="ttdeci">struct @54 lastphot_</div></div>
<div class="ttc" id="aTVar_8hh_html_ac8ad3b9b9fb4621a213e219ad7289d76"><div class="ttname"><a href="TVar_8hh.html#ac8ad3b9b9fb4621a213e219ad7289d76">SimpleParticleCollection_t</a></div><div class="ttdeci">std::vector&lt; SimpleParticle_t &gt; SimpleParticleCollection_t</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00025">TVar.hh:25</a></div></div>
<div class="ttc" id="anamespaceTUtil_html"><div class="ttname"><a href="namespaceTUtil.html">TUtil</a></div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8hh_source.html#l00048">TUtil.hh:48</a></div></div>
<div class="ttc" id="anamespaceTVar_html_ab9fe70f6c2d4abb0f3fa561abc04805cacf38211651fe3f026d3323b90762b955"><div class="ttname"><a href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805cacf38211651fe3f026d3323b90762b955">TVar::Dynamic_qJJH</a></div><div class="ttdeci">@ Dynamic_qJJH</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00206">TVar.hh:206</a></div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a37c6cad193fe8886ac9fc33913b7ace0"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a37c6cad193fe8886ac9fc33913b7ace0">__modjhugenmela_MOD_setspinonecouplings</a></div><div class="ttdeci">void __modjhugenmela_MOD_setspinonecouplings(double qqcoupl[SIZE_ZQQ][2], double vvcoupl[SIZE_ZVV][2])</div></div>
<div class="ttc" id="aTMCFM_8hh_html_a8b1a2900f63cee7b8b7726fb5a6497ad"><div class="ttname"><a href="TMCFM_8hh.html#a8b1a2900f63cee7b8b7726fb5a6497ad">gg_vv_</a></div><div class="ttdeci">void gg_vv_(double *p, double *msq)</div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_ac2de2325a37bdded726f16460fd79a0f"><div class="ttname"><a href="classSpinZeroCouplings.html#ac2de2325a37bdded726f16460fd79a0f">SpinZeroCouplings::H2ttcoupl</a></div><div class="ttdeci">double H2ttcoupl[SIZE_HQQ][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00044">TCouplings.hh:44</a></div></div>
<div class="ttc" id="anamespaceTVar_html_ab9fe70f6c2d4abb0f3fa561abc04805cabff9613912b7618ad30a4c8360ec9dea"><div class="ttname"><a href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805cabff9613912b7618ad30a4c8360ec9dea">TVar::DefaultScaleScheme</a></div><div class="ttdeci">@ DefaultScaleScheme</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00197">TVar.hh:197</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a71a2597822d7f2646209498585c4bbc4abf438fbd5ea78acf6ed796714b309583"><div class="ttname"><a href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4abf438fbd5ea78acf6ed796714b309583">TVar::CandidateDecay_ff</a></div><div class="ttdeci">@ CandidateDecay_ff</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00039">TVar.hh:39</a></div></div>
<div class="ttc" id="anamespacePDGHelpers_html_a794b5a5be20c1b6004500abb9938deec"><div class="ttname"><a href="namespacePDGHelpers.html#a794b5a5be20c1b6004500abb9938deec">PDGHelpers::isATauLepton</a></div><div class="ttdeci">bool isATauLepton(const int id)</div><div class="ttdef"><b>Definition:</b> <a href="PDGHelpers_8cc_source.html#l00054">PDGHelpers.cc:54</a></div></div>
<div class="ttc" id="anamespaceTVar_html_ab9fe70f6c2d4abb0f3fa561abc04805ca0d937411470defd3a6e748a4e8bfcc62"><div class="ttname"><a href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805ca0d937411470defd3a6e748a4e8bfcc62">TVar::Fixed_mtPlusmH</a></div><div class="ttdeci">@ Fixed_mtPlusmH</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00204">TVar.hh:204</a></div></div>
<div class="ttc" id="aclassMELACandidate_html_a5c9c2090d9da51250048c0b70f4a29f3"><div class="ttname"><a href="classMELACandidate.html#a5c9c2090d9da51250048c0b70f4a29f3">MELACandidate::getDecayMode</a></div><div class="ttdeci">TVar::CandidateDecayMode getDecayMode() const</div><div class="ttdef"><b>Definition:</b> <a href="MELACandidate_8h_source.html#l00055">MELACandidate.h:55</a></div></div>
<div class="ttc" id="aTModKinematics_8hh_html_a73f3e00258b646b5d30697ce71d76af3"><div class="ttname"><a href="TModKinematics_8hh.html#a73f3e00258b646b5d30697ce71d76af3">__modkinematics_MOD_getbwpropagator</a></div><div class="ttdeci">double __modkinematics_MOD_getbwpropagator(double *shat, int *scheme)</div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca97ce0d58eebcc5155081864c77b0a19a">TVar::Had_WH</a></div><div class="ttdeci">@ Had_WH</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00076">TVar.hh:76</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a3b31843cde69d917445902e679909e6e"><div class="ttname"><a href="TMCFM_8hh.html#a3b31843cde69d917445902e679909e6e">bveg1_mcfm_</a></div><div class="ttdeci">struct @22 bveg1_mcfm_</div></div>
<div class="ttc" id="aTMCFM_8hh_html_a819542dc6ff812e041d403592a6b8990"><div class="ttname"><a href="TMCFM_8hh.html#a819542dc6ff812e041d403592a6b8990">nlooprun_</a></div><div class="ttdeci">struct @52 nlooprun_</div></div>
<div class="ttc" id="aTMCFM_8hh_html_abf7be34aa9d044bc74b481967e5e1245"><div class="ttname"><a href="TMCFM_8hh.html#abf7be34aa9d044bc74b481967e5e1245">sqrts</a></div><div class="ttdeci">double sqrts</div><div class="ttdef"><b>Definition:</b> <a href="TMCFM_8hh_source.html#l00290">TMCFM.hh:290</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28caf04b7e8e4c0900b0206ceaa88dc50271"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caf04b7e8e4c0900b0206ceaa88dc50271">TVar::JJEW_TU</a></div><div class="ttdeci">@ JJEW_TU</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00095">TVar.hh:95</a></div></div>
<div class="ttc" id="anamespaceTVar_html_ab9fe70f6c2d4abb0f3fa561abc04805cae313d1a3b64c3b8b487652aa346ec57b"><div class="ttname"><a href="namespaceTVar.html#ab9fe70f6c2d4abb0f3fa561abc04805cae313d1a3b64c3b8b487652aa346ec57b">TVar::Dynamic_Leading_pTJ</a></div><div class="ttdeci">@ Dynamic_Leading_pTJ</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00210">TVar.hh:210</a></div></div>
<div class="ttc" id="aclassMELAParticle_html_aa386f1d8d5641ba54762863d0636ad74"><div class="ttname"><a href="classMELAParticle.html#aa386f1d8d5641ba54762863d0636ad74">MELAParticle::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="MELAParticle_8h_source.html#l00017">MELAParticle.h:17</a></div></div>
<div class="ttc" id="aclassMelaIO_html_aebe453b6e0a6bf08d7aa68c1927ae48f"><div class="ttname"><a href="classMelaIO.html#aebe453b6e0a6bf08d7aa68c1927ae48f">MelaIO::melaCand</a></div><div class="ttdeci">MELACandidate * melaCand</div><div class="ttdef"><b>Definition:</b> <a href="MelaIO_8h_source.html#l00029">MelaIO.h:29</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28c"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28c">TVar::Production</a></div><div class="ttdeci">Production</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00060">TVar.hh:60</a></div></div>
<div class="ttc" id="anamespaceTMCFMUtils_html_aef81a55fd97ffadcaabc57015b59e4ee"><div class="ttname"><a href="namespaceTMCFMUtils.html#aef81a55fd97ffadcaabc57015b59e4ee">TMCFMUtils::AssociatedParticleOrdering_QQVVQQAny</a></div><div class="ttdeci">void AssociatedParticleOrdering_QQVVQQAny(int iSel, int jSel, int rSel, int sSel, int order[2])</div><div class="ttdef"><b>Definition:</b> <a href="TMCFMUtils_8cc_source.html#l00018">TMCFMUtils.cc:18</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a5ac253858407e89f0aec0203338a99ac"><div class="ttname"><a href="TMCFM_8hh.html#a5ac253858407e89f0aec0203338a99ac">qqb_zz_</a></div><div class="ttdeci">void qqb_zz_(double *p, double *msq)</div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_a6fa253fbbe5c57ec1cb7a11d2d5542d4"><div class="ttname"><a href="classSpinZeroCouplings.html#a6fa253fbbe5c57ec1cb7a11d2d5542d4">SpinZeroCouplings::H2t4t4coupl</a></div><div class="ttdeci">double H2t4t4coupl[SIZE_HQQ][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00047">TCouplings.hh:47</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_ac7c53005d835398935c9b0612b460762"><div class="ttname"><a href="TMCFM_8hh.html#ac7c53005d835398935c9b0612b460762">nuflav_</a></div><div class="ttdeci">struct @30 nuflav_</div></div>
<div class="ttc" id="anamespaceTUtil_html_a4f9532dc2110d5229def322ed98d61bc"><div class="ttname"><a href="namespaceTUtil.html#a4f9532dc2110d5229def322ed98d61bc">TUtil::setJetMassScheme</a></div><div class="ttdeci">void setJetMassScheme(TVar::FermionMassRemoval scheme=TVar::ConserveDifermionMass)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00038">TUtil.cc:38</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca902db21776e8b4069184189a3d35976a"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca902db21776e8b4069184189a3d35976a">TVar::JJVBF_S</a></div><div class="ttdeci">@ JJVBF_S</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00083">TVar.hh:83</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28caab9dfee3e5e0a6cb283bc7c1cca8de5d">TVar::Lep_WH</a></div><div class="ttdeci">@ Lep_WH</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00078">TVar.hh:78</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_ac25514d0b4bfda2daae52ee27f8d2fe8"><div class="ttname"><a href="namespaceTUtil.html#ac25514d0b4bfda2daae52ee27f8d2fe8">TUtil::computeVBFAngles</a></div><div class="ttdeci">void computeVBFAngles(float &amp;costhetastar, float &amp;costheta1, float &amp;costheta2, float &amp;Phi, float &amp;Phi1, float &amp;Q2V1, float &amp;Q2V2, TLorentzVector p4M11, int Z1_lept1Id, TLorentzVector p4M12, int Z1_lept2Id, TLorentzVector p4M21, int Z2_lept1Id, TLorentzVector p4M22, int Z2_lept2Id, TLorentzVector jet1, int jet1Id, TLorentzVector jet2, int jet2Id, TLorentzVector *injet1=0, int injet1Id=0, TLorentzVector *injet2=0, int injet2Id=0)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00596">TUtil.cc:596</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_a2d17190b656f51e9aef47baab87a5895"><div class="ttname"><a href="TMCFM_8hh.html#a2d17190b656f51e9aef47baab87a5895">qcdcouple_</a></div><div class="ttdeci">struct @37 qcdcouple_</div></div>
<div class="ttc" id="anamespaceTVar_html_a8dbe2bd8efad9a9d5d55e43c0c6f777ba4551ea50273466da7a30f958650ebfe7"><div class="ttname"><a href="namespaceTVar.html#a8dbe2bd8efad9a9d5d55e43c0c6f777ba4551ea50273466da7a30f958650ebfe7">TVar::kUseAssociated_StableTops</a></div><div class="ttdeci">@ kUseAssociated_StableTops</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00035">TVar.hh:35</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca832b9995c64912826d4e5f60e86f35ed"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca832b9995c64912826d4e5f60e86f35ed">TVar::JJQCD_TU</a></div><div class="ttdeci">@ JJQCD_TU</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00093">TVar.hh:93</a></div></div>
<div class="ttc" id="astructTVar_1_1simple__event__record_html"><div class="ttname"><a href="structTVar_1_1simple__event__record.html">TVar::simple_event_record</a></div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00227">TVar.hh:227</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a76543bd66713a065a73ac619127b52e5"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a76543bd66713a065a73ac619127b52e5">TVar::SelfDefine_spin1</a></div><div class="ttdeci">@ SelfDefine_spin1</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00181">TVar.hh:181</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_ae680a3c75129b19b6ba276b49194e84a"><div class="ttname"><a href="classSpinZeroCouplings.html#ae680a3c75129b19b6ba276b49194e84a">SpinZeroCouplings::Hb4b4coupl</a></div><div class="ttdeci">double Hb4b4coupl[SIZE_HQQ][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00033">TCouplings.hh:33</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_abba2bc9db0b21f6a1bc11aa0f75d8854"><div class="ttname"><a href="classSpinZeroCouplings.html#abba2bc9db0b21f6a1bc11aa0f75d8854">SpinZeroCouplings::Hggcoupl</a></div><div class="ttdeci">double Hggcoupl[SIZE_HGG][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00027">TCouplings.hh:27</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a0c6d3acf0d4f0af16181b35a88d813a1a3d026c66fd17c64c1d9d03653cc1b6a8"><div class="ttname"><a href="namespaceTVar.html#a0c6d3acf0d4f0af16181b35a88d813a1a3d026c66fd17c64c1d9d03653cc1b6a8">TVar::H0hplus</a></div><div class="ttdeci">@ H0hplus</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00128">TVar.hh:128</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a2bfa5115b0bf398c2fae3cc36aedf9f5"><div class="ttname"><a href="namespaceTUtil.html#a2bfa5115b0bf398c2fae3cc36aedf9f5">TUtil::GetBoostedParticleVectors</a></div><div class="ttdeci">void GetBoostedParticleVectors(MELACandidate *melaCand, TVar::simple_event_record &amp;mela_event, TVar::VerbosityLevel verbosity=TVar::DEBUG)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l07947">TUtil.cc:7947</a></div></div>
<div class="ttc" id="anamespacemodparameters_html_a01230a7892286e381643f0ca4fed5c04"><div class="ttname"><a href="namespacemodparameters.html#a01230a7892286e381643f0ca4fed5c04">modparameters::process</a></div><div class="ttdeci">integer, public process</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l00017">mod_Parameters.F90:17</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_ad2f4fde8f2c90dadebec96378b36144d"><div class="ttname"><a href="namespaceTUtil.html#ad2f4fde8f2c90dadebec96378b36144d">TUtil::JHUGenMatEl</a></div><div class="ttdeci">double JHUGenMatEl(const TVar::Process &amp;process, const TVar::Production &amp;production, const TVar::MatrixElement &amp;matrixElement, TVar::event_scales_type *event_scales, MelaIO *RcdME, const double &amp;EBEAM, TVar::VerbosityLevel verbosity)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l04746">TUtil.cc:4746</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca1ae680405479fddfedd3314339a47b01"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca1ae680405479fddfedd3314339a47b01">TVar::bbH</a></div><div class="ttdeci">@ bbH</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00067">TVar.hh:67</a></div></div>
<div class="ttc" id="aTModZprimeMatEl_8hh_html_ac71b783c7df3cdd6cf98ab3419e6b2a2"><div class="ttname"><a href="TModZprimeMatEl_8hh.html#ac71b783c7df3cdd6cf98ab3419e6b2a2">__modzprime_MOD_evalamp_zprime_vv</a></div><div class="ttdeci">void __modzprime_MOD_evalamp_zprime_vv(double P[6][4], int *MYIDUP, double *MatElSq)</div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_a75b28dfc18a2abd947beb996f9cf63dd"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#a75b28dfc18a2abd947beb996f9cf63dd">__modjhugenmela_MOD_setvprimecontactcouplings</a></div><div class="ttdeci">void __modjhugenmela_MOD_setvprimecontactcouplings(double Zpffcoupl[SIZE_Vpff][2], double Wpffcoupl[SIZE_Vpff][2])</div></div>
<div class="ttc" id="anamespaceTUtil_html_a30b0f3cd4082fab9f6d057b0243f26de"><div class="ttname"><a href="namespaceTUtil.html#a30b0f3cd4082fab9f6d057b0243f26de">TUtil::VHiggsMatEl</a></div><div class="ttdeci">double VHiggsMatEl(const TVar::Process &amp;process, const TVar::Production &amp;production, const TVar::MatrixElement &amp;matrixElement, TVar::event_scales_type *event_scales, MelaIO *RcdME, const double &amp;EBEAM, bool includeHiggsDecay, TVar::VerbosityLevel verbosity)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l06578">TUtil.cc:6578</a></div></div>
<div class="ttc" id="aclassMELAParticle_html_a793d2d9fbebea5e9a0a7b7c3205d4d43"><div class="ttname"><a href="classMELAParticle.html#a793d2d9fbebea5e9a0a7b7c3205d4d43">MELAParticle::getNMothers</a></div><div class="ttdeci">int getNMothers() const</div><div class="ttdef"><b>Definition:</b> <a href="MELAParticle_8h_source.html#l00049">MELAParticle.h:49</a></div></div>
<div class="ttc" id="aTModJHUGen_8hh_html_af882f865345973a4ccbdf9545ed4f866"><div class="ttname"><a href="TModJHUGen_8hh.html#af882f865345973a4ccbdf9545ed4f866">__modjhugen_MOD_initfirsttime</a></div><div class="ttdeci">void __modjhugen_MOD_initfirsttime(char *gridfilename, int *lenfilename, int *irep, double *collider_sqrts)</div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28cac09ee14d8ad516b27397f28eee642c62"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28cac09ee14d8ad516b27397f28eee642c62">TVar::JJQCD_S</a></div><div class="ttdeci">@ JJQCD_S</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00082">TVar.hh:82</a></div></div>
<div class="ttc" id="anamespacePDGHelpers_html_a489c1dbbeb1023de341ae81fd17f50c3"><div class="ttname"><a href="namespacePDGHelpers.html#a489c1dbbeb1023de341ae81fd17f50c3">PDGHelpers::isUpTypeQuark</a></div><div class="ttdeci">bool isUpTypeQuark(const int id)</div><div class="ttdef"><b>Definition:</b> <a href="PDGHelpers_8cc_source.html#l00040">PDGHelpers.cc:40</a></div></div>
<div class="ttc" id="aTMCFM_8hh_html_ac5f5b45e0d7308e50552ea6a1a5c1aa8"><div class="ttname"><a href="TMCFM_8hh.html#ac5f5b45e0d7308e50552ea6a1a5c1aa8">gg_hzz_tb_</a></div><div class="ttdeci">void gg_hzz_tb_(double *p, double *msq)</div></div>
<div class="ttc" id="aTMCFM_8hh_html_a55930b5d389dfae39115156b2bc9a692"><div class="ttname"><a href="TMCFM_8hh.html#a55930b5d389dfae39115156b2bc9a692">nflav_</a></div><div class="ttdeci">struct @53 nflav_</div></div>
<div class="ttc" id="anamespacePDGHelpers_html_a70d454afa0ba8867880810d0a527e4e5"><div class="ttname"><a href="namespacePDGHelpers.html#a70d454afa0ba8867880810d0a527e4e5">PDGHelpers::isAJet</a></div><div class="ttdeci">bool isAJet(const int id)</div><div class="ttdef"><b>Definition:</b> <a href="PDGHelpers_8cc_source.html#l00018">PDGHelpers.cc:18</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7"><div class="ttname"><a href="namespaceTVar.html#a1d885f45cfb17fdc0cb80d0b3dd4f28ca843cb3a0a0c8f423befc9c7781a3eee7">TVar::Lep_ZH_TU</a></div><div class="ttdeci">@ Lep_ZH_TU</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00099">TVar.hh:99</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a9a0761a097eca0e6c200ad64ccfdf80f"><div class="ttname"><a href="namespaceTUtil.html#a9a0761a097eca0e6c200ad64ccfdf80f">TUtil::computeVBFAngles_ComplexBoost</a></div><div class="ttdeci">void computeVBFAngles_ComplexBoost(float &amp;costhetastar, float &amp;costheta1_real, float &amp;costheta1_imag, float &amp;costheta2_real, float &amp;costheta2_imag, float &amp;Phi, float &amp;Phi1, float &amp;Q2V1, float &amp;Q2V2, TLorentzVector p4M11, int Z1_lept1Id, TLorentzVector p4M12, int Z1_lept2Id, TLorentzVector p4M21, int Z2_lept1Id, TLorentzVector p4M22, int Z2_lept2Id, TLorentzVector jet1, int jet1Id, TLorentzVector jet2, int jet2Id, TLorentzVector *injet1=0, int injet1Id=0, TLorentzVector *injet2=0, int injet2Id=0)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00730">TUtil.cc:730</a></div></div>
<div class="ttc" id="aclassSpinZeroCouplings_html_a189ac5469f2eed474ccd6403a82766e3"><div class="ttname"><a href="classSpinZeroCouplings.html#a189ac5469f2eed474ccd6403a82766e3">SpinZeroCouplings::H2ggcoupl</a></div><div class="ttdeci">double H2ggcoupl[SIZE_HGG][2]</div><div class="ttdef"><b>Definition:</b> <a href="TCouplings_8hh_source.html#l00042">TCouplings.hh:42</a></div></div>
<div class="ttc" id="aTModJHUGenMELA_8hh_html_ad64c7f7d10b1a0ac889b00b32cf1f53f"><div class="ttname"><a href="TModJHUGenMELA_8hh.html#ad64c7f7d10b1a0ac889b00b32cf1f53f">__modjhugenmela_MOD_setdistinguishwwcouplingsflag</a></div><div class="ttdeci">void __modjhugenmela_MOD_setdistinguishwwcouplingsflag(int *doallow)</div></div>
<div class="ttc" id="aclassMELAParticle_html_a555dda1d36e3cf9801de88ad38a6c6de"><div class="ttname"><a href="classMELAParticle.html#a555dda1d36e3cf9801de88ad38a6c6de">MELAParticle::addDaughter</a></div><div class="ttdeci">void addDaughter(MELAParticle *myParticle)</div><div class="ttdef"><b>Definition:</b> <a href="MELAParticle_8cc_source.html#l00063">MELAParticle.cc:63</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_a2e1b502237f00dd823a0ef37b49e7aaa"><div class="ttname"><a href="namespaceTUtil.html#a2e1b502237f00dd823a0ef37b49e7aaa">TUtil::ResetAmplitudeIncludes</a></div><div class="ttdeci">void ResetAmplitudeIncludes()</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l03357">TUtil.cc:3357</a></div></div>
<div class="ttc" id="anamespaceTVar_html_a71a2597822d7f2646209498585c4bbc4abb1917a08ff9507cf02938700ad23d7a"><div class="ttname"><a href="namespaceTVar.html#a71a2597822d7f2646209498585c4bbc4abb1917a08ff9507cf02938700ad23d7a">TVar::CandidateDecay_GG</a></div><div class="ttdeci">@ CandidateDecay_GG</div><div class="ttdef"><b>Definition:</b> <a href="TVar_8hh_source.html#l00045">TVar.hh:45</a></div></div>
<div class="ttc" id="anamespaceTUtil_html_ae24251edeb2dbc469b31a1e1dc05e51e"><div class="ttname"><a href="namespaceTUtil.html#ae24251edeb2dbc469b31a1e1dc05e51e">TUtil::applyJetMassCorrection</a></div><div class="ttdeci">void applyJetMassCorrection(bool flag=true)</div><div class="ttdef"><b>Definition:</b> <a href="TUtil_8cc_source.html#l00036">TUtil.cc:36</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
