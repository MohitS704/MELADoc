<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JHUGen MELA: MELA/fortran/mod_HiggsJ.F90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JHUGen MELA
   &#160;<span id="projectnumber">v2.4.1</span>
   </div>
   <div id="projectbrief">Matrix element calculations as used in JHUGen. MELA is an important tool that was used for the Higgs boson discovery and for precise measurements of its structure and interactions. Please see the website https://spin.pha.jhu.edu/ and papers cited there for more details, and kindly cite those papers when using this code.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_00387dd39d960209b81c23b2fe5ca929.html">MELA</a></li><li class="navelem"><a class="el" href="dir_1e990d202f380d40186005b13f113cb8.html">fortran</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">mod_HiggsJ.F90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mod__HiggsJ_8F90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="namespacemodhiggsj.html">    1</a></span>&#160;<span class="keyword">module</span> <a class="code" href="namespacemodhiggsj.html">modhiggsj</a></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespacemodparameters.html">modparameters</a></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespacemodmisc.html">modmisc</a></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  <span class="keywordtype">private</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  <span class="keywordtype">public</span> :: <a class="code" href="namespacemodhiggsj.html#adb7dee52b99526ea8810c352b90ba372">evalamp_hj</a></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">contains</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">subroutine </span><a class="code" href="namespacemodhiggsj.html#adb7dee52b99526ea8810c352b90ba372">evalamp_hj</a>(p,res)</div>
<div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="namespacemodhiggsj.html#adb7dee52b99526ea8810c352b90ba372">   12</a></span>&#160;<span class="keywordtype">    real</span>(<a class="code" href="namespacemodparameters.html#a813faebf7a65bdbf17a039fd0da947a8">dp</a>), <span class="keywordtype">intent(in)</span> :: p(4,4)</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordtype">complex(dp)</span> :: heftcoupl</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keywordtype">    real</span>(<a class="code" href="namespacemodparameters.html#a813faebf7a65bdbf17a039fd0da947a8">dp</a>), <span class="keywordtype">intent(out)</span> :: res(-5:5,-5:5)</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keywordtype">    real</span>(<a class="code" href="namespacemodparameters.html#a813faebf7a65bdbf17a039fd0da947a8">dp</a>) :: sprod(4,4)</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordtype">complex(dp)</span> :: za(4,4), zb(4,4)</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keywordtype">    real</span>(<a class="code" href="namespacemodparameters.html#a813faebf7a65bdbf17a039fd0da947a8">dp</a>) :: restmp<span class="comment">!, restmpid</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keywordtype">integer</span> :: i,j</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    heftcoupl = <a class="code" href="namespacemodparameters.html#ab8e8ab40cd8ddf3aa1a4989e8fe99eb8">gs</a>*<a class="code" href="namespacemodparameters.html#abcc8d0f63ddeea7d3c2e2fd9a6b50980">alphas</a>/(6.0_dp * pi * <a class="code" href="namespacemodparameters.html#a51d683e9562b018607af681bafd01d36">vev</a>)</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        res=<a class="code" href="namespacemodparameters.html#ae0859513f02800206318ab45a1d55d02">zero</a></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemodhiggsj.html#ab4734e029575a57d373881c466e27bb8">spinoru2</a>(3,(/-p(:,1),-p(:,2),p(:,4)/),za,zb,sprod)</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacemodhiggsj.html#a6dbfc45fc31ed0742b6a4d04735981e2">me2_ggg_tree</a>(1,2,3,sprod,res(0,0))</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    res(0,0) = res(0,0)*<a class="code" href="namespacemodparameters.html#afacba0c32725fa31f12d123b8197afba">avegg</a></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">do</span> i=1,5</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemodhiggsj.html#a8907af214708b3eff5dbde3c73ba6805">me2_qbqg_tree</a>(2,3,1,sprod,res(0,i))</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      res(0,i) = -res(0,i)*<a class="code" href="namespacemodparameters.html#abd475fd9bba8b6a8b5bd86e99e8c05c4">aveqg</a></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <span class="comment">!print *,res(0,i)</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">do</span> i=1,5</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemodhiggsj.html#a8907af214708b3eff5dbde3c73ba6805">me2_qbqg_tree</a>(1,3,2,sprod,res(i,0))</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      res(i,0) = -res(i,0)*<a class="code" href="namespacemodparameters.html#abd475fd9bba8b6a8b5bd86e99e8c05c4">aveqg</a></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <span class="comment">!print *,res(i,0)</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">do</span> i=1,5</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemodhiggsj.html#a8907af214708b3eff5dbde3c73ba6805">me2_qbqg_tree</a>(3,2,1,sprod,res(0,-i))</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      res(0,-i) = -res(0,-i)*<a class="code" href="namespacemodparameters.html#abd475fd9bba8b6a8b5bd86e99e8c05c4">aveqg</a></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="comment">!print *,res(0,-i)</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">do</span> i=1,5</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemodhiggsj.html#a8907af214708b3eff5dbde3c73ba6805">me2_qbqg_tree</a>(1,3,2,sprod,res(-i,0))</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      res(-i,0) = -res(-i,0)*<a class="code" href="namespacemodparameters.html#abd475fd9bba8b6a8b5bd86e99e8c05c4">aveqg</a></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">!if(res(-i,0).le.0d0) then</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">!print *,res(-i,0)</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">!endif</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">do</span> i=1,5</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemodhiggsj.html#a8907af214708b3eff5dbde3c73ba6805">me2_qbqg_tree</a>(1,2,3,sprod,res(-i,i))</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      res(-i,i) = res(-i,i) * <a class="code" href="namespacemodparameters.html#a911b093fad51f19299758b52c22d18bd">aveqq</a></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">!      res(i,-i) = res(i,-i) + restmp * aveqq</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">!      res(0, i) = res(0, i) + restmp * aveqg</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">!      res(0,-i) = res(0,-i) + restmp * aveqg</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">!      res(i, 0) = res(i, 0) + restmp * aveqg</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">!      res(-i,0) = res(-i,0) + restmp * aveqg</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">do</span> i=1,5</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacemodhiggsj.html#a8907af214708b3eff5dbde3c73ba6805">me2_qbqg_tree</a>(2,1,3,sprod,res(i,-i))</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      res(i,-i) = res(i,-i)*<a class="code" href="namespacemodparameters.html#a911b093fad51f19299758b52c22d18bd">aveqq</a></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    res = res * (heftcoupl**2)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">!if(res(0,0).gt.10000d0)then</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">!do i = -5,5</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">!do j = -5,5</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">!print *, res(i,j),i,j</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">!enddo</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">!enddo</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">!    print *, dsqrt(scr(p(:,1),p(:,1))), dsqrt(scr(p(:,2),p(:,2))), dsqrt(scr(p(:,3),p(:,3))), dsqrt(scr(p(:,4),p(:,4)))</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">!    print*, p</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">!endif</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keyword">end subroutine </span><a class="code" href="namespacemodhiggsj.html#adb7dee52b99526ea8810c352b90ba372">evalamp_hj</a></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keyword">subroutine </span><a class="code" href="namespacemodhiggsj.html#a6dbfc45fc31ed0742b6a4d04735981e2">me2_ggg_tree</a>(j1,j2,j3,sprod,me2)</div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="namespacemodhiggsj.html#a6dbfc45fc31ed0742b6a4d04735981e2">   87</a></span>&#160;   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: j1,j2,j3</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keywordtype">   real</span>(dp), <span class="keywordtype">intent(in)</span> :: sprod(3,3)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keywordtype">   real</span>(dp), <span class="keywordtype">intent(out)</span> :: me2</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keywordtype">   real</span>(dp) :: s12, s13, s23, qsq</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keywordtype">   real</span>(dp), <span class="keywordtype">parameter</span> :: col_gg = 4.0d0 * <a class="code" href="namespacemodparameters.html#a5f88dee6ae7d7e45756fc1e6ab3a7258">ca</a>**2 * <a class="code" href="namespacemodparameters.html#a6621f44cfbbd29d29962de74b277894c">cf</a></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   me2 = <a class="code" href="namespacemodparameters.html#ae0859513f02800206318ab45a1d55d02">zero</a></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   s12 = sprod(j1,j2)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   s13 = sprod(j1,j3)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   s23 = sprod(j2,j3)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   qsq = s12 + s13 + s23</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   me2 = (s12**4 + s13**4 + s23**4 + qsq**4)/s12/s13/s23</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   me2 = me2 * <a class="code" href="namespacemodparameters.html#a2f3f801555ec94b0aa1d9c5bf2f4631e">two</a> * col_gg</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   <span class="keywordflow">return</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keyword">end subroutine </span><a class="code" href="namespacemodhiggsj.html#a6dbfc45fc31ed0742b6a4d04735981e2">me2_ggg_tree</a></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">!-- 0 -&gt; qb(p1) q(p2) g(p3) H</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keyword">subroutine </span><a class="code" href="namespacemodhiggsj.html#a8907af214708b3eff5dbde3c73ba6805">me2_qbqg_tree</a>(j1,j2,j3,sprod,me2)</div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="namespacemodhiggsj.html#a8907af214708b3eff5dbde3c73ba6805">  112</a></span>&#160;   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: j1, j2, j3</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="keywordtype">   real</span>(dp), <span class="keywordtype">intent(in)</span> :: sprod(3,3)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keywordtype">   real</span>(dp), <span class="keywordtype">intent(out)</span> :: me2</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keywordtype">   real</span>(dp) :: s12, s13,s23</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keywordtype">   real</span>(dp), <span class="keywordtype">parameter</span> :: col_qg = <a class="code" href="namespacemodparameters.html#a2f3f801555ec94b0aa1d9c5bf2f4631e">two</a> * <a class="code" href="namespacemodparameters.html#a8ae39ff432460e1198f9399b8aef334c">xn</a> * <a class="code" href="namespacemodparameters.html#a6621f44cfbbd29d29962de74b277894c">cf</a></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   me2 = <a class="code" href="namespacemodparameters.html#ae0859513f02800206318ab45a1d55d02">zero</a></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   s12 = sprod(j1,j2)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   s13 = sprod(j1,j3)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   s23 = sprod(j2,j3)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   me2 = <a class="code" href="namespacemodparameters.html#a2f3f801555ec94b0aa1d9c5bf2f4631e">two</a> * (s13**2 + s23**2)/s12 * col_qg</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">!if(me2.le.0d0)then</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">!print *, s12,s13,s23</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">!endif</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   <span class="keywordflow">return</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keyword">end subroutine </span><a class="code" href="namespacemodhiggsj.html#a8907af214708b3eff5dbde3c73ba6805">me2_qbqg_tree</a></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="comment">!-------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="comment">!-- generic functions below</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">!- MCFM spinors</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keyword">subroutine </span><a class="code" href="namespacemodhiggsj.html#ab4734e029575a57d373881c466e27bb8">spinoru2</a>(n,p,za,zb,s)</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="namespacemodhiggsj.html#ab4734e029575a57d373881c466e27bb8">  137</a></span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: n</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">intent(in)</span> :: p(4,n)</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">complex(dp)</span>, <span class="keywordtype">intent(out)</span> :: za(n,n), zb(n,n)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">intent(out)</span> :: s(n,n)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordtype">integer</span> :: i,j</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordtype">complex(dp)</span> :: c23(n), f(n)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keywordtype">    real</span>(dp) :: rt(n)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">!---if one of the vectors happens to be zero this routine fails.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">do</span> j=1,n</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;       za(j,j)=<a class="code" href="namespacemodparameters.html#a6a30b7d4b026523c4f9ba552a92d4fcf">czero</a></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;       zb(j,j)=za(j,j)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;       <span class="comment">!-----positive energy case</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;       <span class="keywordflow">if</span> (p(1,j) .gt. <a class="code" href="namespacemodparameters.html#ae0859513f02800206318ab45a1d55d02">zero</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          rt(j)=sqrt(p(2,j)+p(1,j))</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          c23(j)=cmplx(p(4,j),-p(3,j),kind=dp)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          f(j)=(<a class="code" href="namespacemodparameters.html#a3a66040091018dcd8f0e5c9053e9da72">one</a>,<a class="code" href="namespacemodparameters.html#ae0859513f02800206318ab45a1d55d02">zero</a>)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;       <span class="keywordflow">else</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;       <span class="comment">!-----negative energy case</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          rt(j)=sqrt(-p(1,j)-p(2,j))</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          c23(j)=cmplx(-p(4,j),p(3,j),kind=dp)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          f(j)=<a class="code" href="namespacemodparameters.html#a5fe152b1ec4e043f0d3f4900bcc562a8">ci</a></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="keywordflow">       endif</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">do</span> i=2,n</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;     <span class="keywordflow">do</span> j=1,i-1</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          s(i,j)=<a class="code" href="namespacemodparameters.html#a2f3f801555ec94b0aa1d9c5bf2f4631e">two</a>*<a class="code" href="namespacemodmisc.html#a3f09f85d546e0284b955a11b37ef1310">scr</a>(p(:,i),p(:,j))</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          za(i,j)=f(i)*f(j) &amp;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;               *(c23(i)*cmplx(rt(j)/rt(i),kind=dp)-c23(j)*cmplx(rt(i)/rt(j),kind=dp))</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          <span class="keywordflow">if</span> (abs(s(i,j)).lt.1d-5) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;             zb(i,j)=-(f(i)*f(j))**2*conjg(za(i,j))</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;             zb(i,j)=-cmplx(s(i,j),kind=dp)/za(i,j)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keywordflow">          endif</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          za(j,i)=-za(i,j)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          zb(j,i)=-zb(i,j)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          s(j,i)=s(i,j)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keywordflow">       enddo</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keywordflow">    enddo</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">return</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keyword">end subroutine </span><a class="code" href="namespacemodhiggsj.html#ab4734e029575a57d373881c466e27bb8">spinoru2</a></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="keyword">end module </span><a class="code" href="namespacemodhiggsj.html">modhiggsj</a></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacemodparameters_html_a51d683e9562b018607af681bafd01d36"><div class="ttname"><a href="namespacemodparameters.html#a51d683e9562b018607af681bafd01d36">modparameters::vev</a></div><div class="ttdeci">real(8), public vev</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l00249">mod_Parameters.F90:249</a></div></div>
<div class="ttc" id="anamespacemodparameters_html_ab8e8ab40cd8ddf3aa1a4989e8fe99eb8"><div class="ttname"><a href="namespacemodparameters.html#ab8e8ab40cd8ddf3aa1a4989e8fe99eb8">modparameters::gs</a></div><div class="ttdeci">real(dp), public gs</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l00271">mod_Parameters.F90:271</a></div></div>
<div class="ttc" id="anamespacemodparameters_html_a911b093fad51f19299758b52c22d18bd"><div class="ttname"><a href="namespacemodparameters.html#a911b093fad51f19299758b52c22d18bd">modparameters::aveqq</a></div><div class="ttdeci">real(dp), parameter, public aveqq</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l01021">mod_Parameters.F90:1021</a></div></div>
<div class="ttc" id="anamespacemodhiggsj_html_ab4734e029575a57d373881c466e27bb8"><div class="ttname"><a href="namespacemodhiggsj.html#ab4734e029575a57d373881c466e27bb8">modhiggsj::spinoru2</a></div><div class="ttdeci">subroutine spinoru2(n, p, za, zb, s)</div><div class="ttdef"><b>Definition:</b> <a href="mod__HiggsJ_8F90_source.html#l00137">mod_HiggsJ.F90:137</a></div></div>
<div class="ttc" id="anamespacemodparameters_html_a6621f44cfbbd29d29962de74b277894c"><div class="ttname"><a href="namespacemodparameters.html#a6621f44cfbbd29d29962de74b277894c">modparameters::cf</a></div><div class="ttdeci">real(dp), parameter, public cf</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l01017">mod_Parameters.F90:1017</a></div></div>
<div class="ttc" id="anamespacemodparameters_html_a3a66040091018dcd8f0e5c9053e9da72"><div class="ttname"><a href="namespacemodparameters.html#a3a66040091018dcd8f0e5c9053e9da72">modparameters::one</a></div><div class="ttdeci">real(8), parameter, public one</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l00083">mod_Parameters.F90:83</a></div></div>
<div class="ttc" id="anamespacemodparameters_html_a2f3f801555ec94b0aa1d9c5bf2f4631e"><div class="ttname"><a href="namespacemodparameters.html#a2f3f801555ec94b0aa1d9c5bf2f4631e">modparameters::two</a></div><div class="ttdeci">real(8), parameter, public two</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l00084">mod_Parameters.F90:84</a></div></div>
<div class="ttc" id="anamespacemodparameters_html_a5fe152b1ec4e043f0d3f4900bcc562a8"><div class="ttname"><a href="namespacemodparameters.html#a5fe152b1ec4e043f0d3f4900bcc562a8">modparameters::ci</a></div><div class="ttdeci">complex(8), parameter, public ci</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l00088">mod_Parameters.F90:88</a></div></div>
<div class="ttc" id="anamespacemodparameters_html_afacba0c32725fa31f12d123b8197afba"><div class="ttname"><a href="namespacemodparameters.html#afacba0c32725fa31f12d123b8197afba">modparameters::avegg</a></div><div class="ttdeci">real(dp), parameter, public avegg</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l01019">mod_Parameters.F90:1019</a></div></div>
<div class="ttc" id="anamespacemodparameters_html_ae0859513f02800206318ab45a1d55d02"><div class="ttname"><a href="namespacemodparameters.html#ae0859513f02800206318ab45a1d55d02">modparameters::zero</a></div><div class="ttdeci">real(8), parameter, public zero</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l00085">mod_Parameters.F90:85</a></div></div>
<div class="ttc" id="anamespacemodparameters_html_a5f88dee6ae7d7e45756fc1e6ab3a7258"><div class="ttname"><a href="namespacemodparameters.html#a5f88dee6ae7d7e45756fc1e6ab3a7258">modparameters::ca</a></div><div class="ttdeci">real(dp), parameter, public ca</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l01016">mod_Parameters.F90:1016</a></div></div>
<div class="ttc" id="anamespacemodparameters_html_a8ae39ff432460e1198f9399b8aef334c"><div class="ttname"><a href="namespacemodparameters.html#a8ae39ff432460e1198f9399b8aef334c">modparameters::xn</a></div><div class="ttdeci">real(dp), parameter, public xn</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l01015">mod_Parameters.F90:1015</a></div></div>
<div class="ttc" id="anamespacemodparameters_html_a6a30b7d4b026523c4f9ba552a92d4fcf"><div class="ttname"><a href="namespacemodparameters.html#a6a30b7d4b026523c4f9ba552a92d4fcf">modparameters::czero</a></div><div class="ttdeci">complex(8), parameter, public czero</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l00086">mod_Parameters.F90:86</a></div></div>
<div class="ttc" id="anamespacemodparameters_html_abd475fd9bba8b6a8b5bd86e99e8c05c4"><div class="ttname"><a href="namespacemodparameters.html#abd475fd9bba8b6a8b5bd86e99e8c05c4">modparameters::aveqg</a></div><div class="ttdeci">real(dp), parameter, public aveqg</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l01020">mod_Parameters.F90:1020</a></div></div>
<div class="ttc" id="anamespacemodhiggsj_html_adb7dee52b99526ea8810c352b90ba372"><div class="ttname"><a href="namespacemodhiggsj.html#adb7dee52b99526ea8810c352b90ba372">modhiggsj::evalamp_hj</a></div><div class="ttdeci">subroutine, public evalamp_hj(p, res)</div><div class="ttdef"><b>Definition:</b> <a href="mod__HiggsJ_8F90_source.html#l00012">mod_HiggsJ.F90:12</a></div></div>
<div class="ttc" id="anamespacemodhiggsj_html"><div class="ttname"><a href="namespacemodhiggsj.html">modhiggsj</a></div><div class="ttdef"><b>Definition:</b> <a href="mod__HiggsJ_8F90_source.html#l00001">mod_HiggsJ.F90:1</a></div></div>
<div class="ttc" id="anamespacemodparameters_html"><div class="ttname"><a href="namespacemodparameters.html">modparameters</a></div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l00001">mod_Parameters.F90:1</a></div></div>
<div class="ttc" id="anamespacemodmisc_html"><div class="ttname"><a href="namespacemodmisc.html">modmisc</a></div><div class="ttdef"><b>Definition:</b> <a href="mod__Misc_8F90_source.html#l00001">mod_Misc.F90:1</a></div></div>
<div class="ttc" id="anamespacemodhiggsj_html_a8907af214708b3eff5dbde3c73ba6805"><div class="ttname"><a href="namespacemodhiggsj.html#a8907af214708b3eff5dbde3c73ba6805">modhiggsj::me2_qbqg_tree</a></div><div class="ttdeci">subroutine me2_qbqg_tree(j1, j2, j3, sprod, me2)</div><div class="ttdef"><b>Definition:</b> <a href="mod__HiggsJ_8F90_source.html#l00112">mod_HiggsJ.F90:112</a></div></div>
<div class="ttc" id="anamespacemodparameters_html_a813faebf7a65bdbf17a039fd0da947a8"><div class="ttname"><a href="namespacemodparameters.html#a813faebf7a65bdbf17a039fd0da947a8">modparameters::dp</a></div><div class="ttdeci">integer, parameter, public dp</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l00011">mod_Parameters.F90:11</a></div></div>
<div class="ttc" id="anamespacemodmisc_html_a3f09f85d546e0284b955a11b37ef1310"><div class="ttname"><a href="namespacemodmisc.html#a3f09f85d546e0284b955a11b37ef1310">modmisc::scr</a></div><div class="ttdeci">double precision function scr(p1, p2)</div><div class="ttdef"><b>Definition:</b> <a href="mod__Misc_8F90_source.html#l00135">mod_Misc.F90:135</a></div></div>
<div class="ttc" id="anamespacemodparameters_html_abcc8d0f63ddeea7d3c2e2fd9a6b50980"><div class="ttname"><a href="namespacemodparameters.html#abcc8d0f63ddeea7d3c2e2fd9a6b50980">modparameters::alphas</a></div><div class="ttdeci">real(dp), public alphas</div><div class="ttdef"><b>Definition:</b> <a href="mod__Parameters_8F90_source.html#l00269">mod_Parameters.F90:269</a></div></div>
<div class="ttc" id="anamespacemodhiggsj_html_a6dbfc45fc31ed0742b6a4d04735981e2"><div class="ttname"><a href="namespacemodhiggsj.html#a6dbfc45fc31ed0742b6a4d04735981e2">modhiggsj::me2_ggg_tree</a></div><div class="ttdeci">subroutine me2_ggg_tree(j1, j2, j3, sprod, me2)</div><div class="ttdef"><b>Definition:</b> <a href="mod__HiggsJ_8F90_source.html#l00087">mod_HiggsJ.F90:87</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
