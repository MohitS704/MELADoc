<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JHUGen MELA: hto_solve_nonlin Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JHUGen MELA
   &#160;<span id="projectnumber">v2.4.1</span>
   </div>
   <div id="projectbrief">Matrix element calculations as used in JHUGen. MELA is an important tool that was used for the Higgs boson discovery and for precise measurements of its structure and interactions. Please see the website https://spin.pha.jhu.edu/ and papers cited there for more details, and kindly cite those papers when using this code.</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacehto__solve__nonlin.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">hto_solve_nonlin Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a4913ccbfdbf22332947aa02f3df9eee5"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehto__solve__nonlin.html#a4913ccbfdbf22332947aa02f3df9eee5">hto_hbrd</a> (HTO_FCN, n, x, fvec, epsfcn, tol, info, diag)</td></tr>
<tr class="separator:a4913ccbfdbf22332947aa02f3df9eee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fedece7d4082c4306271f14df72387e"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehto__solve__nonlin.html#a2fedece7d4082c4306271f14df72387e">hto_hybrd</a> (HTO_FCN, n, x, fvec, xtol, maxfev, ml, mu, epsfcn, diag, mode, factor, nprint, info, nfev)</td></tr>
<tr class="separator:a2fedece7d4082c4306271f14df72387e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe4e5fea1ad06250f9e5ce2a5ac37e33"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehto__solve__nonlin.html#afe4e5fea1ad06250f9e5ce2a5ac37e33">hto_dogleg</a> (n, r, lr, diag, qtb, delta, x, wa1, wa2)</td></tr>
<tr class="separator:afe4e5fea1ad06250f9e5ce2a5ac37e33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b9991931fe83ae42bd577aa132fd691"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehto__solve__nonlin.html#a9b9991931fe83ae42bd577aa132fd691">hto_fdjac1</a> (HTO_FCN, n, x, fvec, fjac, ldfjac, iflag, ml, mu, epsfcn, wa1, wa2)</td></tr>
<tr class="separator:a9b9991931fe83ae42bd577aa132fd691"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c27c7948dee7924b448527cd0e47aff"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehto__solve__nonlin.html#a6c27c7948dee7924b448527cd0e47aff">hto_qform</a> (m, n, q, ldq, wa)</td></tr>
<tr class="separator:a6c27c7948dee7924b448527cd0e47aff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98884f67245c484b378efff769d60f69"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehto__solve__nonlin.html#a98884f67245c484b378efff769d60f69">hto_qrfac</a> (m, n, a, lda, pivot, ipvt, lipvt, rdiag, acnorm, wa)</td></tr>
<tr class="separator:a98884f67245c484b378efff769d60f69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89a4ef64a31dd4d201b9b6bb3c077ab1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehto__solve__nonlin.html#a89a4ef64a31dd4d201b9b6bb3c077ab1">hto_r1mpyq</a> (m, n, a, lda, v, w)</td></tr>
<tr class="separator:a89a4ef64a31dd4d201b9b6bb3c077ab1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af73d8384fe07fde7b063afc452466f03"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehto__solve__nonlin.html#af73d8384fe07fde7b063afc452466f03">hto_r1updt</a> (m, n, s, ls, u, v, w, sing)</td></tr>
<tr class="separator:af73d8384fe07fde7b063afc452466f03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52df74850a83808488fb1b90d7e539ed"><td class="memItemLeft" align="right" valign="top">real *8 function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehto__solve__nonlin.html#a52df74850a83808488fb1b90d7e539ed">hto_enorm</a> (n, x)</td></tr>
<tr class="separator:a52df74850a83808488fb1b90d7e539ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="afe4e5fea1ad06250f9e5ce2a5ac37e33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe4e5fea1ad06250f9e5ce2a5ac37e33">&#9670;&nbsp;</a></span>hto_dogleg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hto_solve_nonlin::hto_dogleg </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(lr), intent(in)&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>qtb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, intent(in)&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>wa1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>wa2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CALLING__cpHTO_8f_source.html#l05805">5805</a> of file <a class="el" href="CALLING__cpHTO_8f_source.html">CALLING_cpHTO.f</a>.</p>
<div class="fragment"><div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: n</div>
<div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: lr</div>
<div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;      real*8, <span class="keywordtype">INTENT(IN)</span>      :: r(lr)</div>
<div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;      real*8, <span class="keywordtype">INTENT(IN)</span>      :: diag(n)</div>
<div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;      real*8, <span class="keywordtype">INTENT(IN)</span>      :: qtb(n)</div>
<div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;      real*8, <span class="keywordtype">INTENT(IN)</span>      :: delta</div>
<div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;      real*8, <span class="keywordtype">INTENT(IN OUT)</span>  :: x(n)</div>
<div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;      real*8, <span class="keywordtype">INTENT(OUT)</span>     :: wa1(n)</div>
<div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;      real*8, <span class="keywordtype">INTENT(OUT)</span>     :: wa2(n)</div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160; </div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;<span class="comment">!     **********</span></div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160; </div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;<span class="comment">!     SUBROUTINE HTO_DOGLEG</span></div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160; </div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;<span class="comment">!     GIVEN AN M BY N MATRIX A, AN N BY N NONSINGULAR DIAGONAL</span></div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;<span class="comment">!     MATRIX D, AN M-VECTOR B, AND A POSITIVE NUMBER DELTA, THE</span></div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;<span class="comment">!     PROBLEM IS TO DETERMINE THE CONVEX COMBINATION X OF THE</span></div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;<span class="comment">!     GAUSS-NEWTON AND SCALED GRADIENT DIRECTIONS THAT MINIMIZES</span></div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;<span class="comment">!     (A*X - B) IN THE LEAST SQUARES SENSE, SUBJECT TO THE</span></div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;<span class="comment">!     RESTRICTION THAT THE EUCLIDEAN NORM OF D*X BE AT MOST DELTA.</span></div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160; </div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;<span class="comment">!     THIS SUBROUTINE HTO_COMPLETES THE SOLUTION OF THE PROBLEM</span></div>
<div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;<span class="comment">!     IF IT IS PROVIDED WITH THE NECESSARY INFORMATION FROM THE</span></div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;<span class="comment">!     QR FACTORIZATION OF A. THAT IS, IF A= Q*R, WHERE Q HAS</span></div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;<span class="comment">!     ORTHOGONAL COLUMNS AND R IS AN UPPER TRIANGULAR MATRIX,</span></div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;<span class="comment">!     THEN DOGLEG EXPECTS THE FULL UPPER TRIANGLE OF R AND</span></div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;<span class="comment">!     THE FIRST N COMPONENTS OF (Q TRANSPOSE)*B.</span></div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160; </div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;<span class="comment">!     THE SUBROUTINE HTO_STATEMENT IS</span></div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160; </div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;<span class="comment">!       SUBROUTINE HTO_DOGLEG(N,R,LR,DIAG,QTB,DELTA,X,WA1,WA2)</span></div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160; </div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;<span class="comment">!     WHERE</span></div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160; </div>
<div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;<span class="comment">!       N IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE ORDER OF R.</span></div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160; </div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;<span class="comment">!       R IS AN INPUT ARRAY OF LENGTH LR WHICH MUST CONTAIN THE UPPER</span></div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;<span class="comment">!         TRIANGULAR MATRIX R STORED BY ROWS.</span></div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160; </div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;<span class="comment">!       LR IS A POSITIVE INTEGER INPUT VARIABLE NOT LESS THAN</span></div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;<span class="comment">!         (N*(N+1))/2.</span></div>
<div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160; </div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;<span class="comment">!       DIAG IS AN INPUT ARRAY OF LENGTH N WHICH MUST CONTAIN THE</span></div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;<span class="comment">!         DIAGONAL ELEMENTS OF THE MATRIX D.</span></div>
<div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160; </div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;<span class="comment">!       QTB IS AN INPUT ARRAY OF LENGTH N WHICH MUST CONTAIN THE FIRST</span></div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;<span class="comment">!         N ELEMENTS OF THE VECTOR (Q TRANSPOSE)*B.</span></div>
<div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160; </div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;<span class="comment">!       DELTA IS A POSITIVE INPUT VARIABLE WHICH SPECIFIES AN UPPER</span></div>
<div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;<span class="comment">!         BOUND ON THE EUCLIDEAN NORM OF D*X.</span></div>
<div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160; </div>
<div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;<span class="comment">!       X IS AN OUTPUT ARRAY OF LENGTH N WHICH CONTAINS THE DESIRED</span></div>
<div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;<span class="comment">!         CONVEX COMBINATION OF THE GAUSS-NEWTON DIRECTION AND THE</span></div>
<div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;<span class="comment">!         SCALED GRADIENT DIRECTION.</span></div>
<div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160; </div>
<div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;<span class="comment">!       WA1 AND WA2 ARE WORK ARRAYS OF LENGTH N.</span></div>
<div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160; </div>
<div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;<span class="comment">!     SUBPROGRAMS CALLED</span></div>
<div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160; </div>
<div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;<span class="comment">!       MINPACK-SUPPLIED ... SPMPAR,ENORM</span></div>
<div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160; </div>
<div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;<span class="comment">!       FORTRAN-SUPPLIED ... ABS,MAX,MIN,SQRT</span></div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160; </div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;<span class="comment">!     ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.</span></div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;<span class="comment">!     BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE</span></div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160; </div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;<span class="comment">!     **********</span></div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160; </div>
<div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;      <span class="keywordtype">INTEGER</span>    :: i,j,jj,jp1,k,l</div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;      real*8  :: alpha,bnorm,epsmch,gnorm,qnorm,sgnorm,sum,temp</div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;      epsmch= epsilon(1.0d0)</div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;      jj= (n*(n+1))/2+1</div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;      <span class="keywordflow">DO</span> k= 1,n</div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;       j= n-k+1</div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;       jp1= j+1</div>
<div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;       jj= jj-k</div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;       l= jj+1</div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;       sum= 0.0</div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;       <span class="keywordflow">IF</span>(n &gt;= jp1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;        <span class="keywordflow">DO</span> i= jp1,n</div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;         sum= sum+r(l)*x(i)</div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;         l= l+1</div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;<span class="keywordflow">       ENDIF</span></div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;       temp= r(jj)</div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;       <span class="keywordflow">IF</span>(temp == 0.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;        l= j</div>
<div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;        <span class="keywordflow">DO</span> i= 1,j</div>
<div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;         temp= max(temp,abs(r(l)))</div>
<div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;         l= l+n-i</div>
<div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;        temp= epsmch*temp</div>
<div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;        <span class="keywordflow">IF</span>(temp == 0.0) temp= epsmch</div>
<div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;<span class="keywordflow">       ENDIF</span></div>
<div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;       x(j)= (qtb(j)-sum)/temp</div>
<div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;      <span class="keywordflow">DO</span> j= 1,n</div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;       wa1(j)= 0.0</div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;       wa2(j)= diag(j)*x(j)</div>
<div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;      qnorm= hto_enorm(n,wa2)</div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;      <span class="keywordflow">IF</span>(qnorm &gt; delta) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;       l= 1</div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;       <span class="keywordflow">DO</span> j= 1,n</div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;        temp= qtb(j)</div>
<div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;        <span class="keywordflow">DO</span> i= j,n</div>
<div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;         wa1(i)= wa1(i)+r(l)*temp</div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;         l= l+1</div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;        wa1(j)= wa1(j)/diag(j)</div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;<span class="keywordflow">       ENDDO</span></div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;       gnorm= hto_enorm(n,wa1)</div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;       sgnorm= 0.0</div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;       alpha= delta/qnorm</div>
<div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;       <span class="keywordflow">IF</span>(gnorm /= 0.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;        <span class="keywordflow">DO</span> j= 1,n</div>
<div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;         wa1(j)= (wa1(j)/gnorm)/diag(j)</div>
<div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;        l= 1</div>
<div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;        <span class="keywordflow">DO</span> j= 1,n</div>
<div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;         sum= 0.0</div>
<div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;         <span class="keywordflow">DO</span> i= j,n</div>
<div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;          sum= sum+r(l)*wa1(i)</div>
<div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;          l= l+1</div>
<div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;<span class="keywordflow">         ENDDO</span></div>
<div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;         wa2(j)= sum</div>
<div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;        temp= hto_enorm(n,wa2)</div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;        sgnorm= (gnorm/temp)/temp</div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;        alpha= 0.0</div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;        <span class="keywordflow">IF</span>(sgnorm &lt; delta) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;         bnorm= hto_enorm(n,qtb)</div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;         temp= (bnorm/gnorm)*(bnorm/qnorm)*(sgnorm/delta)</div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;         temp= temp-(delta/qnorm)*(sgnorm/delta)**2+</div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;     #         sqrt((temp-(delta/qnorm))**2+(1.0d0-(delta/qnorm)**2)*</div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;     #         (1.0d0-( sgnorm/delta)**2))</div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;         alpha= ((delta/qnorm)*(1.0d0-(sgnorm/delta)**2))/temp</div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;<span class="keywordflow">       ENDIF</span></div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;       temp= (1.0d0-alpha)*min(sgnorm,delta)</div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;       <span class="keywordflow">DO</span> j= 1,n</div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;        x(j)= temp*wa1(j)+alpha*x(j)</div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;<span class="keywordflow">       ENDDO</span></div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;<span class="comment">*</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a52df74850a83808488fb1b90d7e539ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52df74850a83808488fb1b90d7e539ed">&#9670;&nbsp;</a></span>hto_enorm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real*8 function hto_solve_nonlin::hto_enorm </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CALLING__cpHTO_8f_source.html#l06621">6621</a> of file <a class="el" href="CALLING__cpHTO_8f_source.html">CALLING_cpHTO.f</a>.</p>
<div class="fragment"><div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;<span class="comment">* </span></div>
<div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>    :: n</div>
<div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;      real*8, <span class="keywordtype">INTENT(IN)</span>  :: x(n)</div>
<div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;      real*8              :: fn_val</div>
<div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160; </div>
<div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;<span class="comment">!   **********</span></div>
<div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160; </div>
<div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;<span class="comment">!   FUNCTION ENORM</span></div>
<div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160; </div>
<div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;<span class="comment">!   GIVEN AN N-VECTOR X, THIS FUNCTION CALCULATES THE EUCLIDEAN NORM OF X.</span></div>
<div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160; </div>
<div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;<span class="comment">!   THE EUCLIDEAN NORM IS COMPUTED BY ACCUMULATING THE SUM OF SQUARES IN THREE</span></div>
<div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;<span class="comment">!   DIFFERENT SUMS.  THE SUMS OF SQUARES FOR THE SMALL AND LARGE COMPONENTS</span></div>
<div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;<span class="comment">!   ARE SCALED SO THAT NO OVERFLOWS OCCUR.  NON-DESTRUCTIVE UNDERFLOWS ARE</span></div>
<div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;<span class="comment">!   PERMITTED.  UNDERFLOWS AND OVERFLOWS DO NOT OCCUR IN THE COMPUTATION OF THE UNSCALED</span></div>
<div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;<span class="comment">!   SUM OF SQUARES FOR THE INTERMEDIATE COMPONENTS.</span></div>
<div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;<span class="comment">!   THE DEFINITIONS OF SMALL, INTERMEDIATE AND LARGE COMPONENTS DEPEND ON</span></div>
<div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;<span class="comment">!   TWO CONSTANTS, RDWARF AND RGIANT.  THE MAIN RESTRICTIONS ON THESE CONSTANTS</span></div>
<div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;<span class="comment">!   ARE THAT RDWARF**2 NOT UNDERFLOW AND RGIANT**2 NOT OVERFLOW.</span></div>
<div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;<span class="comment">!   THE CONSTANTS GIVEN HERE ARE SUITABLE FOR EVERY KNOWN COMPUTER.</span></div>
<div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160; </div>
<div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;<span class="comment">!   THE FUNCTION STATEMENT IS</span></div>
<div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160; </div>
<div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;<span class="comment">!     REAL FUNCTION ENORM(N, X)</span></div>
<div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160; </div>
<div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;<span class="comment">!   WHERE</span></div>
<div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160; </div>
<div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;<span class="comment">!     N IS A POSITIVE INTEGER INPUT VARIABLE.</span></div>
<div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160; </div>
<div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;<span class="comment">!     X IS AN INPUT ARRAY OF LENGTH N.</span></div>
<div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160; </div>
<div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;<span class="comment">!   SUBPROGRAMS CALLED</span></div>
<div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160; </div>
<div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;<span class="comment">!     FORTRAN-SUPPLIED ... ABS,SQRT</span></div>
<div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160; </div>
<div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;<span class="comment">!   ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.</span></div>
<div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;<span class="comment">!   BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE</span></div>
<div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160; </div>
<div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;<span class="comment">!   **********</span></div>
<div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160; </div>
<div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;      <span class="keywordtype">INTEGER</span>    :: i</div>
<div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;      real*8  :: agiant,floatn,s1,s2,s3,xabs,x1max,x3max</div>
<div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;      real*8, <span class="keywordtype">PARAMETER</span>  :: rdwarf= 1.0d-100,rgiant= 1.0d+100</div>
<div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;      s1= 0.0d0</div>
<div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;      s2= 0.0d0</div>
<div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;      s3= 0.0d0</div>
<div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;      x1max= 0.0d0</div>
<div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;      x3max= 0.0d0</div>
<div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;      floatn= n</div>
<div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;      agiant= rgiant/floatn</div>
<div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;      <span class="keywordflow">DO</span> i= 1,n</div>
<div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;       xabs= abs(x(i))</div>
<div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;       <span class="keywordflow">IF</span>(xabs &lt;= rdwarf.or.xabs &gt;= agiant) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;        <span class="keywordflow">IF</span>(xabs &gt; rdwarf) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;         <span class="keywordflow">IF</span>(xabs &gt; x1max) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;          s1= 1.0d0+s1*(x1max/xabs)**2</div>
<div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;          x1max= xabs</div>
<div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;          s1= s1+(xabs/x1max)**2</div>
<div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;<span class="keywordflow">         ENDIF</span></div>
<div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;         <span class="keywordflow">IF</span>(xabs &gt; x3max) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;          s3= 1.0d0+s3*(x3max/xabs)**2</div>
<div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;          x3max= xabs</div>
<div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;          <span class="keywordflow">IF</span>(xabs /= 0.0d0) s3= s3+(xabs/x3max)**2</div>
<div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;<span class="keywordflow">         ENDIF</span></div>
<div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;       <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;        s2= s2+xabs**2</div>
<div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;<span class="keywordflow">       ENDIF</span></div>
<div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;      <span class="keywordflow">IF</span>(s1 /= 0.0d0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;       fn_val= x1max*sqrt(s1+(s2/x1max)/x1max)</div>
<div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;       <span class="keywordflow">IF</span>(s2 /= 0.0d0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;        <span class="keywordflow">IF</span>(s2 &gt;= x3max) fn_val= sqrt(s2*(1.0d0+(x3max/s2)*(x3max*s3)))</div>
<div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;        <span class="keywordflow">IF</span>(s2 &lt; x3max) fn_val= sqrt(x3max*((s2/x3max)+(x3max*s3)))</div>
<div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;       <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;        fn_val= x3max*sqrt(s3)</div>
<div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;<span class="keywordflow">       ENDIF</span></div>
<div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;<span class="comment">*</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b9991931fe83ae42bd577aa132fd691"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b9991931fe83ae42bd577aa132fd691">&#9670;&nbsp;</a></span>hto_fdjac1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hto_solve_nonlin::hto_fdjac1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>HTO_FCN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>fvec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(ldfjac,n), intent(out)&#160;</td>
          <td class="paramname"><em>fjac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ldfjac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>iflag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, intent(in)&#160;</td>
          <td class="paramname"><em>epsfcn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>wa1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>wa2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CALLING__cpHTO_8f_source.html#l05962">5962</a> of file <a class="el" href="CALLING__cpHTO_8f_source.html">CALLING_cpHTO.f</a>.</p>
<div class="fragment"><div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: n</div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;      real*8, <span class="keywordtype">INTENT(IN OUT)</span>  :: x(n)</div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;      real*8, <span class="keywordtype">INTENT(IN)</span>      :: fvec(n)</div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: ldfjac</div>
<div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;      real*8, <span class="keywordtype">INTENT(OUT)</span>     :: fjac(ldfjac,n)</div>
<div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN OUT)</span>    :: iflag</div>
<div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: ml</div>
<div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: mu</div>
<div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;      real*8, <span class="keywordtype">INTENT(IN)</span>      :: epsfcn</div>
<div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;      real*8, <span class="keywordtype">INTENT(IN OUT)</span>  :: wa1(n)</div>
<div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;      real*8, <span class="keywordtype">INTENT(OUT)</span>     :: wa2(n)</div>
<div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;       </div>
<div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;<span class="comment">! EXTERNAL fcn</span></div>
<div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;      </div>
<div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;      <span class="keyword">INTERFACE</span></div>
<div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;       <span class="keyword">SUBROUTINE </span>hto_fcn(N,X,FVEC,IFLAG)</div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;       <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;       <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span>  :: dp= selected_real_kind(14,60)</div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;       <span class="keywordtype">INTEGER</span>,<span class="keywordtype">INTENT(IN)</span>      :: n</div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;       real*8,<span class="keywordtype">INTENT(IN)</span>    :: x(n)</div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;       real*8, <span class="keywordtype">INTENT(OUT)</span>   :: fvec(n)</div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;       <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN OUT)</span>  :: iflag</div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;       <span class="keyword">END SUBROUTINE </span>hto_fcn</div>
<div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;      <span class="keyword">END INTERFACE</span></div>
<div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160; </div>
<div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;<span class="comment">!   **********</span></div>
<div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160; </div>
<div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;<span class="comment">!   SUBROUTINE HTO_FDJAC1</span></div>
<div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160; </div>
<div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;<span class="comment">!   THIS SUBROUTINE HTO_COMPUTES A FORWARD-DIFFERENCE APPROXIMATION TO THE N BY N</span></div>
<div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;<span class="comment">!   JACOBIAN MATRIX ASSOCIATED WITH A SPECIFIED PROBLEM OF N FUNCTIONS IN N</span></div>
<div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;<span class="comment">!   VARIABLES.  IF THE JACOBIAN HAS A BANDED FORM, THEN FUNCTION EVALUATIONS</span></div>
<div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;<span class="comment">!   ARE SAVED BY ONLY APPROXIMATING THE NONZERO TERMS.</span></div>
<div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160; </div>
<div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;<span class="comment">!   THE SUBROUTINE HTO_STATEMENT IS</span></div>
<div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160; </div>
<div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;<span class="comment">!     SUBROUTINE HTO_FDJAC1(FCN,N,X,FVEC,FJAC,LDFJAC,IFLAG,ML,MU,EPSFCN,</span></div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;<span class="comment">!                       WA1,WA2)</span></div>
<div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160; </div>
<div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;<span class="comment">!   WHERE</span></div>
<div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160; </div>
<div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;<span class="comment">!     FCN IS THE NAME OF THE USER-SUPPLIED SUBROUTINE HTO_WHICH CALCULATES</span></div>
<div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;<span class="comment">!       THE FUNCTIONS.  FCN MUST BE DECLARED IN AN EXTERNAL STATEMENT IN</span></div>
<div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;<span class="comment">!       THE USER CALLING PROGRAM, AND SHOULD BE WRITTEN AS FOLLOWS.</span></div>
<div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160; </div>
<div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;<span class="comment">!       SUBROUTINE HTO_FCN(N,X,FVEC,IFLAG)</span></div>
<div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;<span class="comment">!       INTEGER N,IFLAG</span></div>
<div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;<span class="comment">!       REAL X(N),FVEC(N)</span></div>
<div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;<span class="comment">!       ----------</span></div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;<span class="comment">!       CALCULATE THE FUNCTIONS AT X AND</span></div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;<span class="comment">!       RETURN THIS VECTOR IN FVEC.</span></div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;<span class="comment">!       ----------</span></div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;<span class="comment">!       RETURN</span></div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;<span class="comment">!       END</span></div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160; </div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;<span class="comment">!       THE VALUE OF IFLAG SHOULD NOT BE CHANGED BY FCN UNLESS</span></div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;<span class="comment">!       THE USER WANTS TO TERMINATE EXECUTION OF FDJAC1.</span></div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;<span class="comment">!       IN THIS CASE SET IFLAG TO A NEGATIVE INTEGER.</span></div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160; </div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;<span class="comment">!     N IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER</span></div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;<span class="comment">!       OF FUNCTIONS AND VARIABLES.</span></div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160; </div>
<div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;<span class="comment">!     X IS AN INPUT ARRAY OF LENGTH N.</span></div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160; </div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;<span class="comment">!     FVEC IS AN INPUT ARRAY OF LENGTH N WHICH MUST CONTAIN THE</span></div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;<span class="comment">!       FUNCTIONS EVALUATED AT X.</span></div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160; </div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;<span class="comment">!     FJAC IS AN OUTPUT N BY N ARRAY WHICH CONTAINS THE</span></div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;<span class="comment">!       APPROXIMATION TO THE JACOBIAN MATRIX EVALUATED AT X.</span></div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160; </div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;<span class="comment">!     LDFJAC IS A POSITIVE INTEGER INPUT VARIABLE NOT LESS THAN N</span></div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;<span class="comment">!       WHICH SPECIFIES THE LEADING DIMENSION OF THE ARRAY FJAC.</span></div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160; </div>
<div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;<span class="comment">!     IFLAG IS AN INTEGER VARIABLE WHICH CAN BE USED TO TERMINATE</span></div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;<span class="comment">!       THE EXECUTION OF FDJAC1.  SEE DESCRIPTION OF FCN.</span></div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160; </div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;<span class="comment">!     ML IS A NONNEGATIVE INTEGER INPUT VARIABLE WHICH SPECIFIES</span></div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;<span class="comment">!       THE NUMBER OF SUBDIAGONALS WITHIN THE BAND OF THE</span></div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;<span class="comment">!       JACOBIAN MATRIX. IF THE JACOBIAN IS NOT BANDED, SET</span></div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;<span class="comment">!       ML TO AT LEAST N - 1.</span></div>
<div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160; </div>
<div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;<span class="comment">!     EPSFCN IS AN INPUT VARIABLE USED IN DETERMINING A SUITABLE</span></div>
<div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;<span class="comment">!       STEP LENGTH FOR THE FORWARD-DIFFERENCE APPROXIMATION. THIS</span></div>
<div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;<span class="comment">!       APPROXIMATION ASSUMES THAT THE RELATIVE ERRORS IN THE</span></div>
<div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;<span class="comment">!       FUNCTIONS ARE OF THE ORDER OF EPSFCN. IF EPSFCN IS LESS</span></div>
<div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;<span class="comment">!       THAN THE MACHINE PRECISION, IT IS ASSUMED THAT THE RELATIVE</span></div>
<div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;<span class="comment">!       ERRORS IN THE FUNCTIONS ARE OF THE ORDER OF THE MACHINE PRECISION.</span></div>
<div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160; </div>
<div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;<span class="comment">!     MU IS A NONNEGATIVE INTEGER INPUT VARIABLE WHICH SPECIFIES</span></div>
<div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;<span class="comment">!       THE NUMBER OF SUPERDIAGONALS WITHIN THE BAND OF THE</span></div>
<div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;<span class="comment">!       JACOBIAN MATRIX. IF THE JACOBIAN IS NOT BANDED, SET</span></div>
<div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;<span class="comment">!       MU TO AT LEAST N - 1.</span></div>
<div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160; </div>
<div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;<span class="comment">!     WA1 AND WA2 ARE WORK ARRAYS OF LENGTH N.  IF ML + MU + 1 IS AT</span></div>
<div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;<span class="comment">!       LEAST N, THEN THE JACOBIAN IS CONSIDERED DENSE, AND WA2 IS</span></div>
<div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;<span class="comment">!       NOT REFERENCED.</span></div>
<div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160; </div>
<div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;<span class="comment">!   SUBPROGRAMS CALLED</span></div>
<div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160; </div>
<div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;<span class="comment">!     MINPACK-SUPPLIED ... SPMPAR</span></div>
<div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160; </div>
<div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;<span class="comment">!     FORTRAN-SUPPLIED ... ABS,MAX,SQRT</span></div>
<div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160; </div>
<div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;<span class="comment">!   ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.</span></div>
<div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;<span class="comment">!   BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE</span></div>
<div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160; </div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;<span class="comment">!   **********</span></div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;      </div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;      <span class="keywordtype">INTEGER</span>    :: i,j,k,msum</div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;      real*8  :: <a class="code" href="namespacehto__units.html#abab92a867fb77543c0c4ff069d1783d4">eps</a>,epsmch,h,temp</div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;      real*8, <span class="keywordtype">PARAMETER</span>  :: <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>= 0.0d0</div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;      epsmch= epsilon(1.0d0)</div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;      <a class="code" href="namespacehto__units.html#abab92a867fb77543c0c4ff069d1783d4">eps</a>= sqrt(max(epsfcn,epsmch))</div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;      msum= ml+mu+1</div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;      <span class="keywordflow">IF</span>(msum &gt;= n) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;       <span class="keywordflow">DO</span> j= 1,n</div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;        temp= x(j)</div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;        h= <a class="code" href="namespacehto__units.html#abab92a867fb77543c0c4ff069d1783d4">eps</a>*abs(temp)</div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;        <span class="keywordflow">IF</span>(h == <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) h= <a class="code" href="namespacehto__units.html#abab92a867fb77543c0c4ff069d1783d4">eps</a></div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;        x(j)= temp+h</div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;        <span class="keyword">CALL </span>hto_fcn(n,x,wa1,iflag)</div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;        <span class="keywordflow">IF</span>(iflag &lt; 0) <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;        x(j)= temp</div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;        <span class="keywordflow">DO</span> i= 1,n</div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;         fjac(i,j)= (wa1(i)-fvec(i))/h</div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;<span class="keywordflow">       ENDDO</span></div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;       <span class="keywordflow">DO</span> k= 1,msum</div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;        <span class="keywordflow">DO</span> j= k,n,msum</div>
<div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;         wa2(j)= x(j)</div>
<div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;         h= <a class="code" href="namespacehto__units.html#abab92a867fb77543c0c4ff069d1783d4">eps</a>*abs(wa2(j))</div>
<div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;         <span class="keywordflow">IF</span>(h == <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) h= <a class="code" href="namespacehto__units.html#abab92a867fb77543c0c4ff069d1783d4">eps</a></div>
<div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;         x(j)= wa2(j)+h</div>
<div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;        <span class="keyword">CALL </span>hto_fcn(n,x,wa1,iflag)</div>
<div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;        <span class="keywordflow">IF</span>(iflag &lt; 0) <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;        <span class="keywordflow">DO</span> j= k,n,msum</div>
<div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;         x(j)= wa2(j)</div>
<div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;         h= <a class="code" href="namespacehto__units.html#abab92a867fb77543c0c4ff069d1783d4">eps</a>*abs(wa2(j))</div>
<div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;         <span class="keywordflow">IF</span>(h == <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) h= <a class="code" href="namespacehto__units.html#abab92a867fb77543c0c4ff069d1783d4">eps</a></div>
<div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;         <span class="keywordflow">DO</span> i= 1,n</div>
<div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;          fjac(i,j)= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a></div>
<div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;          <span class="keywordflow">IF</span>(i &gt;= j-mu.and.i &lt;= j+ml) fjac(i,j)= (wa1(i)-fvec(i))/h</div>
<div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;<span class="keywordflow">         ENDDO</span></div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;<span class="keywordflow">       ENDDO</span></div>
<div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;<span class="comment">* </span></div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;<span class="comment">*</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4913ccbfdbf22332947aa02f3df9eee5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4913ccbfdbf22332947aa02f3df9eee5">&#9670;&nbsp;</a></span>hto_hbrd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public hto_solve_nonlin::hto_hbrd </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>HTO_FCN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>fvec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, intent(in)&#160;</td>
          <td class="paramname"><em>epsfcn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, intent(in)&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>diag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CALLING__cpHTO_8f_source.html#l05311">5311</a> of file <a class="el" href="CALLING__cpHTO_8f_source.html">CALLING_cpHTO.f</a>.</p>
<div class="fragment"><div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;<span class="comment">* </span></div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;<span class="comment">! Code converted using TO_F90 by Alan Miller</span></div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;<span class="comment">! Date: 2003-07-15  Time: 13:27:42</span></div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>     :: n</div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;      real*8, <span class="keywordtype">INTENT(IN OUT)</span>  :: x(n)</div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;      real*8, <span class="keywordtype">INTENT(IN OUT)</span>  :: fvec(n)</div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;      real*8, <span class="keywordtype">INTENT(IN)</span>      :: epsfcn</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;      real*8, <span class="keywordtype">INTENT(IN)</span>      :: tol</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(OUT)</span>    :: info</div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;      real*8, <span class="keywordtype">INTENT(OUT)</span>     :: diag(n)</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;<span class="comment">! EXTERNAL fcn</span></div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;      <span class="keyword">INTERFACE</span></div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;       <span class="keyword">SUBROUTINE </span>hto_fcn(N,X,FVEC,IFLAG)</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;       <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;       <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>      :: n</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;       real*8, <span class="keywordtype">INTENT(IN)</span>    :: x(n)</div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;       real*8, <span class="keywordtype">INTENT(OUT)</span>   :: fvec(n)</div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;       <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN OUT)</span>  :: iflag</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;       <span class="keyword">END SUBROUTINE </span>hto_fcn</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;      <span class="keyword">END INTERFACE</span></div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160; </div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;<span class="comment">!   **********</span></div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160; </div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;<span class="comment">!   SUBROUTINE HTO_HBRD</span></div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160; </div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;<span class="comment">!   THE PURPOSE OF HBRD IS TO FIND A ZERO OF A SYSTEM OF N NONLINEAR</span></div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;<span class="comment">!   FUNCTIONS IN N VARIABLES BY A MODIFICATION OF THE POWELL HYBRID METHOD.</span></div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;<span class="comment">!   THIS IS DONE BY USING THE MORE GENERAL NONLINEAR EQUATION SOLVER HYBRD.</span></div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;<span class="comment">!   THE USER MUST PROVIDE A SUBROUTINE HTO_WHICH CALCULATES THE FUNCTIONS.</span></div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;<span class="comment">!   THE JACOBIAN IS THEN CALCULATED BY A FORWARD-DIFFERENCE APPROXIMATION.</span></div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160; </div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;<span class="comment">!   THE SUBROUTINE HTO_STATEMENT IS</span></div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160; </div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;<span class="comment">!     SUBROUTINE HTO_HBRD(N,X,FVEC,EPSFCN,TOL,INFO,WA,LWA)</span></div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160; </div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;<span class="comment">!   WHERE</span></div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160; </div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;<span class="comment">!     FCN IS THE NAME OF THE USER-SUPPLIED SUBROUTINE HTO_WHICH CALCULATES</span></div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;<span class="comment">!       THE FUNCTIONS.  FCN MUST BE DECLARED IN AN EXTERNAL STATEMENT</span></div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;<span class="comment">!       IN THE USER CALLING PROGRAM, AND SHOULD BE WRITTEN AS FOLLOWS.</span></div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160; </div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;<span class="comment">!       SUBROUTINE HTO_FCN(N,X,FVEC,IFLAG)</span></div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;<span class="comment">!       INTEGER N,IFLAG</span></div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;<span class="comment">!       REAL X(N),FVEC(N)</span></div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;<span class="comment">!       ----------</span></div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;<span class="comment">!       CALCULATE THE FUNCTIONS AT X AND RETURN THIS VECTOR IN FVEC.</span></div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;<span class="comment">!       ---------</span></div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;<span class="comment">!       RETURN</span></div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;<span class="comment">!       END</span></div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160; </div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;<span class="comment">!       THE VALUE OF IFLAG NOT BE CHANGED BY FCN UNLESS</span></div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;<span class="comment">!       THE USER WANTS TO TERMINATE THE EXECUTION OF HBRD.</span></div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;<span class="comment">!       IN THIS CASE SET IFLAG TO A NEGATIVE INTEGER.</span></div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160; </div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;<span class="comment">!     N IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER</span></div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;<span class="comment">!       OF FUNCTIONS AND VARIABLES.</span></div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160; </div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;<span class="comment">!     X IS AN ARRAY OF LENGTH N. ON INPUT X MUST CONTAIN AN INITIAL</span></div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;<span class="comment">!       ESTIMATE OF THE SOLUTION VECTOR.  ON OUTPUT X CONTAINS THE</span></div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;<span class="comment">!       FINAL ESTIMATE OF THE SOLUTION VECTOR.</span></div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160; </div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;<span class="comment">!     FVEC IS AN OUTPUT ARRAY OF LENGTH N WHICH CONTAINS</span></div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;<span class="comment">!       THE FUNCTIONS EVALUATED AT THE OUTPUT X.</span></div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160; </div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;<span class="comment">!     EPSFCN IS AN INPUT VARIABLE USED IN DETERMINING A SUITABLE STEP LENGTH</span></div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;<span class="comment">!       FOR THE FORWARD-DIFFERENCE APPROXIMATION.  THIS APPROXIMATION ASSUMES</span></div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;<span class="comment">!       THAT THE RELATIVE ERRORS IN THE FUNCTIONS ARE OF THE ORDER OF EPSFCN.</span></div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;<span class="comment">!       IF EPSFCN IS LESS THAN THE MACHINE PRECISION, IT IS ASSUMED THAT THE</span></div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;<span class="comment">!       RELATIVE ERRORS IN THE FUNCTIONS ARE OF THE ORDER OF THE MACHINE</span></div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;<span class="comment">!       PRECISION.</span></div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160; </div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;<span class="comment">!     TOL IS A NONNEGATIVE INPUT VARIABLE.  TERMINATION OCCURS WHEN THE</span></div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;<span class="comment">!       ALGORITHM ESTIMATES THAT THE RELATIVE ERROR BETWEEN X AND THE SOLUTION</span></div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;<span class="comment">!       IS AT MOST TOL.</span></div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160; </div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;<span class="comment">!     INFO IS AN INTEGER OUTPUT VARIABLE.  IF THE USER HAS TERMINATED</span></div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;<span class="comment">!       EXECUTION, INFO IS SET TO THE (NEGATIVE) VALUE OF IFLAG.</span></div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;<span class="comment">!       SEE DESCRIPTION OF FCN.  OTHERWISE, INFO IS SET AS FOLLOWS.</span></div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160; </div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;<span class="comment">!       INFO= 0   IMPROPER INPUT PARAMETERS.</span></div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160; </div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;<span class="comment">!       INFO= 1   ALGORITHM ESTIMATES THAT THE RELATIVE ERROR</span></div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;<span class="comment">!                  BETWEEN X AND THE SOLUTION IS AT MOST TOL.</span></div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160; </div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;<span class="comment">!       INFO= 2   NUMBER OF CALLS TO FCN HAS REACHED OR EXCEEDED 200*(N+1).</span></div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160; </div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;<span class="comment">!       INFO= 3   TOL IS TOO SMALL. NO FURTHER IMPROVEMENT IN</span></div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;<span class="comment">!                  THE APPROXIMATE SOLUTION X IS POSSIBLE.</span></div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160; </div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;<span class="comment">!       INFO= 4   ITERATION IS NOT MAKING GOOD PROGRESS.</span></div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160; </div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;<span class="comment">!   SUBPROGRAMS CALLED</span></div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160; </div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;<span class="comment">!     USER-SUPPLIED ...... FCN</span></div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160; </div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;<span class="comment">!     MINPACK-SUPPLIED ... HYBRD</span></div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160; </div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;<span class="comment">!   ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.</span></div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;<span class="comment">!   BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE</span></div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160; </div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;<span class="comment">! Reference:</span></div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;<span class="comment">! Powell, M.J.D. &#39;A hybrid method for nonlinear equations&#39; in Numerical Methods</span></div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;<span class="comment">!      for Nonlinear Algebraic Equations&#39;, P.Rabinowitz (editor), Gordon and</span></div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;<span class="comment">!      Breach, London 1970.</span></div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;<span class="comment">!   **********</span></div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;      <span class="keywordtype">INTEGER</span> :: maxfev, ml,mode,mu,nfev,nprint</div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;      real*8  :: xtol</div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;      real*8, <span class="keywordtype">PARAMETER</span>  :: factor= 100.0d0,<a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>= 0.0d0</div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;      </div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;      info= 0</div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160; </div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;<span class="comment">!     CHECK THE INPUT PARAMETERS FOR ERRORS.</span></div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160; </div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;      <span class="keywordflow">IF</span>(n &lt;= 0.or.epsfcn &lt; <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>.or.tol &lt; <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) <span class="keywordflow">GO TO</span> 20</div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160; </div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;<span class="comment">!     CALL HTO_HYBRD.</span></div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160; </div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;      maxfev= 200*(n+1)</div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;      xtol= tol</div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;      ml= n-1</div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;      mu= n-1</div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;      mode= 2</div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;      nprint= 0</div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;      <span class="keyword">CALL </span>hto_hybrd(hto_fcn,n,x,fvec,xtol,maxfev,ml,mu,epsfcn,diag,</div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;     #               mode,factor,nprint,info,nfev)</div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;      <span class="keywordflow">IF</span>(info == 5) info= 4</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;   20 <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;       </div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;<span class="comment">!     LAST CARD OF SUBROUTINE HTO_HBRD.</span></div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2fedece7d4082c4306271f14df72387e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fedece7d4082c4306271f14df72387e">&#9670;&nbsp;</a></span>hto_hybrd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public hto_solve_nonlin::hto_hybrd </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>HTO_FCN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>fvec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, intent(in)&#160;</td>
          <td class="paramname"><em>xtol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>maxfev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>ml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, intent(in)&#160;</td>
          <td class="paramname"><em>epsfcn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, intent(in)&#160;</td>
          <td class="paramname"><em>factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>nprint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>nfev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CALLING__cpHTO_8f_source.html#l05450">5450</a> of file <a class="el" href="CALLING__cpHTO_8f_source.html">CALLING_cpHTO.f</a>.</p>
<div class="fragment"><div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160; </div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: n</div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;      real*8, <span class="keywordtype">INTENT(IN OUT)</span>  :: x(n)</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;      real*8, <span class="keywordtype">INTENT(IN OUT)</span>  :: fvec(n)</div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;      real*8, <span class="keywordtype">INTENT(IN)</span>      :: xtol</div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN OUT)</span>    :: maxfev</div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN OUT)</span>    :: ml</div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: mu</div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;      real*8, <span class="keywordtype">INTENT(IN)</span>      :: epsfcn</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;      real*8, <span class="keywordtype">INTENT(OUT)</span>     :: diag(n)</div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: mode</div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;      real*8, <span class="keywordtype">INTENT(IN)</span>      :: factor</div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN OUT)</span>    :: nprint</div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(OUT)</span>       :: info</div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(OUT)</span>       :: nfev</div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160; </div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;<span class="comment">! EXTERNAL fcn</span></div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160; </div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;      <span class="keyword">INTERFACE</span></div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;       <span class="keyword">SUBROUTINE </span>hto_fcn(N,X,FVEC,IFLAG)</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;       <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;       <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>      :: n</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;       real*8, <span class="keywordtype">INTENT(IN)</span>    :: x(n)</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;       real*8, <span class="keywordtype">INTENT(OUT)</span>   :: fvec(n)</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;       <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN OUT)</span>  :: iflag</div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;       <span class="keyword">END SUBROUTINE </span>hto_fcn</div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;      <span class="keyword">END INTERFACE</span></div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160; </div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;<span class="comment">!   **********</span></div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160; </div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;<span class="comment">!   SUBROUTINE HTO_HYBRD</span></div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160; </div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;<span class="comment">!   THE PURPOSE OF HYBRD IS TO FIND A ZERO OF A SYSTEM OF N NONLINEAR</span></div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;<span class="comment">!   FUNCTIONS IN N VARIABLES BY A MODIFICATION OF THE POWELL HYBRID METHOD.</span></div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;<span class="comment">!   THE USER MUST PROVIDE A SUBROUTINE HTO_WHICH CALCULATES THE FUNCTIONS.</span></div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;<span class="comment">!   THE JACOBIAN IS THEN CALCULATED BY A FORWARD-DIFFERENCE APPROXIMATION.</span></div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160; </div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;<span class="comment">!   THE SUBROUTINE HTO_STATEMENT IS</span></div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160; </div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;<span class="comment">!     SUBROUTINE HTO_HYBRD(FCN,N,X,FVEC,XTOL,MAXFEV,ML,MU,EPSFCN,</span></div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;<span class="comment">!                      DIAG,MODE,FACTOR,NPRINT,INFO,NFEV,FJAC,</span></div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;<span class="comment">!                      LDFJAC,R,LR,QTF,WA1,WA2,WA3,WA4)</span></div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160; </div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;<span class="comment">!   WHERE</span></div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160; </div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;<span class="comment">!     FCN IS THE NAME OF THE USER-SUPPLIED SUBROUTINE HTO_WHICH CALCULATES</span></div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;<span class="comment">!       THE FUNCTIONS.  FCN MUST BE DECLARED IN AN EXTERNAL STATEMENT IN</span></div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;<span class="comment">!       THE USER CALLING PROGRAM, AND SHOULD BE WRITTEN AS FOLLOWS.</span></div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160; </div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;<span class="comment">!       SUBROUTINE HTO_FCN(N, X, FVEC, IFLAG)</span></div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;<span class="comment">!       INTEGER N, IFLAG</span></div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;<span class="comment">!       REAL X(N), FVEC(N)</span></div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;<span class="comment">!       ----------</span></div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;<span class="comment">!       CALCULATE THE FUNCTIONS AT X AND</span></div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;<span class="comment">!       RETURN THIS VECTOR IN FVEC.</span></div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;<span class="comment">!       ---------</span></div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;<span class="comment">!       RETURN</span></div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;<span class="comment">!       END</span></div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160; </div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;<span class="comment">!       THE VALUE OF IFLAG SHOULD NOT BE CHANGED BY FCN UNLESS</span></div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;<span class="comment">!       THE USER WANTS TO TERMINATE EXECUTION OF HYBRD.</span></div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;<span class="comment">!       IN THIS CASE SET IFLAG TO A NEGATIVE INTEGER.</span></div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160; </div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;<span class="comment">!     N IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER</span></div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;<span class="comment">!       OF FUNCTIONS AND VARIABLES.</span></div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160; </div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;<span class="comment">!     X IS AN ARRAY OF LENGTH N.  ON INPUT X MUST CONTAIN AN INITIAL</span></div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;<span class="comment">!       ESTIMATE OF THE SOLUTION VECTOR.  ON OUTPUT X CONTAINS THE FINAL</span></div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;<span class="comment">!       ESTIMATE OF THE SOLUTION VECTOR.</span></div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160; </div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;<span class="comment">!     FVEC IS AN OUTPUT ARRAY OF LENGTH N WHICH CONTAINS</span></div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;<span class="comment">!       THE FUNCTIONS EVALUATED AT THE OUTPUT X.</span></div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160; </div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;<span class="comment">!     XTOL IS A NONNEGATIVE INPUT VARIABLE.  TERMINATION OCCURS WHEN THE</span></div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;<span class="comment">!       RELATIVE ERROR BETWEEN TWO CONSECUTIVE ITERATES IS AT MOST XTOL.</span></div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160; </div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;<span class="comment">!     MAXFEV IS A POSITIVE INTEGER INPUT VARIABLE.  TERMINATION OCCURS WHEN</span></div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;<span class="comment">!       THE NUMBER OF CALLS TO FCN IS AT LEAST MAXFEV BY THE END OF AN</span></div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;<span class="comment">!       ITERATION.</span></div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160; </div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;<span class="comment">!     ML IS A NONNEGATIVE INTEGER INPUT VARIABLE WHICH SPECIFIES THE</span></div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;<span class="comment">!       NUMBER OF SUBDIAGONALS WITHIN THE BAND OF THE JACOBIAN MATRIX.</span></div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;<span class="comment">!       IF THE JACOBIAN IS NOT BANDED, SET ML TO AT LEAST N - 1.</span></div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160; </div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;<span class="comment">!     MU IS A NONNEGATIVE INTEGER INPUT VARIABLE WHICH SPECIFIES THE NUMBER</span></div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;<span class="comment">!       OF SUPERDIAGONALS WITHIN THE BAND OF THE JACOBIAN MATRIX.</span></div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;<span class="comment">!       IF THE JACOBIAN IS NOT BANDED, SET MU TO AT LEAST N - 1.</span></div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160; </div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;<span class="comment">!     EPSFCN IS AN INPUT VARIABLE USED IN DETERMINING A SUITABLE STEP LENGTH</span></div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;<span class="comment">!       FOR THE FORWARD-DIFFERENCE APPROXIMATION.  THIS APPROXIMATION</span></div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;<span class="comment">!       ASSUMES THAT THE RELATIVE ERRORS IN THE FUNCTIONS ARE OF THE ORDER</span></div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;<span class="comment">!       OF EPSFCN. IF EPSFCN IS LESS THAN THE MACHINE PRECISION,</span></div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;<span class="comment">!       IT IS ASSUMED THAT THE RELATIVE ERRORS IN THE FUNCTIONS ARE OF THE</span></div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;<span class="comment">!       ORDER OF THE MACHINE PRECISION.</span></div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160; </div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;<span class="comment">!     DIAG IS AN ARRAY OF LENGTH N. IF MODE= 1 (SEE BELOW),</span></div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;<span class="comment">!       DIAG IS INTERNALLY SET.  IF MODE= 2, DIAG MUST CONTAIN POSITIVE</span></div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;<span class="comment">!       ENTRIES THAT SERVE AS MULTIPLICATIVE SCALE FACTORS FOR THE</span></div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;<span class="comment">!       VARIABLES.</span></div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160; </div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;<span class="comment">!     MODE IS AN INTEGER INPUT VARIABLE. IF MODE= 1, THE VARIABLES WILL BE</span></div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;<span class="comment">!       SCALED INTERNALLY.  IF MODE= 2, THE SCALING IS SPECIFIED BY THE</span></div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;<span class="comment">!       INPUT DIAG.  OTHER VALUES OF MODE ARE EQUIVALENT TO MODE= 1.</span></div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160; </div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;<span class="comment">!     FACTOR IS A POSITIVE INPUT VARIABLE USED IN DETERMINING THE</span></div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;<span class="comment">!       INITIAL STEP BOUND. THIS BOUND IS SET TO THE PRODUCT OF</span></div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;<span class="comment">!       FACTOR AND THE EUCLIDEAN NORM OF DIAG*X IF NONZERO, OR ELSE</span></div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;<span class="comment">!       TO FACTOR ITSELF. IN MOST CASES FACTOR SHOULD LIE IN THE</span></div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;<span class="comment">!       INTERVAL (.1,100.). 100. IS A GENERALLY RECOMMENDED VALUE.</span></div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160; </div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;<span class="comment">!     NPRINT IS AN INTEGER INPUT VARIABLE THAT ENABLES CONTROLLED</span></div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;<span class="comment">!       PRINTING OF ITERATES IF IT IS POSITIVE. IN THIS CASE,</span></div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;<span class="comment">!       FCN IS CALLED WITH IFLAG= 0 AT THE BEGINNING OF THE FIRST</span></div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;<span class="comment">!       ITERATION AND EVERY NPRINT ITERATIONS THEREAFTER AND</span></div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;<span class="comment">!       IMMEDIATELY PRIOR TO RETURN, WITH X AND FVEC AVAILABLE</span></div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;<span class="comment">!       FOR PRINTING. IF NPRINT IS NOT POSITIVE, NO SPECIAL CALLS</span></div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;<span class="comment">!       OF FCN WITH IFLAG= 0 ARE MADE.</span></div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160; </div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;<span class="comment">!     INFO IS AN INTEGER OUTPUT VARIABLE. IF THE USER HAS</span></div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;<span class="comment">!       TERMINATED EXECUTION, INFO IS SET TO THE (NEGATIVE)</span></div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;<span class="comment">!       VALUE OF IFLAG. SEE DESCRIPTION OF FCN. OTHERWISE,</span></div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;<span class="comment">!       INFO IS SET AS FOLLOWS.</span></div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160; </div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;<span class="comment">!       INFO= 0   IMPROPER INPUT PARAMETERS.</span></div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160; </div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;<span class="comment">!       INFO= 1   RELATIVE ERROR BETWEEN TWO CONSECUTIVE ITERATES</span></div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;<span class="comment">!                  IS AT MOST XTOL.</span></div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160; </div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;<span class="comment">!       INFO= 2   NUMBER OF CALLS TO FCN HAS REACHED OR EXCEEDED MAXFEV.</span></div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160; </div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;<span class="comment">!       INFO= 3   XTOL IS TOO SMALL. NO FURTHER IMPROVEMENT IN</span></div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;<span class="comment">!                  THE APPROXIMATE SOLUTION X IS POSSIBLE.</span></div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160; </div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;<span class="comment">!       INFO= 4   ITERATION IS NOT MAKING GOOD PROGRESS, AS</span></div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;<span class="comment">!                  MEASURED BY THE IMPROVEMENT FROM THE LAST</span></div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;<span class="comment">!                  FIVE JACOBIAN EVALUATIONS.</span></div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160; </div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;<span class="comment">!       INFO= 5   ITERATION IS NOT MAKING GOOD PROGRESS, AS MEASURED BY</span></div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;<span class="comment">!                  THE IMPROVEMENT FROM THE LAST TEN ITERATIONS.</span></div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160; </div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;<span class="comment">!     NFEV IS AN INTEGER OUTPUT VARIABLE SET TO THE NUMBER OF CALLS TO FCN.</span></div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160; </div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;<span class="comment">!     FJAC IS AN OUTPUT N BY N ARRAY WHICH CONTAINS THE ORTHOGONAL MATRIX Q</span></div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;<span class="comment">!       PRODUCED BY THE QR FACTORIZATION OF THE FINAL APPROXIMATE JACOBIAN.</span></div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160; </div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;<span class="comment">!     LDFJAC IS A POSITIVE INTEGER INPUT VARIABLE NOT LESS THAN N</span></div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;<span class="comment">!       WHICH SPECIFIES THE LEADING DIMENSION OF THE ARRAY FJAC.</span></div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160; </div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;<span class="comment">!     R IS AN OUTPUT ARRAY OF LENGTH LR WHICH CONTAINS THE</span></div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;<span class="comment">!       UPPER TRIANGULAR MATRIX PRODUCED BY THE QR FACTORIZATION</span></div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;<span class="comment">!       OF THE FINAL APPROXIMATE JACOBIAN, STORED ROWWISE.</span></div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160; </div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;<span class="comment">!     LR IS A POSITIVE INTEGER INPUT VARIABLE NOT LESS THAN (N*(N+1))/2.</span></div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160; </div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;<span class="comment">!     QTF IS AN OUTPUT ARRAY OF LENGTH N WHICH CONTAINS</span></div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;<span class="comment">!       THE VECTOR (Q TRANSPOSE)*FVEC.</span></div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160; </div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;<span class="comment">!     WA1, WA2, WA3, AND WA4 ARE WORK ARRAYS OF LENGTH N.</span></div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160; </div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;<span class="comment">!   SUBPROGRAMS CALLED</span></div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160; </div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;<span class="comment">!     USER-SUPPLIED ...... FCN</span></div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160; </div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;<span class="comment">!     MINPACK-SUPPLIED ... DOGLEG,SPMPAR,ENORM,FDJAC1,</span></div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;<span class="comment">!                          QFORM,QRFAC,R1MPYQ,R1UPDT</span></div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160; </div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;<span class="comment">!     FORTRAN-SUPPLIED ... ABS,MAX,MIN,MIN,MOD</span></div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160; </div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;<span class="comment">!   ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.</span></div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;<span class="comment">!   BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE</span></div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160; </div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;<span class="comment">!   **********</span></div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;      </div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;      <span class="keywordtype">INTEGER</span>    :: i,iflag,iter,j,jm1,l,lr,msum,ncfail,ncsuc,</div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;     #              nslow1,nslow2</div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;      <span class="keywordtype">INTEGER</span>    :: iwa(1)</div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;      <span class="keywordtype">LOGICAL</span>    :: jeval,sing</div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;      real*8  :: actred,delta,epsmch,fnorm,fnorm1,pnorm,prered,  </div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;     #           ratio,sum,temp,xnorm</div>
<div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;      real*8, <span class="keywordtype">PARAMETER</span>  :: <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>= 1.0d0,p1= 0.1d0,p5= 0.5d0,  </div>
<div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;     #                      p001= 0.001d0,p0001= 0.0001d0,<a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>= 0.0d0</div>
<div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;      real*8  :: fjac(n,n),r(n*(n+1)/2),qtf(n),wa1(n),wa2(n),</div>
<div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;     #           wa3(n),wa4(n)</div>
<div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;      epsmch= epsilon(1.0d0)</div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;      info= 0</div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;      iflag= 0</div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;      nfev= 0</div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;      lr= n*(n+1)/2</div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;      <span class="keywordflow">IF</span>(n &gt; 0.and.xtol &gt;= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>.and.maxfev &gt; 0.and.ml &gt;= 0</div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;     #        .and.mu &gt;= 0.and.factor &gt; <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;      <span class="keywordflow">IF</span>(mode == 2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;       diag(1:n)= <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a></div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;      iflag= 1</div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;      <span class="keyword">CALL </span>hto_fcn(n,x,fvec,iflag)</div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;      nfev= 1</div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;      <span class="keywordflow">IF</span>(iflag &gt;= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;      fnorm= hto_enorm(n,fvec)</div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;      msum= min(ml+mu+1,n)</div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;      iter= 1</div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;      ncsuc= 0</div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;      ncfail= 0</div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;      nslow1= 0</div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;      nslow2= 0</div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;  20  jeval= .true.</div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;      iflag= 2</div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;      <span class="keyword">CALL </span>hto_fdjac1(hto_fcn,n,x,fvec,fjac,n,iflag,ml,mu,epsfcn,</div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;     #                wa1,wa2)</div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;      nfev= nfev+msum</div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;      <span class="keywordflow">IF</span>(iflag &gt;= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;      <span class="keyword">CALL </span>hto_qrfac(n,n,fjac,n,.false.,iwa,1,wa1,wa2,wa3)</div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;      <span class="keywordflow">IF</span>(iter == 1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;      <span class="keywordflow">IF</span>(mode /= 2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;       <span class="keywordflow">DO</span> j= 1,n</div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;        diag(j)= wa2(j)</div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;        <span class="keywordflow">IF</span>(wa2(j) == <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) diag(j)= <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a></div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;<span class="keywordflow">       ENDDO</span></div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;      wa3(1:n)= diag(1:n)*x(1:n)</div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;      xnorm= hto_enorm(n,wa3)</div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;      delta= factor*xnorm</div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;      <span class="keywordflow">IF</span>(delta == <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) delta= factor</div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;      qtf(1:n)= fvec(1:n)</div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;      <span class="keywordflow">DO</span> j= 1,n</div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;       <span class="keywordflow">IF</span>(fjac(j,j) /= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;        sum= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a></div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;        <span class="keywordflow">DO</span> i= j,n</div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;          sum= sum+fjac(i,j)*qtf(i)</div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;        temp= -sum/fjac(j,j)</div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;        <span class="keywordflow">DO</span> i= j,n</div>
<div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;          qtf(i)= qtf(i)+fjac(i,j)*temp</div>
<div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;<span class="keywordflow">       ENDIF</span></div>
<div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;      sing= .false.</div>
<div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;      <span class="keywordflow">DO</span> j= 1,n</div>
<div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;       l= j</div>
<div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;       jm1= j-1</div>
<div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;       <span class="keywordflow">IF</span>(jm1 &gt;= 1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;        <span class="keywordflow">DO</span> i= 1,jm1</div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;         r(l)= fjac(i,j)</div>
<div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;         l= l+n-i</div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;<span class="keywordflow">       ENDIF</span></div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;       r(l)= wa1(j)</div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;       <span class="keywordflow">IF</span>(wa1(j) == <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) sing= .true.</div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;      <span class="keyword">CALL </span>hto_qform(n,n,fjac,n,wa1)</div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;      <span class="keywordflow">IF</span>(mode /= 2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;       <span class="keywordflow">DO</span> j= 1,n</div>
<div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;        diag(j)= max(diag(j),wa2(j))</div>
<div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;<span class="keywordflow">       ENDDO</span></div>
<div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;  120 <span class="keywordflow">IF</span>(nprint &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;       iflag= 0</div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;       <span class="keywordflow">IF</span>(mod(iter-1,nprint) == 0) <span class="keyword">CALL </span>hto_fcn(n,x,fvec,iflag)</div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;       <span class="keywordflow">IF</span>(iflag &lt; 0) <span class="keywordflow">GO TO</span> 190</div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;      <span class="keyword">CALL </span>hto_dogleg(n,r,lr,diag,qtf,delta,wa1,wa2,wa3)</div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;      <span class="keywordflow">DO</span> j= 1,n</div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;       wa1(j)= -wa1(j)</div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;       wa2(j)= x(j)+wa1(j)</div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;       wa3(j)= diag(j)*wa1(j)</div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;      pnorm= hto_enorm(n,wa3)</div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;      <span class="keywordflow">IF</span>(iter == 1) delta= min(delta,pnorm)</div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;      iflag= 1</div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;      <span class="keyword">CALL </span>hto_fcn(n,wa2,wa4,iflag)</div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;      nfev= nfev+1</div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;      <span class="keywordflow">IF</span>(iflag &gt;= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;      fnorm1= hto_enorm(n,wa4)</div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;      actred= -<a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a></div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;      <span class="keywordflow">IF</span>(fnorm1 &lt; fnorm) actred= <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>-(fnorm1/fnorm)**2</div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;      l= 1</div>
<div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;      <span class="keywordflow">DO</span> i= 1,n</div>
<div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;       sum= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a></div>
<div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;       <span class="keywordflow">DO</span> j= i,n</div>
<div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;        sum= sum+r(l)*wa1(j)</div>
<div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;        l= l+1</div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;<span class="keywordflow">       ENDDO</span></div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;       wa3(i)= qtf(i)+sum</div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;      temp= hto_enorm(n,wa3)</div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;      prered= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a></div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;      <span class="keywordflow">IF</span>(temp &lt; fnorm) prered= <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>-(temp/fnorm)**2</div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;      ratio= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a></div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;      <span class="keywordflow">IF</span>(prered &gt; <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) ratio= actred/prered</div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;      <span class="keywordflow">IF</span>(ratio &lt; p1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;       ncsuc= 0</div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;       ncfail= ncfail+1</div>
<div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;       delta= p5*delta</div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;       ncfail= 0</div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;       ncsuc= ncsuc+1</div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;       <span class="keywordflow">IF</span>(ratio &gt;= p5.or.ncsuc &gt; 1) delta= max(delta,pnorm/p5)</div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;       <span class="keywordflow">IF</span>(abs(ratio-<a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>) &lt;= p1) delta= pnorm/p5</div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;      <span class="keywordflow">IF</span>(ratio &gt;= p0001) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;       <span class="keywordflow">DO</span> j= 1,n</div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;        x(j)= wa2(j)</div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;        wa2(j)= diag(j)*x(j)</div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;        fvec(j)= wa4(j)</div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;<span class="keywordflow">       ENDDO</span></div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;       xnorm= hto_enorm(n,wa2)</div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;       fnorm= fnorm1</div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;       iter= iter+1</div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;      nslow1= nslow1+1</div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;      <span class="keywordflow">IF</span>(actred &gt;= p001) nslow1= 0</div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;      <span class="keywordflow">IF</span>(jeval) nslow2= nslow2+1</div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;      <span class="keywordflow">IF</span>(actred &gt;= p1) nslow2= 0</div>
<div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;      <span class="keywordflow">IF</span>(delta &lt;= xtol*xnorm.or.fnorm == <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) info= 1</div>
<div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;      <span class="keywordflow">IF</span>(info == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;      <span class="keywordflow">IF</span>(nfev &gt;= maxfev) info= 2</div>
<div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;      <span class="keywordflow">IF</span>(p1*max(p1*delta,pnorm) &lt;= epsmch*xnorm) info= 3</div>
<div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;      <span class="keywordflow">IF</span>(nslow2 == 5) info= 4</div>
<div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;      <span class="keywordflow">IF</span>(nslow1 == 10) info= 5</div>
<div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;      <span class="keywordflow">IF</span>(info == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;      <span class="keywordflow">IF</span>(ncfail /= 2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;      <span class="keywordflow">DO</span> j= 1,n</div>
<div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;       sum= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a></div>
<div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;       <span class="keywordflow">DO</span> i= 1,n</div>
<div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;        sum= sum+fjac(i,j)*wa4(i)</div>
<div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;<span class="keywordflow">       ENDDO</span></div>
<div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;       wa2(j)= (sum-wa3(j))/pnorm</div>
<div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;       wa1(j)= diag(j)*((diag(j)*wa1(j))/pnorm)</div>
<div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;       <span class="keywordflow">IF</span>(ratio &gt;= p0001) qtf(j)= sum</div>
<div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;      <span class="keyword">CALL </span>hto_r1updt(n,n,r,lr,wa1,wa2,wa3,sing)</div>
<div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;      <span class="keyword">CALL </span>hto_r1mpyq(n,n,fjac,n,wa2,wa3)</div>
<div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;      <span class="keyword">CALL </span>hto_r1mpyq(1,n,qtf,1,wa2,wa3)</div>
<div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;      jeval= .false.</div>
<div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;      <span class="keywordflow">GO TO</span> 120</div>
<div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;      <span class="keywordflow">GO TO</span> 20</div>
<div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160; 190  <span class="keywordflow">IF</span>(iflag &lt; 0) info= iflag</div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;      iflag= 0</div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;      <span class="keywordflow">IF</span>(nprint &gt; 0) <span class="keyword">CALL </span>hto_fcn(n,x,fvec,iflag)</div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;<span class="comment">*</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c27c7948dee7924b448527cd0e47aff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c27c7948dee7924b448527cd0e47aff">&#9670;&nbsp;</a></span>hto_qform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hto_solve_nonlin::hto_qform </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(ldq,m), intent(out)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ldq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(m), intent(out)&#160;</td>
          <td class="paramname"><em>wa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CALLING__cpHTO_8f_source.html#l06121">6121</a> of file <a class="el" href="CALLING__cpHTO_8f_source.html">CALLING_cpHTO.f</a>.</p>
<div class="fragment"><div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>     :: m</div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>     :: n</div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>     :: ldq</div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;      real*8, <span class="keywordtype">INTENT(OUT)</span>  :: q(ldq,m)</div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;      real*8, <span class="keywordtype">INTENT(OUT)</span>  :: wa(m)</div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160; </div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;<span class="comment">!   **********</span></div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160; </div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;<span class="comment">!   SUBROUTINE HTO_QFORM</span></div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160; </div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;<span class="comment">!   THIS SUBROUTINE HTO_PROCEEDS FROM THE COMPUTED QR FACTORIZATION OF AN M BY N</span></div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;<span class="comment">!   MATRIX A TO ACCUMULATE THE M BY M ORTHOGONAL MATRIX Q FROM ITS FACTORED FORM.</span></div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160; </div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;<span class="comment">!   THE SUBROUTINE HTO_STATEMENT IS</span></div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160; </div>
<div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;<span class="comment">!     SUBROUTINE HTO_QFORM(M,N,Q,LDQ,WA)</span></div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160; </div>
<div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;<span class="comment">!   WHERE</span></div>
<div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160; </div>
<div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;<span class="comment">!     M IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER</span></div>
<div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;<span class="comment">!       OF ROWS OF A AND THE ORDER OF Q.</span></div>
<div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160; </div>
<div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;<span class="comment">!     N IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER OF COLUMNS OF A.</span></div>
<div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160; </div>
<div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;<span class="comment">!     Q IS AN M BY M ARRAY. ON INPUT THE FULL LOWER TRAPEZOID IN</span></div>
<div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;<span class="comment">!       THE FIRST MIN(M,N) COLUMNS OF Q CONTAINS THE FACTORED FORM.</span></div>
<div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;<span class="comment">!       ON OUTPUT Q HAS BEEN ACCUMULATED INTO A SQUARE MATRIX.</span></div>
<div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160; </div>
<div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;<span class="comment">!     LDQ IS A POSITIVE INTEGER INPUT VARIABLE NOT LESS THAN M</span></div>
<div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;<span class="comment">!       WHICH SPECIFIES THE LEADING DIMENSION OF THE ARRAY Q.</span></div>
<div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160; </div>
<div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;<span class="comment">!     WA IS A WORK ARRAY OF LENGTH M.</span></div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160; </div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;<span class="comment">!   SUBPROGRAMS CALLED</span></div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160; </div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;<span class="comment">!     FORTRAN-SUPPLIED ... MIN</span></div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160; </div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;<span class="comment">!   ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.</span></div>
<div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;<span class="comment">!   BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE</span></div>
<div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160; </div>
<div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;<span class="comment">!   **********</span></div>
<div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;      <span class="keywordtype">INTEGER</span>    :: i,j,jm1,k,l,minmn,np1</div>
<div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;      real*8  :: sum,temp</div>
<div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;      real*8, <span class="keywordtype">PARAMETER</span>  :: <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>= 1.0d0,<a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>= 0.0d0</div>
<div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;      minmn= min(m,n)</div>
<div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;      <span class="keywordflow">IF</span>(minmn &gt;= 2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;       <span class="keywordflow">DO</span> j= 2,minmn</div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;        jm1= j-1</div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;        <span class="keywordflow">DO</span> i= 1,jm1</div>
<div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;         q(i,j)= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a></div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;<span class="keywordflow">       ENDDO</span></div>
<div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;      np1= n+1</div>
<div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;      <span class="keywordflow">IF</span>(m &gt;= np1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;       <span class="keywordflow">DO</span> j= np1,m</div>
<div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;        <span class="keywordflow">DO</span> i= 1,m</div>
<div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;         q(i,j)= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a></div>
<div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;        q(j,j)= <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a></div>
<div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;<span class="keywordflow">       ENDDO</span></div>
<div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;      <span class="keywordflow">DO</span> l= 1,minmn</div>
<div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;       k= minmn-l+1</div>
<div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;       <span class="keywordflow">DO</span> i= k,m</div>
<div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;        wa(i)= q(i,k)</div>
<div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;        q(i,k)= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a></div>
<div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;<span class="keywordflow">       ENDDO</span></div>
<div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;       q(k,k)= <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a></div>
<div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;       <span class="keywordflow">IF</span>(wa(k) /= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;        <span class="keywordflow">DO</span> j= k,m</div>
<div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;         sum= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a></div>
<div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;         <span class="keywordflow">DO</span> i= k,m</div>
<div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;          sum= sum+q(i,j)*wa(i)</div>
<div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;<span class="keywordflow">         ENDDO</span></div>
<div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;         temp= sum/wa(k)</div>
<div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;         <span class="keywordflow">DO</span> i= k,m</div>
<div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;          q(i,j)= q(i,j)-temp*wa(i)</div>
<div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;<span class="keywordflow">         ENDDO</span></div>
<div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;<span class="keywordflow">       ENDIF</span></div>
<div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;<span class="comment">* </span></div>
<div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;<span class="comment">*</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a98884f67245c484b378efff769d60f69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98884f67245c484b378efff769d60f69">&#9670;&nbsp;</a></span>hto_qrfac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hto_solve_nonlin::hto_qrfac </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(lda,n), intent(inout)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>pivot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(lipvt), intent(out)&#160;</td>
          <td class="paramname"><em>ipvt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lipvt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>rdiag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>acnorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>wa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CALLING__cpHTO_8f_source.html#l06214">6214</a> of file <a class="el" href="CALLING__cpHTO_8f_source.html">CALLING_cpHTO.f</a>.</p>
<div class="fragment"><div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: m</div>
<div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: n</div>
<div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: lda</div>
<div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;      real*8, <span class="keywordtype">INTENT(IN OUT)</span>  :: a(lda,n)</div>
<div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;      <span class="keywordtype">LOGICAL</span>, <span class="keywordtype">INTENT(IN)</span>        :: pivot</div>
<div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: lipvt</div>
<div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(OUT)</span>       :: ipvt(lipvt)</div>
<div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;      real*8, <span class="keywordtype">INTENT(OUT)</span>     :: rdiag(n)</div>
<div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;      real*8, <span class="keywordtype">INTENT(OUT)</span>     :: acnorm(n)</div>
<div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;      real*8, <span class="keywordtype">INTENT(OUT)</span>     :: wa(n)</div>
<div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160; </div>
<div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;<span class="comment">!   **********</span></div>
<div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160; </div>
<div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;<span class="comment">!   SUBROUTINE HTO_QRFAC</span></div>
<div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160; </div>
<div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;<span class="comment">!   THIS SUBROUTINE HTO_USES HOUSEHOLDER TRANSFORMATIONS WITH COLUMN PIVOTING</span></div>
<div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;<span class="comment">!   (OPTIONAL) TO COMPUTE A QR FACTORIZATION OF THE M BY N MATRIX A.</span></div>
<div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;<span class="comment">!   THAT IS, QRFAC DETERMINES AN ORTHOGONAL MATRIX Q, A PERMUTATION MATRIX P,</span></div>
<div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;<span class="comment">!   AND AN UPPER TRAPEZOIDAL MATRIX R WITH DIAGONAL ELEMENTS OF NONINCREASING</span></div>
<div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;<span class="comment">!   MAGNITUDE, SUCH THAT A*P= Q*R.  THE HOUSEHOLDER TRANSFORMATION FOR</span></div>
<div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;<span class="comment">!   COLUMN K, K= 1,2,...,MIN(M,N), IS OF THE FORM</span></div>
<div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160; </div>
<div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;<span class="comment">!                         T</span></div>
<div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;<span class="comment">!         I - (1/U(K))*U*U</span></div>
<div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160; </div>
<div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;<span class="comment">!   WHERE U HAS ZEROS IN THE FIRST K-1 POSITIONS.  THE FORM OF THIS</span></div>
<div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;<span class="comment">!   TRANSFORMATION AND THE METHOD OF PIVOTING FIRST APPEARED IN THE</span></div>
<div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;<span class="comment">!   CORRESPONDING LINPACK SUBROUTINE.</span></div>
<div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160; </div>
<div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;<span class="comment">!   THE SUBROUTINE HTO_STATEMENT IS</span></div>
<div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160; </div>
<div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;<span class="comment">!     SUBROUTINE HTO_QRFAC(M,N,A,LDA,PIVOT,IPVT,LIPVT,RDIAG,ACNORM,WA)</span></div>
<div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160; </div>
<div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;<span class="comment">!   WHERE</span></div>
<div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160; </div>
<div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;<span class="comment">!     M IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER OF ROWS OF A.</span></div>
<div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160; </div>
<div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;<span class="comment">!     N IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER</span></div>
<div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;<span class="comment">!       OF COLUMNS OF A.</span></div>
<div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160; </div>
<div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;<span class="comment">!     A IS AN M BY N ARRAY.  ON INPUT A CONTAINS THE MATRIX FOR WHICH THE</span></div>
<div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;<span class="comment">!       QR FACTORIZATION IS TO BE COMPUTED.  ON OUTPUT THE STRICT UPPER</span></div>
<div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;<span class="comment">!       TRAPEZOIDAL PART OF A CONTAINS THE STRICT UPPER TRAPEZOIDAL PART OF R,</span></div>
<div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;<span class="comment">!       AND THE LOWER TRAPEZOIDAL PART OF A CONTAINS A FACTORED FORM OF Q</span></div>
<div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;<span class="comment">!       (THE NON-TRIVIAL ELEMENTS OF THE U VECTORS DESCRIBED ABOVE).</span></div>
<div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160; </div>
<div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;<span class="comment">!     LDA IS A POSITIVE INTEGER INPUT VARIABLE NOT LESS THAN M</span></div>
<div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;<span class="comment">!       WHICH SPECIFIES THE LEADING DIMENSION OF THE ARRAY A.</span></div>
<div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160; </div>
<div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;<span class="comment">!     PIVOT IS A LOGICAL INPUT VARIABLE.  IF PIVOT IS SET TRUE,</span></div>
<div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;<span class="comment">!       THEN COLUMN PIVOTING IS ENFORCED.  IF PIVOT IS SET FALSE,</span></div>
<div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;<span class="comment">!       THEN NO COLUMN PIVOTING IS DONE.</span></div>
<div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160; </div>
<div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;<span class="comment">!     IPVT IS AN INTEGER OUTPUT ARRAY OF LENGTH LIPVT.  IPVT DEFINES THE</span></div>
<div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;<span class="comment">!       PERMUTATION MATRIX P SUCH THAT A*P= Q*R.</span></div>
<div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;<span class="comment">!       COLUMN J OF P IS COLUMN IPVT(J) OF THE IDENTITY MATRIX.</span></div>
<div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;<span class="comment">!       IF PIVOT IS FALSE, IPVT IS NOT REFERENCED.</span></div>
<div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160; </div>
<div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;<span class="comment">!     LIPVT IS A POSITIVE INTEGER INPUT VARIABLE.  IF PIVOT IS FALSE,</span></div>
<div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;<span class="comment">!       THEN LIPVT MAY BE AS SMALL AS 1.  IF PIVOT IS TRUE, THEN</span></div>
<div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;<span class="comment">!       LIPVT MUST BE AT LEAST N.</span></div>
<div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160; </div>
<div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;<span class="comment">!     RDIAG IS AN OUTPUT ARRAY OF LENGTH N WHICH CONTAINS THE</span></div>
<div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;<span class="comment">!       DIAGONAL ELEMENTS OF R.</span></div>
<div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160; </div>
<div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;<span class="comment">!     ACNORM IS AN OUTPUT ARRAY OF LENGTH N WHICH CONTAINS THE NORMS OF</span></div>
<div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;<span class="comment">!       THE CORRESPONDING COLUMNS OF THE INPUT MATRIX A.</span></div>
<div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;<span class="comment">!       IF THIS INFORMATION IS NOT NEEDED, THEN ACNORM CAN COINCIDE WITH RDIAG.</span></div>
<div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160; </div>
<div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;<span class="comment">!     WA IS A WORK ARRAY OF LENGTH N. IF PIVOT IS FALSE, THEN WA</span></div>
<div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;<span class="comment">!       CAN COINCIDE WITH RDIAG.</span></div>
<div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160; </div>
<div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;<span class="comment">!   SUBPROGRAMS CALLED</span></div>
<div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160; </div>
<div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;<span class="comment">!     MINPACK-SUPPLIED ... SPMPAR,ENORM</span></div>
<div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160; </div>
<div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;<span class="comment">!     FORTRAN-SUPPLIED ... MAX,SQRT,MIN</span></div>
<div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160; </div>
<div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;<span class="comment">!   ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.</span></div>
<div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;<span class="comment">!   BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE</span></div>
<div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160; </div>
<div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;<span class="comment">!   **********</span></div>
<div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;      <span class="keywordtype">INTEGER</span>    :: i,j,jp1,k,kmax,minmn</div>
<div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;      real*8  :: ajnorm,epsmch,sum,temp</div>
<div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;      real*8, <span class="keywordtype">PARAMETER</span>  :: <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>= 1.0d0,p05= 0.05d0,<a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>= 0.0d0</div>
<div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;      epsmch= epsilon(1.0d0)</div>
<div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;      <span class="keywordflow">DO</span> j= 1,n</div>
<div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;       acnorm(j)= hto_enorm(m,a(1:,j))</div>
<div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;       rdiag(j)= acnorm(j)</div>
<div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;       wa(j)= rdiag(j)</div>
<div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;       <span class="keywordflow">IF</span>(pivot) ipvt(j)= j</div>
<div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;      minmn= min(m,n)</div>
<div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;      <span class="keywordflow">DO</span> j= 1,minmn</div>
<div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;       <span class="keywordflow">IF</span>(pivot) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;        kmax= j</div>
<div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;        <span class="keywordflow">DO</span> k= j,n</div>
<div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;         <span class="keywordflow">IF</span>(rdiag(k) &gt; rdiag(kmax)) kmax= k</div>
<div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;        <span class="keywordflow">IF</span>(kmax /= j) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;         <span class="keywordflow">DO</span> i= 1,m</div>
<div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;          temp= a(i,j)</div>
<div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;          a(i,j)= a(i,kmax)</div>
<div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;          a(i,kmax)= temp</div>
<div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;<span class="keywordflow">         ENDDO</span></div>
<div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;         rdiag(kmax)= rdiag(j)</div>
<div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;         wa(kmax)= wa(j)</div>
<div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;         k= ipvt(j)</div>
<div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;         ipvt(j)= ipvt(kmax)</div>
<div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;         ipvt(kmax)= k</div>
<div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;<span class="keywordflow">       ENDIF</span></div>
<div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;       ajnorm= hto_enorm(m-j+1,a(j:,j))</div>
<div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;       <span class="keywordflow">IF</span>(ajnorm /= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;        <span class="keywordflow">IF</span>(a(j,j) &lt; <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) ajnorm= -ajnorm</div>
<div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;        <span class="keywordflow">DO</span> i= j,m</div>
<div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;         a(i,j)= a(i,j)/ajnorm</div>
<div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;        a(j,j)= a(j,j)+<a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a></div>
<div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;        jp1= j+1</div>
<div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;        <span class="keywordflow">IF</span>(n &gt;= jp1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;         <span class="keywordflow">DO</span> k= jp1,n</div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;          sum= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a></div>
<div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;          <span class="keywordflow">DO</span> i= j,m</div>
<div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;           sum= sum+a(i,j)*a(i,k)</div>
<div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;<span class="keywordflow">          ENDDO</span></div>
<div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;          temp= sum/a(j,j)</div>
<div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;          <span class="keywordflow">DO</span> i= j,m</div>
<div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;           a(i,k)= a(i,k)-temp*a(i,j)</div>
<div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;<span class="keywordflow">          ENDDO</span></div>
<div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;          <span class="keywordflow">IF</span>(.NOT.(.NOT.pivot.OR.rdiag(k) == <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;           temp= a(j,k)/rdiag(k)</div>
<div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;           rdiag(k)= rdiag(k)*sqrt(max(<a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>,<a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>-temp**2))</div>
<div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;           <span class="keywordflow">IF</span>(p05*(rdiag(k)/wa(k))**2 &lt;= epsmch) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;            rdiag(k)= hto_enorm(m-j,a(jp1:,k))</div>
<div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;            wa(k)= rdiag(k)</div>
<div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;<span class="keywordflow">           ENDIF</span></div>
<div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;<span class="keywordflow">          ENDIF</span></div>
<div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;<span class="keywordflow">         ENDDO</span></div>
<div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;<span class="keywordflow">       ENDIF</span></div>
<div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;       rdiag(j)= -ajnorm</div>
<div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;<span class="comment">*</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a89a4ef64a31dd4d201b9b6bb3c077ab1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89a4ef64a31dd4d201b9b6bb3c077ab1">&#9670;&nbsp;</a></span>hto_r1mpyq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hto_solve_nonlin::hto_r1mpyq </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(lda,n), intent(inout)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CALLING__cpHTO_8f_source.html#l06367">6367</a> of file <a class="el" href="CALLING__cpHTO_8f_source.html">CALLING_cpHTO.f</a>.</p>
<div class="fragment"><div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: m</div>
<div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: n</div>
<div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: lda</div>
<div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;      real*8, <span class="keywordtype">INTENT(IN OUT)</span>  :: a(lda,n)</div>
<div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;      real*8, <span class="keywordtype">INTENT(IN)</span>      :: v(n)</div>
<div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;      real*8, <span class="keywordtype">INTENT(IN)</span>      :: w(n)</div>
<div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160; </div>
<div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;<span class="comment">!   **********</span></div>
<div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160; </div>
<div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;<span class="comment">!   SUBROUTINE HTO_R1MPYQ</span></div>
<div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160; </div>
<div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;<span class="comment">!   GIVEN AN M BY N MATRIX A, THIS SUBROUTINE HTO_COMPUTES A*Q WHERE</span></div>
<div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;<span class="comment">!   Q IS THE PRODUCT OF 2*(N - 1) TRANSFORMATIONS</span></div>
<div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160; </div>
<div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;<span class="comment">!         GV(N-1)*...*GV(1)*GW(1)*...*GW(N-1)</span></div>
<div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160; </div>
<div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;<span class="comment">!   AND GV(I), GW(I) ARE GIVENS ROTATIONS IN THE (I,N) PLANE WHICH</span></div>
<div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;<span class="comment">!   ELIMINATE ELEMENTS IN THE I-TH AND N-TH PLANES, RESPECTIVELY.</span></div>
<div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;<span class="comment">!   Q ITSELF IS NOT GIVEN, RATHER THE INFORMATION TO RECOVER THE</span></div>
<div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;<span class="comment">!   GV, GW ROTATIONS IS SUPPLIED.</span></div>
<div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160; </div>
<div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;<span class="comment">!   THE SUBROUTINE HTO_STATEMENT IS</span></div>
<div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160; </div>
<div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;<span class="comment">!     SUBROUTINE HTO_R1MPYQ(M, N, A, LDA, V, W)</span></div>
<div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160; </div>
<div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;<span class="comment">!   WHERE</span></div>
<div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160; </div>
<div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;<span class="comment">!     M IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER OF ROWS OF A.</span></div>
<div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160; </div>
<div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;<span class="comment">!     N IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER OF COLUMNS OF A.</span></div>
<div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160; </div>
<div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;<span class="comment">!     A IS AN M BY N ARRAY.  ON INPUT A MUST CONTAIN THE MATRIX TO BE</span></div>
<div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;<span class="comment">!       POSTMULTIPLIED BY THE ORTHOGONAL MATRIX Q DESCRIBED ABOVE.</span></div>
<div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;<span class="comment">!       ON OUTPUT A*Q HAS REPLACED A.</span></div>
<div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160; </div>
<div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;<span class="comment">!     LDA IS A POSITIVE INTEGER INPUT VARIABLE NOT LESS THAN M</span></div>
<div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;<span class="comment">!       WHICH SPECIFIES THE LEADING DIMENSION OF THE ARRAY A.</span></div>
<div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160; </div>
<div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;<span class="comment">!     V IS AN INPUT ARRAY OF LENGTH N. V(I) MUST CONTAIN THE INFORMATION</span></div>
<div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;<span class="comment">!       NECESSARY TO RECOVER THE GIVENS ROTATION GV(I) DESCRIBED ABOVE.</span></div>
<div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160; </div>
<div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;<span class="comment">!     W IS AN INPUT ARRAY OF LENGTH N. W(I) MUST CONTAIN THE INFORMATION</span></div>
<div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;<span class="comment">!       NECESSARY TO RECOVER THE GIVENS ROTATION GW(I) DESCRIBED ABOVE.</span></div>
<div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160; </div>
<div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;<span class="comment">!   SUBROUTINES CALLED</span></div>
<div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160; </div>
<div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;<span class="comment">!     FORTRAN-SUPPLIED ... ABS, SQRT</span></div>
<div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160; </div>
<div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;<span class="comment">!   ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.</span></div>
<div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;<span class="comment">!   BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE</span></div>
<div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160; </div>
<div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;<span class="comment">!   **********</span></div>
<div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;      </div>
<div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;      <span class="keywordtype">INTEGER</span>    :: i,j,nmj,nm1</div>
<div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;      real*8  :: cos,sin,temp</div>
<div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;      real*8, <span class="keywordtype">PARAMETER</span>  :: <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>= 1.0d0</div>
<div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;      nm1= n-1</div>
<div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;      <span class="keywordflow">IF</span>(nm1 &gt;= 1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;       <span class="keywordflow">DO</span> nmj= 1,nm1</div>
<div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;        j= n-nmj</div>
<div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;        <span class="keywordflow">IF</span>(abs(v(j)) &gt; <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>) cos= <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>/v(j)</div>
<div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;        <span class="keywordflow">IF</span>(abs(v(j)) &gt; <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>) sin= sqrt(<a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>-cos**2)</div>
<div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;        <span class="keywordflow">IF</span>(abs(v(j)) &lt;= <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>) sin= v(j)</div>
<div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;        <span class="keywordflow">IF</span>(abs(v(j)) &lt;= <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>) cos= sqrt(<a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>-sin**2)</div>
<div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;        <span class="keywordflow">DO</span> i= 1,m</div>
<div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;         temp= cos*a(i,j)-sin*a(i,n)</div>
<div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;         a(i,n)= sin*a(i,j)+cos*a(i,n)</div>
<div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;         a(i,j)= temp</div>
<div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;<span class="keywordflow">       ENDDO</span></div>
<div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;       <span class="keywordflow">DO</span> j= 1,nm1</div>
<div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;        <span class="keywordflow">IF</span>(abs(w(j)) &gt; <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>) cos= <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>/w(j)</div>
<div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;        <span class="keywordflow">IF</span>(abs(w(j)) &gt; <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>) sin= sqrt(<a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>-cos**2)</div>
<div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;        <span class="keywordflow">IF</span>(abs(w(j)) &lt;= <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>) sin= w(j)</div>
<div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;        <span class="keywordflow">IF</span>(abs(w(j)) &lt;= <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>) cos= sqrt(<a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>-sin**2)</div>
<div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;        <span class="keywordflow">DO</span> i= 1,m</div>
<div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;         temp= cos*a(i,j)+sin*a(i,n)</div>
<div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;         a(i,n)= -sin*a(i,j)+cos*a(i,n)</div>
<div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;         a(i,j)= temp</div>
<div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;<span class="keywordflow">       ENDDO</span></div>
<div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;<span class="comment">*</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="af73d8384fe07fde7b063afc452466f03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af73d8384fe07fde7b063afc452466f03">&#9670;&nbsp;</a></span>hto_r1updt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hto_solve_nonlin::hto_r1updt </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(ls), intent(inout)&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(m), intent(in)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(m), intent(out)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(out)&#160;</td>
          <td class="paramname"><em>sing</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CALLING__cpHTO_8f_source.html#l06459">6459</a> of file <a class="el" href="CALLING__cpHTO_8f_source.html">CALLING_cpHTO.f</a>.</p>
<div class="fragment"><div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: m</div>
<div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: n</div>
<div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;      <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>        :: ls</div>
<div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;      real*8, <span class="keywordtype">INTENT(IN OUT)</span>  :: s(ls)</div>
<div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;      real*8, <span class="keywordtype">INTENT(IN)</span>      :: u(m)</div>
<div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;      real*8, <span class="keywordtype">INTENT(IN OUT)</span>  :: v(n)</div>
<div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;      real*8, <span class="keywordtype">INTENT(OUT)</span>     :: w(m)</div>
<div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;      <span class="keywordtype">LOGICAL</span>, <span class="keywordtype">INTENT(OUT)</span>       :: sing</div>
<div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160; </div>
<div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;<span class="comment">!   **********</span></div>
<div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160; </div>
<div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;<span class="comment">!   SUBROUTINE HTO_R1UPDT</span></div>
<div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160; </div>
<div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;<span class="comment">!   GIVEN AN M BY N LOWER TRAPEZOIDAL MATRIX S, AN M-VECTOR U,</span></div>
<div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;<span class="comment">!   AND AN N-VECTOR V, THE PROBLEM IS TO DETERMINE AN</span></div>
<div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;<span class="comment">!   ORTHOGONAL MATRIX Q SUCH THAT</span></div>
<div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160; </div>
<div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;<span class="comment">!                 T</span></div>
<div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;<span class="comment">!         (S + U*V )*Q</span></div>
<div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160; </div>
<div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;<span class="comment">!   IS AGAIN LOWER TRAPEZOIDAL.</span></div>
<div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160; </div>
<div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;<span class="comment">!   THIS SUBROUTINE HTO_DETERMINES Q AS THE PRODUCT OF 2*(N - 1) TRANSFORMATIONS</span></div>
<div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160; </div>
<div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;<span class="comment">!         GV(N-1)*...*GV(1)*GW(1)*...*GW(N-1)</span></div>
<div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160; </div>
<div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;<span class="comment">!   WHERE GV(I), GW(I) ARE GIVENS ROTATIONS IN THE (I,N) PLANE</span></div>
<div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;<span class="comment">!   WHICH ELIMINATE ELEMENTS IN THE I-TH AND N-TH PLANES, RESPECTIVELY.</span></div>
<div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;<span class="comment">!   Q ITSELF IS NOT ACCUMULATED, RATHER THE INFORMATION TO RECOVER THE GV,</span></div>
<div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;<span class="comment">!   GW ROTATIONS IS RETURNED.</span></div>
<div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160; </div>
<div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;<span class="comment">!   THE SUBROUTINE HTO_STATEMENT IS</span></div>
<div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160; </div>
<div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;<span class="comment">!     SUBROUTINE HTO_R1UPDT(M,N,S,LS,U,V,W,SING)</span></div>
<div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160; </div>
<div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;<span class="comment">!   WHERE</span></div>
<div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160; </div>
<div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;<span class="comment">!     M IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER OF ROWS OF S.</span></div>
<div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160; </div>
<div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;<span class="comment">!     N IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER</span></div>
<div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;<span class="comment">!       OF COLUMNS OF S.  N MUST NOT EXCEED M.</span></div>
<div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160; </div>
<div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;<span class="comment">!     S IS AN ARRAY OF LENGTH LS. ON INPUT S MUST CONTAIN THE LOWER</span></div>
<div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;<span class="comment">!       TRAPEZOIDAL MATRIX S STORED BY COLUMNS. ON OUTPUT S CONTAINS</span></div>
<div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;<span class="comment">!       THE LOWER TRAPEZOIDAL MATRIX PRODUCED AS DESCRIBED ABOVE.</span></div>
<div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160; </div>
<div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;<span class="comment">!     LS IS A POSITIVE INTEGER INPUT VARIABLE NOT LESS THAN</span></div>
<div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;<span class="comment">!       (N*(2*M-N+1))/2.</span></div>
<div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160; </div>
<div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;<span class="comment">!     U IS AN INPUT ARRAY OF LENGTH M WHICH MUST CONTAIN THE VECTOR U.</span></div>
<div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160; </div>
<div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;<span class="comment">!     V IS AN ARRAY OF LENGTH N. ON INPUT V MUST CONTAIN THE VECTOR V.</span></div>
<div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;<span class="comment">!       ON OUTPUT V(I) CONTAINS THE INFORMATION NECESSARY TO</span></div>
<div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;<span class="comment">!       RECOVER THE GIVENS ROTATION GV(I) DESCRIBED ABOVE.</span></div>
<div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160; </div>
<div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;<span class="comment">!     W IS AN OUTPUT ARRAY OF LENGTH M. W(I) CONTAINS INFORMATION</span></div>
<div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;<span class="comment">!       NECESSARY TO RECOVER THE GIVENS ROTATION GW(I) DESCRIBED ABOVE.</span></div>
<div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160; </div>
<div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;<span class="comment">!     SING IS A LOGICAL OUTPUT VARIABLE.  SING IS SET TRUE IF ANY OF THE</span></div>
<div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;<span class="comment">!       DIAGONAL ELEMENTS OF THE OUTPUT S ARE ZERO.  OTHERWISE SING IS</span></div>
<div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;<span class="comment">!       SET FALSE.</span></div>
<div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160; </div>
<div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;<span class="comment">!   SUBPROGRAMS CALLED</span></div>
<div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160; </div>
<div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;<span class="comment">!     MINPACK-SUPPLIED ... SPMPAR</span></div>
<div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160; </div>
<div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;<span class="comment">!     FORTRAN-SUPPLIED ... ABS,SQRT</span></div>
<div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160; </div>
<div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;<span class="comment">!   ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.</span></div>
<div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;<span class="comment">!   BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE, JOHN L. NAZARETH</span></div>
<div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160; </div>
<div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;<span class="comment">!   **********</span></div>
<div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160; </div>
<div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;      <span class="keywordtype">INTEGER</span>    :: i,j,jj,l,nmj,nm1</div>
<div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;      real*8  :: cos,cotan,giant,sin,tan,tau,temp</div>
<div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;      real*8, <span class="keywordtype">PARAMETER</span>  :: <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>= 1.0d0,p5= 0.5d0,p25= 0.25d0,<a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>= 0.0d0</div>
<div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;      giant= huge(1.0d0)</div>
<div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;      jj= (n*(2*m-n+1))/2-(m-n)</div>
<div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;      l= jj</div>
<div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;      <span class="keywordflow">DO</span> i= n,m</div>
<div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;       w(i)= s(l)</div>
<div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;       l= l+1</div>
<div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;      nm1= n-1</div>
<div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;      <span class="keywordflow">IF</span>(nm1 &gt;= 1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;       <span class="keywordflow">DO</span> nmj= 1,nm1</div>
<div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;        j= n-nmj</div>
<div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;        jj= jj-(m-j+1)</div>
<div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;        w(j)= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a></div>
<div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;        <span class="keywordflow">IF</span>(v(j) /= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;         <span class="keywordflow">IF</span>(abs(v(n)) &lt; abs(v(j))) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;          cotan= v(n)/v(j)</div>
<div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;          sin= p5/sqrt(p25+p25*cotan**2)</div>
<div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;          cos= sin*cotan</div>
<div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;          tau= <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a></div>
<div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;          <span class="keywordflow">IF</span>(abs(cos)*giant &gt; <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>) tau= <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>/cos</div>
<div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;          tan= v(j)/v(n)</div>
<div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;          cos= p5/sqrt(p25+p25*tan**2)</div>
<div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;          sin= cos*tan</div>
<div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;          tau= sin</div>
<div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;<span class="keywordflow">         ENDIF</span></div>
<div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;         v(n)= sin*v(j)+cos*v(n)</div>
<div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;         v(j)= tau</div>
<div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;         l= jj</div>
<div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;         <span class="keywordflow">DO</span> i= j,m</div>
<div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;          temp= cos*s(l)-sin*w(i)</div>
<div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;          w(i)= sin*s(l)+cos*w(i)</div>
<div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;          s(l)= temp</div>
<div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;          l= l+1</div>
<div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;<span class="keywordflow">         ENDDO</span></div>
<div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;<span class="keywordflow">       ENDDO</span></div>
<div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;      <span class="keywordflow">DO</span> i= 1,m</div>
<div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;       w(i)= w(i)+v(n)*u(i)</div>
<div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;      sing= .false.</div>
<div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;      <span class="keywordflow">IF</span>(nm1 &gt;= 1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;       <span class="keywordflow">DO</span> j= 1,nm1</div>
<div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;        <span class="keywordflow">IF</span>(w(j) /= <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;         <span class="keywordflow">IF</span>(abs(s(jj)) &lt; abs(w(j))) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;          cotan= s(jj)/w(j)</div>
<div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;          sin= p5/sqrt(p25+p25*cotan**2)</div>
<div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;          cos= sin*cotan</div>
<div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;          tau= <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a></div>
<div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;          <span class="keywordflow">IF</span>(abs(cos)*giant &gt; <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>) tau= <a class="code" href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">one</a>/cos</div>
<div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;          tan= w(j)/s(jj)</div>
<div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;          cos= p5/sqrt(p25+p25*tan**2)</div>
<div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;          sin= cos*tan</div>
<div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;          tau= sin</div>
<div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;<span class="keywordflow">         ENDIF</span></div>
<div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;         l= jj</div>
<div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;         <span class="keywordflow">DO</span> i= j,m</div>
<div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;          temp= cos*s(l)+sin*w(i)</div>
<div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;          w(i)= -sin*s(l)+cos*w(i)</div>
<div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;          s(l)= temp</div>
<div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;          l= l+1</div>
<div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;<span class="keywordflow">         ENDDO</span></div>
<div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;         w(j)= tau</div>
<div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;        <span class="keywordflow">IF</span>(s(jj) == <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) sing= .true.</div>
<div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;        jj= jj+(m-j+1)</div>
<div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;<span class="keywordflow">       ENDDO</span></div>
<div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;      l= jj</div>
<div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;      <span class="keywordflow">DO</span> i= n,m</div>
<div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;       s(l)= w(i)</div>
<div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;       l= l+1</div>
<div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;      <span class="keywordflow">IF</span>(s(jj) == <a class="code" href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">zero</a>) sing= .true.</div>
<div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;<span class="comment">*</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacehto__units_html_adb7ab93d326f14720c354f68b0f7ee6c"><div class="ttname"><a href="namespacehto__units.html#adb7ab93d326f14720c354f68b0f7ee6c">hto_units::one</a></div><div class="ttdeci">real *8, parameter one</div><div class="ttdef"><b>Definition:</b> <a href="CALLING__cpHTO_8f_source.html#l00184">CALLING_cpHTO.f:184</a></div></div>
<div class="ttc" id="anamespacehto__units_html_abab92a867fb77543c0c4ff069d1783d4"><div class="ttname"><a href="namespacehto__units.html#abab92a867fb77543c0c4ff069d1783d4">hto_units::eps</a></div><div class="ttdeci">real *8, parameter eps</div><div class="ttdef"><b>Definition:</b> <a href="CALLING__cpHTO_8f_source.html#l00183">CALLING_cpHTO.f:183</a></div></div>
<div class="ttc" id="anamespacehto__units_html_a99185641f2fef22fbd699ff69ee64f18"><div class="ttname"><a href="namespacehto__units.html#a99185641f2fef22fbd699ff69ee64f18">hto_units::zero</a></div><div class="ttdeci">real *8, parameter zero</div><div class="ttdef"><b>Definition:</b> <a href="CALLING__cpHTO_8f_source.html#l00185">CALLING_cpHTO.f:185</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacehto__solve__nonlin.html">hto_solve_nonlin</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
