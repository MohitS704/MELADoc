\hypertarget{mod__Misc_8F90}{}\doxysection{M\+E\+L\+A/fortran/mod\+\_\+\+Misc.F90 File Reference}
\label{mod__Misc_8F90}\index{MELA/fortran/mod\_Misc.F90@{MELA/fortran/mod\_Misc.F90}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfacemodmisc_1_1swap}{modmisc\+::swap}}
\item 
interface \mbox{\hyperlink{interfacemodmisc_1_1operator_07_8dot_8_08}{modmisc\+::operator(.\+dot.)}}
\item 
interface \mbox{\hyperlink{interfacemodmisc_1_1operator_07_8cross_8_08}{modmisc\+::operator(.\+cross.)}}
\item 
interface \mbox{\hyperlink{interfacemodmisc_1_1bublesort}{modmisc\+::bublesort}}
\item 
interface \mbox{\hyperlink{interfacemodmisc_1_1reorder}{modmisc\+::reorder}}
\end{DoxyCompactItemize}
\doxysubsection*{Modules}
\begin{DoxyCompactItemize}
\item 
module \mbox{\hyperlink{namespacemodmisc}{modmisc}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{mod__Misc_8F90_aa68ba1b5d3c1ca012f1b06f473f57786}{Make\+Buble\+Sort}}(typex,  typey,  name)
\item 
\#define \mbox{\hyperlink{mod__Misc_8F90_aaadc2ef947e88bca309ea11630f645ac}{Make\+Re\+Order}}(typey,  typex,  name)
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
real(8) function, dimension(1\+:3) \mbox{\hyperlink{namespacemodmisc_a5c1ae793e3808197355304880195cd7d}{modmisc\+::vectorcross}} (p1, p2)
\item 
real(8) function \mbox{\hyperlink{namespacemodmisc_a40302e047edf719cd8549dc9527e0bbe}{modmisc\+::minkowskyproduct}} (p1, p2)
\item 
complex(8) function \mbox{\hyperlink{namespacemodmisc_a7c41f3834703063f40e1c40c240b0e06}{modmisc\+::minkowskyproductc}} (p1, p2)
\item 
complex(8) function \mbox{\hyperlink{namespacemodmisc_aacfa89cffdffb9e858f85de293d51107}{modmisc\+::minkowskyproductrc}} (p1, p2)
\item 
complex(8) function \mbox{\hyperlink{namespacemodmisc_a29f390c69567f0956fe5d248815b2718}{modmisc\+::minkowskyproductcr}} (p1, p2)
\item 
integer function \mbox{\hyperlink{namespacemodmisc_adeda8e85f44e7c660f23fdf3f1889adf}{modmisc\+::logicaltointeger}} (var)
\item 
double complex function \mbox{\hyperlink{namespacemodmisc_a0795d8fbf3d1017126319148c42c8181}{modmisc\+::et1}} (e1, e2, e3, e4)
\item 
double complex function \mbox{\hyperlink{namespacemodmisc_ad7a51fc80e98c8745facacd7104065d5}{modmisc\+::sc}} (q1, q2)
\item 
double precision function \mbox{\hyperlink{namespacemodmisc_a3f09f85d546e0284b955a11b37ef1310}{modmisc\+::scr}} (p1, p2)
\item 
double complex function \mbox{\hyperlink{namespacemodmisc_a656b78f23188708e38caa4b28bb1e5fb}{modmisc\+::scrc}} (p1, p2)
\item 
real(8) function \mbox{\hyperlink{namespacemodmisc_a16087c52e2af5fad4da5ed6a8698380a}{modmisc\+::get\+\_\+pt}} (Mom)
\item 
real(8) function \mbox{\hyperlink{namespacemodmisc_aec9407c3be9e130960571ced057362b3}{modmisc\+::get\+\_\+pt2}} (Mom)
\item 
real(8) function \mbox{\hyperlink{namespacemodmisc_adbd3954c2d1c01ab42fcb7689f74bc88}{modmisc\+::get\+\_\+minv}} (Mom)
\item 
real(8) function \mbox{\hyperlink{namespacemodmisc_a8f5484a847bac9816a81f6b58fbd5a9e}{modmisc\+::get\+\_\+minv2}} (Mom)
\item 
real(8) function \mbox{\hyperlink{namespacemodmisc_a05526cf686aa06459c1cd8d9cb994c14}{modmisc\+::get\+\_\+eta}} (Mom)
\item 
real(8) function \mbox{\hyperlink{namespacemodmisc_a6749378af481a8e3721cebb7eca09cce}{modmisc\+::get\+\_\+phi}} (Mom)
\item 
real(8) function \mbox{\hyperlink{namespacemodmisc_a2deaec996b883fffd3d9b19523d51fdf}{modmisc\+::get\+\_\+cosalpha}} (Mom1, Mom2)
\item 
real(8) function \mbox{\hyperlink{namespacemodmisc_a48b5ae16f30c3494deb4d3fc8af305e5}{modmisc\+::get\+\_\+costheta}} (Mom)
\item 
real(8) function \mbox{\hyperlink{namespacemodmisc_aa2b700cf276ef4d3e4a0fc6f57fd2e27}{modmisc\+::get\+\_\+r}} (Mom1, Mom2)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a1ac47dc64761009dcc50e57fbbbcf519}{modmisc\+::pt\+\_\+order}} (N, Mom)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a1893505dd44d7785fdbb0205589eae75}{modmisc\+::bublesort\+\_\+integerinteger}} (N, X, IY)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_aa2d41111fc8b601b37937e045aee92d6}{modmisc\+::bublesort\+\_\+realinteger}} (N, X, IY)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a0201268c995ef0873f96df05efb4585e}{modmisc\+::bublesort\+\_\+stringlogical}} (N, X, IY)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_ae0d368ad0f278c05b7c98bce5c121aaa}{modmisc\+::bublesort\+\_\+stringinteger}} (N, X, IY)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a5f0698dac2feea5e0305d2e252276602}{modmisc\+::bublesort\+\_\+stringreal8}} (N, X, IY)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a1f86966e068da2cadacb4c6bf0d4f488}{modmisc\+::bublesort\+\_\+stringcomplex8}} (N, X, IY)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a7332ad8fe3566afa8bbb3b0a047bc57d}{modmisc\+::bublesort\+\_\+stringstring}} (N, X, IY)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a99d754212c75d62fd943a63bdfed4ae8}{modmisc\+::reorder\+\_\+integerinteger}} (N, iy, x)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a10c281ae800a3db9140c70680c2be641}{modmisc\+::reorder\+\_\+integerreal}} (N, iy, x)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_aace7c4a048eb3cded1072e6e257a1fd9}{modmisc\+::printmom}} (Mom)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a67da31b838636e613886adf687dd9040}{modmisc\+::error}} (Message, Err\+Num)
\item 
logical function \mbox{\hyperlink{namespacemodmisc_aec88f7154cdc627bd8c823597a684073}{modmisc\+::isnan}} (x)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a5e82d0b873a2134ae12c18569547f5d6}{modmisc\+::swapi}} (i, j)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a7262c4ef2e4832436c895d154dbe3080}{modmisc\+::swapr}} (i, j)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a316c5e80a9dff0f6cb32b42052f3bd49}{modmisc\+::swapc}} (i, j)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a66e6a665132a82ba20fc014b11c7fc6a}{modmisc\+::swap\+\_\+mom}} (Mom1, Mom2)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a8dec65192dc31f19d4c3c44d5105a901}{modmisc\+::swap\+\_\+cmom}} (Mom1, Mom2)
\item 
complex(8) function \mbox{\hyperlink{namespacemodmisc_a14b27552033291b7da4d75268ac50615}{modmisc\+::leviciv}} (e1, e2, e3, e4)
\item 
complex(8) function, dimension(1\+:4) \mbox{\hyperlink{namespacemodmisc_a6513c51ea08f81a34b2458f33e0b5052}{modmisc\+::pol\+\_\+gluon\+\_\+incoming}} (p, hel)
\item 
complex(8) function, dimension(4) \mbox{\hyperlink{namespacemodmisc_a46a3ced2544bfb257c9f3f35f340e98c}{modmisc\+::pol\+\_\+zff\+\_\+outgoing}} (pf, pfbar, hel)
\item 
complex(8) function, dimension(1\+:4) \mbox{\hyperlink{namespacemodmisc_a1afc2e6e1e690b780362c1ed54eba41e}{modmisc\+::ubar\+\_\+spinor}} (p, hel)
\item 
complex(8) function, dimension(1\+:4) \mbox{\hyperlink{namespacemodmisc_a1fa24751336ef1074ba19731c5a158f4}{modmisc\+::v\+\_\+spinor}} (p, hel)
\item 
double complex function, dimension(1\+:4) \mbox{\hyperlink{namespacemodmisc_a7ca64b7e83364c5cd4703612d946e292}{modmisc\+::chir\+\_\+weyl}} (sign, sp)
\item 
complex(8) function, dimension(dv) \mbox{\hyperlink{namespacemodmisc_a8cc0ea8d114091af9a19cfe25131ac86}{modmisc\+::vbqq\+\_\+weyl}} (sp1, sp2)
\item 
complex(8) function, dimension(4) \mbox{\hyperlink{namespacemodmisc_adae9194ef960165bb25545daa834dad4}{modmisc\+::spb2\+\_\+weyl}} (sp, v)
\item 
complex(8) function, dimension(4) \mbox{\hyperlink{namespacemodmisc_a62ab057832b4bcaa7ec79890c68b607c}{modmisc\+::spi2\+\_\+weyl}} (v, sp)
\item 
character(len=150) function \mbox{\hyperlink{namespacemodmisc_a7f62f096a28a7e46a6df7f9f2bc5ba44}{modmisc\+::findinputfmt0}} (Event\+Info\+Line)
\item 
character(len=150) function \mbox{\hyperlink{namespacemodmisc_a187adba58a588e038e8b717a54304b82}{modmisc\+::findinputfmt1}} (Particle\+Line)
\item 
character(len=150) function \mbox{\hyperlink{namespacemodmisc_a77efda25ce167292fc0a5e0196dbd479}{modmisc\+::capitalize}} (Input\+String)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_acb57f3f42fbae92a730a0291d79c47f7}{modmisc\+::houseofrepresentatives}} (X\+Sec\+Array, Number\+Of\+Seats, Total\+Number\+Of\+Seats)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a06b31627b7caea5513cb4edd231310e6}{modmisc\+::houseofrepresentatives2}} (X\+Sec\+Array, Number\+Of\+Seats, Total\+Number\+Of\+Seats)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a88674022f66b662981b6e56ecb86d945}{modmisc\+::convert\+\_\+to\+\_\+mcfm}} (p, pout)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a8dbc3ab8816ff1d9a811605cacdb2bc6}{modmisc\+::evaluatespline}} (Eval\+Point, Spline\+Data, Spline\+Data\+Length, The\+Result)
\item 
subroutine \mbox{\hyperlink{mod__Misc_8F90_ab8ad91b5de8a1d788156339b933a3037}{hto\+\_\+fmmsplinesingleht}} (b, c, d, top, gdim, xc, yc)
\item 
subroutine \mbox{\hyperlink{mod__Misc_8F90_aa91afe68b1537c093c096cdd8f158fed}{hto\+\_\+seval3singleht}} (u, b, c, d, top, gdim, f, fp, fpp, fppp, xc, yc)
\item 
character(len=totallength) function \mbox{\hyperlink{namespacemodmisc_a5d09bd430284bf287a4aa6308766a6db}{modmisc\+::centerwithstars}} (string, totallength, align, padleft, padright)
\item 
subroutine \mbox{\hyperlink{namespacemodmisc_a61bad9ca8f9cc15902f5a24598fbcc19}{modmisc\+::printlogo}} (The\+Unit, title)
\item 
real function \mbox{\hyperlink{namespacemodmisc_abc2510f822a295ad2fac165fe41a8a96}{modmisc\+::infinity}} ()
\item 
logical function \mbox{\hyperlink{namespacemodmisc_a6ac5e4d5117566541606747e97c289d7}{modmisc\+::calculatesxsec}} (Process)
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{mod__Misc_8F90_aa68ba1b5d3c1ca012f1b06f473f57786}\label{mod__Misc_8F90_aa68ba1b5d3c1ca012f1b06f473f57786}} 
\index{mod\_Misc.F90@{mod\_Misc.F90}!MakeBubleSort@{MakeBubleSort}}
\index{MakeBubleSort@{MakeBubleSort}!mod\_Misc.F90@{mod\_Misc.F90}}
\doxysubsubsection{\texorpdfstring{MakeBubleSort}{MakeBubleSort}}
{\footnotesize\ttfamily \#define Make\+Buble\+Sort(\begin{DoxyParamCaption}\item[{}]{typex,  }\item[{}]{typey,  }\item[{}]{name }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{keyword}{SUBROUTINE }name(N,X, IY)                 ;\(\backslash\)}
\DoxyCodeLine{2 \textcolor{keywordtype}{IMPLICIT NONE}                            ;\(\backslash\)}
\DoxyCodeLine{3 \textcolor{keywordtype}{integer} n                                ;\(\backslash\)}
\DoxyCodeLine{4 typex :: x(1:n)                          ;\(\backslash\)}
\DoxyCodeLine{5 typey :: iy(1:n)                         ;\(\backslash\)}
\DoxyCodeLine{6 typex :: temp                            ;\(\backslash\)}
\DoxyCodeLine{7 \textcolor{keywordtype}{integer} :: i, j, jmax                    ;\(\backslash\)}
\DoxyCodeLine{8 typey :: itemp                           ;\(\backslash\)}
\DoxyCodeLine{9 \textcolor{keywordtype}{logical} :: keepgoing                     ;\(\backslash\)}
\DoxyCodeLine{10                                          ;\(\backslash\)}
\DoxyCodeLine{11       keepgoing = .true.                 ;\(\backslash\)}
\DoxyCodeLine{12       jmax=n-\/1                           ;\(\backslash\)}
\DoxyCodeLine{13       \textcolor{keywordflow}{do} i=1,n-\/1                         ;\(\backslash\)}
\DoxyCodeLine{14          keepgoing = .false.             ;\(\backslash\)}
\DoxyCodeLine{15          \textcolor{keywordflow}{do} j=1,jmax                     ;\(\backslash\)}
\DoxyCodeLine{16             \textcolor{keywordflow}{if}(x(j).gt.x(j+1)) cycle     ;\(\backslash\)}
\DoxyCodeLine{17               keepgoing = .true.         ;\(\backslash\)}
\DoxyCodeLine{18               temp=x(j)                  ;\(\backslash\)}
\DoxyCodeLine{19               x(j)=x(j+1)                ;\(\backslash\)}
\DoxyCodeLine{20               x(j+1)=temp                ;\(\backslash\)}
\DoxyCodeLine{21               itemp=iy(j)                ;\(\backslash\)}
\DoxyCodeLine{22               iy(j)=iy(j+1)              ;\(\backslash\)}
\DoxyCodeLine{23               iy(j+1)=itemp              ;\(\backslash\)}
\DoxyCodeLine{24 \textcolor{keywordflow}{         enddo}                           ;\(\backslash\)}
\DoxyCodeLine{25          \textcolor{keywordflow}{if}(.not.keepgoing) \textcolor{keywordflow}{return}       ;\(\backslash\)}
\DoxyCodeLine{26          jmax=jmax-\/1                     ;\(\backslash\)}
\DoxyCodeLine{27 \textcolor{keywordflow}{       enddo}                             ;\(\backslash\)}
\DoxyCodeLine{28                                          ;\(\backslash\)}
\DoxyCodeLine{29 \textcolor{keywordflow}{RETURN}                                   ;\(\backslash\)}
\DoxyCodeLine{30 \textcolor{keyword}{END SUBROUTINE}}

\end{DoxyCode}
\mbox{\Hypertarget{mod__Misc_8F90_aaadc2ef947e88bca309ea11630f645ac}\label{mod__Misc_8F90_aaadc2ef947e88bca309ea11630f645ac}} 
\index{mod\_Misc.F90@{mod\_Misc.F90}!MakeReOrder@{MakeReOrder}}
\index{MakeReOrder@{MakeReOrder}!mod\_Misc.F90@{mod\_Misc.F90}}
\doxysubsubsection{\texorpdfstring{MakeReOrder}{MakeReOrder}}
{\footnotesize\ttfamily \#define Make\+Re\+Order(\begin{DoxyParamCaption}\item[{}]{typey,  }\item[{}]{typex,  }\item[{}]{name }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{keyword}{SUBROUTINE }name(N, iy,x)                    ;\(\backslash\)}
\DoxyCodeLine{2 \textcolor{keywordtype}{integer} :: n,i                              ;\(\backslash\)}
\DoxyCodeLine{3 typex :: x(1:n)                             ;\(\backslash\)}
\DoxyCodeLine{4 typey :: iy(1:n)                            ;\(\backslash\)}
\DoxyCodeLine{5 typex :: temp(1:n)                          ;\(\backslash\)}
\DoxyCodeLine{6                                             ;\(\backslash\)}
\DoxyCodeLine{7      \textcolor{keywordflow}{do} i=1,n                               ;\(\backslash\)}
\DoxyCodeLine{8          temp(i) = x( iy(i) )               ;\(\backslash\)}
\DoxyCodeLine{9 \textcolor{keywordflow}{     enddo}                                  ;\(\backslash\)}
\DoxyCodeLine{10      x(1:n) = temp(1:n)                     ;\(\backslash\)}
\DoxyCodeLine{11                                             ;\(\backslash\)}
\DoxyCodeLine{12 \textcolor{keywordflow}{RETURN}                                      ;\(\backslash\)}
\DoxyCodeLine{13 \textcolor{keyword}{END SUBROUTINE                              };\(\backslash\)}

\end{DoxyCode}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{mod__Misc_8F90_ab8ad91b5de8a1d788156339b933a3037}\label{mod__Misc_8F90_ab8ad91b5de8a1d788156339b933a3037}} 
\index{mod\_Misc.F90@{mod\_Misc.F90}!hto\_fmmsplinesingleht@{hto\_fmmsplinesingleht}}
\index{hto\_fmmsplinesingleht@{hto\_fmmsplinesingleht}!mod\_Misc.F90@{mod\_Misc.F90}}
\doxysubsubsection{\texorpdfstring{hto\_fmmsplinesingleht()}{hto\_fmmsplinesingleht()}}
{\footnotesize\ttfamily subroutine evaluatespline\+::hto\+\_\+fmmsplinesingleht (\begin{DoxyParamCaption}\item[{real(8), dimension(gdim)}]{b,  }\item[{real(8), dimension(gdim)}]{c,  }\item[{real(8), dimension(gdim)}]{d,  }\item[{integer}]{top,  }\item[{integer}]{gdim,  }\item[{real(8), dimension(gdim)}]{xc,  }\item[{real(8), dimension(gdim)}]{yc }\end{DoxyParamCaption})}



Definition at line 1341 of file mod\+\_\+\+Misc.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1341 }
\DoxyCodeLine{1342 \textcolor{comment}{!-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1343 }
\DoxyCodeLine{1344 \textcolor{keywordtype}{INTEGER} k,n,i,top,gdim,l}
\DoxyCodeLine{1345 }
\DoxyCodeLine{1346 \textcolor{keywordtype}{REAL}(8), \textcolor{keywordtype}{dimension(gdim)} :: xc,yc}
\DoxyCodeLine{1347 \textcolor{keywordtype}{REAL}(8), \textcolor{keywordtype}{dimension(gdim)} :: x,y}
\DoxyCodeLine{1348 }
\DoxyCodeLine{1349 \textcolor{keywordtype}{REAL}(8), \textcolor{keywordtype}{DIMENSION(gdim)} :: b}
\DoxyCodeLine{1350 \textcolor{comment}{! linear coeff}}
\DoxyCodeLine{1351 }
\DoxyCodeLine{1352 \textcolor{keywordtype}{REAL}(8), \textcolor{keywordtype}{DIMENSION(gdim)} :: c}
\DoxyCodeLine{1353 \textcolor{comment}{! quadratic coeff.}}
\DoxyCodeLine{1354 }
\DoxyCodeLine{1355 \textcolor{keywordtype}{REAL}(8), \textcolor{keywordtype}{DIMENSION(gdim)} :: d}
\DoxyCodeLine{1356 \textcolor{comment}{! cubic coeff.}}
\DoxyCodeLine{1357 }
\DoxyCodeLine{1358 \textcolor{keywordtype}{REAL}(8) :: t}
\DoxyCodeLine{1359 \textcolor{keywordtype}{REAL}(8),\textcolor{keywordtype}{PARAMETER}:: ZERO=0.0, two=2.0, three=3.0}
\DoxyCodeLine{1360 }
\DoxyCodeLine{1361 \textcolor{comment}{! The grid}}
\DoxyCodeLine{1362 }
\DoxyCodeLine{1363 }
\DoxyCodeLine{1364 n= gdim}
\DoxyCodeLine{1365 \textcolor{keywordflow}{FORALL}(l=1:gdim)}
\DoxyCodeLine{1366 x(l)= xc(l)}
\DoxyCodeLine{1367 y(l)= yc(l)}
\DoxyCodeLine{1368 \textcolor{keywordflow}{ENDFORALL}}
\DoxyCodeLine{1369 }
\DoxyCodeLine{1370 \textcolor{comment}{!.....Set up tridiagonal system.........................................}}
\DoxyCodeLine{1371 \textcolor{comment}{!     b=diagonal, d=offdiagonal, c=right-\/hand side}}
\DoxyCodeLine{1372 }
\DoxyCodeLine{1373 d(1)= x(2)-\/x(1)}
\DoxyCodeLine{1374 c(2)= (y(2)-\/y(1))/d(1)}
\DoxyCodeLine{1375 \textcolor{keywordflow}{DO} k= 2,n-\/1}
\DoxyCodeLine{1376 d(k)= x(k+1)-\/x(k)}
\DoxyCodeLine{1377 b(k)= two*(d(k-\/1)+d(k))}
\DoxyCodeLine{1378 c(k+1)= (y(k+1)-\/y(k))/d(k)}
\DoxyCodeLine{1379 c(k)= c(k+1)-\/c(k)}
\DoxyCodeLine{1380 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{1381 }
\DoxyCodeLine{1382 \textcolor{comment}{!.....End conditions.  third derivatives at x(1) and x(n) obtained}}
\DoxyCodeLine{1383 \textcolor{comment}{!     from divided differences.......................................}}
\DoxyCodeLine{1384 }
\DoxyCodeLine{1385 b(1)= -\/d(1)}
\DoxyCodeLine{1386 b(n)= -\/d(n-\/1)}
\DoxyCodeLine{1387 c(1)= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}}
\DoxyCodeLine{1388 c(n)= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}}
\DoxyCodeLine{1389 \textcolor{keywordflow}{IF} (n > 3) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{1390 c(1)= c(3)/(x(4)-\/x(2))-\/c(2)/(x(3)-\/x(1))}
\DoxyCodeLine{1391 c(n)= c(n-\/1)/(x(n)-\/x(n-\/2))-\/c(n-\/2)/(x(n-\/1)-\/x(n-\/3))}
\DoxyCodeLine{1392 c(1)= c(1)*d(1)*d(1)/(x(4)-\/x(1))}
\DoxyCodeLine{1393 c(n)= -\/c(n)*d(n-\/1)*d(n-\/1)/(x(n)-\/x(n-\/3))}
\DoxyCodeLine{1394 \textcolor{keywordflow}{END IF}}
\DoxyCodeLine{1395 }
\DoxyCodeLine{1396 \textcolor{keywordflow}{DO} k=2,n    \textcolor{comment}{! forward elimination}}
\DoxyCodeLine{1397 t= d(k-\/1)/b(k-\/1)}
\DoxyCodeLine{1398 b(k)= b(k)-\/t*d(k-\/1)}
\DoxyCodeLine{1399 c(k)= c(k)-\/t*c(k-\/1)}
\DoxyCodeLine{1400 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{1401 }
\DoxyCodeLine{1402 c(n)= c(n)/b(n)}
\DoxyCodeLine{1403 }
\DoxyCodeLine{1404 \textcolor{comment}{! back substitution ( makes c the sigma of text)}}
\DoxyCodeLine{1405 }
\DoxyCodeLine{1406 \textcolor{keywordflow}{DO} k=n-\/1,1,-\/1}
\DoxyCodeLine{1407 c(k)= (c(k)-\/d(k)*c(k+1))/b(k)}
\DoxyCodeLine{1408 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{1409 }
\DoxyCodeLine{1410 \textcolor{comment}{!.....Compute polynomial coefficients...................................}}
\DoxyCodeLine{1411 }
\DoxyCodeLine{1412 b(n)= (y(n)-\/y(n-\/1))/d(n-\/1)+d(n-\/1)*(c(n-\/1)+c(n)+c(n))}
\DoxyCodeLine{1413 \textcolor{keywordflow}{DO} k=1,n-\/1}
\DoxyCodeLine{1414 b(k)= (y(k+1)-\/y(k))/d(k)-\/d(k)*(c(k+1)+c(k)+c(k))}
\DoxyCodeLine{1415 d(k)= (c(k+1)-\/c(k))/d(k)}
\DoxyCodeLine{1416 c(k)= three*c(k)}
\DoxyCodeLine{1417 \textcolor{keywordflow}{END DO}}
\DoxyCodeLine{1418 c(n)= three*c(n)}
\DoxyCodeLine{1419 d(n)= d(n-\/1)}
\DoxyCodeLine{1420 }
\DoxyCodeLine{1421 \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{1422 }

\end{DoxyCode}
\mbox{\Hypertarget{mod__Misc_8F90_aa91afe68b1537c093c096cdd8f158fed}\label{mod__Misc_8F90_aa91afe68b1537c093c096cdd8f158fed}} 
\index{mod\_Misc.F90@{mod\_Misc.F90}!hto\_seval3singleht@{hto\_seval3singleht}}
\index{hto\_seval3singleht@{hto\_seval3singleht}!mod\_Misc.F90@{mod\_Misc.F90}}
\doxysubsubsection{\texorpdfstring{hto\_seval3singleht()}{hto\_seval3singleht()}}
{\footnotesize\ttfamily subroutine evaluatespline\+::hto\+\_\+seval3singleht (\begin{DoxyParamCaption}\item[{real(8), intent(in)}]{u,  }\item[{real(8), dimension(gdim)}]{b,  }\item[{real(8), dimension(gdim)}]{c,  }\item[{real(8), dimension(gdim)}]{d,  }\item[{integer}]{top,  }\item[{integer}]{gdim,  }\item[{real(8), intent(out), optional}]{f,  }\item[{real(8), intent(out), optional}]{fp,  }\item[{real(8), intent(out), optional}]{fpp,  }\item[{real(8), intent(out), optional}]{fppp,  }\item[{real(8), dimension(gdim)}]{xc,  }\item[{real(8), dimension(gdim)}]{yc }\end{DoxyParamCaption})}



Definition at line 1428 of file mod\+\_\+\+Misc.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1428 }
\DoxyCodeLine{1429 \textcolor{comment}{! -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{1430 }
\DoxyCodeLine{1431 \textcolor{keywordtype}{REAL}(8),\textcolor{keywordtype}{INTENT(IN)} :: u}
\DoxyCodeLine{1432 \textcolor{comment}{! abscissa at which the spline is to be evaluated}}
\DoxyCodeLine{1433 }
\DoxyCodeLine{1434 \textcolor{keywordtype}{INTEGER} j,k,n,l,top,gdim}
\DoxyCodeLine{1435 }
\DoxyCodeLine{1436 \textcolor{keywordtype}{REAL}(8), \textcolor{keywordtype}{dimension(gdim)} :: xc,yc}
\DoxyCodeLine{1437 \textcolor{keywordtype}{REAL}(8), \textcolor{keywordtype}{dimension(gdim)} :: x,y}
\DoxyCodeLine{1438 \textcolor{keywordtype}{REAL}(8), \textcolor{keywordtype}{DIMENSION(gdim)} :: b,c,d}
\DoxyCodeLine{1439 \textcolor{comment}{! linear,quadratic,cubic coeff}}
\DoxyCodeLine{1440 }
\DoxyCodeLine{1441 \textcolor{keywordtype}{REAL}(8),\textcolor{keywordtype}{INTENT(OUT)},\textcolor{keywordtype}{OPTIONAL}:: f,fp,fpp,fppp}
\DoxyCodeLine{1442 \textcolor{comment}{! function, 1st,2nd,3rd deriv}}
\DoxyCodeLine{1443 }
\DoxyCodeLine{1444 \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{SAVE} :: i=1}
\DoxyCodeLine{1445 \textcolor{keywordtype}{REAL}(8)    :: dx}
\DoxyCodeLine{1446 \textcolor{keywordtype}{REAL}(8),\textcolor{keywordtype}{PARAMETER}:: TWO=2.0, three=3.0, six=6.0}
\DoxyCodeLine{1447 }
\DoxyCodeLine{1448 \textcolor{comment}{! The grid}}
\DoxyCodeLine{1449 }
\DoxyCodeLine{1450 n= gdim}
\DoxyCodeLine{1451 \textcolor{keywordflow}{FORALL}(l=1:gdim)}
\DoxyCodeLine{1452 x(l)= xc(l)}
\DoxyCodeLine{1453 y(l)= yc(l)}
\DoxyCodeLine{1454 \textcolor{keywordflow}{ENDFORALL}}
\DoxyCodeLine{1455 }
\DoxyCodeLine{1456 \textcolor{comment}{!.....First check if u is in the same interval found on the}}
\DoxyCodeLine{1457 \textcolor{comment}{!     last call to Seval.............................................}}
\DoxyCodeLine{1458 }
\DoxyCodeLine{1459 \textcolor{keywordflow}{IF} (  (i<1) .OR. (i >= n) ) i=1}
\DoxyCodeLine{1460 \textcolor{keywordflow}{IF} ( (u < x(i))  .OR.  (u >= x(i+1)) ) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{1461 i=1}
\DoxyCodeLine{1462 }
\DoxyCodeLine{1463 \textcolor{comment}{! binary search}}
\DoxyCodeLine{1464 }
\DoxyCodeLine{1465 j= n+1}
\DoxyCodeLine{1466 \textcolor{keywordflow}{DO}}
\DoxyCodeLine{1467 k= (i+j)/2}
\DoxyCodeLine{1468 \textcolor{keywordflow}{IF} (u < x(k)) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{1469 j= k}
\DoxyCodeLine{1470 \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{1471 i= k}
\DoxyCodeLine{1472 \textcolor{keywordflow}{ENDIF}}
\DoxyCodeLine{1473 \textcolor{keywordflow}{IF} (j <= i+1) \textcolor{keywordflow}{EXIT}}
\DoxyCodeLine{1474 \textcolor{keywordflow}{ENDDO}}
\DoxyCodeLine{1475 \textcolor{keywordflow}{ENDIF}}
\DoxyCodeLine{1476 }
\DoxyCodeLine{1477 dx= u-\/x(i)}
\DoxyCodeLine{1478 }
\DoxyCodeLine{1479 \textcolor{comment}{! evaluate the spline}}
\DoxyCodeLine{1480 }
\DoxyCodeLine{1481 \textcolor{keywordflow}{IF} (\textcolor{keyword}{Present}(f))    f= y(i)+dx*(b(i)+dx*(c(i)+dx*d(i)))}
\DoxyCodeLine{1482 \textcolor{keywordflow}{IF} (\textcolor{keyword}{Present}(fp))   fp= b(i)+dx*(two*c(i) + dx*three*d(i))}
\DoxyCodeLine{1483 \textcolor{keywordflow}{IF} (\textcolor{keyword}{Present}(fpp))  fpp= two*c(i) + dx*six*d(i)}
\DoxyCodeLine{1484 \textcolor{keywordflow}{IF} (\textcolor{keyword}{Present}(fppp)) fppp= six*d(i)}
\DoxyCodeLine{1485 }
\DoxyCodeLine{1486 \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{1487 }

\end{DoxyCode}
