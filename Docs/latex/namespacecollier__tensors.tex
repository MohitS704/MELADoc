\hypertarget{namespacecollier__tensors}{}\doxysection{collier\+\_\+tensors Module Reference}
\label{namespacecollier__tensors}\index{collier\_tensors@{collier\_tensors}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfacecollier__tensors_1_1aten__cll}{aten\+\_\+cll}}
\item 
interface \mbox{\hyperlink{interfacecollier__tensors_1_1bten__cll}{bten\+\_\+cll}}
\item 
interface \mbox{\hyperlink{interfacecollier__tensors_1_1cten__cll}{cten\+\_\+cll}}
\item 
interface \mbox{\hyperlink{interfacecollier__tensors_1_1dten__cll}{dten\+\_\+cll}}
\item 
interface \mbox{\hyperlink{interfacecollier__tensors_1_1eten__cll}{eten\+\_\+cll}}
\item 
interface \mbox{\hyperlink{interfacecollier__tensors_1_1ften__cll}{ften\+\_\+cll}}
\item 
interface \mbox{\hyperlink{interfacecollier__tensors_1_1gten__cll}{gten\+\_\+cll}}
\item 
interface \mbox{\hyperlink{interfacecollier__tensors_1_1tnten__cll}{tnten\+\_\+cll}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a1af4cedf09121004ac928e984009b9f3}{aten\+\_\+main\+\_\+cll}} (TA, T\+Auv, masses2, rmax, T\+Aerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_ac3d165ced498f52ff045227d2e31e109}{aten\+\_\+list\+\_\+cll}} (TA, T\+Auv, masses2, rmax, T\+Aerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_aab26882970e2015519489ce98a35c432}{aten\+\_\+list\+\_\+checked\+\_\+cll}} (TA, T\+Auv, masses2, rmax, T\+Aerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a91fca79addb28a9c44339ae6abb7a382}{aten\+\_\+args\+\_\+cll}} (TA, T\+Auv, m02, rmax, T\+Aerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_ae3af03813d26d8db21e75eb9d1a408ae}{aten\+\_\+args\+\_\+list\+\_\+cll}} (TA, T\+Auv, m02, rmax, T\+Aerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_acd5a92007e69b9c38a4181685565b918}{aten\+\_\+args\+\_\+list\+\_\+checked\+\_\+cll}} (TA, T\+Auv, m02, rmax, T\+Aerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a65fc8bc272e83486cd92b39472dfcf4f}{bten\+\_\+main\+\_\+cll}} (TB, T\+Buv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Berr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a28332030a1671a6ed8a500ebe83b9657}{bten\+\_\+list\+\_\+cll}} (TB, T\+Buv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Berr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a2adee9ff44acc7e12679cb45d9c905fa}{bten\+\_\+list\+\_\+checked\+\_\+cll}} (TB, T\+Buv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Berr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_acb7a69654449f75ed1825598a57ca037}{bten\+\_\+args\+\_\+cll}} (TB, T\+Buv, p1vec, p10, m02, m12, rmax, T\+Berr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a1fa67597c7dd758e852a1f6dca390219}{bten\+\_\+args\+\_\+list\+\_\+cll}} (TB, T\+Buv, p1vec, p10, m02, m12, rmax, T\+Berr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a2e7cccc59777f264cbc7bf680bc64f46}{bten\+\_\+args\+\_\+list\+\_\+checked\+\_\+cll}} (TB, T\+Buv, p1vec, p10, m02, m12, rmax, T\+Berr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_af81370e418360b72dbd61dbfc4733a5b}{cten\+\_\+main\+\_\+cll}} (TC, T\+Cuv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Cerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_ab9aa9c991c5534216af7fc5b85b44e68}{cten\+\_\+list\+\_\+cll}} (TC, T\+Cuv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Cerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_aabe489d66033c94e18e392d2de6b435a}{cten\+\_\+list\+\_\+checked\+\_\+cll}} (TC, T\+Cuv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Cerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a8c6f1e627c27e34f7ef5d9c607cafefa}{cten\+\_\+args\+\_\+cll}} (TC, T\+Cuv, p1vec, p2vec, p10, p21, p20, m02, m12, m22, rmax, T\+Cerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_aec2a54cfeaf840549490a41be99dfbb2}{cten\+\_\+args\+\_\+list\+\_\+cll}} (TC, T\+Cuv, p1vec, p2vec, p10, p21, p20, m02, m12, m22, rmax, T\+Cerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a26e41d2004d6be496410777cffbf1643}{cten\+\_\+args\+\_\+list\+\_\+checked\+\_\+cll}} (TC, T\+Cuv, p1vec, p2vec, p10, p21, p20, m02, m12, m22, rmax, T\+Cerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_abf1d5364cb033985f5fde40ea856941c}{dten\+\_\+main\+\_\+cll}} (TD, T\+Duv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Derr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a765e8219d0bb652c3286f081a9f6643a}{dten\+\_\+list\+\_\+cll}} (TD, T\+Duv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Derr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_af784478649f78b1da2c2f372dbb7f6bb}{dten\+\_\+list\+\_\+checked\+\_\+cll}} (TD, T\+Duv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Derr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_aff310970e3a35e652b807c52bdc2b8d7}{dten\+\_\+args\+\_\+cll}} (TD, T\+Duv, p1vec, p2vec, p3vec, p10, p21, p32, p30, p20, p31, m02, m12, m22, m32, rmax, T\+Derr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a3186b4583525ea94bae5f56f2b853200}{dten\+\_\+args\+\_\+list\+\_\+cll}} (TD, T\+Duv, p1vec, p2vec, p3vec, p10, p21, p32, p30, p20, p31, m02, m12, m22, m32, rmax, T\+Derr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_ad3ea858cb4a11696eb6418532e82221e}{dten\+\_\+args\+\_\+list\+\_\+checked\+\_\+cll}} (TD, T\+Duv, p1vec, p2vec, p3vec, p10, p21, p32, p30, p20, p31, m02, m12, m22, m32, rmax, T\+Derr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a1a980ea98c7f056c16d52c97549adabb}{eten\+\_\+main\+\_\+cll}} (TE, T\+Euv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Eerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a9282e713273930d8af6c788cc010f81f}{eten\+\_\+list\+\_\+cll}} (TE, T\+Euv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Eerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_ab02ec3958ab26aa8d22d17ee78c8c913}{eten\+\_\+list\+\_\+checked\+\_\+cll}} (TE, T\+Euv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Eerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_ac0085ba5950e0ffb5099366ac8432ba0}{eten\+\_\+args\+\_\+cll}} (TE, T\+Euv, p1vec, p2vec, p3vec, p4vec, p10, p21, p32, p43, p40, p20, p31, p42, p30, p41, m02, m12, m22, m32, m42, rmax, T\+Eerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a0314603490a1a1c29d52800d27002cdf}{eten\+\_\+args\+\_\+list\+\_\+cll}} (TE, T\+Euv, p1vec, p2vec, p3vec, p4vec, p10, p21, p32, p43, p40, p20, p31, p42, p30, p41, m02, m12, m22, m32, m42, rmax, T\+Eerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_ae455f8dfeb8689c700207c33c5030652}{eten\+\_\+args\+\_\+list\+\_\+checked\+\_\+cll}} (TE, T\+Euv, p1vec, p2vec, p3vec, p4vec, p10, p21, p32, p43, p40, p20, p31, p42, p30, p41, m02, m12, m22, m32, m42, rmax, T\+Eerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_ae1aff9e61c040381355b95796fa03928}{ften\+\_\+main\+\_\+cll}} (TF, T\+Fuv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Ferr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a33255f6dab2c80c147f49f2f2a8307a9}{ften\+\_\+list\+\_\+cll}} (TF, T\+Fuv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Ferr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a54bac71e5a70b26e794a149d4cd47aac}{ften\+\_\+list\+\_\+checked\+\_\+cll}} (TF, T\+Fuv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Ferr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_aded4a4e2b606bd45d0f502afa07944ae}{ften\+\_\+args\+\_\+cll}} (TF, T\+Fuv, p1vec, p2vec, p3vec, p4vec, p5vec, p10, p21, p32, p43, p54, p50, p20, p31, p42, p53, p40, p51, p30, p41, p52, m02, m12, m22, m32, m42, m52, rmax, T\+Ferr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a912588549e1bc6a08bd0a78f0606fa0b}{ften\+\_\+args\+\_\+list\+\_\+cll}} (TF, T\+Fuv, p1vec, p2vec, p3vec, p4vec, p5vec, p10, p21, p32, p43, p54, p50, p20, p31, p42, p53, p40, p51, p30, p41, p52, m02, m12, m22, m32, m42, m52, rmax, T\+Ferr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_ae280f5f9c022a58e673a5175d5bacc82}{ften\+\_\+args\+\_\+list\+\_\+checked\+\_\+cll}} (TF, T\+Fuv, p1vec, p2vec, p3vec, p4vec, p5vec, p10, p21, p32, p43, p54, p50, p20, p31, p42, p53, p40, p51, p30, p41, p52, m02, m12, m22, m32, m42, m52, rmax, T\+Ferr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a35d3c1c32be2f39e18b3035b9efd31f2}{gten\+\_\+main\+\_\+cll}} (TG, T\+Guv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Gerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a121016ac6975fdf09bbec7d767e23037}{gten\+\_\+list\+\_\+cll}} (TG, T\+Guv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Gerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_ae1bf216de04e5649889b8a7a3fbc315b}{gten\+\_\+list\+\_\+checked\+\_\+cll}} (TG, T\+Guv, Mom\+Vec, Mom\+Inv, masses2, rmax, T\+Gerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a4936ce1ce9f20c0bc2aa38a080ca897c}{gten\+\_\+args\+\_\+cll}} (TG, T\+Guv, p1vec, p2vec, p3vec, p4vec, p5vec, p6vec, p10, p21, p32, p43, p54, p65, p60, p20, p31, p42, p53, p64, p50, p61, p30, p41, p52, p63, p40, p51, p62, m02, m12, m22, m32, m42, m52, m62, rmax, T\+Gerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a39ca7e37ea7dc038c303010f2fac582f}{gten\+\_\+args\+\_\+list\+\_\+cll}} (TG, T\+Guv, p1vec, p2vec, p3vec, p4vec, p5vec, p6vec, p10, p21, p32, p43, p54, p65, p60, p20, p31, p42, p53, p64, p50, p61, p30, p41, p52, p63, p40, p51, p62, m02, m12, m22, m32, m42, m52, m62, rmax, T\+Gerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_ab7d6a27a15d210162f8d6d73143887e8}{gten\+\_\+args\+\_\+list\+\_\+checked\+\_\+cll}} (TG, T\+Guv, p1vec, p2vec, p3vec, p4vec, p5vec, p6vec, p10, p21, p32, p43, p54, p65, p60, p20, p31, p42, p53, p64, p50, p61, p30, p41, p52, p63, p40, p51, p62, m02, m12, m22, m32, m42, m52, m62, rmax, T\+Gerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a1ce6fe217845dbbe80fe5effdeac8cd3}{tnten\+\_\+main\+\_\+cll}} (TN, T\+Nuv, Mom\+Vec, Mom\+Inv, masses2, N, rmax, T\+Nerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a87995b57c6fddc58254053e30899a7e7}{tnten\+\_\+main\+\_\+checked\+\_\+cll}} (TN, T\+Nuv, Mom\+Vec, Mom\+Inv, masses2, N, rmax, T\+Nerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_ad5a41c48b7784839de17ebc766b878c8}{tnten\+\_\+list\+\_\+cll}} (TN, T\+Nuv, Mom\+Vec, Mom\+Inv, masses2, N, rmax, T\+Nerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a1ecde1bfcc792940c48453fcc8e40f89}{tnten\+\_\+list\+\_\+checked\+\_\+cll}} (TN, T\+Nuv, Mom\+Vec, Mom\+Inv, masses2, N, rmax, T\+Nerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a2ea6b37a1666e6bd877302768d9342e2}{t1ten\+\_\+main\+\_\+cll}} (TA, T\+Auv, masses2, N, rmax, T\+Aerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a566f3d792ce105469c7e3b239d3732da}{t1ten\+\_\+list\+\_\+cll}} (TA, T\+Auv, masses2, N, rmax, T\+Aerr)
\item 
subroutine \mbox{\hyperlink{namespacecollier__tensors_a2a5a0690343ab7b8150bdb307cd35317}{t1ten\+\_\+list\+\_\+checked\+\_\+cll}} (TA, T\+Auv, masses2, N, rmax, T\+Aerr)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacecollier__tensors_a91fca79addb28a9c44339ae6abb7a382}\label{namespacecollier__tensors_a91fca79addb28a9c44339ae6abb7a382}} 
\index{collier\_tensors@{collier\_tensors}!aten\_args\_cll@{aten\_args\_cll}}
\index{aten\_args\_cll@{aten\_args\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{aten\_args\_cll()}{aten\_args\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::aten\+\_\+args\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TA,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Auv,  }\item[{double complex, intent(in)}]{m02,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Aerr }\end{DoxyParamCaption})}



Definition at line 446 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{446 }
\DoxyCodeLine{447     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{448     \textcolor{keywordtype}{double complex},\textcolor{keywordtype}{intent(in)} :: m02}
\DoxyCodeLine{449     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TA(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{450     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TAuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{451     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TAerr(0:rmax)}
\DoxyCodeLine{452     \textcolor{keywordtype}{double complex} :: TA2(0:rmax,0:rmax,0:rmax,0:rmax), TAuv2(0:rmax,0:rmax,0:rmax,0:rmax)    }
\DoxyCodeLine{453     \textcolor{keywordtype}{double complex} :: CA(0:rmax/2), CAuv(0:rmax/2)}
\DoxyCodeLine{454     \textcolor{keywordtype}{double precision} :: CAerr(0:rmax),TAerr\_aux(0:rmax),TAerr\_aux2(0:rmax)}
\DoxyCodeLine{455     \textcolor{keywordtype}{double complex} :: args(1),masses2(0:0)}
\DoxyCodeLine{456     \textcolor{keywordtype}{double precision} :: TAdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TAacc(0:rmax)}
\DoxyCodeLine{457     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3}
\DoxyCodeLine{458     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{459     }
\DoxyCodeLine{460     \textcolor{keywordflow}{if} (1.gt.nmax\_cll) then}
\DoxyCodeLine{461       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{462       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Aten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 1'},eflag,.true.)}
\DoxyCodeLine{463       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{464       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 1'}}
\DoxyCodeLine{465       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{466       return}
\DoxyCodeLine{467 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{468     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{469       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{470       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Aten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{471       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{472       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{473       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{474       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{475       return}
\DoxyCodeLine{476 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{477 }
\DoxyCodeLine{478     args(1) = m02}
\DoxyCodeLine{479     masses2(0) = m02}
\DoxyCodeLine{480     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Aten\_cll'})}
\DoxyCodeLine{481     \textcolor{keyword}{call }setmastern\_cll(1)}
\DoxyCodeLine{482     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{483     \textcolor{keyword}{call }setmasterargs\_cll(1,args)}
\DoxyCodeLine{484 }
\DoxyCodeLine{485     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{486     }
\DoxyCodeLine{487     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{488       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{489       mode\_cll = 1}
\DoxyCodeLine{490       \textcolor{keyword}{call }a\_cll(ca,cauv,m02,rmax,caerr,0)}
\DoxyCodeLine{491       \textcolor{keyword}{call }calctensora(ta,tauv,taerr\_aux,ca,cauv,caerr,rmax)         }
\DoxyCodeLine{492       }
\DoxyCodeLine{493       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{494       mode\_cll = 2}
\DoxyCodeLine{495       \textcolor{keyword}{call }a\_cll(ca,cauv,m02,rmax,caerr,0)}
\DoxyCodeLine{496       \textcolor{keyword}{call }calctensora(ta2,tauv2,taerr\_aux2,ca,cauv,caerr,rmax)          }
\DoxyCodeLine{497       }
\DoxyCodeLine{498       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{499       mode\_cll = 3}
\DoxyCodeLine{500       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{501         norm\_coli=0d0}
\DoxyCodeLine{502         norm\_dd=0d0}
\DoxyCodeLine{503         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{504           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{505             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{506               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{507               norm\_coli = max(norm\_coli,abs(ta(n0,n1,n2,n3)))}
\DoxyCodeLine{508               norm\_dd = max(norm\_dd,abs(ta2(n0,n1,n2,n3)))}
\DoxyCodeLine{509             \textcolor{keyword}{end }do}
\DoxyCodeLine{510           \textcolor{keyword}{end }do}
\DoxyCodeLine{511         \textcolor{keyword}{end }do}
\DoxyCodeLine{512         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{513           norm\_coli = abs(masses2(0))}
\DoxyCodeLine{514           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{515             norm\_coli=norm\_coli**(1+real(r)/2)}
\DoxyCodeLine{516           else}
\DoxyCodeLine{517             norm\_coli=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{518           \textcolor{keyword}{end }if}
\DoxyCodeLine{519         \textcolor{keyword}{end }if}
\DoxyCodeLine{520         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{521           norm\_dd = abs(masses2(0))}
\DoxyCodeLine{522           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{523             norm\_dd=norm\_dd**(1+real(r)/2)}
\DoxyCodeLine{524           else}
\DoxyCodeLine{525             norm\_dd=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{526           \textcolor{keyword}{end }if}
\DoxyCodeLine{527         \textcolor{keyword}{end }if}
\DoxyCodeLine{528         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{529       \textcolor{keyword}{end }do}
\DoxyCodeLine{530       }
\DoxyCodeLine{531       \textcolor{keyword}{call }checktena\_cll(ta,ta2,masses2,norm,rmax,tadiff)}
\DoxyCodeLine{532        }
\DoxyCodeLine{533       \textcolor{keywordflow}{if} (taerr\_aux(rmax).lt.taerr\_aux2(rmax)) then}
\DoxyCodeLine{534         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr))  taerr = max(taerr\_aux,tadiff*norm)}
\DoxyCodeLine{535         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{536           taacc(r) = max(taerr\_aux(r)/norm(r),tadiff(r))}
\DoxyCodeLine{537         \textcolor{keyword}{end }do}
\DoxyCodeLine{538         \textcolor{keywordflow}{if} (monitoring) pointscntaten\_coli =  pointscntaten\_coli + 1}
\DoxyCodeLine{539       else}
\DoxyCodeLine{540         ta = ta2}
\DoxyCodeLine{541         tauv = tauv2        }
\DoxyCodeLine{542         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr))  taerr = max(taerr\_aux2,tadiff*norm)    }
\DoxyCodeLine{543         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{544           taacc(r) = max(taerr\_aux2(r)/norm(r),tadiff(r))}
\DoxyCodeLine{545         \textcolor{keyword}{end }do}
\DoxyCodeLine{546         \textcolor{keywordflow}{if} (monitoring) pointscntaten\_dd =  pointscntaten\_dd + 1         }
\DoxyCodeLine{547 \textcolor{keywordflow}{      end if}      }
\DoxyCodeLine{548     }
\DoxyCodeLine{549     else}
\DoxyCodeLine{550       \textcolor{keyword}{call }a\_cll(ca,cauv,m02,rmax,caerr,0)}
\DoxyCodeLine{551       \textcolor{keyword}{call }calctensora(ta,tauv,taerr\_aux,ca,cauv,caerr,rmax)}
\DoxyCodeLine{552       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr)) taerr = taerr\_aux}
\DoxyCodeLine{553       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{554         norm(r)=0d0}
\DoxyCodeLine{555         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{556           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{557             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{558               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{559               norm(r) = max(norm(r),abs(ta(n0,n1,n2,n3)))}
\DoxyCodeLine{560             \textcolor{keyword}{end }do}
\DoxyCodeLine{561           \textcolor{keyword}{end }do}
\DoxyCodeLine{562         \textcolor{keyword}{end }do}
\DoxyCodeLine{563         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{564           norm(r) = abs(masses2(0))}
\DoxyCodeLine{565           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{566             norm(r)=norm(r)**(1+real(r)/2)}
\DoxyCodeLine{567           else}
\DoxyCodeLine{568             norm(r)=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{569           \textcolor{keyword}{end }if}
\DoxyCodeLine{570         \textcolor{keyword}{end }if}
\DoxyCodeLine{571       \textcolor{keyword}{end }do}
\DoxyCodeLine{572       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{573         taacc(r) = taerr\_aux(r)/norm(r)}
\DoxyCodeLine{574 \textcolor{keywordflow}{      end do}      }
\DoxyCodeLine{575       }
\DoxyCodeLine{576     \textcolor{keyword}{end }if}
\DoxyCodeLine{577 }
\DoxyCodeLine{578     \textcolor{keyword}{call }propagateaccflag\_cll(taacc,rmax)}
\DoxyCodeLine{579     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{580 }
\DoxyCodeLine{581     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{582       pointscntaten\_cll =  pointscntaten\_cll + 1}
\DoxyCodeLine{583 }
\DoxyCodeLine{584       \textcolor{keywordflow}{if}(maxval(taacc).gt.reqacc\_cll) accpointscntaten\_cll = accpointscntaten\_cll + 1}
\DoxyCodeLine{585 }
\DoxyCodeLine{586       \textcolor{keywordflow}{if}(maxval(taacc).gt.critacc\_cll) then}
\DoxyCodeLine{587         critpointscntaten\_cll =  critpointscntaten\_cll + 1}
\DoxyCodeLine{588         \textcolor{keywordflow}{if} ( critpointscntaten\_cll.le.noutcritpointsmax\_cll(1) ) then}
\DoxyCodeLine{589           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TAten\_cll'},0,maxval(taacc),critpointscntaten\_cll)}
\DoxyCodeLine{590           \textcolor{keywordflow}{if}( critpointscntaten\_cll.eq.noutcritpointsmax\_cll(1)) then}
\DoxyCodeLine{591             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TAten\_cll suppressed'}   }
\DoxyCodeLine{592             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{593           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{594 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{595 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TAten\_cll'},0,maxval(taacc),critpointscntaten\_cll)}
\DoxyCodeLine{596           \textcolor{keywordflow}{if}( critpointscntaten\_cll.eq.noutcritpointsmax\_cll(1)) then}
\DoxyCodeLine{597             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TAten\_cll suppressed'}   }
\DoxyCodeLine{598             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{599           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{600 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{601 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{602       \textcolor{keyword}{end }if}
\DoxyCodeLine{603     \textcolor{keyword}{end }if}
\DoxyCodeLine{604 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_acd5a92007e69b9c38a4181685565b918}\label{namespacecollier__tensors_acd5a92007e69b9c38a4181685565b918}} 
\index{collier\_tensors@{collier\_tensors}!aten\_args\_list\_checked\_cll@{aten\_args\_list\_checked\_cll}}
\index{aten\_args\_list\_checked\_cll@{aten\_args\_list\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{aten\_args\_list\_checked\_cll()}{aten\_args\_list\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::aten\+\_\+args\+\_\+list\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TA,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Auv,  }\item[{double complex, intent(in)}]{m02,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Aerr }\end{DoxyParamCaption})}



Definition at line 649 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{649 }
\DoxyCodeLine{650     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{651     \textcolor{keywordtype}{double complex},\textcolor{keywordtype}{intent(in)} :: m02}
\DoxyCodeLine{652     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TA(RtS(rmax)),TAuv(RtS(rmax))}
\DoxyCodeLine{653     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TAerr(0:rmax)}
\DoxyCodeLine{654     \textcolor{keywordtype}{double complex} :: TA2(RtS(rmax)),TAuv2(RtS(rmax))    }
\DoxyCodeLine{655     \textcolor{keywordtype}{double complex} :: CA(0:rmax/2), CAuv(0:rmax/2)}
\DoxyCodeLine{656     \textcolor{keywordtype}{double precision} :: CAerr(0:rmax), TAerr\_aux(0:rmax), TAerr\_aux2(0:rmax)}
\DoxyCodeLine{657     \textcolor{keywordtype}{double complex} :: args(1),masses2(0:0)}
\DoxyCodeLine{658     \textcolor{keywordtype}{double precision} :: TAdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TAacc(0:rmax)}
\DoxyCodeLine{659     \textcolor{keywordtype}{integer} :: r,i    }
\DoxyCodeLine{660     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{661 }
\DoxyCodeLine{662     args(1) = m02}
\DoxyCodeLine{663     masses2(0) = m02}
\DoxyCodeLine{664     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Aten\_cll'})}
\DoxyCodeLine{665     \textcolor{keyword}{call }setmastern\_cll(1)}
\DoxyCodeLine{666     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{667     \textcolor{keyword}{call }setmasterargs\_cll(1,args)}
\DoxyCodeLine{668 }
\DoxyCodeLine{669     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{670     }
\DoxyCodeLine{671     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{672       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{673       mode\_cll = 1}
\DoxyCodeLine{674       \textcolor{keyword}{call }a\_cll(ca,cauv,m02,rmax,caerr,0)}
\DoxyCodeLine{675       \textcolor{keyword}{call }calctensora\_list(ta,tauv,taerr\_aux,ca,cauv,caerr,rmax)         }
\DoxyCodeLine{676       }
\DoxyCodeLine{677       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{678       mode\_cll = 2}
\DoxyCodeLine{679       \textcolor{keyword}{call }a\_cll(ca,cauv,m02,rmax,caerr,0)}
\DoxyCodeLine{680       \textcolor{keyword}{call }calctensora\_list(ta2,tauv2,taerr\_aux2,ca,cauv,caerr,rmax)          }
\DoxyCodeLine{681       }
\DoxyCodeLine{682       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{683       mode\_cll = 3}
\DoxyCodeLine{684       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{685         norm\_coli=0d0}
\DoxyCodeLine{686         norm\_dd=0d0}
\DoxyCodeLine{687         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{688           norm\_coli = max(norm\_coli,abs(ta(i)))}
\DoxyCodeLine{689           norm\_dd = max(norm\_dd,abs(ta2(i)))}
\DoxyCodeLine{690         \textcolor{keyword}{end }do}
\DoxyCodeLine{691         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{692           norm\_coli = abs(masses2(0))}
\DoxyCodeLine{693           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{694             norm\_coli=norm\_coli**(1+real(r)/2)}
\DoxyCodeLine{695           else}
\DoxyCodeLine{696             norm\_coli=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{697           \textcolor{keyword}{end }if}
\DoxyCodeLine{698         \textcolor{keyword}{end }if}
\DoxyCodeLine{699         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{700           norm\_dd = abs(masses2(0))}
\DoxyCodeLine{701           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{702             norm\_dd=norm\_dd**(1+real(r)/2)}
\DoxyCodeLine{703           else}
\DoxyCodeLine{704             norm\_dd=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{705           \textcolor{keyword}{end }if}
\DoxyCodeLine{706         \textcolor{keyword}{end }if}
\DoxyCodeLine{707         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{708       \textcolor{keyword}{end }do}
\DoxyCodeLine{709       }
\DoxyCodeLine{710       \textcolor{keyword}{call }checktenalist\_cll(ta,ta2,masses2,norm,rmax,tadiff)}
\DoxyCodeLine{711       }
\DoxyCodeLine{712       \textcolor{keywordflow}{if} (taerr\_aux(rmax).lt.taerr\_aux2(rmax)) then}
\DoxyCodeLine{713         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr))  taerr = max(taerr\_aux,tadiff*norm)}
\DoxyCodeLine{714         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{715           taacc(r) = max(taerr\_aux(r)/norm(r),tadiff(r))}
\DoxyCodeLine{716         \textcolor{keyword}{end }do}
\DoxyCodeLine{717         \textcolor{keywordflow}{if} (monitoring) pointscntaten\_coli =  pointscntaten\_coli + 1}
\DoxyCodeLine{718       else}
\DoxyCodeLine{719         ta = ta2}
\DoxyCodeLine{720         tauv = tauv2        }
\DoxyCodeLine{721         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr))  taerr = max(taerr\_aux2,tadiff*norm)    }
\DoxyCodeLine{722         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{723           taacc(r) = max(taerr\_aux2(r)/norm(r),tadiff(r))}
\DoxyCodeLine{724 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{725         \textcolor{keywordflow}{if} (monitoring) pointscntaten\_dd =  pointscntaten\_dd + 1}
\DoxyCodeLine{726 \textcolor{keywordflow}{      end if}      }
\DoxyCodeLine{727     }
\DoxyCodeLine{728     else}
\DoxyCodeLine{729       \textcolor{keyword}{call }a\_cll(ca,cauv,m02,rmax,caerr,0)    }
\DoxyCodeLine{730       \textcolor{keyword}{call }calctensora\_list(ta,tauv,taerr\_aux,ca,cauv,caerr,rmax)}
\DoxyCodeLine{731       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr)) taerr = taerr\_aux}
\DoxyCodeLine{732       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{733         norm(r)=0d0}
\DoxyCodeLine{734         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{735           norm(r) = max(norm(r),abs(ta(i)))}
\DoxyCodeLine{736         \textcolor{keyword}{end }do}
\DoxyCodeLine{737         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{738           norm(r) = abs(masses2(0))}
\DoxyCodeLine{739           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{740             norm(r)=norm(r)**(1+real(r)/2)}
\DoxyCodeLine{741           else}
\DoxyCodeLine{742             norm(r)=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{743           \textcolor{keyword}{end }if}
\DoxyCodeLine{744         \textcolor{keyword}{end }if}
\DoxyCodeLine{745       \textcolor{keyword}{end }do}
\DoxyCodeLine{746       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{747         taacc(r) = taerr\_aux(r)/norm(r)}
\DoxyCodeLine{748 \textcolor{keywordflow}{      end do}      }
\DoxyCodeLine{749       }
\DoxyCodeLine{750     \textcolor{keyword}{end }if}
\DoxyCodeLine{751 }
\DoxyCodeLine{752     \textcolor{keyword}{call }propagateaccflag\_cll(taacc,rmax)}
\DoxyCodeLine{753     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{754 }
\DoxyCodeLine{755     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{756       pointscntaten\_cll =  pointscntaten\_cll + 1}
\DoxyCodeLine{757 }
\DoxyCodeLine{758       \textcolor{keywordflow}{if}(maxval(taacc).gt.reqacc\_cll) accpointscntaten\_cll = accpointscntaten\_cll + 1}
\DoxyCodeLine{759 }
\DoxyCodeLine{760       \textcolor{keywordflow}{if}(maxval(taacc).gt.critacc\_cll) then}
\DoxyCodeLine{761         critpointscntaten\_cll =  critpointscntaten\_cll + 1}
\DoxyCodeLine{762         \textcolor{keywordflow}{if} ( critpointscntaten\_cll.le.noutcritpointsmax\_cll(1) ) then}
\DoxyCodeLine{763           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TAten\_cll'},0,maxval(taacc),critpointscntaten\_cll)}
\DoxyCodeLine{764           \textcolor{keywordflow}{if}( critpointscntaten\_cll.eq.noutcritpointsmax\_cll(1)) then}
\DoxyCodeLine{765             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TAten\_cll suppressed'}   }
\DoxyCodeLine{766             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{767           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{768 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{769 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TAten\_cll'},0,maxval(taacc),critpointscntaten\_cll)}
\DoxyCodeLine{770           \textcolor{keywordflow}{if}( critpointscntaten\_cll.eq.noutcritpointsmax\_cll(1)) then}
\DoxyCodeLine{771             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TAten\_cll suppressed'}   }
\DoxyCodeLine{772             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{773           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{774 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{775 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{776       \textcolor{keyword}{end }if}
\DoxyCodeLine{777     \textcolor{keyword}{end }if}
\DoxyCodeLine{778 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_ae3af03813d26d8db21e75eb9d1a408ae}\label{namespacecollier__tensors_ae3af03813d26d8db21e75eb9d1a408ae}} 
\index{collier\_tensors@{collier\_tensors}!aten\_args\_list\_cll@{aten\_args\_list\_cll}}
\index{aten\_args\_list\_cll@{aten\_args\_list\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{aten\_args\_list\_cll()}{aten\_args\_list\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::aten\+\_\+args\+\_\+list\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:), intent(out)}]{TA,  }\item[{double complex, dimension(\+:), intent(out)}]{T\+Auv,  }\item[{double complex, intent(in)}]{m02,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:), intent(out), optional}]{T\+Aerr }\end{DoxyParamCaption})}



Definition at line 617 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{617 }
\DoxyCodeLine{618     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{619     \textcolor{keywordtype}{double complex},\textcolor{keywordtype}{intent(in)} :: m02}
\DoxyCodeLine{620     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TA(:),TAuv(:)}
\DoxyCodeLine{621     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TAerr(0:)}
\DoxyCodeLine{622     \textcolor{keywordtype}{integer} :: r,i    }
\DoxyCodeLine{623     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{624 }
\DoxyCodeLine{625     \textcolor{keywordflow}{if} (1.gt.nmax\_cll) then}
\DoxyCodeLine{626       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{627       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Aten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 1'},eflag,.true.)}
\DoxyCodeLine{628       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{629       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 1'}}
\DoxyCodeLine{630       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{631       return}
\DoxyCodeLine{632 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{633     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{634       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{635       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Aten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{636       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{637       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{638       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{639       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{640       return}
\DoxyCodeLine{641 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{642 }
\DoxyCodeLine{643     \textcolor{keyword}{call }aten\_args\_list\_checked\_cll(ta,tauv,m02,rmax,taerr)}
\DoxyCodeLine{644 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_aab26882970e2015519489ce98a35c432}\label{namespacecollier__tensors_aab26882970e2015519489ce98a35c432}} 
\index{collier\_tensors@{collier\_tensors}!aten\_list\_checked\_cll@{aten\_list\_checked\_cll}}
\index{aten\_list\_checked\_cll@{aten\_list\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{aten\_list\_checked\_cll()}{aten\_list\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::aten\+\_\+list\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TA,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Auv,  }\item[{double complex, dimension(0\+:0), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Aerr }\end{DoxyParamCaption})}



Definition at line 306 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{306 }
\DoxyCodeLine{307     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{308     \textcolor{keywordtype}{double complex},\textcolor{keywordtype}{intent(in)} :: masses2(0:0)}
\DoxyCodeLine{309     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TA(RtS(rmax)),TAuv(RtS(rmax))}
\DoxyCodeLine{310     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TAerr(0:rmax)}
\DoxyCodeLine{311     \textcolor{keywordtype}{double complex} :: TA2(RtS(rmax)),TAuv2(RtS(rmax))    }
\DoxyCodeLine{312     \textcolor{keywordtype}{double complex} :: CA(0:rmax/2), CAuv(0:rmax/2)}
\DoxyCodeLine{313     \textcolor{keywordtype}{double precision} :: CAerr(0:rmax), TAerr\_aux(0:rmax), TAerr\_aux2(0:rmax)}
\DoxyCodeLine{314     \textcolor{keywordtype}{double complex} :: args(1)}
\DoxyCodeLine{315     \textcolor{keywordtype}{double precision} :: TAdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TAacc(0:rmax)}
\DoxyCodeLine{316     \textcolor{keywordtype}{integer} :: r,i}
\DoxyCodeLine{317 }
\DoxyCodeLine{318     args(1) = masses2(0)}
\DoxyCodeLine{319     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Aten\_cll'})}
\DoxyCodeLine{320     \textcolor{keyword}{call }setmastern\_cll(1)}
\DoxyCodeLine{321     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{322     \textcolor{keyword}{call }setmasterargs\_cll(1,args)}
\DoxyCodeLine{323 }
\DoxyCodeLine{324     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{325     }
\DoxyCodeLine{326     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{327       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{328       mode\_cll = 1}
\DoxyCodeLine{329       \textcolor{keyword}{call }a\_cll(ca,cauv,masses2(0),rmax,caerr,0)}
\DoxyCodeLine{330       \textcolor{keyword}{call }calctensora\_list(ta,tauv,taerr\_aux,ca,cauv,caerr,rmax)         }
\DoxyCodeLine{331       }
\DoxyCodeLine{332       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{333       mode\_cll = 2}
\DoxyCodeLine{334       \textcolor{keyword}{call }a\_cll(ca,cauv,masses2(0),rmax,caerr,0)}
\DoxyCodeLine{335       \textcolor{keyword}{call }calctensora\_list(ta2,tauv2,taerr\_aux2,ca,cauv,caerr,rmax)          }
\DoxyCodeLine{336       }
\DoxyCodeLine{337       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{338       mode\_cll = 3}
\DoxyCodeLine{339       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{340         norm\_coli=0d0}
\DoxyCodeLine{341         norm\_dd=0d0}
\DoxyCodeLine{342         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{343           norm\_coli = max(norm\_coli,abs(ta(i)))}
\DoxyCodeLine{344           norm\_dd = max(norm\_dd,abs(ta2(i)))}
\DoxyCodeLine{345         \textcolor{keyword}{end }do}
\DoxyCodeLine{346         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{347           norm\_coli = abs(masses2(0))}
\DoxyCodeLine{348           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{349             norm\_coli=norm\_coli**(1+real(r)/2)}
\DoxyCodeLine{350           else}
\DoxyCodeLine{351             norm\_coli=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{352           \textcolor{keyword}{end }if}
\DoxyCodeLine{353         \textcolor{keyword}{end }if}
\DoxyCodeLine{354         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{355           norm\_dd = abs(masses2(0))}
\DoxyCodeLine{356           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{357             norm\_dd=norm\_dd**(1+real(r)/2)}
\DoxyCodeLine{358           else}
\DoxyCodeLine{359             norm\_dd=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{360           \textcolor{keyword}{end }if}
\DoxyCodeLine{361         \textcolor{keyword}{end }if}
\DoxyCodeLine{362         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{363       \textcolor{keyword}{end }do}
\DoxyCodeLine{364       }
\DoxyCodeLine{365       \textcolor{keyword}{call }checktenalist\_cll(ta,ta2,masses2,norm,rmax,tadiff)}
\DoxyCodeLine{366       }
\DoxyCodeLine{367       \textcolor{keywordflow}{if} (taerr\_aux(rmax).lt.taerr\_aux2(rmax)) then}
\DoxyCodeLine{368         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr))  taerr = max(taerr\_aux,tadiff*norm)}
\DoxyCodeLine{369         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{370           taacc(r) = max(taerr\_aux(r)/norm(r),tadiff(r))}
\DoxyCodeLine{371         \textcolor{keyword}{end }do}
\DoxyCodeLine{372         \textcolor{keywordflow}{if} (monitoring) pointscntaten\_coli =  pointscntaten\_coli + 1}
\DoxyCodeLine{373       else}
\DoxyCodeLine{374         ta = ta2}
\DoxyCodeLine{375         tauv = tauv2        }
\DoxyCodeLine{376         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr))  taerr = max(taerr\_aux2,tadiff*norm)    }
\DoxyCodeLine{377         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{378           taacc(r) = max(taerr\_aux2(r)/norm(r),tadiff(r))}
\DoxyCodeLine{379 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{380         \textcolor{keywordflow}{if} (monitoring) pointscntaten\_dd =  pointscntaten\_dd + 1}
\DoxyCodeLine{381 \textcolor{keywordflow}{      end if}       }
\DoxyCodeLine{382     }
\DoxyCodeLine{383     else}
\DoxyCodeLine{384       \textcolor{keyword}{call }a\_cll(ca,cauv,masses2(0),rmax,caerr,0)    }
\DoxyCodeLine{385       \textcolor{keyword}{call }calctensora\_list(ta,tauv,taerr\_aux,ca,cauv,caerr,rmax)}
\DoxyCodeLine{386       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr)) taerr = taerr\_aux}
\DoxyCodeLine{387       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{388         norm(r)=0d0}
\DoxyCodeLine{389         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{390           norm(r) = max(norm(r),abs(ta(i)))}
\DoxyCodeLine{391         \textcolor{keyword}{end }do}
\DoxyCodeLine{392         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{393           norm(r) = abs(masses2(0))}
\DoxyCodeLine{394           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{395             norm(r)=norm(r)**(1+real(r)/2)}
\DoxyCodeLine{396           else}
\DoxyCodeLine{397             norm(r)=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{398           \textcolor{keyword}{end }if}
\DoxyCodeLine{399         \textcolor{keyword}{end }if}
\DoxyCodeLine{400       \textcolor{keyword}{end }do}
\DoxyCodeLine{401       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{402         taacc(r) = taerr\_aux(r)/norm(r)}
\DoxyCodeLine{403 \textcolor{keywordflow}{      end do}      }
\DoxyCodeLine{404       }
\DoxyCodeLine{405     \textcolor{keyword}{end }if}
\DoxyCodeLine{406 }
\DoxyCodeLine{407     \textcolor{keyword}{call }propagateaccflag\_cll(taacc,rmax)}
\DoxyCodeLine{408     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{409 }
\DoxyCodeLine{410     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{411       pointscntaten\_cll =  pointscntaten\_cll + 1}
\DoxyCodeLine{412 }
\DoxyCodeLine{413       \textcolor{keywordflow}{if}(maxval(taacc).gt.reqacc\_cll) accpointscntaten\_cll = accpointscntaten\_cll + 1}
\DoxyCodeLine{414 }
\DoxyCodeLine{415       \textcolor{keywordflow}{if}(maxval(taacc).gt.critacc\_cll) then}
\DoxyCodeLine{416         critpointscntaten\_cll =  critpointscntaten\_cll + 1}
\DoxyCodeLine{417         \textcolor{keywordflow}{if} ( critpointscntaten\_cll.le.noutcritpointsmax\_cll(1) ) then}
\DoxyCodeLine{418           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TAten\_cll'},0,maxval(taacc),critpointscntaten\_cll)}
\DoxyCodeLine{419           \textcolor{keywordflow}{if}( critpointscntaten\_cll.eq.noutcritpointsmax\_cll(1)) then}
\DoxyCodeLine{420             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TAten\_cll suppressed'}   }
\DoxyCodeLine{421             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{422           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{423 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{424 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TAten\_cll'},0,maxval(taacc),critpointscntaten\_cll)}
\DoxyCodeLine{425           \textcolor{keywordflow}{if}( critpointscntaten\_cll.eq.noutcritpointsmax\_cll(1)) then}
\DoxyCodeLine{426             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TAten\_cll suppressed'}   }
\DoxyCodeLine{427             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{428           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{429 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{430 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{431       \textcolor{keyword}{end }if}
\DoxyCodeLine{432     \textcolor{keyword}{end }if}
\DoxyCodeLine{433 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_ac3d165ced498f52ff045227d2e31e109}\label{namespacecollier__tensors_ac3d165ced498f52ff045227d2e31e109}} 
\index{collier\_tensors@{collier\_tensors}!aten\_list\_cll@{aten\_list\_cll}}
\index{aten\_list\_cll@{aten\_list\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{aten\_list\_cll()}{aten\_list\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::aten\+\_\+list\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:), intent(out)}]{TA,  }\item[{double complex, dimension(\+:), intent(out)}]{T\+Auv,  }\item[{double complex, dimension(0\+:0), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Aerr }\end{DoxyParamCaption})}



Definition at line 274 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{274 }
\DoxyCodeLine{275     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{276     \textcolor{keywordtype}{double complex},\textcolor{keywordtype}{intent(in)} :: masses2(0:0)}
\DoxyCodeLine{277     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TA(:),TAuv(:)}
\DoxyCodeLine{278     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TAerr(0:rmax)}
\DoxyCodeLine{279     \textcolor{keywordtype}{integer} :: r,i}
\DoxyCodeLine{280     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{281 }
\DoxyCodeLine{282     \textcolor{keywordflow}{if} (1.gt.nmax\_cll) then}
\DoxyCodeLine{283       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{284       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Aten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 1'},eflag,.true.)}
\DoxyCodeLine{285       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{286       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 1'}}
\DoxyCodeLine{287       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{288       return}
\DoxyCodeLine{289 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{290     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{291       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{292       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Aten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{293       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{294       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{295       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{296       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{297       return}
\DoxyCodeLine{298 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{299 }
\DoxyCodeLine{300     \textcolor{keyword}{call }aten\_list\_checked\_cll(ta,tauv,masses2,rmax,taerr)}
\DoxyCodeLine{301 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a1af4cedf09121004ac928e984009b9f3}\label{namespacecollier__tensors_a1af4cedf09121004ac928e984009b9f3}} 
\index{collier\_tensors@{collier\_tensors}!aten\_main\_cll@{aten\_main\_cll}}
\index{aten\_main\_cll@{aten\_main\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{aten\_main\_cll()}{aten\_main\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::aten\+\_\+main\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TA,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Auv,  }\item[{double complex, dimension(0\+:0), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Aerr }\end{DoxyParamCaption})}



Definition at line 104 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{104 }
\DoxyCodeLine{105     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{106     \textcolor{keywordtype}{double complex},\textcolor{keywordtype}{intent(in)} :: masses2(0:0)}
\DoxyCodeLine{107     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TA(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{108     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TAuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{109     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TAerr(0:rmax)}
\DoxyCodeLine{110     \textcolor{keywordtype}{double complex} :: TA2(0:rmax,0:rmax,0:rmax,0:rmax), TAuv2(0:rmax,0:rmax,0:rmax,0:rmax)    }
\DoxyCodeLine{111     \textcolor{keywordtype}{double complex} :: CA(0:rmax/2), CAuv(0:rmax/2)}
\DoxyCodeLine{112     \textcolor{keywordtype}{double precision} :: CAerr(0:rmax),TAerr\_aux(0:rmax),TAerr\_aux2(0:rmax)}
\DoxyCodeLine{113     \textcolor{keywordtype}{double complex} :: args(1)    }
\DoxyCodeLine{114     \textcolor{keywordtype}{double precision} :: TAdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TAacc(0:rmax)}
\DoxyCodeLine{115     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3}
\DoxyCodeLine{116     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{117     }
\DoxyCodeLine{118     \textcolor{keywordflow}{if} (1.gt.nmax\_cll) then}
\DoxyCodeLine{119       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{120       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Aten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 1'},eflag,.true.)}
\DoxyCodeLine{121       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{122       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 1'}}
\DoxyCodeLine{123       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{124       return}
\DoxyCodeLine{125     \textcolor{keyword}{end }if}
\DoxyCodeLine{126     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{127       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{128       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Aten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{129       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{130       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{131       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{132       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{133       return}
\DoxyCodeLine{134 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{135 }
\DoxyCodeLine{136     args(1) = masses2(0)}
\DoxyCodeLine{137     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Aten\_cll'})}
\DoxyCodeLine{138     \textcolor{keyword}{call }setmastern\_cll(1)}
\DoxyCodeLine{139     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{140     \textcolor{keyword}{call }setmasterargs\_cll(1,args)}
\DoxyCodeLine{141 }
\DoxyCodeLine{142     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{143     }
\DoxyCodeLine{144     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{145       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{146       mode\_cll = 1}
\DoxyCodeLine{147       \textcolor{keyword}{call }a\_cll(ca,cauv,masses2(0),rmax,caerr,0)}
\DoxyCodeLine{148       \textcolor{keyword}{call }calctensora(ta,tauv,taerr\_aux,ca,cauv,caerr,rmax)         }
\DoxyCodeLine{149       }
\DoxyCodeLine{150       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{151       mode\_cll = 2}
\DoxyCodeLine{152       \textcolor{keyword}{call }a\_cll(ca,cauv,masses2(0),rmax,caerr,0)}
\DoxyCodeLine{153       \textcolor{keyword}{call }calctensora(ta2,tauv2,taerr\_aux2,ca,cauv,caerr,rmax)          }
\DoxyCodeLine{154       }
\DoxyCodeLine{155       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{156       mode\_cll = 3}
\DoxyCodeLine{157       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{158         norm\_coli=0d0}
\DoxyCodeLine{159         norm\_dd=0d0}
\DoxyCodeLine{160         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{161           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{162             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{163               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{164               norm\_coli = max(norm\_coli,abs(ta(n0,n1,n2,n3)))}
\DoxyCodeLine{165               norm\_dd = max(norm\_dd,abs(ta2(n0,n1,n2,n3)))}
\DoxyCodeLine{166             \textcolor{keyword}{end }do}
\DoxyCodeLine{167           \textcolor{keyword}{end }do}
\DoxyCodeLine{168         \textcolor{keyword}{end }do}
\DoxyCodeLine{169         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{170           norm\_coli = abs(masses2(0))}
\DoxyCodeLine{171           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{172             norm\_coli=norm\_coli**(1+real(r)/2)}
\DoxyCodeLine{173           else}
\DoxyCodeLine{174             norm\_coli=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{175           \textcolor{keyword}{end }if}
\DoxyCodeLine{176         \textcolor{keyword}{end }if}
\DoxyCodeLine{177         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{178           norm\_dd = abs(masses2(0))}
\DoxyCodeLine{179           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{180             norm\_dd=norm\_dd**(1+real(r)/2)}
\DoxyCodeLine{181           else}
\DoxyCodeLine{182             norm\_dd=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{183           \textcolor{keyword}{end }if}
\DoxyCodeLine{184         \textcolor{keyword}{end }if}
\DoxyCodeLine{185         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{186       \textcolor{keyword}{end }do}
\DoxyCodeLine{187       }
\DoxyCodeLine{188       \textcolor{keyword}{call }checktena\_cll(ta,ta2,masses2,norm,rmax,tadiff)}
\DoxyCodeLine{189       }
\DoxyCodeLine{190       \textcolor{keywordflow}{if} (taerr\_aux(rmax).lt.taerr\_aux2(rmax)) then}
\DoxyCodeLine{191         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr))  taerr = max(taerr\_aux,tadiff*norm)}
\DoxyCodeLine{192         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{193           taacc(r) = max(taerr\_aux(r)/norm(r),tadiff(r))}
\DoxyCodeLine{194         \textcolor{keyword}{end }do}
\DoxyCodeLine{195         \textcolor{keywordflow}{if} (monitoring) pointscntaten\_coli =  pointscntaten\_coli + 1}
\DoxyCodeLine{196       else}
\DoxyCodeLine{197         ta = ta2}
\DoxyCodeLine{198         tauv = tauv2        }
\DoxyCodeLine{199         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr))  taerr = max(taerr\_aux2,tadiff*norm)    }
\DoxyCodeLine{200         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{201           taacc(r) = max(taerr\_aux2(r)/norm(r),tadiff(r))}
\DoxyCodeLine{202 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{203         \textcolor{keywordflow}{if} (monitoring) pointscntaten\_dd =  pointscntaten\_dd + 1}
\DoxyCodeLine{204 \textcolor{keywordflow}{      end if}       }
\DoxyCodeLine{205     }
\DoxyCodeLine{206     else}
\DoxyCodeLine{207       \textcolor{keyword}{call }a\_cll(ca,cauv,masses2(0),rmax,caerr,0)}
\DoxyCodeLine{208       \textcolor{keyword}{call }calctensora(ta,tauv,taerr\_aux,ca,cauv,caerr,rmax)}
\DoxyCodeLine{209       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr)) taerr = taerr\_aux}
\DoxyCodeLine{210       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{211         norm(r)=0d0}
\DoxyCodeLine{212         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{213           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{214             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{215               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{216               norm(r) = max(norm(r),abs(ta(n0,n1,n2,n3)))}
\DoxyCodeLine{217             \textcolor{keyword}{end }do}
\DoxyCodeLine{218           \textcolor{keyword}{end }do}
\DoxyCodeLine{219         \textcolor{keyword}{end }do}
\DoxyCodeLine{220         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{221           norm(r) = abs(masses2(0))}
\DoxyCodeLine{222           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{223             norm(r)=norm(r)**(1+real(r)/2)}
\DoxyCodeLine{224           else}
\DoxyCodeLine{225             norm(r)=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{226           \textcolor{keyword}{end }if}
\DoxyCodeLine{227         \textcolor{keyword}{end }if}
\DoxyCodeLine{228       \textcolor{keyword}{end }do}
\DoxyCodeLine{229       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{230         taacc(r) = taerr\_aux(r)/norm(r)}
\DoxyCodeLine{231       \textcolor{keyword}{end }do}
\DoxyCodeLine{232       }
\DoxyCodeLine{233     \textcolor{keyword}{end }if}
\DoxyCodeLine{234 }
\DoxyCodeLine{235     \textcolor{keyword}{call }propagateaccflag\_cll(taacc,rmax)}
\DoxyCodeLine{236     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{237 }
\DoxyCodeLine{238     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{239       pointscntaten\_cll =  pointscntaten\_cll + 1}
\DoxyCodeLine{240 }
\DoxyCodeLine{241       \textcolor{keywordflow}{if}(maxval(taacc).gt.reqacc\_cll) accpointscntaten\_cll = accpointscntaten\_cll + 1}
\DoxyCodeLine{242 }
\DoxyCodeLine{243       \textcolor{keywordflow}{if}(maxval(taacc).gt.critacc\_cll) then}
\DoxyCodeLine{244         critpointscntaten\_cll =  critpointscntaten\_cll + 1}
\DoxyCodeLine{245         \textcolor{keywordflow}{if} ( critpointscntaten\_cll.le.noutcritpointsmax\_cll(1) ) then}
\DoxyCodeLine{246           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TAten\_cll'},0,maxval(taacc),critpointscntaten\_cll)}
\DoxyCodeLine{247           \textcolor{keywordflow}{if}( critpointscntaten\_cll.eq.noutcritpointsmax\_cll(1)) then}
\DoxyCodeLine{248             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TAten\_cll suppressed'}   }
\DoxyCodeLine{249             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{250           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{251 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{252 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TAten\_cll'},0,maxval(taacc),critpointscntaten\_cll)}
\DoxyCodeLine{253           \textcolor{keywordflow}{if}( critpointscntaten\_cll.eq.noutcritpointsmax\_cll(1)) then}
\DoxyCodeLine{254             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TAten\_cll suppressed'}   }
\DoxyCodeLine{255             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{256           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{257 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{258 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{259       \textcolor{keyword}{end }if}
\DoxyCodeLine{260     \textcolor{keyword}{end }if}
\DoxyCodeLine{261 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_acb7a69654449f75ed1825598a57ca037}\label{namespacecollier__tensors_acb7a69654449f75ed1825598a57ca037}} 
\index{collier\_tensors@{collier\_tensors}!bten\_args\_cll@{bten\_args\_cll}}
\index{bten\_args\_cll@{bten\_args\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{bten\_args\_cll()}{bten\_args\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::bten\+\_\+args\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TB,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Buv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Berr }\end{DoxyParamCaption})}



Definition at line 1136 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1136   }
\DoxyCodeLine{1137     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{1138     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3)}
\DoxyCodeLine{1139     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,m02,m12}
\DoxyCodeLine{1140     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TB(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{1141     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TBuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{1142     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TBerr(0:rmax)}
\DoxyCodeLine{1143     \textcolor{keywordtype}{double complex} :: TB2(0:rmax,0:rmax,0:rmax,0:rmax), TBuv2(0:rmax,0:rmax,0:rmax,0:rmax)    }
\DoxyCodeLine{1144     \textcolor{keywordtype}{double complex} :: masses2(0:1),MomInv(1)}
\DoxyCodeLine{1145     \textcolor{keywordtype}{double complex} :: CB(0:rmax/2,0:rmax), CBuv(0:rmax/2,0:rmax)}
\DoxyCodeLine{1146     \textcolor{keywordtype}{double precision} :: CBerr(0:rmax),TBerr\_aux(0:rmax),TBerr\_aux2(0:rmax)}
\DoxyCodeLine{1147     \textcolor{keywordtype}{double complex} :: args(7)}
\DoxyCodeLine{1148     \textcolor{keywordtype}{double precision} :: TBdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TBacc(0:rmax)}
\DoxyCodeLine{1149     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3    }
\DoxyCodeLine{1150     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{1151 }
\DoxyCodeLine{1152     \textcolor{keywordflow}{if} (2.gt.nmax\_cll) then}
\DoxyCodeLine{1153       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{1154       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Bten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 2'},eflag,.true.)}
\DoxyCodeLine{1155       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{1156       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 2'}}
\DoxyCodeLine{1157       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{1158       return}
\DoxyCodeLine{1159 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{1160     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{1161       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{1162       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Bten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{1163       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{1164       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{1165       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{1166       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{1167       return}
\DoxyCodeLine{1168 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{1169 }
\DoxyCodeLine{1170     masses2(0) = m02}
\DoxyCodeLine{1171     masses2(1) = m12}
\DoxyCodeLine{1172     mominv(1) = p10}
\DoxyCodeLine{1173 }
\DoxyCodeLine{1174     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{1175     args(1:4) = p1vec(0:)}
\DoxyCodeLine{1176     args(5) = p10}
\DoxyCodeLine{1177     args(6:7) = masses2(0:)}
\DoxyCodeLine{1178     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Bten\_cll'})}
\DoxyCodeLine{1179     \textcolor{keyword}{call }setmastern\_cll(2)}
\DoxyCodeLine{1180     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{1181     \textcolor{keyword}{call }setmasterargs\_cll(7,args)}
\DoxyCodeLine{1182 }
\DoxyCodeLine{1183     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{1184     }
\DoxyCodeLine{1185     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{1186       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{1187       mode\_cll = 1}
\DoxyCodeLine{1188       \textcolor{keyword}{call }b\_main\_cll(cb,cbuv,p10,m02,m12,rmax,cberr,0)}
\DoxyCodeLine{1189       \textcolor{keyword}{call }calctensorb(tb,tbuv,tberr\_aux,cb,cbuv,cberr,p1vec,rmax)      }
\DoxyCodeLine{1190       }
\DoxyCodeLine{1191       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{1192       mode\_cll = 2}
\DoxyCodeLine{1193       \textcolor{keyword}{call }b\_main\_cll(cb,cbuv,p10,m02,m12,rmax,cberr,0)}
\DoxyCodeLine{1194       \textcolor{keyword}{call }calctensorb(tb2,tbuv2,tberr\_aux2,cb,cbuv,cberr,p1vec,rmax)     }
\DoxyCodeLine{1195       }
\DoxyCodeLine{1196       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{1197       mode\_cll = 3}
\DoxyCodeLine{1198       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1199         norm\_coli=0d0}
\DoxyCodeLine{1200         norm\_dd=0d0}
\DoxyCodeLine{1201         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{1202           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{1203             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{1204               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{1205               norm\_coli = max(norm\_coli,abs(tb(n0,n1,n2,n3)))}
\DoxyCodeLine{1206               norm\_dd = max(norm\_dd,abs(tb2(n0,n1,n2,n3)))}
\DoxyCodeLine{1207             \textcolor{keyword}{end }do}
\DoxyCodeLine{1208           \textcolor{keyword}{end }do}
\DoxyCodeLine{1209         \textcolor{keyword}{end }do}
\DoxyCodeLine{1210         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{1211           norm\_coli = max(abs(mominv(1)),maxval(abs(masses2(0:1))))}
\DoxyCodeLine{1212           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{1213             norm\_coli=norm\_coli**(real(r)/2)}
\DoxyCodeLine{1214           else}
\DoxyCodeLine{1215             norm\_coli=muir2\_cll**(real(r)/2)}
\DoxyCodeLine{1216           \textcolor{keyword}{end }if}
\DoxyCodeLine{1217         \textcolor{keyword}{end }if}
\DoxyCodeLine{1218         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{1219           norm\_dd = max(abs(mominv(1)),maxval(abs(masses2(0:1))))}
\DoxyCodeLine{1220           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{1221             norm\_dd=norm\_dd**(real(r)/2)}
\DoxyCodeLine{1222           else}
\DoxyCodeLine{1223             norm\_dd=muir2\_cll**(real(r)/2)}
\DoxyCodeLine{1224           \textcolor{keyword}{end }if}
\DoxyCodeLine{1225         \textcolor{keyword}{end }if}
\DoxyCodeLine{1226         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{1227       \textcolor{keyword}{end }do}
\DoxyCodeLine{1228       }
\DoxyCodeLine{1229       \textcolor{keyword}{call }checktensors\_cll(tb,tb2,p1vec,mominv,masses2,norm,2,rmax,tbdiff)}
\DoxyCodeLine{1230       }
\DoxyCodeLine{1231       \textcolor{keywordflow}{if} (tberr\_aux(rmax).lt.tberr\_aux2(rmax)) then}
\DoxyCodeLine{1232         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tberr))  tberr = max(tberr\_aux,tbdiff*norm)}
\DoxyCodeLine{1233         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1234           tbacc(r) = max(tberr\_aux(r)/norm(r),tbdiff(r))}
\DoxyCodeLine{1235         \textcolor{keyword}{end }do}
\DoxyCodeLine{1236         \textcolor{keywordflow}{if} (monitoring) pointscntbten\_coli =  pointscntbten\_coli + 1}
\DoxyCodeLine{1237       else}
\DoxyCodeLine{1238         tb = tb2}
\DoxyCodeLine{1239         tbuv = tbuv2        }
\DoxyCodeLine{1240         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tberr))  tberr = max(tberr\_aux2,tbdiff*norm)    }
\DoxyCodeLine{1241         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1242           tbacc(r) = max(tberr\_aux2(r)/norm(r),tbdiff(r))}
\DoxyCodeLine{1243 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{1244         \textcolor{keywordflow}{if} (monitoring) pointscntbten\_dd =  pointscntbten\_dd + 1}
\DoxyCodeLine{1245       \textcolor{keyword}{end }if}
\DoxyCodeLine{1246       }
\DoxyCodeLine{1247     else}
\DoxyCodeLine{1248       \textcolor{keyword}{call }b\_main\_cll(cb,cbuv,p10,m02,m12,rmax,cberr,0)}
\DoxyCodeLine{1249       \textcolor{keyword}{call }calctensorb(tb,tbuv,tberr\_aux,cb,cbuv,cberr,p1vec,rmax)}
\DoxyCodeLine{1250       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tberr))  tberr = tberr\_aux}
\DoxyCodeLine{1251       norm = 0d0}
\DoxyCodeLine{1252       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1253         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{1254           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{1255             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{1256               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{1257               norm(r) = max(norm(r),abs(tb(n0,n1,n2,n3)))}
\DoxyCodeLine{1258             \textcolor{keyword}{end }do}
\DoxyCodeLine{1259           \textcolor{keyword}{end }do}
\DoxyCodeLine{1260 \textcolor{keywordflow}{        end do}       }
\DoxyCodeLine{1261         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{1262           norm(r) = max(abs(mominv(1)),maxval(abs(masses2(0:1))))}
\DoxyCodeLine{1263           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{1264             norm(r)=norm(r)**(real(r)/2)}
\DoxyCodeLine{1265           else}
\DoxyCodeLine{1266             norm(r)=muir2\_cll**(real(r)/2)}
\DoxyCodeLine{1267           \textcolor{keyword}{end }if}
\DoxyCodeLine{1268         \textcolor{keyword}{end }if}
\DoxyCodeLine{1269         tbacc(r) = tberr\_aux(r)/norm(r)}
\DoxyCodeLine{1270 \textcolor{keywordflow}{      end do}     }
\DoxyCodeLine{1271       }
\DoxyCodeLine{1272     \textcolor{keyword}{end }if}
\DoxyCodeLine{1273 }
\DoxyCodeLine{1274     \textcolor{keyword}{call }propagateaccflag\_cll(tbacc,rmax)}
\DoxyCodeLine{1275     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{1276 }
\DoxyCodeLine{1277     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{1278       pointscntbten\_cll =  pointscntbten\_cll + 1}
\DoxyCodeLine{1279 }
\DoxyCodeLine{1280       \textcolor{keywordflow}{if}(maxval(tbacc).gt.reqacc\_cll) accpointscntbten\_cll = accpointscntbten\_cll + 1}
\DoxyCodeLine{1281 }
\DoxyCodeLine{1282       \textcolor{keywordflow}{if}(maxval(tbacc).gt.critacc\_cll) then}
\DoxyCodeLine{1283         critpointscntbten\_cll =  critpointscntbten\_cll + 1}
\DoxyCodeLine{1284         \textcolor{keywordflow}{if} ( critpointscntbten\_cll.le.noutcritpointsmax\_cll(2) ) then}
\DoxyCodeLine{1285           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TBten\_cll'},0,maxval(tbacc),critpointscntbten\_cll)}
\DoxyCodeLine{1286           \textcolor{keywordflow}{if}( critpointscntbten\_cll.eq.noutcritpointsmax\_cll(2)) then}
\DoxyCodeLine{1287             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TBten\_cll suppressed'}   }
\DoxyCodeLine{1288             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{1289           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{1290 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{1291 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TBten\_cll'},0,maxval(tbacc),critpointscntbten\_cll)}
\DoxyCodeLine{1292           \textcolor{keywordflow}{if}( critpointscntbten\_cll.eq.noutcritpointsmax\_cll(2)) then}
\DoxyCodeLine{1293             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TBten\_cll suppressed'}   }
\DoxyCodeLine{1294             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{1295           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{1296 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1297 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{1298       \textcolor{keyword}{end }if}
\DoxyCodeLine{1299     \textcolor{keyword}{end }if}
\DoxyCodeLine{1300 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a2e7cccc59777f264cbc7bf680bc64f46}\label{namespacecollier__tensors_a2e7cccc59777f264cbc7bf680bc64f46}} 
\index{collier\_tensors@{collier\_tensors}!bten\_args\_list\_checked\_cll@{bten\_args\_list\_checked\_cll}}
\index{bten\_args\_list\_checked\_cll@{bten\_args\_list\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{bten\_args\_list\_checked\_cll()}{bten\_args\_list\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::bten\+\_\+args\+\_\+list\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TB,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Buv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Berr }\end{DoxyParamCaption})}



Definition at line 1346 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1346   }
\DoxyCodeLine{1347     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{1348     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3)}
\DoxyCodeLine{1349     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,m02,m12}
\DoxyCodeLine{1350     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TB(RtS(rmax)), TBuv(RtS(rmax))}
\DoxyCodeLine{1351     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TBerr(0:rmax)}
\DoxyCodeLine{1352     \textcolor{keywordtype}{double complex} :: TB2(RtS(rmax)), TBuv2(RtS(rmax))    }
\DoxyCodeLine{1353     \textcolor{keywordtype}{double complex} :: masses2(0:1),MomInv(1)}
\DoxyCodeLine{1354     \textcolor{keywordtype}{double complex} :: CB(0:rmax/2,0:rmax), CBuv(0:rmax/2,0:rmax)}
\DoxyCodeLine{1355     \textcolor{keywordtype}{double precision} :: CBerr(0:rmax), TBerr\_aux(0:rmax), TBerr\_aux2(0:rmax)}
\DoxyCodeLine{1356     \textcolor{keywordtype}{double complex} :: args(7)}
\DoxyCodeLine{1357     \textcolor{keywordtype}{double precision} :: TBdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TBacc(0:rmax)}
\DoxyCodeLine{1358     \textcolor{keywordtype}{integer} :: r,i    }
\DoxyCodeLine{1359     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{1360 }
\DoxyCodeLine{1361     masses2(0) = m02}
\DoxyCodeLine{1362     masses2(1) = m12}
\DoxyCodeLine{1363     mominv(1) = p10}
\DoxyCodeLine{1364 }
\DoxyCodeLine{1365     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{1366     args(1:4) = p1vec(0:)}
\DoxyCodeLine{1367     args(5) = p10}
\DoxyCodeLine{1368     args(6:7) = masses2(0:)}
\DoxyCodeLine{1369     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Bten\_cll'})}
\DoxyCodeLine{1370     \textcolor{keyword}{call }setmastern\_cll(2)}
\DoxyCodeLine{1371     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{1372     \textcolor{keyword}{call }setmasterargs\_cll(7,args)}
\DoxyCodeLine{1373 }
\DoxyCodeLine{1374     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{1375     }
\DoxyCodeLine{1376     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{1377       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{1378       mode\_cll = 1}
\DoxyCodeLine{1379       \textcolor{keyword}{call }b\_main\_cll(cb,cbuv,p10,m02,m12,rmax,cberr,0)}
\DoxyCodeLine{1380       \textcolor{keyword}{call }calctensorb\_list(tb,tbuv,tberr\_aux,cb,cbuv,cberr,p1vec,rmax)      }
\DoxyCodeLine{1381       }
\DoxyCodeLine{1382       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{1383       mode\_cll = 2}
\DoxyCodeLine{1384       \textcolor{keyword}{call }b\_main\_cll(cb,cbuv,p10,m02,m12,rmax,cberr,0)}
\DoxyCodeLine{1385       \textcolor{keyword}{call }calctensorb\_list(tb2,tbuv2,tberr\_aux2,cb,cbuv,cberr,p1vec,rmax)     }
\DoxyCodeLine{1386       }
\DoxyCodeLine{1387       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{1388       mode\_cll = 3}
\DoxyCodeLine{1389       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1390         norm\_coli=0d0}
\DoxyCodeLine{1391         norm\_dd=0d0}
\DoxyCodeLine{1392         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{1393           norm\_coli = max(norm\_coli,abs(tb(i)))}
\DoxyCodeLine{1394           norm\_dd = max(norm\_dd,abs(tb2(i)))}
\DoxyCodeLine{1395         \textcolor{keyword}{end }do}
\DoxyCodeLine{1396         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{1397           norm\_coli = max(abs(mominv(1)),maxval(abs(masses2(0:1))))}
\DoxyCodeLine{1398           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{1399             norm\_coli=norm\_coli**(real(r)/2)}
\DoxyCodeLine{1400           else}
\DoxyCodeLine{1401             norm\_coli=muir2\_cll**(real(r)/2)}
\DoxyCodeLine{1402           \textcolor{keyword}{end }if}
\DoxyCodeLine{1403         \textcolor{keyword}{end }if}
\DoxyCodeLine{1404         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{1405           norm\_dd = max(abs(mominv(1)),maxval(abs(masses2(0:1))))}
\DoxyCodeLine{1406           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{1407             norm\_dd=norm\_dd**(real(r)/2)}
\DoxyCodeLine{1408           else}
\DoxyCodeLine{1409             norm\_dd=muir2\_cll**(real(r)/2)}
\DoxyCodeLine{1410           \textcolor{keyword}{end }if}
\DoxyCodeLine{1411         \textcolor{keyword}{end }if}
\DoxyCodeLine{1412         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{1413       \textcolor{keyword}{end }do}
\DoxyCodeLine{1414       }
\DoxyCodeLine{1415       \textcolor{keyword}{call }checktensorslist\_cll(tb,tb2,p1vec,mominv,masses2,norm,2,rmax,tbdiff)      }
\DoxyCodeLine{1416       }
\DoxyCodeLine{1417       \textcolor{keywordflow}{if} (tberr\_aux(rmax).lt.tberr\_aux2(rmax)) then}
\DoxyCodeLine{1418         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tberr))  tberr = max(tberr\_aux,tbdiff*norm)}
\DoxyCodeLine{1419         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1420           tbacc(r) = max(tberr\_aux(r)/norm(r),tbdiff(r))}
\DoxyCodeLine{1421         \textcolor{keyword}{end }do}
\DoxyCodeLine{1422         \textcolor{keywordflow}{if} (monitoring) pointscntbten\_coli =  pointscntbten\_coli + 1}
\DoxyCodeLine{1423       else}
\DoxyCodeLine{1424         tb = tb2}
\DoxyCodeLine{1425         tbuv = tbuv2        }
\DoxyCodeLine{1426         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tberr))  tberr = max(tberr\_aux2,tbdiff*norm)    }
\DoxyCodeLine{1427         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1428           tbacc(r) = max(tberr\_aux2(r)/norm(r),tbdiff(r))}
\DoxyCodeLine{1429 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{1430         \textcolor{keywordflow}{if} (monitoring) pointscntbten\_dd =  pointscntbten\_dd + 1}
\DoxyCodeLine{1431       \textcolor{keyword}{end }if}
\DoxyCodeLine{1432       }
\DoxyCodeLine{1433     else}
\DoxyCodeLine{1434       \textcolor{keyword}{call }b\_main\_cll(cb,cbuv,p10,m02,m12,rmax,cberr,0)}
\DoxyCodeLine{1435       \textcolor{keyword}{call }calctensorb\_list(tb,tbuv,tberr\_aux,cb,cbuv,cberr,p1vec,rmax)}
\DoxyCodeLine{1436       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tberr))  tberr = tberr\_aux}
\DoxyCodeLine{1437       norm = 0d0}
\DoxyCodeLine{1438       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1439         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{1440           norm(r) = max(norm(r),abs(tb(i)))      }
\DoxyCodeLine{1441 \textcolor{keywordflow}{        end do}            }
\DoxyCodeLine{1442         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{1443           norm(r) = max(abs(mominv(1)),maxval(abs(masses2(0:1))))}
\DoxyCodeLine{1444           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{1445             norm(r)=norm(r)**(real(r)/2)}
\DoxyCodeLine{1446           else}
\DoxyCodeLine{1447             norm(r)=muir2\_cll**(real(r)/2)}
\DoxyCodeLine{1448           \textcolor{keyword}{end }if}
\DoxyCodeLine{1449         \textcolor{keyword}{end }if}
\DoxyCodeLine{1450         tbacc(r) = tberr\_aux(r)/norm(r)}
\DoxyCodeLine{1451 \textcolor{keywordflow}{      end do}      }
\DoxyCodeLine{1452       }
\DoxyCodeLine{1453     \textcolor{keyword}{end }if}
\DoxyCodeLine{1454 }
\DoxyCodeLine{1455     \textcolor{keyword}{call }propagateaccflag\_cll(tbacc,rmax)}
\DoxyCodeLine{1456     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{1457 }
\DoxyCodeLine{1458     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{1459       pointscntbten\_cll =  pointscntbten\_cll + 1}
\DoxyCodeLine{1460 }
\DoxyCodeLine{1461       \textcolor{keywordflow}{if}(maxval(tbacc).gt.reqacc\_cll) accpointscntbten\_cll = accpointscntbten\_cll + 1}
\DoxyCodeLine{1462 }
\DoxyCodeLine{1463       \textcolor{keywordflow}{if}(maxval(tbacc).gt.critacc\_cll) then}
\DoxyCodeLine{1464         critpointscntbten\_cll =  critpointscntbten\_cll + 1}
\DoxyCodeLine{1465         \textcolor{keywordflow}{if} ( critpointscntbten\_cll.le.noutcritpointsmax\_cll(2) ) then}
\DoxyCodeLine{1466           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TBten\_cll'},0,maxval(tbacc),critpointscntbten\_cll)}
\DoxyCodeLine{1467           \textcolor{keywordflow}{if}( critpointscntbten\_cll.eq.noutcritpointsmax\_cll(2)) then}
\DoxyCodeLine{1468             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TBten\_cll suppressed'}   }
\DoxyCodeLine{1469             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{1470           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{1471 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{1472 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TBten\_cll'},0,maxval(tbacc),critpointscntbten\_cll)}
\DoxyCodeLine{1473           \textcolor{keywordflow}{if}( critpointscntbten\_cll.eq.noutcritpointsmax\_cll(2)) then}
\DoxyCodeLine{1474             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TBten\_cll suppressed'}   }
\DoxyCodeLine{1475             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{1476           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{1477 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1478 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{1479       \textcolor{keyword}{end }if}
\DoxyCodeLine{1480     \textcolor{keyword}{end }if}
\DoxyCodeLine{1481 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a1fa67597c7dd758e852a1f6dca390219}\label{namespacecollier__tensors_a1fa67597c7dd758e852a1f6dca390219}} 
\index{collier\_tensors@{collier\_tensors}!bten\_args\_list\_cll@{bten\_args\_list\_cll}}
\index{bten\_args\_list\_cll@{bten\_args\_list\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{bten\_args\_list\_cll()}{bten\_args\_list\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::bten\+\_\+args\+\_\+list\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:), intent(out)}]{TB,  }\item[{double complex, dimension(\+:), intent(out)}]{T\+Buv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Berr }\end{DoxyParamCaption})}



Definition at line 1313 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1313   }
\DoxyCodeLine{1314     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{1315     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3)}
\DoxyCodeLine{1316     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,m02,m12}
\DoxyCodeLine{1317     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TB(:), TBuv(:)}
\DoxyCodeLine{1318     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TBerr(0:rmax)}
\DoxyCodeLine{1319     \textcolor{keywordtype}{integer} :: r,i    }
\DoxyCodeLine{1320     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{1321 }
\DoxyCodeLine{1322     \textcolor{keywordflow}{if} (2.gt.nmax\_cll) then}
\DoxyCodeLine{1323       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{1324       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Bten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 2'},eflag,.true.)}
\DoxyCodeLine{1325       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{1326       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 2'}}
\DoxyCodeLine{1327       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{1328       return}
\DoxyCodeLine{1329 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{1330     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{1331       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{1332       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Bten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{1333       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{1334       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{1335       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{1336       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{1337       return}
\DoxyCodeLine{1338 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{1339 }
\DoxyCodeLine{1340     \textcolor{keyword}{call }bten\_args\_list\_checked\_cll(tb,tbuv,p1vec,p10,m02,m12,rmax,tberr)}
\DoxyCodeLine{1341   }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a2adee9ff44acc7e12679cb45d9c905fa}\label{namespacecollier__tensors_a2adee9ff44acc7e12679cb45d9c905fa}} 
\index{collier\_tensors@{collier\_tensors}!bten\_list\_checked\_cll@{bten\_list\_checked\_cll}}
\index{bten\_list\_checked\_cll@{bten\_list\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{bten\_list\_checked\_cll()}{bten\_list\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::bten\+\_\+list\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TB,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Buv,  }\item[{double complex, dimension(0\+:3,1), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(1), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:1), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Berr }\end{DoxyParamCaption})}



Definition at line 994 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{994 }
\DoxyCodeLine{995     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{996     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,1), MomInv(1), masses2(0:1)}
\DoxyCodeLine{997     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TB(RtS(rmax)), TBuv(RtS(rmax))}
\DoxyCodeLine{998     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TBerr(0:rmax)}
\DoxyCodeLine{999     \textcolor{keywordtype}{double complex} :: TB2(RtS(rmax)), TBuv2(RtS(rmax))    }
\DoxyCodeLine{1000     \textcolor{keywordtype}{double complex} :: CB(0:rmax/2,0:rmax), CBuv(0:rmax/2,0:rmax)}
\DoxyCodeLine{1001     \textcolor{keywordtype}{double precision} :: CBerr(0:rmax), TBerr\_aux(0:rmax), TBerr\_aux2(0:rmax) }
\DoxyCodeLine{1002     \textcolor{keywordtype}{double complex} :: args(7)}
\DoxyCodeLine{1003     \textcolor{keywordtype}{double precision} :: TBdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TBacc(0:rmax)}
\DoxyCodeLine{1004     \textcolor{keywordtype}{integer} :: r,i    }
\DoxyCodeLine{1005     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{1006 }
\DoxyCodeLine{1007     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{1008     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{1009     args(5) = mominv(1)}
\DoxyCodeLine{1010     args(6:7) = masses2(0:)}
\DoxyCodeLine{1011     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Bten\_cll'})}
\DoxyCodeLine{1012     \textcolor{keyword}{call }setmastern\_cll(2)}
\DoxyCodeLine{1013     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{1014     \textcolor{keyword}{call }setmasterargs\_cll(7,args)}
\DoxyCodeLine{1015 }
\DoxyCodeLine{1016     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{1017     }
\DoxyCodeLine{1018     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{1019       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{1020       mode\_cll = 1}
\DoxyCodeLine{1021       \textcolor{keyword}{call }b\_main\_cll(cb,cbuv,mominv(1),masses2(0),masses2(1),rmax,cberr,0)}
\DoxyCodeLine{1022       \textcolor{keyword}{call }calctensorb\_list(tb,tbuv,tberr\_aux,cb,cbuv,cberr,momvec(0:,1),rmax)      }
\DoxyCodeLine{1023       }
\DoxyCodeLine{1024       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{1025       mode\_cll = 2}
\DoxyCodeLine{1026       \textcolor{keyword}{call }b\_main\_cll(cb,cbuv,mominv(1),masses2(0),masses2(1),rmax,cberr,0)}
\DoxyCodeLine{1027       \textcolor{keyword}{call }calctensorb\_list(tb2,tbuv2,tberr\_aux2,cb,cbuv,cberr,momvec(0:,1),rmax)     }
\DoxyCodeLine{1028       }
\DoxyCodeLine{1029       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{1030       mode\_cll = 3}
\DoxyCodeLine{1031       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1032         norm\_coli=0d0}
\DoxyCodeLine{1033         norm\_dd=0d0}
\DoxyCodeLine{1034         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{1035           norm\_coli = max(norm\_coli,abs(tb(i)))}
\DoxyCodeLine{1036           norm\_dd = max(norm\_dd,abs(tb2(i)))}
\DoxyCodeLine{1037         \textcolor{keyword}{end }do}
\DoxyCodeLine{1038         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{1039           norm\_coli = max(abs(mominv(1)),maxval(abs(masses2(0:1))))}
\DoxyCodeLine{1040           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{1041             norm\_coli=norm\_coli**(real(r)/2)}
\DoxyCodeLine{1042           else}
\DoxyCodeLine{1043             norm\_coli=muir2\_cll**(real(r)/2)}
\DoxyCodeLine{1044           \textcolor{keyword}{end }if}
\DoxyCodeLine{1045         \textcolor{keyword}{end }if}
\DoxyCodeLine{1046         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{1047           norm\_dd = max(abs(mominv(1)),maxval(abs(masses2(0:1))))}
\DoxyCodeLine{1048           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{1049             norm\_dd=norm\_dd**(real(r)/2)}
\DoxyCodeLine{1050           else}
\DoxyCodeLine{1051             norm\_dd=muir2\_cll**(real(r)/2)}
\DoxyCodeLine{1052           \textcolor{keyword}{end }if}
\DoxyCodeLine{1053         \textcolor{keyword}{end }if}
\DoxyCodeLine{1054         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{1055       \textcolor{keyword}{end }do}
\DoxyCodeLine{1056       }
\DoxyCodeLine{1057       \textcolor{keyword}{call }checktensorslist\_cll(tb,tb2,momvec,mominv,masses2,norm,2,rmax,tbdiff)}
\DoxyCodeLine{1058       }
\DoxyCodeLine{1059       \textcolor{keywordflow}{if} (tberr\_aux(rmax).lt.tberr\_aux2(rmax)) then}
\DoxyCodeLine{1060         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tberr))  tberr = max(tberr\_aux,tbdiff*norm)}
\DoxyCodeLine{1061         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1062           tbacc(r) = max(tberr\_aux(r)/norm(r),tbdiff(r))}
\DoxyCodeLine{1063         \textcolor{keyword}{end }do}
\DoxyCodeLine{1064         \textcolor{keywordflow}{if} (monitoring) pointscntbten\_coli =  pointscntbten\_coli + 1}
\DoxyCodeLine{1065       else}
\DoxyCodeLine{1066         tb = tb2}
\DoxyCodeLine{1067         tbuv = tbuv2        }
\DoxyCodeLine{1068         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tberr))  tberr = max(tberr\_aux2,tbdiff*norm)    }
\DoxyCodeLine{1069         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1070           tbacc(r) = max(tberr\_aux2(r)/norm(r),tbdiff(r))}
\DoxyCodeLine{1071 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{1072         \textcolor{keywordflow}{if} (monitoring) pointscntbten\_dd =  pointscntbten\_dd + 1}
\DoxyCodeLine{1073 \textcolor{keywordflow}{      end if}      }
\DoxyCodeLine{1074     }
\DoxyCodeLine{1075     else}
\DoxyCodeLine{1076       \textcolor{keyword}{call }b\_main\_cll(cb,cbuv,mominv(1),masses2(0),masses2(1),rmax,cberr,0)    }
\DoxyCodeLine{1077       \textcolor{keyword}{call }calctensorb\_list(tb,tbuv,tberr\_aux,cb,cbuv,cberr,momvec(0:,1),rmax)}
\DoxyCodeLine{1078       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tberr))  tberr = tberr\_aux}
\DoxyCodeLine{1079       norm = 0d0}
\DoxyCodeLine{1080       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1081         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{1082           norm(r) = max(norm(r),abs(tb(i)))      }
\DoxyCodeLine{1083 \textcolor{keywordflow}{        end do}             }
\DoxyCodeLine{1084         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{1085           norm(r) = max(abs(mominv(1)),maxval(abs(masses2(0:1))))}
\DoxyCodeLine{1086           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{1087             norm(r)=norm(r)**(real(r)/2)}
\DoxyCodeLine{1088           else}
\DoxyCodeLine{1089             norm(r)=muir2\_cll**(real(r)/2)}
\DoxyCodeLine{1090           \textcolor{keyword}{end }if}
\DoxyCodeLine{1091         \textcolor{keyword}{end }if}
\DoxyCodeLine{1092         tbacc(r) = tberr\_aux(r)/norm(r)}
\DoxyCodeLine{1093 \textcolor{keywordflow}{      end do}     }
\DoxyCodeLine{1094       }
\DoxyCodeLine{1095     \textcolor{keyword}{end }if}
\DoxyCodeLine{1096 }
\DoxyCodeLine{1097     \textcolor{keyword}{call }propagateaccflag\_cll(tbacc,rmax)}
\DoxyCodeLine{1098     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{1099 }
\DoxyCodeLine{1100     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{1101       pointscntbten\_cll =  pointscntbten\_cll + 1}
\DoxyCodeLine{1102 }
\DoxyCodeLine{1103       \textcolor{keywordflow}{if}(maxval(tbacc).gt.reqacc\_cll) accpointscntbten\_cll = accpointscntbten\_cll + 1}
\DoxyCodeLine{1104 }
\DoxyCodeLine{1105       \textcolor{keywordflow}{if}(maxval(tbacc).gt.critacc\_cll) then}
\DoxyCodeLine{1106         critpointscntbten\_cll =  critpointscntbten\_cll + 1}
\DoxyCodeLine{1107         \textcolor{keywordflow}{if} ( critpointscntbten\_cll.le.noutcritpointsmax\_cll(2) ) then}
\DoxyCodeLine{1108           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TBten\_cll'},0,maxval(tbacc),critpointscntbten\_cll)}
\DoxyCodeLine{1109           \textcolor{keywordflow}{if}( critpointscntbten\_cll.eq.noutcritpointsmax\_cll(2)) then}
\DoxyCodeLine{1110             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TBten\_cll suppressed'}   }
\DoxyCodeLine{1111             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{1112           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{1113 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{1114 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TBten\_cll'},0,maxval(tbacc),critpointscntbten\_cll)}
\DoxyCodeLine{1115           \textcolor{keywordflow}{if}( critpointscntbten\_cll.eq.noutcritpointsmax\_cll(2)) then}
\DoxyCodeLine{1116             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TBten\_cll suppressed'}   }
\DoxyCodeLine{1117             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{1118           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{1119 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1120 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{1121       \textcolor{keyword}{end }if}
\DoxyCodeLine{1122     \textcolor{keyword}{end }if}
\DoxyCodeLine{1123 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a28332030a1671a6ed8a500ebe83b9657}\label{namespacecollier__tensors_a28332030a1671a6ed8a500ebe83b9657}} 
\index{collier\_tensors@{collier\_tensors}!bten\_list\_cll@{bten\_list\_cll}}
\index{bten\_list\_cll@{bten\_list\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{bten\_list\_cll()}{bten\_list\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::bten\+\_\+list\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:), intent(out)}]{TB,  }\item[{double complex, dimension(\+:), intent(out)}]{T\+Buv,  }\item[{double complex, dimension(0\+:3,1), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(1), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:1), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Berr }\end{DoxyParamCaption})}



Definition at line 962 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{962 }
\DoxyCodeLine{963     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{964     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,1), MomInv(1), masses2(0:1)}
\DoxyCodeLine{965     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TB(:), TBuv(:)}
\DoxyCodeLine{966     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TBerr(0:rmax)}
\DoxyCodeLine{967     \textcolor{keywordtype}{integer} :: r,i    }
\DoxyCodeLine{968     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{969 }
\DoxyCodeLine{970     \textcolor{keywordflow}{if} (2.gt.nmax\_cll) then}
\DoxyCodeLine{971       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{972       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Bten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 2'},eflag,.true.)}
\DoxyCodeLine{973       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{974       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 2'}}
\DoxyCodeLine{975       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{976       return}
\DoxyCodeLine{977 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{978     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{979       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{980       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Bten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{981       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{982       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{983       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{984       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{985       return}
\DoxyCodeLine{986 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{987 }
\DoxyCodeLine{988     \textcolor{keyword}{call }bten\_list\_checked\_cll(tb,tbuv,momvec,mominv,masses2,rmax,tberr)}
\DoxyCodeLine{989 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a65fc8bc272e83486cd92b39472dfcf4f}\label{namespacecollier__tensors_a65fc8bc272e83486cd92b39472dfcf4f}} 
\index{collier\_tensors@{collier\_tensors}!bten\_main\_cll@{bten\_main\_cll}}
\index{bten\_main\_cll@{bten\_main\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{bten\_main\_cll()}{bten\_main\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::bten\+\_\+main\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TB,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Buv,  }\item[{double complex, dimension(0\+:3,1), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(1), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:1), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Berr }\end{DoxyParamCaption})}



Definition at line 791 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{791 }
\DoxyCodeLine{792     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{793     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,1), MomInv(1), masses2(0:1)}
\DoxyCodeLine{794     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TB(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{795     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TBuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{796     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TBerr(0:rmax)}
\DoxyCodeLine{797     \textcolor{keywordtype}{double complex} :: TB2(0:rmax,0:rmax,0:rmax,0:rmax), TBuv2(0:rmax,0:rmax,0:rmax,0:rmax)    }
\DoxyCodeLine{798     \textcolor{keywordtype}{double complex} :: CB(0:rmax/2,0:rmax), CBuv(0:rmax/2,0:rmax)}
\DoxyCodeLine{799     \textcolor{keywordtype}{double precision} :: CBerr(0:rmax), TBerr\_aux(0:rmax), TBerr\_aux2(0:rmax)}
\DoxyCodeLine{800     \textcolor{keywordtype}{double complex} :: args(7)}
\DoxyCodeLine{801     \textcolor{keywordtype}{double precision} :: TBdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TBacc(0:rmax)}
\DoxyCodeLine{802     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3    }
\DoxyCodeLine{803     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{804 }
\DoxyCodeLine{805     \textcolor{keywordflow}{if} (2.gt.nmax\_cll) then}
\DoxyCodeLine{806       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{807       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Bten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 2'},eflag,.true.)}
\DoxyCodeLine{808       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{809       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 2'}}
\DoxyCodeLine{810       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{811       return}
\DoxyCodeLine{812 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{813     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{814       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{815       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Bten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{816       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{817       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{818       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{819       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{820       return}
\DoxyCodeLine{821 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{822  }
\DoxyCodeLine{823     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{824     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{825     args(5) = mominv(1)}
\DoxyCodeLine{826     args(6:7) = masses2(0:)}
\DoxyCodeLine{827     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Bten\_cll'})}
\DoxyCodeLine{828     \textcolor{keyword}{call }setmastern\_cll(2)}
\DoxyCodeLine{829     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{830     \textcolor{keyword}{call }setmasterargs\_cll(7,args)}
\DoxyCodeLine{831 }
\DoxyCodeLine{832     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{833     }
\DoxyCodeLine{834     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{835       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{836       mode\_cll = 1}
\DoxyCodeLine{837       \textcolor{keyword}{call }b\_main\_cll(cb,cbuv,mominv(1),masses2(0),masses2(1),rmax,cberr,0)}
\DoxyCodeLine{838       \textcolor{keyword}{call }calctensorb(tb,tbuv,tberr\_aux,cb,cbuv,cberr,momvec(0:,1),rmax)      }
\DoxyCodeLine{839       }
\DoxyCodeLine{840       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{841       mode\_cll = 2}
\DoxyCodeLine{842       \textcolor{keyword}{call }b\_main\_cll(cb,cbuv,mominv(1),masses2(0),masses2(1),rmax,cberr,0)}
\DoxyCodeLine{843       \textcolor{keyword}{call }calctensorb(tb2,tbuv2,tberr\_aux2,cb,cbuv,cberr,momvec(0:,1),rmax)     }
\DoxyCodeLine{844             }
\DoxyCodeLine{845       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{846       mode\_cll = 3}
\DoxyCodeLine{847       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{848         norm\_coli=0d0}
\DoxyCodeLine{849         norm\_dd=0d0}
\DoxyCodeLine{850         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{851           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{852             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{853               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{854               norm\_coli = max(norm\_coli,abs(tb(n0,n1,n2,n3)))}
\DoxyCodeLine{855               norm\_dd = max(norm\_dd,abs(tb2(n0,n1,n2,n3)))}
\DoxyCodeLine{856             \textcolor{keyword}{end }do}
\DoxyCodeLine{857           \textcolor{keyword}{end }do}
\DoxyCodeLine{858         \textcolor{keyword}{end }do}
\DoxyCodeLine{859         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{860           norm\_coli = max(abs(mominv(1)),maxval(abs(masses2(0:1))))}
\DoxyCodeLine{861           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{862             norm\_coli=norm\_coli**(real(r)/2)}
\DoxyCodeLine{863           else}
\DoxyCodeLine{864             norm\_coli=muir2\_cll**(real(r)/2)}
\DoxyCodeLine{865           \textcolor{keyword}{end }if}
\DoxyCodeLine{866         \textcolor{keyword}{end }if}
\DoxyCodeLine{867         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{868           norm\_dd = max(abs(mominv(1)),maxval(abs(masses2(0:1))))}
\DoxyCodeLine{869           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{870             norm\_dd=norm\_dd**(real(r)/2)}
\DoxyCodeLine{871           else}
\DoxyCodeLine{872             norm\_dd=muir2\_cll**(real(r)/2)}
\DoxyCodeLine{873           \textcolor{keyword}{end }if}
\DoxyCodeLine{874         \textcolor{keyword}{end }if}
\DoxyCodeLine{875         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{876       \textcolor{keyword}{end }do}
\DoxyCodeLine{877       }
\DoxyCodeLine{878       \textcolor{keyword}{call }checktensors\_cll(tb,tb2,momvec,mominv,masses2,norm,2,rmax,tbdiff)}
\DoxyCodeLine{879       }
\DoxyCodeLine{880       \textcolor{keywordflow}{if} (tberr\_aux(rmax).lt.tberr\_aux2(rmax)) then}
\DoxyCodeLine{881         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tberr))  tberr = max(tberr\_aux,tbdiff*norm)}
\DoxyCodeLine{882         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{883           tbacc(r) = max(tberr\_aux(r)/norm(r),tbdiff(r))}
\DoxyCodeLine{884         \textcolor{keyword}{end }do}
\DoxyCodeLine{885         \textcolor{keywordflow}{if} (monitoring) pointscntbten\_coli =  pointscntbten\_coli + 1}
\DoxyCodeLine{886       else}
\DoxyCodeLine{887         tb = tb2}
\DoxyCodeLine{888         tbuv = tbuv2        }
\DoxyCodeLine{889         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tberr))  tberr = max(tberr\_aux2,tbdiff*norm)    }
\DoxyCodeLine{890         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{891           tbacc(r) = max(tberr\_aux2(r)/norm(r),tbdiff(r))}
\DoxyCodeLine{892 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{893         \textcolor{keywordflow}{if} (monitoring) pointscntbten\_dd =  pointscntbten\_dd + 1}
\DoxyCodeLine{894 \textcolor{keywordflow}{      end if}      }
\DoxyCodeLine{895       }
\DoxyCodeLine{896     else}
\DoxyCodeLine{897       \textcolor{keyword}{call }b\_main\_cll(cb,cbuv,mominv(1),masses2(0),masses2(1),rmax,cberr,0)}
\DoxyCodeLine{898       \textcolor{keyword}{call }calctensorb(tb,tbuv,tberr\_aux,cb,cbuv,cberr,momvec(0:,1),rmax)}
\DoxyCodeLine{899       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tberr))  tberr = tberr\_aux}
\DoxyCodeLine{900       norm = 0d0}
\DoxyCodeLine{901       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{902         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{903           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{904             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{905               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{906               norm(r) = max(norm(r),abs(tb(n0,n1,n2,n3)))}
\DoxyCodeLine{907             \textcolor{keyword}{end }do}
\DoxyCodeLine{908           \textcolor{keyword}{end }do}
\DoxyCodeLine{909 \textcolor{keywordflow}{        end do}      }
\DoxyCodeLine{910         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{911           norm(r) = max(abs(mominv(1)),maxval(abs(masses2(0:1))))}
\DoxyCodeLine{912           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{913             norm(r)=norm(r)**(real(r)/2)}
\DoxyCodeLine{914           else}
\DoxyCodeLine{915             norm(r)=muir2\_cll**(real(r)/2)}
\DoxyCodeLine{916           \textcolor{keyword}{end }if}
\DoxyCodeLine{917         \textcolor{keyword}{end }if}
\DoxyCodeLine{918         tbacc(r) = tberr\_aux(r)/norm(r)}
\DoxyCodeLine{919 \textcolor{keywordflow}{      end do}       }
\DoxyCodeLine{920       }
\DoxyCodeLine{921     \textcolor{keyword}{end }if}
\DoxyCodeLine{922 }
\DoxyCodeLine{923     \textcolor{keyword}{call }propagateaccflag\_cll(tbacc,rmax)}
\DoxyCodeLine{924     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{925 }
\DoxyCodeLine{926     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{927       pointscntbten\_cll =  pointscntbten\_cll + 1}
\DoxyCodeLine{928 }
\DoxyCodeLine{929       \textcolor{keywordflow}{if}(maxval(tbacc).gt.reqacc\_cll) accpointscntbten\_cll = accpointscntbten\_cll + 1}
\DoxyCodeLine{930 }
\DoxyCodeLine{931       \textcolor{keywordflow}{if}(maxval(tbacc).gt.critacc\_cll) then}
\DoxyCodeLine{932         critpointscntbten\_cll =  critpointscntbten\_cll + 1}
\DoxyCodeLine{933         \textcolor{keywordflow}{if} ( critpointscntbten\_cll.le.noutcritpointsmax\_cll(2) ) then}
\DoxyCodeLine{934           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TBten\_cll'},0,maxval(tbacc),critpointscntbten\_cll)}
\DoxyCodeLine{935           \textcolor{keywordflow}{if}( critpointscntbten\_cll.eq.noutcritpointsmax\_cll(2)) then}
\DoxyCodeLine{936             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TBten\_cll suppressed'}   }
\DoxyCodeLine{937             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{938           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{939 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{940 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TBten\_cll'},0,maxval(tbacc),critpointscntbten\_cll)}
\DoxyCodeLine{941           \textcolor{keywordflow}{if}( critpointscntbten\_cll.eq.noutcritpointsmax\_cll(2)) then}
\DoxyCodeLine{942             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TBten\_cll suppressed'}   }
\DoxyCodeLine{943             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{944           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{945 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{946 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{947       \textcolor{keyword}{end }if}
\DoxyCodeLine{948     \textcolor{keyword}{end }if}
\DoxyCodeLine{949 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a8c6f1e627c27e34f7ef5d9c607cafefa}\label{namespacecollier__tensors_a8c6f1e627c27e34f7ef5d9c607cafefa}} 
\index{collier\_tensors@{collier\_tensors}!cten\_args\_cll@{cten\_args\_cll}}
\index{cten\_args\_cll@{cten\_args\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{cten\_args\_cll()}{cten\_args\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::cten\+\_\+args\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TC,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Cuv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p2vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Cerr }\end{DoxyParamCaption})}



Definition at line 1846 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1846 }
\DoxyCodeLine{1847     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{1848     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3), p2vec(0:3)}
\DoxyCodeLine{1849     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{1850     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TC(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{1851     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TCuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{1852     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TCerr(0:rmax)}
\DoxyCodeLine{1853     \textcolor{keywordtype}{double complex} :: TC2(0:rmax,0:rmax,0:rmax,0:rmax), TCuv2(0:rmax,0:rmax,0:rmax,0:rmax)    }
\DoxyCodeLine{1854     \textcolor{keywordtype}{double complex} :: MomVec(0:3,2), MomInv(3), masses2(0:2)}
\DoxyCodeLine{1855     \textcolor{keywordtype}{double complex} :: CC(0:rmax/2,0:rmax,0:rmax), CCuv(0:rmax/2,0:rmax,0:rmax)}
\DoxyCodeLine{1856     \textcolor{keywordtype}{double precision} :: CCerr(0:rmax), TCerr\_aux(0:rmax), TCerr\_aux2(0:rmax)}
\DoxyCodeLine{1857     \textcolor{keywordtype}{double complex} :: args(14)}
\DoxyCodeLine{1858     \textcolor{keywordtype}{double precision} :: TCdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TCacc(0:rmax)}
\DoxyCodeLine{1859     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3    }
\DoxyCodeLine{1860     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{1861 }
\DoxyCodeLine{1862     \textcolor{keywordflow}{if} (3.gt.nmax\_cll) then}
\DoxyCodeLine{1863       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{1864       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Cten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 3'},eflag,.true.)}
\DoxyCodeLine{1865       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{1866       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 3'}}
\DoxyCodeLine{1867       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{1868       return}
\DoxyCodeLine{1869 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{1870     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{1871       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{1872       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Cten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{1873       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{1874       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{1875       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{1876       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{1877       return}
\DoxyCodeLine{1878 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{1879 }
\DoxyCodeLine{1880     momvec(0:,1) = p1vec}
\DoxyCodeLine{1881     momvec(0:,2) = p2vec}
\DoxyCodeLine{1882     mominv(1) = p10}
\DoxyCodeLine{1883     mominv(2) = p21}
\DoxyCodeLine{1884     mominv(3) = p20}
\DoxyCodeLine{1885     masses2(0) = m02}
\DoxyCodeLine{1886     masses2(1) = m12}
\DoxyCodeLine{1887     masses2(2) = m22}
\DoxyCodeLine{1888 }
\DoxyCodeLine{1889     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{1890     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{1891     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{1892     args(9:11) = mominv}
\DoxyCodeLine{1893     args(12:14) = masses2(0:)}
\DoxyCodeLine{1894     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Cten\_cll'})}
\DoxyCodeLine{1895     \textcolor{keyword}{call }setmastern\_cll(3)}
\DoxyCodeLine{1896     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{1897     \textcolor{keyword}{call }setmasterargs\_cll(14,args)}
\DoxyCodeLine{1898 }
\DoxyCodeLine{1899     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{1900 }
\DoxyCodeLine{1901     }
\DoxyCodeLine{1902     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{1903       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{1904       mode\_cll = 1}
\DoxyCodeLine{1905       \textcolor{keyword}{call }c\_main\_cll(cc,ccuv,mominv(1),mominv(2),mominv(3), \&}
\DoxyCodeLine{1906                       masses2(0),masses2(1),masses2(2),rmax,cerr2=ccerr,id\_in=0)    }
\DoxyCodeLine{1907       \textcolor{keyword}{call }calctensorc(tc,tcuv,tcerr\_aux,cc,ccuv,ccerr,momvec,rmax)}
\DoxyCodeLine{1908       }
\DoxyCodeLine{1909       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{1910       mode\_cll = 2}
\DoxyCodeLine{1911       \textcolor{keyword}{call }c\_main\_cll(cc,ccuv,mominv(1),mominv(2),mominv(3), \&}
\DoxyCodeLine{1912                       masses2(0),masses2(1),masses2(2),rmax,cerr2=ccerr,id\_in=0)    }
\DoxyCodeLine{1913       \textcolor{keyword}{call }calctensorc(tc2,tcuv2,tcerr\_aux2,cc,ccuv,ccerr,momvec,rmax)}
\DoxyCodeLine{1914       }
\DoxyCodeLine{1915       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{1916       mode\_cll = 3}
\DoxyCodeLine{1917       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1918         norm\_coli=0d0}
\DoxyCodeLine{1919         norm\_dd=0d0}
\DoxyCodeLine{1920         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{1921           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{1922             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{1923               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{1924               norm\_coli = max(norm\_coli,abs(tc(n0,n1,n2,n3)))}
\DoxyCodeLine{1925               norm\_dd = max(norm\_dd,abs(tc2(n0,n1,n2,n3)))}
\DoxyCodeLine{1926             \textcolor{keyword}{end }do}
\DoxyCodeLine{1927           \textcolor{keyword}{end }do}
\DoxyCodeLine{1928         \textcolor{keyword}{end }do}
\DoxyCodeLine{1929         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{1930           norm\_coli = max(maxval(abs(mominv(1:3))),maxval(abs(masses2(0:2))))}
\DoxyCodeLine{1931           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{1932             norm\_coli=1d0/norm\_coli**(1-\/real(r)/2)}
\DoxyCodeLine{1933           else}
\DoxyCodeLine{1934             norm\_coli=1d0/muir2\_cll**(1-\/real(r)/2)}
\DoxyCodeLine{1935           \textcolor{keyword}{end }if}
\DoxyCodeLine{1936         \textcolor{keyword}{end }if}
\DoxyCodeLine{1937         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{1938           norm\_dd = max(maxval(abs(mominv(1:3))),maxval(abs(masses2(0:2))))}
\DoxyCodeLine{1939           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{1940             norm\_dd=1d0/norm\_dd**(1-\/real(r)/2)}
\DoxyCodeLine{1941           else}
\DoxyCodeLine{1942             norm\_dd=1d0/muir2\_cll**(1-\/real(r)/2)}
\DoxyCodeLine{1943           \textcolor{keyword}{end }if}
\DoxyCodeLine{1944         \textcolor{keyword}{end }if}
\DoxyCodeLine{1945          norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{1946       \textcolor{keyword}{end }do}
\DoxyCodeLine{1947       }
\DoxyCodeLine{1948       \textcolor{keyword}{call }checktensors\_cll(tc,tc2,momvec,mominv,masses2,norm,3,rmax,tcdiff)}
\DoxyCodeLine{1949       }
\DoxyCodeLine{1950       \textcolor{keywordflow}{if} (tcerr\_aux(rmax).lt.tcerr\_aux2(rmax)) then}
\DoxyCodeLine{1951         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tcerr))  tcerr = max(tcerr\_aux,tcdiff*norm)}
\DoxyCodeLine{1952         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1953           tcacc(r) = max(tcerr\_aux(r)/norm(r),tcdiff(r))}
\DoxyCodeLine{1954         \textcolor{keyword}{end }do}
\DoxyCodeLine{1955         \textcolor{keywordflow}{if} (monitoring) pointscntcten\_coli =  pointscntcten\_coli + 1}
\DoxyCodeLine{1956       else}
\DoxyCodeLine{1957         tc = tc2}
\DoxyCodeLine{1958         tcuv = tcuv2        }
\DoxyCodeLine{1959         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tcerr))  tcerr = max(tcerr\_aux2,tcdiff*norm)    }
\DoxyCodeLine{1960         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1961           tcacc(r) = max(tcerr\_aux2(r)/norm(r),tcdiff(r))}
\DoxyCodeLine{1962 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{1963         \textcolor{keywordflow}{if} (monitoring) pointscntcten\_dd =  pointscntcten\_dd + 1}
\DoxyCodeLine{1964       \textcolor{keyword}{end }if}
\DoxyCodeLine{1965       }
\DoxyCodeLine{1966     else}
\DoxyCodeLine{1967       \textcolor{keyword}{call }c\_main\_cll(cc,ccuv,mominv(1),mominv(2),mominv(3), \&}
\DoxyCodeLine{1968                       masses2(0),masses2(1),masses2(2),rmax,cerr2=ccerr,id\_in=0)}
\DoxyCodeLine{1969       \textcolor{keyword}{call }calctensorc(tc,tcuv,tcerr\_aux,cc,ccuv,ccerr,momvec,rmax)}
\DoxyCodeLine{1970       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tcerr)) tcerr = tcerr\_aux}
\DoxyCodeLine{1971       norm=0d0}
\DoxyCodeLine{1972       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1973         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{1974           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{1975             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{1976               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{1977               norm(r) = max(norm(r),abs(tc(n0,n1,n2,n3)))}
\DoxyCodeLine{1978             \textcolor{keyword}{end }do}
\DoxyCodeLine{1979           \textcolor{keyword}{end }do}
\DoxyCodeLine{1980 \textcolor{keywordflow}{        end do}      }
\DoxyCodeLine{1981         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{1982           norm(r) = max(maxval(abs(mominv(1:3))),maxval(abs(masses2(0:2))))}
\DoxyCodeLine{1983           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{1984             norm(r)=1d0/norm(r)**(1-\/real(r)/2)}
\DoxyCodeLine{1985           else}
\DoxyCodeLine{1986             norm(r)=1d0/muir2\_cll**(1-\/real(r)/2)}
\DoxyCodeLine{1987           \textcolor{keyword}{end }if}
\DoxyCodeLine{1988         \textcolor{keyword}{end }if}
\DoxyCodeLine{1989         tcacc(r) = tcerr\_aux(r)/norm(r)}
\DoxyCodeLine{1990 \textcolor{keywordflow}{      end do}      }
\DoxyCodeLine{1991       }
\DoxyCodeLine{1992 \textcolor{keywordflow}{    end if}  }
\DoxyCodeLine{1993 }
\DoxyCodeLine{1994     \textcolor{keyword}{call }propagateaccflag\_cll(tcacc,rmax)}
\DoxyCodeLine{1995     \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{1996     }
\DoxyCodeLine{1997     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{1998       pointscntcten\_cll =  pointscntcten\_cll + 1}
\DoxyCodeLine{1999 }
\DoxyCodeLine{2000       \textcolor{keywordflow}{if}(maxval(tcacc).gt.reqacc\_cll) accpointscntcten\_cll = accpointscntcten\_cll + 1}
\DoxyCodeLine{2001 }
\DoxyCodeLine{2002       \textcolor{keywordflow}{if}(maxval(tcacc).gt.critacc\_cll) then}
\DoxyCodeLine{2003         critpointscntcten\_cll =  critpointscntcten\_cll + 1}
\DoxyCodeLine{2004         \textcolor{keywordflow}{if} ( critpointscntcten\_cll.le.noutcritpointsmax\_cll(3) ) then}
\DoxyCodeLine{2005           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TCten\_cll'},0,maxval(tcacc),critpointscntcten\_cll)}
\DoxyCodeLine{2006           \textcolor{keywordflow}{if}( critpointscntcten\_cll.eq.noutcritpointsmax\_cll(3)) then}
\DoxyCodeLine{2007             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TCten\_cll suppressed'}   }
\DoxyCodeLine{2008             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{2009           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{2010 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{2011 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TCten\_cll'},0,maxval(tcacc),critpointscntcten\_cll)}
\DoxyCodeLine{2012           \textcolor{keywordflow}{if}( critpointscntcten\_cll.eq.noutcritpointsmax\_cll(3)) then}
\DoxyCodeLine{2013             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TCten\_cll suppressed'}   }
\DoxyCodeLine{2014             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{2015           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{2016 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2017 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{2018       \textcolor{keyword}{end }if}
\DoxyCodeLine{2019     \textcolor{keyword}{end }if}
\DoxyCodeLine{2020 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a26e41d2004d6be496410777cffbf1643}\label{namespacecollier__tensors_a26e41d2004d6be496410777cffbf1643}} 
\index{collier\_tensors@{collier\_tensors}!cten\_args\_list\_checked\_cll@{cten\_args\_list\_checked\_cll}}
\index{cten\_args\_list\_checked\_cll@{cten\_args\_list\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{cten\_args\_list\_checked\_cll()}{cten\_args\_list\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::cten\+\_\+args\+\_\+list\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TC,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Cuv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p2vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Cerr }\end{DoxyParamCaption})}



Definition at line 2064 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2064 }
\DoxyCodeLine{2065     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{2066     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3), p2vec(0:3)}
\DoxyCodeLine{2067     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{2068     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TC(RtS(rmax)), TCuv(RtS(rmax))}
\DoxyCodeLine{2069     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TCerr(0:rmax)}
\DoxyCodeLine{2070     \textcolor{keywordtype}{double complex} :: TC2(RtS(rmax)), TCuv2(RtS(rmax))    }
\DoxyCodeLine{2071     \textcolor{keywordtype}{double complex} :: MomVec(0:3,2), MomInv(3), masses2(0:2)}
\DoxyCodeLine{2072     \textcolor{keywordtype}{double complex} :: CC(0:rmax/2,0:rmax,0:rmax), CCuv(0:rmax/2,0:rmax,0:rmax)}
\DoxyCodeLine{2073     \textcolor{keywordtype}{double precision} :: CCerr(0:rmax), TCerr\_aux(0:rmax), TCerr\_aux2(0:rmax)}
\DoxyCodeLine{2074     \textcolor{keywordtype}{double complex} :: args(14)}
\DoxyCodeLine{2075     \textcolor{keywordtype}{double precision} :: TCdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TCacc(0:rmax)}
\DoxyCodeLine{2076     \textcolor{keywordtype}{integer} :: r,i    }
\DoxyCodeLine{2077     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{2078 }
\DoxyCodeLine{2079     momvec(0:,1) = p1vec}
\DoxyCodeLine{2080     momvec(0:,2) = p2vec}
\DoxyCodeLine{2081     mominv(1) = p10}
\DoxyCodeLine{2082     mominv(2) = p21}
\DoxyCodeLine{2083     mominv(3) = p20}
\DoxyCodeLine{2084     masses2(0) = m02}
\DoxyCodeLine{2085     masses2(1) = m12}
\DoxyCodeLine{2086     masses2(2) = m22}
\DoxyCodeLine{2087 }
\DoxyCodeLine{2088     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{2089     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{2090     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{2091     args(9:11) = mominv}
\DoxyCodeLine{2092     args(12:14) = masses2(0:)}
\DoxyCodeLine{2093     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Cten\_cll'})}
\DoxyCodeLine{2094     \textcolor{keyword}{call }setmastern\_cll(3)}
\DoxyCodeLine{2095     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{2096     \textcolor{keyword}{call }setmasterargs\_cll(14,args)}
\DoxyCodeLine{2097 }
\DoxyCodeLine{2098     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{2099 }
\DoxyCodeLine{2100     }
\DoxyCodeLine{2101     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{2102       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{2103       mode\_cll = 1}
\DoxyCodeLine{2104       \textcolor{keyword}{call }c\_main\_cll(cc,ccuv,mominv(1),mominv(2),mominv(3), \&}
\DoxyCodeLine{2105                       masses2(0),masses2(1),masses2(2),rmax,cerr2=ccerr,id\_in=0)    }
\DoxyCodeLine{2106       \textcolor{keyword}{call }calctensorc\_list(tc,tcuv,tcerr\_aux,cc,ccuv,ccerr,momvec,rmax)}
\DoxyCodeLine{2107       }
\DoxyCodeLine{2108       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{2109       mode\_cll = 2}
\DoxyCodeLine{2110       \textcolor{keyword}{call }c\_main\_cll(cc,ccuv,mominv(1),mominv(2),mominv(3), \&}
\DoxyCodeLine{2111                       masses2(0),masses2(1),masses2(2),rmax,cerr2=ccerr,id\_in=0)    }
\DoxyCodeLine{2112       \textcolor{keyword}{call }calctensorc\_list(tc2,tcuv2,tcerr\_aux2,cc,ccuv,ccerr,momvec,rmax)}
\DoxyCodeLine{2113       }
\DoxyCodeLine{2114       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{2115       mode\_cll = 3}
\DoxyCodeLine{2116       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2117         norm\_coli=0d0}
\DoxyCodeLine{2118         norm\_dd=0d0}
\DoxyCodeLine{2119         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{2120           norm\_coli = max(norm\_coli,abs(tc(i)))}
\DoxyCodeLine{2121           norm\_dd = max(norm\_dd,abs(tc2(i)))}
\DoxyCodeLine{2122         \textcolor{keyword}{end }do}
\DoxyCodeLine{2123         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{2124           norm\_coli = max(maxval(abs(mominv(1:3))),maxval(abs(masses2(0:2))))}
\DoxyCodeLine{2125           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{2126             norm\_coli=1d0/norm\_coli**(1-\/real(r)/2)}
\DoxyCodeLine{2127           else}
\DoxyCodeLine{2128             norm\_coli=1d0/muir2\_cll**(1-\/real(r)/2)}
\DoxyCodeLine{2129           \textcolor{keyword}{end }if}
\DoxyCodeLine{2130         \textcolor{keyword}{end }if}
\DoxyCodeLine{2131         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{2132           norm\_dd = max(maxval(abs(mominv(1:3))),maxval(abs(masses2(0:2))))}
\DoxyCodeLine{2133           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{2134             norm\_dd=1d0/norm\_dd**(1-\/real(r)/2)}
\DoxyCodeLine{2135           else}
\DoxyCodeLine{2136             norm\_dd=1d0/muir2\_cll**(1-\/real(r)/2)}
\DoxyCodeLine{2137           \textcolor{keyword}{end }if}
\DoxyCodeLine{2138         \textcolor{keyword}{end }if}
\DoxyCodeLine{2139         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{2140       \textcolor{keyword}{end }do}
\DoxyCodeLine{2141       }
\DoxyCodeLine{2142       \textcolor{keyword}{call }checktensorslist\_cll(tc,tc2,momvec,mominv,masses2,norm,3,rmax,tcdiff)      }
\DoxyCodeLine{2143       }
\DoxyCodeLine{2144       \textcolor{keywordflow}{if} (tcerr\_aux(rmax).lt.tcerr\_aux2(rmax)) then}
\DoxyCodeLine{2145         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tcerr))  tcerr = max(tcerr\_aux,tcdiff*norm)}
\DoxyCodeLine{2146         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2147           tcacc(r) = max(tcerr\_aux(r)/norm(r),tcdiff(r))}
\DoxyCodeLine{2148         \textcolor{keyword}{end }do}
\DoxyCodeLine{2149         \textcolor{keywordflow}{if} (monitoring) pointscntcten\_coli =  pointscntcten\_coli + 1}
\DoxyCodeLine{2150       else}
\DoxyCodeLine{2151         tc = tc2}
\DoxyCodeLine{2152         tcuv = tcuv2        }
\DoxyCodeLine{2153         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tcerr))  tcerr = max(tcerr\_aux2,tcdiff*norm)    }
\DoxyCodeLine{2154         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2155           tcacc(r) = max(tcerr\_aux2(r)/norm(r),tcdiff(r))}
\DoxyCodeLine{2156 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{2157         \textcolor{keywordflow}{if} (monitoring) pointscntcten\_dd =  pointscntcten\_dd + 1}
\DoxyCodeLine{2158       \textcolor{keyword}{end }if}
\DoxyCodeLine{2159       }
\DoxyCodeLine{2160     else}
\DoxyCodeLine{2161       \textcolor{keyword}{call }c\_main\_cll(cc,ccuv,mominv(1),mominv(2),mominv(3), \&}
\DoxyCodeLine{2162                       masses2(0),masses2(1),masses2(2),rmax,cerr2=ccerr,id\_in=0)    }
\DoxyCodeLine{2163       \textcolor{keyword}{call }calctensorc\_list(tc,tcuv,tcerr,cc,ccuv,ccerr,momvec,rmax)}
\DoxyCodeLine{2164       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tcerr)) tcerr = tcerr\_aux}
\DoxyCodeLine{2165       norm=0d0}
\DoxyCodeLine{2166       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2167         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{2168           norm(r) = max(norm(r),abs(tc(i)))      }
\DoxyCodeLine{2169 \textcolor{keywordflow}{        end do}            }
\DoxyCodeLine{2170         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{2171           norm(r) = max(maxval(abs(mominv(1:3))),maxval(abs(masses2(0:2))))}
\DoxyCodeLine{2172           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{2173             norm(r)=1d0/norm(r)**(1-\/real(r)/2)}
\DoxyCodeLine{2174           else}
\DoxyCodeLine{2175             norm(r)=1d0/muir2\_cll**(1-\/real(r)/2)}
\DoxyCodeLine{2176           \textcolor{keyword}{end }if}
\DoxyCodeLine{2177         \textcolor{keyword}{end }if}
\DoxyCodeLine{2178         tcacc(r) = tcerr\_aux(r)/norm(r)}
\DoxyCodeLine{2179 \textcolor{keywordflow}{      end do}       }
\DoxyCodeLine{2180       }
\DoxyCodeLine{2181     \textcolor{keyword}{end }if}
\DoxyCodeLine{2182 }
\DoxyCodeLine{2183     \textcolor{keyword}{call }propagateaccflag\_cll(tcacc,rmax)}
\DoxyCodeLine{2184     \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{2185     }
\DoxyCodeLine{2186     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{2187       pointscntcten\_cll =  pointscntcten\_cll + 1}
\DoxyCodeLine{2188 }
\DoxyCodeLine{2189       \textcolor{keywordflow}{if}(maxval(tcacc).gt.reqacc\_cll) accpointscntcten\_cll = accpointscntcten\_cll + 1}
\DoxyCodeLine{2190 }
\DoxyCodeLine{2191       \textcolor{keywordflow}{if}(maxval(tcacc).gt.critacc\_cll) then}
\DoxyCodeLine{2192         critpointscntcten\_cll =  critpointscntcten\_cll + 1}
\DoxyCodeLine{2193         \textcolor{keywordflow}{if} ( critpointscntcten\_cll.le.noutcritpointsmax\_cll(3) ) then}
\DoxyCodeLine{2194           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TCten\_cll'},0,maxval(tcacc),critpointscntcten\_cll)}
\DoxyCodeLine{2195           \textcolor{keywordflow}{if}( critpointscntcten\_cll.eq.noutcritpointsmax\_cll(3)) then}
\DoxyCodeLine{2196             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TCten\_cll suppressed'}   }
\DoxyCodeLine{2197             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{2198           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{2199 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{2200 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TCten\_cll'},0,maxval(tcacc),critpointscntcten\_cll)}
\DoxyCodeLine{2201           \textcolor{keywordflow}{if}( critpointscntcten\_cll.eq.noutcritpointsmax\_cll(3)) then}
\DoxyCodeLine{2202             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TCten\_cll suppressed'}   }
\DoxyCodeLine{2203             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{2204           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{2205 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2206 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{2207       \textcolor{keyword}{end }if}
\DoxyCodeLine{2208     \textcolor{keyword}{end }if}
\DoxyCodeLine{2209 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_aec2a54cfeaf840549490a41be99dfbb2}\label{namespacecollier__tensors_aec2a54cfeaf840549490a41be99dfbb2}} 
\index{collier\_tensors@{collier\_tensors}!cten\_args\_list\_cll@{cten\_args\_list\_cll}}
\index{cten\_args\_list\_cll@{cten\_args\_list\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{cten\_args\_list\_cll()}{cten\_args\_list\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::cten\+\_\+args\+\_\+list\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:), intent(out)}]{TC,  }\item[{double complex, dimension(\+:), intent(out)}]{T\+Cuv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p2vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Cerr }\end{DoxyParamCaption})}



Definition at line 2033 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2033     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{2034     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3), p2vec(0:3)}
\DoxyCodeLine{2035     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{2036     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TC(:), TCuv(:)}
\DoxyCodeLine{2037     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TCerr(0:rmax)}
\DoxyCodeLine{2038     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{2039 }
\DoxyCodeLine{2040     \textcolor{keywordflow}{if} (3.gt.nmax\_cll) then}
\DoxyCodeLine{2041       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{2042       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Cten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 3'},eflag,.true.)}
\DoxyCodeLine{2043       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{2044       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 3'}}
\DoxyCodeLine{2045       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{2046       return}
\DoxyCodeLine{2047 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{2048     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{2049       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{2050       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Cten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{2051       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{2052       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{2053       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{2054       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{2055       return}
\DoxyCodeLine{2056 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{2057     }
\DoxyCodeLine{2058     \textcolor{keyword}{call }cten\_args\_list\_checked\_cll(tc,tcuv,p1vec,p2vec,p10,p21,p20,m02,m12,m22,rmax,tcerr)}
\DoxyCodeLine{2059 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_aabe489d66033c94e18e392d2de6b435a}\label{namespacecollier__tensors_aabe489d66033c94e18e392d2de6b435a}} 
\index{collier\_tensors@{collier\_tensors}!cten\_list\_checked\_cll@{cten\_list\_checked\_cll}}
\index{cten\_list\_checked\_cll@{cten\_list\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{cten\_list\_checked\_cll()}{cten\_list\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::cten\+\_\+list\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TC,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Cuv,  }\item[{double complex, dimension(0\+:3,2), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(3), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:2), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Cerr }\end{DoxyParamCaption})}



Definition at line 1700 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1700 }
\DoxyCodeLine{1701     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{1702     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,2), MomInv(3), masses2(0:2)}
\DoxyCodeLine{1703     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TC(RtS(rmax)), TCuv(RtS(rmax))}
\DoxyCodeLine{1704     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TCerr(0:rmax)}
\DoxyCodeLine{1705     \textcolor{keywordtype}{double complex} :: TC2(RtS(rmax)), TCuv2(RtS(rmax))    }
\DoxyCodeLine{1706     \textcolor{keywordtype}{double complex} :: CC(0:rmax/2,0:rmax,0:rmax), CCuv(0:rmax/2,0:rmax,0:rmax)}
\DoxyCodeLine{1707     \textcolor{keywordtype}{double precision} :: CCerr(0:rmax), TCerr\_aux(0:rmax), TCerr\_aux2(0:rmax)}
\DoxyCodeLine{1708     \textcolor{keywordtype}{double complex} :: args(14)}
\DoxyCodeLine{1709     \textcolor{keywordtype}{double precision} :: TCdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TCacc(0:rmax)}
\DoxyCodeLine{1710     \textcolor{keywordtype}{integer} :: r,i}
\DoxyCodeLine{1711     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{1712 }
\DoxyCodeLine{1713     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{1714     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{1715     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{1716     args(9:11) = mominv}
\DoxyCodeLine{1717     args(12:14) = masses2(0:)}
\DoxyCodeLine{1718     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Cten\_cll'})}
\DoxyCodeLine{1719     \textcolor{keyword}{call }setmastern\_cll(3)}
\DoxyCodeLine{1720     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{1721     \textcolor{keyword}{call }setmasterargs\_cll(14,args)}
\DoxyCodeLine{1722 }
\DoxyCodeLine{1723     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{1724     }
\DoxyCodeLine{1725     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{1726       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{1727       mode\_cll = 1}
\DoxyCodeLine{1728       \textcolor{keyword}{call }c\_main\_cll(cc,ccuv,mominv(1),mominv(2),mominv(3), \&}
\DoxyCodeLine{1729                       masses2(0),masses2(1),masses2(2),rmax,cerr2=ccerr,id\_in=0)    }
\DoxyCodeLine{1730       \textcolor{keyword}{call }calctensorc\_list(tc,tcuv,tcerr\_aux,cc,ccuv,ccerr,momvec,rmax)}
\DoxyCodeLine{1731       }
\DoxyCodeLine{1732       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{1733       mode\_cll = 2}
\DoxyCodeLine{1734       \textcolor{keyword}{call }c\_main\_cll(cc,ccuv,mominv(1),mominv(2),mominv(3), \&}
\DoxyCodeLine{1735                       masses2(0),masses2(1),masses2(2),rmax,cerr2=ccerr,id\_in=0)    }
\DoxyCodeLine{1736       \textcolor{keyword}{call }calctensorc\_list(tc2,tcuv2,tcerr\_aux2,cc,ccuv,ccerr,momvec,rmax)}
\DoxyCodeLine{1737       }
\DoxyCodeLine{1738       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{1739       mode\_cll = 3}
\DoxyCodeLine{1740       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1741         norm\_coli=0d0}
\DoxyCodeLine{1742         norm\_dd=0d0}
\DoxyCodeLine{1743         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{1744           norm\_coli = max(norm\_coli,abs(tc(i)))}
\DoxyCodeLine{1745           norm\_dd = max(norm\_dd,abs(tc2(i)))}
\DoxyCodeLine{1746         \textcolor{keyword}{end }do}
\DoxyCodeLine{1747         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{1748           norm\_coli = max(maxval(abs(mominv(1:3))),maxval(abs(masses2(0:2))))}
\DoxyCodeLine{1749           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{1750             norm\_coli=1d0/norm\_coli**(1-\/real(r)/2)}
\DoxyCodeLine{1751           else}
\DoxyCodeLine{1752             norm\_coli=1d0/muir2\_cll**(1-\/real(r)/2)}
\DoxyCodeLine{1753           \textcolor{keyword}{end }if}
\DoxyCodeLine{1754         \textcolor{keyword}{end }if}
\DoxyCodeLine{1755         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{1756           norm\_dd = max(maxval(abs(mominv(1:3))),maxval(abs(masses2(0:2))))}
\DoxyCodeLine{1757           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{1758             norm\_dd=1d0/norm\_dd**(1-\/real(r)/2)}
\DoxyCodeLine{1759           else}
\DoxyCodeLine{1760             norm\_dd=1d0/muir2\_cll**(1-\/real(r)/2)}
\DoxyCodeLine{1761           \textcolor{keyword}{end }if}
\DoxyCodeLine{1762         \textcolor{keyword}{end }if}
\DoxyCodeLine{1763         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{1764       \textcolor{keyword}{end }do}
\DoxyCodeLine{1765       }
\DoxyCodeLine{1766       \textcolor{keyword}{call }checktensorslist\_cll(tc,tc2,momvec,mominv,masses2,norm,3,rmax,tcdiff)      }
\DoxyCodeLine{1767       }
\DoxyCodeLine{1768       \textcolor{keywordflow}{if} (tcerr\_aux(rmax).lt.tcerr\_aux2(rmax)) then}
\DoxyCodeLine{1769         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tcerr))  tcerr = max(tcerr\_aux,tcdiff*norm)}
\DoxyCodeLine{1770         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1771           tcacc(r) = max(tcerr\_aux(r)/norm(r),tcdiff(r))}
\DoxyCodeLine{1772         \textcolor{keyword}{end }do}
\DoxyCodeLine{1773         \textcolor{keywordflow}{if} (monitoring) pointscntcten\_coli =  pointscntcten\_coli + 1}
\DoxyCodeLine{1774       else}
\DoxyCodeLine{1775         tc = tc2}
\DoxyCodeLine{1776         tcuv = tcuv2        }
\DoxyCodeLine{1777         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tcerr))  tcerr = max(tcerr\_aux2,tcdiff*norm)    }
\DoxyCodeLine{1778         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1779           tcacc(r) = max(tcerr\_aux2(r)/norm(r),tcdiff(r))}
\DoxyCodeLine{1780 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{1781         \textcolor{keywordflow}{if} (monitoring) pointscntcten\_dd =  pointscntcten\_dd + 1}
\DoxyCodeLine{1782       \textcolor{keyword}{end }if}
\DoxyCodeLine{1783       }
\DoxyCodeLine{1784     \textcolor{keywordflow}{else} }
\DoxyCodeLine{1785       \textcolor{keyword}{call }c\_main\_cll(cc,ccuv,mominv(1),mominv(2),mominv(3), \&}
\DoxyCodeLine{1786                       masses2(0),masses2(1),masses2(2),rmax,cerr2=ccerr,id\_in=0)}
\DoxyCodeLine{1787       \textcolor{keyword}{call }calctensorc\_list(tc,tcuv,tcerr\_aux,cc,ccuv,ccerr,momvec,rmax)}
\DoxyCodeLine{1788       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tcerr)) tcerr = tcerr\_aux}
\DoxyCodeLine{1789       norm=0d0}
\DoxyCodeLine{1790       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1791         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{1792           norm(r) = max(norm(r),abs(tc(i)))      }
\DoxyCodeLine{1793 \textcolor{keywordflow}{        end do}             }
\DoxyCodeLine{1794         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{1795           norm(r) = max(maxval(abs(mominv(1:3))),maxval(abs(masses2(0:2))))}
\DoxyCodeLine{1796           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{1797             norm(r)=1d0/norm(r)**(1-\/real(r)/2)}
\DoxyCodeLine{1798           else}
\DoxyCodeLine{1799             norm(r)=1d0/muir2\_cll**(1-\/real(r)/2)}
\DoxyCodeLine{1800           \textcolor{keyword}{end }if}
\DoxyCodeLine{1801         \textcolor{keyword}{end }if}
\DoxyCodeLine{1802         tcacc(r) = tcerr\_aux(r)/norm(r)}
\DoxyCodeLine{1803 \textcolor{keywordflow}{      end do}       }
\DoxyCodeLine{1804       }
\DoxyCodeLine{1805     \textcolor{keyword}{end }if}
\DoxyCodeLine{1806 }
\DoxyCodeLine{1807     \textcolor{keyword}{call }propagateaccflag\_cll(tcacc,rmax)}
\DoxyCodeLine{1808     \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{1809     }
\DoxyCodeLine{1810     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{1811       pointscntcten\_cll =  pointscntcten\_cll + 1}
\DoxyCodeLine{1812 }
\DoxyCodeLine{1813       \textcolor{keywordflow}{if}(maxval(tcacc).gt.reqacc\_cll) accpointscntcten\_cll = accpointscntcten\_cll + 1}
\DoxyCodeLine{1814 }
\DoxyCodeLine{1815       \textcolor{keywordflow}{if}(maxval(tcacc).gt.critacc\_cll) then}
\DoxyCodeLine{1816         critpointscntcten\_cll =  critpointscntcten\_cll + 1}
\DoxyCodeLine{1817         \textcolor{keywordflow}{if} ( critpointscntcten\_cll.le.noutcritpointsmax\_cll(3) ) then}
\DoxyCodeLine{1818           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TCten\_cll'},0,maxval(tcacc),critpointscntcten\_cll)}
\DoxyCodeLine{1819           \textcolor{keywordflow}{if}( critpointscntcten\_cll.eq.noutcritpointsmax\_cll(3)) then}
\DoxyCodeLine{1820             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TCten\_cll suppressed'}   }
\DoxyCodeLine{1821             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{1822           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{1823 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{1824 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TCten\_cll'},0,maxval(tcacc),critpointscntcten\_cll)}
\DoxyCodeLine{1825           \textcolor{keywordflow}{if}( critpointscntcten\_cll.eq.noutcritpointsmax\_cll(3)) then}
\DoxyCodeLine{1826             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TCten\_cll suppressed'}   }
\DoxyCodeLine{1827             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{1828           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{1829 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1830 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{1831       \textcolor{keyword}{end }if}
\DoxyCodeLine{1832     \textcolor{keyword}{end }if}
\DoxyCodeLine{1833 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_ab9aa9c991c5534216af7fc5b85b44e68}\label{namespacecollier__tensors_ab9aa9c991c5534216af7fc5b85b44e68}} 
\index{collier\_tensors@{collier\_tensors}!cten\_list\_cll@{cten\_list\_cll}}
\index{cten\_list\_cll@{cten\_list\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{cten\_list\_cll()}{cten\_list\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::cten\+\_\+list\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:), intent(out)}]{TC,  }\item[{double complex, dimension(\+:), intent(out)}]{T\+Cuv,  }\item[{double complex, dimension(0\+:3,2), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(3), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:2), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Cerr }\end{DoxyParamCaption})}



Definition at line 1669 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1669 }
\DoxyCodeLine{1670     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{1671     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,2), MomInv(3), masses2(0:2)}
\DoxyCodeLine{1672     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TC(:), TCuv(:)}
\DoxyCodeLine{1673     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TCerr(0:rmax)}
\DoxyCodeLine{1674     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{1675 }
\DoxyCodeLine{1676     \textcolor{keywordflow}{if} (3.gt.nmax\_cll) then}
\DoxyCodeLine{1677       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{1678       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Cten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 3'},eflag,.true.)}
\DoxyCodeLine{1679       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{1680       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 3'}}
\DoxyCodeLine{1681       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{1682       return}
\DoxyCodeLine{1683 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{1684     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{1685       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{1686       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Cten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{1687       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{1688       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{1689       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{1690       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{1691       return}
\DoxyCodeLine{1692 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{1693 }
\DoxyCodeLine{1694     \textcolor{keyword}{call }cten\_list\_checked\_cll(tc,tcuv,momvec,mominv,masses2,rmax,tcerr)}
\DoxyCodeLine{1695 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_af81370e418360b72dbd61dbfc4733a5b}\label{namespacecollier__tensors_af81370e418360b72dbd61dbfc4733a5b}} 
\index{collier\_tensors@{collier\_tensors}!cten\_main\_cll@{cten\_main\_cll}}
\index{cten\_main\_cll@{cten\_main\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{cten\_main\_cll()}{cten\_main\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::cten\+\_\+main\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TC,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Cuv,  }\item[{double complex, dimension(0\+:3,2), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(3), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:2), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Cerr }\end{DoxyParamCaption})}



Definition at line 1494 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1494 }
\DoxyCodeLine{1495     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{1496     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,2), MomInv(3), masses2(0:2)}
\DoxyCodeLine{1497     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TC(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{1498     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TCuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{1499     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TCerr(0:rmax)}
\DoxyCodeLine{1500     \textcolor{keywordtype}{double complex} :: TC2(0:rmax,0:rmax,0:rmax,0:rmax), TCuv2(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{1501     \textcolor{keywordtype}{double complex} :: CC(0:rmax/2,0:rmax,0:rmax), CCuv(0:rmax/2,0:rmax,0:rmax)}
\DoxyCodeLine{1502     \textcolor{keywordtype}{double precision} :: CCerr(0:rmax), TCerr\_aux(0:rmax), TCerr\_aux2(0:rmax), TCacc(0:rmax)}
\DoxyCodeLine{1503     \textcolor{keywordtype}{double complex} args(14)}
\DoxyCodeLine{1504     \textcolor{keywordtype}{double precision} :: TCdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd}
\DoxyCodeLine{1505     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3    }
\DoxyCodeLine{1506     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{1507 }
\DoxyCodeLine{1508     \textcolor{keywordflow}{if} (3.gt.nmax\_cll) then}
\DoxyCodeLine{1509       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{1510       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Cten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 3'},eflag,.true.)}
\DoxyCodeLine{1511       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{1512       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 3'}}
\DoxyCodeLine{1513       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{1514       return}
\DoxyCodeLine{1515 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{1516     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{1517       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{1518       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Cten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{1519       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{1520       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{1521       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{1522       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{1523       return}
\DoxyCodeLine{1524 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{1525 }
\DoxyCodeLine{1526     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{1527     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{1528     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{1529     args(9:11) = mominv}
\DoxyCodeLine{1530     args(12:14) = masses2(0:)}
\DoxyCodeLine{1531     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Cten\_cll'})}
\DoxyCodeLine{1532     \textcolor{keyword}{call }setmastern\_cll(3)}
\DoxyCodeLine{1533     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{1534     \textcolor{keyword}{call }setmasterargs\_cll(14,args)}
\DoxyCodeLine{1535 }
\DoxyCodeLine{1536     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{1537     }
\DoxyCodeLine{1538     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{1539       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{1540       mode\_cll = 1}
\DoxyCodeLine{1541       \textcolor{keyword}{call }c\_main\_cll(cc,ccuv,mominv(1),mominv(2),mominv(3), \&}
\DoxyCodeLine{1542                       masses2(0),masses2(1),masses2(2),rmax,cerr2=ccerr,id\_in=0)    }
\DoxyCodeLine{1543       \textcolor{keyword}{call }calctensorc(tc,tcuv,tcerr\_aux,cc,ccuv,ccerr,momvec,rmax)}
\DoxyCodeLine{1544       }
\DoxyCodeLine{1545       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{1546       mode\_cll = 2}
\DoxyCodeLine{1547       \textcolor{keyword}{call }c\_main\_cll(cc,ccuv,mominv(1),mominv(2),mominv(3), \&}
\DoxyCodeLine{1548                       masses2(0),masses2(1),masses2(2),rmax,cerr2=ccerr,id\_in=0)    }
\DoxyCodeLine{1549       \textcolor{keyword}{call }calctensorc(tc2,tcuv2,tcerr\_aux2,cc,ccuv,ccerr,momvec,rmax)}
\DoxyCodeLine{1550       }
\DoxyCodeLine{1551       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{1552       mode\_cll = 3}
\DoxyCodeLine{1553       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1554         norm\_coli=0d0}
\DoxyCodeLine{1555         norm\_dd=0d0}
\DoxyCodeLine{1556         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{1557           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{1558             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{1559               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{1560               norm\_coli = max(norm\_coli,abs(tc(n0,n1,n2,n3)))}
\DoxyCodeLine{1561               norm\_dd = max(norm\_dd,abs(tc2(n0,n1,n2,n3)))}
\DoxyCodeLine{1562             \textcolor{keyword}{end }do}
\DoxyCodeLine{1563           \textcolor{keyword}{end }do}
\DoxyCodeLine{1564         \textcolor{keyword}{end }do}
\DoxyCodeLine{1565         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{1566           norm\_coli = max(maxval(abs(mominv(1:3))),maxval(abs(masses2(0:2))))}
\DoxyCodeLine{1567           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{1568             norm\_coli=1d0/norm\_coli**(1-\/real(r)/2)}
\DoxyCodeLine{1569           else}
\DoxyCodeLine{1570             norm\_coli=1d0/muir2\_cll**(1-\/real(r)/2)}
\DoxyCodeLine{1571           \textcolor{keyword}{end }if}
\DoxyCodeLine{1572         \textcolor{keyword}{end }if}
\DoxyCodeLine{1573         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{1574           norm\_dd = max(maxval(abs(mominv(1:3))),maxval(abs(masses2(0:2))))}
\DoxyCodeLine{1575           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{1576             norm\_dd=1d0/norm\_dd**(1-\/real(r)/2)}
\DoxyCodeLine{1577           else}
\DoxyCodeLine{1578             norm\_dd=1d0/muir2\_cll**(1-\/real(r)/2)}
\DoxyCodeLine{1579           \textcolor{keyword}{end }if}
\DoxyCodeLine{1580         \textcolor{keyword}{end }if}
\DoxyCodeLine{1581         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{1582       \textcolor{keyword}{end }do}
\DoxyCodeLine{1583       }
\DoxyCodeLine{1584       \textcolor{keyword}{call }checktensors\_cll(tc,tc2,momvec,mominv,masses2,norm,3,rmax,tcdiff)}
\DoxyCodeLine{1585       }
\DoxyCodeLine{1586       \textcolor{keywordflow}{if} (tcerr\_aux(rmax).lt.tcerr\_aux2(rmax)) then}
\DoxyCodeLine{1587         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tcerr))  tcerr = max(tcerr\_aux,tcdiff*norm)}
\DoxyCodeLine{1588         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1589           tcacc(r) = max(tcerr\_aux(r)/norm(r),tcdiff(r))}
\DoxyCodeLine{1590         \textcolor{keyword}{end }do}
\DoxyCodeLine{1591         \textcolor{keywordflow}{if} (monitoring) pointscntcten\_coli =  pointscntcten\_coli + 1}
\DoxyCodeLine{1592       else}
\DoxyCodeLine{1593         tc = tc2}
\DoxyCodeLine{1594         tcuv = tcuv2        }
\DoxyCodeLine{1595         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tcerr))  tcerr = max(tcerr\_aux2,tcdiff*norm)    }
\DoxyCodeLine{1596         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1597           tcacc(r) = max(tcerr\_aux2(r)/norm(r),tcdiff(r))}
\DoxyCodeLine{1598 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{1599         \textcolor{keywordflow}{if} (monitoring) pointscntcten\_dd =  pointscntcten\_dd + 1}
\DoxyCodeLine{1600 \textcolor{keywordflow}{      end if}      }
\DoxyCodeLine{1601       }
\DoxyCodeLine{1602     else}
\DoxyCodeLine{1603       \textcolor{keyword}{call }c\_main\_cll(cc,ccuv,mominv(1),mominv(2),mominv(3), \&}
\DoxyCodeLine{1604                       masses2(0),masses2(1),masses2(2),rmax,cerr2=ccerr,id\_in=0)    }
\DoxyCodeLine{1605       \textcolor{keyword}{call }calctensorc(tc,tcuv,tcerr\_aux,cc,ccuv,ccerr,momvec,rmax)}
\DoxyCodeLine{1606       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tcerr)) tcerr = tcerr\_aux}
\DoxyCodeLine{1607       norm=0d0}
\DoxyCodeLine{1608       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{1609         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{1610           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{1611             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{1612               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{1613               norm(r) = max(norm(r),abs(tc(n0,n1,n2,n3)))}
\DoxyCodeLine{1614             \textcolor{keyword}{end }do}
\DoxyCodeLine{1615           \textcolor{keyword}{end }do}
\DoxyCodeLine{1616 \textcolor{keywordflow}{        end do}      }
\DoxyCodeLine{1617         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{1618           norm(r) = max(maxval(abs(mominv(1:3))),maxval(abs(masses2(0:2))))}
\DoxyCodeLine{1619           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{1620             norm(r)=1d0/norm(r)**(1-\/real(r)/2)}
\DoxyCodeLine{1621           else}
\DoxyCodeLine{1622             norm(r)=1d0/muir2\_cll**(1-\/real(r)/2)}
\DoxyCodeLine{1623           \textcolor{keyword}{end }if}
\DoxyCodeLine{1624         \textcolor{keyword}{end }if}
\DoxyCodeLine{1625         tcacc(r) = tcerr\_aux(r)/norm(r)}
\DoxyCodeLine{1626 \textcolor{keywordflow}{      end do} }
\DoxyCodeLine{1627       }
\DoxyCodeLine{1628     \textcolor{keyword}{end }if}
\DoxyCodeLine{1629 }
\DoxyCodeLine{1630     \textcolor{keyword}{call }propagateaccflag\_cll(tcacc,rmax)}
\DoxyCodeLine{1631     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{1632 }
\DoxyCodeLine{1633     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{1634       pointscntcten\_cll =  pointscntcten\_cll + 1}
\DoxyCodeLine{1635 }
\DoxyCodeLine{1636       \textcolor{keywordflow}{if}(maxval(tcacc).gt.reqacc\_cll) accpointscntcten\_cll = accpointscntcten\_cll + 1}
\DoxyCodeLine{1637 }
\DoxyCodeLine{1638       \textcolor{keywordflow}{if}(maxval(tcacc).gt.critacc\_cll) then}
\DoxyCodeLine{1639         critpointscntcten\_cll =  critpointscntcten\_cll + 1}
\DoxyCodeLine{1640         \textcolor{keywordflow}{if} ( critpointscntcten\_cll.le.noutcritpointsmax\_cll(3) ) then}
\DoxyCodeLine{1641           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TCten\_cll'},0,maxval(tcacc),critpointscntcten\_cll)}
\DoxyCodeLine{1642           \textcolor{keywordflow}{if}( critpointscntcten\_cll.eq.noutcritpointsmax\_cll(3)) then}
\DoxyCodeLine{1643             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TCten\_cll suppressed'}   }
\DoxyCodeLine{1644             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{1645           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{1646 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{1647 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TCten\_cll'},0,maxval(tcacc),critpointscntcten\_cll)}
\DoxyCodeLine{1648           \textcolor{keywordflow}{if}( critpointscntcten\_cll.eq.noutcritpointsmax\_cll(3)) then}
\DoxyCodeLine{1649             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TCten\_cll suppressed'}   }
\DoxyCodeLine{1650             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{1651           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{1652 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1653 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{1654       \textcolor{keyword}{end }if}
\DoxyCodeLine{1655     \textcolor{keyword}{end }if}
\DoxyCodeLine{1656 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_aff310970e3a35e652b807c52bdc2b8d7}\label{namespacecollier__tensors_aff310970e3a35e652b807c52bdc2b8d7}} 
\index{collier\_tensors@{collier\_tensors}!dten\_args\_cll@{dten\_args\_cll}}
\index{dten\_args\_cll@{dten\_args\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{dten\_args\_cll()}{dten\_args\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::dten\+\_\+args\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TD,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Duv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p2vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p3vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Derr }\end{DoxyParamCaption})}



Definition at line 2580 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2580 }
\DoxyCodeLine{2581     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{2582     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3), p2vec(0:3), p3vec(0:3)}
\DoxyCodeLine{2583     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p30,p20,p31,m02,m12,m22,m32}
\DoxyCodeLine{2584     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TD(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2585     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TDuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2586     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TDerr(0:rmax)}
\DoxyCodeLine{2587     \textcolor{keywordtype}{double complex} TD2(0:rmax,0:rmax,0:rmax,0:rmax), TDuv2(0:rmax,0:rmax,0:rmax,0:rmax)    }
\DoxyCodeLine{2588     \textcolor{keywordtype}{double complex} :: MomVec(0:3,3), MomInv(6), masses2(0:3)}
\DoxyCodeLine{2589     \textcolor{keywordtype}{double complex} :: CD(0:rmax/2,0:rmax,0:rmax,0:rmax) }
\DoxyCodeLine{2590     \textcolor{keywordtype}{double complex} :: CDuv(0:rmax/2,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2591     \textcolor{keywordtype}{double precision} :: CDerr(0:rmax), TDerr\_aux(0:rmax), TDerr\_aux2(0:rmax)}
\DoxyCodeLine{2592     \textcolor{keywordtype}{double complex} :: args(22)}
\DoxyCodeLine{2593     \textcolor{keywordtype}{double precision} :: TDdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TDacc(0:rmax)}
\DoxyCodeLine{2594     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3    }
\DoxyCodeLine{2595     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{2596 }
\DoxyCodeLine{2597     \textcolor{keywordflow}{if} (4.gt.nmax\_cll) then}
\DoxyCodeLine{2598       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{2599       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Dten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 4'},eflag,.true.)}
\DoxyCodeLine{2600       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{2601       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 4'}}
\DoxyCodeLine{2602       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{2603       return}
\DoxyCodeLine{2604 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{2605     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{2606       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{2607       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Dten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{2608       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{2609       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{2610       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{2611       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{2612       return}
\DoxyCodeLine{2613 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{2614    }
\DoxyCodeLine{2615     momvec(0:,1) = p1vec}
\DoxyCodeLine{2616     momvec(0:,2) = p2vec}
\DoxyCodeLine{2617     momvec(0:,3) = p3vec}
\DoxyCodeLine{2618     mominv(1) = p10}
\DoxyCodeLine{2619     mominv(2) = p21}
\DoxyCodeLine{2620     mominv(3) = p32}
\DoxyCodeLine{2621     mominv(4) = p30}
\DoxyCodeLine{2622     mominv(5) = p20}
\DoxyCodeLine{2623     mominv(6) = p31}
\DoxyCodeLine{2624     masses2(0) = m02}
\DoxyCodeLine{2625     masses2(1) = m12}
\DoxyCodeLine{2626     masses2(2) = m22}
\DoxyCodeLine{2627     masses2(3) = m32}
\DoxyCodeLine{2628 }
\DoxyCodeLine{2629     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{2630     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{2631     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{2632     args(9:12) = momvec(0:,3)}
\DoxyCodeLine{2633     args(13:18) = mominv}
\DoxyCodeLine{2634     args(19:22) = masses2(0:)}
\DoxyCodeLine{2635     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Dten\_cll'})}
\DoxyCodeLine{2636     \textcolor{keyword}{call }setmastern\_cll(4)}
\DoxyCodeLine{2637     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{2638     \textcolor{keyword}{call }setmasterargs\_cll(22,args)}
\DoxyCodeLine{2639 }
\DoxyCodeLine{2640     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{2641 }
\DoxyCodeLine{2642     }
\DoxyCodeLine{2643     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{2644       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{2645       mode\_cll = 1}
\DoxyCodeLine{2646       \textcolor{keyword}{call }d\_main\_cll(cd,cduv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6), \&}
\DoxyCodeLine{2647                       masses2(0),masses2(1),masses2(2),masses2(3),rmax,derr2=cderr,id\_in=0)    }
\DoxyCodeLine{2648       \textcolor{keyword}{call }calctensord(td,tduv,tderr\_aux,cd,cduv,cderr,momvec,rmax)}
\DoxyCodeLine{2649       }
\DoxyCodeLine{2650       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{2651       mode\_cll = 2}
\DoxyCodeLine{2652       \textcolor{keyword}{call }d\_main\_cll(cd,cduv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6), \&}
\DoxyCodeLine{2653                       masses2(0),masses2(1),masses2(2),masses2(3),rmax,derr2=cderr,id\_in=0)    }
\DoxyCodeLine{2654       \textcolor{keyword}{call }calctensord(td2,tduv2,tderr\_aux2,cd,cduv,cderr,momvec,rmax)      }
\DoxyCodeLine{2655        }
\DoxyCodeLine{2656       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{2657       mode\_cll = 3}
\DoxyCodeLine{2658       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2659         norm\_coli=0d0}
\DoxyCodeLine{2660         norm\_dd=0d0}
\DoxyCodeLine{2661         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{2662           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{2663             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{2664               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{2665               norm\_coli = max(norm\_coli,abs(td(n0,n1,n2,n3)))}
\DoxyCodeLine{2666               norm\_dd = max(norm\_dd,abs(td2(n0,n1,n2,n3)))}
\DoxyCodeLine{2667             \textcolor{keyword}{end }do}
\DoxyCodeLine{2668           \textcolor{keyword}{end }do}
\DoxyCodeLine{2669         \textcolor{keyword}{end }do}
\DoxyCodeLine{2670         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{2671           norm\_coli = max(maxval(abs(mominv(1:6))),maxval(abs(masses2(0:3))))}
\DoxyCodeLine{2672           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{2673             norm\_coli=1d0/norm\_coli**(2-\/real(r)/2)}
\DoxyCodeLine{2674           else}
\DoxyCodeLine{2675             norm\_coli=1d0/muir2\_cll**(2-\/real(r)/2)}
\DoxyCodeLine{2676           \textcolor{keyword}{end }if}
\DoxyCodeLine{2677         \textcolor{keyword}{end }if}
\DoxyCodeLine{2678         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{2679           norm\_dd = max(maxval(abs(mominv(1:6))),maxval(abs(masses2(0:3))))}
\DoxyCodeLine{2680           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{2681             norm\_dd=1d0/norm\_dd**(2-\/real(r)/2)}
\DoxyCodeLine{2682           else}
\DoxyCodeLine{2683             norm\_dd=1d0/muir2\_cll**(2-\/real(r)/2)}
\DoxyCodeLine{2684           \textcolor{keyword}{end }if}
\DoxyCodeLine{2685         \textcolor{keyword}{end }if}
\DoxyCodeLine{2686         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{2687       \textcolor{keyword}{end }do}
\DoxyCodeLine{2688       }
\DoxyCodeLine{2689       \textcolor{keyword}{call }checktensors\_cll(td,td2,momvec,mominv,masses2,norm,4,rmax,tddiff)}
\DoxyCodeLine{2690              }
\DoxyCodeLine{2691       \textcolor{keywordflow}{if} (tderr\_aux(rmax).lt.tderr\_aux2(rmax)) then}
\DoxyCodeLine{2692         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tderr))  tderr = max(tderr\_aux,tddiff*norm)}
\DoxyCodeLine{2693         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2694           tdacc(r) = max(tderr\_aux(r)/norm(r),tddiff(r))}
\DoxyCodeLine{2695         \textcolor{keyword}{end }do}
\DoxyCodeLine{2696         \textcolor{keywordflow}{if} (monitoring) pointscntdten\_coli =  pointscntdten\_coli + 1}
\DoxyCodeLine{2697       else}
\DoxyCodeLine{2698         td = td2}
\DoxyCodeLine{2699         tduv = tduv2        }
\DoxyCodeLine{2700         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tderr))  tderr = max(tderr\_aux2,tddiff*norm)    }
\DoxyCodeLine{2701         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2702           tdacc(r) = max(tderr\_aux2(r)/norm(r),tddiff(r))}
\DoxyCodeLine{2703 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{2704         \textcolor{keywordflow}{if} (monitoring) pointscntdten\_dd =  pointscntdten\_dd + 1}
\DoxyCodeLine{2705       \textcolor{keyword}{end }if}
\DoxyCodeLine{2706       }
\DoxyCodeLine{2707     \textcolor{keywordflow}{else}    }
\DoxyCodeLine{2708       \textcolor{keyword}{call }d\_main\_cll(cd,cduv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6), \&}
\DoxyCodeLine{2709                       masses2(0),masses2(1),masses2(2),masses2(3),rmax,derr2=cderr,id\_in=0)}
\DoxyCodeLine{2710 }
\DoxyCodeLine{2711       \textcolor{keyword}{call }calctensord(td,tduv,tderr\_aux,cd,cduv,cderr,momvec,rmax)}
\DoxyCodeLine{2712       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tderr)) tderr = tderr\_aux}
\DoxyCodeLine{2713       norm=0d0}
\DoxyCodeLine{2714       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2715         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{2716           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{2717             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{2718               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{2719               norm(r) = max(norm(r),abs(td(n0,n1,n2,n3)))}
\DoxyCodeLine{2720             \textcolor{keyword}{end }do}
\DoxyCodeLine{2721           \textcolor{keyword}{end }do}
\DoxyCodeLine{2722 \textcolor{keywordflow}{        end do}      }
\DoxyCodeLine{2723         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{2724           norm(r) = max(maxval(abs(mominv(1:6))),maxval(abs(masses2(0:3))))}
\DoxyCodeLine{2725           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{2726             norm(r)=1d0/norm(r)**(2-\/real(r)/2)}
\DoxyCodeLine{2727           else}
\DoxyCodeLine{2728             norm(r)=1d0/muir2\_cll**(2-\/real(r)/2)}
\DoxyCodeLine{2729           \textcolor{keyword}{end }if}
\DoxyCodeLine{2730         \textcolor{keyword}{end }if}
\DoxyCodeLine{2731         tdacc(r) = tderr\_aux(r)/norm(r)}
\DoxyCodeLine{2732 \textcolor{keywordflow}{      end do}       }
\DoxyCodeLine{2733       }
\DoxyCodeLine{2734     \textcolor{keyword}{end }if}
\DoxyCodeLine{2735 }
\DoxyCodeLine{2736     \textcolor{keyword}{call }propagateaccflag\_cll(tdacc,rmax)}
\DoxyCodeLine{2737     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{2738 }
\DoxyCodeLine{2739     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{2740       pointscntdten\_cll =  pointscntdten\_cll + 1}
\DoxyCodeLine{2741 }
\DoxyCodeLine{2742       \textcolor{keywordflow}{if}(maxval(tdacc).gt.reqacc\_cll) accpointscntdten\_cll = accpointscntdten\_cll + 1}
\DoxyCodeLine{2743 }
\DoxyCodeLine{2744       \textcolor{keywordflow}{if}(maxval(tdacc).gt.critacc\_cll) then}
\DoxyCodeLine{2745         critpointscntdten\_cll =  critpointscntdten\_cll + 1}
\DoxyCodeLine{2746         \textcolor{keywordflow}{if} ( critpointscntdten\_cll.le.noutcritpointsmax\_cll(4) ) then}
\DoxyCodeLine{2747           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TDten\_cll'},0,maxval(tdacc),critpointscntdten\_cll)}
\DoxyCodeLine{2748           \textcolor{keywordflow}{if}( critpointscntdten\_cll.eq.noutcritpointsmax\_cll(4)) then}
\DoxyCodeLine{2749             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TDten\_cll suppressed'}   }
\DoxyCodeLine{2750             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{2751           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{2752 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{2753 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TDten\_cll'},0,maxval(tdacc),critpointscntdten\_cll)}
\DoxyCodeLine{2754           \textcolor{keywordflow}{if}( critpointscntdten\_cll.eq.noutcritpointsmax\_cll(4)) then}
\DoxyCodeLine{2755             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TDten\_cll suppressed'}   }
\DoxyCodeLine{2756             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{2757           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{2758 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2759 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{2760       \textcolor{keyword}{end }if}
\DoxyCodeLine{2761     \textcolor{keyword}{end }if}
\DoxyCodeLine{2762 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_ad3ea858cb4a11696eb6418532e82221e}\label{namespacecollier__tensors_ad3ea858cb4a11696eb6418532e82221e}} 
\index{collier\_tensors@{collier\_tensors}!dten\_args\_list\_checked\_cll@{dten\_args\_list\_checked\_cll}}
\index{dten\_args\_list\_checked\_cll@{dten\_args\_list\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{dten\_args\_list\_checked\_cll()}{dten\_args\_list\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::dten\+\_\+args\+\_\+list\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TD,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Duv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p2vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p3vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Derr }\end{DoxyParamCaption})}



Definition at line 2810 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2810     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{2811     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3), p2vec(0:3), p3vec(0:3)}
\DoxyCodeLine{2812     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p30,p20,p31,m02,m12,m22,m32}
\DoxyCodeLine{2813     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TD(RtS(rmax)), TDuv(RtS(rmax))}
\DoxyCodeLine{2814     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TDerr(0:rmax)}
\DoxyCodeLine{2815     \textcolor{keywordtype}{double complex} :: TD2(RtS(rmax)), TDuv2(RtS(rmax))    }
\DoxyCodeLine{2816     \textcolor{keywordtype}{double complex} :: MomVec(0:3,3), MomInv(6), masses2(0:3)}
\DoxyCodeLine{2817     \textcolor{keywordtype}{double complex} :: CD(0:rmax/2,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2818     \textcolor{keywordtype}{double complex} :: CDuv(0:rmax/2,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2819     \textcolor{keywordtype}{double precision} :: CDerr(0:rmax), TDerr\_aux(0:rmax), TDerr\_aux2(0:rmax)}
\DoxyCodeLine{2820     \textcolor{keywordtype}{double complex} :: args(22)}
\DoxyCodeLine{2821     \textcolor{keywordtype}{double precision} :: TDdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TDacc(0:rmax)}
\DoxyCodeLine{2822     \textcolor{keywordtype}{integer} :: r,i    }
\DoxyCodeLine{2823 }
\DoxyCodeLine{2824     momvec(0:,1) = p1vec}
\DoxyCodeLine{2825     momvec(0:,2) = p2vec}
\DoxyCodeLine{2826     momvec(0:,3) = p3vec}
\DoxyCodeLine{2827     mominv(1) = p10}
\DoxyCodeLine{2828     mominv(2) = p21}
\DoxyCodeLine{2829     mominv(3) = p32}
\DoxyCodeLine{2830     mominv(4) = p30}
\DoxyCodeLine{2831     mominv(5) = p20}
\DoxyCodeLine{2832     mominv(6) = p31}
\DoxyCodeLine{2833     masses2(0) = m02}
\DoxyCodeLine{2834     masses2(1) = m12}
\DoxyCodeLine{2835     masses2(2) = m22}
\DoxyCodeLine{2836     masses2(3) = m32}
\DoxyCodeLine{2837 }
\DoxyCodeLine{2838     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{2839     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{2840     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{2841     args(9:12) = momvec(0:,3)}
\DoxyCodeLine{2842     args(13:18) = mominv}
\DoxyCodeLine{2843     args(19:22) = masses2(0:)}
\DoxyCodeLine{2844     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Dten\_cll'})}
\DoxyCodeLine{2845     \textcolor{keyword}{call }setmastern\_cll(4)}
\DoxyCodeLine{2846     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{2847     \textcolor{keyword}{call }setmasterargs\_cll(22,args)}
\DoxyCodeLine{2848 }
\DoxyCodeLine{2849     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{2850 }
\DoxyCodeLine{2851     }
\DoxyCodeLine{2852     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{2853       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{2854       mode\_cll = 1}
\DoxyCodeLine{2855       \textcolor{keyword}{call }d\_main\_cll(cd,cduv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6), \&}
\DoxyCodeLine{2856                       masses2(0),masses2(1),masses2(2),masses2(3),rmax,derr2=cderr,id\_in=0)    }
\DoxyCodeLine{2857       \textcolor{keyword}{call }calctensord\_list(td,tduv,tderr\_aux,cd,cduv,cderr,momvec,rmax)}
\DoxyCodeLine{2858       }
\DoxyCodeLine{2859       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{2860       mode\_cll = 2}
\DoxyCodeLine{2861       \textcolor{keyword}{call }d\_main\_cll(cd,cduv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6), \&}
\DoxyCodeLine{2862                       masses2(0),masses2(1),masses2(2),masses2(3),rmax,derr2=cderr,id\_in=0)    }
\DoxyCodeLine{2863       \textcolor{keyword}{call }calctensord\_list(td2,tduv2,tderr\_aux2,cd,cduv,cderr,momvec,rmax)      }
\DoxyCodeLine{2864       }
\DoxyCodeLine{2865       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{2866       mode\_cll = 3}
\DoxyCodeLine{2867       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2868         norm\_coli=0d0}
\DoxyCodeLine{2869         norm\_dd=0d0}
\DoxyCodeLine{2870         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{2871           norm\_coli = max(norm\_coli,abs(td(i)))}
\DoxyCodeLine{2872           norm\_dd = max(norm\_dd,abs(td2(i)))}
\DoxyCodeLine{2873         \textcolor{keyword}{end }do}
\DoxyCodeLine{2874         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{2875           norm\_coli = max(maxval(abs(mominv(1:6))),maxval(abs(masses2(0:3))))}
\DoxyCodeLine{2876           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{2877             norm\_coli=1d0/norm\_coli**(2-\/real(r)/2)}
\DoxyCodeLine{2878           else}
\DoxyCodeLine{2879             norm\_coli=1d0/muir2\_cll**(2-\/real(r)/2)}
\DoxyCodeLine{2880           \textcolor{keyword}{end }if}
\DoxyCodeLine{2881         \textcolor{keyword}{end }if}
\DoxyCodeLine{2882         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{2883           norm\_dd = max(maxval(abs(mominv(1:6))),maxval(abs(masses2(0:3))))}
\DoxyCodeLine{2884           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{2885             norm\_dd=1d0/norm\_dd**(2-\/real(r)/2)}
\DoxyCodeLine{2886           else}
\DoxyCodeLine{2887             norm\_dd=1d0/muir2\_cll**(2-\/real(r)/2)}
\DoxyCodeLine{2888           \textcolor{keyword}{end }if}
\DoxyCodeLine{2889         \textcolor{keyword}{end }if}
\DoxyCodeLine{2890         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{2891       \textcolor{keyword}{end }do}
\DoxyCodeLine{2892       }
\DoxyCodeLine{2893       \textcolor{keyword}{call }checktensorslist\_cll(td,td2,momvec,mominv,masses2,norm,4,rmax,tddiff)}
\DoxyCodeLine{2894        }
\DoxyCodeLine{2895       \textcolor{keywordflow}{if} (tderr\_aux(rmax).lt.tderr\_aux2(rmax)) then}
\DoxyCodeLine{2896         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tderr))  tderr = max(tderr\_aux,tddiff*norm)}
\DoxyCodeLine{2897         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2898           tdacc(r) = max(tderr\_aux(r)/norm(r),tddiff(r))}
\DoxyCodeLine{2899         \textcolor{keyword}{end }do}
\DoxyCodeLine{2900         \textcolor{keywordflow}{if} (monitoring) pointscntdten\_coli =  pointscntdten\_coli + 1}
\DoxyCodeLine{2901       else}
\DoxyCodeLine{2902         td = td2}
\DoxyCodeLine{2903         tduv = tduv2        }
\DoxyCodeLine{2904         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tderr))  tderr = max(tderr\_aux2,tddiff*norm)    }
\DoxyCodeLine{2905         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2906           tdacc(r) = max(tderr\_aux2(r)/norm(r),tddiff(r))}
\DoxyCodeLine{2907 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{2908         \textcolor{keywordflow}{if} (monitoring) pointscntdten\_dd =  pointscntdten\_dd + 1}
\DoxyCodeLine{2909 \textcolor{keywordflow}{      end if}      }
\DoxyCodeLine{2910       }
\DoxyCodeLine{2911     \textcolor{keywordflow}{else}    }
\DoxyCodeLine{2912       \textcolor{keyword}{call }d\_main\_cll(cd,cduv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6), \&}
\DoxyCodeLine{2913                       masses2(0),masses2(1),masses2(2),masses2(3),rmax,derr2=cderr,id\_in=0)    }
\DoxyCodeLine{2914     }
\DoxyCodeLine{2915       \textcolor{keyword}{call }calctensord\_list(td,tduv,tderr\_aux,cd,cduv,cderr,momvec,rmax)}
\DoxyCodeLine{2916       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tderr)) tderr = tderr\_aux}
\DoxyCodeLine{2917       norm=0d0}
\DoxyCodeLine{2918       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2919         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{2920           norm(r) = max(norm(r),abs(td(i)))      }
\DoxyCodeLine{2921 \textcolor{keywordflow}{        end do}           }
\DoxyCodeLine{2922         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{2923           norm(r) = max(maxval(abs(mominv(1:6))),maxval(abs(masses2(0:3))))}
\DoxyCodeLine{2924           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{2925             norm(r)=1d0/norm(r)**(2-\/real(r)/2)}
\DoxyCodeLine{2926           else}
\DoxyCodeLine{2927             norm(r)=1d0/muir2\_cll**(2-\/real(r)/2)}
\DoxyCodeLine{2928           \textcolor{keyword}{end }if}
\DoxyCodeLine{2929         \textcolor{keyword}{end }if}
\DoxyCodeLine{2930         tdacc(r) = tderr\_aux(r)/norm(r)}
\DoxyCodeLine{2931 \textcolor{keywordflow}{      end do}       }
\DoxyCodeLine{2932       }
\DoxyCodeLine{2933     \textcolor{keyword}{end }if}
\DoxyCodeLine{2934  }
\DoxyCodeLine{2935     \textcolor{keyword}{call }propagateaccflag\_cll(tdacc,rmax)}
\DoxyCodeLine{2936     \textcolor{keyword}{call }propagateerrflag\_cll   }
\DoxyCodeLine{2937 }
\DoxyCodeLine{2938     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{2939       pointscntdten\_cll =  pointscntdten\_cll + 1}
\DoxyCodeLine{2940 }
\DoxyCodeLine{2941       \textcolor{keywordflow}{if}(maxval(tdacc).gt.reqacc\_cll) accpointscntdten\_cll = accpointscntdten\_cll + 1}
\DoxyCodeLine{2942 }
\DoxyCodeLine{2943       \textcolor{keywordflow}{if}(maxval(tdacc).gt.critacc\_cll) then}
\DoxyCodeLine{2944         critpointscntdten\_cll =  critpointscntdten\_cll + 1}
\DoxyCodeLine{2945         \textcolor{keywordflow}{if} ( critpointscntdten\_cll.le.noutcritpointsmax\_cll(4) ) then}
\DoxyCodeLine{2946           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TDten\_cll'},0,maxval(tdacc),critpointscntdten\_cll)}
\DoxyCodeLine{2947           \textcolor{keywordflow}{if}( critpointscntdten\_cll.eq.noutcritpointsmax\_cll(4)) then}
\DoxyCodeLine{2948             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TDten\_cll suppressed'}   }
\DoxyCodeLine{2949             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{2950           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{2951 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{2952 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TDten\_cll'},0,maxval(tdacc),critpointscntdten\_cll)}
\DoxyCodeLine{2953           \textcolor{keywordflow}{if}( critpointscntdten\_cll.eq.noutcritpointsmax\_cll(4)) then}
\DoxyCodeLine{2954             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TDten\_cll suppressed'}   }
\DoxyCodeLine{2955             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{2956           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{2957 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2958 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{2959       \textcolor{keyword}{end }if}
\DoxyCodeLine{2960     \textcolor{keyword}{end }if}
\DoxyCodeLine{2961 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a3186b4583525ea94bae5f56f2b853200}\label{namespacecollier__tensors_a3186b4583525ea94bae5f56f2b853200}} 
\index{collier\_tensors@{collier\_tensors}!dten\_args\_list\_cll@{dten\_args\_list\_cll}}
\index{dten\_args\_list\_cll@{dten\_args\_list\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{dten\_args\_list\_cll()}{dten\_args\_list\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::dten\+\_\+args\+\_\+list\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:), intent(out)}]{TD,  }\item[{double complex, dimension(\+:), intent(out)}]{T\+Duv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p2vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p3vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Derr }\end{DoxyParamCaption})}



Definition at line 2777 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2777     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{2778     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3), p2vec(0:3), p3vec(0:3)}
\DoxyCodeLine{2779     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p30,p20,p31,m02,m12,m22,m32}
\DoxyCodeLine{2780     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TD(:), TDuv(:)}
\DoxyCodeLine{2781     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TDerr(0:rmax)}
\DoxyCodeLine{2782     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{2783 }
\DoxyCodeLine{2784     \textcolor{keywordflow}{if} (4.gt.nmax\_cll) then}
\DoxyCodeLine{2785       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{2786       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Dten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 4'},eflag,.true.)}
\DoxyCodeLine{2787       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{2788       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 4'}}
\DoxyCodeLine{2789       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{2790       return}
\DoxyCodeLine{2791 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{2792     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{2793       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{2794       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Dten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{2795       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{2796       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{2797       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{2798       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{2799       return}
\DoxyCodeLine{2800 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{2801     }
\DoxyCodeLine{2802     \textcolor{keyword}{call }dten\_args\_list\_checked\_cll(td,tduv,p1vec,p2vec,p3vec,p10,p21,p32,p30,p20,p31,  \&}
\DoxyCodeLine{2803                        m02,m12,m22,m32,rmax,tderr)}
\DoxyCodeLine{2804 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_af784478649f78b1da2c2f372dbb7f6bb}\label{namespacecollier__tensors_af784478649f78b1da2c2f372dbb7f6bb}} 
\index{collier\_tensors@{collier\_tensors}!dten\_list\_checked\_cll@{dten\_list\_checked\_cll}}
\index{dten\_list\_checked\_cll@{dten\_list\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{dten\_list\_checked\_cll()}{dten\_list\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::dten\+\_\+list\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TD,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Duv,  }\item[{double complex, dimension(0\+:3,3), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(6), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Derr }\end{DoxyParamCaption})}



Definition at line 2431 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2431     }
\DoxyCodeLine{2432     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{2433     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,3), MomInv(6), masses2(0:3)}
\DoxyCodeLine{2434     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TD(RtS(rmax)), TDuv(RtS(rmax))}
\DoxyCodeLine{2435     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TDerr(0:rmax)}
\DoxyCodeLine{2436     \textcolor{keywordtype}{double complex} :: TD2(RtS(rmax)), TDuv2(RtS(rmax))    }
\DoxyCodeLine{2437     \textcolor{keywordtype}{double complex} :: CD(0:rmax/2,0:rmax,0:rmax,0:rmax) }
\DoxyCodeLine{2438     \textcolor{keywordtype}{double complex} :: CDuv(0:rmax/2,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2439     \textcolor{keywordtype}{double precision} :: CDerr(0:rmax), TDerr\_aux(0:rmax), TDerr\_aux2(0:rmax)}
\DoxyCodeLine{2440     \textcolor{keywordtype}{double complex} :: args(22)}
\DoxyCodeLine{2441     \textcolor{keywordtype}{double precision} :: TDdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TDacc(0:rmax)}
\DoxyCodeLine{2442     \textcolor{keywordtype}{integer} :: r,i    }
\DoxyCodeLine{2443 }
\DoxyCodeLine{2444     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{2445     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{2446     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{2447     args(9:12) = momvec(0:,3)}
\DoxyCodeLine{2448     args(13:18) = mominv}
\DoxyCodeLine{2449     args(19:22) = masses2(0:)}
\DoxyCodeLine{2450     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Dten\_cll'})}
\DoxyCodeLine{2451     \textcolor{keyword}{call }setmastern\_cll(4)}
\DoxyCodeLine{2452     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{2453     \textcolor{keyword}{call }setmasterargs\_cll(22,args)}
\DoxyCodeLine{2454 }
\DoxyCodeLine{2455     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{2456 }
\DoxyCodeLine{2457     }
\DoxyCodeLine{2458     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{2459       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{2460       mode\_cll = 1}
\DoxyCodeLine{2461       \textcolor{keyword}{call }d\_main\_cll(cd,cduv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6), \&}
\DoxyCodeLine{2462                       masses2(0),masses2(1),masses2(2),masses2(3),rmax,derr2=cderr,id\_in=0)    }
\DoxyCodeLine{2463       \textcolor{keyword}{call }calctensord\_list(td,tduv,tderr\_aux,cd,cduv,cderr,momvec,rmax)}
\DoxyCodeLine{2464       }
\DoxyCodeLine{2465       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{2466       mode\_cll = 2}
\DoxyCodeLine{2467       \textcolor{keyword}{call }d\_main\_cll(cd,cduv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6), \&}
\DoxyCodeLine{2468                       masses2(0),masses2(1),masses2(2),masses2(3),rmax,derr2=cderr,id\_in=0)    }
\DoxyCodeLine{2469       \textcolor{keyword}{call }calctensord\_list(td2,tduv2,tderr\_aux2,cd,cduv,cderr,momvec,rmax)      }
\DoxyCodeLine{2470       }
\DoxyCodeLine{2471       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{2472       mode\_cll = 3}
\DoxyCodeLine{2473       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2474         norm\_coli=0d0}
\DoxyCodeLine{2475         norm\_dd=0d0}
\DoxyCodeLine{2476         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{2477           norm\_coli = max(norm\_coli,abs(td(i)))}
\DoxyCodeLine{2478           norm\_dd = max(norm\_dd,abs(td2(i)))}
\DoxyCodeLine{2479         \textcolor{keyword}{end }do}
\DoxyCodeLine{2480         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{2481           norm\_coli = max(maxval(abs(mominv(1:6))),maxval(abs(masses2(0:3))))}
\DoxyCodeLine{2482           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{2483             norm\_coli=1d0/norm\_coli**(2-\/real(r)/2)}
\DoxyCodeLine{2484           else}
\DoxyCodeLine{2485             norm\_coli=1d0/muir2\_cll**(2-\/real(r)/2)}
\DoxyCodeLine{2486           \textcolor{keyword}{end }if}
\DoxyCodeLine{2487         \textcolor{keyword}{end }if}
\DoxyCodeLine{2488         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{2489           norm\_dd = max(maxval(abs(mominv(1:6))),maxval(abs(masses2(0:3))))}
\DoxyCodeLine{2490           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{2491             norm\_dd=1d0/norm\_dd**(2-\/real(r)/2)}
\DoxyCodeLine{2492           else}
\DoxyCodeLine{2493             norm\_dd=1d0/muir2\_cll**(2-\/real(r)/2)}
\DoxyCodeLine{2494           \textcolor{keyword}{end }if}
\DoxyCodeLine{2495         \textcolor{keyword}{end }if}
\DoxyCodeLine{2496         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{2497       \textcolor{keyword}{end }do}
\DoxyCodeLine{2498       }
\DoxyCodeLine{2499       \textcolor{keyword}{call }checktensorslist\_cll(td,td2,momvec,mominv,masses2,norm,4,rmax,tddiff)      }
\DoxyCodeLine{2500        }
\DoxyCodeLine{2501       \textcolor{keywordflow}{if} (tderr\_aux(rmax).lt.tderr\_aux2(rmax)) then}
\DoxyCodeLine{2502         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tderr))  tderr = max(tderr\_aux,tddiff*norm)}
\DoxyCodeLine{2503         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2504           tdacc(r) = max(tderr\_aux(r)/norm(r),tddiff(r))}
\DoxyCodeLine{2505         \textcolor{keyword}{end }do}
\DoxyCodeLine{2506         \textcolor{keywordflow}{if} (monitoring) pointscntdten\_coli =  pointscntdten\_coli + 1}
\DoxyCodeLine{2507       else}
\DoxyCodeLine{2508         td = td2}
\DoxyCodeLine{2509         tduv = tduv2        }
\DoxyCodeLine{2510         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tderr))  tderr = max(tderr\_aux2,tddiff*norm)    }
\DoxyCodeLine{2511         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2512           tdacc(r) = max(tderr\_aux2(r)/norm(r),tddiff(r))}
\DoxyCodeLine{2513 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{2514         \textcolor{keywordflow}{if} (monitoring) pointscntdten\_dd =  pointscntdten\_dd + 1}
\DoxyCodeLine{2515       \textcolor{keyword}{end }if}
\DoxyCodeLine{2516       }
\DoxyCodeLine{2517     \textcolor{keywordflow}{else}    }
\DoxyCodeLine{2518       \textcolor{keyword}{call }d\_main\_cll(cd,cduv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6), \&}
\DoxyCodeLine{2519                       masses2(0),masses2(1),masses2(2),masses2(3),rmax,derr2=cderr,id\_in=0)    }
\DoxyCodeLine{2520       \textcolor{keyword}{call }calctensord\_list(td,tduv,tderr\_aux,cd,cduv,cderr,momvec,rmax)}
\DoxyCodeLine{2521       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tderr)) tderr = tderr\_aux}
\DoxyCodeLine{2522       norm=0d0}
\DoxyCodeLine{2523       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2524         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{2525           norm(r) = max(norm(r),abs(td(i)))      }
\DoxyCodeLine{2526 \textcolor{keywordflow}{        end do}            }
\DoxyCodeLine{2527         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{2528           norm(r) = max(maxval(abs(mominv(1:6))),maxval(abs(masses2(0:3))))}
\DoxyCodeLine{2529           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{2530             norm(r)=1d0/norm(r)**(2-\/real(r)/2)}
\DoxyCodeLine{2531           else}
\DoxyCodeLine{2532             norm(r)=1d0/muir2\_cll**(2-\/real(r)/2)}
\DoxyCodeLine{2533           \textcolor{keyword}{end }if}
\DoxyCodeLine{2534         \textcolor{keyword}{end }if}
\DoxyCodeLine{2535         tdacc(r) = tderr\_aux(r)/norm(r)}
\DoxyCodeLine{2536 \textcolor{keywordflow}{      end do}      }
\DoxyCodeLine{2537       }
\DoxyCodeLine{2538     \textcolor{keyword}{end }if}
\DoxyCodeLine{2539 }
\DoxyCodeLine{2540     \textcolor{keyword}{call }propagateaccflag\_cll(tdacc,rmax)}
\DoxyCodeLine{2541     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{2542 }
\DoxyCodeLine{2543     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{2544       pointscntdten\_cll =  pointscntdten\_cll + 1}
\DoxyCodeLine{2545 }
\DoxyCodeLine{2546       \textcolor{keywordflow}{if}(maxval(tdacc).gt.reqacc\_cll) accpointscntdten\_cll = accpointscntdten\_cll + 1}
\DoxyCodeLine{2547 }
\DoxyCodeLine{2548       \textcolor{keywordflow}{if}(maxval(tdacc).gt.critacc\_cll) then}
\DoxyCodeLine{2549         critpointscntdten\_cll =  critpointscntdten\_cll + 1}
\DoxyCodeLine{2550         \textcolor{keywordflow}{if} ( critpointscntdten\_cll.le.noutcritpointsmax\_cll(4) ) then}
\DoxyCodeLine{2551           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TDten\_cll'},0,maxval(tdacc),critpointscntdten\_cll)}
\DoxyCodeLine{2552           \textcolor{keywordflow}{if}( critpointscntdten\_cll.eq.noutcritpointsmax\_cll(4)) then}
\DoxyCodeLine{2553             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TDten\_cll suppressed'}   }
\DoxyCodeLine{2554             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{2555           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{2556 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{2557 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TDten\_cll'},0,maxval(tdacc),critpointscntdten\_cll)}
\DoxyCodeLine{2558           \textcolor{keywordflow}{if}( critpointscntdten\_cll.eq.noutcritpointsmax\_cll(4)) then}
\DoxyCodeLine{2559             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TDten\_cll suppressed'}   }
\DoxyCodeLine{2560             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{2561           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{2562 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2563 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{2564       \textcolor{keyword}{end }if}
\DoxyCodeLine{2565     \textcolor{keyword}{end }if}
\DoxyCodeLine{2566 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a765e8219d0bb652c3286f081a9f6643a}\label{namespacecollier__tensors_a765e8219d0bb652c3286f081a9f6643a}} 
\index{collier\_tensors@{collier\_tensors}!dten\_list\_cll@{dten\_list\_cll}}
\index{dten\_list\_cll@{dten\_list\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{dten\_list\_cll()}{dten\_list\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::dten\+\_\+list\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:), intent(out)}]{TD,  }\item[{double complex, dimension(\+:), intent(out)}]{T\+Duv,  }\item[{double complex, dimension(0\+:3,3), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(6), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Derr }\end{DoxyParamCaption})}



Definition at line 2400 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2400     }
\DoxyCodeLine{2401     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{2402     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,3), MomInv(6), masses2(0:3)}
\DoxyCodeLine{2403     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TD(:), TDuv(:)}
\DoxyCodeLine{2404     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TDerr(0:rmax)}
\DoxyCodeLine{2405     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{2406 }
\DoxyCodeLine{2407     \textcolor{keywordflow}{if} (4.gt.nmax\_cll) then}
\DoxyCodeLine{2408       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{2409       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Dten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 4'},eflag,.true.)}
\DoxyCodeLine{2410       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{2411       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 4'}}
\DoxyCodeLine{2412       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{2413       return}
\DoxyCodeLine{2414 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{2415     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{2416       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{2417       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Dten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{2418       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{2419       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{2420       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{2421       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{2422       return}
\DoxyCodeLine{2423 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{2424     }
\DoxyCodeLine{2425     \textcolor{keyword}{call }dten\_list\_checked\_cll(td,tduv,momvec,mominv,masses2,rmax,tderr)}
\DoxyCodeLine{2426 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_abf1d5364cb033985f5fde40ea856941c}\label{namespacecollier__tensors_abf1d5364cb033985f5fde40ea856941c}} 
\index{collier\_tensors@{collier\_tensors}!dten\_main\_cll@{dten\_main\_cll}}
\index{dten\_main\_cll@{dten\_main\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{dten\_main\_cll()}{dten\_main\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::dten\+\_\+main\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TD,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Duv,  }\item[{double complex, dimension(0\+:3,3), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(6), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Derr }\end{DoxyParamCaption})}



Definition at line 2222 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2222   }
\DoxyCodeLine{2223     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{2224     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,3), MomInv(6), masses2(0:3)}
\DoxyCodeLine{2225     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TD(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2226     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TDuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2227     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TDerr(0:rmax)}
\DoxyCodeLine{2228     \textcolor{keywordtype}{double complex} :: CD(0:rmax/2,0:rmax,0:rmax,0:rmax) }
\DoxyCodeLine{2229     \textcolor{keywordtype}{double complex} :: TD2(0:rmax,0:rmax,0:rmax,0:rmax), TDuv2(0:rmax,0:rmax,0:rmax,0:rmax)    }
\DoxyCodeLine{2230     \textcolor{keywordtype}{double complex} :: CDuv(0:rmax/2,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2231     \textcolor{keywordtype}{double precision} :: CDerr(0:rmax), TDerr\_aux(0:rmax), TDerr\_aux2(0:rmax)}
\DoxyCodeLine{2232     \textcolor{keywordtype}{double complex} :: args(22)}
\DoxyCodeLine{2233     \textcolor{keywordtype}{double precision} :: TDdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TDacc(0:rmax)}
\DoxyCodeLine{2234     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3    }
\DoxyCodeLine{2235     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{2236 }
\DoxyCodeLine{2237     \textcolor{keywordflow}{if} (4.gt.nmax\_cll) then}
\DoxyCodeLine{2238       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{2239       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Dten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 4'},eflag,.true.)}
\DoxyCodeLine{2240       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{2241       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 4'}}
\DoxyCodeLine{2242       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{2243       return}
\DoxyCodeLine{2244 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{2245     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{2246       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{2247       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Dten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{2248       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{2249       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{2250       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{2251       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{2252       return}
\DoxyCodeLine{2253 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{2254 }
\DoxyCodeLine{2255     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{2256     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{2257     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{2258     args(9:12) = momvec(0:,3)}
\DoxyCodeLine{2259     args(13:18) = mominv}
\DoxyCodeLine{2260     args(19:22) = masses2(0:)}
\DoxyCodeLine{2261     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Dten\_cll'})}
\DoxyCodeLine{2262     \textcolor{keyword}{call }setmastern\_cll(4)}
\DoxyCodeLine{2263     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{2264     \textcolor{keyword}{call }setmasterargs\_cll(22,args)}
\DoxyCodeLine{2265 }
\DoxyCodeLine{2266     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{2267     }
\DoxyCodeLine{2268     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{2269       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{2270       mode\_cll = 1}
\DoxyCodeLine{2271       \textcolor{keyword}{call }d\_main\_cll(cd,cduv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6), \&}
\DoxyCodeLine{2272                       masses2(0),masses2(1),masses2(2),masses2(3),rmax,derr2=cderr,id\_in=0)    }
\DoxyCodeLine{2273       \textcolor{keyword}{call }calctensord(td,tduv,tderr\_aux,cd,cduv,cderr,momvec,rmax)}
\DoxyCodeLine{2274       }
\DoxyCodeLine{2275       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{2276       mode\_cll = 2}
\DoxyCodeLine{2277       \textcolor{keyword}{call }d\_main\_cll(cd,cduv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6), \&}
\DoxyCodeLine{2278                       masses2(0),masses2(1),masses2(2),masses2(3),rmax,derr2=cderr,id\_in=0)    }
\DoxyCodeLine{2279       \textcolor{keyword}{call }calctensord(td2,tduv2,tderr\_aux2,cd,cduv,cderr,momvec,rmax)      }
\DoxyCodeLine{2280       }
\DoxyCodeLine{2281       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{2282       mode\_cll = 3}
\DoxyCodeLine{2283       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2284         norm\_coli=0d0}
\DoxyCodeLine{2285         norm\_dd=0d0}
\DoxyCodeLine{2286         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{2287           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{2288             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{2289               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{2290               norm\_coli = max(norm\_coli,abs(td(n0,n1,n2,n3)))}
\DoxyCodeLine{2291               norm\_dd = max(norm\_dd,abs(td2(n0,n1,n2,n3)))}
\DoxyCodeLine{2292             \textcolor{keyword}{end }do}
\DoxyCodeLine{2293           \textcolor{keyword}{end }do}
\DoxyCodeLine{2294         \textcolor{keyword}{end }do}
\DoxyCodeLine{2295         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{2296           norm\_coli = max(maxval(abs(mominv(1:6))),maxval(abs(masses2(0:3))))}
\DoxyCodeLine{2297           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{2298             norm\_coli=1d0/norm\_coli**(2-\/real(r)/2)}
\DoxyCodeLine{2299           else}
\DoxyCodeLine{2300             norm\_coli=1d0/muir2\_cll**(2-\/real(r)/2)}
\DoxyCodeLine{2301           \textcolor{keyword}{end }if}
\DoxyCodeLine{2302         \textcolor{keyword}{end }if}
\DoxyCodeLine{2303         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{2304           norm\_dd = max(maxval(abs(mominv(1:6))),maxval(abs(masses2(0:3))))}
\DoxyCodeLine{2305           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{2306             norm\_dd=1d0/norm\_dd**(2-\/real(r)/2)}
\DoxyCodeLine{2307           else}
\DoxyCodeLine{2308             norm\_dd=1d0/muir2\_cll**(2-\/real(r)/2)}
\DoxyCodeLine{2309           \textcolor{keyword}{end }if}
\DoxyCodeLine{2310         \textcolor{keyword}{end }if}
\DoxyCodeLine{2311         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{2312       \textcolor{keyword}{end }do}
\DoxyCodeLine{2313       }
\DoxyCodeLine{2314       \textcolor{keyword}{call }checktensors\_cll(td,td2,momvec,mominv,masses2,norm,4,rmax,tddiff)      }
\DoxyCodeLine{2315        }
\DoxyCodeLine{2316       \textcolor{keywordflow}{if} (tderr\_aux(rmax).lt.tderr\_aux2(rmax)) then}
\DoxyCodeLine{2317         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tderr))  tderr = max(tderr\_aux,tddiff*norm)}
\DoxyCodeLine{2318         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2319           tdacc(r) = max(tderr\_aux(r)/norm(r),tddiff(r))}
\DoxyCodeLine{2320         \textcolor{keyword}{end }do}
\DoxyCodeLine{2321         \textcolor{keywordflow}{if} (monitoring) pointscntdten\_coli =  pointscntdten\_coli + 1}
\DoxyCodeLine{2322       else}
\DoxyCodeLine{2323         td = td2}
\DoxyCodeLine{2324         tduv = tduv2        }
\DoxyCodeLine{2325         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tderr))  tderr = max(tderr\_aux2,tddiff*norm)    }
\DoxyCodeLine{2326         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2327           tdacc(r) = max(tderr\_aux2(r)/norm(r),tddiff(r))}
\DoxyCodeLine{2328 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{2329         \textcolor{keywordflow}{if} (monitoring) pointscntdten\_dd =  pointscntdten\_dd + 1}
\DoxyCodeLine{2330       \textcolor{keyword}{end }if}
\DoxyCodeLine{2331       }
\DoxyCodeLine{2332     else}
\DoxyCodeLine{2333       \textcolor{keyword}{call }d\_main\_cll(cd,cduv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6), \&}
\DoxyCodeLine{2334                       masses2(0),masses2(1),masses2(2),masses2(3),rmax,derr2=cderr,id\_in=0)    }
\DoxyCodeLine{2335       \textcolor{keyword}{call }calctensord(td,tduv,tderr\_aux,cd,cduv,cderr,momvec,rmax)}
\DoxyCodeLine{2336       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tderr)) tderr = tderr\_aux}
\DoxyCodeLine{2337       norm=0d0}
\DoxyCodeLine{2338       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{2339         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{2340           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{2341             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{2342               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{2343               norm(r) = max(norm(r),abs(td(n0,n1,n2,n3)))}
\DoxyCodeLine{2344             \textcolor{keyword}{end }do}
\DoxyCodeLine{2345           \textcolor{keyword}{end }do}
\DoxyCodeLine{2346 \textcolor{keywordflow}{        end do}      }
\DoxyCodeLine{2347         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{2348           norm(r) = max(maxval(abs(mominv(1:6))),maxval(abs(masses2(0:3))))}
\DoxyCodeLine{2349           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{2350             norm(r)=1d0/norm(r)**(2-\/real(r)/2)}
\DoxyCodeLine{2351           else}
\DoxyCodeLine{2352             norm(r)=1d0/muir2\_cll**(2-\/real(r)/2)}
\DoxyCodeLine{2353           \textcolor{keyword}{end }if}
\DoxyCodeLine{2354         \textcolor{keyword}{end }if}
\DoxyCodeLine{2355         tdacc(r) = tderr\_aux(r)/norm(r)}
\DoxyCodeLine{2356 \textcolor{keywordflow}{      end do}       }
\DoxyCodeLine{2357       }
\DoxyCodeLine{2358     \textcolor{keyword}{end }if}
\DoxyCodeLine{2359 }
\DoxyCodeLine{2360     \textcolor{keyword}{call }propagateaccflag\_cll(tdacc,rmax)}
\DoxyCodeLine{2361     \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{2362     }
\DoxyCodeLine{2363     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{2364       pointscntdten\_cll =  pointscntdten\_cll + 1}
\DoxyCodeLine{2365 }
\DoxyCodeLine{2366       \textcolor{keywordflow}{if}(maxval(tdacc).gt.reqacc\_cll) accpointscntdten\_cll = accpointscntdten\_cll + 1}
\DoxyCodeLine{2367 }
\DoxyCodeLine{2368       \textcolor{keywordflow}{if}(maxval(tdacc).gt.critacc\_cll) then}
\DoxyCodeLine{2369         critpointscntdten\_cll =  critpointscntdten\_cll + 1}
\DoxyCodeLine{2370         \textcolor{keywordflow}{if} ( critpointscntdten\_cll.le.noutcritpointsmax\_cll(4) ) then}
\DoxyCodeLine{2371           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TDten\_cll'},0,maxval(tdacc),critpointscntdten\_cll)}
\DoxyCodeLine{2372           \textcolor{keywordflow}{if}( critpointscntdten\_cll.eq.noutcritpointsmax\_cll(4)) then}
\DoxyCodeLine{2373             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TDten\_cll suppressed'}   }
\DoxyCodeLine{2374             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{2375           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{2376 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{2377 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TDten\_cll'},0,maxval(tdacc),critpointscntdten\_cll)}
\DoxyCodeLine{2378           \textcolor{keywordflow}{if}( critpointscntdten\_cll.eq.noutcritpointsmax\_cll(4)) then}
\DoxyCodeLine{2379             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TDten\_cll suppressed'}   }
\DoxyCodeLine{2380             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{2381           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{2382 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2383 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{2384       \textcolor{keyword}{end }if}
\DoxyCodeLine{2385     \textcolor{keyword}{end }if}
\DoxyCodeLine{2386 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_ac0085ba5950e0ffb5099366ac8432ba0}\label{namespacecollier__tensors_ac0085ba5950e0ffb5099366ac8432ba0}} 
\index{collier\_tensors@{collier\_tensors}!eten\_args\_cll@{eten\_args\_cll}}
\index{eten\_args\_cll@{eten\_args\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{eten\_args\_cll()}{eten\_args\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::eten\+\_\+args\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TE,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Euv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p2vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p3vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p4vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p43,  }\item[{double complex, intent(in)}]{p40,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{p42,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p41,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{double complex, intent(in)}]{m42,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Eerr }\end{DoxyParamCaption})}



Definition at line 3341 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{3341   }
\DoxyCodeLine{3342     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{3343     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3),p2vec(0:3),p3vec(0:3),p4vec(0:3)}
\DoxyCodeLine{3344     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p43,p40,p20,p31,p42,p30,p41}
\DoxyCodeLine{3345     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: m02,m12,m22,m32,m42}
\DoxyCodeLine{3346     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TE(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3347     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TEuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3348     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TEerr(0:rmax)}
\DoxyCodeLine{3349     \textcolor{keywordtype}{double complex} :: TE2(0:rmax,0:rmax,0:rmax,0:rmax), TEuv2(0:rmax,0:rmax,0:rmax,0:rmax)    }
\DoxyCodeLine{3350     \textcolor{keywordtype}{double complex} :: MomVec(0:3,4), MomInv(10), masses2(0:4)}
\DoxyCodeLine{3351     \textcolor{keywordtype}{double complex} :: CE(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax) }
\DoxyCodeLine{3352     \textcolor{keywordtype}{double complex} :: CEuv(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3353     \textcolor{keywordtype}{double precision} :: CEerr(0:rmax), TEerr\_aux(0:rmax), TEerr\_aux2(0:rmax)  }
\DoxyCodeLine{3354     \textcolor{keywordtype}{double complex} :: args(31)}
\DoxyCodeLine{3355     \textcolor{keywordtype}{double precision} :: TEdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TEacc(0:rmax)}
\DoxyCodeLine{3356     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3    }
\DoxyCodeLine{3357     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{3358 }
\DoxyCodeLine{3359     \textcolor{keywordflow}{if} (5.gt.nmax\_cll) then}
\DoxyCodeLine{3360       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{3361       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Eten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 5'},eflag,.true.)}
\DoxyCodeLine{3362       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{3363       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 5'}}
\DoxyCodeLine{3364       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{3365       return}
\DoxyCodeLine{3366 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{3367     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{3368       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{3369       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Eten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{3370       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{3371       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{3372       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{3373       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{3374       return}
\DoxyCodeLine{3375 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{3376 }
\DoxyCodeLine{3377     momvec(0:,1) = p1vec}
\DoxyCodeLine{3378     momvec(0:,2) = p2vec}
\DoxyCodeLine{3379     momvec(0:,3) = p3vec}
\DoxyCodeLine{3380     momvec(0:,4) = p4vec}
\DoxyCodeLine{3381     mominv(1) = p10}
\DoxyCodeLine{3382     mominv(2) = p21}
\DoxyCodeLine{3383     mominv(3) = p32}
\DoxyCodeLine{3384     mominv(4) = p43}
\DoxyCodeLine{3385     mominv(5) = p40}
\DoxyCodeLine{3386     mominv(6) = p20}
\DoxyCodeLine{3387     mominv(7) = p31}
\DoxyCodeLine{3388     mominv(8) = p42}
\DoxyCodeLine{3389     mominv(9) = p30}
\DoxyCodeLine{3390     mominv(10) = p41}
\DoxyCodeLine{3391     masses2(0) = m02}
\DoxyCodeLine{3392     masses2(1) = m12}
\DoxyCodeLine{3393     masses2(2) = m22}
\DoxyCodeLine{3394     masses2(3) = m32}
\DoxyCodeLine{3395     masses2(4) = m42}
\DoxyCodeLine{3396     }
\DoxyCodeLine{3397     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{3398     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{3399     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{3400     args(9:12) = momvec(0:,3)}
\DoxyCodeLine{3401     args(13:16) = momvec(0:,4)}
\DoxyCodeLine{3402     args(17:26) = mominv}
\DoxyCodeLine{3403     args(27:31) = masses2}
\DoxyCodeLine{3404     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Eten\_cll'})}
\DoxyCodeLine{3405     \textcolor{keyword}{call }setmastern\_cll(5)}
\DoxyCodeLine{3406     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{3407     \textcolor{keyword}{call }setmasterargs\_cll(31,args)}
\DoxyCodeLine{3408 }
\DoxyCodeLine{3409     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{3410 }
\DoxyCodeLine{3411     }
\DoxyCodeLine{3412     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{3413       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{3414       mode\_cll = 1}
\DoxyCodeLine{3415       \textcolor{keyword}{call }e\_main\_cll(ce,ceuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{3416                       mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),masses2(0), \&}
\DoxyCodeLine{3417                       masses2(1),masses2(2),masses2(3),masses2(4),rmax,eerr2=ceerr,id\_in=0)}
\DoxyCodeLine{3418       \textcolor{keyword}{call }calctensore(te,teuv,teerr\_aux,ce,ceuv,ceerr,momvec,rmax)                      }
\DoxyCodeLine{3419       }
\DoxyCodeLine{3420       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{3421       mode\_cll = 2}
\DoxyCodeLine{3422       \textcolor{keyword}{call }e\_main\_cll(ce,ceuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{3423                       mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),masses2(0), \&}
\DoxyCodeLine{3424                       masses2(1),masses2(2),masses2(3),masses2(4),rmax,eerr2=ceerr,id\_in=0)}
\DoxyCodeLine{3425       \textcolor{keyword}{call }calctensore(te2,teuv2,teerr\_aux2,ce,ceuv,ceerr,momvec,rmax)                          }
\DoxyCodeLine{3426       }
\DoxyCodeLine{3427       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{3428       mode\_cll = 3}
\DoxyCodeLine{3429       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3430         norm\_coli=0d0}
\DoxyCodeLine{3431         norm\_dd=0d0}
\DoxyCodeLine{3432         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{3433           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{3434             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{3435               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{3436               norm\_coli = max(norm\_coli,abs(te(n0,n1,n2,n3)))}
\DoxyCodeLine{3437               norm\_dd = max(norm\_dd,abs(te2(n0,n1,n2,n3)))}
\DoxyCodeLine{3438             \textcolor{keyword}{end }do}
\DoxyCodeLine{3439           \textcolor{keyword}{end }do}
\DoxyCodeLine{3440         \textcolor{keyword}{end }do}
\DoxyCodeLine{3441         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{3442           norm\_coli = max(maxval(abs(mominv(1:10))),maxval(abs(masses2(0:4))))}
\DoxyCodeLine{3443           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{3444             norm\_coli=1d0/norm\_coli**(3-\/real(r)/2)}
\DoxyCodeLine{3445           else}
\DoxyCodeLine{3446             norm\_coli=1d0/muir2\_cll**(3-\/real(r)/2)}
\DoxyCodeLine{3447           \textcolor{keyword}{end }if}
\DoxyCodeLine{3448         \textcolor{keyword}{end }if}
\DoxyCodeLine{3449         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{3450           norm\_dd = max(maxval(abs(mominv(1:10))),maxval(abs(masses2(0:4))))}
\DoxyCodeLine{3451           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{3452             norm\_dd=1d0/norm\_dd**(3-\/real(r)/2)}
\DoxyCodeLine{3453           else}
\DoxyCodeLine{3454             norm\_dd=1d0/muir2\_cll**(3-\/real(r)/2)}
\DoxyCodeLine{3455           \textcolor{keyword}{end }if}
\DoxyCodeLine{3456         \textcolor{keyword}{end }if}
\DoxyCodeLine{3457         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{3458       \textcolor{keyword}{end }do}
\DoxyCodeLine{3459       }
\DoxyCodeLine{3460       \textcolor{keyword}{call }checktensors\_cll(te,te2,momvec,mominv,masses2,norm,5,rmax,tediff)      }
\DoxyCodeLine{3461        }
\DoxyCodeLine{3462       \textcolor{keywordflow}{if} (teerr\_aux(rmax).lt.teerr\_aux2(rmax)) then}
\DoxyCodeLine{3463         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(teerr))  teerr = max(teerr\_aux,tediff*norm)}
\DoxyCodeLine{3464         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3465           teacc(r) = max(teerr\_aux(r)/norm(r),tediff(r))}
\DoxyCodeLine{3466         \textcolor{keyword}{end }do}
\DoxyCodeLine{3467         \textcolor{keywordflow}{if} (monitoring) pointscnteten\_coli =  pointscnteten\_coli + 1}
\DoxyCodeLine{3468       else}
\DoxyCodeLine{3469         te = te2}
\DoxyCodeLine{3470         teuv = teuv2        }
\DoxyCodeLine{3471         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(teerr))  teerr = max(teerr\_aux2,tediff*norm)    }
\DoxyCodeLine{3472         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3473           teacc(r) = max(teerr\_aux2(r)/norm(r),tediff(r))}
\DoxyCodeLine{3474 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{3475         \textcolor{keywordflow}{if} (monitoring) pointscnteten\_dd =  pointscnteten\_dd + 1}
\DoxyCodeLine{3476       \textcolor{keyword}{end }if}
\DoxyCodeLine{3477       }
\DoxyCodeLine{3478     else}
\DoxyCodeLine{3479       \textcolor{keyword}{call }e\_main\_cll(ce,ceuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{3480                       mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),masses2(0), \&}
\DoxyCodeLine{3481                       masses2(1),masses2(2),masses2(3),masses2(4),rmax,eerr2=ceerr,id\_in=0)}
\DoxyCodeLine{3482       \textcolor{keyword}{call }calctensore(te,teuv,teerr\_aux,ce,ceuv,ceerr,momvec,rmax)}
\DoxyCodeLine{3483       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(teerr)) teerr = teerr\_aux}
\DoxyCodeLine{3484       norm = 0d0}
\DoxyCodeLine{3485       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3486         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{3487           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{3488             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{3489               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{3490               norm(r) = max(norm(r),abs(te(n0,n1,n2,n3)))}
\DoxyCodeLine{3491             \textcolor{keyword}{end }do}
\DoxyCodeLine{3492           \textcolor{keyword}{end }do}
\DoxyCodeLine{3493 \textcolor{keywordflow}{        end do}      }
\DoxyCodeLine{3494         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{3495           norm(r) = max(maxval(abs(mominv(1:10))),maxval(abs(masses2(0:4))))}
\DoxyCodeLine{3496           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{3497             norm(r)=1d0/norm(r)**(3-\/real(r)/2)}
\DoxyCodeLine{3498           else}
\DoxyCodeLine{3499             norm(r)=1d0/muir2\_cll**(3-\/real(r)/2)}
\DoxyCodeLine{3500           \textcolor{keyword}{end }if}
\DoxyCodeLine{3501         \textcolor{keyword}{end }if}
\DoxyCodeLine{3502         teacc(r) = teerr\_aux(r)/norm(r)}
\DoxyCodeLine{3503 \textcolor{keywordflow}{      end do}      }
\DoxyCodeLine{3504       }
\DoxyCodeLine{3505     \textcolor{keyword}{end }if}
\DoxyCodeLine{3506 }
\DoxyCodeLine{3507     \textcolor{keyword}{call }propagateaccflag\_cll(teacc,rmax)}
\DoxyCodeLine{3508     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{3509 }
\DoxyCodeLine{3510     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{3511       pointscnteten\_cll =  pointscnteten\_cll + 1}
\DoxyCodeLine{3512 }
\DoxyCodeLine{3513       \textcolor{keywordflow}{if}(maxval(teacc).gt.reqacc\_cll) accpointscnteten\_cll = accpointscnteten\_cll + 1}
\DoxyCodeLine{3514 }
\DoxyCodeLine{3515       \textcolor{keywordflow}{if}(maxval(teacc).gt.critacc\_cll) then}
\DoxyCodeLine{3516         critpointscnteten\_cll =  critpointscnteten\_cll + 1}
\DoxyCodeLine{3517         \textcolor{keywordflow}{if} ( critpointscnteten\_cll.le.noutcritpointsmax\_cll(5) ) then}
\DoxyCodeLine{3518           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TEten\_cll'},0,maxval(teacc),critpointscnteten\_cll)}
\DoxyCodeLine{3519           \textcolor{keywordflow}{if}( critpointscnteten\_cll.eq.noutcritpointsmax\_cll(5)) then}
\DoxyCodeLine{3520             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TEten\_cll suppressed'}   }
\DoxyCodeLine{3521             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{3522           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{3523 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{3524 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TEten\_cll'},0,maxval(teacc),critpointscnteten\_cll)}
\DoxyCodeLine{3525           \textcolor{keywordflow}{if}( critpointscnteten\_cll.eq.noutcritpointsmax\_cll(5)) then}
\DoxyCodeLine{3526             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TEten\_cll suppressed'}   }
\DoxyCodeLine{3527             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{3528           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{3529 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3530 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{3531       \textcolor{keyword}{end }if}
\DoxyCodeLine{3532     \textcolor{keyword}{end }if}
\DoxyCodeLine{3533 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_ae455f8dfeb8689c700207c33c5030652}\label{namespacecollier__tensors_ae455f8dfeb8689c700207c33c5030652}} 
\index{collier\_tensors@{collier\_tensors}!eten\_args\_list\_checked\_cll@{eten\_args\_list\_checked\_cll}}
\index{eten\_args\_list\_checked\_cll@{eten\_args\_list\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{eten\_args\_list\_checked\_cll()}{eten\_args\_list\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::eten\+\_\+args\+\_\+list\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TE,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Euv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p2vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p3vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p4vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p43,  }\item[{double complex, intent(in)}]{p40,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{p42,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p41,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{double complex, intent(in)}]{m42,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Eerr }\end{DoxyParamCaption})}



Definition at line 3592 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{3592 }
\DoxyCodeLine{3593     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{3594     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3),p2vec(0:3),p3vec(0:3),p4vec(0:3)}
\DoxyCodeLine{3595     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p43,p40,p20,p31,p42,p30,p41}
\DoxyCodeLine{3596     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: m02,m12,m22,m32,m42}
\DoxyCodeLine{3597     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TE(RtS(rmax)), TEuv(RtS(rmax))}
\DoxyCodeLine{3598     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TEerr(0:rmax)}
\DoxyCodeLine{3599     \textcolor{keywordtype}{double complex} :: TE2(RtS(rmax)), TEuv2(RtS(rmax))   }
\DoxyCodeLine{3600     \textcolor{keywordtype}{double complex} :: MomVec(0:3,4), MomInv(10), masses2(0:4)}
\DoxyCodeLine{3601     \textcolor{keywordtype}{double complex} :: CE(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3602     \textcolor{keywordtype}{double complex} :: CEuv(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3603     \textcolor{keywordtype}{double precision} :: CEerr(0:rmax), TEerr\_aux(0:rmax), TEerr\_aux2(0:rmax)}
\DoxyCodeLine{3604     \textcolor{keywordtype}{double complex} :: args(31)}
\DoxyCodeLine{3605     \textcolor{keywordtype}{double precision} :: TEdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TEacc(0:rmax)}
\DoxyCodeLine{3606     \textcolor{keywordtype}{integer} :: r,i    }
\DoxyCodeLine{3607     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{3608 }
\DoxyCodeLine{3609     momvec(0:,1) = p1vec}
\DoxyCodeLine{3610     momvec(0:,2) = p2vec}
\DoxyCodeLine{3611     momvec(0:,3) = p3vec}
\DoxyCodeLine{3612     momvec(0:,4) = p4vec}
\DoxyCodeLine{3613     mominv(1) = p10}
\DoxyCodeLine{3614     mominv(2) = p21}
\DoxyCodeLine{3615     mominv(3) = p32}
\DoxyCodeLine{3616     mominv(4) = p43}
\DoxyCodeLine{3617     mominv(5) = p40}
\DoxyCodeLine{3618     mominv(6) = p20}
\DoxyCodeLine{3619     mominv(7) = p31}
\DoxyCodeLine{3620     mominv(8) = p42}
\DoxyCodeLine{3621     mominv(9) = p30}
\DoxyCodeLine{3622     mominv(10) = p41}
\DoxyCodeLine{3623     masses2(0) = m02}
\DoxyCodeLine{3624     masses2(1) = m12}
\DoxyCodeLine{3625     masses2(2) = m22}
\DoxyCodeLine{3626     masses2(3) = m32}
\DoxyCodeLine{3627     masses2(4) = m42    }
\DoxyCodeLine{3628      }
\DoxyCodeLine{3629     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{3630     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{3631     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{3632     args(9:12) = momvec(0:,3)}
\DoxyCodeLine{3633     args(13:16) = momvec(0:,4)}
\DoxyCodeLine{3634     args(17:26) = mominv}
\DoxyCodeLine{3635     args(27:31) = masses2}
\DoxyCodeLine{3636     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Eten\_cll'})}
\DoxyCodeLine{3637     \textcolor{keyword}{call }setmastern\_cll(5)}
\DoxyCodeLine{3638     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{3639     \textcolor{keyword}{call }setmasterargs\_cll(31,args)}
\DoxyCodeLine{3640 }
\DoxyCodeLine{3641     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{3642 }
\DoxyCodeLine{3643     }
\DoxyCodeLine{3644     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{3645       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{3646       mode\_cll = 1}
\DoxyCodeLine{3647       \textcolor{keyword}{call }e\_main\_cll(ce,ceuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{3648                       mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),masses2(0), \&}
\DoxyCodeLine{3649                       masses2(1),masses2(2),masses2(3),masses2(4),rmax,eerr2=ceerr,id\_in=0)}
\DoxyCodeLine{3650       \textcolor{keyword}{call }calctensore(te,teuv,teerr\_aux,ce,ceuv,ceerr,momvec,rmax)                      }
\DoxyCodeLine{3651       }
\DoxyCodeLine{3652       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{3653       mode\_cll = 2}
\DoxyCodeLine{3654       \textcolor{keyword}{call }e\_main\_cll(ce,ceuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{3655                       mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),masses2(0), \&}
\DoxyCodeLine{3656                       masses2(1),masses2(2),masses2(3),masses2(4),rmax,eerr2=ceerr,id\_in=0)}
\DoxyCodeLine{3657       \textcolor{keyword}{call }calctensore(te2,teuv2,teerr\_aux2,ce,ceuv,ceerr,momvec,rmax)                          }
\DoxyCodeLine{3658       }
\DoxyCodeLine{3659       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{3660       mode\_cll = 3}
\DoxyCodeLine{3661       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3662         norm\_coli=0d0}
\DoxyCodeLine{3663         norm\_dd=0d0}
\DoxyCodeLine{3664         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{3665           norm\_coli = max(norm\_coli,abs(te(i)))}
\DoxyCodeLine{3666           norm\_dd = max(norm\_dd,abs(te2(i)))}
\DoxyCodeLine{3667         \textcolor{keyword}{end }do}
\DoxyCodeLine{3668         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{3669           norm\_coli = max(maxval(abs(mominv(1:10))),maxval(abs(masses2(0:4))))}
\DoxyCodeLine{3670           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{3671             norm\_coli=1d0/norm\_coli**(3-\/real(r)/2)}
\DoxyCodeLine{3672           else}
\DoxyCodeLine{3673             norm\_coli=1d0/muir2\_cll**(3-\/real(r)/2)}
\DoxyCodeLine{3674           \textcolor{keyword}{end }if}
\DoxyCodeLine{3675         \textcolor{keyword}{end }if}
\DoxyCodeLine{3676         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{3677           norm\_dd = max(maxval(abs(mominv(1:10))),maxval(abs(masses2(0:4))))}
\DoxyCodeLine{3678           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{3679             norm\_dd=1d0/norm\_dd**(3-\/real(r)/2)}
\DoxyCodeLine{3680           else}
\DoxyCodeLine{3681             norm\_dd=1d0/muir2\_cll**(3-\/real(r)/2)}
\DoxyCodeLine{3682           \textcolor{keyword}{end }if}
\DoxyCodeLine{3683         \textcolor{keyword}{end }if}
\DoxyCodeLine{3684         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{3685       \textcolor{keyword}{end }do}
\DoxyCodeLine{3686       }
\DoxyCodeLine{3687       \textcolor{keyword}{call }checktensorslist\_cll(te,te2,momvec,mominv,masses2,norm,5,rmax,tediff)      }
\DoxyCodeLine{3688        }
\DoxyCodeLine{3689       \textcolor{keywordflow}{if} (teerr\_aux(rmax).lt.teerr\_aux2(rmax)) then}
\DoxyCodeLine{3690         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(teerr))  teerr = max(teerr\_aux,tediff*norm)}
\DoxyCodeLine{3691         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3692           teacc(r) = max(teerr\_aux(r)/norm(r),tediff(r))}
\DoxyCodeLine{3693         \textcolor{keyword}{end }do}
\DoxyCodeLine{3694         \textcolor{keywordflow}{if} (monitoring) pointscnteten\_coli =  pointscnteten\_coli + 1}
\DoxyCodeLine{3695       else}
\DoxyCodeLine{3696         te = te2}
\DoxyCodeLine{3697         teuv = teuv2        }
\DoxyCodeLine{3698         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(teerr))  teerr = max(teerr\_aux2,tediff*norm)    }
\DoxyCodeLine{3699         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3700           teacc(r) = max(teerr\_aux2(r)/norm(r),tediff(r))}
\DoxyCodeLine{3701 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{3702         \textcolor{keywordflow}{if} (monitoring) pointscnteten\_dd =  pointscnteten\_dd + 1}
\DoxyCodeLine{3703       \textcolor{keyword}{end }if}
\DoxyCodeLine{3704       }
\DoxyCodeLine{3705     else}
\DoxyCodeLine{3706       \textcolor{keyword}{call }e\_main\_cll(ce,ceuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{3707                       mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),masses2(0), \&}
\DoxyCodeLine{3708                       masses2(1),masses2(2),masses2(3),masses2(4),rmax,eerr2=ceerr,id\_in=0)   }
\DoxyCodeLine{3709       \textcolor{keyword}{call }calctensore\_list(te,teuv,teerr\_aux,ce,ceuv,ceerr,momvec,rmax)}
\DoxyCodeLine{3710       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(teerr)) teerr = teerr\_aux}
\DoxyCodeLine{3711       norm = 0d0}
\DoxyCodeLine{3712       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3713         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{3714           norm(r) = max(norm(r),abs(te(i)))      }
\DoxyCodeLine{3715 \textcolor{keywordflow}{        end do}      }
\DoxyCodeLine{3716         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{3717           norm(r) = max(maxval(abs(mominv(1:10))),maxval(abs(masses2(0:4))))}
\DoxyCodeLine{3718           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{3719             norm(r)=1d0/norm(r)**(3-\/real(r)/2)}
\DoxyCodeLine{3720           else}
\DoxyCodeLine{3721             norm(r)=1d0/muir2\_cll**(3-\/real(r)/2)}
\DoxyCodeLine{3722           \textcolor{keyword}{end }if}
\DoxyCodeLine{3723         \textcolor{keyword}{end }if}
\DoxyCodeLine{3724         teacc(r) = teerr\_aux(r)/norm(r)}
\DoxyCodeLine{3725 \textcolor{keywordflow}{      end do}     }
\DoxyCodeLine{3726       }
\DoxyCodeLine{3727     \textcolor{keyword}{end }if}
\DoxyCodeLine{3728 }
\DoxyCodeLine{3729     \textcolor{keyword}{call }propagateaccflag\_cll(teacc,rmax)}
\DoxyCodeLine{3730     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{3731 }
\DoxyCodeLine{3732     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{3733       pointscnteten\_cll =  pointscnteten\_cll + 1}
\DoxyCodeLine{3734 }
\DoxyCodeLine{3735       \textcolor{keywordflow}{if}(maxval(teacc).gt.reqacc\_cll) accpointscnteten\_cll = accpointscnteten\_cll + 1}
\DoxyCodeLine{3736 }
\DoxyCodeLine{3737       \textcolor{keywordflow}{if}(maxval(teacc).gt.critacc\_cll) then}
\DoxyCodeLine{3738         critpointscnteten\_cll =  critpointscnteten\_cll + 1}
\DoxyCodeLine{3739         \textcolor{keywordflow}{if} ( critpointscnteten\_cll.le.noutcritpointsmax\_cll(5) ) then}
\DoxyCodeLine{3740           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TEten\_cll'},0,maxval(teacc),critpointscnteten\_cll)}
\DoxyCodeLine{3741           \textcolor{keywordflow}{if}( critpointscnteten\_cll.eq.noutcritpointsmax\_cll(5)) then}
\DoxyCodeLine{3742             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TEten\_cll suppressed'}   }
\DoxyCodeLine{3743             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{3744           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{3745 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{3746 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TEten\_cll'},0,maxval(teacc),critpointscnteten\_cll)}
\DoxyCodeLine{3747           \textcolor{keywordflow}{if}( critpointscnteten\_cll.eq.noutcritpointsmax\_cll(5)) then}
\DoxyCodeLine{3748             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TEten\_cll suppressed'}   }
\DoxyCodeLine{3749             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{3750           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{3751 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3752 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{3753       \textcolor{keyword}{end }if}
\DoxyCodeLine{3754     \textcolor{keyword}{end }if}
\DoxyCodeLine{3755 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a0314603490a1a1c29d52800d27002cdf}\label{namespacecollier__tensors_a0314603490a1a1c29d52800d27002cdf}} 
\index{collier\_tensors@{collier\_tensors}!eten\_args\_list\_cll@{eten\_args\_list\_cll}}
\index{eten\_args\_list\_cll@{eten\_args\_list\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{eten\_args\_list\_cll()}{eten\_args\_list\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::eten\+\_\+args\+\_\+list\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TE,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Euv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p2vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p3vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p4vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p43,  }\item[{double complex, intent(in)}]{p40,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{p42,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p41,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{double complex, intent(in)}]{m42,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Eerr }\end{DoxyParamCaption})}



Definition at line 3548 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{3548 }
\DoxyCodeLine{3549     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{3550     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3),p2vec(0:3),p3vec(0:3),p4vec(0:3)}
\DoxyCodeLine{3551     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p43,p40,p20,p31,p42,p30,p41}
\DoxyCodeLine{3552     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: m02,m12,m22,m32,m42}
\DoxyCodeLine{3553     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TE(RtS(rmax)), TEuv(RtS(rmax))}
\DoxyCodeLine{3554     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TEerr(0:rmax)}
\DoxyCodeLine{3555     \textcolor{keywordtype}{double complex} :: TE2(RtS(rmax)), TEuv2(RtS(rmax))   }
\DoxyCodeLine{3556     \textcolor{keywordtype}{double complex} :: MomVec(0:3,4), MomInv(10), masses2(0:4)}
\DoxyCodeLine{3557     \textcolor{keywordtype}{double complex} :: CE(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3558     \textcolor{keywordtype}{double complex} :: CEuv(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3559     \textcolor{keywordtype}{double precision} :: CEerr(0:rmax), TEerr\_aux(0:rmax), TEerr\_aux2(0:rmax)}
\DoxyCodeLine{3560     \textcolor{keywordtype}{double complex} :: args(31)}
\DoxyCodeLine{3561     \textcolor{keywordtype}{double precision} :: TEdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TEacc(0:rmax)}
\DoxyCodeLine{3562     \textcolor{keywordtype}{integer} :: r,i    }
\DoxyCodeLine{3563     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{3564 }
\DoxyCodeLine{3565     \textcolor{keywordflow}{if} (5.gt.nmax\_cll) then}
\DoxyCodeLine{3566       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{3567       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Eten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 5'},eflag,.true.)}
\DoxyCodeLine{3568       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{3569       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 5'}}
\DoxyCodeLine{3570       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{3571       return}
\DoxyCodeLine{3572 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{3573     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{3574       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{3575       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Eten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{3576       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{3577       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{3578       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{3579       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{3580       return}
\DoxyCodeLine{3581 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{3582 }
\DoxyCodeLine{3583     \textcolor{keyword}{call }eten\_args\_list\_checked\_cll(te,teuv,p1vec,p2vec,p3vec,p4vec, \&}
\DoxyCodeLine{3584                            p10,p21,p32,p43,p40,p20,p31,p42,p30,p41, \&}
\DoxyCodeLine{3585                            m02,m12,m22,m32,m42,rmax,teerr)}
\DoxyCodeLine{3586 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_ab02ec3958ab26aa8d22d17ee78c8c913}\label{namespacecollier__tensors_ab02ec3958ab26aa8d22d17ee78c8c913}} 
\index{collier\_tensors@{collier\_tensors}!eten\_list\_checked\_cll@{eten\_list\_checked\_cll}}
\index{eten\_list\_checked\_cll@{eten\_list\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{eten\_list\_checked\_cll()}{eten\_list\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::eten\+\_\+list\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TE,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Euv,  }\item[{double complex, dimension(0\+:3,4), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(10), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:4), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Eerr }\end{DoxyParamCaption})}



Definition at line 3187 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{3187 }
\DoxyCodeLine{3188     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{3189     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,4), MomInv(10), masses2(0:4)}
\DoxyCodeLine{3190     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TE(RtS(rmax)), TEuv(RtS(rmax))}
\DoxyCodeLine{3191     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TEerr(0:rmax)}
\DoxyCodeLine{3192     \textcolor{keywordtype}{double complex} :: TE2(RtS(rmax)), TEuv2(RtS(rmax))    }
\DoxyCodeLine{3193     \textcolor{keywordtype}{double complex} :: CE(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax) }
\DoxyCodeLine{3194     \textcolor{keywordtype}{double complex} :: CEuv(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3195     \textcolor{keywordtype}{double precision} :: CEerr(0:rmax), TEerr\_aux(0:rmax), TEerr\_aux2(0:rmax)}
\DoxyCodeLine{3196     \textcolor{keywordtype}{double complex} :: args(31)}
\DoxyCodeLine{3197     \textcolor{keywordtype}{double precision} :: TEdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TEacc(0:rmax)}
\DoxyCodeLine{3198     \textcolor{keywordtype}{integer} :: r,i   }
\DoxyCodeLine{3199     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{3200 }
\DoxyCodeLine{3201     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{3202     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{3203     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{3204     args(9:12) = momvec(0:,3)}
\DoxyCodeLine{3205     args(13:16) = momvec(0:,4)}
\DoxyCodeLine{3206     args(17:26) = mominv}
\DoxyCodeLine{3207     args(27:31) = masses2}
\DoxyCodeLine{3208     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Eten\_cll'})}
\DoxyCodeLine{3209     \textcolor{keyword}{call }setmastern\_cll(5)}
\DoxyCodeLine{3210     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{3211     \textcolor{keyword}{call }setmasterargs\_cll(31,args)}
\DoxyCodeLine{3212 }
\DoxyCodeLine{3213     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{3214     }
\DoxyCodeLine{3215     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{3216       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{3217       mode\_cll = 1}
\DoxyCodeLine{3218       \textcolor{keyword}{call }e\_main\_cll(ce,ceuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{3219                       mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),masses2(0), \&}
\DoxyCodeLine{3220                       masses2(1),masses2(2),masses2(3),masses2(4),rmax,eerr2=ceerr,id\_in=0)}
\DoxyCodeLine{3221       \textcolor{keyword}{call }calctensore\_list(te,teuv,teerr\_aux,ce,ceuv,ceerr,momvec,rmax)                      }
\DoxyCodeLine{3222       }
\DoxyCodeLine{3223       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{3224       mode\_cll = 2}
\DoxyCodeLine{3225       \textcolor{keyword}{call }e\_main\_cll(ce,ceuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{3226                       mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),masses2(0), \&}
\DoxyCodeLine{3227                       masses2(1),masses2(2),masses2(3),masses2(4),rmax,eerr2=ceerr,id\_in=0)}
\DoxyCodeLine{3228       \textcolor{keyword}{call }calctensore\_list(te2,teuv2,teerr\_aux2,ce,ceuv,ceerr,momvec,rmax)                          }
\DoxyCodeLine{3229       }
\DoxyCodeLine{3230       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{3231       mode\_cll = 3}
\DoxyCodeLine{3232       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3233         norm\_coli=0d0}
\DoxyCodeLine{3234         norm\_dd=0d0}
\DoxyCodeLine{3235         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{3236           norm\_coli = max(norm\_coli,abs(te(i)))}
\DoxyCodeLine{3237           norm\_dd = max(norm\_dd,abs(te2(i)))}
\DoxyCodeLine{3238         \textcolor{keyword}{end }do}
\DoxyCodeLine{3239         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{3240           norm\_coli = max(maxval(abs(mominv(1:10))),maxval(abs(masses2(0:4))))}
\DoxyCodeLine{3241           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{3242             norm\_coli=1d0/norm\_coli**(3-\/real(r)/2)}
\DoxyCodeLine{3243           else}
\DoxyCodeLine{3244             norm\_coli=1d0/muir2\_cll**(3-\/real(r)/2)}
\DoxyCodeLine{3245           \textcolor{keyword}{end }if}
\DoxyCodeLine{3246         \textcolor{keyword}{end }if}
\DoxyCodeLine{3247         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{3248           norm\_dd = max(maxval(abs(mominv(1:10))),maxval(abs(masses2(0:4))))}
\DoxyCodeLine{3249           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{3250             norm\_dd=1d0/norm\_dd**(3-\/real(r)/2)}
\DoxyCodeLine{3251           else}
\DoxyCodeLine{3252             norm\_dd=1d0/muir2\_cll**(3-\/real(r)/2)}
\DoxyCodeLine{3253           \textcolor{keyword}{end }if}
\DoxyCodeLine{3254         \textcolor{keyword}{end }if}
\DoxyCodeLine{3255         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{3256       \textcolor{keyword}{end }do}
\DoxyCodeLine{3257       }
\DoxyCodeLine{3258       \textcolor{keyword}{call }checktensorslist\_cll(te,te2,momvec,mominv,masses2,norm,5,rmax,tediff)      }
\DoxyCodeLine{3259        }
\DoxyCodeLine{3260       \textcolor{keywordflow}{if} (teerr\_aux(rmax).lt.teerr\_aux2(rmax)) then}
\DoxyCodeLine{3261         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(teerr))  teerr = max(teerr\_aux,tediff*norm)}
\DoxyCodeLine{3262         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3263           teacc(r) = max(teerr\_aux(r)/norm(r),tediff(r))}
\DoxyCodeLine{3264         \textcolor{keyword}{end }do}
\DoxyCodeLine{3265         \textcolor{keywordflow}{if} (monitoring) pointscnteten\_coli =  pointscnteten\_coli + 1}
\DoxyCodeLine{3266       else}
\DoxyCodeLine{3267         te = te2}
\DoxyCodeLine{3268         teuv = teuv2        }
\DoxyCodeLine{3269         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(teerr))  teerr = max(teerr\_aux2,tediff*norm)    }
\DoxyCodeLine{3270         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3271           teacc(r) = max(teerr\_aux2(r)/norm(r),tediff(r))}
\DoxyCodeLine{3272 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{3273         \textcolor{keywordflow}{if} (monitoring) pointscnteten\_dd =  pointscnteten\_dd + 1}
\DoxyCodeLine{3274       \textcolor{keyword}{end }if}
\DoxyCodeLine{3275       }
\DoxyCodeLine{3276     else}
\DoxyCodeLine{3277       \textcolor{keyword}{call }e\_main\_cll(ce,ceuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{3278                       mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),masses2(0), \&}
\DoxyCodeLine{3279                       masses2(1),masses2(2),masses2(3),masses2(4),rmax,eerr2=ceerr,id\_in=0)    }
\DoxyCodeLine{3280       \textcolor{keyword}{call }calctensore\_list(te,teuv,teerr\_aux,ce,ceuv,ceerr,momvec,rmax)}
\DoxyCodeLine{3281       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(teerr)) teerr = teerr\_aux}
\DoxyCodeLine{3282       norm = 0d0}
\DoxyCodeLine{3283       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3284         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{3285           norm(r) = max(norm(r),abs(te(i)))      }
\DoxyCodeLine{3286 \textcolor{keywordflow}{        end do}       }
\DoxyCodeLine{3287         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{3288           norm(r) = max(maxval(abs(mominv(1:10))),maxval(abs(masses2(0:4))))}
\DoxyCodeLine{3289           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{3290             norm(r)=1d0/norm(r)**(3-\/real(r)/2)}
\DoxyCodeLine{3291           else}
\DoxyCodeLine{3292             norm(r)=1d0/muir2\_cll**(3-\/real(r)/2)}
\DoxyCodeLine{3293           \textcolor{keyword}{end }if}
\DoxyCodeLine{3294         \textcolor{keyword}{end }if}
\DoxyCodeLine{3295         teacc(r) = teerr\_aux(r)/norm(r)}
\DoxyCodeLine{3296 \textcolor{keywordflow}{      end do}      }
\DoxyCodeLine{3297       }
\DoxyCodeLine{3298     \textcolor{keyword}{end }if}
\DoxyCodeLine{3299  }
\DoxyCodeLine{3300     \textcolor{keyword}{call }propagateaccflag\_cll(teacc,rmax)}
\DoxyCodeLine{3301     \textcolor{keyword}{call }propagateerrflag\_cll   }
\DoxyCodeLine{3302 }
\DoxyCodeLine{3303     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{3304       pointscnteten\_cll =  pointscnteten\_cll + 1}
\DoxyCodeLine{3305 }
\DoxyCodeLine{3306       \textcolor{keywordflow}{if}(maxval(teacc).gt.reqacc\_cll) accpointscnteten\_cll = accpointscnteten\_cll + 1}
\DoxyCodeLine{3307 }
\DoxyCodeLine{3308       \textcolor{keywordflow}{if}(maxval(teacc).gt.critacc\_cll) then}
\DoxyCodeLine{3309         critpointscnteten\_cll =  critpointscnteten\_cll + 1}
\DoxyCodeLine{3310         \textcolor{keywordflow}{if} ( critpointscnteten\_cll.le.noutcritpointsmax\_cll(5) ) then}
\DoxyCodeLine{3311           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TEten\_cll'},0,maxval(teacc),critpointscnteten\_cll)}
\DoxyCodeLine{3312           \textcolor{keywordflow}{if}( critpointscnteten\_cll.eq.noutcritpointsmax\_cll(5)) then}
\DoxyCodeLine{3313             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TEten\_cll suppressed'}   }
\DoxyCodeLine{3314             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{3315           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{3316 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{3317 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TEten\_cll'},0,maxval(teacc),critpointscnteten\_cll)}
\DoxyCodeLine{3318           \textcolor{keywordflow}{if}( critpointscnteten\_cll.eq.noutcritpointsmax\_cll(5)) then}
\DoxyCodeLine{3319             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TEten\_cll suppressed'}   }
\DoxyCodeLine{3320             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{3321           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{3322 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3323 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{3324       \textcolor{keyword}{end }if}
\DoxyCodeLine{3325     \textcolor{keyword}{end }if}
\DoxyCodeLine{3326 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a9282e713273930d8af6c788cc010f81f}\label{namespacecollier__tensors_a9282e713273930d8af6c788cc010f81f}} 
\index{collier\_tensors@{collier\_tensors}!eten\_list\_cll@{eten\_list\_cll}}
\index{eten\_list\_cll@{eten\_list\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{eten\_list\_cll()}{eten\_list\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::eten\+\_\+list\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:), intent(out)}]{TE,  }\item[{double complex, dimension(\+:), intent(out)}]{T\+Euv,  }\item[{double complex, dimension(0\+:3,4), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(10), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:4), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Eerr }\end{DoxyParamCaption})}



Definition at line 3155 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{3155 }
\DoxyCodeLine{3156     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{3157     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,4), MomInv(10), masses2(0:4)}
\DoxyCodeLine{3158     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TE(:), TEuv(:)}
\DoxyCodeLine{3159     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TEerr(0:rmax)}
\DoxyCodeLine{3160     \textcolor{keywordtype}{integer} :: r,i   }
\DoxyCodeLine{3161     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{3162 }
\DoxyCodeLine{3163     \textcolor{keywordflow}{if} (5.gt.nmax\_cll) then}
\DoxyCodeLine{3164       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{3165       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Eten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 5'},eflag,.true.)}
\DoxyCodeLine{3166       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{3167       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 5'}}
\DoxyCodeLine{3168       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{3169       return}
\DoxyCodeLine{3170 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{3171     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{3172       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{3173       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Eten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{3174       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{3175       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{3176       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{3177       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{3178       return}
\DoxyCodeLine{3179 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{3180 }
\DoxyCodeLine{3181     \textcolor{keyword}{call }eten\_list\_checked\_cll(te,teuv,momvec,mominv,masses2,rmax,teerr)}
\DoxyCodeLine{3182 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a1a980ea98c7f056c16d52c97549adabb}\label{namespacecollier__tensors_a1a980ea98c7f056c16d52c97549adabb}} 
\index{collier\_tensors@{collier\_tensors}!eten\_main\_cll@{eten\_main\_cll}}
\index{eten\_main\_cll@{eten\_main\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{eten\_main\_cll()}{eten\_main\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::eten\+\_\+main\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TE,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Euv,  }\item[{double complex, dimension(0\+:3,4), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(10), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:4), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Eerr }\end{DoxyParamCaption})}



Definition at line 2974 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2974   }
\DoxyCodeLine{2975     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{2976     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,4), MomInv(10), masses2(0:4)}
\DoxyCodeLine{2977     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TE(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2978     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TEuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2979     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TEerr(0:rmax)}
\DoxyCodeLine{2980     \textcolor{keywordtype}{double complex} :: TE2(0:rmax,0:rmax,0:rmax,0:rmax), TEuv2(0:rmax,0:rmax,0:rmax,0:rmax)    }
\DoxyCodeLine{2981     \textcolor{keywordtype}{double complex} :: CE(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax) }
\DoxyCodeLine{2982     \textcolor{keywordtype}{double complex} :: CEuv(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2983     \textcolor{keywordtype}{double precision} :: CEerr(0:rmax), TEerr\_aux(0:rmax), TEerr\_aux2(0:rmax)}
\DoxyCodeLine{2984     \textcolor{keywordtype}{double complex} :: args(31)}
\DoxyCodeLine{2985     \textcolor{keywordtype}{double precision} :: TEdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TEacc(0:rmax)}
\DoxyCodeLine{2986     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3    }
\DoxyCodeLine{2987     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{2988 }
\DoxyCodeLine{2989     \textcolor{keywordflow}{if} (5.gt.nmax\_cll) then}
\DoxyCodeLine{2990       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{2991       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Eten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 5'},eflag,.true.)}
\DoxyCodeLine{2992       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{2993       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 5'}}
\DoxyCodeLine{2994       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{2995       return}
\DoxyCodeLine{2996 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{2997     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{2998       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{2999       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Eten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{3000       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{3001       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{3002       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{3003       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{3004       return}
\DoxyCodeLine{3005 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{3006 }
\DoxyCodeLine{3007     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{3008     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{3009     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{3010     args(9:12) = momvec(0:,3)}
\DoxyCodeLine{3011     args(13:16) = momvec(0:,4)}
\DoxyCodeLine{3012     args(17:26) = mominv}
\DoxyCodeLine{3013     args(27:31) = masses2}
\DoxyCodeLine{3014     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Eten\_cll'})}
\DoxyCodeLine{3015     \textcolor{keyword}{call }setmastern\_cll(5)}
\DoxyCodeLine{3016     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{3017     \textcolor{keyword}{call }setmasterargs\_cll(31,args)}
\DoxyCodeLine{3018 }
\DoxyCodeLine{3019     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{3020     }
\DoxyCodeLine{3021     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{3022       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{3023       mode\_cll = 1}
\DoxyCodeLine{3024       \textcolor{keyword}{call }e\_main\_cll(ce,ceuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{3025                       mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),masses2(0), \&}
\DoxyCodeLine{3026                       masses2(1),masses2(2),masses2(3),masses2(4),rmax,eerr2=ceerr,id\_in=0)}
\DoxyCodeLine{3027       \textcolor{keyword}{call }calctensore(te,teuv,teerr\_aux,ce,ceuv,ceerr,momvec,rmax)                      }
\DoxyCodeLine{3028       }
\DoxyCodeLine{3029       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{3030       mode\_cll = 2}
\DoxyCodeLine{3031       \textcolor{keyword}{call }e\_main\_cll(ce,ceuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{3032                       mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),masses2(0), \&}
\DoxyCodeLine{3033                       masses2(1),masses2(2),masses2(3),masses2(4),rmax,eerr2=ceerr,id\_in=0)}
\DoxyCodeLine{3034       \textcolor{keyword}{call }calctensore(te2,teuv2,teerr\_aux2,ce,ceuv,ceerr,momvec,rmax)                          }
\DoxyCodeLine{3035       }
\DoxyCodeLine{3036       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{3037       mode\_cll = 3}
\DoxyCodeLine{3038       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3039         norm\_coli=0d0}
\DoxyCodeLine{3040         norm\_dd=0d0}
\DoxyCodeLine{3041         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{3042           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{3043             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{3044               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{3045               norm\_coli = max(norm\_coli,abs(te(n0,n1,n2,n3)))}
\DoxyCodeLine{3046               norm\_dd = max(norm\_dd,abs(te2(n0,n1,n2,n3)))}
\DoxyCodeLine{3047             \textcolor{keyword}{end }do}
\DoxyCodeLine{3048           \textcolor{keyword}{end }do}
\DoxyCodeLine{3049         \textcolor{keyword}{end }do}
\DoxyCodeLine{3050         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{3051           norm\_coli = max(maxval(abs(mominv(1:10))),maxval(abs(masses2(0:4))))}
\DoxyCodeLine{3052           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{3053             norm\_coli=1d0/norm\_coli**(3-\/real(r)/2)}
\DoxyCodeLine{3054           else}
\DoxyCodeLine{3055             norm\_coli=1d0/muir2\_cll**(3-\/real(r)/2)}
\DoxyCodeLine{3056           \textcolor{keyword}{end }if}
\DoxyCodeLine{3057         \textcolor{keyword}{end }if}
\DoxyCodeLine{3058         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{3059           norm\_dd = max(maxval(abs(mominv(1:10))),maxval(abs(masses2(0:4))))}
\DoxyCodeLine{3060           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{3061             norm\_dd=1d0/norm\_dd**(3-\/real(r)/2)}
\DoxyCodeLine{3062           else}
\DoxyCodeLine{3063             norm\_dd=1d0/muir2\_cll**(3-\/real(r)/2)}
\DoxyCodeLine{3064           \textcolor{keyword}{end }if}
\DoxyCodeLine{3065         \textcolor{keyword}{end }if}
\DoxyCodeLine{3066         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{3067       \textcolor{keyword}{end }do}
\DoxyCodeLine{3068       }
\DoxyCodeLine{3069       \textcolor{keyword}{call }checktensors\_cll(te,te2,momvec,mominv,masses2,norm,5,rmax,tediff)}
\DoxyCodeLine{3070        }
\DoxyCodeLine{3071       \textcolor{keywordflow}{if} (teerr\_aux(rmax).lt.teerr\_aux2(rmax)) then}
\DoxyCodeLine{3072         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(teerr))  teerr = max(teerr\_aux,tediff*norm)}
\DoxyCodeLine{3073         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3074           teacc(r) = max(teerr\_aux(r)/norm(r),tediff(r))}
\DoxyCodeLine{3075         \textcolor{keyword}{end }do}
\DoxyCodeLine{3076         \textcolor{keywordflow}{if} (monitoring) pointscnteten\_coli =  pointscnteten\_coli + 1}
\DoxyCodeLine{3077       else}
\DoxyCodeLine{3078         te = te2}
\DoxyCodeLine{3079         teuv = teuv2        }
\DoxyCodeLine{3080         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(teerr))  teerr = max(teerr\_aux2,tediff*norm)    }
\DoxyCodeLine{3081         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3082           teacc(r) = max(teerr\_aux2(r)/norm(r),tediff(r))}
\DoxyCodeLine{3083 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{3084         \textcolor{keywordflow}{if} (monitoring) pointscnteten\_dd =  pointscnteten\_dd + 1}
\DoxyCodeLine{3085 \textcolor{keywordflow}{      end if}      }
\DoxyCodeLine{3086       }
\DoxyCodeLine{3087     else}
\DoxyCodeLine{3088       \textcolor{keyword}{call }e\_main\_cll(ce,ceuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{3089                       mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),masses2(0), \&}
\DoxyCodeLine{3090                       masses2(1),masses2(2),masses2(3),masses2(4),rmax,eerr2=ceerr,id\_in=0)}
\DoxyCodeLine{3091       \textcolor{keyword}{call }calctensore(te,teuv,teerr\_aux,ce,ceuv,ceerr,momvec,rmax)}
\DoxyCodeLine{3092       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(teerr)) teerr = teerr\_aux}
\DoxyCodeLine{3093       norm = 0d0}
\DoxyCodeLine{3094       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3095         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{3096           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{3097             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{3098               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{3099               norm(r) = max(norm(r),abs(te(n0,n1,n2,n3)))}
\DoxyCodeLine{3100             \textcolor{keyword}{end }do}
\DoxyCodeLine{3101           \textcolor{keyword}{end }do}
\DoxyCodeLine{3102 \textcolor{keywordflow}{        end do}      }
\DoxyCodeLine{3103         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{3104           norm(r) = max(maxval(abs(mominv(1:10))),maxval(abs(masses2(0:4))))}
\DoxyCodeLine{3105           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{3106             norm(r)=1d0/norm(r)**(3-\/real(r)/2)}
\DoxyCodeLine{3107           else}
\DoxyCodeLine{3108             norm(r)=1d0/muir2\_cll**(3-\/real(r)/2)}
\DoxyCodeLine{3109           \textcolor{keyword}{end }if}
\DoxyCodeLine{3110         \textcolor{keyword}{end }if}
\DoxyCodeLine{3111         teacc(r) = teerr\_aux(r)/norm(r)}
\DoxyCodeLine{3112 \textcolor{keywordflow}{      end do}      }
\DoxyCodeLine{3113       }
\DoxyCodeLine{3114     \textcolor{keyword}{end }if}
\DoxyCodeLine{3115 }
\DoxyCodeLine{3116     \textcolor{keyword}{call }propagateaccflag\_cll(teacc,rmax)}
\DoxyCodeLine{3117     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{3118 }
\DoxyCodeLine{3119     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{3120       pointscnteten\_cll =  pointscnteten\_cll + 1}
\DoxyCodeLine{3121 }
\DoxyCodeLine{3122       \textcolor{keywordflow}{if}(maxval(teacc).gt.reqacc\_cll) accpointscnteten\_cll = accpointscnteten\_cll + 1}
\DoxyCodeLine{3123 }
\DoxyCodeLine{3124       \textcolor{keywordflow}{if}(maxval(teacc).gt.critacc\_cll) then}
\DoxyCodeLine{3125         critpointscnteten\_cll =  critpointscnteten\_cll + 1}
\DoxyCodeLine{3126         \textcolor{keywordflow}{if} ( critpointscnteten\_cll.le.noutcritpointsmax\_cll(5) ) then}
\DoxyCodeLine{3127           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TEten\_cll'},0,maxval(teacc),critpointscnteten\_cll)}
\DoxyCodeLine{3128           \textcolor{keywordflow}{if}( critpointscnteten\_cll.eq.noutcritpointsmax\_cll(5)) then}
\DoxyCodeLine{3129             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TEten\_cll suppressed'}   }
\DoxyCodeLine{3130             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{3131           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{3132 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{3133 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TEten\_cll'},0,maxval(teacc),critpointscnteten\_cll)}
\DoxyCodeLine{3134           \textcolor{keywordflow}{if}( critpointscnteten\_cll.eq.noutcritpointsmax\_cll(5)) then}
\DoxyCodeLine{3135             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TEten\_cll suppressed'}   }
\DoxyCodeLine{3136             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{3137           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{3138 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3139 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{3140       \textcolor{keyword}{end }if}
\DoxyCodeLine{3141     \textcolor{keyword}{end }if}
\DoxyCodeLine{3142 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_aded4a4e2b606bd45d0f502afa07944ae}\label{namespacecollier__tensors_aded4a4e2b606bd45d0f502afa07944ae}} 
\index{collier\_tensors@{collier\_tensors}!ften\_args\_cll@{ften\_args\_cll}}
\index{ften\_args\_cll@{ften\_args\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{ften\_args\_cll()}{ften\_args\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::ften\+\_\+args\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TF,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Fuv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p2vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p3vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p4vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p5vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p43,  }\item[{double complex, intent(in)}]{p54,  }\item[{double complex, intent(in)}]{p50,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{p42,  }\item[{double complex, intent(in)}]{p53,  }\item[{double complex, intent(in)}]{p40,  }\item[{double complex, intent(in)}]{p51,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p41,  }\item[{double complex, intent(in)}]{p52,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{double complex, intent(in)}]{m42,  }\item[{double complex, intent(in)}]{m52,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Ferr }\end{DoxyParamCaption})}



Definition at line 4325 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{4325     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{4326     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3),p2vec(0:3),p3vec(0:3),p4vec(0:3)}
\DoxyCodeLine{4327     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p5vec(0:3)}
\DoxyCodeLine{4328     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p43,p54,p50,p20,p31,p42,p53,p40}
\DoxyCodeLine{4329     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p51,p30,p41,p52,m02,m12,m22,m32,m42,m52}
\DoxyCodeLine{4330     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TF(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4331     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TFuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4332     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TFerr(0:rmax)}
\DoxyCodeLine{4333     \textcolor{keywordtype}{double complex} :: TF2(0:rmax,0:rmax,0:rmax,0:rmax), TFuv2(0:rmax,0:rmax,0:rmax,0:rmax)    }
\DoxyCodeLine{4334     \textcolor{keywordtype}{double complex} :: MomVec(0:3,5), MomInv(15), masses2(0:5)}
\DoxyCodeLine{4335     \textcolor{keywordtype}{double complex} :: CF(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax) }
\DoxyCodeLine{4336     \textcolor{keywordtype}{double complex} :: CFuv(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4337     \textcolor{keywordtype}{double precision} :: CFerr(0:rmax), TFerr\_aux(0:rmax), TFerr\_aux2(0:rmax)}
\DoxyCodeLine{4338     \textcolor{keywordtype}{double complex} :: args(41)}
\DoxyCodeLine{4339     \textcolor{keywordtype}{double precision} :: TFdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TFacc(0:rmax)}
\DoxyCodeLine{4340     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3   }
\DoxyCodeLine{4341     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{4342 }
\DoxyCodeLine{4343     \textcolor{keywordflow}{if} (6.gt.nmax\_cll) then}
\DoxyCodeLine{4344       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{4345       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Ften\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 6'},eflag,.true.)}
\DoxyCodeLine{4346       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{4347       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 6'}}
\DoxyCodeLine{4348       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{4349       return}
\DoxyCodeLine{4350 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{4351     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{4352       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{4353       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Ften\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{4354       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{4355       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{4356       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{4357       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{4358       return}
\DoxyCodeLine{4359 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{4360 }
\DoxyCodeLine{4361     momvec(0:,1) = p1vec}
\DoxyCodeLine{4362     momvec(0:,2) = p2vec}
\DoxyCodeLine{4363     momvec(0:,3) = p3vec}
\DoxyCodeLine{4364     momvec(0:,4) = p4vec}
\DoxyCodeLine{4365     momvec(0:,5) = p5vec}
\DoxyCodeLine{4366     mominv(1) = p10}
\DoxyCodeLine{4367     mominv(2) = p21}
\DoxyCodeLine{4368     mominv(3) = p32}
\DoxyCodeLine{4369     mominv(4) = p43}
\DoxyCodeLine{4370     mominv(5) = p54}
\DoxyCodeLine{4371     mominv(6) = p50}
\DoxyCodeLine{4372     mominv(7) = p20}
\DoxyCodeLine{4373     mominv(8) = p31}
\DoxyCodeLine{4374     mominv(9) = p42}
\DoxyCodeLine{4375     mominv(10) = p53}
\DoxyCodeLine{4376     mominv(11) = p40}
\DoxyCodeLine{4377     mominv(12) = p51}
\DoxyCodeLine{4378     mominv(13) = p30}
\DoxyCodeLine{4379     mominv(14) = p41}
\DoxyCodeLine{4380     mominv(15) = p52}
\DoxyCodeLine{4381     masses2(0) = m02}
\DoxyCodeLine{4382     masses2(1) = m12}
\DoxyCodeLine{4383     masses2(2) = m22}
\DoxyCodeLine{4384     masses2(3) = m32}
\DoxyCodeLine{4385     masses2(4) = m42}
\DoxyCodeLine{4386     masses2(5) = m52}
\DoxyCodeLine{4387 }
\DoxyCodeLine{4388     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{4389     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{4390     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{4391     args(9:12) = momvec(0:,3)}
\DoxyCodeLine{4392     args(13:16) = momvec(0:,4)}
\DoxyCodeLine{4393     args(17:20) = momvec(0:,5)}
\DoxyCodeLine{4394     args(21:35) = mominv}
\DoxyCodeLine{4395     args(36:41) = masses2(0:)}
\DoxyCodeLine{4396     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Ften\_cll'})}
\DoxyCodeLine{4397     \textcolor{keyword}{call }setmastern\_cll(6)}
\DoxyCodeLine{4398     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{4399     \textcolor{keyword}{call }setmasterargs\_cll(41,args)}
\DoxyCodeLine{4400 }
\DoxyCodeLine{4401     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{4402 }
\DoxyCodeLine{4403     \textcolor{keywordflow}{if} (tenred\_cll.le.6) then}
\DoxyCodeLine{4404     }
\DoxyCodeLine{4405       \textcolor{keywordflow}{if} (mode\_cll.gt.1) \textcolor{keyword}{call }f\_dd\_dummy(rmax)}
\DoxyCodeLine{4406       }
\DoxyCodeLine{4407       \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{4408         \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{4409         mode\_cll = 1}
\DoxyCodeLine{4410         \textcolor{keyword}{call }calctensorfr(tf,tfuv,tferr\_aux,momvec,mominv,masses2,rmax)                                     }
\DoxyCodeLine{4411       }
\DoxyCodeLine{4412         \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{4413         mode\_cll = 2}
\DoxyCodeLine{4414         \textcolor{keyword}{call }calctensorfr(tf2,tfuv2,tferr\_aux2,momvec,mominv,masses2,rmax)                               }
\DoxyCodeLine{4415       }
\DoxyCodeLine{4416         \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{4417         mode\_cll = 3}
\DoxyCodeLine{4418         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4419           norm\_coli=0d0}
\DoxyCodeLine{4420           norm\_dd=0d0}
\DoxyCodeLine{4421           \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{4422             \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{4423               \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{4424                 n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{4425                 norm\_coli = max(norm\_coli,abs(tf(n0,n1,n2,n3)))}
\DoxyCodeLine{4426                 norm\_dd = max(norm\_dd,abs(tf2(n0,n1,n2,n3)))}
\DoxyCodeLine{4427               \textcolor{keyword}{end }do}
\DoxyCodeLine{4428             \textcolor{keyword}{end }do}
\DoxyCodeLine{4429           \textcolor{keyword}{end }do}
\DoxyCodeLine{4430           \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{4431             norm\_coli = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4432             \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{4433               norm\_coli=1d0/norm\_coli**(4-\/real(r)/2)}
\DoxyCodeLine{4434             else}
\DoxyCodeLine{4435               norm\_coli=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4436             \textcolor{keyword}{end }if}
\DoxyCodeLine{4437           \textcolor{keyword}{end }if}
\DoxyCodeLine{4438           \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{4439             norm\_dd = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4440             \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{4441               norm\_dd=1d0/norm\_dd**(4-\/real(r)/2)}
\DoxyCodeLine{4442             else}
\DoxyCodeLine{4443               norm\_dd=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4444             \textcolor{keyword}{end }if}
\DoxyCodeLine{4445           \textcolor{keyword}{end }if}
\DoxyCodeLine{4446           norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{4447         \textcolor{keyword}{end }do}
\DoxyCodeLine{4448       }
\DoxyCodeLine{4449         \textcolor{keyword}{call }checktensors\_cll(tf,tf2,momvec,mominv,masses2,norm,6,rmax,tfdiff)        }
\DoxyCodeLine{4450        }
\DoxyCodeLine{4451         \textcolor{keywordflow}{if} (tferr\_aux(rmax).lt.tferr\_aux2(rmax)) then}
\DoxyCodeLine{4452           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr))  tferr = max(tferr\_aux,tfdiff*norm)}
\DoxyCodeLine{4453           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4454             tfacc(r) = max(tferr\_aux(r)/norm(r),tfdiff(r))}
\DoxyCodeLine{4455           \textcolor{keyword}{end }do}
\DoxyCodeLine{4456           \textcolor{keywordflow}{if} (monitoring) pointscntften\_coli =  pointscntften\_coli + 1}
\DoxyCodeLine{4457         else}
\DoxyCodeLine{4458           tf = tf2}
\DoxyCodeLine{4459           tfuv = tfuv2        }
\DoxyCodeLine{4460           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr))  tferr = max(tferr\_aux2,tfdiff*norm)    }
\DoxyCodeLine{4461           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4462             tfacc(r) = max(tferr\_aux2(r)/norm(r),tfdiff(r))}
\DoxyCodeLine{4463 \textcolor{keywordflow}{          end do}         }
\DoxyCodeLine{4464           \textcolor{keywordflow}{if} (monitoring) pointscntften\_dd =  pointscntften\_dd + 1}
\DoxyCodeLine{4465         \textcolor{keyword}{end }if}
\DoxyCodeLine{4466         }
\DoxyCodeLine{4467       \textcolor{keywordflow}{else}       }
\DoxyCodeLine{4468         \textcolor{keyword}{call }calctensorfr(tf,tfuv,tferr\_aux,momvec,mominv,masses2,rmax)}
\DoxyCodeLine{4469         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr)) tferr = tferr\_aux}
\DoxyCodeLine{4470         norm = 0d0}
\DoxyCodeLine{4471         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4472           \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{4473             \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{4474               \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{4475                 n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{4476                 norm(r) = max(norm(r),abs(tf(n0,n1,n2,n3)))}
\DoxyCodeLine{4477               \textcolor{keyword}{end }do}
\DoxyCodeLine{4478             \textcolor{keyword}{end }do}
\DoxyCodeLine{4479           \textcolor{keyword}{end }do}
\DoxyCodeLine{4480           \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{4481             norm(r) = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4482             \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{4483               norm(r)=1d0/norm(r)**(4-\/real(r)/2)}
\DoxyCodeLine{4484             else}
\DoxyCodeLine{4485               norm(r)=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4486             \textcolor{keyword}{end }if}
\DoxyCodeLine{4487           \textcolor{keyword}{end }if}
\DoxyCodeLine{4488           tfacc(r) = tferr\_aux(r)/norm(r)}
\DoxyCodeLine{4489 \textcolor{keywordflow}{        end do}        }
\DoxyCodeLine{4490         }
\DoxyCodeLine{4491       \textcolor{keyword}{end }if}
\DoxyCodeLine{4492       }
\DoxyCodeLine{4493     else}
\DoxyCodeLine{4494        }
\DoxyCodeLine{4495       \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{4496         \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{4497         mode\_cll = 1}
\DoxyCodeLine{4498         \textcolor{keyword}{call }f\_main\_cll(cf,cfuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{4499                         mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),mominv(11), \&}
\DoxyCodeLine{4500                         mominv(12),mominv(13),mominv(14),mominv(15),masses2(0),masses2(1), \&}
\DoxyCodeLine{4501                         masses2(2),masses2(3),masses2(4),masses2(5),rmax,ferr2=cferr,id\_in=0) }
\DoxyCodeLine{4502         \textcolor{keyword}{call }calctensorf(tf,tfuv,tferr\_aux,cf,cfuv,cferr,momvec,rmax)                                     }
\DoxyCodeLine{4503       }
\DoxyCodeLine{4504         \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{4505         mode\_cll = 2}
\DoxyCodeLine{4506         \textcolor{keyword}{call }f\_main\_cll(cf,cfuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{4507                         mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),mominv(11), \&}
\DoxyCodeLine{4508                         mominv(12),mominv(13),mominv(14),mominv(15),masses2(0),masses2(1), \&}
\DoxyCodeLine{4509                         masses2(2),masses2(3),masses2(4),masses2(5),rmax,ferr2=cferr,id\_in=0) }
\DoxyCodeLine{4510         \textcolor{keyword}{call }calctensorf(tf2,tfuv2,tferr\_aux2,cf,cfuv,cferr,momvec,rmax)                                }
\DoxyCodeLine{4511           }
\DoxyCodeLine{4512         \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{4513         mode\_cll = 3}
\DoxyCodeLine{4514         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4515           norm\_coli=0d0}
\DoxyCodeLine{4516           norm\_dd=0d0}
\DoxyCodeLine{4517           \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{4518             \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{4519               \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{4520                 n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{4521                 norm\_coli = max(norm\_coli,abs(tf(n0,n1,n2,n3)))}
\DoxyCodeLine{4522                 norm\_dd = max(norm\_dd,abs(tf2(n0,n1,n2,n3)))}
\DoxyCodeLine{4523               \textcolor{keyword}{end }do}
\DoxyCodeLine{4524             \textcolor{keyword}{end }do}
\DoxyCodeLine{4525           \textcolor{keyword}{end }do}
\DoxyCodeLine{4526           \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{4527             norm\_coli = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4528             \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{4529               norm\_coli=1d0/norm\_coli**(4-\/real(r)/2)}
\DoxyCodeLine{4530             else}
\DoxyCodeLine{4531               norm\_coli=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4532             \textcolor{keyword}{end }if}
\DoxyCodeLine{4533           \textcolor{keyword}{end }if}
\DoxyCodeLine{4534           \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{4535             norm\_dd = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4536             \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{4537               norm\_dd=1d0/norm\_dd**(4-\/real(r)/2)}
\DoxyCodeLine{4538             else}
\DoxyCodeLine{4539               norm\_dd=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4540             \textcolor{keyword}{end }if}
\DoxyCodeLine{4541           \textcolor{keyword}{end }if}
\DoxyCodeLine{4542           norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{4543         \textcolor{keyword}{end }do}
\DoxyCodeLine{4544       }
\DoxyCodeLine{4545         \textcolor{keyword}{call }checktensors\_cll(tf,tf2,momvec,mominv,masses2,norm,6,rmax,tfdiff)         }
\DoxyCodeLine{4546        }
\DoxyCodeLine{4547         \textcolor{keywordflow}{if} (tferr\_aux(rmax).lt.tferr\_aux2(rmax)) then}
\DoxyCodeLine{4548           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr))  tferr = max(tferr\_aux,tfdiff*norm)}
\DoxyCodeLine{4549           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4550             tfacc(r) = max(tferr\_aux(r)/norm(r),tfdiff(r))}
\DoxyCodeLine{4551           \textcolor{keyword}{end }do}
\DoxyCodeLine{4552           \textcolor{keywordflow}{if} (monitoring) pointscntften\_coli =  pointscntften\_coli + 1}
\DoxyCodeLine{4553         else}
\DoxyCodeLine{4554           tf = tf2}
\DoxyCodeLine{4555           tfuv = tfuv2        }
\DoxyCodeLine{4556           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr))  tferr = max(tferr\_aux2,tfdiff*norm)    }
\DoxyCodeLine{4557           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4558             tfacc(r) = max(tferr\_aux2(r)/norm(r),tfdiff(r))}
\DoxyCodeLine{4559 \textcolor{keywordflow}{          end do}         }
\DoxyCodeLine{4560           \textcolor{keywordflow}{if} (monitoring) pointscntften\_dd =  pointscntften\_dd + 1}
\DoxyCodeLine{4561         \textcolor{keyword}{end }if}
\DoxyCodeLine{4562         }
\DoxyCodeLine{4563       \textcolor{keywordflow}{else}    }
\DoxyCodeLine{4564         \textcolor{keyword}{call }f\_main\_cll(cf,cfuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{4565                         mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),mominv(11), \&}
\DoxyCodeLine{4566                         mominv(12),mominv(13),mominv(14),mominv(15),masses2(0),masses2(1), \&}
\DoxyCodeLine{4567                         masses2(2),masses2(3),masses2(4),masses2(5),rmax,ferr2=cferr,id\_in=0)}
\DoxyCodeLine{4568         \textcolor{keyword}{call }calctensorf(tf,tfuv,tferr\_aux,cf,cfuv,cferr,momvec,rmax)}
\DoxyCodeLine{4569         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr)) tferr = tferr\_aux}
\DoxyCodeLine{4570         norm = 0d0}
\DoxyCodeLine{4571         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4572           \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{4573             \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{4574               \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{4575                 n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{4576                 norm(r) = max(norm(r),abs(tf(n0,n1,n2,n3)))}
\DoxyCodeLine{4577               \textcolor{keyword}{end }do}
\DoxyCodeLine{4578             \textcolor{keyword}{end }do}
\DoxyCodeLine{4579           \textcolor{keyword}{end }do}
\DoxyCodeLine{4580           \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{4581             norm(r) = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4582             \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{4583               norm(r)=1d0/norm(r)**(4-\/real(r)/2)}
\DoxyCodeLine{4584             else}
\DoxyCodeLine{4585               norm(r)=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4586             \textcolor{keyword}{end }if}
\DoxyCodeLine{4587           \textcolor{keyword}{end }if}
\DoxyCodeLine{4588           tfacc(r) = tferr\_aux(r)/norm(r)}
\DoxyCodeLine{4589 \textcolor{keywordflow}{        end do}        }
\DoxyCodeLine{4590         }
\DoxyCodeLine{4591       \textcolor{keyword}{end }if}
\DoxyCodeLine{4592     }
\DoxyCodeLine{4593     \textcolor{keyword}{end }if}
\DoxyCodeLine{4594  }
\DoxyCodeLine{4595     \textcolor{keyword}{call }propagateaccflag\_cll(tfacc,rmax)}
\DoxyCodeLine{4596     \textcolor{keyword}{call }propagateerrflag\_cll   }
\DoxyCodeLine{4597 }
\DoxyCodeLine{4598     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{4599       pointscntften\_cll =  pointscntften\_cll + 1}
\DoxyCodeLine{4600 }
\DoxyCodeLine{4601       \textcolor{keywordflow}{if}(maxval(tfacc).gt.reqacc\_cll) accpointscntften\_cll = accpointscntften\_cll + 1}
\DoxyCodeLine{4602 }
\DoxyCodeLine{4603       \textcolor{keywordflow}{if}(maxval(tfacc).gt.critacc\_cll) then}
\DoxyCodeLine{4604         critpointscntften\_cll =  critpointscntften\_cll + 1}
\DoxyCodeLine{4605         \textcolor{keywordflow}{if} ( critpointscntften\_cll.le.noutcritpointsmax\_cll(6) ) then}
\DoxyCodeLine{4606           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TFten\_cll'},0,maxval(tfacc),critpointscntften\_cll)}
\DoxyCodeLine{4607           \textcolor{keywordflow}{if}( critpointscntften\_cll.eq.noutcritpointsmax\_cll(6)) then}
\DoxyCodeLine{4608             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TFten\_cll suppressed'}   }
\DoxyCodeLine{4609             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{4610           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{4611 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{4612 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TFten\_cll'},0,maxval(tfacc),critpointscntften\_cll)}
\DoxyCodeLine{4613           \textcolor{keywordflow}{if}( critpointscntften\_cll.eq.noutcritpointsmax\_cll(6)) then}
\DoxyCodeLine{4614             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TFten\_cll suppressed'}   }
\DoxyCodeLine{4615             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{4616           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{4617 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4618 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{4619       \textcolor{keyword}{end }if}
\DoxyCodeLine{4620     \textcolor{keyword}{end }if}
\DoxyCodeLine{4621 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_ae280f5f9c022a58e673a5175d5bacc82}\label{namespacecollier__tensors_ae280f5f9c022a58e673a5175d5bacc82}} 
\index{collier\_tensors@{collier\_tensors}!ften\_args\_list\_checked\_cll@{ften\_args\_list\_checked\_cll}}
\index{ften\_args\_list\_checked\_cll@{ften\_args\_list\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{ften\_args\_list\_checked\_cll()}{ften\_args\_list\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::ften\+\_\+args\+\_\+list\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TF,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Fuv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p2vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p3vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p4vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p5vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p43,  }\item[{double complex, intent(in)}]{p54,  }\item[{double complex, intent(in)}]{p50,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{p42,  }\item[{double complex, intent(in)}]{p53,  }\item[{double complex, intent(in)}]{p40,  }\item[{double complex, intent(in)}]{p51,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p41,  }\item[{double complex, intent(in)}]{p52,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{double complex, intent(in)}]{m42,  }\item[{double complex, intent(in)}]{m52,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Ferr }\end{DoxyParamCaption})}



Definition at line 4675 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{4675 }
\DoxyCodeLine{4676     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{4677     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3),p2vec(0:3),p3vec(0:3),p4vec(0:3)}
\DoxyCodeLine{4678     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p5vec(0:3)}
\DoxyCodeLine{4679     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p43,p54,p50,p20,p31,p42,p53,p40}
\DoxyCodeLine{4680     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p51,p30,p41,p52,m02,m12,m22,m32,m42,m52}
\DoxyCodeLine{4681     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TF(RtS(rmax)),TFuv(RtS(rmax))}
\DoxyCodeLine{4682     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TFerr(0:rmax)}
\DoxyCodeLine{4683     \textcolor{keywordtype}{double complex} :: TF2(RtS(rmax)),TFuv2(RtS(rmax))    }
\DoxyCodeLine{4684     \textcolor{keywordtype}{double complex} :: MomVec(0:3,5), MomInv(15), masses2(0:5)}
\DoxyCodeLine{4685     \textcolor{keywordtype}{double complex} :: CF(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax) }
\DoxyCodeLine{4686     \textcolor{keywordtype}{double complex} :: CFuv(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4687     \textcolor{keywordtype}{double precision} :: CFerr(0:rmax), TFerr\_aux(0:rmax), TFerr\_aux2(0:rmax)}
\DoxyCodeLine{4688     \textcolor{keywordtype}{double complex} :: args(41)}
\DoxyCodeLine{4689     \textcolor{keywordtype}{double precision} :: TFdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TFacc(0:rmax)}
\DoxyCodeLine{4690     \textcolor{keywordtype}{integer} :: r,i    }
\DoxyCodeLine{4691     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{4692 }
\DoxyCodeLine{4693     momvec(0:,1) = p1vec}
\DoxyCodeLine{4694     momvec(0:,2) = p2vec}
\DoxyCodeLine{4695     momvec(0:,3) = p3vec}
\DoxyCodeLine{4696     momvec(0:,4) = p4vec}
\DoxyCodeLine{4697     momvec(0:,5) = p5vec}
\DoxyCodeLine{4698     mominv(1) = p10}
\DoxyCodeLine{4699     mominv(2) = p21}
\DoxyCodeLine{4700     mominv(3) = p32}
\DoxyCodeLine{4701     mominv(4) = p43}
\DoxyCodeLine{4702     mominv(5) = p54}
\DoxyCodeLine{4703     mominv(6) = p50}
\DoxyCodeLine{4704     mominv(7) = p20}
\DoxyCodeLine{4705     mominv(8) = p31}
\DoxyCodeLine{4706     mominv(9) = p42}
\DoxyCodeLine{4707     mominv(10) = p53}
\DoxyCodeLine{4708     mominv(11) = p40}
\DoxyCodeLine{4709     mominv(12) = p51}
\DoxyCodeLine{4710     mominv(13) = p30}
\DoxyCodeLine{4711     mominv(14) = p41}
\DoxyCodeLine{4712     mominv(15) = p52}
\DoxyCodeLine{4713     masses2(0) = m02}
\DoxyCodeLine{4714     masses2(1) = m12}
\DoxyCodeLine{4715     masses2(2) = m22}
\DoxyCodeLine{4716     masses2(3) = m32}
\DoxyCodeLine{4717     masses2(4) = m42}
\DoxyCodeLine{4718     masses2(5) = m52}
\DoxyCodeLine{4719 }
\DoxyCodeLine{4720     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{4721     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{4722     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{4723     args(9:12) = momvec(0:,3)}
\DoxyCodeLine{4724     args(13:16) = momvec(0:,4)}
\DoxyCodeLine{4725     args(17:20) = momvec(0:,5)}
\DoxyCodeLine{4726     args(21:35) = mominv}
\DoxyCodeLine{4727     args(36:41) = masses2(0:)}
\DoxyCodeLine{4728     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Ften\_cll'})}
\DoxyCodeLine{4729     \textcolor{keyword}{call }setmastern\_cll(6)}
\DoxyCodeLine{4730     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{4731     \textcolor{keyword}{call }setmasterargs\_cll(41,args)}
\DoxyCodeLine{4732 }
\DoxyCodeLine{4733     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{4734 }
\DoxyCodeLine{4735     \textcolor{keywordflow}{if} (tenred\_cll.le.6) then}
\DoxyCodeLine{4736     }
\DoxyCodeLine{4737       \textcolor{keywordflow}{if} (mode\_cll.gt.1) \textcolor{keyword}{call }f\_dd\_dummy(rmax)}
\DoxyCodeLine{4738       }
\DoxyCodeLine{4739       \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{4740         \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{4741         mode\_cll = 1}
\DoxyCodeLine{4742         \textcolor{keyword}{call }calctensorfr\_list(tf,tfuv,tferr\_aux,momvec,mominv,masses2,rmax)                                     }
\DoxyCodeLine{4743       }
\DoxyCodeLine{4744         \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{4745         mode\_cll = 2}
\DoxyCodeLine{4746         \textcolor{keyword}{call }calctensorfr\_list(tf2,tfuv2,tferr\_aux2,momvec,mominv,masses2,rmax)                               }
\DoxyCodeLine{4747       }
\DoxyCodeLine{4748         \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{4749         mode\_cll = 3}
\DoxyCodeLine{4750         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4751           norm\_coli=0d0}
\DoxyCodeLine{4752           norm\_dd=0d0}
\DoxyCodeLine{4753           \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{4754             norm\_coli = max(norm\_coli,abs(tf(i)))}
\DoxyCodeLine{4755             norm\_dd = max(norm\_dd,abs(tf2(i)))}
\DoxyCodeLine{4756           \textcolor{keyword}{end }do}
\DoxyCodeLine{4757           \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{4758             norm\_coli = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4759             \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{4760               norm\_coli=1d0/norm\_coli**(4-\/real(r)/2)}
\DoxyCodeLine{4761             else}
\DoxyCodeLine{4762               norm\_coli=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4763             \textcolor{keyword}{end }if}
\DoxyCodeLine{4764           \textcolor{keyword}{end }if}
\DoxyCodeLine{4765           \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{4766             norm\_dd = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4767             \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{4768               norm\_dd=1d0/norm\_dd**(4-\/real(r)/2)}
\DoxyCodeLine{4769             else}
\DoxyCodeLine{4770               norm\_dd=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4771             \textcolor{keyword}{end }if}
\DoxyCodeLine{4772           \textcolor{keyword}{end }if}
\DoxyCodeLine{4773           norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{4774 \textcolor{keywordflow}{        end do}        }
\DoxyCodeLine{4775       }
\DoxyCodeLine{4776         \textcolor{keyword}{call }checktensorslist\_cll(tf,tf2,momvec,mominv,masses2,norm,6,rmax,tfdiff)        }
\DoxyCodeLine{4777        }
\DoxyCodeLine{4778         \textcolor{keywordflow}{if} (tferr\_aux(rmax).lt.tferr\_aux2(rmax)) then}
\DoxyCodeLine{4779           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr))  tferr = max(tferr\_aux,tfdiff*norm)}
\DoxyCodeLine{4780           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4781             tfacc(r) = max(tferr\_aux(r)/norm(r),tfdiff(r))}
\DoxyCodeLine{4782           \textcolor{keyword}{end }do}
\DoxyCodeLine{4783           \textcolor{keywordflow}{if} (monitoring) pointscntften\_coli =  pointscntften\_coli + 1}
\DoxyCodeLine{4784         else}
\DoxyCodeLine{4785           tf = tf2}
\DoxyCodeLine{4786           tfuv = tfuv2        }
\DoxyCodeLine{4787           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr))  tferr = max(tferr\_aux2,tfdiff*norm)    }
\DoxyCodeLine{4788           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4789             tfacc(r) = max(tferr\_aux2(r)/norm(r),tfdiff(r))}
\DoxyCodeLine{4790 \textcolor{keywordflow}{          end do}         }
\DoxyCodeLine{4791           \textcolor{keywordflow}{if} (monitoring) pointscntften\_dd =  pointscntften\_dd + 1}
\DoxyCodeLine{4792         \textcolor{keyword}{end }if}
\DoxyCodeLine{4793         }
\DoxyCodeLine{4794       \textcolor{keywordflow}{else}       }
\DoxyCodeLine{4795         \textcolor{keyword}{call }calctensorfr\_list(tf,tfuv,tferr\_aux,momvec,mominv,masses2,rmax)}
\DoxyCodeLine{4796         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr)) tferr = tferr\_aux}
\DoxyCodeLine{4797         norm = 0d0}
\DoxyCodeLine{4798         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4799           \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{4800             norm(r) = max(norm(r),abs(tf(i)))}
\DoxyCodeLine{4801           \textcolor{keyword}{end }do}
\DoxyCodeLine{4802           \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{4803             norm(r) = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4804             \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{4805               norm(r)=1d0/norm(r)**(4-\/real(r)/2)}
\DoxyCodeLine{4806             else}
\DoxyCodeLine{4807               norm(r)=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4808             \textcolor{keyword}{end }if}
\DoxyCodeLine{4809           \textcolor{keyword}{end }if}
\DoxyCodeLine{4810           tfacc(r) = tferr\_aux(r)/norm(r)}
\DoxyCodeLine{4811 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{4812         }
\DoxyCodeLine{4813       \textcolor{keyword}{end }if}
\DoxyCodeLine{4814       }
\DoxyCodeLine{4815     \textcolor{keywordflow}{else}           }
\DoxyCodeLine{4816       \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{4817         \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{4818         mode\_cll = 1}
\DoxyCodeLine{4819         \textcolor{keyword}{call }f\_main\_cll(cf,cfuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{4820                         mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),mominv(11), \&}
\DoxyCodeLine{4821                         mominv(12),mominv(13),mominv(14),mominv(15),masses2(0),masses2(1), \&}
\DoxyCodeLine{4822                         masses2(2),masses2(3),masses2(4),masses2(5),rmax,ferr2=cferr,id\_in=0) }
\DoxyCodeLine{4823         \textcolor{keyword}{call }calctensorf\_list(tf,tfuv,tferr\_aux,cf,cfuv,cferr,momvec,rmax)                                     }
\DoxyCodeLine{4824       }
\DoxyCodeLine{4825         \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{4826         mode\_cll = 2}
\DoxyCodeLine{4827         \textcolor{keyword}{call }f\_main\_cll(cf,cfuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{4828                         mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),mominv(11), \&}
\DoxyCodeLine{4829                         mominv(12),mominv(13),mominv(14),mominv(15),masses2(0),masses2(1), \&}
\DoxyCodeLine{4830                         masses2(2),masses2(3),masses2(4),masses2(5),rmax,ferr2=cferr,id\_in=0) }
\DoxyCodeLine{4831         \textcolor{keyword}{call }calctensorf\_list(tf2,tfuv2,tferr\_aux2,cf,cfuv,cferr,momvec,rmax)                                }
\DoxyCodeLine{4832       }
\DoxyCodeLine{4833         \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{4834         mode\_cll = 3}
\DoxyCodeLine{4835         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4836           norm\_coli=0d0}
\DoxyCodeLine{4837           norm\_dd=0d0}
\DoxyCodeLine{4838           \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{4839             norm\_coli = max(norm\_coli,abs(tf(i)))}
\DoxyCodeLine{4840             norm\_dd = max(norm\_dd,abs(tf2(i)))}
\DoxyCodeLine{4841           \textcolor{keyword}{end }do}
\DoxyCodeLine{4842           \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{4843             norm\_coli = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4844             \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{4845               norm\_coli=1d0/norm\_coli**(4-\/real(r)/2)}
\DoxyCodeLine{4846             else}
\DoxyCodeLine{4847               norm\_coli=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4848             \textcolor{keyword}{end }if}
\DoxyCodeLine{4849           \textcolor{keyword}{end }if}
\DoxyCodeLine{4850           \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{4851             norm\_dd = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4852             \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{4853               norm\_dd=1d0/norm\_dd**(4-\/real(r)/2)}
\DoxyCodeLine{4854             else}
\DoxyCodeLine{4855               norm\_dd=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4856             \textcolor{keyword}{end }if}
\DoxyCodeLine{4857           \textcolor{keyword}{end }if}
\DoxyCodeLine{4858           norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{4859         \textcolor{keyword}{end }do}
\DoxyCodeLine{4860       }
\DoxyCodeLine{4861         \textcolor{keyword}{call }checktensorslist\_cll(tf,tf2,momvec,mominv,masses2,norm,6,rmax,tfdiff)         }
\DoxyCodeLine{4862        }
\DoxyCodeLine{4863         \textcolor{keywordflow}{if} (tferr\_aux(rmax).lt.tferr\_aux2(rmax)) then}
\DoxyCodeLine{4864           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr))  tferr = max(tferr\_aux,tfdiff*norm)}
\DoxyCodeLine{4865           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4866             tfacc(r) = max(tferr\_aux(r)/norm(r),tfdiff(r))}
\DoxyCodeLine{4867           \textcolor{keyword}{end }do}
\DoxyCodeLine{4868           \textcolor{keywordflow}{if} (monitoring) pointscntften\_coli =  pointscntften\_coli + 1}
\DoxyCodeLine{4869         else}
\DoxyCodeLine{4870           tf = tf2}
\DoxyCodeLine{4871           tfuv = tfuv2        }
\DoxyCodeLine{4872           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr))  tferr = max(tferr\_aux2,tfdiff*norm)    }
\DoxyCodeLine{4873           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4874             tfacc(r) = max(tferr\_aux2(r)/norm(r),tfdiff(r))}
\DoxyCodeLine{4875 \textcolor{keywordflow}{          end do}         }
\DoxyCodeLine{4876           \textcolor{keywordflow}{if} (monitoring) pointscntften\_dd =  pointscntften\_dd + 1}
\DoxyCodeLine{4877         \textcolor{keyword}{end }if}
\DoxyCodeLine{4878         }
\DoxyCodeLine{4879       else}
\DoxyCodeLine{4880         \textcolor{keyword}{call }f\_main\_cll(cf,cfuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{4881                         mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),mominv(11), \&}
\DoxyCodeLine{4882                         mominv(12),mominv(13),mominv(14),mominv(15),masses2(0),masses2(1), \&}
\DoxyCodeLine{4883                         masses2(2),masses2(3),masses2(4),masses2(5),rmax,ferr2=cferr,id\_in=0)}
\DoxyCodeLine{4884         \textcolor{keyword}{call }calctensorf\_list(tf,tfuv,tferr\_aux,cf,cfuv,cferr,momvec,rmax)}
\DoxyCodeLine{4885         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr)) tferr = tferr\_aux}
\DoxyCodeLine{4886         norm = 0d0}
\DoxyCodeLine{4887         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4888           \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{4889             norm(r) = max(norm(r),abs(tf(i)))}
\DoxyCodeLine{4890           \textcolor{keyword}{end }do}
\DoxyCodeLine{4891           \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{4892             norm(r) = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4893             \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{4894               norm(r)=1d0/norm(r)**(4-\/real(r)/2)}
\DoxyCodeLine{4895             else}
\DoxyCodeLine{4896               norm(r)=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4897             \textcolor{keyword}{end }if}
\DoxyCodeLine{4898           \textcolor{keyword}{end }if}
\DoxyCodeLine{4899           tfacc(r) = tferr\_aux(r)/norm(r)}
\DoxyCodeLine{4900 \textcolor{keywordflow}{        end do}       }
\DoxyCodeLine{4901         }
\DoxyCodeLine{4902       \textcolor{keyword}{end }if}
\DoxyCodeLine{4903       }
\DoxyCodeLine{4904     \textcolor{keyword}{end }if}
\DoxyCodeLine{4905     }
\DoxyCodeLine{4906     \textcolor{keyword}{call }propagateaccflag\_cll(tfacc,rmax)}
\DoxyCodeLine{4907     \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{4908 }
\DoxyCodeLine{4909     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{4910       pointscntften\_cll =  pointscntften\_cll + 1}
\DoxyCodeLine{4911 }
\DoxyCodeLine{4912       \textcolor{keywordflow}{if}(maxval(tfacc).gt.reqacc\_cll) accpointscntften\_cll = accpointscntften\_cll + 1}
\DoxyCodeLine{4913 }
\DoxyCodeLine{4914       \textcolor{keywordflow}{if}(maxval(tfacc).gt.critacc\_cll) then}
\DoxyCodeLine{4915         critpointscntften\_cll =  critpointscntften\_cll + 1}
\DoxyCodeLine{4916         \textcolor{keywordflow}{if} ( critpointscntften\_cll.le.noutcritpointsmax\_cll(6) ) then}
\DoxyCodeLine{4917           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TFten\_cll'},0,maxval(tfacc),critpointscntften\_cll)}
\DoxyCodeLine{4918           \textcolor{keywordflow}{if}( critpointscntften\_cll.eq.noutcritpointsmax\_cll(6)) then}
\DoxyCodeLine{4919             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TFten\_cll suppressed'}   }
\DoxyCodeLine{4920             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{4921           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{4922 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{4923 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TFten\_cll'},0,maxval(tfacc),critpointscntften\_cll)}
\DoxyCodeLine{4924           \textcolor{keywordflow}{if}( critpointscntften\_cll.eq.noutcritpointsmax\_cll(6)) then}
\DoxyCodeLine{4925             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TFten\_cll suppressed'}   }
\DoxyCodeLine{4926             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{4927           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{4928 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4929 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{4930       \textcolor{keyword}{end }if}
\DoxyCodeLine{4931     \textcolor{keyword}{end }if}
\DoxyCodeLine{4932 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a912588549e1bc6a08bd0a78f0606fa0b}\label{namespacecollier__tensors_a912588549e1bc6a08bd0a78f0606fa0b}} 
\index{collier\_tensors@{collier\_tensors}!ften\_args\_list\_cll@{ften\_args\_list\_cll}}
\index{ften\_args\_list\_cll@{ften\_args\_list\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{ften\_args\_list\_cll()}{ften\_args\_list\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::ften\+\_\+args\+\_\+list\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:), intent(out)}]{TF,  }\item[{double complex, dimension(\+:), intent(out)}]{T\+Fuv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p2vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p3vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p4vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p5vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p43,  }\item[{double complex, intent(in)}]{p54,  }\item[{double complex, intent(in)}]{p50,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{p42,  }\item[{double complex, intent(in)}]{p53,  }\item[{double complex, intent(in)}]{p40,  }\item[{double complex, intent(in)}]{p51,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p41,  }\item[{double complex, intent(in)}]{p52,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{double complex, intent(in)}]{m42,  }\item[{double complex, intent(in)}]{m52,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Ferr }\end{DoxyParamCaption})}



Definition at line 4638 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{4638     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{4639     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3),p2vec(0:3),p3vec(0:3),p4vec(0:3)}
\DoxyCodeLine{4640     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p5vec(0:3)}
\DoxyCodeLine{4641     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p43,p54,p50,p20,p31,p42,p53,p40}
\DoxyCodeLine{4642     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p51,p30,p41,p52,m02,m12,m22,m32,m42,m52}
\DoxyCodeLine{4643     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TF(:),TFuv(:)}
\DoxyCodeLine{4644     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TFerr(0:rmax)}
\DoxyCodeLine{4645     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{4646 }
\DoxyCodeLine{4647     \textcolor{keywordflow}{if} (6.gt.nmax\_cll) then}
\DoxyCodeLine{4648       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{4649       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Ften\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 6'},eflag,.true.)}
\DoxyCodeLine{4650       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{4651       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 6'}}
\DoxyCodeLine{4652       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{4653       return}
\DoxyCodeLine{4654 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{4655     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{4656       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{4657       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Ften\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{4658       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{4659       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{4660       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{4661       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{4662       return}
\DoxyCodeLine{4663 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{4664 }
\DoxyCodeLine{4665     \textcolor{keyword}{call }ften\_args\_list\_checked\_cll(tf,tfuv,p1vec,p2vec,p3vec,p4vec,p5vec,  \&}
\DoxyCodeLine{4666                            p10,p21,p32,p43,p54,p50,p20,p31,p42,p53,p40,  \&}
\DoxyCodeLine{4667                            p51,p30,p41,p52,m02,m12,m22,m32,m42,m52,rmax,tferr)}
\DoxyCodeLine{4668 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a54bac71e5a70b26e794a149d4cd47aac}\label{namespacecollier__tensors_a54bac71e5a70b26e794a149d4cd47aac}} 
\index{collier\_tensors@{collier\_tensors}!ften\_list\_checked\_cll@{ften\_list\_checked\_cll}}
\index{ften\_list\_checked\_cll@{ften\_list\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{ften\_list\_checked\_cll()}{ften\_list\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::ften\+\_\+list\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TF,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Fuv,  }\item[{double complex, dimension(0\+:3,5), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(15), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:5), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Ferr }\end{DoxyParamCaption})}



Definition at line 4080 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{4080 }
\DoxyCodeLine{4081     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{4082     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,5), MomInv(15), masses2(0:5)}
\DoxyCodeLine{4083     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TF(RtS(rmax)), TFuv(RtS(rmax))}
\DoxyCodeLine{4084     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TFerr(0:rmax)}
\DoxyCodeLine{4085     \textcolor{keywordtype}{double complex} :: TF2(RtS(rmax)), TFuv2(RtS(rmax))}
\DoxyCodeLine{4086     \textcolor{keywordtype}{double complex} :: CF(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4087     \textcolor{keywordtype}{double complex} :: CFuv(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4088     \textcolor{keywordtype}{double precision} :: CFerr(0:rmax), TFerr\_aux(0:rmax), TFerr\_aux2(0:rmax)}
\DoxyCodeLine{4089     \textcolor{keywordtype}{double complex} :: args(41)}
\DoxyCodeLine{4090     \textcolor{keywordtype}{double precision} :: TFdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TFacc(0:rmax)}
\DoxyCodeLine{4091     \textcolor{keywordtype}{integer} :: r,i    }
\DoxyCodeLine{4092     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{4093 }
\DoxyCodeLine{4094     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{4095     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{4096     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{4097     args(9:12) = momvec(0:,3)}
\DoxyCodeLine{4098     args(13:16) = momvec(0:,4)}
\DoxyCodeLine{4099     args(17:20) = momvec(0:,5)}
\DoxyCodeLine{4100     args(21:35) = mominv}
\DoxyCodeLine{4101     args(36:41) = masses2(0:)}
\DoxyCodeLine{4102     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Ften\_cll'})}
\DoxyCodeLine{4103     \textcolor{keyword}{call }setmastern\_cll(6)}
\DoxyCodeLine{4104     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{4105     \textcolor{keyword}{call }setmasterargs\_cll(41,args)}
\DoxyCodeLine{4106 }
\DoxyCodeLine{4107     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{4108 }
\DoxyCodeLine{4109     \textcolor{keywordflow}{if} (tenred\_cll.le.6) then}
\DoxyCodeLine{4110     }
\DoxyCodeLine{4111       \textcolor{keywordflow}{if} (mode\_cll.gt.1) \textcolor{keyword}{call }f\_dd\_dummy(rmax)}
\DoxyCodeLine{4112       }
\DoxyCodeLine{4113       \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{4114         \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{4115         mode\_cll = 1}
\DoxyCodeLine{4116         \textcolor{keyword}{call }calctensorfr\_list(tf,tfuv,tferr\_aux,momvec,mominv,masses2,rmax)                                     }
\DoxyCodeLine{4117       }
\DoxyCodeLine{4118         \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{4119         mode\_cll = 2}
\DoxyCodeLine{4120         \textcolor{keyword}{call }calctensorfr\_list(tf2,tfuv2,tferr\_aux2,momvec,mominv,masses2,rmax)                               }
\DoxyCodeLine{4121 }
\DoxyCodeLine{4122         \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{4123         mode\_cll = 3}
\DoxyCodeLine{4124         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4125           norm\_coli=0d0}
\DoxyCodeLine{4126           norm\_dd=0d0}
\DoxyCodeLine{4127           \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{4128             norm\_coli = max(norm\_coli,abs(tf(i)))}
\DoxyCodeLine{4129             norm\_dd = max(norm\_dd,abs(tf2(i)))}
\DoxyCodeLine{4130           \textcolor{keyword}{end }do}
\DoxyCodeLine{4131           \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{4132             norm\_coli = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4133             \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{4134               norm\_coli=1d0/norm\_coli**(4-\/real(r)/2)}
\DoxyCodeLine{4135             else}
\DoxyCodeLine{4136               norm\_coli=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4137             \textcolor{keyword}{end }if}
\DoxyCodeLine{4138           \textcolor{keyword}{end }if}
\DoxyCodeLine{4139           \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{4140             norm\_dd = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4141             \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{4142               norm\_dd=1d0/norm\_dd**(4-\/real(r)/2)}
\DoxyCodeLine{4143             else}
\DoxyCodeLine{4144               norm\_dd=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4145             \textcolor{keyword}{end }if}
\DoxyCodeLine{4146           \textcolor{keyword}{end }if}
\DoxyCodeLine{4147           norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{4148 \textcolor{keywordflow}{        end do}        }
\DoxyCodeLine{4149       }
\DoxyCodeLine{4150         \textcolor{keyword}{call }checktensorslist\_cll(tf,tf2,momvec,mominv,masses2,norm,6,rmax,tfdiff)        }
\DoxyCodeLine{4151        }
\DoxyCodeLine{4152         \textcolor{keywordflow}{if} (tferr\_aux(rmax).lt.tferr\_aux2(rmax)) then}
\DoxyCodeLine{4153           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr))  tferr = max(tferr\_aux,tfdiff*norm)}
\DoxyCodeLine{4154           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4155             tfacc(r) = max(tferr\_aux(r)/norm(r),tfdiff(r))}
\DoxyCodeLine{4156           \textcolor{keyword}{end }do}
\DoxyCodeLine{4157           \textcolor{keywordflow}{if} (monitoring) pointscntften\_coli =  pointscntften\_coli + 1}
\DoxyCodeLine{4158         else}
\DoxyCodeLine{4159           tf = tf2}
\DoxyCodeLine{4160           tfuv = tfuv2        }
\DoxyCodeLine{4161           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr))  tferr = max(tferr\_aux2,tfdiff*norm)    }
\DoxyCodeLine{4162           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4163             tfacc(r) = max(tferr\_aux2(r)/norm(r),tfdiff(r))}
\DoxyCodeLine{4164 \textcolor{keywordflow}{          end do}         }
\DoxyCodeLine{4165           \textcolor{keywordflow}{if} (monitoring) pointscntften\_dd =  pointscntften\_dd + 1}
\DoxyCodeLine{4166         \textcolor{keyword}{end }if}
\DoxyCodeLine{4167         }
\DoxyCodeLine{4168       \textcolor{keywordflow}{else}       }
\DoxyCodeLine{4169         \textcolor{keyword}{call }calctensorfr\_list(tf,tfuv,tferr\_aux,momvec,mominv,masses2,rmax)}
\DoxyCodeLine{4170         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr)) tferr = tferr\_aux}
\DoxyCodeLine{4171         norm = 0d0}
\DoxyCodeLine{4172         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4173           \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{4174              norm(r) = max(norm(r),abs(tf(i)))}
\DoxyCodeLine{4175           \textcolor{keyword}{end }do}
\DoxyCodeLine{4176           \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{4177             norm(r) = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4178             \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{4179               norm(r)=1d0/norm(r)**(4-\/real(r)/2)}
\DoxyCodeLine{4180             else}
\DoxyCodeLine{4181               norm(r)=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4182             \textcolor{keyword}{end }if}
\DoxyCodeLine{4183           \textcolor{keyword}{end }if}
\DoxyCodeLine{4184           tfacc(r) = tferr\_aux(r)/norm(r)}
\DoxyCodeLine{4185 \textcolor{keywordflow}{        end do}        }
\DoxyCodeLine{4186         }
\DoxyCodeLine{4187       \textcolor{keyword}{end }if}
\DoxyCodeLine{4188       }
\DoxyCodeLine{4189     else}
\DoxyCodeLine{4190     }
\DoxyCodeLine{4191        }
\DoxyCodeLine{4192       \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{4193         \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{4194         mode\_cll = 1}
\DoxyCodeLine{4195         \textcolor{keyword}{call }f\_main\_cll(cf,cfuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{4196                         mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),mominv(11), \&}
\DoxyCodeLine{4197                         mominv(12),mominv(13),mominv(14),mominv(15),masses2(0),masses2(1), \&}
\DoxyCodeLine{4198                         masses2(2),masses2(3),masses2(4),masses2(5),rmax,ferr2=cferr,id\_in=0) }
\DoxyCodeLine{4199         \textcolor{keyword}{call }calctensorf\_list(tf,tfuv,tferr\_aux,cf,cfuv,cferr,momvec,rmax)                                     }
\DoxyCodeLine{4200       }
\DoxyCodeLine{4201         \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{4202         mode\_cll = 2}
\DoxyCodeLine{4203         \textcolor{keyword}{call }f\_main\_cll(cf,cfuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{4204                         mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),mominv(11), \&}
\DoxyCodeLine{4205                         mominv(12),mominv(13),mominv(14),mominv(15),masses2(0),masses2(1), \&}
\DoxyCodeLine{4206                         masses2(2),masses2(3),masses2(4),masses2(5),rmax,ferr2=cferr,id\_in=0) }
\DoxyCodeLine{4207         \textcolor{keyword}{call }calctensorf\_list(tf2,tfuv2,tferr\_aux2,cf,cfuv,cferr,momvec,rmax)                                }
\DoxyCodeLine{4208       }
\DoxyCodeLine{4209         \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{4210         mode\_cll = 3}
\DoxyCodeLine{4211         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4212           norm\_coli=0d0}
\DoxyCodeLine{4213           norm\_dd=0d0}
\DoxyCodeLine{4214           \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{4215             norm\_coli = max(norm\_coli,abs(tf(i)))}
\DoxyCodeLine{4216             norm\_dd = max(norm\_dd,abs(tf2(i)))}
\DoxyCodeLine{4217           \textcolor{keyword}{end }do}
\DoxyCodeLine{4218           \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{4219             norm\_coli = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4220             \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{4221               norm\_coli=1d0/norm\_coli**(4-\/real(r)/2)}
\DoxyCodeLine{4222             else}
\DoxyCodeLine{4223               norm\_coli=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4224             \textcolor{keyword}{end }if}
\DoxyCodeLine{4225           \textcolor{keyword}{end }if}
\DoxyCodeLine{4226           \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{4227             norm\_dd = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4228             \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{4229               norm\_dd=1d0/norm\_dd**(4-\/real(r)/2)}
\DoxyCodeLine{4230             else}
\DoxyCodeLine{4231               norm\_dd=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4232             \textcolor{keyword}{end }if}
\DoxyCodeLine{4233           \textcolor{keyword}{end }if}
\DoxyCodeLine{4234           norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{4235         \textcolor{keyword}{end }do}
\DoxyCodeLine{4236       }
\DoxyCodeLine{4237         \textcolor{keyword}{call }checktensorslist\_cll(tf,tf2,momvec,mominv,masses2,norm,6,rmax,tfdiff)        }
\DoxyCodeLine{4238        }
\DoxyCodeLine{4239         \textcolor{keywordflow}{if} (tferr\_aux(rmax).lt.tferr\_aux2(rmax)) then}
\DoxyCodeLine{4240           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr))  tferr = max(tferr\_aux,tfdiff*norm)}
\DoxyCodeLine{4241           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4242             tfacc(r) = max(tferr\_aux(r)/norm(r),tfdiff(r))}
\DoxyCodeLine{4243           \textcolor{keyword}{end }do}
\DoxyCodeLine{4244           \textcolor{keywordflow}{if} (monitoring) pointscntften\_coli =  pointscntften\_coli + 1}
\DoxyCodeLine{4245         else}
\DoxyCodeLine{4246           tf = tf2}
\DoxyCodeLine{4247           tfuv = tfuv2        }
\DoxyCodeLine{4248           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr))  tferr = max(tferr\_aux2,tfdiff*norm)    }
\DoxyCodeLine{4249           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4250             tfacc(r) = max(tferr\_aux2(r)/norm(r),tfdiff(r))}
\DoxyCodeLine{4251 \textcolor{keywordflow}{          end do}         }
\DoxyCodeLine{4252           \textcolor{keywordflow}{if} (monitoring) pointscntften\_dd =  pointscntften\_dd + 1}
\DoxyCodeLine{4253         \textcolor{keyword}{end }if}
\DoxyCodeLine{4254         }
\DoxyCodeLine{4255       else}
\DoxyCodeLine{4256         \textcolor{keyword}{call }f\_main\_cll(cf,cfuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{4257                         mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),mominv(11), \&}
\DoxyCodeLine{4258                         mominv(12),mominv(13),mominv(14),mominv(15),masses2(0),masses2(1), \&}
\DoxyCodeLine{4259                         masses2(2),masses2(3),masses2(4),masses2(5),rmax,ferr2=cferr,id\_in=0)}
\DoxyCodeLine{4260         \textcolor{keyword}{call }calctensorf\_list(tf,tfuv,tferr\_aux,cf,cfuv,cferr,momvec,rmax)}
\DoxyCodeLine{4261         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr)) tferr = tferr\_aux}
\DoxyCodeLine{4262         norm = 0d0}
\DoxyCodeLine{4263         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{4264           \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{4265             norm(r) = max(norm(r),abs(tf(i)))}
\DoxyCodeLine{4266           \textcolor{keyword}{end }do}
\DoxyCodeLine{4267           \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{4268             norm(r) = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{4269             \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{4270               norm(r)=1d0/norm(r)**(4-\/real(r)/2)}
\DoxyCodeLine{4271             else}
\DoxyCodeLine{4272               norm(r)=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4273             \textcolor{keyword}{end }if}
\DoxyCodeLine{4274           \textcolor{keyword}{end }if}
\DoxyCodeLine{4275           tfacc(r) = tferr\_aux(r)/norm(r)}
\DoxyCodeLine{4276 \textcolor{keywordflow}{        end do}        }
\DoxyCodeLine{4277       }
\DoxyCodeLine{4278       \textcolor{keyword}{end }if}
\DoxyCodeLine{4279       }
\DoxyCodeLine{4280     \textcolor{keyword}{end }if}
\DoxyCodeLine{4281 }
\DoxyCodeLine{4282     \textcolor{keyword}{call }propagateaccflag\_cll(tfacc,rmax)}
\DoxyCodeLine{4283     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{4284 }
\DoxyCodeLine{4285     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{4286       pointscntften\_cll =  pointscntften\_cll + 1}
\DoxyCodeLine{4287 }
\DoxyCodeLine{4288       \textcolor{keywordflow}{if}(maxval(tfacc).gt.reqacc\_cll) accpointscntften\_cll = accpointscntften\_cll + 1}
\DoxyCodeLine{4289 }
\DoxyCodeLine{4290       \textcolor{keywordflow}{if}(maxval(tfacc).gt.critacc\_cll) then}
\DoxyCodeLine{4291         critpointscntften\_cll =  critpointscntften\_cll + 1}
\DoxyCodeLine{4292         \textcolor{keywordflow}{if} ( critpointscntften\_cll.le.noutcritpointsmax\_cll(6) ) then}
\DoxyCodeLine{4293           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TFten\_cll'},0,maxval(tfacc),critpointscntften\_cll)}
\DoxyCodeLine{4294           \textcolor{keywordflow}{if}( critpointscntften\_cll.eq.noutcritpointsmax\_cll(6)) then}
\DoxyCodeLine{4295             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TFten\_cll suppressed'}   }
\DoxyCodeLine{4296             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{4297           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{4298 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{4299 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TFten\_cll'},0,maxval(tfacc),critpointscntften\_cll)}
\DoxyCodeLine{4300           \textcolor{keywordflow}{if}( critpointscntften\_cll.eq.noutcritpointsmax\_cll(6)) then}
\DoxyCodeLine{4301             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TFten\_cll suppressed'}   }
\DoxyCodeLine{4302             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{4303           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{4304 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4305 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{4306       \textcolor{keyword}{end }if}
\DoxyCodeLine{4307     \textcolor{keyword}{end }if}
\DoxyCodeLine{4308 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a33255f6dab2c80c147f49f2f2a8307a9}\label{namespacecollier__tensors_a33255f6dab2c80c147f49f2f2a8307a9}} 
\index{collier\_tensors@{collier\_tensors}!ften\_list\_cll@{ften\_list\_cll}}
\index{ften\_list\_cll@{ften\_list\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{ften\_list\_cll()}{ften\_list\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::ften\+\_\+list\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:), intent(out)}]{TF,  }\item[{double complex, dimension(\+:), intent(out)}]{T\+Fuv,  }\item[{double complex, dimension(0\+:3,5), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(15), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:5), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Ferr }\end{DoxyParamCaption})}



Definition at line 4049 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{4049 }
\DoxyCodeLine{4050     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{4051     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,5), MomInv(15), masses2(0:5)}
\DoxyCodeLine{4052     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TF(:), TFuv(:)}
\DoxyCodeLine{4053     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TFerr(0:rmax)}
\DoxyCodeLine{4054     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{4055 }
\DoxyCodeLine{4056     \textcolor{keywordflow}{if} (6.gt.nmax\_cll) then}
\DoxyCodeLine{4057       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{4058       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Ften\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 6'},eflag,.true.)}
\DoxyCodeLine{4059       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{4060       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 6'}}
\DoxyCodeLine{4061       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{4062       return}
\DoxyCodeLine{4063 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{4064     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{4065       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{4066       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Ften\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{4067       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{4068       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{4069       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{4070       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{4071       return}
\DoxyCodeLine{4072 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{4073 }
\DoxyCodeLine{4074     \textcolor{keyword}{call }ften\_list\_checked\_cll(tf,tfuv,momvec,mominv,masses2,rmax,tferr)}
\DoxyCodeLine{4075 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_ae1aff9e61c040381355b95796fa03928}\label{namespacecollier__tensors_ae1aff9e61c040381355b95796fa03928}} 
\index{collier\_tensors@{collier\_tensors}!ften\_main\_cll@{ften\_main\_cll}}
\index{ften\_main\_cll@{ften\_main\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{ften\_main\_cll()}{ften\_main\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::ften\+\_\+main\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TF,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Fuv,  }\item[{double complex, dimension(0\+:3,5), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(15), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:5), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Ferr }\end{DoxyParamCaption})}



Definition at line 3768 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{3768 }
\DoxyCodeLine{3769     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{3770     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,5), MomInv(15), masses2(0:5)}
\DoxyCodeLine{3771     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TF(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3772     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TFuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3773     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TFerr(0:rmax)}
\DoxyCodeLine{3774     \textcolor{keywordtype}{double complex} :: TF2(0:rmax,0:rmax,0:rmax,0:rmax), TFuv2(0:rmax,0:rmax,0:rmax,0:rmax)    }
\DoxyCodeLine{3775     \textcolor{keywordtype}{double complex} :: CF(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3776     \textcolor{keywordtype}{double complex} :: CFuv(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3777     \textcolor{keywordtype}{double precision} :: CFerr(0:rmax), TFerr\_aux(0:rmax), TFerr\_aux2(0:rmax) }
\DoxyCodeLine{3778     \textcolor{keywordtype}{double complex} :: args(41)}
\DoxyCodeLine{3779     \textcolor{keywordtype}{double precision} :: TFdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TFacc(0:rmax)}
\DoxyCodeLine{3780     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3    }
\DoxyCodeLine{3781     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{3782 }
\DoxyCodeLine{3783     \textcolor{keywordflow}{if} (6.gt.nmax\_cll) then}
\DoxyCodeLine{3784       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{3785       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Ften\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 6'},eflag,.true.)}
\DoxyCodeLine{3786       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{3787       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 6'}}
\DoxyCodeLine{3788       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{3789       return}
\DoxyCodeLine{3790 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{3791     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{3792       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{3793       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Ften\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{3794       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{3795       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{3796       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{3797       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{3798       return}
\DoxyCodeLine{3799 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{3800 }
\DoxyCodeLine{3801     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{3802     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{3803     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{3804     args(9:12) = momvec(0:,3)}
\DoxyCodeLine{3805     args(13:16) = momvec(0:,4)}
\DoxyCodeLine{3806     args(17:20) = momvec(0:,5)}
\DoxyCodeLine{3807     args(21:35) = mominv}
\DoxyCodeLine{3808     args(36:41) = masses2(0:)}
\DoxyCodeLine{3809     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Ften\_cll'})}
\DoxyCodeLine{3810     \textcolor{keyword}{call }setmastern\_cll(6)}
\DoxyCodeLine{3811     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{3812     \textcolor{keyword}{call }setmasterargs\_cll(41,args)}
\DoxyCodeLine{3813 }
\DoxyCodeLine{3814     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{3815 }
\DoxyCodeLine{3816 }
\DoxyCodeLine{3817     \textcolor{keywordflow}{if} (tenred\_cll.le.6) then}
\DoxyCodeLine{3818     }
\DoxyCodeLine{3819       \textcolor{keywordflow}{if} (mode\_cll.gt.1) \textcolor{keyword}{call }f\_dd\_dummy(rmax)}
\DoxyCodeLine{3820              }
\DoxyCodeLine{3821       \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{3822         \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{3823         mode\_cll = 1}
\DoxyCodeLine{3824         \textcolor{keyword}{call }calctensorfr(tf,tfuv,tferr\_aux,momvec,mominv,masses2,rmax)                                     }
\DoxyCodeLine{3825       }
\DoxyCodeLine{3826         \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{3827         mode\_cll = 2}
\DoxyCodeLine{3828         \textcolor{keyword}{call }calctensorfr(tf2,tfuv2,tferr\_aux2,momvec,mominv,masses2,rmax)                               }
\DoxyCodeLine{3829       }
\DoxyCodeLine{3830         \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{3831         mode\_cll = 3}
\DoxyCodeLine{3832         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3833           norm\_coli=0d0}
\DoxyCodeLine{3834           norm\_dd=0d0}
\DoxyCodeLine{3835           \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{3836             \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{3837               \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{3838                 n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{3839                 norm\_coli = max(norm\_coli,abs(tf(n0,n1,n2,n3)))}
\DoxyCodeLine{3840                 norm\_dd = max(norm\_dd,abs(tf2(n0,n1,n2,n3)))}
\DoxyCodeLine{3841               \textcolor{keyword}{end }do}
\DoxyCodeLine{3842             \textcolor{keyword}{end }do}
\DoxyCodeLine{3843           \textcolor{keyword}{end }do}
\DoxyCodeLine{3844           \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{3845             norm\_coli = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{3846             \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{3847               norm\_coli=1d0/norm\_coli**(4-\/real(r)/2)}
\DoxyCodeLine{3848             else}
\DoxyCodeLine{3849               norm\_coli=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{3850             \textcolor{keyword}{end }if}
\DoxyCodeLine{3851           \textcolor{keyword}{end }if}
\DoxyCodeLine{3852           \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{3853             norm\_dd = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{3854             \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{3855               norm\_dd=1d0/norm\_dd**(4-\/real(r)/2)}
\DoxyCodeLine{3856             else}
\DoxyCodeLine{3857               norm\_dd=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{3858             \textcolor{keyword}{end }if}
\DoxyCodeLine{3859           \textcolor{keyword}{end }if}
\DoxyCodeLine{3860           norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{3861         \textcolor{keyword}{end }do}
\DoxyCodeLine{3862       }
\DoxyCodeLine{3863         \textcolor{keyword}{call }checktensors\_cll(tf,tf2,momvec,mominv,masses2,norm,6,rmax,tfdiff)        }
\DoxyCodeLine{3864        }
\DoxyCodeLine{3865         \textcolor{keywordflow}{if} (tferr\_aux(rmax).lt.tferr\_aux2(rmax)) then}
\DoxyCodeLine{3866           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr))  tferr = max(tferr\_aux,tfdiff*norm)}
\DoxyCodeLine{3867           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3868             tfacc(r) = max(tferr\_aux(r)/norm(r),tfdiff(r))}
\DoxyCodeLine{3869           \textcolor{keyword}{end }do}
\DoxyCodeLine{3870           \textcolor{keywordflow}{if} (monitoring) pointscntften\_coli =  pointscntften\_coli + 1}
\DoxyCodeLine{3871         else}
\DoxyCodeLine{3872           tf = tf2}
\DoxyCodeLine{3873           tfuv = tfuv2        }
\DoxyCodeLine{3874           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr))  tferr = max(tferr\_aux2,tfdiff*norm)    }
\DoxyCodeLine{3875           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3876             tfacc(r) = max(tferr\_aux2(r)/norm(r),tfdiff(r))}
\DoxyCodeLine{3877 \textcolor{keywordflow}{          end do}         }
\DoxyCodeLine{3878           \textcolor{keywordflow}{if} (monitoring) pointscntften\_dd =  pointscntften\_dd + 1}
\DoxyCodeLine{3879         \textcolor{keyword}{end }if}
\DoxyCodeLine{3880         }
\DoxyCodeLine{3881       \textcolor{keywordflow}{else}      }
\DoxyCodeLine{3882         \textcolor{keyword}{call }calctensorfr(tf,tfuv,tferr\_aux,momvec,mominv,masses2,rmax)}
\DoxyCodeLine{3883         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr)) tferr = tferr\_aux}
\DoxyCodeLine{3884         norm = 0d0}
\DoxyCodeLine{3885         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3886           \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{3887             \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{3888               \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{3889                 n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{3890                 norm(r) = max(norm(r),abs(tf(n0,n1,n2,n3)))}
\DoxyCodeLine{3891               \textcolor{keyword}{end }do}
\DoxyCodeLine{3892             \textcolor{keyword}{end }do}
\DoxyCodeLine{3893 \textcolor{keywordflow}{          end do}       }
\DoxyCodeLine{3894           \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{3895             norm(r) = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{3896             \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{3897               norm(r)=1d0/norm(r)**(4-\/real(r)/2)}
\DoxyCodeLine{3898             else}
\DoxyCodeLine{3899               norm(r)=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{3900             \textcolor{keyword}{end }if}
\DoxyCodeLine{3901           \textcolor{keyword}{end }if}
\DoxyCodeLine{3902           tfacc(r) = tferr\_aux(r)/norm(r)}
\DoxyCodeLine{3903 \textcolor{keywordflow}{        end do}      }
\DoxyCodeLine{3904       }
\DoxyCodeLine{3905       \textcolor{keyword}{end }if}
\DoxyCodeLine{3906     }
\DoxyCodeLine{3907     }
\DoxyCodeLine{3908     else}
\DoxyCodeLine{3909        }
\DoxyCodeLine{3910       \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{3911         \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{3912         mode\_cll = 1}
\DoxyCodeLine{3913         \textcolor{keyword}{call }f\_main\_cll(cf,cfuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{3914                         mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),mominv(11), \&}
\DoxyCodeLine{3915                         mominv(12),mominv(13),mominv(14),mominv(15),masses2(0),masses2(1), \&}
\DoxyCodeLine{3916                         masses2(2),masses2(3),masses2(4),masses2(5),rmax,ferr2=cferr,id\_in=0) }
\DoxyCodeLine{3917         \textcolor{keyword}{call }calctensorf(tf,tfuv,tferr\_aux,cf,cfuv,cferr,momvec,rmax)                                     }
\DoxyCodeLine{3918       }
\DoxyCodeLine{3919         \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{3920         mode\_cll = 2}
\DoxyCodeLine{3921         \textcolor{keyword}{call }f\_main\_cll(cf,cfuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{3922                         mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),mominv(11), \&}
\DoxyCodeLine{3923                         mominv(12),mominv(13),mominv(14),mominv(15),masses2(0),masses2(1), \&}
\DoxyCodeLine{3924                         masses2(2),masses2(3),masses2(4),masses2(5),rmax,ferr2=cferr,id\_in=0) }
\DoxyCodeLine{3925         \textcolor{keyword}{call }calctensorf(tf2,tfuv2,tferr\_aux2,cf,cfuv,cferr,momvec,rmax)                                }
\DoxyCodeLine{3926       }
\DoxyCodeLine{3927         \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{3928         mode\_cll = 3}
\DoxyCodeLine{3929         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3930           norm\_coli=0d0}
\DoxyCodeLine{3931           norm\_dd=0d0}
\DoxyCodeLine{3932           \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{3933             \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{3934               \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{3935                 n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{3936                 norm\_coli = max(norm\_coli,abs(tf(n0,n1,n2,n3)))}
\DoxyCodeLine{3937                 norm\_dd = max(norm\_dd,abs(tf2(n0,n1,n2,n3)))}
\DoxyCodeLine{3938               \textcolor{keyword}{end }do}
\DoxyCodeLine{3939             \textcolor{keyword}{end }do}
\DoxyCodeLine{3940           \textcolor{keyword}{end }do}
\DoxyCodeLine{3941           \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{3942             norm\_coli = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{3943             \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{3944               norm\_coli=1d0/norm\_coli**(4-\/real(r)/2)}
\DoxyCodeLine{3945             else}
\DoxyCodeLine{3946               norm\_coli=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{3947             \textcolor{keyword}{end }if}
\DoxyCodeLine{3948           \textcolor{keyword}{end }if}
\DoxyCodeLine{3949           \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{3950             norm\_dd = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{3951             \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{3952               norm\_dd=1d0/norm\_dd**(4-\/real(r)/2)}
\DoxyCodeLine{3953             else}
\DoxyCodeLine{3954               norm\_dd=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{3955             \textcolor{keyword}{end }if}
\DoxyCodeLine{3956           \textcolor{keyword}{end }if}
\DoxyCodeLine{3957           norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{3958         \textcolor{keyword}{end }do}
\DoxyCodeLine{3959       }
\DoxyCodeLine{3960         \textcolor{keyword}{call }checktensors\_cll(tf,tf2,momvec,mominv,masses2,norm,6,rmax,tfdiff)        }
\DoxyCodeLine{3961        }
\DoxyCodeLine{3962         \textcolor{keywordflow}{if} (tferr\_aux(rmax).lt.tferr\_aux2(rmax)) then}
\DoxyCodeLine{3963           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr))  tferr = max(tferr\_aux,tfdiff*norm)}
\DoxyCodeLine{3964           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3965             tfacc(r) = max(tferr\_aux(r)/norm(r),tfdiff(r))}
\DoxyCodeLine{3966           \textcolor{keyword}{end }do}
\DoxyCodeLine{3967           \textcolor{keywordflow}{if} (monitoring) pointscntften\_coli =  pointscntften\_coli + 1}
\DoxyCodeLine{3968         else}
\DoxyCodeLine{3969           tf = tf2}
\DoxyCodeLine{3970           tfuv = tfuv2        }
\DoxyCodeLine{3971           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr))  tferr = max(tferr\_aux2,tfdiff*norm)    }
\DoxyCodeLine{3972           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3973             tfacc(r) = max(tferr\_aux2(r)/norm(r),tfdiff(r))}
\DoxyCodeLine{3974 \textcolor{keywordflow}{          end do}         }
\DoxyCodeLine{3975           \textcolor{keywordflow}{if} (monitoring) pointscntften\_dd =  pointscntften\_dd + 1}
\DoxyCodeLine{3976         \textcolor{keyword}{end }if}
\DoxyCodeLine{3977         }
\DoxyCodeLine{3978       else}
\DoxyCodeLine{3979         \textcolor{keyword}{call }f\_main\_cll(cf,cfuv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5), \&}
\DoxyCodeLine{3980                         mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),mominv(11), \&}
\DoxyCodeLine{3981                         mominv(12),mominv(13),mominv(14),mominv(15),masses2(0),masses2(1), \&}
\DoxyCodeLine{3982                         masses2(2),masses2(3),masses2(4),masses2(5),rmax,ferr2=cferr,id\_in=0)}
\DoxyCodeLine{3983         \textcolor{keyword}{call }calctensorf(tf,tfuv,tferr\_aux,cf,cfuv,cferr,momvec,rmax)}
\DoxyCodeLine{3984         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tferr)) tferr = tferr\_aux       }
\DoxyCodeLine{3985         norm = 0d0}
\DoxyCodeLine{3986         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{3987           \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{3988             \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{3989               \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{3990                 n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{3991                 norm(r) = max(norm(r),abs(tf(n0,n1,n2,n3)))}
\DoxyCodeLine{3992               \textcolor{keyword}{end }do}
\DoxyCodeLine{3993             \textcolor{keyword}{end }do}
\DoxyCodeLine{3994 \textcolor{keywordflow}{          end do}        }
\DoxyCodeLine{3995           \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{3996             norm(r) = max(maxval(abs(mominv(1:15))),maxval(abs(masses2(0:5))))}
\DoxyCodeLine{3997             \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{3998               norm(r)=1d0/norm(r)**(4-\/real(r)/2)}
\DoxyCodeLine{3999             else}
\DoxyCodeLine{4000               norm(r)=1d0/muir2\_cll**(4-\/real(r)/2)}
\DoxyCodeLine{4001             \textcolor{keyword}{end }if}
\DoxyCodeLine{4002           \textcolor{keyword}{end }if}
\DoxyCodeLine{4003           tfacc(r) = tferr\_aux(r)/norm(r)}
\DoxyCodeLine{4004 \textcolor{keywordflow}{        end do}        }
\DoxyCodeLine{4005         }
\DoxyCodeLine{4006       \textcolor{keyword}{end }if}
\DoxyCodeLine{4007       }
\DoxyCodeLine{4008     \textcolor{keyword}{end }if}
\DoxyCodeLine{4009 }
\DoxyCodeLine{4010     \textcolor{keyword}{call }propagateaccflag\_cll(tfacc,rmax)}
\DoxyCodeLine{4011     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{4012 }
\DoxyCodeLine{4013     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{4014       pointscntften\_cll =  pointscntften\_cll + 1}
\DoxyCodeLine{4015 }
\DoxyCodeLine{4016       \textcolor{keywordflow}{if}(maxval(tfacc).gt.reqacc\_cll) accpointscntften\_cll = accpointscntften\_cll + 1}
\DoxyCodeLine{4017 }
\DoxyCodeLine{4018       \textcolor{keywordflow}{if}(maxval(tfacc).gt.critacc\_cll) then}
\DoxyCodeLine{4019         critpointscntften\_cll =  critpointscntften\_cll + 1}
\DoxyCodeLine{4020         \textcolor{keywordflow}{if} ( critpointscntften\_cll.le.noutcritpointsmax\_cll(6) ) then}
\DoxyCodeLine{4021           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TFten\_cll'},0,maxval(tfacc),critpointscntften\_cll)}
\DoxyCodeLine{4022           \textcolor{keywordflow}{if}( critpointscntften\_cll.eq.noutcritpointsmax\_cll(6)) then}
\DoxyCodeLine{4023             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TFten\_cll suppressed'}   }
\DoxyCodeLine{4024             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{4025           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{4026 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{4027 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TFten\_cll'},0,maxval(tfacc),critpointscntften\_cll)}
\DoxyCodeLine{4028           \textcolor{keywordflow}{if}( critpointscntften\_cll.eq.noutcritpointsmax\_cll(6)) then}
\DoxyCodeLine{4029             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TFten\_cll suppressed'}   }
\DoxyCodeLine{4030             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{4031           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{4032 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4033 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{4034       \textcolor{keyword}{end }if}
\DoxyCodeLine{4035     \textcolor{keyword}{end }if}
\DoxyCodeLine{4036 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a4936ce1ce9f20c0bc2aa38a080ca897c}\label{namespacecollier__tensors_a4936ce1ce9f20c0bc2aa38a080ca897c}} 
\index{collier\_tensors@{collier\_tensors}!gten\_args\_cll@{gten\_args\_cll}}
\index{gten\_args\_cll@{gten\_args\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{gten\_args\_cll()}{gten\_args\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::gten\+\_\+args\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TG,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Guv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p2vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p3vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p4vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p5vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p6vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p43,  }\item[{double complex, intent(in)}]{p54,  }\item[{double complex, intent(in)}]{p65,  }\item[{double complex, intent(in)}]{p60,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{p42,  }\item[{double complex, intent(in)}]{p53,  }\item[{double complex, intent(in)}]{p64,  }\item[{double complex, intent(in)}]{p50,  }\item[{double complex, intent(in)}]{p61,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p41,  }\item[{double complex, intent(in)}]{p52,  }\item[{double complex, intent(in)}]{p63,  }\item[{double complex, intent(in)}]{p40,  }\item[{double complex, intent(in)}]{p51,  }\item[{double complex, intent(in)}]{p62,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{double complex, intent(in)}]{m42,  }\item[{double complex, intent(in)}]{m52,  }\item[{double complex, intent(in)}]{m62,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Gerr }\end{DoxyParamCaption})}



Definition at line 5371 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5371     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{5372     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3),p2vec(0:3),p3vec(0:3),p4vec(0:3)}
\DoxyCodeLine{5373     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p5vec(0:3),p6vec(0:3)}
\DoxyCodeLine{5374     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p43,p54,p65,p60,p20,p31,p42,p53}
\DoxyCodeLine{5375     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p64,p50,p61,p30,p41,p52,p63,p40,p51,p62}
\DoxyCodeLine{5376     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: m02,m12,m22,m32,m42,m52,m62}
\DoxyCodeLine{5377     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TG(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5378     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TGuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5379     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TGerr(0:rmax)}
\DoxyCodeLine{5380     \textcolor{keywordtype}{double complex} :: TG2(0:rmax,0:rmax,0:rmax,0:rmax), TGuv2(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5381     \textcolor{keywordtype}{double precision} :: TGerr\_aux(0:rmax),TGerr\_aux2(0:rmax)   }
\DoxyCodeLine{5382     \textcolor{keywordtype}{double complex} :: MomVec(0:3,6), MomInv(21), masses2(0:6)}
\DoxyCodeLine{5383     \textcolor{keywordtype}{double complex} :: CG(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax) }
\DoxyCodeLine{5384     \textcolor{keywordtype}{double complex} :: CGuv(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5385     \textcolor{keywordtype}{double precision} :: CGerr(0:rmax), TGacc(0:rmax)}
\DoxyCodeLine{5386     \textcolor{keywordtype}{double precision} :: norm(0:rmax),norm\_coli,norm\_dd, TGdiff(0:rmax)}
\DoxyCodeLine{5387     \textcolor{keywordtype}{double complex} :: args(52)}
\DoxyCodeLine{5388     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3}
\DoxyCodeLine{5389     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{5390 }
\DoxyCodeLine{5391     \textcolor{keywordflow}{if} (7.gt.nmax\_cll) then}
\DoxyCodeLine{5392       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{5393       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Gten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 7'},eflag,.true.)}
\DoxyCodeLine{5394       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{5395       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 7'}}
\DoxyCodeLine{5396       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{5397       return}
\DoxyCodeLine{5398 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{5399     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{5400       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{5401       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Gten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{5402       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{5403       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{5404       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{5405       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{5406       return}
\DoxyCodeLine{5407 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{5408 }
\DoxyCodeLine{5409     momvec(0:,1) = p1vec}
\DoxyCodeLine{5410     momvec(0:,2) = p2vec}
\DoxyCodeLine{5411     momvec(0:,3) = p3vec}
\DoxyCodeLine{5412     momvec(0:,4) = p4vec}
\DoxyCodeLine{5413     momvec(0:,5) = p5vec}
\DoxyCodeLine{5414     momvec(0:,6) = p6vec}
\DoxyCodeLine{5415     mominv(1) = p10}
\DoxyCodeLine{5416     mominv(2) = p21}
\DoxyCodeLine{5417     mominv(3) = p32}
\DoxyCodeLine{5418     mominv(4) = p43}
\DoxyCodeLine{5419     mominv(5) = p54}
\DoxyCodeLine{5420     mominv(6) = p65}
\DoxyCodeLine{5421     mominv(7) = p60}
\DoxyCodeLine{5422     mominv(8) = p20}
\DoxyCodeLine{5423     mominv(9) = p31}
\DoxyCodeLine{5424     mominv(10) = p42}
\DoxyCodeLine{5425     mominv(11) = p53}
\DoxyCodeLine{5426     mominv(12) = p64}
\DoxyCodeLine{5427     mominv(13) = p50}
\DoxyCodeLine{5428     mominv(14) = p61}
\DoxyCodeLine{5429     mominv(15) = p30}
\DoxyCodeLine{5430     mominv(16) = p41}
\DoxyCodeLine{5431     mominv(17) = p52}
\DoxyCodeLine{5432     mominv(18) = p63}
\DoxyCodeLine{5433     mominv(19) = p40}
\DoxyCodeLine{5434     mominv(20) = p51}
\DoxyCodeLine{5435     mominv(21) = p62}
\DoxyCodeLine{5436     masses2(0) = m02}
\DoxyCodeLine{5437     masses2(1) = m12}
\DoxyCodeLine{5438     masses2(2) = m22}
\DoxyCodeLine{5439     masses2(3) = m32}
\DoxyCodeLine{5440     masses2(4) = m42}
\DoxyCodeLine{5441     masses2(5) = m52}
\DoxyCodeLine{5442     masses2(6) = m62}
\DoxyCodeLine{5443 }
\DoxyCodeLine{5444     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{5445     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{5446     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{5447     args(9:12) = momvec(0:,3)}
\DoxyCodeLine{5448     args(13:16) = momvec(0:,4)}
\DoxyCodeLine{5449     args(17:20) = momvec(0:,5)}
\DoxyCodeLine{5450     args(21:24) = momvec(0:,6)}
\DoxyCodeLine{5451     args(25:45) = mominv}
\DoxyCodeLine{5452     args(46:52) = masses2}
\DoxyCodeLine{5453     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Gten\_cll'})}
\DoxyCodeLine{5454     \textcolor{keyword}{call }setmastern\_cll(7)}
\DoxyCodeLine{5455     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{5456     \textcolor{keyword}{call }setmasterargs\_cll(52,args)}
\DoxyCodeLine{5457 }
\DoxyCodeLine{5458     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{5459 }
\DoxyCodeLine{5460 }
\DoxyCodeLine{5461     \textcolor{keywordflow}{if} (tenred\_cll.le.7) then}
\DoxyCodeLine{5462     }
\DoxyCodeLine{5463       \textcolor{keywordflow}{if} (mode\_cll.gt.1) \textcolor{keyword}{call }tn\_dd\_dummy(7,rmax)  }
\DoxyCodeLine{5464       }
\DoxyCodeLine{5465       \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{5466         \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{5467         mode\_cll = 1}
\DoxyCodeLine{5468         \textcolor{keyword}{call }calctensortnr(tg,tguv,tgerr\_aux,momvec,mominv,masses2,7,rmax,0)        }
\DoxyCodeLine{5469       }
\DoxyCodeLine{5470         \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{5471         mode\_cll = 2}
\DoxyCodeLine{5472         \textcolor{keyword}{call }calctensortnr(tg2,tguv2,tgerr\_aux2,momvec,mominv,masses2,7,rmax,0)         }
\DoxyCodeLine{5473       }
\DoxyCodeLine{5474         \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{5475         mode\_cll = 3}
\DoxyCodeLine{5476         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5477           norm\_coli=0d0}
\DoxyCodeLine{5478           norm\_dd=0d0}
\DoxyCodeLine{5479           \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{5480             \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{5481               \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{5482                 n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{5483                 norm\_coli = max(norm\_coli,abs(tg(n0,n1,n2,n3)))}
\DoxyCodeLine{5484                 norm\_dd = max(norm\_dd,abs(tg2(n0,n1,n2,n3)))}
\DoxyCodeLine{5485               \textcolor{keyword}{end }do}
\DoxyCodeLine{5486             \textcolor{keyword}{end }do}
\DoxyCodeLine{5487           \textcolor{keyword}{end }do}
\DoxyCodeLine{5488           \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{5489             norm\_coli = max(maxval(abs(mominv(1:21))),maxval(abs(masses2(0:6))))}
\DoxyCodeLine{5490             \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{5491               norm\_coli=1d0/norm\_coli**(5-\/real(r)/2)}
\DoxyCodeLine{5492             else}
\DoxyCodeLine{5493               norm\_coli=1d0/muir2\_cll**(5-\/real(r)/2)}
\DoxyCodeLine{5494             \textcolor{keyword}{end }if}
\DoxyCodeLine{5495           \textcolor{keyword}{end }if}
\DoxyCodeLine{5496           \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{5497             norm\_dd = max(maxval(abs(mominv(1:21))),maxval(abs(masses2(0:6))))}
\DoxyCodeLine{5498             \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{5499               norm\_dd=1d0/norm\_dd**(5-\/real(r)/2)}
\DoxyCodeLine{5500             else}
\DoxyCodeLine{5501               norm\_dd=1d0/muir2\_cll**(5-\/real(r)/2)}
\DoxyCodeLine{5502             \textcolor{keyword}{end }if}
\DoxyCodeLine{5503           \textcolor{keyword}{end }if}
\DoxyCodeLine{5504           norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{5505         \textcolor{keyword}{end }do}
\DoxyCodeLine{5506       }
\DoxyCodeLine{5507         \textcolor{keyword}{call }checktensors\_cll(tg,tg2,momvec,mominv,masses2,norm,7,rmax,tgdiff)        }
\DoxyCodeLine{5508        }
\DoxyCodeLine{5509         \textcolor{keywordflow}{if} (tgerr\_aux(rmax).lt.tgerr\_aux2(rmax)) then}
\DoxyCodeLine{5510           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tgerr))  tgerr = max(tgerr\_aux,tgdiff*norm)}
\DoxyCodeLine{5511           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5512             tgacc(r) = max(tgerr\_aux(r)/norm(r),tgdiff(r))}
\DoxyCodeLine{5513           \textcolor{keyword}{end }do}
\DoxyCodeLine{5514           \textcolor{keywordflow}{if} (monitoring) pointscntgten\_coli =  pointscntgten\_coli + 1}
\DoxyCodeLine{5515         else}
\DoxyCodeLine{5516           tg = tg2}
\DoxyCodeLine{5517           tguv = tguv2        }
\DoxyCodeLine{5518           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tgerr))  tgerr = max(tgerr\_aux2,tgdiff*norm)    }
\DoxyCodeLine{5519           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5520             tgacc(r) = max(tgerr\_aux2(r)/norm(r),tgdiff(r))}
\DoxyCodeLine{5521 \textcolor{keywordflow}{          end do}         }
\DoxyCodeLine{5522           \textcolor{keywordflow}{if} (monitoring) pointscntgten\_dd =  pointscntgten\_dd + 1}
\DoxyCodeLine{5523         \textcolor{keyword}{end }if}
\DoxyCodeLine{5524         }
\DoxyCodeLine{5525       \textcolor{keywordflow}{else}    }
\DoxyCodeLine{5526         \textcolor{keyword}{call }calctensortnr(tg,tguv,tgerr\_aux,momvec,mominv,masses2,7,rmax,0)        }
\DoxyCodeLine{5527         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tgerr)) tgerr = tgerr\_aux}
\DoxyCodeLine{5528         norm = 0d0}
\DoxyCodeLine{5529         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5530           \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{5531             \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{5532               \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{5533                 n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{5534                 norm(r) = max(norm(r),abs(tg(n0,n1,n2,n3)))}
\DoxyCodeLine{5535               \textcolor{keyword}{end }do}
\DoxyCodeLine{5536             \textcolor{keyword}{end }do}
\DoxyCodeLine{5537           \textcolor{keyword}{end }do}
\DoxyCodeLine{5538           \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{5539             norm(r) = max(maxval(abs(mominv(1:21))),maxval(abs(masses2(0:6))))}
\DoxyCodeLine{5540             \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{5541               norm(r)=1d0/norm(r)**(5-\/real(r)/2)}
\DoxyCodeLine{5542             else}
\DoxyCodeLine{5543               norm(r)=1d0/muir2\_cll**(5-\/real(r)/2)}
\DoxyCodeLine{5544             \textcolor{keyword}{end }if}
\DoxyCodeLine{5545           \textcolor{keyword}{end }if}
\DoxyCodeLine{5546           tgacc(r) = tgerr\_aux(r)/norm(r)}
\DoxyCodeLine{5547 \textcolor{keywordflow}{        end do}        }
\DoxyCodeLine{5548         }
\DoxyCodeLine{5549 \textcolor{keywordflow}{      end if}      }
\DoxyCodeLine{5550       }
\DoxyCodeLine{5551     else}
\DoxyCodeLine{5552       \textcolor{keyword}{call }g\_main\_cll(cg,cguv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6), \&}
\DoxyCodeLine{5553                       mominv(7),mominv(8),mominv(9),mominv(10),mominv(11),mominv(12), \&}
\DoxyCodeLine{5554                       mominv(13),mominv(14),mominv(15),mominv(16),mominv(17),mominv(18), \&}
\DoxyCodeLine{5555                       mominv(19),mominv(20),mominv(21),masses2(0),masses2(1),masses2(2), \&}
\DoxyCodeLine{5556                       masses2(3),masses2(4),masses2(5),masses2(6),rmax,gerr2=cgerr,id\_in=0)}
\DoxyCodeLine{5557       \textcolor{keyword}{call }calctensorg(tg,tguv,tgerr\_aux,cg,cguv,cgerr,momvec,rmax)}
\DoxyCodeLine{5558       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tgerr)) tgerr = tgerr\_aux}
\DoxyCodeLine{5559       norm = 0d0}
\DoxyCodeLine{5560       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5561         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{5562           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{5563             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{5564               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{5565               norm(r) = max(norm(r),abs(tg(n0,n1,n2,n3)))}
\DoxyCodeLine{5566             \textcolor{keyword}{end }do}
\DoxyCodeLine{5567           \textcolor{keyword}{end }do}
\DoxyCodeLine{5568 \textcolor{keywordflow}{        end do}      }
\DoxyCodeLine{5569         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{5570           norm(r) = max(maxval(abs(mominv(1:21))),maxval(abs(masses2(0:6))))}
\DoxyCodeLine{5571           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{5572             norm(r)=1d0/norm(r)**(5-\/real(r)/2)}
\DoxyCodeLine{5573           else}
\DoxyCodeLine{5574             norm(r)=1d0/muir2\_cll**(5-\/real(r)/2)}
\DoxyCodeLine{5575           \textcolor{keyword}{end }if}
\DoxyCodeLine{5576         \textcolor{keyword}{end }if}
\DoxyCodeLine{5577         tgacc(r) = tgerr\_aux(r)/norm(r)}
\DoxyCodeLine{5578 \textcolor{keywordflow}{      end do}      }
\DoxyCodeLine{5579     \textcolor{keyword}{end }if}
\DoxyCodeLine{5580 }
\DoxyCodeLine{5581     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{5582       pointscntgten\_cll =  pointscntgten\_cll + 1}
\DoxyCodeLine{5583 }
\DoxyCodeLine{5584       \textcolor{keywordflow}{if}(maxval(tgacc).gt.reqacc\_cll) accpointscntgten\_cll = accpointscntgten\_cll + 1}
\DoxyCodeLine{5585 }
\DoxyCodeLine{5586       \textcolor{keywordflow}{if}(maxval(tgacc).gt.critacc\_cll) then}
\DoxyCodeLine{5587         critpointscntgten\_cll =  critpointscntgten\_cll + 1}
\DoxyCodeLine{5588         \textcolor{keywordflow}{if} ( critpointscntgten\_cll.le.noutcritpointsmax\_cll(7) ) then}
\DoxyCodeLine{5589           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TGten\_cll'},0,maxval(tgacc),critpointscntgten\_cll)}
\DoxyCodeLine{5590           \textcolor{keywordflow}{if}( critpointscntgten\_cll.eq.noutcritpointsmax\_cll(7)) then}
\DoxyCodeLine{5591             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TGten\_cll suppressed'}   }
\DoxyCodeLine{5592             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{5593           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{5594         \textcolor{keyword}{end }if}
\DoxyCodeLine{5595       \textcolor{keyword}{end }if}
\DoxyCodeLine{5596     \textcolor{keyword}{end }if}
\DoxyCodeLine{5597 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_ab7d6a27a15d210162f8d6d73143887e8}\label{namespacecollier__tensors_ab7d6a27a15d210162f8d6d73143887e8}} 
\index{collier\_tensors@{collier\_tensors}!gten\_args\_list\_checked\_cll@{gten\_args\_list\_checked\_cll}}
\index{gten\_args\_list\_checked\_cll@{gten\_args\_list\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{gten\_args\_list\_checked\_cll()}{gten\_args\_list\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::gten\+\_\+args\+\_\+list\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TG,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Guv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p2vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p3vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p4vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p5vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p6vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p43,  }\item[{double complex, intent(in)}]{p54,  }\item[{double complex, intent(in)}]{p65,  }\item[{double complex, intent(in)}]{p60,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{p42,  }\item[{double complex, intent(in)}]{p53,  }\item[{double complex, intent(in)}]{p64,  }\item[{double complex, intent(in)}]{p50,  }\item[{double complex, intent(in)}]{p61,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p41,  }\item[{double complex, intent(in)}]{p52,  }\item[{double complex, intent(in)}]{p63,  }\item[{double complex, intent(in)}]{p40,  }\item[{double complex, intent(in)}]{p51,  }\item[{double complex, intent(in)}]{p62,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{double complex, intent(in)}]{m42,  }\item[{double complex, intent(in)}]{m52,  }\item[{double complex, intent(in)}]{m62,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Gerr }\end{DoxyParamCaption})}



Definition at line 5665 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5665     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{5666     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3),p2vec(0:3),p3vec(0:3),p4vec(0:3)}
\DoxyCodeLine{5667     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p5vec(0:3),p6vec(0:3)}
\DoxyCodeLine{5668     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p43,p54,p65,p60,p20,p31,p42,p53}
\DoxyCodeLine{5669     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p64,p50,p61,p30,p41,p52,p63,p40,p51,p62}
\DoxyCodeLine{5670     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: m02,m12,m22,m32,m42,m52,m62}
\DoxyCodeLine{5671     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TG(RtS(rmax)), TGuv(RtS(rmax))}
\DoxyCodeLine{5672     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TGerr(0:rmax)}
\DoxyCodeLine{5673     \textcolor{keywordtype}{double complex} :: TG2(RtS(rmax)), TGuv2(RtS(rmax))}
\DoxyCodeLine{5674     \textcolor{keywordtype}{double precision} :: TGerr\_aux(0:rmax), TGerr\_aux2(0:rmax)   }
\DoxyCodeLine{5675     \textcolor{keywordtype}{double complex} :: MomVec(0:3,6), MomInv(21), masses2(0:6)}
\DoxyCodeLine{5676     \textcolor{keywordtype}{double complex} :: CG(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5677     \textcolor{keywordtype}{double complex} :: CGuv(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5678     \textcolor{keywordtype}{double precision} :: CGerr(0:rmax), TGacc(0:rmax)}
\DoxyCodeLine{5679     \textcolor{keywordtype}{double precision} :: norm(0:rmax), TGdiff(0:rmax), norm\_coli, norm\_dd}
\DoxyCodeLine{5680     \textcolor{keywordtype}{double complex} :: args(52)}
\DoxyCodeLine{5681     \textcolor{keywordtype}{integer} :: r,i}
\DoxyCodeLine{5682     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{5683 }
\DoxyCodeLine{5684     momvec(0:,1) = p1vec}
\DoxyCodeLine{5685     momvec(0:,2) = p2vec}
\DoxyCodeLine{5686     momvec(0:,3) = p3vec}
\DoxyCodeLine{5687     momvec(0:,4) = p4vec}
\DoxyCodeLine{5688     momvec(0:,5) = p5vec}
\DoxyCodeLine{5689     momvec(0:,6) = p6vec}
\DoxyCodeLine{5690     mominv(1) = p10}
\DoxyCodeLine{5691     mominv(2) = p21}
\DoxyCodeLine{5692     mominv(3) = p32}
\DoxyCodeLine{5693     mominv(4) = p43}
\DoxyCodeLine{5694     mominv(5) = p54}
\DoxyCodeLine{5695     mominv(6) = p65}
\DoxyCodeLine{5696     mominv(7) = p60}
\DoxyCodeLine{5697     mominv(8) = p20}
\DoxyCodeLine{5698     mominv(9) = p31}
\DoxyCodeLine{5699     mominv(10) = p42}
\DoxyCodeLine{5700     mominv(11) = p53}
\DoxyCodeLine{5701     mominv(12) = p64}
\DoxyCodeLine{5702     mominv(13) = p50}
\DoxyCodeLine{5703     mominv(14) = p61}
\DoxyCodeLine{5704     mominv(15) = p30}
\DoxyCodeLine{5705     mominv(16) = p41}
\DoxyCodeLine{5706     mominv(17) = p52}
\DoxyCodeLine{5707     mominv(18) = p63}
\DoxyCodeLine{5708     mominv(19) = p40}
\DoxyCodeLine{5709     mominv(20) = p51}
\DoxyCodeLine{5710     mominv(21) = p62}
\DoxyCodeLine{5711     masses2(0) = m02}
\DoxyCodeLine{5712     masses2(1) = m12}
\DoxyCodeLine{5713     masses2(2) = m22}
\DoxyCodeLine{5714     masses2(3) = m32}
\DoxyCodeLine{5715     masses2(4) = m42}
\DoxyCodeLine{5716     masses2(5) = m52}
\DoxyCodeLine{5717     masses2(6) = m62}
\DoxyCodeLine{5718 }
\DoxyCodeLine{5719     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{5720     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{5721     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{5722     args(9:12) = momvec(0:,3)}
\DoxyCodeLine{5723     args(13:16) = momvec(0:,4)}
\DoxyCodeLine{5724     args(17:20) = momvec(0:,5)}
\DoxyCodeLine{5725     args(21:24) = momvec(0:,6)}
\DoxyCodeLine{5726     args(25:45) = mominv}
\DoxyCodeLine{5727     args(46:52) = masses2}
\DoxyCodeLine{5728     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Gten\_cll'})}
\DoxyCodeLine{5729     \textcolor{keyword}{call }setmastern\_cll(7)}
\DoxyCodeLine{5730     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{5731     \textcolor{keyword}{call }setmasterargs\_cll(52,args)}
\DoxyCodeLine{5732 }
\DoxyCodeLine{5733     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{5734 }
\DoxyCodeLine{5735 }
\DoxyCodeLine{5736     \textcolor{keywordflow}{if} (tenred\_cll.le.7) then}
\DoxyCodeLine{5737      }
\DoxyCodeLine{5738       \textcolor{keywordflow}{if} (mode\_cll.gt.1) \textcolor{keyword}{call }tn\_dd\_dummy(7,rmax)  }
\DoxyCodeLine{5739       }
\DoxyCodeLine{5740       \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{5741         \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{5742         mode\_cll = 1}
\DoxyCodeLine{5743         \textcolor{keyword}{call }calctensortnr\_list(tg,tguv,tgerr\_aux,momvec,mominv,masses2,7,rmax)        }
\DoxyCodeLine{5744       }
\DoxyCodeLine{5745         \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{5746         mode\_cll = 2}
\DoxyCodeLine{5747         \textcolor{keyword}{call }calctensortnr\_list(tg2,tguv2,tgerr\_aux2,momvec,mominv,masses2,7,rmax)         }
\DoxyCodeLine{5748       }
\DoxyCodeLine{5749         \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{5750         mode\_cll = 3}
\DoxyCodeLine{5751         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5752           norm\_coli=0d0}
\DoxyCodeLine{5753           norm\_dd=0d0}
\DoxyCodeLine{5754           \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)          }
\DoxyCodeLine{5755             norm\_coli = max(norm\_coli,abs(tg(i)))}
\DoxyCodeLine{5756             norm\_dd = max(norm\_dd,abs(tg2(i)))}
\DoxyCodeLine{5757           \textcolor{keyword}{end }do}
\DoxyCodeLine{5758           \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{5759             norm\_coli = max(maxval(abs(mominv(1:21))),maxval(abs(masses2(0:6))))}
\DoxyCodeLine{5760             \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{5761               norm\_coli=1d0/norm\_coli**(5-\/real(r)/2)}
\DoxyCodeLine{5762             else}
\DoxyCodeLine{5763               norm\_coli=1d0/muir2\_cll**(5-\/real(r)/2)}
\DoxyCodeLine{5764             \textcolor{keyword}{end }if}
\DoxyCodeLine{5765           \textcolor{keyword}{end }if}
\DoxyCodeLine{5766           \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{5767             norm\_dd = max(maxval(abs(mominv(1:21))),maxval(abs(masses2(0:6))))}
\DoxyCodeLine{5768             \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{5769               norm\_dd=1d0/norm\_dd**(5-\/real(r)/2)}
\DoxyCodeLine{5770             else}
\DoxyCodeLine{5771               norm\_dd=1d0/muir2\_cll**(5-\/real(r)/2)}
\DoxyCodeLine{5772             \textcolor{keyword}{end }if}
\DoxyCodeLine{5773           \textcolor{keyword}{end }if}
\DoxyCodeLine{5774           norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{5775         \textcolor{keyword}{end }do}
\DoxyCodeLine{5776       }
\DoxyCodeLine{5777         \textcolor{keyword}{call }checktensorslist\_cll(tg,tg2,momvec,mominv,masses2,norm,7,rmax,tgdiff)        }
\DoxyCodeLine{5778        }
\DoxyCodeLine{5779         \textcolor{keywordflow}{if} (tgerr\_aux(rmax).lt.tgerr\_aux2(rmax)) then}
\DoxyCodeLine{5780           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tgerr))  tgerr = max(tgerr\_aux,tgdiff*norm)}
\DoxyCodeLine{5781           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5782             tgacc(r) = max(tgerr\_aux(r)/norm(r),tgdiff(r))}
\DoxyCodeLine{5783           \textcolor{keyword}{end }do}
\DoxyCodeLine{5784           \textcolor{keywordflow}{if} (monitoring) pointscntgten\_coli =  pointscntgten\_coli + 1}
\DoxyCodeLine{5785         else}
\DoxyCodeLine{5786           tg = tg2}
\DoxyCodeLine{5787           tguv = tguv2        }
\DoxyCodeLine{5788           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tgerr))  tgerr = max(tgerr\_aux2,tgdiff*norm)    }
\DoxyCodeLine{5789           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5790             tgacc(r) = max(tgerr\_aux2(r)/norm(r),tgdiff(r))}
\DoxyCodeLine{5791 \textcolor{keywordflow}{          end do}         }
\DoxyCodeLine{5792           \textcolor{keywordflow}{if} (monitoring) pointscntgten\_dd =  pointscntgten\_dd + 1}
\DoxyCodeLine{5793         \textcolor{keyword}{end }if}
\DoxyCodeLine{5794         }
\DoxyCodeLine{5795       \textcolor{keywordflow}{else}  }
\DoxyCodeLine{5796         \textcolor{keyword}{call }calctensortnr\_list(tg,tguv,tgerr\_aux,momvec,mominv,masses2,7,rmax)}
\DoxyCodeLine{5797         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tgerr)) tgerr = tgerr\_aux}
\DoxyCodeLine{5798         norm = 0d0}
\DoxyCodeLine{5799         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5800           \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{5801             norm(r) = max(norm(r),abs(tg(i)))}
\DoxyCodeLine{5802 \textcolor{keywordflow}{          end do}      }
\DoxyCodeLine{5803           \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{5804             norm(r) = max(maxval(abs(mominv(1:21))),maxval(abs(masses2(0:6))))}
\DoxyCodeLine{5805             \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{5806               norm(r)=1d0/norm(r)**(5-\/real(r)/2)}
\DoxyCodeLine{5807             else}
\DoxyCodeLine{5808               norm(r)=1d0/muir2\_cll**(5-\/real(r)/2)}
\DoxyCodeLine{5809             \textcolor{keyword}{end }if}
\DoxyCodeLine{5810           \textcolor{keyword}{end }if}
\DoxyCodeLine{5811           tgacc(r) = tgerr\_aux(r)/norm(r)}
\DoxyCodeLine{5812 \textcolor{keywordflow}{        end do}             }
\DoxyCodeLine{5813         }
\DoxyCodeLine{5814 \textcolor{keywordflow}{      end if}      }
\DoxyCodeLine{5815       }
\DoxyCodeLine{5816     else}
\DoxyCodeLine{5817       \textcolor{keyword}{call }g\_main\_cll(cg,cguv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6), \&}
\DoxyCodeLine{5818                       mominv(7),mominv(8),mominv(9),mominv(10),mominv(11),mominv(12), \&}
\DoxyCodeLine{5819                       mominv(13),mominv(14),mominv(15),mominv(16),mominv(17),mominv(18), \&}
\DoxyCodeLine{5820                       mominv(19),mominv(20),mominv(21),masses2(0),masses2(1),masses2(2), \&}
\DoxyCodeLine{5821                       masses2(3),masses2(4),masses2(5),masses2(6),rmax,gerr2=cgerr,id\_in=0)}
\DoxyCodeLine{5822       \textcolor{keyword}{call }calctensorg\_list(tg,tguv,tgerr\_aux,cg,cguv,cgerr,momvec,rmax)}
\DoxyCodeLine{5823       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tgerr)) tgerr = tgerr\_aux}
\DoxyCodeLine{5824       norm = 0d0}
\DoxyCodeLine{5825       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5826         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{5827           norm(r) = max(norm(r),abs(tg(i)))}
\DoxyCodeLine{5828 \textcolor{keywordflow}{        end do}       }
\DoxyCodeLine{5829         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{5830           norm(r) = max(maxval(abs(mominv(1:21))),maxval(abs(masses2(0:6))))}
\DoxyCodeLine{5831           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{5832             norm(r)=1d0/norm(r)**(5-\/real(r)/2)}
\DoxyCodeLine{5833           else}
\DoxyCodeLine{5834             norm(r)=1d0/muir2\_cll**(5-\/real(r)/2)}
\DoxyCodeLine{5835           \textcolor{keyword}{end }if}
\DoxyCodeLine{5836         \textcolor{keyword}{end }if}
\DoxyCodeLine{5837         tgacc(r) = tgerr\_aux(r)/norm(r)}
\DoxyCodeLine{5838 \textcolor{keywordflow}{      end do}      }
\DoxyCodeLine{5839     \textcolor{keyword}{end }if}
\DoxyCodeLine{5840 }
\DoxyCodeLine{5841     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{5842       pointscntgten\_cll =  pointscntgten\_cll + 1}
\DoxyCodeLine{5843 }
\DoxyCodeLine{5844       \textcolor{keywordflow}{if}(maxval(tgacc).gt.reqacc\_cll) accpointscntgten\_cll = accpointscntgten\_cll + 1}
\DoxyCodeLine{5845 }
\DoxyCodeLine{5846       \textcolor{keywordflow}{if}(maxval(tgacc).gt.critacc\_cll) then}
\DoxyCodeLine{5847         critpointscntgten\_cll =  critpointscntgten\_cll + 1}
\DoxyCodeLine{5848         \textcolor{keywordflow}{if} ( critpointscntgten\_cll.le.noutcritpointsmax\_cll(7) ) then}
\DoxyCodeLine{5849           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TGten\_cll'},0,maxval(tgacc),critpointscntgten\_cll)}
\DoxyCodeLine{5850           \textcolor{keywordflow}{if}( critpointscntgten\_cll.eq.noutcritpointsmax\_cll(7)) then}
\DoxyCodeLine{5851             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TGten\_cll suppressed'}   }
\DoxyCodeLine{5852             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{5853           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{5854 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{5855 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TGten\_cll'},0,maxval(tgacc),critpointscntgten\_cll)}
\DoxyCodeLine{5856           \textcolor{keywordflow}{if}( critpointscntgten\_cll.eq.noutcritpointsmax\_cll(7)) then}
\DoxyCodeLine{5857             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TGten\_cll suppressed'}   }
\DoxyCodeLine{5858             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{5859           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{5860 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5861 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{5862       \textcolor{keyword}{end }if}
\DoxyCodeLine{5863     \textcolor{keyword}{end }if}
\DoxyCodeLine{5864 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a39ca7e37ea7dc038c303010f2fac582f}\label{namespacecollier__tensors_a39ca7e37ea7dc038c303010f2fac582f}} 
\index{collier\_tensors@{collier\_tensors}!gten\_args\_list\_cll@{gten\_args\_list\_cll}}
\index{gten\_args\_list\_cll@{gten\_args\_list\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{gten\_args\_list\_cll()}{gten\_args\_list\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::gten\+\_\+args\+\_\+list\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TG,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Guv,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p1vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p2vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p3vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p4vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p5vec,  }\item[{double complex, dimension(0\+:3), intent(in)}]{p6vec,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p43,  }\item[{double complex, intent(in)}]{p54,  }\item[{double complex, intent(in)}]{p65,  }\item[{double complex, intent(in)}]{p60,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{p42,  }\item[{double complex, intent(in)}]{p53,  }\item[{double complex, intent(in)}]{p64,  }\item[{double complex, intent(in)}]{p50,  }\item[{double complex, intent(in)}]{p61,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p41,  }\item[{double complex, intent(in)}]{p52,  }\item[{double complex, intent(in)}]{p63,  }\item[{double complex, intent(in)}]{p40,  }\item[{double complex, intent(in)}]{p51,  }\item[{double complex, intent(in)}]{p62,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{double complex, intent(in)}]{m42,  }\item[{double complex, intent(in)}]{m52,  }\item[{double complex, intent(in)}]{m62,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Gerr }\end{DoxyParamCaption})}



Definition at line 5616 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5616     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{5617     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p1vec(0:3),p2vec(0:3),p3vec(0:3),p4vec(0:3)}
\DoxyCodeLine{5618     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p5vec(0:3),p6vec(0:3)}
\DoxyCodeLine{5619     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p43,p54,p65,p60,p20,p31,p42,p53}
\DoxyCodeLine{5620     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p64,p50,p61,p30,p41,p52,p63,p40,p51,p62}
\DoxyCodeLine{5621     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: m02,m12,m22,m32,m42,m52,m62}
\DoxyCodeLine{5622     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TG(RtS(rmax)), TGuv(RtS(rmax))}
\DoxyCodeLine{5623     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TGerr(0:rmax)}
\DoxyCodeLine{5624     \textcolor{keywordtype}{double complex} :: TG2(RtS(rmax)), TGuv2(RtS(rmax))}
\DoxyCodeLine{5625     \textcolor{keywordtype}{double precision} :: TGerr\_aux(0:rmax), TGerr\_aux2(0:rmax)   }
\DoxyCodeLine{5626     \textcolor{keywordtype}{double complex} :: MomVec(0:3,6), MomInv(21), masses2(0:6)}
\DoxyCodeLine{5627     \textcolor{keywordtype}{double complex} :: CG(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5628     \textcolor{keywordtype}{double complex} :: CGuv(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5629     \textcolor{keywordtype}{double precision} :: CGerr(0:rmax), TGacc(0:rmax)}
\DoxyCodeLine{5630     \textcolor{keywordtype}{double precision} :: norm(0:rmax), TGdiff(0:rmax), norm\_coli, norm\_dd}
\DoxyCodeLine{5631     \textcolor{keywordtype}{double complex} :: args(52)}
\DoxyCodeLine{5632     \textcolor{keywordtype}{integer} :: r,i}
\DoxyCodeLine{5633     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{5634 }
\DoxyCodeLine{5635     \textcolor{keywordflow}{if} (7.gt.nmax\_cll) then}
\DoxyCodeLine{5636       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{5637       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Gten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 7'},eflag,.true.)}
\DoxyCodeLine{5638       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{5639       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 7'}}
\DoxyCodeLine{5640       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{5641       return}
\DoxyCodeLine{5642 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{5643     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{5644       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{5645       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Gten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{5646       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{5647       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{5648       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{5649       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{5650       return}
\DoxyCodeLine{5651 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{5652 }
\DoxyCodeLine{5653     \textcolor{keyword}{call }gten\_args\_list\_checked\_cll(tg,tguv,p1vec,p2vec,p3vec,p4vec,p5vec,p6vec,  \&}
\DoxyCodeLine{5654                            p10,p21,p32,p43,p54,p65,p60,p20,p31,p42,p53,  \&}
\DoxyCodeLine{5655                            p64,p50,p61,p30,p41,p52,p63,p40,p51,p62,  \&}
\DoxyCodeLine{5656                            m02,m12,m22,m32,m42,m52,m62,rmax,tgerr)}
\DoxyCodeLine{5657 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_ae1bf216de04e5649889b8a7a3fbc315b}\label{namespacecollier__tensors_ae1bf216de04e5649889b8a7a3fbc315b}} 
\index{collier\_tensors@{collier\_tensors}!gten\_list\_checked\_cll@{gten\_list\_checked\_cll}}
\index{gten\_list\_checked\_cll@{gten\_list\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{gten\_list\_checked\_cll()}{gten\_list\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::gten\+\_\+list\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TG,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Guv,  }\item[{double complex, dimension(0\+:3,6), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(21), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:6), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Gerr }\end{DoxyParamCaption})}



Definition at line 5199 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5199 }
\DoxyCodeLine{5200     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{5201     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,6), MomInv(21), masses2(0:6)}
\DoxyCodeLine{5202     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TG(RtS(rmax)),TGuv(RtS(rmax))}
\DoxyCodeLine{5203     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TGerr(0:rmax)}
\DoxyCodeLine{5204     \textcolor{keywordtype}{double complex} :: TG2(RtS(rmax)),TGuv2(RtS(rmax))}
\DoxyCodeLine{5205     \textcolor{keywordtype}{double precision} :: TGerr\_aux(0:rmax),TGerr\_aux2(0:rmax) }
\DoxyCodeLine{5206     \textcolor{keywordtype}{double complex} :: CG(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5207     \textcolor{keywordtype}{double complex} :: CGuv(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5208     \textcolor{keywordtype}{double precision} :: CGerr(0:rmax), TGacc(0:rmax)}
\DoxyCodeLine{5209     \textcolor{keywordtype}{double precision} :: norm(0:rmax),norm\_coli,norm\_dd, TGdiff(0:rmax)}
\DoxyCodeLine{5210     \textcolor{keywordtype}{double complex} :: args(52)}
\DoxyCodeLine{5211     \textcolor{keywordtype}{integer} :: r,i}
\DoxyCodeLine{5212     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{5213 }
\DoxyCodeLine{5214     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{5215     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{5216     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{5217     args(9:12) = momvec(0:,3)}
\DoxyCodeLine{5218     args(13:16) = momvec(0:,4)}
\DoxyCodeLine{5219     args(17:20) = momvec(0:,5)}
\DoxyCodeLine{5220     args(21:24) = momvec(0:,6)}
\DoxyCodeLine{5221     args(25:45) = mominv}
\DoxyCodeLine{5222     args(46:52) = masses2}
\DoxyCodeLine{5223     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Gten\_cll'})}
\DoxyCodeLine{5224     \textcolor{keyword}{call }setmastern\_cll(7)}
\DoxyCodeLine{5225     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{5226     \textcolor{keyword}{call }setmasterargs\_cll(52,args)}
\DoxyCodeLine{5227 }
\DoxyCodeLine{5228     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{5229 }
\DoxyCodeLine{5230 }
\DoxyCodeLine{5231     \textcolor{keywordflow}{if} (tenred\_cll.le.7) then}
\DoxyCodeLine{5232     }
\DoxyCodeLine{5233       \textcolor{keywordflow}{if} (mode\_cll.gt.1) \textcolor{keyword}{call }tn\_dd\_dummy(7,rmax)  }
\DoxyCodeLine{5234       }
\DoxyCodeLine{5235       \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{5236         \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{5237         mode\_cll = 1}
\DoxyCodeLine{5238         \textcolor{keyword}{call }calctensortnr\_list(tg,tguv,tgerr\_aux,momvec,mominv,masses2,7,rmax)        }
\DoxyCodeLine{5239       }
\DoxyCodeLine{5240         \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{5241         mode\_cll = 2}
\DoxyCodeLine{5242         \textcolor{keyword}{call }calctensortnr\_list(tg2,tguv2,tgerr\_aux2,momvec,mominv,masses2,7,rmax)         }
\DoxyCodeLine{5243       }
\DoxyCodeLine{5244         \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{5245         mode\_cll = 3}
\DoxyCodeLine{5246         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5247           norm\_coli=0d0}
\DoxyCodeLine{5248           norm\_dd=0d0}
\DoxyCodeLine{5249           \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)          }
\DoxyCodeLine{5250             norm\_coli = max(norm\_coli,abs(tg(i)))}
\DoxyCodeLine{5251             norm\_dd = max(norm\_dd,abs(tg2(i)))}
\DoxyCodeLine{5252           \textcolor{keyword}{end }do}
\DoxyCodeLine{5253           \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{5254             norm\_coli = max(maxval(abs(mominv(1:21))),maxval(abs(masses2(0:6))))}
\DoxyCodeLine{5255             \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{5256               norm\_coli=1d0/norm\_coli**(5-\/real(r)/2)}
\DoxyCodeLine{5257             else}
\DoxyCodeLine{5258               norm\_coli=1d0/muir2\_cll**(5-\/real(r)/2)}
\DoxyCodeLine{5259             \textcolor{keyword}{end }if}
\DoxyCodeLine{5260           \textcolor{keyword}{end }if}
\DoxyCodeLine{5261           \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{5262             norm\_dd = max(maxval(abs(mominv(1:21))),maxval(abs(masses2(0:6))))}
\DoxyCodeLine{5263             \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{5264               norm\_dd=1d0/norm\_dd**(5-\/real(r)/2)}
\DoxyCodeLine{5265             else}
\DoxyCodeLine{5266               norm\_dd=1d0/muir2\_cll**(5-\/real(r)/2)}
\DoxyCodeLine{5267             \textcolor{keyword}{end }if}
\DoxyCodeLine{5268           \textcolor{keyword}{end }if}
\DoxyCodeLine{5269           norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{5270         \textcolor{keyword}{end }do}
\DoxyCodeLine{5271       }
\DoxyCodeLine{5272         \textcolor{keyword}{call }checktensorslist\_cll(tg,tg2,momvec,mominv,masses2,norm,7,rmax,tgdiff)        }
\DoxyCodeLine{5273        }
\DoxyCodeLine{5274         \textcolor{keywordflow}{if} (tgerr\_aux(rmax).lt.tgerr\_aux2(rmax)) then}
\DoxyCodeLine{5275           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tgerr))  tgerr = max(tgerr\_aux,tgdiff*norm)}
\DoxyCodeLine{5276           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5277             tgacc(r) = max(tgerr\_aux(r)/norm(r),tgdiff(r))}
\DoxyCodeLine{5278           \textcolor{keyword}{end }do}
\DoxyCodeLine{5279           \textcolor{keywordflow}{if} (monitoring) pointscntgten\_coli =  pointscntgten\_coli + 1}
\DoxyCodeLine{5280         else}
\DoxyCodeLine{5281           tg = tg2}
\DoxyCodeLine{5282           tguv = tguv2        }
\DoxyCodeLine{5283           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tgerr))  tgerr = max(tgerr\_aux2,tgdiff*norm)    }
\DoxyCodeLine{5284           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5285             tgacc(r) = max(tgerr\_aux2(r)/norm(r),tgdiff(r))}
\DoxyCodeLine{5286 \textcolor{keywordflow}{          end do}         }
\DoxyCodeLine{5287           \textcolor{keywordflow}{if} (monitoring) pointscntgten\_dd =  pointscntgten\_dd + 1}
\DoxyCodeLine{5288         \textcolor{keyword}{end }if}
\DoxyCodeLine{5289         }
\DoxyCodeLine{5290       \textcolor{keywordflow}{else}  }
\DoxyCodeLine{5291         \textcolor{keyword}{call }calctensortnr\_list(tg,tguv,tgerr\_aux,momvec,mominv,masses2,7,rmax)}
\DoxyCodeLine{5292         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tgerr)) tgerr = tgerr\_aux}
\DoxyCodeLine{5293         norm = 0d0}
\DoxyCodeLine{5294         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5295           \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{5296             norm(r) = max(norm(r),abs(tg(i)))}
\DoxyCodeLine{5297 \textcolor{keywordflow}{          end do}      }
\DoxyCodeLine{5298           \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{5299             norm(r) = max(maxval(abs(mominv(1:21))),maxval(abs(masses2(0:6))))}
\DoxyCodeLine{5300             \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{5301               norm(r)=1d0/norm(r)**(5-\/real(r)/2)}
\DoxyCodeLine{5302             else}
\DoxyCodeLine{5303               norm(r)=1d0/muir2\_cll**(5-\/real(r)/2)}
\DoxyCodeLine{5304             \textcolor{keyword}{end }if}
\DoxyCodeLine{5305           \textcolor{keyword}{end }if}
\DoxyCodeLine{5306           tgacc(r) = tgerr\_aux(r)/norm(r)}
\DoxyCodeLine{5307 \textcolor{keywordflow}{        end do}             }
\DoxyCodeLine{5308         }
\DoxyCodeLine{5309 \textcolor{keywordflow}{      end if}      }
\DoxyCodeLine{5310             }
\DoxyCodeLine{5311     else}
\DoxyCodeLine{5312       \textcolor{keyword}{call }g\_main\_cll(cg,cguv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6), \&}
\DoxyCodeLine{5313                       mominv(7),mominv(8),mominv(9),mominv(10),mominv(11),mominv(12), \&}
\DoxyCodeLine{5314                       mominv(13),mominv(14),mominv(15),mominv(16),mominv(17),mominv(18), \&}
\DoxyCodeLine{5315                       mominv(19),mominv(20),mominv(21),masses2(0),masses2(1),masses2(2), \&}
\DoxyCodeLine{5316                       masses2(3),masses2(4),masses2(5),masses2(6),rmax,gerr2=cgerr,id\_in=0)}
\DoxyCodeLine{5317       \textcolor{keyword}{call }calctensorg\_list(tg,tguv,tgerr\_aux,cg,cguv,cgerr,momvec,rmax)}
\DoxyCodeLine{5318       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tgerr)) tgerr = tgerr\_aux}
\DoxyCodeLine{5319       norm = 0d0}
\DoxyCodeLine{5320       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5321         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{5322           norm(r) = max(norm(r),abs(tg(i)))}
\DoxyCodeLine{5323 \textcolor{keywordflow}{        end do}      }
\DoxyCodeLine{5324         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{5325           norm(r) = max(maxval(abs(mominv(1:21))),maxval(abs(masses2(0:6))))}
\DoxyCodeLine{5326           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{5327             norm(r)=1d0/norm(r)**(5-\/real(r)/2)}
\DoxyCodeLine{5328           else}
\DoxyCodeLine{5329             norm(r)=1d0/muir2\_cll**(5-\/real(r)/2)}
\DoxyCodeLine{5330           \textcolor{keyword}{end }if}
\DoxyCodeLine{5331         \textcolor{keyword}{end }if}
\DoxyCodeLine{5332         tgacc(r) = tgerr\_aux(r)/norm(r)}
\DoxyCodeLine{5333 \textcolor{keywordflow}{      end do}      }
\DoxyCodeLine{5334     \textcolor{keyword}{end }if}
\DoxyCodeLine{5335 }
\DoxyCodeLine{5336     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{5337       pointscntgten\_cll =  pointscntgten\_cll + 1}
\DoxyCodeLine{5338 }
\DoxyCodeLine{5339       \textcolor{keywordflow}{if}(maxval(tgacc).gt.reqacc\_cll) accpointscntgten\_cll = accpointscntgten\_cll + 1}
\DoxyCodeLine{5340 }
\DoxyCodeLine{5341       \textcolor{keywordflow}{if}(maxval(tgacc).gt.critacc\_cll) then}
\DoxyCodeLine{5342         critpointscntgten\_cll =  critpointscntgten\_cll + 1}
\DoxyCodeLine{5343         \textcolor{keywordflow}{if} ( critpointscntgten\_cll.le.noutcritpointsmax\_cll(7) ) then}
\DoxyCodeLine{5344           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TGten\_cll'},0,maxval(tgacc),critpointscntgten\_cll)}
\DoxyCodeLine{5345           \textcolor{keywordflow}{if}( critpointscntgten\_cll.eq.noutcritpointsmax\_cll(7)) then}
\DoxyCodeLine{5346             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TGten\_cll suppressed'}   }
\DoxyCodeLine{5347             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{5348           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{5349         \textcolor{keyword}{end }if}
\DoxyCodeLine{5350       \textcolor{keyword}{end }if}
\DoxyCodeLine{5351     \textcolor{keyword}{end }if}
\DoxyCodeLine{5352 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a121016ac6975fdf09bbec7d767e23037}\label{namespacecollier__tensors_a121016ac6975fdf09bbec7d767e23037}} 
\index{collier\_tensors@{collier\_tensors}!gten\_list\_cll@{gten\_list\_cll}}
\index{gten\_list\_cll@{gten\_list\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{gten\_list\_cll()}{gten\_list\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::gten\+\_\+list\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:), intent(out)}]{TG,  }\item[{double complex, dimension(\+:), intent(out)}]{T\+Guv,  }\item[{double complex, dimension(0\+:3,6), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(21), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:6), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Gerr }\end{DoxyParamCaption})}



Definition at line 5168 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5168 }
\DoxyCodeLine{5169     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{5170     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,6), MomInv(21), masses2(0:6)}
\DoxyCodeLine{5171     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TG(:),TGuv(:)}
\DoxyCodeLine{5172     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TGerr(0:rmax)}
\DoxyCodeLine{5173     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{5174 }
\DoxyCodeLine{5175     \textcolor{keywordflow}{if} (7.gt.nmax\_cll) then}
\DoxyCodeLine{5176       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{5177       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Gten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 7'},eflag,.true.)}
\DoxyCodeLine{5178       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{5179       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 7'}}
\DoxyCodeLine{5180       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{5181       return}
\DoxyCodeLine{5182 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{5183     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{5184       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{5185       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Gten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{5186       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{5187       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{5188       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{5189       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{5190       return}
\DoxyCodeLine{5191 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{5192 }
\DoxyCodeLine{5193     \textcolor{keyword}{call }gten\_list\_checked\_cll(tg,tguv,momvec,mominv,masses2,rmax,tgerr)}
\DoxyCodeLine{5194 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a35d3c1c32be2f39e18b3035b9efd31f2}\label{namespacecollier__tensors_a35d3c1c32be2f39e18b3035b9efd31f2}} 
\index{collier\_tensors@{collier\_tensors}!gten\_main\_cll@{gten\_main\_cll}}
\index{gten\_main\_cll@{gten\_main\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{gten\_main\_cll()}{gten\_main\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::gten\+\_\+main\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TG,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Guv,  }\item[{double complex, dimension(0\+:3,6), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(21), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:6), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Gerr }\end{DoxyParamCaption})}



Definition at line 4945 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{4945 }
\DoxyCodeLine{4946     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax}
\DoxyCodeLine{4947     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,6), MomInv(21), masses2(0:6)}
\DoxyCodeLine{4948     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TG(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4949     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TGuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4950     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TGerr(0:rmax)}
\DoxyCodeLine{4951     \textcolor{keywordtype}{double precision} :: TGerr\_aux(0:rmax), TGerr\_aux2(0:rmax)   }
\DoxyCodeLine{4952     \textcolor{keywordtype}{double complex} :: TG2(0:rmax,0:rmax,0:rmax,0:rmax), TGuv2(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4953     \textcolor{keywordtype}{double complex} :: CG(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4954     \textcolor{keywordtype}{double complex} :: CGuv(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4955     \textcolor{keywordtype}{double precision} :: CGerr(0:rmax), TGacc(0:rmax)}
\DoxyCodeLine{4956     \textcolor{keywordtype}{double precision} :: norm(0:rmax),norm\_coli,norm\_dd, TGdiff(0:rmax)}
\DoxyCodeLine{4957     \textcolor{keywordtype}{double complex} :: args(52)}
\DoxyCodeLine{4958     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3}
\DoxyCodeLine{4959     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{4960 }
\DoxyCodeLine{4961     \textcolor{keywordflow}{if} (7.gt.nmax\_cll) then}
\DoxyCodeLine{4962       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{4963       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Gten\_cll'},\textcolor{stringliteral}{'Nmax\_cll smaller 7'},eflag,.true.)}
\DoxyCodeLine{4964       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{4965       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= 7'}}
\DoxyCodeLine{4966       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{4967       return}
\DoxyCodeLine{4968 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{4969     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{4970       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{4971       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'Gten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{4972       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{4973       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{4974       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{4975       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{4976       return}
\DoxyCodeLine{4977 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{4978 }
\DoxyCodeLine{4979     \textcolor{comment}{! set ID of master call}}
\DoxyCodeLine{4980     args(1:4) = momvec(0:,1)}
\DoxyCodeLine{4981     args(5:8) = momvec(0:,2)}
\DoxyCodeLine{4982     args(9:12) = momvec(0:,3)}
\DoxyCodeLine{4983     args(13:16) = momvec(0:,4)}
\DoxyCodeLine{4984     args(17:20) = momvec(0:,5)}
\DoxyCodeLine{4985     args(21:24) = momvec(0:,6)}
\DoxyCodeLine{4986     args(25:45) = mominv}
\DoxyCodeLine{4987     args(46:52) = masses2}
\DoxyCodeLine{4988     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'Gten\_cll'})}
\DoxyCodeLine{4989     \textcolor{keyword}{call }setmastern\_cll(7)}
\DoxyCodeLine{4990     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{4991     \textcolor{keyword}{call }setmasterargs\_cll(52,args)}
\DoxyCodeLine{4992 }
\DoxyCodeLine{4993     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{4994 }
\DoxyCodeLine{4995     \textcolor{keywordflow}{if} (tenred\_cll.le.7) then}
\DoxyCodeLine{4996     }
\DoxyCodeLine{4997       \textcolor{keywordflow}{if} (mode\_cll.gt.1) \textcolor{keyword}{call }tn\_dd\_dummy(7,rmax)  }
\DoxyCodeLine{4998       }
\DoxyCodeLine{4999       \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{5000         \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{5001         mode\_cll = 1}
\DoxyCodeLine{5002         \textcolor{keyword}{call }calctensortnr(tg,tguv,tgerr\_aux,momvec,mominv,masses2,7,rmax,0)        }
\DoxyCodeLine{5003       }
\DoxyCodeLine{5004         \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{5005         mode\_cll = 2}
\DoxyCodeLine{5006         \textcolor{keyword}{call }calctensortnr(tg2,tguv2,tgerr\_aux2,momvec,mominv,masses2,7,rmax,0)         }
\DoxyCodeLine{5007       }
\DoxyCodeLine{5008         \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{5009         mode\_cll = 3}
\DoxyCodeLine{5010         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5011           norm\_coli=0d0}
\DoxyCodeLine{5012           norm\_dd=0d0}
\DoxyCodeLine{5013           \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{5014             \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{5015               \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{5016                 n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{5017                 norm\_coli = max(norm\_coli,abs(tg(n0,n1,n2,n3)))}
\DoxyCodeLine{5018                 norm\_dd = max(norm\_dd,abs(tg2(n0,n1,n2,n3)))}
\DoxyCodeLine{5019               \textcolor{keyword}{end }do}
\DoxyCodeLine{5020             \textcolor{keyword}{end }do}
\DoxyCodeLine{5021           \textcolor{keyword}{end }do}
\DoxyCodeLine{5022           \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{5023             norm\_coli = max(maxval(abs(mominv(1:21))),maxval(abs(masses2(0:6))))}
\DoxyCodeLine{5024             \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{5025               norm\_coli=1d0/norm\_coli**(5-\/real(r)/2)}
\DoxyCodeLine{5026             else}
\DoxyCodeLine{5027               norm\_coli=1d0/muir2\_cll**(5-\/real(r)/2)}
\DoxyCodeLine{5028             \textcolor{keyword}{end }if}
\DoxyCodeLine{5029           \textcolor{keyword}{end }if}
\DoxyCodeLine{5030           \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{5031             norm\_dd = max(maxval(abs(mominv(1:21))),maxval(abs(masses2(0:6))))}
\DoxyCodeLine{5032             \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{5033               norm\_dd=1d0/norm\_dd**(5-\/real(r)/2)}
\DoxyCodeLine{5034             else}
\DoxyCodeLine{5035               norm\_dd=1d0/muir2\_cll**(5-\/real(r)/2)}
\DoxyCodeLine{5036             \textcolor{keyword}{end }if}
\DoxyCodeLine{5037           \textcolor{keyword}{end }if}
\DoxyCodeLine{5038           norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{5039         \textcolor{keyword}{end }do}
\DoxyCodeLine{5040       }
\DoxyCodeLine{5041         \textcolor{keyword}{call }checktensors\_cll(tg,tg2,momvec,mominv,masses2,norm,7,rmax,tgdiff)        }
\DoxyCodeLine{5042        }
\DoxyCodeLine{5043         \textcolor{keywordflow}{if} (tgerr\_aux(rmax).lt.tgerr\_aux2(rmax)) then}
\DoxyCodeLine{5044           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tgerr))  tgerr = max(tgerr\_aux,tgdiff*norm)}
\DoxyCodeLine{5045           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5046             tgacc(r) = max(tgerr\_aux(r)/norm(r),tgdiff(r))}
\DoxyCodeLine{5047           \textcolor{keyword}{end }do}
\DoxyCodeLine{5048           \textcolor{keywordflow}{if} (monitoring) pointscntgten\_coli =  pointscntgten\_coli + 1}
\DoxyCodeLine{5049         else}
\DoxyCodeLine{5050           tg = tg2}
\DoxyCodeLine{5051           tguv = tguv2        }
\DoxyCodeLine{5052           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tgerr))  tgerr = max(tgerr\_aux2,tgdiff*norm)    }
\DoxyCodeLine{5053           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5054             tgacc(r) = max(tgerr\_aux2(r)/norm(r),tgdiff(r))}
\DoxyCodeLine{5055 \textcolor{keywordflow}{          end do}         }
\DoxyCodeLine{5056           \textcolor{keywordflow}{if} (monitoring) pointscntgten\_dd =  pointscntgten\_dd + 1}
\DoxyCodeLine{5057         \textcolor{keyword}{end }if}
\DoxyCodeLine{5058         }
\DoxyCodeLine{5059       \textcolor{keywordflow}{else}    }
\DoxyCodeLine{5060         \textcolor{keyword}{call }calctensortnr(tg,tguv,tgerr\_aux,momvec,mominv,masses2,7,rmax,0)        }
\DoxyCodeLine{5061         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tgerr)) tgerr = tgerr\_aux}
\DoxyCodeLine{5062         norm = 0d0}
\DoxyCodeLine{5063         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5064           \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{5065             \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{5066               \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{5067                 n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{5068                 norm(r) = max(norm(r),abs(tg(n0,n1,n2,n3)))}
\DoxyCodeLine{5069               \textcolor{keyword}{end }do}
\DoxyCodeLine{5070             \textcolor{keyword}{end }do}
\DoxyCodeLine{5071           \textcolor{keyword}{end }do}
\DoxyCodeLine{5072           \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{5073             norm(r) = max(maxval(abs(mominv(1:21))),maxval(abs(masses2(0:6))))}
\DoxyCodeLine{5074             \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{5075               norm(r)=1d0/norm(r)**(5-\/real(r)/2)}
\DoxyCodeLine{5076             else}
\DoxyCodeLine{5077               norm(r)=1d0/muir2\_cll**(5-\/real(r)/2)}
\DoxyCodeLine{5078             \textcolor{keyword}{end }if}
\DoxyCodeLine{5079           \textcolor{keyword}{end }if}
\DoxyCodeLine{5080           tgacc(r) = tgerr\_aux(r)/norm(r)}
\DoxyCodeLine{5081 \textcolor{keywordflow}{        end do}        }
\DoxyCodeLine{5082         }
\DoxyCodeLine{5083 \textcolor{keywordflow}{      end if}      }
\DoxyCodeLine{5084      }
\DoxyCodeLine{5085     else}
\DoxyCodeLine{5086       \textcolor{keyword}{call }g\_main\_cll(cg,cguv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6), \&}
\DoxyCodeLine{5087                       mominv(7),mominv(8),mominv(9),mominv(10),mominv(11),mominv(12), \&}
\DoxyCodeLine{5088                       mominv(13),mominv(14),mominv(15),mominv(16),mominv(17),mominv(18), \&}
\DoxyCodeLine{5089                       mominv(19),mominv(20),mominv(21),masses2(0),masses2(1),masses2(2), \&}
\DoxyCodeLine{5090                       masses2(3),masses2(4),masses2(5),masses2(6),rmax,gerr2=cgerr,id\_in=0)}
\DoxyCodeLine{5091       \textcolor{keyword}{call }calctensorg(tg,tguv,tgerr\_aux,cg,cguv,cgerr,momvec,rmax)}
\DoxyCodeLine{5092       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tgerr)) tgerr = tgerr\_aux}
\DoxyCodeLine{5093       norm = 0d0}
\DoxyCodeLine{5094       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5095         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{5096           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{5097             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{5098               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{5099               norm(r) = max(norm(r),abs(tg(n0,n1,n2,n3)))}
\DoxyCodeLine{5100             \textcolor{keyword}{end }do}
\DoxyCodeLine{5101           \textcolor{keyword}{end }do}
\DoxyCodeLine{5102 \textcolor{keywordflow}{        end do}      }
\DoxyCodeLine{5103         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{5104           norm(r) = max(maxval(abs(mominv(1:21))),maxval(abs(masses2(0:6))))}
\DoxyCodeLine{5105           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{5106             norm(r)=1d0/norm(r)**(5-\/real(r)/2)}
\DoxyCodeLine{5107           else}
\DoxyCodeLine{5108             norm(r)=1d0/muir2\_cll**(5-\/real(r)/2)}
\DoxyCodeLine{5109           \textcolor{keyword}{end }if}
\DoxyCodeLine{5110         \textcolor{keyword}{end }if}
\DoxyCodeLine{5111         tgacc(r) = tgerr\_aux(r)/norm(r)}
\DoxyCodeLine{5112 \textcolor{keywordflow}{      end do}      }
\DoxyCodeLine{5113 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{5114 }
\DoxyCodeLine{5115     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{5116       \textcolor{keywordflow}{if} (monitoring) pointscntgten\_cll =  pointscntgten\_cll + 1}
\DoxyCodeLine{5117 }
\DoxyCodeLine{5118       \textcolor{keywordflow}{if}(maxval(tgacc).gt.reqacc\_cll) accpointscntgten\_cll = accpointscntgten\_cll + 1}
\DoxyCodeLine{5119 }
\DoxyCodeLine{5120       \textcolor{keywordflow}{if}(maxval(tgacc).gt.critacc\_cll) then}
\DoxyCodeLine{5121         critpointscntgten\_cll =  critpointscntgten\_cll + 1}
\DoxyCodeLine{5122         \textcolor{keywordflow}{if} ( critpointscntgten\_cll.le.noutcritpointsmax\_cll(7) ) then}
\DoxyCodeLine{5123           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TGten\_cll'},0,maxval(tgacc),critpointscntgten\_cll)}
\DoxyCodeLine{5124           \textcolor{keywordflow}{if}( critpointscntgten\_cll.eq.noutcritpointsmax\_cll(7)) then}
\DoxyCodeLine{5125             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TGten\_cll suppressed'}   }
\DoxyCodeLine{5126             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{5127           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{5128         \textcolor{keyword}{end }if}
\DoxyCodeLine{5129       \textcolor{keyword}{end }if}
\DoxyCodeLine{5130     \textcolor{keyword}{end }if}
\DoxyCodeLine{5131 }
\DoxyCodeLine{5132     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{5133       pointscntgten\_cll =  pointscntgten\_cll + 1}
\DoxyCodeLine{5134 }
\DoxyCodeLine{5135       \textcolor{keywordflow}{if}(maxval(tgacc).gt.reqacc\_cll) accpointscntgten\_cll = accpointscntgten\_cll + 1}
\DoxyCodeLine{5136 }
\DoxyCodeLine{5137       \textcolor{keywordflow}{if}(maxval(tgacc).gt.critacc\_cll) then}
\DoxyCodeLine{5138         critpointscntgten\_cll =  critpointscntgten\_cll + 1}
\DoxyCodeLine{5139         \textcolor{keywordflow}{if} ( critpointscntgten\_cll.le.noutcritpointsmax\_cll(7) ) then}
\DoxyCodeLine{5140           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TGten\_cll'},0,maxval(tgacc),critpointscntgten\_cll)}
\DoxyCodeLine{5141           \textcolor{keywordflow}{if}( critpointscntgten\_cll.eq.noutcritpointsmax\_cll(7)) then}
\DoxyCodeLine{5142             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TGten\_cll suppressed'}   }
\DoxyCodeLine{5143             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{5144           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{5145 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{5146 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TGten\_cll'},0,maxval(tgacc),critpointscntgten\_cll)}
\DoxyCodeLine{5147           \textcolor{keywordflow}{if}( critpointscntgten\_cll.eq.noutcritpointsmax\_cll(7)) then}
\DoxyCodeLine{5148             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TGten\_cll suppressed'}   }
\DoxyCodeLine{5149             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{5150           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{5151 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5152 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{5153       \textcolor{keyword}{end }if}
\DoxyCodeLine{5154 \textcolor{keywordflow}{    end if}  }
\DoxyCodeLine{5155 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a2a5a0690343ab7b8150bdb307cd35317}\label{namespacecollier__tensors_a2a5a0690343ab7b8150bdb307cd35317}} 
\index{collier\_tensors@{collier\_tensors}!t1ten\_list\_checked\_cll@{t1ten\_list\_checked\_cll}}
\index{t1ten\_list\_checked\_cll@{t1ten\_list\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{t1ten\_list\_checked\_cll()}{t1ten\_list\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::t1ten\+\_\+list\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TA,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Auv,  }\item[{double complex, dimension(0\+:0), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{N,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Aerr }\end{DoxyParamCaption})}



Definition at line 6686 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{6686 }
\DoxyCodeLine{6687     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,N}
\DoxyCodeLine{6688     \textcolor{keywordtype}{double complex},\textcolor{keywordtype}{intent(in)} :: masses2(0:0)}
\DoxyCodeLine{6689     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TA(RtS(rmax)),TAuv(RtS(rmax))}
\DoxyCodeLine{6690     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TAerr(0:rmax)}
\DoxyCodeLine{6691     \textcolor{keywordtype}{double complex} :: TA2(RtS(rmax)),TAuv2(RtS(rmax))    }
\DoxyCodeLine{6692     \textcolor{keywordtype}{double complex} :: CA(0:rmax/2), CAuv(0:rmax/2)}
\DoxyCodeLine{6693     \textcolor{keywordtype}{double precision} :: CAerr(0:rmax), TAerr\_aux(0:rmax), TAerr\_aux2(0:rmax)}
\DoxyCodeLine{6694     \textcolor{keywordtype}{double complex} :: args(1)}
\DoxyCodeLine{6695     \textcolor{keywordtype}{double precision} :: TAdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TAacc(0:rmax)}
\DoxyCodeLine{6696     \textcolor{keywordtype}{integer} :: r,i}
\DoxyCodeLine{6697     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{6698 }
\DoxyCodeLine{6699     args(1) = masses2(0)}
\DoxyCodeLine{6700     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'TNten\_cll'})}
\DoxyCodeLine{6701     \textcolor{keyword}{call }setmastern\_cll(1)}
\DoxyCodeLine{6702     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{6703     \textcolor{keyword}{call }setmasterargs\_cll(1,args)}
\DoxyCodeLine{6704 }
\DoxyCodeLine{6705     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{6706     }
\DoxyCodeLine{6707     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{6708       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{6709       mode\_cll = 1}
\DoxyCodeLine{6710 \textcolor{comment}{!      call A\_cll(CA,CAuv,masses2(0),rmax,CAerr,0)}}
\DoxyCodeLine{6711       \textcolor{keyword}{call }tn\_cll(ca,cauv,masses2(0:0),1,rmax,caerr,0)}
\DoxyCodeLine{6712       \textcolor{keyword}{call }calctensora\_list(ta,tauv,taerr\_aux,ca,cauv,caerr,rmax)         }
\DoxyCodeLine{6713       }
\DoxyCodeLine{6714       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{6715       mode\_cll = 2}
\DoxyCodeLine{6716 \textcolor{comment}{!      call A\_cll(CA,CAuv,masses2(0),rmax,CAerr,0)}}
\DoxyCodeLine{6717       \textcolor{keyword}{call }tn\_cll(ca,cauv,masses2(0:0),1,rmax,caerr,0)}
\DoxyCodeLine{6718       \textcolor{keyword}{call }calctensora\_list(ta2,tauv2,taerr\_aux2,ca,cauv,caerr,rmax)}
\DoxyCodeLine{6719       }
\DoxyCodeLine{6720       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{6721       mode\_cll = 3}
\DoxyCodeLine{6722       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6723         norm\_coli=0d0}
\DoxyCodeLine{6724         norm\_dd=0d0}
\DoxyCodeLine{6725         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{6726           norm\_coli = max(norm\_coli,abs(ta(i)))}
\DoxyCodeLine{6727           norm\_dd = max(norm\_dd,abs(ta2(i)))}
\DoxyCodeLine{6728         \textcolor{keyword}{end }do}
\DoxyCodeLine{6729         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{6730           norm\_coli = abs(masses2(0))}
\DoxyCodeLine{6731           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{6732             norm\_coli=norm\_coli**(1+real(r)/2)}
\DoxyCodeLine{6733           else}
\DoxyCodeLine{6734             norm\_coli=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{6735           \textcolor{keyword}{end }if}
\DoxyCodeLine{6736         \textcolor{keyword}{end }if}
\DoxyCodeLine{6737         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{6738           norm\_dd = abs(masses2(0))}
\DoxyCodeLine{6739           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{6740             norm\_dd=norm\_dd**(1+real(r)/2)}
\DoxyCodeLine{6741           else}
\DoxyCodeLine{6742             norm\_dd=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{6743           \textcolor{keyword}{end }if}
\DoxyCodeLine{6744         \textcolor{keyword}{end }if}
\DoxyCodeLine{6745         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{6746       \textcolor{keyword}{end }do}
\DoxyCodeLine{6747       }
\DoxyCodeLine{6748       \textcolor{keyword}{call }checktenalist\_cll(ta,ta2,masses2,norm,rmax,tadiff)}
\DoxyCodeLine{6749       }
\DoxyCodeLine{6750       \textcolor{keywordflow}{if} (taerr\_aux(rmax).lt.taerr\_aux2(rmax)) then}
\DoxyCodeLine{6751         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr))  taerr = max(taerr\_aux,tadiff*norm)}
\DoxyCodeLine{6752         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6753           taacc(r) = max(taerr\_aux(r)/norm(r),tadiff(r))}
\DoxyCodeLine{6754         \textcolor{keyword}{end }do}
\DoxyCodeLine{6755         \textcolor{keywordflow}{if} (monitoring) pointscnttnten\_coli(1) =  pointscnttnten\_coli(1) + 1}
\DoxyCodeLine{6756       else}
\DoxyCodeLine{6757         ta = ta2}
\DoxyCodeLine{6758         tauv = tauv2        }
\DoxyCodeLine{6759         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr))  taerr = max(taerr\_aux2,tadiff*norm)    }
\DoxyCodeLine{6760         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6761           taacc(r) = max(taerr\_aux2(r)/norm(r),tadiff(r))}
\DoxyCodeLine{6762 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{6763         \textcolor{keywordflow}{if} (monitoring) pointscnttnten\_dd(1) =  pointscnttnten\_dd(1) + 1}
\DoxyCodeLine{6764 \textcolor{keywordflow}{      end if}       }
\DoxyCodeLine{6765     }
\DoxyCodeLine{6766     else}
\DoxyCodeLine{6767 \textcolor{comment}{!      call A\_cll(CA,CAuv,masses2(0),rmax,CAerr,0)    }}
\DoxyCodeLine{6768       \textcolor{keyword}{call }tn\_cll(ca,cauv,masses2(0:0),1,rmax,caerr,0)    }
\DoxyCodeLine{6769       \textcolor{keyword}{call }calctensora\_list(ta,tauv,taerr\_aux,ca,cauv,caerr,rmax)}
\DoxyCodeLine{6770       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr)) taerr = taerr\_aux}
\DoxyCodeLine{6771       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6772         norm(r)=0d0}
\DoxyCodeLine{6773         \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{6774           norm(r) = max(norm(r),abs(ta(i)))}
\DoxyCodeLine{6775         \textcolor{keyword}{end }do}
\DoxyCodeLine{6776         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{6777           norm(r) = abs(masses2(0))}
\DoxyCodeLine{6778           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{6779             norm(r)=norm(r)**(1+real(r)/2)}
\DoxyCodeLine{6780           else}
\DoxyCodeLine{6781             norm(r)=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{6782           \textcolor{keyword}{end }if}
\DoxyCodeLine{6783         \textcolor{keyword}{end }if}
\DoxyCodeLine{6784       \textcolor{keyword}{end }do}
\DoxyCodeLine{6785       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6786         taacc(r) = taerr\_aux(r)/norm(r)}
\DoxyCodeLine{6787 \textcolor{keywordflow}{      end do}      }
\DoxyCodeLine{6788       }
\DoxyCodeLine{6789     \textcolor{keyword}{end }if}
\DoxyCodeLine{6790 }
\DoxyCodeLine{6791     \textcolor{keyword}{call }propagateaccflag\_cll(taacc,rmax)}
\DoxyCodeLine{6792     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{6793 }
\DoxyCodeLine{6794     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{6795       pointscnttnten\_cll(1) =  pointscnttnten\_cll(1) + 1}
\DoxyCodeLine{6796 }
\DoxyCodeLine{6797       \textcolor{keywordflow}{if}(maxval(taacc).gt.reqacc\_cll) accpointscnttnten\_cll(1) = accpointscnttnten\_cll(1) + 1}
\DoxyCodeLine{6798 }
\DoxyCodeLine{6799       \textcolor{keywordflow}{if}(maxval(taacc).gt.critacc\_cll) then}
\DoxyCodeLine{6800         critpointscnttnten\_cll(1) =  critpointscnttnten\_cll(1) + 1}
\DoxyCodeLine{6801         \textcolor{keywordflow}{if} ( critpointscnttnten\_cll(1).le.noutcritpointsmax\_cll(1) ) then}
\DoxyCodeLine{6802           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TNten\_cll'},1,maxval(taacc),critpointscnttnten\_cll(1))}
\DoxyCodeLine{6803           \textcolor{keywordflow}{if}( critpointscnttnten\_cll(1).eq.noutcritpointsmax\_cll(1)) then}
\DoxyCodeLine{6804             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TNten\_cll suppressed for N ='},1   }
\DoxyCodeLine{6805             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{6806           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{6807 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{6808 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TNten\_cll'},1,maxval(taacc),critpointscnttnten\_cll(1))}
\DoxyCodeLine{6809           \textcolor{keywordflow}{if}( critpointscnttnten\_cll(1).eq.noutcritpointsmax\_cll(1)) then}
\DoxyCodeLine{6810             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TNten\_cll suppressed for N ='},1   }
\DoxyCodeLine{6811             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{6812           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{6813 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6814 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{6815       \textcolor{keyword}{end }if}
\DoxyCodeLine{6816     \textcolor{keyword}{end }if}
\DoxyCodeLine{6817 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a566f3d792ce105469c7e3b239d3732da}\label{namespacecollier__tensors_a566f3d792ce105469c7e3b239d3732da}} 
\index{collier\_tensors@{collier\_tensors}!t1ten\_list\_cll@{t1ten\_list\_cll}}
\index{t1ten\_list\_cll@{t1ten\_list\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{t1ten\_list\_cll()}{t1ten\_list\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::t1ten\+\_\+list\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:), intent(out)}]{TA,  }\item[{double complex, dimension(\+:), intent(out)}]{T\+Auv,  }\item[{double complex, dimension(0\+:0), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{N,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Aerr }\end{DoxyParamCaption})}



Definition at line 6649 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{6649 }
\DoxyCodeLine{6650     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,N}
\DoxyCodeLine{6651     \textcolor{keywordtype}{double complex},\textcolor{keywordtype}{intent(in)} :: masses2(0:0)}
\DoxyCodeLine{6652     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TA(:),TAuv(:)}
\DoxyCodeLine{6653     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TAerr(0:rmax)}
\DoxyCodeLine{6654     \textcolor{keywordtype}{integer} :: r,i}
\DoxyCodeLine{6655     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{6656 }
\DoxyCodeLine{6657     \textcolor{keywordflow}{if} (n.ne.1) then}
\DoxyCodeLine{6658       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{6659       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'TNten\_cll'},\textcolor{stringliteral}{'subroutine called with inconsistent arguments'},eflag)}
\DoxyCodeLine{6660     \textcolor{keyword}{end }if}
\DoxyCodeLine{6661     \textcolor{keywordflow}{if} (n.gt.nmax\_cll) then}
\DoxyCodeLine{6662       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{6663       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'TNten\_cll'},\textcolor{stringliteral}{'argument N larger than Nmax\_cll'},eflag,.true.)}
\DoxyCodeLine{6664       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'N        ='},n}
\DoxyCodeLine{6665       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{6666       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= '},n}
\DoxyCodeLine{6667       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{6668       return}
\DoxyCodeLine{6669 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{6670     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{6671       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{6672       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'TNten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{6673       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{6674       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{6675       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{6676       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{6677       return}
\DoxyCodeLine{6678 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{6679 }
\DoxyCodeLine{6680     \textcolor{keyword}{call }t1ten\_list\_checked\_cll(ta,tauv,masses2,n,rmax,taerr)}
\DoxyCodeLine{6681 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a2ea6b37a1666e6bd877302768d9342e2}\label{namespacecollier__tensors_a2ea6b37a1666e6bd877302768d9342e2}} 
\index{collier\_tensors@{collier\_tensors}!t1ten\_main\_cll@{t1ten\_main\_cll}}
\index{t1ten\_main\_cll@{t1ten\_main\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{t1ten\_main\_cll()}{t1ten\_main\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::t1ten\+\_\+main\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TA,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Auv,  }\item[{double complex, dimension(0\+:0), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{N,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Aerr }\end{DoxyParamCaption})}



Definition at line 6470 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{6470 }
\DoxyCodeLine{6471     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,N}
\DoxyCodeLine{6472     \textcolor{keywordtype}{double complex},\textcolor{keywordtype}{intent(in)} :: masses2(0:0)}
\DoxyCodeLine{6473     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TA(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{6474     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TAuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{6475     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TAerr(0:rmax)}
\DoxyCodeLine{6476     \textcolor{keywordtype}{double complex} :: TA2(0:rmax,0:rmax,0:rmax,0:rmax), TAuv2(0:rmax,0:rmax,0:rmax,0:rmax)    }
\DoxyCodeLine{6477     \textcolor{keywordtype}{double complex} :: CA(0:rmax/2), CAuv(0:rmax/2)}
\DoxyCodeLine{6478     \textcolor{keywordtype}{double precision} :: CAerr(0:rmax),TAerr\_aux(0:rmax),TAerr\_aux2(0:rmax)}
\DoxyCodeLine{6479     \textcolor{keywordtype}{double complex} :: args(1)    }
\DoxyCodeLine{6480     \textcolor{keywordtype}{double precision} :: TAdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TAacc(0:rmax)}
\DoxyCodeLine{6481     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3}
\DoxyCodeLine{6482     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{6483     }
\DoxyCodeLine{6484     \textcolor{keywordflow}{if} (n.ne.1) then}
\DoxyCodeLine{6485       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{6486       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'TNten\_cll'},\textcolor{stringliteral}{'subroutine called with inconsistent arguments'},eflag)}
\DoxyCodeLine{6487     \textcolor{keyword}{end }if}
\DoxyCodeLine{6488     \textcolor{keywordflow}{if} (n.gt.nmax\_cll) then}
\DoxyCodeLine{6489       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{6490       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'TNten\_cll'},\textcolor{stringliteral}{'argument N larger than Nmax\_cll'},eflag,.true.)}
\DoxyCodeLine{6491       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'N        ='},n}
\DoxyCodeLine{6492       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{6493       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= '},n}
\DoxyCodeLine{6494       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{6495       return}
\DoxyCodeLine{6496 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{6497     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{6498       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{6499       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'TNten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{6500       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{6501       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{6502       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{6503       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{6504       return}
\DoxyCodeLine{6505 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{6506 }
\DoxyCodeLine{6507     args(1) = masses2(0)}
\DoxyCodeLine{6508     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'TNten\_cll'})}
\DoxyCodeLine{6509     \textcolor{keyword}{call }setmastern\_cll(1)}
\DoxyCodeLine{6510     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{6511     \textcolor{keyword}{call }setmasterargs\_cll(1,args)}
\DoxyCodeLine{6512 }
\DoxyCodeLine{6513     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{6514     }
\DoxyCodeLine{6515     \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{6516       \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{6517       mode\_cll = 1}
\DoxyCodeLine{6518 \textcolor{comment}{!      call A\_cll(CA,CAuv,masses2(0),rmax,CAerr,0)}}
\DoxyCodeLine{6519       \textcolor{keyword}{call }tn\_cll(ca,cauv,masses2(0:0),1,rmax,caerr,0)}
\DoxyCodeLine{6520       \textcolor{keyword}{call }calctensora(ta,tauv,taerr\_aux,ca,cauv,caerr,rmax)         }
\DoxyCodeLine{6521       }
\DoxyCodeLine{6522       \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{6523       mode\_cll = 2}
\DoxyCodeLine{6524 \textcolor{comment}{!      call A\_cll(CA,CAuv,masses2(0),rmax,CAerr,0)}}
\DoxyCodeLine{6525       \textcolor{keyword}{call }tn\_cll(ca,cauv,masses2(0:0),1,rmax,caerr,0)}
\DoxyCodeLine{6526       \textcolor{keyword}{call }calctensora(ta2,tauv2,taerr\_aux2,ca,cauv,caerr,rmax)          }
\DoxyCodeLine{6527       }
\DoxyCodeLine{6528       \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{6529       mode\_cll = 3}
\DoxyCodeLine{6530       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6531         norm\_coli=0d0}
\DoxyCodeLine{6532         norm\_dd=0d0}
\DoxyCodeLine{6533         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{6534           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{6535             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{6536               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{6537               norm\_coli = max(norm\_coli,abs(ta(n0,n1,n2,n3)))}
\DoxyCodeLine{6538               norm\_dd = max(norm\_dd,abs(ta2(n0,n1,n2,n3)))}
\DoxyCodeLine{6539             \textcolor{keyword}{end }do}
\DoxyCodeLine{6540           \textcolor{keyword}{end }do}
\DoxyCodeLine{6541         \textcolor{keyword}{end }do}
\DoxyCodeLine{6542         \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{6543           norm\_coli = abs(masses2(0))}
\DoxyCodeLine{6544           \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{6545             norm\_coli=norm\_coli**(1+real(r)/2)}
\DoxyCodeLine{6546           else}
\DoxyCodeLine{6547             norm\_coli=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{6548           \textcolor{keyword}{end }if}
\DoxyCodeLine{6549         \textcolor{keyword}{end }if}
\DoxyCodeLine{6550         \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{6551           norm\_dd = abs(masses2(0))}
\DoxyCodeLine{6552           \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{6553             norm\_dd=norm\_dd**(1+real(r)/2)}
\DoxyCodeLine{6554           else}
\DoxyCodeLine{6555             norm\_dd=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{6556           \textcolor{keyword}{end }if}
\DoxyCodeLine{6557         \textcolor{keyword}{end }if}
\DoxyCodeLine{6558         norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{6559       \textcolor{keyword}{end }do}
\DoxyCodeLine{6560       }
\DoxyCodeLine{6561       \textcolor{keyword}{call }checktena\_cll(ta,ta2,masses2,norm,rmax,tadiff)}
\DoxyCodeLine{6562 \textcolor{comment}{!      call CheckTensors\_cll(TA,TA2,masses2,norm,1,rmax,TAdiff)}}
\DoxyCodeLine{6563       }
\DoxyCodeLine{6564       \textcolor{keywordflow}{if} (taerr\_aux(rmax).lt.taerr\_aux2(rmax)) then}
\DoxyCodeLine{6565         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr))  taerr = max(taerr\_aux,tadiff*norm)}
\DoxyCodeLine{6566         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6567           taacc(r) = max(taerr\_aux(r)/norm(r),tadiff(r))}
\DoxyCodeLine{6568         \textcolor{keyword}{end }do}
\DoxyCodeLine{6569         pointscnttnten\_coli(1) =  pointscnttnten\_coli(1) + 1}
\DoxyCodeLine{6570       else}
\DoxyCodeLine{6571         ta = ta2}
\DoxyCodeLine{6572         tauv = tauv2        }
\DoxyCodeLine{6573         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr))  taerr = max(taerr\_aux2,tadiff*norm)    }
\DoxyCodeLine{6574         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6575           taacc(r) = max(taerr\_aux2(r)/norm(r),tadiff(r))}
\DoxyCodeLine{6576 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{6577         pointscnttnten\_dd(1) =  pointscnttnten\_dd(1) + 1}
\DoxyCodeLine{6578 \textcolor{keywordflow}{      end if}       }
\DoxyCodeLine{6579     }
\DoxyCodeLine{6580     else}
\DoxyCodeLine{6581 \textcolor{comment}{!      call A\_cll(CA,CAuv,masses2(0),rmax,CAerr,0)}}
\DoxyCodeLine{6582       \textcolor{keyword}{call }tn\_cll(ca,cauv,masses2(0:0),1,rmax,caerr,0)}
\DoxyCodeLine{6583       \textcolor{keyword}{call }calctensora(ta,tauv,taerr\_aux,ca,cauv,caerr,rmax)}
\DoxyCodeLine{6584       \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(taerr)) taerr = taerr\_aux}
\DoxyCodeLine{6585       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6586         norm(r)=0d0}
\DoxyCodeLine{6587         \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{6588           \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{6589             \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{6590               n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{6591               norm(r) = max(norm(r),abs(ta(n0,n1,n2,n3)))}
\DoxyCodeLine{6592             \textcolor{keyword}{end }do}
\DoxyCodeLine{6593           \textcolor{keyword}{end }do}
\DoxyCodeLine{6594         \textcolor{keyword}{end }do}
\DoxyCodeLine{6595         \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{6596           norm(r) = abs(masses2(0))}
\DoxyCodeLine{6597           \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{6598             norm(r)=norm(r)**(1+real(r)/2)}
\DoxyCodeLine{6599           else}
\DoxyCodeLine{6600             norm(r)=muuv2\_cll**(1+real(r)/2)}
\DoxyCodeLine{6601           \textcolor{keyword}{end }if}
\DoxyCodeLine{6602         \textcolor{keyword}{end }if}
\DoxyCodeLine{6603       \textcolor{keyword}{end }do}
\DoxyCodeLine{6604       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6605         taacc(r) = taerr\_aux(r)/norm(r)}
\DoxyCodeLine{6606       \textcolor{keyword}{end }do}
\DoxyCodeLine{6607       }
\DoxyCodeLine{6608     \textcolor{keyword}{end }if}
\DoxyCodeLine{6609 }
\DoxyCodeLine{6610     \textcolor{keyword}{call }propagateaccflag\_cll(taacc,rmax)}
\DoxyCodeLine{6611     \textcolor{keyword}{call }propagateerrflag\_cll    }
\DoxyCodeLine{6612 }
\DoxyCodeLine{6613     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{6614       pointscnttnten\_cll(1) =  pointscnttnten\_cll(1) + 1}
\DoxyCodeLine{6615 }
\DoxyCodeLine{6616       \textcolor{keywordflow}{if}(maxval(taacc).gt.reqacc\_cll) accpointscnttnten\_cll(1) = accpointscnttnten\_cll(1) + 1}
\DoxyCodeLine{6617 }
\DoxyCodeLine{6618       \textcolor{keywordflow}{if}(maxval(taacc).gt.critacc\_cll) then}
\DoxyCodeLine{6619         critpointscnttnten\_cll(1) =  critpointscnttnten\_cll(1) + 1}
\DoxyCodeLine{6620         \textcolor{keywordflow}{if} ( critpointscnttnten\_cll(1).le.noutcritpointsmax\_cll(1) ) then}
\DoxyCodeLine{6621           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TNten\_cll'},1,maxval(taacc),critpointscnttnten\_cll(1))}
\DoxyCodeLine{6622           \textcolor{keywordflow}{if}( critpointscnttnten\_cll(1).eq.noutcritpointsmax\_cll(1)) then}
\DoxyCodeLine{6623             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TNten\_cll suppressed for N ='},1   }
\DoxyCodeLine{6624             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{6625           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{6626 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{6627 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TNten\_cll'},1,maxval(taacc),critpointscnttnten\_cll(1))}
\DoxyCodeLine{6628           \textcolor{keywordflow}{if}( critpointscnttnten\_cll(1).eq.noutcritpointsmax\_cll(1)) then}
\DoxyCodeLine{6629             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TNten\_cll suppressed for N ='},1   }
\DoxyCodeLine{6630             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{6631           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{6632 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6633 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{6634       \textcolor{keyword}{end }if}
\DoxyCodeLine{6635     \textcolor{keyword}{end }if}
\DoxyCodeLine{6636 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a1ecde1bfcc792940c48453fcc8e40f89}\label{namespacecollier__tensors_a1ecde1bfcc792940c48453fcc8e40f89}} 
\index{collier\_tensors@{collier\_tensors}!tnten\_list\_checked\_cll@{tnten\_list\_checked\_cll}}
\index{tnten\_list\_checked\_cll@{tnten\_list\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{tnten\_list\_checked\_cll()}{tnten\_list\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::tnten\+\_\+list\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(rmax)), intent(out)}]{TN,  }\item[{double complex, dimension(rts(rmax)), intent(out)}]{T\+Nuv,  }\item[{double complex, dimension(0\+:3,max(n-\/1,1)), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(binomtable(2,n)), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:max(n-\/1,1)), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{N,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Nerr }\end{DoxyParamCaption})}



Definition at line 6223 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{6223 }
\DoxyCodeLine{6224     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: N,rmax}
\DoxyCodeLine{6225     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,max(N-\/1,1)), MomInv(BinomTable(2,N)), masses2(0:max(N-\/1,1))}
\DoxyCodeLine{6226     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TN(RtS(rmax)),TNuv(RtS(rmax))}
\DoxyCodeLine{6227     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TNerr(0:rmax)}
\DoxyCodeLine{6228     \textcolor{keywordtype}{double complex} :: TN2(RtS(rmax)),TNuv2(RtS(rmax))    }
\DoxyCodeLine{6229     \textcolor{keywordtype}{double complex} :: CN(NCoefs(rmax,N)),CNuv(NCoefs(rmax,N))}
\DoxyCodeLine{6230     \textcolor{keywordtype}{double precision} :: CNerr(0:rmax), TNerr\_aux(0:rmax), TNerr\_aux2(0:rmax)}
\DoxyCodeLine{6231     \textcolor{keywordtype}{double complex} :: args(4*(N-\/1)+BinomTable(2,N)+N)}
\DoxyCodeLine{6232     \textcolor{keywordtype}{double precision} :: TNdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TNacc(0:rmax)}
\DoxyCodeLine{6233     \textcolor{keywordtype}{integer} :: r,i}
\DoxyCodeLine{6234     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{6235       }
\DoxyCodeLine{6236 \textcolor{comment}{!    if (N.eq.1) then}}
\DoxyCodeLine{6237 \textcolor{comment}{!      call SetErrFlag\_cll(-\/10)}}
\DoxyCodeLine{6238 \textcolor{comment}{!      call ErrOut\_cll('TNten\_cll','subroutine called with wrong number of arguments for N=1',eflag)}}
\DoxyCodeLine{6239 \textcolor{comment}{!      return}}
\DoxyCodeLine{6240 \textcolor{comment}{!    end if}}
\DoxyCodeLine{6241 }
\DoxyCodeLine{6242     \textcolor{keywordflow}{do} i=1,n-\/1}
\DoxyCodeLine{6243       args(4*i-\/3:4*i) = momvec(0:,i)}
\DoxyCodeLine{6244     \textcolor{keyword}{end }do}
\DoxyCodeLine{6245     args(4*(n-\/1)+1:4*(n-\/1)+binomtable(2,n)) = mominv}
\DoxyCodeLine{6246     args(4*(n-\/1)+binomtable(2,n)+1:4*(n-\/1)+binomtable(2,n)+n) = masses2(0:)}
\DoxyCodeLine{6247     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'TNten\_cll'})}
\DoxyCodeLine{6248     \textcolor{keyword}{call }setmastern\_cll(n)}
\DoxyCodeLine{6249     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{6250     \textcolor{keyword}{call }setmasterargs\_cll(4*(n-\/1)+binomtable(2,n)+n,args)}
\DoxyCodeLine{6251 }
\DoxyCodeLine{6252     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{6253 }
\DoxyCodeLine{6254   }
\DoxyCodeLine{6255     \textcolor{keywordflow}{if} (tenred\_cll.le.n+1) then}
\DoxyCodeLine{6256     }
\DoxyCodeLine{6257       \textcolor{keywordflow}{if} (mode\_cll.gt.1) \textcolor{keyword}{call }tn\_dd\_dummy(n,rmax)}
\DoxyCodeLine{6258       }
\DoxyCodeLine{6259       \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{6260         \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{6261         mode\_cll = 1}
\DoxyCodeLine{6262 }
\DoxyCodeLine{6263         \textcolor{keyword}{call }calctensortnr\_list(tn,tnuv,tnerr\_aux,momvec,mominv,masses2,n,rmax)                                    }
\DoxyCodeLine{6264         \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{6265         mode\_cll = 2}
\DoxyCodeLine{6266         \textcolor{keyword}{call }calctensortnr\_list(tn2,tnuv2,tnerr\_aux2,momvec,mominv,masses2,n,rmax)                               }
\DoxyCodeLine{6267 }
\DoxyCodeLine{6268         \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{6269         mode\_cll = 3}
\DoxyCodeLine{6270         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6271           norm\_coli=0d0}
\DoxyCodeLine{6272           norm\_dd=0d0}
\DoxyCodeLine{6273           \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{6274             norm\_coli = max(norm\_coli,abs(tn(i)))}
\DoxyCodeLine{6275             norm\_dd = max(norm\_dd,abs(tn2(i)))}
\DoxyCodeLine{6276           \textcolor{keyword}{end }do}
\DoxyCodeLine{6277           \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{6278             norm\_coli = max(maxval(abs(mominv(1:binomtable(2,n)))),  \&}
\DoxyCodeLine{6279                    maxval(abs(masses2(0:n-\/1))))}
\DoxyCodeLine{6280             \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{6281               norm\_coli=1d0/norm\_coli**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6282             else}
\DoxyCodeLine{6283               norm\_coli=1d0/muir2\_cll**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6284 \textcolor{keywordflow}{            end if} }
\DoxyCodeLine{6285           \textcolor{keyword}{end }if}
\DoxyCodeLine{6286           \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{6287             norm\_dd = max(maxval(abs(mominv(1:binomtable(2,n)))),  \& }
\DoxyCodeLine{6288                    maxval(abs(masses2(0:n-\/1))))}
\DoxyCodeLine{6289             \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{6290               norm\_dd=1d0/norm\_dd**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6291             else}
\DoxyCodeLine{6292               norm\_dd=1d0/muir2\_cll**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6293 \textcolor{keywordflow}{            end if} }
\DoxyCodeLine{6294           \textcolor{keyword}{end }if}
\DoxyCodeLine{6295           norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{6296 \textcolor{keywordflow}{        end do}        }
\DoxyCodeLine{6297       }
\DoxyCodeLine{6298         \textcolor{keyword}{call }checktensorslist\_cll(tn,tn2,momvec,mominv,masses2,norm,n,rmax,tndiff)        }
\DoxyCodeLine{6299        }
\DoxyCodeLine{6300         \textcolor{keywordflow}{if} (tnerr\_aux(rmax).lt.tnerr\_aux2(rmax)) then}
\DoxyCodeLine{6301           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tnerr))  tnerr = max(tnerr\_aux,tndiff*norm)}
\DoxyCodeLine{6302           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6303             tnacc(r) = max(tnerr\_aux(r)/norm(r),tndiff(r))}
\DoxyCodeLine{6304           \textcolor{keyword}{end }do}
\DoxyCodeLine{6305           \textcolor{keywordflow}{if} (monitoring) pointscnttnten\_coli(n) =  pointscnttnten\_coli(n) + 1}
\DoxyCodeLine{6306         else}
\DoxyCodeLine{6307           tn = tn2}
\DoxyCodeLine{6308           tnuv = tnuv2        }
\DoxyCodeLine{6309           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tnerr))  tnerr = max(tnerr\_aux2,tndiff*norm)    }
\DoxyCodeLine{6310           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6311             tnacc(r) = max(tnerr\_aux2(r)/norm(r),tndiff(r))}
\DoxyCodeLine{6312 \textcolor{keywordflow}{          end do}         }
\DoxyCodeLine{6313           \textcolor{keywordflow}{if} (monitoring) pointscnttnten\_dd(n) =  pointscnttnten\_dd(n) + 1}
\DoxyCodeLine{6314         \textcolor{keyword}{end }if}
\DoxyCodeLine{6315         }
\DoxyCodeLine{6316       \textcolor{keywordflow}{else}       }
\DoxyCodeLine{6317         \textcolor{keyword}{call }calctensortnr\_list(tn,tnuv,tnerr\_aux,momvec,mominv,masses2,n,rmax)}
\DoxyCodeLine{6318         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tnerr)) tnerr = tnerr\_aux}
\DoxyCodeLine{6319 }
\DoxyCodeLine{6320         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6321           norm(r)=0d0}
\DoxyCodeLine{6322           \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{6323             norm(r) = max(norm(r),abs(tn(i)))}
\DoxyCodeLine{6324           \textcolor{keyword}{end }do}
\DoxyCodeLine{6325           \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{6326             norm(r) = max(maxval(abs(mominv(1:binomtable(2,n)))),  \&}
\DoxyCodeLine{6327                 maxval(abs(masses2(0:n-\/1))))}
\DoxyCodeLine{6328             \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{6329               norm(r)=1d0/norm(r)**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6330             else}
\DoxyCodeLine{6331               norm(r)=1d0/muir2\_cll**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6332             \textcolor{keyword}{end }if}
\DoxyCodeLine{6333           \textcolor{keyword}{end }if}
\DoxyCodeLine{6334         \textcolor{keyword}{end }do}
\DoxyCodeLine{6335         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6336           tnacc(r) = tnerr\_aux(r)/norm(r)}
\DoxyCodeLine{6337 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{6338         }
\DoxyCodeLine{6339       \textcolor{keyword}{end }if}
\DoxyCodeLine{6340       }
\DoxyCodeLine{6341     else}
\DoxyCodeLine{6342     }
\DoxyCodeLine{6343            }
\DoxyCodeLine{6344       \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{6345         \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{6346         mode\_cll = 1}
\DoxyCodeLine{6347         \textcolor{keyword}{call }tn\_cll(cn,cnuv,mominv,masses2,n,rmax,tnerr2=cnerr,id\_in=0)}
\DoxyCodeLine{6348         \textcolor{keyword}{call }calctensortn\_list(tn,tnuv,tnerr\_aux,cn,cnuv,cnerr,momvec,n,rmax)        }
\DoxyCodeLine{6349         \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{6350         mode\_cll = 2}
\DoxyCodeLine{6351         \textcolor{keyword}{call }tn\_cll(cn,cnuv,mominv,masses2,n,rmax,tnerr2=cnerr,id\_in=0)}
\DoxyCodeLine{6352         \textcolor{keyword}{call }calctensortn\_list(tn2,tnuv2,tnerr\_aux2,cn,cnuv,cnerr,momvec,n,rmax)                                }
\DoxyCodeLine{6353 }
\DoxyCodeLine{6354         \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{6355         mode\_cll = 3}
\DoxyCodeLine{6356         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6357           norm\_coli=0d0}
\DoxyCodeLine{6358           norm\_dd=0d0}
\DoxyCodeLine{6359           \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{6360             norm\_coli = max(norm\_coli,abs(tn(i)))}
\DoxyCodeLine{6361             norm\_dd = max(norm\_dd,abs(tn2(i)))}
\DoxyCodeLine{6362           \textcolor{keyword}{end }do}
\DoxyCodeLine{6363           \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{6364             norm\_coli = max(maxval(abs(mominv(1:binomtable(2,n)))),  \&}
\DoxyCodeLine{6365                    maxval(abs(masses2(0:n-\/1))))}
\DoxyCodeLine{6366             \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{6367               norm\_coli=1d0/norm\_coli**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6368             else}
\DoxyCodeLine{6369               norm\_coli=1d0/muir2\_cll**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6370 \textcolor{keywordflow}{            end if} }
\DoxyCodeLine{6371           \textcolor{keyword}{end }if}
\DoxyCodeLine{6372           \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{6373             norm\_dd = max(maxval(abs(mominv(1:binomtable(2,n)))),  \& }
\DoxyCodeLine{6374                    maxval(abs(masses2(0:n-\/1))))}
\DoxyCodeLine{6375             \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{6376               norm\_dd=1d0/norm\_dd**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6377             else}
\DoxyCodeLine{6378               norm\_dd=1d0/muir2\_cll**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6379 \textcolor{keywordflow}{            end if} }
\DoxyCodeLine{6380           \textcolor{keyword}{end }if}
\DoxyCodeLine{6381           norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{6382 \textcolor{keywordflow}{        end do}        }
\DoxyCodeLine{6383      }
\DoxyCodeLine{6384         \textcolor{keyword}{call }checktensorslist\_cll(tn,tn2,momvec,mominv,masses2,norm,n,rmax,tndiff)}
\DoxyCodeLine{6385        }
\DoxyCodeLine{6386         \textcolor{keywordflow}{if} (tnerr\_aux(rmax).lt.tnerr\_aux2(rmax)) then}
\DoxyCodeLine{6387           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tnerr))  tnerr = max(tnerr\_aux,tndiff*norm)}
\DoxyCodeLine{6388           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6389             tnacc(r) = max(tnerr\_aux(r)/norm(r),tndiff(r))}
\DoxyCodeLine{6390           \textcolor{keyword}{end }do}
\DoxyCodeLine{6391           \textcolor{keywordflow}{if} (monitoring) pointscnttnten\_coli(n) =  pointscnttnten\_coli(n) + 1}
\DoxyCodeLine{6392         else}
\DoxyCodeLine{6393           tn = tn2}
\DoxyCodeLine{6394           tnuv = tnuv2        }
\DoxyCodeLine{6395           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tnerr))  tnerr = max(tnerr\_aux2,tndiff*norm)    }
\DoxyCodeLine{6396           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6397             tnacc(r) = max(tnerr\_aux2(r)/norm(r),tndiff(r))}
\DoxyCodeLine{6398 \textcolor{keywordflow}{          end do}         }
\DoxyCodeLine{6399           \textcolor{keywordflow}{if} (monitoring) pointscnttnten\_dd(n) =  pointscnttnten\_dd(n) + 1}
\DoxyCodeLine{6400 \textcolor{keywordflow}{        end if}        }
\DoxyCodeLine{6401     }
\DoxyCodeLine{6402       \textcolor{keywordflow}{else} }
\DoxyCodeLine{6403         \textcolor{keyword}{call }tn\_cll(cn,cnuv,mominv,masses2,n,rmax,tnerr2=cnerr,id\_in=0)}
\DoxyCodeLine{6404         \textcolor{keyword}{call }calctensortn\_list(tn,tnuv,tnerr\_aux,cn,cnuv,cnerr,momvec,n,rmax)}
\DoxyCodeLine{6405 }
\DoxyCodeLine{6406         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tnerr)) tnerr = tnerr\_aux}
\DoxyCodeLine{6407 }
\DoxyCodeLine{6408         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6409           norm(r)=0d0}
\DoxyCodeLine{6410           \textcolor{keywordflow}{do} i=rts(r-\/1)+1,rts(r)}
\DoxyCodeLine{6411             norm(r) = max(norm(r),abs(tn(i)))}
\DoxyCodeLine{6412           \textcolor{keyword}{end }do}
\DoxyCodeLine{6413           \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{6414             norm(r) = max(maxval(abs(mominv(1:binomtable(2,n)))),  \&}
\DoxyCodeLine{6415                 maxval(abs(masses2(0:n-\/1))))}
\DoxyCodeLine{6416             \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{6417               norm(r)=1d0/norm(r)**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6418             else}
\DoxyCodeLine{6419               norm(r)=1d0/muir2\_cll**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6420             \textcolor{keyword}{end }if}
\DoxyCodeLine{6421           \textcolor{keyword}{end }if}
\DoxyCodeLine{6422         \textcolor{keyword}{end }do}
\DoxyCodeLine{6423         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6424           tnacc(r) = tnerr\_aux(r)/norm(r)}
\DoxyCodeLine{6425 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{6426         }
\DoxyCodeLine{6427       \textcolor{keyword}{end }if}
\DoxyCodeLine{6428       }
\DoxyCodeLine{6429     \textcolor{keyword}{end }if}
\DoxyCodeLine{6430 }
\DoxyCodeLine{6431     \textcolor{keyword}{call }propagateaccflag\_cll(tnacc,rmax)}
\DoxyCodeLine{6432     \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{6433 }
\DoxyCodeLine{6434     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{6435       pointscnttnten\_cll(n) =  pointscnttnten\_cll(n) + 1}
\DoxyCodeLine{6436 }
\DoxyCodeLine{6437       \textcolor{keywordflow}{if}(maxval(tnacc).gt.reqacc\_cll) accpointscnttnten\_cll(n) = accpointscnttnten\_cll(n) + 1}
\DoxyCodeLine{6438 }
\DoxyCodeLine{6439       \textcolor{keywordflow}{if}(maxval(tnacc).gt.critacc\_cll) then}
\DoxyCodeLine{6440         critpointscnttnten\_cll(n) =  critpointscnttnten\_cll(n) + 1}
\DoxyCodeLine{6441         \textcolor{keywordflow}{if} ( critpointscnttnten\_cll(n).le.noutcritpointsmax\_cll(n) ) then}
\DoxyCodeLine{6442           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TNten\_cll'},n,maxval(tnacc),critpointscnttnten\_cll(n))}
\DoxyCodeLine{6443           \textcolor{keywordflow}{if}( critpointscnttnten\_cll(n).eq.noutcritpointsmax\_cll(n)) then}
\DoxyCodeLine{6444             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TNten\_cll suppressed for N ='},n   }
\DoxyCodeLine{6445             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{6446           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{6447 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{6448 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TNten\_cll'},n,maxval(tnacc),critpointscnttnten\_cll(n))}
\DoxyCodeLine{6449           \textcolor{keywordflow}{if}( critpointscnttnten\_cll(n).eq.noutcritpointsmax\_cll(n)) then}
\DoxyCodeLine{6450             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TNten\_cll suppressed for N ='},n   }
\DoxyCodeLine{6451             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{6452           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{6453 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6454 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{6455       \textcolor{keyword}{end }if}
\DoxyCodeLine{6456     \textcolor{keyword}{end }if}
\DoxyCodeLine{6457 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_ad5a41c48b7784839de17ebc766b878c8}\label{namespacecollier__tensors_ad5a41c48b7784839de17ebc766b878c8}} 
\index{collier\_tensors@{collier\_tensors}!tnten\_list\_cll@{tnten\_list\_cll}}
\index{tnten\_list\_cll@{tnten\_list\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{tnten\_list\_cll()}{tnten\_list\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::tnten\+\_\+list\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:), intent(out)}]{TN,  }\item[{double complex, dimension(\+:), intent(out)}]{T\+Nuv,  }\item[{double complex, dimension(0\+:3,max(n-\/1,1)), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(\+:), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:max(n-\/1,1)), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{N,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Nerr }\end{DoxyParamCaption})}



Definition at line 6184 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{6184 }
\DoxyCodeLine{6185     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: N,rmax}
\DoxyCodeLine{6186     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,max(N-\/1,1)), MomInv(:), masses2(0:max(N-\/1,1))}
\DoxyCodeLine{6187     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TN(:),TNuv(:)}
\DoxyCodeLine{6188     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TNerr(0:rmax)}
\DoxyCodeLine{6189     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{6190       }
\DoxyCodeLine{6191     \textcolor{keywordflow}{if} (n.eq.1) then}
\DoxyCodeLine{6192       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{6193       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'TNten\_cll'},\textcolor{stringliteral}{'subroutine called with wrong number of arguments for N=1'},eflag)}
\DoxyCodeLine{6194       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{6195       return}
\DoxyCodeLine{6196     \textcolor{keyword}{end }if}
\DoxyCodeLine{6197     \textcolor{keywordflow}{if} (n.gt.nmax\_cll) then}
\DoxyCodeLine{6198       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{6199       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'TNten\_cll'},\textcolor{stringliteral}{'argument N larger than Nmax\_cll'},eflag,.true.)}
\DoxyCodeLine{6200       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'N        ='},n}
\DoxyCodeLine{6201       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{6202       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= '},n}
\DoxyCodeLine{6203       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{6204       return}
\DoxyCodeLine{6205 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{6206     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{6207       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{6208       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'TNten\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{6209       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{6210       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{6211       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{6212       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{6213       return}
\DoxyCodeLine{6214 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{6215     }
\DoxyCodeLine{6216     \textcolor{keyword}{call }tnten\_list\_checked\_cll(tn,tnuv,momvec,mominv,masses2,n,rmax,tnerr)}
\DoxyCodeLine{6217 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a87995b57c6fddc58254053e30899a7e7}\label{namespacecollier__tensors_a87995b57c6fddc58254053e30899a7e7}} 
\index{collier\_tensors@{collier\_tensors}!tnten\_main\_checked\_cll@{tnten\_main\_checked\_cll}}
\index{tnten\_main\_checked\_cll@{tnten\_main\_checked\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{tnten\_main\_checked\_cll()}{tnten\_main\_checked\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::tnten\+\_\+main\+\_\+checked\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TN,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Nuv,  }\item[{double complex, dimension(0\+:3,max(n-\/1,1)), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(binomtable(2,n)), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:max(n-\/1,1)), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{N,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Nerr }\end{DoxyParamCaption})}



Definition at line 5917 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5917 }
\DoxyCodeLine{5918     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: N,rmax}
\DoxyCodeLine{5919     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,max(N-\/1,1)), MomInv(BinomTable(2,N)), masses2(0:max(N-\/1,1))}
\DoxyCodeLine{5920     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TN(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5921     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TNuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5922     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TNerr(0:rmax)}
\DoxyCodeLine{5923     \textcolor{keywordtype}{double complex} :: TN2(0:rmax,0:rmax,0:rmax,0:rmax), TNuv2(0:rmax,0:rmax,0:rmax,0:rmax)    }
\DoxyCodeLine{5924     \textcolor{keywordtype}{double complex} :: CN(NCoefs(rmax,N))}
\DoxyCodeLine{5925     \textcolor{keywordtype}{double complex} :: CNuv(NCoefs(rmax,N)) }
\DoxyCodeLine{5926     \textcolor{keywordtype}{double precision} :: CNerr(0:rmax), TNerr\_aux(0:rmax), TNerr\_aux2(0:rmax)}
\DoxyCodeLine{5927     \textcolor{keywordtype}{double complex} :: args(4*(N-\/1)+BinomTable(2,N)+N)}
\DoxyCodeLine{5928     \textcolor{keywordtype}{integer} :: i}
\DoxyCodeLine{5929     \textcolor{keywordtype}{double precision} :: TNdiff(0:rmax),norm(0:rmax),norm\_coli,norm\_dd,TNacc(0:rmax)}
\DoxyCodeLine{5930     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3    }
\DoxyCodeLine{5931     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{5932 }
\DoxyCodeLine{5933     \textcolor{keywordflow}{if} (n.eq.1) then}
\DoxyCodeLine{5934       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{5935       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'TNten\_cll'},\textcolor{stringliteral}{'subroutine called with wrong number of arguments for N=1'},eflag)}
\DoxyCodeLine{5936       return}
\DoxyCodeLine{5937     \textcolor{keyword}{end }if}
\DoxyCodeLine{5938 }
\DoxyCodeLine{5939     \textcolor{keywordflow}{do} i=1,n-\/1}
\DoxyCodeLine{5940       args(4*i-\/3:4*i) = momvec(0:,i)}
\DoxyCodeLine{5941     \textcolor{keyword}{end }do}
\DoxyCodeLine{5942     args(4*(n-\/1)+1:4*(n-\/1)+binomtable(2,n)) = mominv}
\DoxyCodeLine{5943     args(4*(n-\/1)+binomtable(2,n)+1:4*(n-\/1)+binomtable(2,n)+n) = masses2(0:)}
\DoxyCodeLine{5944     \textcolor{keyword}{call }setmasterfname\_cll(\textcolor{stringliteral}{'TNten\_cll'})}
\DoxyCodeLine{5945     \textcolor{keyword}{call }setmastern\_cll(n)}
\DoxyCodeLine{5946     \textcolor{keyword}{call }setmasterr\_cll(rmax)}
\DoxyCodeLine{5947     \textcolor{keyword}{call }setmasterargs\_cll(4*(n-\/1)+binomtable(2,n)+n,args)}
\DoxyCodeLine{5948 }
\DoxyCodeLine{5949     \textcolor{keyword}{call }settencache\_cll(tenred\_cll-\/1)}
\DoxyCodeLine{5950 }
\DoxyCodeLine{5951   }
\DoxyCodeLine{5952     \textcolor{keywordflow}{if} (tenred\_cll.le.n+1) then}
\DoxyCodeLine{5953     }
\DoxyCodeLine{5954       \textcolor{keywordflow}{if} (mode\_cll.gt.1) \textcolor{keyword}{call }tn\_dd\_dummy(n,rmax)}
\DoxyCodeLine{5955       }
\DoxyCodeLine{5956       \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{5957         \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{5958         mode\_cll = 1}
\DoxyCodeLine{5959         \textcolor{keyword}{call }calctensortnr(tn,tnuv,tnerr\_aux,momvec,mominv,masses2,n,rmax,0)                                    }
\DoxyCodeLine{5960       }
\DoxyCodeLine{5961         \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{5962         mode\_cll = 2}
\DoxyCodeLine{5963         \textcolor{keyword}{call }calctensortnr(tn2,tnuv2,tnerr\_aux2,momvec,mominv,masses2,n,rmax,0)                               }
\DoxyCodeLine{5964       }
\DoxyCodeLine{5965         \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{5966         mode\_cll = 3}
\DoxyCodeLine{5967         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{5968           norm\_coli=0d0}
\DoxyCodeLine{5969           norm\_dd=0d0}
\DoxyCodeLine{5970           \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{5971             \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{5972               \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{5973                 n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{5974                 norm\_coli = max(norm\_coli,abs(tn(n0,n1,n2,n3)))}
\DoxyCodeLine{5975                 norm\_dd = max(norm\_dd,abs(tn2(n0,n1,n2,n3)))}
\DoxyCodeLine{5976               \textcolor{keyword}{end }do}
\DoxyCodeLine{5977             \textcolor{keyword}{end }do}
\DoxyCodeLine{5978           \textcolor{keyword}{end }do}
\DoxyCodeLine{5979           \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{5980             norm\_coli = max(maxval(abs(mominv(1:binomtable(2,n)))),  \&}
\DoxyCodeLine{5981                    maxval(abs(masses2(0:n-\/1))))}
\DoxyCodeLine{5982             \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{5983               norm\_coli=1d0/norm\_coli**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{5984             else}
\DoxyCodeLine{5985               norm\_coli=1d0/muir2\_cll**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{5986 \textcolor{keywordflow}{            end if} }
\DoxyCodeLine{5987           \textcolor{keyword}{end }if}
\DoxyCodeLine{5988           \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{5989             norm\_dd = max(maxval(abs(mominv(1:binomtable(2,n)))),  \& }
\DoxyCodeLine{5990                    maxval(abs(masses2(0:n-\/1))))}
\DoxyCodeLine{5991             \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{5992               norm\_dd=1d0/norm\_dd**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{5993             else}
\DoxyCodeLine{5994               norm\_dd=1d0/muir2\_cll**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{5995 \textcolor{keywordflow}{            end if} }
\DoxyCodeLine{5996           \textcolor{keyword}{end }if}
\DoxyCodeLine{5997           norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{5998         \textcolor{keyword}{end }do}
\DoxyCodeLine{5999       }
\DoxyCodeLine{6000         \textcolor{keyword}{call }checktensors\_cll(tn,tn2,momvec,mominv,masses2,norm,n,rmax,tndiff)}
\DoxyCodeLine{6001 }
\DoxyCodeLine{6002         \textcolor{keywordflow}{if} (tnerr\_aux(rmax).lt.tnerr\_aux2(rmax)) then}
\DoxyCodeLine{6003           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tnerr))  tnerr = max(tnerr\_aux,tndiff*norm)}
\DoxyCodeLine{6004           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6005             tnacc(r) = max(tnerr\_aux(r)/norm(r),tndiff(r))}
\DoxyCodeLine{6006           \textcolor{keyword}{end }do}
\DoxyCodeLine{6007           \textcolor{keywordflow}{if} (monitoring) pointscnttnten\_coli(n) =  pointscnttnten\_coli(n) + 1}
\DoxyCodeLine{6008         else}
\DoxyCodeLine{6009           tn = tn2}
\DoxyCodeLine{6010           tnuv = tnuv2        }
\DoxyCodeLine{6011           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tnerr))  tnerr = max(tnerr\_aux2,tndiff*norm)    }
\DoxyCodeLine{6012           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6013             tnacc(r) = max(tnerr\_aux2(r)/norm(r),tndiff(r))}
\DoxyCodeLine{6014 \textcolor{keywordflow}{          end do}         }
\DoxyCodeLine{6015           \textcolor{keywordflow}{if} (monitoring) pointscnttnten\_dd(n) =  pointscnttnten\_dd(n)  + 1}
\DoxyCodeLine{6016         \textcolor{keyword}{end }if}
\DoxyCodeLine{6017         }
\DoxyCodeLine{6018       \textcolor{keywordflow}{else}       }
\DoxyCodeLine{6019         \textcolor{keyword}{call }calctensortnr(tn,tnuv,tnerr\_aux,momvec,mominv,masses2,n,rmax,0)}
\DoxyCodeLine{6020         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tnerr)) tnerr = tnerr\_aux}
\DoxyCodeLine{6021         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6022           norm(r)=0d0}
\DoxyCodeLine{6023           \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{6024             \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{6025               \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{6026                 n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{6027                 norm(r) = max(norm(r),abs(tn(n0,n1,n2,n3)))}
\DoxyCodeLine{6028               \textcolor{keyword}{end }do}
\DoxyCodeLine{6029             \textcolor{keyword}{end }do}
\DoxyCodeLine{6030           \textcolor{keyword}{end }do}
\DoxyCodeLine{6031           \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{6032             norm(r) = max(maxval(abs(mominv(1:binomtable(2,n)))),  \&}
\DoxyCodeLine{6033                    maxval(abs(masses2(0:n-\/1))))}
\DoxyCodeLine{6034             \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{6035               norm(r)=1d0/norm(r)**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6036             else}
\DoxyCodeLine{6037               norm(r)=1d0/muir2\_cll**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6038 \textcolor{keywordflow}{            end if} }
\DoxyCodeLine{6039           \textcolor{keyword}{end }if}
\DoxyCodeLine{6040         \textcolor{keyword}{end }do}
\DoxyCodeLine{6041         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6042           tnacc(r) = tnerr\_aux(r)/norm(r)}
\DoxyCodeLine{6043 \textcolor{keywordflow}{        end do}        }
\DoxyCodeLine{6044         }
\DoxyCodeLine{6045       \textcolor{keyword}{end }if}
\DoxyCodeLine{6046       }
\DoxyCodeLine{6047     else}
\DoxyCodeLine{6048        }
\DoxyCodeLine{6049       \textcolor{keywordflow}{if} (mode\_cll.eq.3) then}
\DoxyCodeLine{6050         \textcolor{comment}{! calculate tensor with coefficients from COLI}}
\DoxyCodeLine{6051         mode\_cll = 1}
\DoxyCodeLine{6052         \textcolor{keyword}{call }tn\_cll(cn,cnuv,mominv,masses2,n,rmax,tnerr2=cnerr,id\_in=0)}
\DoxyCodeLine{6053         \textcolor{keyword}{call }calctensortn(tn,tnuv,tnerr\_aux,cn,cnuv,cnerr,momvec,n,rmax)        }
\DoxyCodeLine{6054       }
\DoxyCodeLine{6055         \textcolor{comment}{! calculate tensor with coefficients from DD}}
\DoxyCodeLine{6056         mode\_cll = 2}
\DoxyCodeLine{6057         \textcolor{keyword}{call }tn\_cll(cn,cnuv,mominv,masses2,n,rmax,tnerr2=cnerr,id\_in=0)}
\DoxyCodeLine{6058         \textcolor{keyword}{call }calctensortn(tn2,tnuv2,tnerr\_aux2,cn,cnuv,cnerr,momvec,n,rmax)                                }
\DoxyCodeLine{6059       }
\DoxyCodeLine{6060         \textcolor{comment}{! comparison -\/-\/> take better result}}
\DoxyCodeLine{6061         mode\_cll = 3}
\DoxyCodeLine{6062         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6063           norm\_coli=0d0}
\DoxyCodeLine{6064           norm\_dd=0d0}
\DoxyCodeLine{6065           \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{6066             \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{6067               \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{6068                 n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{6069                 norm\_coli = max(norm\_coli,abs(tn(n0,n1,n2,n3)))}
\DoxyCodeLine{6070                 norm\_dd = max(norm\_dd,abs(tn2(n0,n1,n2,n3)))}
\DoxyCodeLine{6071               \textcolor{keyword}{end }do}
\DoxyCodeLine{6072             \textcolor{keyword}{end }do}
\DoxyCodeLine{6073           \textcolor{keyword}{end }do}
\DoxyCodeLine{6074           \textcolor{keywordflow}{if} (norm\_coli.eq.0d0) then}
\DoxyCodeLine{6075             norm\_coli = max(maxval(abs(mominv(1:binomtable(2,n)))),  \&}
\DoxyCodeLine{6076                    maxval(abs(masses2(0:n-\/1))))}
\DoxyCodeLine{6077             \textcolor{keywordflow}{if}(norm\_coli.ne.0d0) then}
\DoxyCodeLine{6078               norm\_coli=1d0/norm\_coli**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6079             else}
\DoxyCodeLine{6080               norm\_coli=1d0/muir2\_cll**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6081 \textcolor{keywordflow}{            end if} }
\DoxyCodeLine{6082           \textcolor{keyword}{end }if}
\DoxyCodeLine{6083           \textcolor{keywordflow}{if} (norm\_dd.eq.0d0) then}
\DoxyCodeLine{6084             norm\_dd = max(maxval(abs(mominv(1:binomtable(2,n)))),  \& }
\DoxyCodeLine{6085                    maxval(abs(masses2(0:n-\/1))))}
\DoxyCodeLine{6086             \textcolor{keywordflow}{if}(norm\_dd.ne.0d0) then}
\DoxyCodeLine{6087               norm\_dd=1d0/norm\_dd**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6088             else}
\DoxyCodeLine{6089               norm\_dd=1d0/muir2\_cll**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6090 \textcolor{keywordflow}{            end if} }
\DoxyCodeLine{6091           \textcolor{keyword}{end }if}
\DoxyCodeLine{6092           norm(r) = min(norm\_coli,norm\_dd)}
\DoxyCodeLine{6093         \textcolor{keyword}{end }do}
\DoxyCodeLine{6094       }
\DoxyCodeLine{6095         \textcolor{keyword}{call }checktensors\_cll(tn,tn2,momvec,mominv,masses2,norm,n,rmax,tndiff)         }
\DoxyCodeLine{6096        }
\DoxyCodeLine{6097         \textcolor{keywordflow}{if} (tnerr\_aux(rmax).lt.tnerr\_aux2(rmax)) then}
\DoxyCodeLine{6098           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tnerr))  tnerr = max(tnerr\_aux,tndiff*norm)}
\DoxyCodeLine{6099           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6100             tnacc(r) = max(tnerr\_aux(r)/norm(r),tndiff(r))}
\DoxyCodeLine{6101           \textcolor{keyword}{end }do}
\DoxyCodeLine{6102           \textcolor{keywordflow}{if} (monitoring) pointscnttnten\_coli(n) =  pointscnttnten\_coli(n) + 1}
\DoxyCodeLine{6103         else}
\DoxyCodeLine{6104           tn = tn2}
\DoxyCodeLine{6105           tnuv = tnuv2        }
\DoxyCodeLine{6106           \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tnerr))  tnerr = max(tnerr\_aux2,tndiff*norm)    }
\DoxyCodeLine{6107           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6108             tnacc(r) = max(tnerr\_aux2(r)/norm(r),tndiff(r))}
\DoxyCodeLine{6109 \textcolor{keywordflow}{          end do}         }
\DoxyCodeLine{6110           \textcolor{keywordflow}{if} (monitoring) pointscnttnten\_dd(n) =  pointscnttnten\_dd(n)  + 1}
\DoxyCodeLine{6111         \textcolor{keyword}{end }if}
\DoxyCodeLine{6112         }
\DoxyCodeLine{6113       \textcolor{keywordflow}{else}    }
\DoxyCodeLine{6114         \textcolor{keyword}{call }tn\_cll(cn,cnuv,mominv,masses2,n,rmax,tnerr2=cnerr,id\_in=0)}
\DoxyCodeLine{6115         \textcolor{keyword}{call }calctensortn(tn,tnuv,tnerr\_aux,cn,cnuv,cnerr,momvec,n,rmax)}
\DoxyCodeLine{6116         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tnerr)) tnerr = tnerr\_aux}
\DoxyCodeLine{6117         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6118           norm(r)=0d0}
\DoxyCodeLine{6119           \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{6120             \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{6121               \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{6122                 n3=r-\/n0-\/n1-\/n2}
\DoxyCodeLine{6123                 norm(r) = max(norm(r),abs(tn(n0,n1,n2,n3)))}
\DoxyCodeLine{6124               \textcolor{keyword}{end }do}
\DoxyCodeLine{6125             \textcolor{keyword}{end }do}
\DoxyCodeLine{6126           \textcolor{keyword}{end }do}
\DoxyCodeLine{6127           \textcolor{keywordflow}{if} (norm(r).eq.0d0) then}
\DoxyCodeLine{6128             norm(r) = max(maxval(abs(mominv(1:binomtable(2,n)))),  \&}
\DoxyCodeLine{6129                    maxval(abs(masses2(0:n-\/1))))}
\DoxyCodeLine{6130             \textcolor{keywordflow}{if}(norm(r).ne.0d0) then}
\DoxyCodeLine{6131               norm(r)=1d0/norm(r)**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6132             else}
\DoxyCodeLine{6133               norm(r)=1d0/muir2\_cll**(n-\/2-\/real(r)/2)}
\DoxyCodeLine{6134 \textcolor{keywordflow}{            end if} }
\DoxyCodeLine{6135           \textcolor{keyword}{end }if}
\DoxyCodeLine{6136         \textcolor{keyword}{end }do}
\DoxyCodeLine{6137         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{6138           tnacc(r) = tnerr\_aux(r)/norm(r)}
\DoxyCodeLine{6139 \textcolor{keywordflow}{        end do}         }
\DoxyCodeLine{6140         }
\DoxyCodeLine{6141       \textcolor{keyword}{end }if}
\DoxyCodeLine{6142       }
\DoxyCodeLine{6143     \textcolor{keyword}{end }if}
\DoxyCodeLine{6144 }
\DoxyCodeLine{6145     \textcolor{keyword}{call }propagateaccflag\_cll(tnacc,rmax)}
\DoxyCodeLine{6146     \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{6147 }
\DoxyCodeLine{6148     \textcolor{keywordflow}{if} (monitoring) then}
\DoxyCodeLine{6149       pointscnttnten\_cll(n) =  pointscnttnten\_cll(n) + 1}
\DoxyCodeLine{6150 }
\DoxyCodeLine{6151       \textcolor{keywordflow}{if}(maxval(tnacc).gt.reqacc\_cll) accpointscnttnten\_cll(n) = accpointscnttnten\_cll(n) + 1}
\DoxyCodeLine{6152 }
\DoxyCodeLine{6153       \textcolor{keywordflow}{if}(maxval(tnacc).gt.critacc\_cll) then}
\DoxyCodeLine{6154         critpointscnttnten\_cll(n) =  critpointscnttnten\_cll(n) + 1}
\DoxyCodeLine{6155         \textcolor{keywordflow}{if} ( critpointscnttnten\_cll(n).le.noutcritpointsmax\_cll(n) ) then}
\DoxyCodeLine{6156           \textcolor{keyword}{call }critpointsout\_cll(\textcolor{stringliteral}{'TNten\_cll'},n,maxval(tnacc),critpointscnttnten\_cll(n))}
\DoxyCodeLine{6157           \textcolor{keywordflow}{if}( critpointscnttnten\_cll(n).eq.noutcritpointsmax\_cll(n)) then}
\DoxyCodeLine{6158             \textcolor{keyword}{write}(ncpout\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TNten\_cll suppressed for N ='},n   }
\DoxyCodeLine{6159             \textcolor{keyword}{write}(ncpout\_cll,*)}
\DoxyCodeLine{6160           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{6161 \textcolor{preprocessor}{\#ifdef CritPoints2}}
\DoxyCodeLine{6162 \textcolor{preprocessor}{}          \textcolor{keyword}{call }critpointsout2\_cll(\textcolor{stringliteral}{'TNten\_cll'},n,maxval(tnacc),critpointscnttnten\_cll(n))}
\DoxyCodeLine{6163           \textcolor{keywordflow}{if}( critpointscnttnten\_cll(n).eq.noutcritpointsmax\_cll(n)) then}
\DoxyCodeLine{6164             \textcolor{keyword}{write}(ncpout2\_cll,*) \textcolor{stringliteral}{' Further output of Critical Points for TNten\_cll suppressed for N ='},n   }
\DoxyCodeLine{6165             \textcolor{keyword}{write}(ncpout2\_cll,*)}
\DoxyCodeLine{6166           \mbox{\hyperlink{CMakeLists_8txt_a2d474886b4d574f7ab3f0ca3e2dc7463}{endif}}}
\DoxyCodeLine{6167 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6168 \textcolor{preprocessor}{}        \textcolor{keyword}{end }if}
\DoxyCodeLine{6169       \textcolor{keyword}{end }if}
\DoxyCodeLine{6170     \textcolor{keyword}{end }if}
\DoxyCodeLine{6171 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacecollier__tensors_a1ce6fe217845dbbe80fe5effdeac8cd3}\label{namespacecollier__tensors_a1ce6fe217845dbbe80fe5effdeac8cd3}} 
\index{collier\_tensors@{collier\_tensors}!tnten\_main\_cll@{tnten\_main\_cll}}
\index{tnten\_main\_cll@{tnten\_main\_cll}!collier\_tensors@{collier\_tensors}}
\doxysubsubsection{\texorpdfstring{tnten\_main\_cll()}{tnten\_main\_cll()}}
{\footnotesize\ttfamily subroutine collier\+\_\+tensors\+::tnten\+\_\+main\+\_\+cll (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{TN,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{T\+Nuv,  }\item[{double complex, dimension(0\+:3,max(n-\/1,1)), intent(in)}]{Mom\+Vec,  }\item[{double complex, dimension(\+:), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:max(n-\/1,1)), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{N,  }\item[{integer, intent(in)}]{rmax,  }\item[{double precision, dimension(0\+:rmax), intent(out), optional}]{T\+Nerr }\end{DoxyParamCaption})}



Definition at line 5877 of file collier\+\_\+tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5877 }
\DoxyCodeLine{5878     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: N,rmax}
\DoxyCodeLine{5879     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomVec(0:3,max(N-\/1,1)), MomInv(:), masses2(0:max(N-\/1,1))}
\DoxyCodeLine{5880     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TN(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5881     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: TNuv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5882     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: TNerr(0:rmax)}
\DoxyCodeLine{5883     \textcolor{keywordtype}{logical} :: eflag}
\DoxyCodeLine{5884 }
\DoxyCodeLine{5885     \textcolor{keywordflow}{if} (n.eq.1) then}
\DoxyCodeLine{5886       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{5887       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'TNten\_cll'},\textcolor{stringliteral}{'subroutine called with wrong number of arguments for N=1'},eflag)}
\DoxyCodeLine{5888       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{5889       return}
\DoxyCodeLine{5890     \textcolor{keyword}{end }if}
\DoxyCodeLine{5891 }
\DoxyCodeLine{5892     \textcolor{keywordflow}{if} (n.gt.nmax\_cll) then}
\DoxyCodeLine{5893       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{5894       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'TN\_cll'},\textcolor{stringliteral}{'argument N larger than Nmax\_cll'},eflag,.true.)}
\DoxyCodeLine{5895       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'N        ='},n}
\DoxyCodeLine{5896       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Nmax\_cll ='},nmax\_cll}
\DoxyCodeLine{5897       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with Nmax\_cll >= '},n}
\DoxyCodeLine{5898       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{5899       return}
\DoxyCodeLine{5900 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{5901     \textcolor{keywordflow}{if} (rmax.gt.rmax\_cll) then}
\DoxyCodeLine{5902       \textcolor{keyword}{call }seterrflag\_cll(-\/10)}
\DoxyCodeLine{5903       \textcolor{keyword}{call }errout\_cll(\textcolor{stringliteral}{'TN\_cll'},\textcolor{stringliteral}{'argument rmax larger than rmax\_cll'},eflag,.true.)}
\DoxyCodeLine{5904       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax     ='},rmax}
\DoxyCodeLine{5905       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'rmax\_cll ='},rmax\_cll}
\DoxyCodeLine{5906       \textcolor{keyword}{write}(nerrout\_cll,*) \textcolor{stringliteral}{'Reinitialize COLLIER with rmax\_cll >= '},rmax}
\DoxyCodeLine{5907       \textcolor{keyword}{call }propagateerrflag\_cll}
\DoxyCodeLine{5908       return}
\DoxyCodeLine{5909 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{5910     }
\DoxyCodeLine{5911     \textcolor{keyword}{call }tnten\_main\_checked\_cll(tn,tnuv,momvec,mominv,masses2,n,rmax,tnerr)}
\DoxyCodeLine{5912 }

\end{DoxyCode}
