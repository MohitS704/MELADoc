\hypertarget{namespacereductiond}{}\doxysection{reductiond Module Reference}
\label{namespacereductiond}\index{reductiond@{reductiond}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacereductiond_a881559e813d007c3d83cb4ebfe58b8d9}{calcd}} (D, Duv, p10, p21, p32, p30, p20, p31, m02, m12, m22, m32, rmax, id, Derr1, Derr2)
\item 
subroutine \mbox{\hyperlink{namespacereductiond_a7e9d3a0b1d8deaf7143765c780cfa2b5}{calcdred}} (D, Duv, p10, p21, p32, p30, p20, p31, m02, m12, m22, m32, rmax, id, Derr1, Derr2)
\item 
subroutine \mbox{\hyperlink{namespacereductiond_a537a9b81a52414b89483076d05a402bb}{calcduv}} (Duv, Cuv\+\_\+0, m02, f, rmax, id)
\item 
subroutine \mbox{\hyperlink{namespacereductiond_add71cf2cbaa4f0ea03ae3b7b2dbccabf}{calcdpv1}} (D, Duv, p10, p21, p32, p30, p20, p31, m02, m12, m22, m32, rmax, id, Derr, Derr2)
\item 
subroutine \mbox{\hyperlink{namespacereductiond_aff4786024c9f25ebd23e8912d6f5eb91}{calcdpv1o}} (D, Duv, p10, p21, p32, p30, p20, p31, m02, m12, m22, m32, rmax, id, Derr, Derr2)
\item 
subroutine \mbox{\hyperlink{namespacereductiond_a07eb55c56430b6a041f61292554c47ad}{calcdpv}} (D, Duv, p10, p21, p32, p30, p20, p31, m02, m12, m22, m32, rmax, id, Derr, Derr2)
\item 
subroutine \mbox{\hyperlink{namespacereductiond_ae9662beb597df14d1122ae9fd86f5b04}{calcdpv2}} (D, Duv, p10, p21, p32, p30, p20, p31, m02, m12, m22, m32, rmax, id, Derr, Derr2)
\item 
subroutine \mbox{\hyperlink{namespacereductiond_acf7f142bd8cbb61437e15e31dedea77c}{calcdg}} (D, Duv, p10, p21, p32, p30, p20, p31, m02, m12, m22, m32, rmax, ordg\+\_\+min, ordg\+\_\+max, id, Derr, Derr2)
\item 
subroutine \mbox{\hyperlink{namespacereductiond_abd34e414e7b09a95c9f2feda1fa18208}{calcdgr}} (D, Duv, p10, p21, p32, p30, p20, p31, m02, m12, m22, m32, rmax, ordgr\+\_\+min, ordgr\+\_\+max, id, Derr, Derr2)
\item 
subroutine \mbox{\hyperlink{namespacereductiond_a7c913234f60361d5a9d2f529e1445657}{calcdgx}} (D, Duv, p10, p21, p32, p30, p20, p31, m02, m12, m22, m32, rmax, ordgx\+\_\+min, ordgx\+\_\+max, id, Derr, Derr2)
\item 
subroutine \mbox{\hyperlink{namespacereductiond_a0a8af515043a0e7891a7944c886f7314}{calcdgy}} (D, Duv, p10, p21, p32, p30, p20, p31, m02, m12, m22, m32, rmax, ordgy\+\_\+min, ordgy\+\_\+max, id, Derr, Derr2)
\item 
subroutine \mbox{\hyperlink{namespacereductiond_a8a603504b8bf40cf8e19483852f1cd58}{calcdgp}} (D, Duv, p10, p21, p32, p30, p20, p31, m02, m12, m22, m32, rmax, ordgp\+\_\+min, ordgp\+\_\+max, id, Derr, Derr2)
\item 
subroutine \mbox{\hyperlink{namespacereductiond_a6feffd7f87c0539742db98aec14cdfac}{calcdgpf}} (D, Duv, p10, p21, p32, p30, p20, p31, m02, m12, m22, m32, rmax, ordgpf\+\_\+min, ordgpf\+\_\+max, id, Derr, Derr2)
\item 
subroutine \mbox{\hyperlink{namespacereductiond_a17b840a4e6732340891e224e6f0f8995}{copydimp3}} (D, D\+\_\+alt, Derr, Derr\+\_\+alt, Derr1, Derr1\+\_\+alt, Derr2, Derr2\+\_\+alt, Drmethod, Drmethod\+\_\+alt, rmax, r\+\_\+alt)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
double precision, parameter \mbox{\hyperlink{namespacereductiond_a8e58a33ce50f6fc2bdd83b7f3bb3e4da}{truncfacd}} = 1d2
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacereductiond_a881559e813d007c3d83cb4ebfe58b8d9}\label{namespacereductiond_a881559e813d007c3d83cb4ebfe58b8d9}} 
\index{reductiond@{reductiond}!calcd@{calcd}}
\index{calcd@{calcd}!reductiond@{reductiond}}
\doxysubsubsection{\texorpdfstring{calcd()}{calcd()}}
{\footnotesize\ttfamily subroutine reductiond\+::calcd (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{D,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Duv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr1,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr2 }\end{DoxyParamCaption})}



Definition at line 94 of file reduction\+D.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{94   }
\DoxyCodeLine{95     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,id}
\DoxyCodeLine{96     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p30,p20,p31,m02,m12,m22,m32}
\DoxyCodeLine{97     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: D(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{98     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Duv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{99     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Derr1(0:rmax),Derr2(0:rmax)}
\DoxyCodeLine{100     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Daux(:,:,:,:), Duvaux(:,:,:,:), fct(:)}
\DoxyCodeLine{101     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: Derr1aux(:),Derr2aux(:)}
\DoxyCodeLine{102     \textcolor{keywordtype}{double complex} :: x(10)}
\DoxyCodeLine{103     \textcolor{keywordtype}{integer} :: rank,switch,cnt,n0,n1,n2,n3,r}
\DoxyCodeLine{104     \textcolor{keywordtype}{logical} :: nocalc,wrica}
\DoxyCodeLine{105 }
\DoxyCodeLine{106 \textcolor{comment}{!    write(*,*) 'CalcD in'}}
\DoxyCodeLine{107 \textcolor{comment}{!    write(*,*)  'CalcD in with Derr'}}
\DoxyCodeLine{108 }
\DoxyCodeLine{109     \textcolor{keywordflow}{if} (use\_cache\_system) \textcolor{keywordflow}{then}}
\DoxyCodeLine{110       \textcolor{keywordflow}{if} ((ncache.gt.0).and.(ncache.le.ncache\_max)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{111 \textcolor{comment}{!        if (use\_cache(ncache).ge.4) then}}
\DoxyCodeLine{112           x(1)=p10}
\DoxyCodeLine{113           x(2)=p21}
\DoxyCodeLine{114           x(3)=p32}
\DoxyCodeLine{115           x(4)=p30}
\DoxyCodeLine{116           x(5)=p20}
\DoxyCodeLine{117           x(6)=p31}
\DoxyCodeLine{118           x(7)=m02}
\DoxyCodeLine{119           x(8)=m12}
\DoxyCodeLine{120           x(9)=m22}
\DoxyCodeLine{121           x(10)=m32}
\DoxyCodeLine{122           rank = rmax}
\DoxyCodeLine{123           switch = 0}
\DoxyCodeLine{124 }
\DoxyCodeLine{125           \textcolor{keywordflow}{if}(rmax.ge.3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{126             \textcolor{keyword}{allocate}(fct(ncoefsg(rmax,4)-\/ncoefs(rmax-\/2,4)+ncoefs(rmax-\/3,4)+2*(rmax+1)))}
\DoxyCodeLine{127             \textcolor{keyword}{call }readcache(fct,ncoefsg(rmax,4)-\/ncoefs(rmax-\/2,4)+ncoefs(rmax-\/3,4)+2*(rmax+1),x,10,1,id,4,rank,nocalc,wrica)}
\DoxyCodeLine{128           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(rmax.eq.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{129             \textcolor{keyword}{allocate}(fct(ncoefsg(rmax,4)-\/1+2*(rmax+1)))}
\DoxyCodeLine{130             \textcolor{keyword}{call }readcache(fct,ncoefsg(rmax,4)-\/1+2*(rmax+1),x,10,1,id,4,rank,nocalc,wrica)}
\DoxyCodeLine{131           \textcolor{keywordflow}{else}}
\DoxyCodeLine{132             \textcolor{keyword}{allocate}(fct(ncoefsg(rmax,4)+2*(rmax+1)))}
\DoxyCodeLine{133             \textcolor{keyword}{call }readcache(fct,ncoefsg(rmax,4)+2*(rmax+1),x,10,1,id,4,rank,nocalc,wrica)}
\DoxyCodeLine{134 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{135     }
\DoxyCodeLine{136           \textcolor{keywordflow}{if}(nocalc)\textcolor{keywordflow}{then}}
\DoxyCodeLine{137             cnt = 0}
\DoxyCodeLine{138             duv(0:min(rmax/2,1),:,:,:) = 0d0}
\DoxyCodeLine{139             \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{140               \textcolor{keywordflow}{do} n1=0,r}
\DoxyCodeLine{141                 \textcolor{keywordflow}{do} n2=0,r-\/n1}
\DoxyCodeLine{142                   n3=r-\/n1-\/n2}
\DoxyCodeLine{143                   cnt = cnt+1}
\DoxyCodeLine{144                   d(0,n1,n2,n3) = fct(cnt)}
\DoxyCodeLine{145 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{146 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{147               \textcolor{keywordflow}{do} n0=1,(r+1)/2}
\DoxyCodeLine{148                 \textcolor{keywordflow}{do} n1=0,r-\/2*n0+1}
\DoxyCodeLine{149                   \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1+1}
\DoxyCodeLine{150                     n3=r-\/2*n0-\/n1-\/n2+1}
\DoxyCodeLine{151  }
\DoxyCodeLine{152                     cnt = cnt+1}
\DoxyCodeLine{153                     d(n0,n1,n2,n3) = fct(cnt)}
\DoxyCodeLine{154 \textcolor{keywordflow}{                  end do}}
\DoxyCodeLine{155 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{156 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{157 }
\DoxyCodeLine{158               \textcolor{keywordflow}{do} n0=2,(r+1)/2}
\DoxyCodeLine{159                 \textcolor{keywordflow}{do} n1=0,r-\/2*n0+1}
\DoxyCodeLine{160                   \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1+1}
\DoxyCodeLine{161                     n3=r-\/2*n0-\/n1-\/n2+1}
\DoxyCodeLine{162  }
\DoxyCodeLine{163                     cnt = cnt+1}
\DoxyCodeLine{164                     duv(n0,n1,n2,n3) = fct(cnt)}
\DoxyCodeLine{165 \textcolor{keywordflow}{                  end do}}
\DoxyCodeLine{166 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{167 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{168               cnt = cnt+1}
\DoxyCodeLine{169               derr1(r) = real(fct(cnt))}
\DoxyCodeLine{170               cnt = cnt+1}
\DoxyCodeLine{171               derr2(r) = real(fct(cnt))}
\DoxyCodeLine{172 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{173 \textcolor{comment}{!            write(*,*) 'Dcache', id, rank, D(0,rank,0,0) }}
\DoxyCodeLine{174             \textcolor{keywordflow}{return}}
\DoxyCodeLine{175 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{176 }
\DoxyCodeLine{177 }
\DoxyCodeLine{178           \textcolor{keywordflow}{if}(rank.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{179 }
\DoxyCodeLine{180             \textcolor{keyword}{call }calcdred(d,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,rank,id,derr1,derr2)}
\DoxyCodeLine{181 \textcolor{comment}{!            write(*,*) 'Dcalc', id, rank, D(0,rank,0,0) }}
\DoxyCodeLine{182 }
\DoxyCodeLine{183             \textcolor{keywordflow}{if} (wrica) \textcolor{keywordflow}{then}}
\DoxyCodeLine{184               cnt = 0}
\DoxyCodeLine{185               \textcolor{keywordflow}{do} r=0,rank}
\DoxyCodeLine{186                 \textcolor{keywordflow}{do} n1=0,r}
\DoxyCodeLine{187                   \textcolor{keywordflow}{do} n2=0,r-\/n1}
\DoxyCodeLine{188                     n3 = r-\/n1-\/n2}
\DoxyCodeLine{189                     cnt = cnt+1}
\DoxyCodeLine{190                     fct(cnt) = d(0,n1,n2,n3)}
\DoxyCodeLine{191 \textcolor{keywordflow}{                  end do}}
\DoxyCodeLine{192 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{193                 \textcolor{keywordflow}{do} n0=1,(r+1)/2}
\DoxyCodeLine{194                   \textcolor{keywordflow}{do} n1=0,r-\/2*n0+1}
\DoxyCodeLine{195                     \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1+1}
\DoxyCodeLine{196                       n3 = r-\/2*n0-\/n1-\/n2+1}
\DoxyCodeLine{197                       cnt = cnt+1}
\DoxyCodeLine{198                       fct(cnt) = d(n0,n1,n2,n3)}
\DoxyCodeLine{199 \textcolor{keywordflow}{                    end do}}
\DoxyCodeLine{200 \textcolor{keywordflow}{                  end do}}
\DoxyCodeLine{201 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{202                 \textcolor{keywordflow}{do} n0=2,(r+1)/2}
\DoxyCodeLine{203                   \textcolor{keywordflow}{do} n1=0,r-\/2*n0+1}
\DoxyCodeLine{204                     \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1+1}
\DoxyCodeLine{205                       n3 = r-\/2*n0-\/n1-\/n2+1}
\DoxyCodeLine{206                       cnt = cnt+1}
\DoxyCodeLine{207                       fct(cnt) = duv(n0,n1,n2,n3)}
\DoxyCodeLine{208 \textcolor{keywordflow}{                    end do}}
\DoxyCodeLine{209 \textcolor{keywordflow}{                  end do}}
\DoxyCodeLine{210 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{211                 cnt = cnt+1}
\DoxyCodeLine{212                 fct(cnt) = derr1(r)}
\DoxyCodeLine{213                 cnt = cnt+1}
\DoxyCodeLine{214                 fct(cnt) = derr2(r)}
\DoxyCodeLine{215 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{216    }
\DoxyCodeLine{217               \textcolor{keywordflow}{if}(rank.ge.3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{218                 \textcolor{keyword}{call }writecache(fct,ncoefsg(rank,4)-\/ncoefs(rank-\/2,4)+ncoefs(rank-\/3,4)+2*(rank+1),id,4,rank)}
\DoxyCodeLine{219               \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(rank.eq.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{220                 \textcolor{keyword}{call }writecache(fct,ncoefsg(rank,4)-\/1+2*(rank+1),id,4,rank)}
\DoxyCodeLine{221               \textcolor{keywordflow}{else}}
\DoxyCodeLine{222                 \textcolor{keyword}{call }writecache(fct,ncoefsg(rank,4)+2*(rank+1),id,4,rank)}
\DoxyCodeLine{223 \textcolor{keywordflow}{              end if}            }
\DoxyCodeLine{224 }
\DoxyCodeLine{225 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{226 }
\DoxyCodeLine{227             \textcolor{keywordflow}{return}}
\DoxyCodeLine{228           }
\DoxyCodeLine{229           }
\DoxyCodeLine{230           \textcolor{keywordflow}{else}}
\DoxyCodeLine{231             \textcolor{keyword}{allocate}(daux(0:rank,0:rank,0:rank,0:rank))}
\DoxyCodeLine{232             \textcolor{keyword}{allocate}(duvaux(0:rank,0:rank,0:rank,0:rank))}
\DoxyCodeLine{233             \textcolor{keyword}{allocate}(derr1aux(0:rank))}
\DoxyCodeLine{234             \textcolor{keyword}{allocate}(derr2aux(0:rank))}
\DoxyCodeLine{235 }
\DoxyCodeLine{236             \textcolor{keyword}{call }calcdred(daux,duvaux,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,rank,id,derr1aux,derr2aux)}
\DoxyCodeLine{237 }
\DoxyCodeLine{238             \textcolor{keywordflow}{if} (wrica) \textcolor{keywordflow}{then}}
\DoxyCodeLine{239               cnt = 0}
\DoxyCodeLine{240               \textcolor{keyword}{deallocate}(fct)}
\DoxyCodeLine{241               \textcolor{keywordflow}{if}(rank.ge.3) \textcolor{keywordflow}{then} }
\DoxyCodeLine{242                 \textcolor{keyword}{allocate}(fct(ncoefsg(rank,4)-\/ncoefs(rank-\/2,4)+ncoefs(rank-\/3,4)+2*(rank+1)))}
\DoxyCodeLine{243               \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(rank.eq.2) \textcolor{keywordflow}{then} }
\DoxyCodeLine{244                 \textcolor{keyword}{allocate}(fct(ncoefsg(rank,4)-\/1+2*(rank+1)))}
\DoxyCodeLine{245               \textcolor{keywordflow}{else}}
\DoxyCodeLine{246                 \textcolor{keyword}{allocate}(fct(ncoefsg(rank,4)+2*(rank+1)))}
\DoxyCodeLine{247 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{248               \textcolor{keywordflow}{do} r=0,rank}
\DoxyCodeLine{249 \textcolor{comment}{!               do n0=0,r}}
\DoxyCodeLine{250                 \textcolor{keywordflow}{do} n0=0,r/2+1}
\DoxyCodeLine{251                   \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{252                     \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{253                       n3 = r-\/n0-\/n1-\/n2}
\DoxyCodeLine{254  }
\DoxyCodeLine{255                       cnt = cnt+1}
\DoxyCodeLine{256                       fct(cnt) = daux(n0,n1,n2,n3)}
\DoxyCodeLine{257 }
\DoxyCodeLine{258 \textcolor{keywordflow}{                    end do}}
\DoxyCodeLine{259 \textcolor{keywordflow}{                  end do}}
\DoxyCodeLine{260 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{261                 \textcolor{keywordflow}{do} n0=2,r/2+1}
\DoxyCodeLine{262                   \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{263                     \textcolor{keywordflow}{do} n2=0,r-\/n0-\/n1}
\DoxyCodeLine{264                       n3 = r-\/n0-\/n1-\/n2}
\DoxyCodeLine{265  }
\DoxyCodeLine{266                       cnt = cnt+1}
\DoxyCodeLine{267                       fct(cnt) = duvaux(n0,n1,n2,n3)}
\DoxyCodeLine{268 }
\DoxyCodeLine{269 \textcolor{keywordflow}{                    end do}}
\DoxyCodeLine{270 \textcolor{keywordflow}{                  end do}}
\DoxyCodeLine{271 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{272                 cnt = cnt+1}
\DoxyCodeLine{273                 fct(cnt) = derr1aux(r)}
\DoxyCodeLine{274                 cnt = cnt+1}
\DoxyCodeLine{275                 fct(cnt) = derr2aux(r)}
\DoxyCodeLine{276 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{277 }
\DoxyCodeLine{278               \textcolor{keywordflow}{if}(rank.ge.3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{279                 \textcolor{keyword}{call }writecache(fct,ncoefsg(rank,4)-\/ncoefs(rank-\/2,4)+ncoefs(rank-\/3,4)+2*(rank+1),id,4,rank)   }
\DoxyCodeLine{280               \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(rank.eq.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{281                 \textcolor{keyword}{call }writecache(fct,ncoefsg(rank,4)-\/1+2*(rank+1),id,4,rank)}
\DoxyCodeLine{282               \textcolor{keywordflow}{else}}
\DoxyCodeLine{283                 \textcolor{keyword}{call }writecache(fct,ncoefsg(rank,4)+2*(rank+1),id,4,rank)}
\DoxyCodeLine{284 \textcolor{keywordflow}{              end if}            }
\DoxyCodeLine{285 }
\DoxyCodeLine{286 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{287 }
\DoxyCodeLine{288             d = daux(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{289             duv = duvaux(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{290             derr1 = derr1aux(0:rmax)}
\DoxyCodeLine{291             derr2 = derr2aux(0:rmax)}
\DoxyCodeLine{292 }
\DoxyCodeLine{293             \textcolor{keyword}{deallocate}(daux)}
\DoxyCodeLine{294             \textcolor{keyword}{deallocate}(duvaux)}
\DoxyCodeLine{295             \textcolor{keyword}{deallocate}(derr1aux)}
\DoxyCodeLine{296             \textcolor{keyword}{deallocate}(derr2aux)}
\DoxyCodeLine{297 }
\DoxyCodeLine{298             \textcolor{keywordflow}{return}}
\DoxyCodeLine{299 }
\DoxyCodeLine{300 \textcolor{comment}{!          end if}}
\DoxyCodeLine{301 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{302 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{303 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{304       }
\DoxyCodeLine{305     \textcolor{keyword}{call }calcdred(d,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,rmax,id,derr1,derr2)}
\DoxyCodeLine{306 }
\DoxyCodeLine{307 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiond_acf7f142bd8cbb61437e15e31dedea77c}\label{namespacereductiond_acf7f142bd8cbb61437e15e31dedea77c}} 
\index{reductiond@{reductiond}!calcdg@{calcdg}}
\index{calcdg@{calcdg}!reductiond@{reductiond}}
\doxysubsubsection{\texorpdfstring{calcdg()}{calcdg()}}
{\footnotesize\ttfamily subroutine reductiond\+::calcdg (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{D,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Duv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{ordg\+\_\+min,  }\item[{integer, intent(in)}]{ordg\+\_\+max,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr2 }\end{DoxyParamCaption})}



Definition at line 4319 of file reduction\+D.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{4319   }
\DoxyCodeLine{4320     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobald}{globald}}}
\DoxyCodeLine{4321 }
\DoxyCodeLine{4322     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,ordg\_min,ordg\_max,id}
\DoxyCodeLine{4323     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p30,p20,p31,m02,m12,m22,m32}
\DoxyCodeLine{4324     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: D(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4325     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Duv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4326     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Derr(0:rmax),Derr2(0:rmax)}
\DoxyCodeLine{4327     \textcolor{keywordtype}{double complex} :: Zadjfj,Zadj2(4), Zadjkl, Xtilde}
\DoxyCodeLine{4328     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Dexpg(:,:,:,:,:), DuvExpg(:,:,:,:)}
\DoxyCodeLine{4329     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_0(:,:,:,:), Cuv\_0(:,:,:,:), Shat(:,:,:,:,:)}
\DoxyCodeLine{4330     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_i(:,:,:,:), Cuv\_i(:,:,:,:)}
\DoxyCodeLine{4331     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: D\_alt(:,:,:,:)}
\DoxyCodeLine{4332     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: Cerr\_i(:,:),Cerr2\_i(:,:)}
\DoxyCodeLine{4333     \textcolor{keywordtype}{double complex} :: Smod(3), Skl, DexpgAux}
\DoxyCodeLine{4334     \textcolor{keywordtype}{double complex} :: cC0f, elimminf2\_coli}
\DoxyCodeLine{4335     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err(:),Dij\_err(:),Cij\_err(:),acc\_req\_Cextra(:)}
\DoxyCodeLine{4336     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err2(:),Dij\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{4337     \textcolor{keywordtype}{double precision} :: maxDexpg(0:1,0:rmax+ordg\_min+1,0:ordg\_max),truncfacexp}
\DoxyCodeLine{4338     \textcolor{keywordtype}{integer} :: rmaxC,rmaxExp,gtrunc,r,n0,n1,n2,n3,k,l,i,j,m,n,g,rg}
\DoxyCodeLine{4339     \textcolor{keywordtype}{integer} :: inds0(3), inds(3), inds2(2,4)}
\DoxyCodeLine{4340     \textcolor{keywordtype}{integer} :: bin,nid(0:3)}
\DoxyCodeLine{4341     \textcolor{keywordtype}{logical} :: errorwriteflag}
\DoxyCodeLine{4342 }
\DoxyCodeLine{4343 \textcolor{preprocessor}{\#ifdef Dgtest}}
\DoxyCodeLine{4344 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg in, ord'},rmax,ordg\_min,ordg\_max}
\DoxyCodeLine{4345 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4346 \textcolor{preprocessor}{}}
\DoxyCodeLine{4347     \textcolor{comment}{! allocation of C functions}}
\DoxyCodeLine{4348     rmaxc = rmax + ordg\_min}
\DoxyCodeLine{4349     \textcolor{keyword}{allocate}(c\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{4350     \textcolor{keyword}{allocate}(cuv\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{4351     \textcolor{keyword}{allocate}(c\_i(0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{4352     \textcolor{keyword}{allocate}(cuv\_i(0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{4353     \textcolor{keyword}{allocate}(cerr\_i(0:rmaxc,0:3))}
\DoxyCodeLine{4354     \textcolor{keyword}{allocate}(cerr2\_i(0:rmaxc,0:3))}
\DoxyCodeLine{4355     \textcolor{keyword}{allocate}(acc\_req\_cextra(0:rmaxc))}
\DoxyCodeLine{4356     }
\DoxyCodeLine{4357     \textcolor{comment}{! determine binaries for C-\/coefficients}}
\DoxyCodeLine{4358     k=0}
\DoxyCodeLine{4359     bin = 1}
\DoxyCodeLine{4360     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.3)}
\DoxyCodeLine{4361       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4362         nid(k) = id+bin}
\DoxyCodeLine{4363         k = k+1}
\DoxyCodeLine{4364 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{4365       bin = 2*bin}
\DoxyCodeLine{4366 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{4367 }
\DoxyCodeLine{4368     \textcolor{comment}{! reduce required accuracy of higher rank C's that appear only in expansion by dividing}}
\DoxyCodeLine{4369     \textcolor{comment}{! by estimated suppression factors that are multiplied in expansion}}
\DoxyCodeLine{4370     acc\_req\_cextra(0:rmax) = acc\_req\_cind}
\DoxyCodeLine{4371     \textcolor{keywordflow}{if} (x\_g.ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4372       \textcolor{keywordflow}{do} r=rmax+1,rmaxc}
\DoxyCodeLine{4373         acc\_req\_cextra(r)= acc\_req\_cextra(r-\/1)/x\_g}
\DoxyCodeLine{4374 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4375     \textcolor{keywordflow}{else} \textcolor{comment}{! 10.07.2017}}
\DoxyCodeLine{4376        acc\_req\_cextra(rmax+1:rmaxc) = acc\_inf}
\DoxyCodeLine{4377 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4378 }
\DoxyCodeLine{4379     \textcolor{keyword}{call }calcc(c\_0(:,0,:,:),cuv\_0(:,0,:,:),p21,p32,p31,m12,m22,m32,rmaxc,nid(0),cerr\_i(:,0),cerr2\_i(:,0),rmax,acc\_req\_cextra)}
\DoxyCodeLine{4380     \textcolor{keyword}{call }calcc(c\_i(:,:,:,1),cuv\_i(:,:,:,1),p20,p32,p30,m02,m22,m32,rmaxc,nid(1),cerr\_i(:,1),cerr2\_i(:,1),rmax,acc\_req\_cextra)}
\DoxyCodeLine{4381     \textcolor{keyword}{call }calcc(c\_i(:,:,:,2),cuv\_i(:,:,:,2),p10,p31,p30,m02,m12,m32,rmaxc,nid(2),cerr\_i(:,2),cerr2\_i(:,2),rmax,acc\_req\_cextra)}
\DoxyCodeLine{4382     \textcolor{keyword}{call }calcc(c\_i(:,:,:,3),cuv\_i(:,:,:,3),p10,p21,p20,m02,m12,m22,rmaxc,nid(3),cerr\_i(:,3),cerr2\_i(:,3),rmax,acc\_req\_cextra)}
\DoxyCodeLine{4383 }
\DoxyCodeLine{4384     \textcolor{comment}{! shift of integration momentum in C\(\backslash\)\{0\}}}
\DoxyCodeLine{4385     \textcolor{keywordflow}{do} n1=1,rmaxc}
\DoxyCodeLine{4386       \textcolor{keywordflow}{do} n2=0,rmaxc-\/n1}
\DoxyCodeLine{4387         \textcolor{keywordflow}{do} n3=0,rmaxc-\/n1-\/n2}
\DoxyCodeLine{4388           n0 = (rmaxc-\/n1-\/n2-\/n3)}
\DoxyCodeLine{4389           c\_0(0:n0,n1,n2,n3) = -\/c\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{4390                             -\/c\_0(0:n0,n1-\/1,n2+1,n3)-\/c\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{4391           cuv\_0(0:n0,n1,n2,n3) = -\/cuv\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{4392                               -\/cuv\_0(0:n0,n1-\/1,n2+1,n3)-\/cuv\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{4393 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4394 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4395 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{4396 }
\DoxyCodeLine{4397 }
\DoxyCodeLine{4398     \textcolor{comment}{! calculate adjugated Gram matrix}}
\DoxyCodeLine{4399 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{4400 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{4401 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{4402 \textcolor{comment}{!    mm32 = elimminf2\_coli(m32)}}
\DoxyCodeLine{4403 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{4404 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{4405 \textcolor{comment}{!    q32  = elimminf2\_coli(p32)}}
\DoxyCodeLine{4406 \textcolor{comment}{!    q30  = elimminf2\_coli(p30)}}
\DoxyCodeLine{4407 \textcolor{comment}{!    q31  = elimminf2\_coli(p31)}}
\DoxyCodeLine{4408 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{4409 }
\DoxyCodeLine{4410 \textcolor{comment}{!    Z(1,1) = 2d0*q10}}
\DoxyCodeLine{4411 \textcolor{comment}{!    Z(2,1) = q10+q20-\/q21}}
\DoxyCodeLine{4412 \textcolor{comment}{!    Z(3,1) = q10+q30-\/q31}}
\DoxyCodeLine{4413 \textcolor{comment}{!    Z(1,2) = Z(2,1)}}
\DoxyCodeLine{4414 \textcolor{comment}{!    Z(2,2) = 2d0*q20}}
\DoxyCodeLine{4415 \textcolor{comment}{!    Z(3,2) = q20+q30-\/q32}}
\DoxyCodeLine{4416 \textcolor{comment}{!    Z(1,3) = Z(3,1)}}
\DoxyCodeLine{4417 \textcolor{comment}{!    Z(2,3) = Z(3,2)}}
\DoxyCodeLine{4418 \textcolor{comment}{!    Z(3,3) = 2d0*q30}}
\DoxyCodeLine{4419 }
\DoxyCodeLine{4420 \textcolor{comment}{!    q1q2 = (q10+q20-\/q21)}}
\DoxyCodeLine{4421 \textcolor{comment}{!    q1q3 = (q10+q30-\/q31)}}
\DoxyCodeLine{4422 \textcolor{comment}{!    q2q3 = (q20+q30-\/q32)}}
\DoxyCodeLine{4423 \textcolor{comment}{!    detZ = 8d0*q10*q30*q20+2D0*q1q2*q1q3*q2q3  \&}}
\DoxyCodeLine{4424 \textcolor{comment}{!     \&    -\/2d0*(q10*q2q3*q2q3+q20*q1q3*q1q3+q30*q1q2*q1q2)}}
\DoxyCodeLine{4425 }
\DoxyCodeLine{4426 \textcolor{comment}{!    Zadj(1,1) = (4d0*q30*q20-\/q2q3*q2q3)}}
\DoxyCodeLine{4427 \textcolor{comment}{!    Zadj(2,1) = (q1q3*q2q3-\/2d0*q30*q1q2)}}
\DoxyCodeLine{4428 \textcolor{comment}{!    Zadj(3,1) = (q1q2*q2q3-\/2d0*q20*q1q3)}}
\DoxyCodeLine{4429 \textcolor{comment}{!    Zadj(1,2) = Zadj(2,1)}}
\DoxyCodeLine{4430 \textcolor{comment}{!    Zadj(2,2) = (4d0*q10*q30-\/q1q3*q1q3)}}
\DoxyCodeLine{4431 \textcolor{comment}{!    Zadj(3,2) = (q1q2*q1q3-\/2d0*q10*q2q3)}}
\DoxyCodeLine{4432 \textcolor{comment}{!    Zadj(1,3) = Zadj(3,1)}}
\DoxyCodeLine{4433 \textcolor{comment}{!    Zadj(2,3) = Zadj(3,2)}}
\DoxyCodeLine{4434 \textcolor{comment}{!    Zadj(3,3) = (4d0*q10*q20-\/q1q2*q1q2)}}
\DoxyCodeLine{4435 \textcolor{comment}{!}}
\DoxyCodeLine{4436 \textcolor{comment}{!    f(1) = q10+mm02-\/mm12}}
\DoxyCodeLine{4437 \textcolor{comment}{!    f(2) = q20+mm02-\/mm22}}
\DoxyCodeLine{4438 \textcolor{comment}{!    f(3) = q30+mm02-\/mm32}}
\DoxyCodeLine{4439       }
\DoxyCodeLine{4440 \textcolor{comment}{!    Zadjf(1) = Zadj(1,1)*f(1)+Zadj(2,1)*f(2)+Zadj(3,1)*f(3)}}
\DoxyCodeLine{4441 \textcolor{comment}{!    Zadjf(2) = Zadj(1,2)*f(1)+Zadj(2,2)*f(2)+Zadj(3,2)*f(3)}}
\DoxyCodeLine{4442 \textcolor{comment}{!    Zadjf(3) = Zadj(1,3)*f(1)+Zadj(2,3)*f(2)+Zadj(3,3)*f(3)}}
\DoxyCodeLine{4443 }
\DoxyCodeLine{4444 }
\DoxyCodeLine{4445     \textcolor{comment}{! coefficients Shat defined in (5.13)}}
\DoxyCodeLine{4446     \textcolor{keyword}{allocate}(shat(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{4447 }
\DoxyCodeLine{4448     \textcolor{keywordflow}{do} r=0,rmaxc}
\DoxyCodeLine{4449       \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{4450         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{4451           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{4452             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{4453 }
\DoxyCodeLine{4454             shat(n0,n1,n2,n3,:) = -\/c\_0(n0,n1,n2,n3)}
\DoxyCodeLine{4455 }
\DoxyCodeLine{4456             \textcolor{keywordflow}{if}(n1.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4457               shat(n0,n1,n2,n3,1) = shat(n0,n1,n2,n3,1) + c\_i(n0,n2,n3,1)}
\DoxyCodeLine{4458 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4459 }
\DoxyCodeLine{4460             \textcolor{keywordflow}{if}(n2.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4461               shat(n0,n1,n2,n3,2) = shat(n0,n1,n2,n3,2) + c\_i(n0,n1,n3,2)}
\DoxyCodeLine{4462 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4463 }
\DoxyCodeLine{4464             \textcolor{keywordflow}{if}(n3.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4465               shat(n0,n1,n2,n3,3) = shat(n0,n1,n2,n3,3) + c\_i(n0,n1,n2,3)}
\DoxyCodeLine{4466 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4467 }
\DoxyCodeLine{4468 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4469 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4470 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4471 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{4472 }
\DoxyCodeLine{4473 }
\DoxyCodeLine{4474     \textcolor{comment}{! choose reduction formulas with biggest denominators}}
\DoxyCodeLine{4475     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)).ge.max(abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)),abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(3)))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4476       j = 1}
\DoxyCodeLine{4477     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)).ge.max(abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)),abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(3)))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4478       j = 2}
\DoxyCodeLine{4479     \textcolor{keywordflow}{else}}
\DoxyCodeLine{4480       j = 3}
\DoxyCodeLine{4481 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4482 }
\DoxyCodeLine{4483     \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = 0d0}
\DoxyCodeLine{4484     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1)).gt.\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4485       \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1))}
\DoxyCodeLine{4486       k = 1}
\DoxyCodeLine{4487       l = 1}
\DoxyCodeLine{4488       inds2 = reshape((/2,2,2,3,3,2,3,3/),shape(inds2))}
\DoxyCodeLine{4489       zadj2(1) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)}
\DoxyCodeLine{4490       zadj2(2) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)}
\DoxyCodeLine{4491       zadj2(3) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3)}
\DoxyCodeLine{4492       zadj2(4) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)}
\DoxyCodeLine{4493 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4494     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2)).gt.\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4495       \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2))}
\DoxyCodeLine{4496       k = 2}
\DoxyCodeLine{4497       l = 2}
\DoxyCodeLine{4498       inds2 = reshape((/1,1,1,3,3,1,3,3/),shape(inds2))}
\DoxyCodeLine{4499       zadj2(1) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)}
\DoxyCodeLine{4500       zadj2(2) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)}
\DoxyCodeLine{4501       zadj2(3) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,3)}
\DoxyCodeLine{4502       zadj2(4) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)}
\DoxyCodeLine{4503 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4504     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,3)).gt.\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4505       \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,3))}
\DoxyCodeLine{4506       k = 3}
\DoxyCodeLine{4507       l = 3}
\DoxyCodeLine{4508       inds2 = reshape((/1,1,1,2,2,1,2,2/),shape(inds2))}
\DoxyCodeLine{4509       zadj2(1) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)}
\DoxyCodeLine{4510       zadj2(2) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{4511       zadj2(3) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2)}
\DoxyCodeLine{4512       zadj2(4) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)}
\DoxyCodeLine{4513 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4514     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2)).gt.\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4515       \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2))}
\DoxyCodeLine{4516       k = 1}
\DoxyCodeLine{4517       l = 2}
\DoxyCodeLine{4518       inds2 = reshape((/2,1,2,3,3,1,3,3/),shape(inds2))}
\DoxyCodeLine{4519       zadj2(1) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)}
\DoxyCodeLine{4520       zadj2(2) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)}
\DoxyCodeLine{4521       zadj2(3) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3)}
\DoxyCodeLine{4522       zadj2(4) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{4523 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4524     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,3)).gt.\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4525       \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,3))}
\DoxyCodeLine{4526       k = 1}
\DoxyCodeLine{4527       l = 3}
\DoxyCodeLine{4528       inds2 = reshape((/2,1,2,2,3,1,3,2/),shape(inds2))}
\DoxyCodeLine{4529       zadj2(1) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)}
\DoxyCodeLine{4530       zadj2(2) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)}
\DoxyCodeLine{4531       zadj2(3) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)}
\DoxyCodeLine{4532       zadj2(4) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{4533 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4534     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,3)).gt.\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4535       k = 2}
\DoxyCodeLine{4536       l = 3}
\DoxyCodeLine{4537       inds2 = reshape((/1,1,1,2,3,1,3,2/),shape(inds2))}
\DoxyCodeLine{4538       zadj2(1) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)}
\DoxyCodeLine{4539       zadj2(2) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)}
\DoxyCodeLine{4540       zadj2(3) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2)}
\DoxyCodeLine{4541       zadj2(4) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)}
\DoxyCodeLine{4542 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4543 }
\DoxyCodeLine{4544     zadjfj = \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j)}
\DoxyCodeLine{4545     zadjkl = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)}
\DoxyCodeLine{4546     xtilde = \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(k,l)}
\DoxyCodeLine{4547 }
\DoxyCodeLine{4548 \textcolor{comment}{!    write(*,*) 'CalcDg Xtilde n',Xtilde,Xadj(1,1),Xadj(1,2),Xadj(2,2)}}
\DoxyCodeLine{4549 }
\DoxyCodeLine{4550 }
\DoxyCodeLine{4551     \textcolor{comment}{! allocation of array for det(Z)-\/expanded C-\/coefficients}}
\DoxyCodeLine{4552     rmaxexp = rmaxc+1}
\DoxyCodeLine{4553     \textcolor{keyword}{allocate}(dexpg(0:rmaxexp/2,0:rmaxexp,0:rmaxexp,0:rmaxexp,0:ordg\_max))}
\DoxyCodeLine{4554 }
\DoxyCodeLine{4555 }
\DoxyCodeLine{4556     \textcolor{comment}{! calculate Duv}}
\DoxyCodeLine{4557     \textcolor{keyword}{allocate}(duvexpg(0:rmaxexp,0:rmaxexp,0:rmaxexp,0:rmaxexp))}
\DoxyCodeLine{4558     \textcolor{keyword}{call }calcduv(duvexpg,cuv\_0,mm02,f,rmaxexp,id)}
\DoxyCodeLine{4559     duv(0:rmax,0:rmax,0:rmax,0:rmax) = duvexpg(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4560 }
\DoxyCodeLine{4561     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{4562     \textcolor{keyword}{allocate}(d00\_err(0:rmaxexp))}
\DoxyCodeLine{4563     \textcolor{keyword}{allocate}(dij\_err(0:rmaxexp))}
\DoxyCodeLine{4564     \textcolor{keyword}{allocate}(cij\_err(0:rmaxc))}
\DoxyCodeLine{4565      }
\DoxyCodeLine{4566     \textcolor{keyword}{allocate}(d00\_err2(0:rmaxexp))}
\DoxyCodeLine{4567     \textcolor{keyword}{allocate}(dij\_err2(0:rmaxexp))}
\DoxyCodeLine{4568     \textcolor{keyword}{allocate}(cij\_err2(0:rmaxc))}
\DoxyCodeLine{4569      }
\DoxyCodeLine{4570     \textcolor{comment}{! initialize accuracy estimates}}
\DoxyCodeLine{4571     derr = acc\_inf}
\DoxyCodeLine{4572     dij\_err =0d0}
\DoxyCodeLine{4573     d00\_err =0d0}
\DoxyCodeLine{4574     cij\_err = max(cerr\_i(:,0),cerr\_i(:,1),cerr\_i(:,2),cerr\_i(:,3))}
\DoxyCodeLine{4575 }
\DoxyCodeLine{4576     derr2 = acc\_inf}
\DoxyCodeLine{4577     dij\_err2 =0d0}
\DoxyCodeLine{4578     d00\_err2 =0d0}
\DoxyCodeLine{4579     cij\_err2 = max(cerr2\_i(:,0),cerr2\_i(:,1),cerr2\_i(:,2),cerr2\_i(:,3))}
\DoxyCodeLine{4580 }
\DoxyCodeLine{4581 \textcolor{preprocessor}{\#ifdef Dgtest}}
\DoxyCodeLine{4582 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg Cij\_err = '},cij\_err }
\DoxyCodeLine{4583     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg C0\_err = '}, cerr\_i(0,0),cerr\_i(0,1),cerr\_i(0,2),cerr\_i(0,3)}
\DoxyCodeLine{4584     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg C0 = '}, c\_0(0,0,0,0),c\_i(0,0,0,1),c\_i(0,0,0,2),c\_i(0,0,0,3)}
\DoxyCodeLine{4585 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4586 \textcolor{preprocessor}{}}
\DoxyCodeLine{4587 \textcolor{comment}{!    maxZadj = maxval(abs(Zadj))}}
\DoxyCodeLine{4588 \textcolor{comment}{!    maxZadj2f = maxval(abs(f(inds2(1,:))*Zadj2(:)))}}
\DoxyCodeLine{4589 }
\DoxyCodeLine{4590     \textcolor{comment}{! truncation of expansion if calculated term larger than truncfacexp * previous term}}
\DoxyCodeLine{4591     \textcolor{comment}{! crucial for expansion parameters between 0.1 and 1 !!!}}
\DoxyCodeLine{4592     truncfacexp = sqrt(\mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}}) * truncfacd}
\DoxyCodeLine{4593     gtrunc = ordg\_max }
\DoxyCodeLine{4594 }
\DoxyCodeLine{4595 \textcolor{comment}{! calculate D(n0,n1,n2,n3) up to rank r for n0>0 and up to rank r-\/1 for n0=0}}
\DoxyCodeLine{4596     rloop: \textcolor{keywordflow}{do} r=1,rmaxexp}
\DoxyCodeLine{4597 }
\DoxyCodeLine{4598 \textcolor{preprocessor}{\#ifdef Dgtest}}
\DoxyCodeLine{4599 \textcolor{preprocessor}{}\textcolor{comment}{!      write(*,*) 'CalcDg rloop',r,rmax,gtrunc}}
\DoxyCodeLine{4600 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4601 \textcolor{preprocessor}{}}
\DoxyCodeLine{4602       \textcolor{keywordflow}{if} (r.gt.rmax+gtrunc+1) \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{4603 }
\DoxyCodeLine{4604 \textcolor{preprocessor}{\#ifdef Dgtest}}
\DoxyCodeLine{4605 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg rloop'},r}
\DoxyCodeLine{4606 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4607 \textcolor{preprocessor}{}}
\DoxyCodeLine{4608       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{4609       \textcolor{comment}{! 0th-\/order coefficients}}
\DoxyCodeLine{4610       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{4611 }
\DoxyCodeLine{4612       \textcolor{comment}{! calculating}}
\DoxyCodeLine{4613       \textcolor{comment}{! D\_00(a)0000..00 -\/-\/> D\_00(a)ij00..00 -\/-\/> D\_00(a)ijkl00..00 -\/-\/> ... -\/-\/> D\_00(a)ijklmn..}}
\DoxyCodeLine{4614       \textcolor{comment}{! exploiting eq. (5.40)}}
\DoxyCodeLine{4615       maxdexpg(1,r,0)=0d0}
\DoxyCodeLine{4616       \textcolor{keywordflow}{do} n0=r/2,1,-\/1}
\DoxyCodeLine{4617         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{4618           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{4619             n3=r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{4620 }
\DoxyCodeLine{4621             inds0(1) = n1}
\DoxyCodeLine{4622             inds0(2) = n2}
\DoxyCodeLine{4623             inds0(3) = n3}
\DoxyCodeLine{4624 }
\DoxyCodeLine{4625             dexpgaux = 2d0*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)*c\_0(n0-\/1,n1,n2,n3)  \& }
\DoxyCodeLine{4626                      + xtilde*dexpg(n0-\/1,n1,n2,n3,0)  \&}
\DoxyCodeLine{4627                      + 4d0*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)*duvexpg(n0,n1,n2,n3)}
\DoxyCodeLine{4628 }
\DoxyCodeLine{4629             inds = inds0}
\DoxyCodeLine{4630             inds(k) = inds(k)+1}
\DoxyCodeLine{4631             \textcolor{keywordflow}{do} i=1,3}
\DoxyCodeLine{4632               dexpgaux = dexpgaux + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,l)*shat(n0-\/1,inds(1),inds(2),inds(3),i)}
\DoxyCodeLine{4633 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{4634 }
\DoxyCodeLine{4635             \textcolor{keywordflow}{do} i=1,3}
\DoxyCodeLine{4636               inds = inds0}
\DoxyCodeLine{4637               inds(i) = inds(i)+1}
\DoxyCodeLine{4638               dexpgaux = dexpgaux -\/ \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)*shat(n0-\/1,inds(1),inds(2),inds(3),i)}
\DoxyCodeLine{4639 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{4640 }
\DoxyCodeLine{4641             \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{4642               n = inds2(1,i)}
\DoxyCodeLine{4643               m = inds2(2,i)}
\DoxyCodeLine{4644 }
\DoxyCodeLine{4645               skl = f(n)*shat(n0-\/1,inds0(1),inds0(2),inds0(3),m)}
\DoxyCodeLine{4646 }
\DoxyCodeLine{4647               inds = inds0}
\DoxyCodeLine{4648               \textcolor{keywordflow}{if} (inds(m).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4649                 inds(m) = inds(m)-\/1}
\DoxyCodeLine{4650                 skl = skl -\/ 2d0*f(n)*inds0(m)*dexpg(n0,inds(1),inds(2),inds(3),0)}
\DoxyCodeLine{4651                 \textcolor{keywordflow}{if} (inds(n).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4652                   inds(n) = inds(n)-\/1}
\DoxyCodeLine{4653                   skl = skl -\/ 4d0*inds0(m)*(inds(n)+1)*dexpg(n0+1,inds(1),inds(2),inds(3),0)}
\DoxyCodeLine{4654 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{4655 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{4656               inds = inds0}
\DoxyCodeLine{4657               \textcolor{keywordflow}{if} (inds(n).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4658                 inds(n) = inds(n)-\/1}
\DoxyCodeLine{4659                 skl = skl + 2d0*inds0(n)*shat(n0,inds(1),inds(2),inds(3),m)  \&}
\DoxyCodeLine{4660                           -\/ 2d0*f(m)*inds0(n)*dexpg(n0,inds(1),inds(2),inds(3),0)}
\DoxyCodeLine{4661 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{4662 }
\DoxyCodeLine{4663               dexpgaux = dexpgaux -\/ zadj2(i)*skl}
\DoxyCodeLine{4664 }
\DoxyCodeLine{4665 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{4666 }
\DoxyCodeLine{4667             dexpg(n0,n1,n2,n3,0) = dexpgaux/(2d0*zadjkl)/(2d0*(r-\/n0))}
\DoxyCodeLine{4668 }
\DoxyCodeLine{4669             \textcolor{keywordflow}{if} (n0.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4670               maxdexpg(1,r,0) =  maxdexpg(1,r,0) + abs(dexpg(n0,n1,n2,n3,0) )}
\DoxyCodeLine{4671 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4672 }
\DoxyCodeLine{4673             \textcolor{keywordflow}{if} (r-\/n0.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4674               d(n0,n1,n2,n3) = dexpg(n0,n1,n2,n3,0)}
\DoxyCodeLine{4675 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4676 }
\DoxyCodeLine{4677 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4678 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4679 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4680 }
\DoxyCodeLine{4681       \textcolor{comment}{! calculate}}
\DoxyCodeLine{4682       \textcolor{comment}{! D\_00ijkl.. -\/-\/> D\_aijkl..}}
\DoxyCodeLine{4683       \textcolor{comment}{! exploiting eq. (5.38)}}
\DoxyCodeLine{4684       maxdexpg(0,r-\/1,0)=0d0}
\DoxyCodeLine{4685       \textcolor{keywordflow}{do} n1=0,r-\/1}
\DoxyCodeLine{4686         \textcolor{keywordflow}{do} n2=0,r-\/1-\/n1}
\DoxyCodeLine{4687           n3 = r-\/1-\/n1-\/n2}
\DoxyCodeLine{4688 }
\DoxyCodeLine{4689           smod = shat(0,n1,n2,n3,:)}
\DoxyCodeLine{4690           \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4691             smod(1) = smod(1) -\/ 2d0*n1*dexpg(1,n1-\/1,n2,n3,0)}
\DoxyCodeLine{4692 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4693           \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4694             smod(2) = smod(2) -\/ 2d0*n2*dexpg(1,n1,n2-\/1,n3,0)}
\DoxyCodeLine{4695 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4696           \textcolor{keywordflow}{if} (n3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4697             smod(3) = smod(3) -\/ 2d0*n3*dexpg(1,n1,n2,n3-\/1,0)}
\DoxyCodeLine{4698 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4699 }
\DoxyCodeLine{4700           dexpg(0,n1,n2,n3,0) = (\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1) +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2)  \&}
\DoxyCodeLine{4701                               +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,j)*smod(3))/zadjfj}
\DoxyCodeLine{4702           maxdexpg(0,r-\/1,0) =  maxdexpg(0,r-\/1,0) + abs(dexpg(0,n1,n2,n3,0))}
\DoxyCodeLine{4703           \textcolor{keywordflow}{if} (r.le.rmax+1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4704             d(0,n1,n2,n3) = dexpg(0,n1,n2,n3,0)}
\DoxyCodeLine{4705 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4706 }
\DoxyCodeLine{4707 }
\DoxyCodeLine{4708 \textcolor{preprocessor}{\#ifdef Dgtest}}
\DoxyCodeLine{4709 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(n0.eq.0.and.n1.eq.0.and.n2.eq.0.and.n3.eq.0) \textcolor{keywordflow}{then} }
\DoxyCodeLine{4710             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'D2(0,0,0,0)= '},0,d(n0,n1,n2,n3),\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}/zadjfj}
\DoxyCodeLine{4711 \textcolor{comment}{!            write(*,*) 'D2(0,0,0,0)= ',Smod}}
\DoxyCodeLine{4712 \textcolor{comment}{!            write(*,*) 'D2(0,0,0,0)= ',Zadj(1:3,j),Zadjfj}}
\DoxyCodeLine{4713 \textcolor{comment}{!            write(*,*) 'D2(0,0,0,0)= ',Zadj(1:3,j)/Zadjfj}}
\DoxyCodeLine{4714 \textcolor{comment}{!            write(*,*) 'D2(0,0,0,0)= ',Smod(1)*Zadj(1,j)/Zadjfj, \&}}
\DoxyCodeLine{4715 \textcolor{comment}{!               Smod(2)*Zadj(2,j)/Zadjfj, Smod(3)*Zadj(3,j)/Zadjfj}}
\DoxyCodeLine{4716 \textcolor{comment}{!            write(*,*) 'D2(0,0,0,0)= ',Smod(1)*Zadj(1,j)/Zadjfj+ \&}}
\DoxyCodeLine{4717 \textcolor{comment}{!               Smod(2)*Zadj(2,j)/Zadjfj+ Smod(3)*Zadj(3,j)/Zadjfj}}
\DoxyCodeLine{4718 \textcolor{comment}{!            write(*,*) 'D2(0,0,0,0)= ',Zadj(1:3,1),Zadjf(1)}}
\DoxyCodeLine{4719 \textcolor{comment}{!            write(*,*) 'D2(0,0,0,0)= ',Zadj(1:3,1)/Zadjf(1)}}
\DoxyCodeLine{4720 \textcolor{comment}{!            write(*,*) 'D2(0,0,0,0)= ',Smod(1)*Zadj(1,1)/Zadjf(1), \&}}
\DoxyCodeLine{4721 \textcolor{comment}{!               Smod(2)*Zadj(2,1)/Zadjfj, Smod(3)*Zadj(3,1)/Zadjf(1)}}
\DoxyCodeLine{4722 \textcolor{comment}{!             write(*,*) 'D2(0,0,0,0)= ',Smod(1)*Zadj(1,1)/Zadjf(1)+ \&}}
\DoxyCodeLine{4723 \textcolor{comment}{!               Smod(2)*Zadj(2,1)/Zadjfj+ Smod(3)*Zadj(3,1)/Zadjf(1)}}
\DoxyCodeLine{4724 \textcolor{comment}{!             write(*,*) 'D2(0,0,0,0)= ',Zadj(1:3,2),Zadjf(2)}}
\DoxyCodeLine{4725 \textcolor{comment}{!            write(*,*) 'D2(0,0,0,0)= ',Zadj(1:3,2)/Zadjf(2)}}
\DoxyCodeLine{4726 \textcolor{comment}{!            write(*,*) 'D2(0,0,0,0)= ',Smod(1)*Zadj(1,2)/Zadjf(2), \&}}
\DoxyCodeLine{4727 \textcolor{comment}{!               Smod(2)*Zadj(2,2)/Zadjfj, Smod(3)*Zadj(3,2)/Zadjf(2)}}
\DoxyCodeLine{4728 \textcolor{comment}{!            write(*,*) 'D2(0,0,0,0)= ',Smod(1)*Zadj(1,2)/Zadjf(2)+ \&}}
\DoxyCodeLine{4729 \textcolor{comment}{!               Smod(2)*Zadj(2,2)/Zadjfj+ Smod(3)*Zadj(3,2)/Zadjf(2)}}
\DoxyCodeLine{4730 \textcolor{comment}{!            write(*,*) 'D2(0,0,0,0)= ',Zadj(1:3,3),Zadjf(3)}}
\DoxyCodeLine{4731 \textcolor{comment}{!            write(*,*) 'D2(0,0,0,0)= ',Zadj(1:3,3)/Zadjf(3)}}
\DoxyCodeLine{4732 \textcolor{comment}{!            write(*,*) 'D2(0,0,0,0)= ',Smod(1)*Zadj(1,3)/Zadjf(3), \&}}
\DoxyCodeLine{4733 \textcolor{comment}{!               Smod(2)*Zadj(2,3)/Zadjfj, Smod(3)*Zadj(3,3)/Zadjf(3)}}
\DoxyCodeLine{4734 \textcolor{comment}{!            write(*,*) 'D2(0,0,0,0)= ',Smod(1)*Zadj(1,3)/Zadjf(3)+ \&}}
\DoxyCodeLine{4735 \textcolor{comment}{!               Smod(2)*Zadj(2,3)/Zadjfj+ Smod(3)*Zadj(3,3)/Zadjf(3)}}
\DoxyCodeLine{4736 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4737 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4738 \textcolor{preprocessor}{}}
\DoxyCodeLine{4739 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4740 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4741 }
\DoxyCodeLine{4742 \textcolor{preprocessor}{\#ifdef Dgtest}}
\DoxyCodeLine{4743 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg maxDexpg 0'},r-\/1, maxdexpg(0,r-\/1,0)}
\DoxyCodeLine{4744 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4745 \textcolor{preprocessor}{}}
\DoxyCodeLine{4746       \textcolor{keywordflow}{if}(r.le.rmax+1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4747 \textcolor{comment}{!       Derr(r-\/1) =  abs(detZ/Zadjfj)*maxDexpg(0,r-\/1,0)}}
\DoxyCodeLine{4748         derr(r-\/1) =  \mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}}*maxdexpg(0,r-\/1,0)}
\DoxyCodeLine{4749 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{4750 }
\DoxyCodeLine{4751 }
\DoxyCodeLine{4752       \textcolor{comment}{! error propagation from C's}}
\DoxyCodeLine{4753       \textcolor{keywordflow}{if}(r.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{4754         d00\_err(r) = max(cij\_err(r-\/1),cij\_err(r-\/2),        \&}
\DoxyCodeLine{4755             max(\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*cij\_err(r-\/1),maxzadj2f*cij\_err(r-\/2))/abs(zadjkl)) \&}
\DoxyCodeLine{4756             /(4*(r-\/1))}
\DoxyCodeLine{4757 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{4758       dij\_err(r-\/1)=\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(cij\_err(r-\/1),2*d00\_err(r))/abs(zadjfj)}
\DoxyCodeLine{4759 }
\DoxyCodeLine{4760       \textcolor{keywordflow}{if}(r.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{4761         d00\_err2(r) = max(cij\_err2(r-\/1),cij\_err2(r-\/2),        \&}
\DoxyCodeLine{4762             max(\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*cij\_err2(r-\/1),maxzadj2f*cij\_err2(r-\/2))/abs(zadjkl)) \&}
\DoxyCodeLine{4763             /(4*(r-\/1))}
\DoxyCodeLine{4764 }
\DoxyCodeLine{4765 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{4766       dij\_err2(r-\/1)=\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(cij\_err2(r-\/1),2*d00\_err2(r))/abs(zadjfj)}
\DoxyCodeLine{4767 }
\DoxyCodeLine{4768 }
\DoxyCodeLine{4769       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{4770       \textcolor{comment}{! higher order coefficients}}
\DoxyCodeLine{4771       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{4772 }
\DoxyCodeLine{4773       rg = r}
\DoxyCodeLine{4774       gloop: \textcolor{keywordflow}{do} g=1,min(gtrunc,r-\/1)}
\DoxyCodeLine{4775         rg = rg-\/1}
\DoxyCodeLine{4776 }
\DoxyCodeLine{4777 \textcolor{preprocessor}{\#ifdef  Dgtest}}
\DoxyCodeLine{4778 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'gloop '},g,rg}
\DoxyCodeLine{4779 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4780 \textcolor{preprocessor}{}}
\DoxyCodeLine{4781         \textcolor{comment}{! calculating}}
\DoxyCodeLine{4782         \textcolor{comment}{! D\_00(a)0000..00 -\/-\/> D\_00(a)ij00..00 -\/-\/> D\_00(a)ijkl00..00 -\/-\/> ... -\/-\/> D\_00(a)ijklmn..}}
\DoxyCodeLine{4783         \textcolor{comment}{! exploiting eq. (5.40)}}
\DoxyCodeLine{4784         maxdexpg(1,rg,g) = 0d0}
\DoxyCodeLine{4785         \textcolor{keywordflow}{do} n0=rg/2,1,-\/1}
\DoxyCodeLine{4786           \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{4787             \textcolor{keywordflow}{do} n2=0,rg-\/2*n0-\/n1}
\DoxyCodeLine{4788               n3=rg-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{4789 }
\DoxyCodeLine{4790               inds0(1) = n1}
\DoxyCodeLine{4791               inds0(2) = n2}
\DoxyCodeLine{4792               inds0(3) = n3}
\DoxyCodeLine{4793 }
\DoxyCodeLine{4794               inds = inds0}
\DoxyCodeLine{4795               inds(k) = inds(k)+1}
\DoxyCodeLine{4796               inds(l) = inds(l)+1}
\DoxyCodeLine{4797               dexpgaux = xtilde*dexpg(n0-\/1,n1,n2,n3,g)  \&}
\DoxyCodeLine{4798                        -\/ \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*dexpg(n0-\/1,inds(1),inds(2),inds(3),g-\/1)}
\DoxyCodeLine{4799 }
\DoxyCodeLine{4800 }
\DoxyCodeLine{4801               \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{4802                 n = inds2(1,i)}
\DoxyCodeLine{4803                 m = inds2(2,i)}
\DoxyCodeLine{4804 }
\DoxyCodeLine{4805                 skl = 0d0}
\DoxyCodeLine{4806 }
\DoxyCodeLine{4807                 inds = inds0}
\DoxyCodeLine{4808                 \textcolor{keywordflow}{if} (inds(m).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4809                   inds(m) = inds(m)-\/1}
\DoxyCodeLine{4810                   skl = skl -\/ 2d0*f(n)*inds0(m)*dexpg(n0,inds(1),inds(2),inds(3),g)}
\DoxyCodeLine{4811                   \textcolor{keywordflow}{if} (inds(n).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4812                     inds(n) = inds(n)-\/1}
\DoxyCodeLine{4813                     skl = skl -\/ 4d0*inds0(m)*(inds(n)+1)*dexpg(n0+1,inds(1),inds(2),inds(3),g)}
\DoxyCodeLine{4814 \textcolor{keywordflow}{                  end if}}
\DoxyCodeLine{4815 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{4816                 inds = inds0}
\DoxyCodeLine{4817                 \textcolor{keywordflow}{if} (inds(n).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4818                   inds(n) = inds(n)-\/1}
\DoxyCodeLine{4819                   skl = skl -\/ 2d0*f(m)*inds0(n)*dexpg(n0,inds(1),inds(2),inds(3),g)}
\DoxyCodeLine{4820 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{4821 }
\DoxyCodeLine{4822                 dexpgaux = dexpgaux -\/ zadj2(i)*skl}
\DoxyCodeLine{4823 }
\DoxyCodeLine{4824 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{4825 }
\DoxyCodeLine{4826               dexpg(n0,n1,n2,n3,g) = dexpgaux/(2d0*zadjkl)/(2d0*(rg-\/n0))}
\DoxyCodeLine{4827 }
\DoxyCodeLine{4828                }
\DoxyCodeLine{4829               \textcolor{keywordflow}{if}(n0.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4830                 maxdexpg(1,rg,g) =  maxdexpg(1,rg,g) + abs(dexpg(n0,n1,n2,n3,g))}
\DoxyCodeLine{4831 }
\DoxyCodeLine{4832                 \textcolor{keywordflow}{if} (g.eq.1.and.abs(dexpg(1,n1,n2,n3,g)).gt.            \&}
\DoxyCodeLine{4833                     truncfacexp*max(1/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}},maxdexpg(1,rg,g-\/1)) .or. \&}
\DoxyCodeLine{4834                     g.ge.2.and.abs(dexpg(1,n1,n2,n3,g)).gt.            \&}
\DoxyCodeLine{4835                     truncfacexp*maxdexpg(1,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4836 }
\DoxyCodeLine{4837 \textcolor{preprocessor}{\#ifdef Dgtest}}
\DoxyCodeLine{4838 \textcolor{preprocessor}{}                  \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg exit gloop'},n0,n1,n2,n3,g,abs(dexpg(n0,n1,n2,n3,g)),maxdexpg(1,rg,g-\/1),truncfacexp}
\DoxyCodeLine{4839 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{4840 \textcolor{preprocessor}{}}
\DoxyCodeLine{4841                   gtrunc = g-\/1}
\DoxyCodeLine{4842                   \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{4843 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{4844 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{4845 }
\DoxyCodeLine{4846 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{4847 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4848 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4849 }
\DoxyCodeLine{4850 \textcolor{preprocessor}{\#ifndef PPEXP00}}
\DoxyCodeLine{4851 \textcolor{preprocessor}{}        \textcolor{keywordflow}{do} n0=rg/2,1,-\/1}
\DoxyCodeLine{4852           \textcolor{keywordflow}{if} (rg-\/n0.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4853             \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{4854               \textcolor{keywordflow}{do} n2=0,rg-\/2*n0-\/n1}
\DoxyCodeLine{4855                 n3=rg-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{4856                 d(n0,n1,n2,n3) = d(n0,n1,n2,n3) + dexpg(n0,n1,n2,n3,g)}
\DoxyCodeLine{4857 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{4858 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{4859 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4860 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4861 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4862 \textcolor{preprocessor}{}\textcolor{comment}{!        write(*,*) 'CalcDg after it1 ',rg}}
\DoxyCodeLine{4863 }
\DoxyCodeLine{4864         \textcolor{comment}{! calculate}}
\DoxyCodeLine{4865         \textcolor{comment}{! D\_00ijkl.. -\/-\/> D\_aijkl..}}
\DoxyCodeLine{4866         \textcolor{comment}{! exploiting eq. (5.38)}}
\DoxyCodeLine{4867 }
\DoxyCodeLine{4868 \textcolor{comment}{!        write(*,*) 'CalcDg maxDexp',rg-\/1,g-\/1,maxDexpg(0,rg-\/1,g-\/1)}}
\DoxyCodeLine{4869 }
\DoxyCodeLine{4870         maxdexpg(0,rg-\/1,g) = 0d0}
\DoxyCodeLine{4871         \textcolor{keywordflow}{do} n1=0,rg-\/1}
\DoxyCodeLine{4872           \textcolor{keywordflow}{do} n2=0,rg-\/1-\/n1}
\DoxyCodeLine{4873             n3 = rg-\/1-\/n1-\/n2}
\DoxyCodeLine{4874 }
\DoxyCodeLine{4875             smod = 0d0}
\DoxyCodeLine{4876             \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4877               smod(1) = smod(1) -\/ 2d0*n1*dexpg(1,n1-\/1,n2,n3,g)}
\DoxyCodeLine{4878 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4879             \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4880               smod(2) = smod(2) -\/ 2d0*n2*dexpg(1,n1,n2-\/1,n3,g)}
\DoxyCodeLine{4881 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4882             \textcolor{keywordflow}{if} (n3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4883               smod(3) = smod(3) -\/ 2d0*n3*dexpg(1,n1,n2,n3-\/1,g)}
\DoxyCodeLine{4884 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4885 }
\DoxyCodeLine{4886             inds(1) = n1}
\DoxyCodeLine{4887             inds(2) = n2}
\DoxyCodeLine{4888             inds(3) = n3}
\DoxyCodeLine{4889             inds(j) = inds(j)+1}
\DoxyCodeLine{4890             dexpg(0,n1,n2,n3,g) = (\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1) +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2)  \&}
\DoxyCodeLine{4891                                 +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,j)*smod(3)  \&}
\DoxyCodeLine{4892                                 -\/ \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*dexpg(0,inds(1),inds(2),inds(3),g-\/1))/zadjfj}
\DoxyCodeLine{4893 }
\DoxyCodeLine{4894             maxdexpg(0,rg-\/1,g) =  maxdexpg(0,rg-\/1,g) + abs(dexpg(0,n1,n2,n3,g))}
\DoxyCodeLine{4895 }
\DoxyCodeLine{4896 \textcolor{comment}{!              if(n1.eq.0.and.n2.eq.1.and.n3.eq.2) then }}
\DoxyCodeLine{4897 \textcolor{comment}{!                write(*,*) 'D2(2,3,3)= ',g,Dexpg(0,n1,n2,n3,g)}}
\DoxyCodeLine{4898 \textcolor{comment}{!                write(*,*) 'D2(2,3,3)= ',Zadj(1,j)*Smod(1)/Zadjfj,  Zadj(2,j)*Smod(2)/Zadjfj,  \&}}
\DoxyCodeLine{4899 \textcolor{comment}{!                                +  Zadj(3,j)*Smod(3)/Zadjfj,  \&}}
\DoxyCodeLine{4900 \textcolor{comment}{!                                -\/ detZ*Dexpg(0,inds(1),inds(2),inds(3),g-\/1)/Zadjfj}}
\DoxyCodeLine{4901 \textcolor{comment}{!                write(*,*) 'D2(2,3,3)= ',inds(1),inds(2),inds(3),         \&}}
\DoxyCodeLine{4902 \textcolor{comment}{!                                -\/ detZ/Zadjfj,Dexpg(0,inds(1),inds(2),inds(3),g-\/1)}}
\DoxyCodeLine{4903 \textcolor{comment}{!              end if}}
\DoxyCodeLine{4904 }
\DoxyCodeLine{4905             \textcolor{keywordflow}{if} (g.eq.1.and.abs(dexpg(0,n1,n2,n3,g)).gt.                  \&}
\DoxyCodeLine{4906                 truncfacexp*max(1/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}**2,maxdexpg(0,rg-\/1,g-\/1)) .or.  \&}
\DoxyCodeLine{4907                 g.ge.2.and.abs(dexpg(0,n1,n2,n3,g)).gt.                  \&}
\DoxyCodeLine{4908                 truncfacexp*maxdexpg(0,rg-\/1,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4909 }
\DoxyCodeLine{4910 \textcolor{preprocessor}{\#ifdef Dgtest}}
\DoxyCodeLine{4911 \textcolor{preprocessor}{}                  \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg exit gloop'},0,n1,n2,n3,g,abs(dexpg(0,n1,n2,n3,g)),maxdexpg(0,rg-\/1,g-\/1),truncfacexp}
\DoxyCodeLine{4912 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{4913 \textcolor{preprocessor}{}              gtrunc = g-\/1}
\DoxyCodeLine{4914               \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{4915 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4916 }
\DoxyCodeLine{4917 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4918 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4919 }
\DoxyCodeLine{4920         \textcolor{comment}{! error propagation from C's}}
\DoxyCodeLine{4921         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{4922 \textcolor{comment}{!          D00\_err(rg) = max( D00\_err(rg),                                \&}}
\DoxyCodeLine{4923 \textcolor{comment}{!              max( abs(m02)*Dij\_err(rg-\/2),                               \&}}
\DoxyCodeLine{4924 \textcolor{comment}{!              max( abs(detZ)*Dij\_err(rg),abs(Xtilde)*Dij\_err(rg-\/2),      \&}}
\DoxyCodeLine{4925 \textcolor{comment}{!              maxZadj2f*D00\_err(rg-\/1) ) / abs(Zadjkl) )                  \&}}
\DoxyCodeLine{4926 \textcolor{comment}{!              /(4*(rg-\/1))   )}}
\DoxyCodeLine{4927 \textcolor{comment}{! 06.05.15 -\/>}}
\DoxyCodeLine{4928           d00\_err(rg) = max( d00\_err(rg),                                \&}
\DoxyCodeLine{4929               max( abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})*dij\_err(rg),abs(xtilde)*dij\_err(rg-\/2),      \&}
\DoxyCodeLine{4930               maxzadj2f*d00\_err(rg-\/1) ) / abs(zadjkl)                   \&}
\DoxyCodeLine{4931               /(4*(rg-\/1))   )}
\DoxyCodeLine{4932 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{4933         dij\_err(rg-\/1)=max(dij\_err(rg-\/1),                \&}
\DoxyCodeLine{4934             max(2*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*d00\_err(rg),abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})*dij\_err(rg))/abs(zadjfj) )}
\DoxyCodeLine{4935 }
\DoxyCodeLine{4936         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{4937           d00\_err2(rg) = max( d00\_err2(rg),                                \&}
\DoxyCodeLine{4938               max( abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})*dij\_err2(rg),abs(xtilde)*dij\_err2(rg-\/2),      \&}
\DoxyCodeLine{4939               maxzadj2f*d00\_err2(rg-\/1) ) / abs(zadjkl)                   \&}
\DoxyCodeLine{4940               /(4*(rg-\/1))   )}
\DoxyCodeLine{4941 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{4942         dij\_err2(rg-\/1)=max(dij\_err2(rg-\/1),                \&}
\DoxyCodeLine{4943             max(2*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*d00\_err2(rg),abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})*dij\_err2(rg))/abs(zadjfj) )}
\DoxyCodeLine{4944 }
\DoxyCodeLine{4945 \textcolor{preprocessor}{\#ifdef PPEXP00}}
\DoxyCodeLine{4946 \textcolor{preprocessor}{}        \textcolor{keywordflow}{do} n0=rg/2,1,-\/1}
\DoxyCodeLine{4947           \textcolor{keywordflow}{if} (rg-\/n0.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4948             \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{4949               \textcolor{keywordflow}{do} n2=0,rg-\/2*n0-\/n1}
\DoxyCodeLine{4950                 n3=rg-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{4951                 d(n0,n1,n2,n3) = d(n0,n1,n2,n3) + dexpg(n0,n1,n2,n3,g)}
\DoxyCodeLine{4952 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{4953 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{4954 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4955 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4956 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4957 \textcolor{preprocessor}{}\textcolor{comment}{!        write(*,*) 'CalcDg after it1 ',rg}}
\DoxyCodeLine{4958         \textcolor{keywordflow}{if} ((rg.le.rmax+1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4959           derr(rg-\/1) = 0d0}
\DoxyCodeLine{4960           \textcolor{keywordflow}{do} n1=0,rg-\/1}
\DoxyCodeLine{4961             \textcolor{keywordflow}{do} n2=0,rg-\/1-\/n1}
\DoxyCodeLine{4962               n3 = rg-\/1-\/n1-\/n2}
\DoxyCodeLine{4963               d(0,n1,n2,n3) = d(0,n1,n2,n3) + dexpg(0,n1,n2,n3,g)}
\DoxyCodeLine{4964 \textcolor{comment}{!              Derr(rg-\/1)=max(Derr(rg-\/1),abs(Dexpg(0,n1,n2,n3,g))**2/abs(Dexpg(0,n1,n2,n3,g-\/1)))}}
\DoxyCodeLine{4965               \textcolor{keywordflow}{if}(abs(dexpg(0,n1,n2,n3,g-\/1)).ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4966                 derr(rg-\/1)=max(derr(rg-\/1),abs(dexpg(0,n1,n2,n3,g))*min(1d0,abs(dexpg(0,n1,n2,n3,g))/abs(dexpg(0,n1,n2,n3,g-\/1))))}
\DoxyCodeLine{4967               \textcolor{keywordflow}{else}}
\DoxyCodeLine{4968                 derr(rg-\/1)=max(derr(rg-\/1),abs(dexpg(0,n1,n2,n3,g)))}
\DoxyCodeLine{4969 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{4970 }
\DoxyCodeLine{4971 \textcolor{preprocessor}{\#ifdef Dgtest}}
\DoxyCodeLine{4972 \textcolor{preprocessor}{}\textcolor{comment}{!              write(*,*) 'CalcDg Derr calc',rg-\/1,Derr(rg-\/1),n1,n2,n3,abs(Dexpg(0,n1,n2,n3,g)),abs(Dexpg(0,n1,n2,n3,g-\/1))}}
\DoxyCodeLine{4973 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4974 \textcolor{preprocessor}{}}
\DoxyCodeLine{4975 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{4976 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4977 }
\DoxyCodeLine{4978           \textcolor{comment}{! if error from C's larger than error from expansion stop expansion}}
\DoxyCodeLine{4979 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{4980 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(dij\_err2(rg-\/1).gt.3d0*derr(rg-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4981 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{4982 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(dij\_err(rg-\/1).gt.3d0*derr(rg-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4983 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4984 \textcolor{preprocessor}{}            gtrunc = min(g,gtrunc)}
\DoxyCodeLine{4985              }
\DoxyCodeLine{4986 \textcolor{preprocessor}{\#ifdef Dgtest}}
\DoxyCodeLine{4987 \textcolor{preprocessor}{}             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg exit err'},r,rg-\/1,g,gtrunc,dij\_err(rg-\/1),derr(rg-\/1)}
\DoxyCodeLine{4988 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4989 \textcolor{preprocessor}{}}
\DoxyCodeLine{4990 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4991 }
\DoxyCodeLine{4992 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{4993 }
\DoxyCodeLine{4994 \textcolor{keywordflow}{      end do} gloop}
\DoxyCodeLine{4995 }
\DoxyCodeLine{4996 \textcolor{preprocessor}{\#ifdef Dgtest}}
\DoxyCodeLine{4997 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(0,0,0,0) = '},r,d(0,0,0,0)}
\DoxyCodeLine{4998     \textcolor{keywordflow}{if}(r.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{4999 \textcolor{comment}{!      write(*,*) 'CalcDg D(0,1,0,0) = ',r,D(0,1,0,0)}}
\DoxyCodeLine{5000       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(0,0,1,0) = '},r,d(0,0,1,0)}
\DoxyCodeLine{5001 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{5002     \textcolor{keywordflow}{if}(r.gt.2.and.rmax.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{5003       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(1,0,0,0) = '},r,d(1,0,0,0)}
\DoxyCodeLine{5004       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(0,2,0,0) = '},r,d(0,2,0,0)}
\DoxyCodeLine{5005       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(0,0,1,1) = '},r,d(0,0,1,1)}
\DoxyCodeLine{5006 \textcolor{comment}{!      write(*,*) 'CalcDg D(0,1,1,0) = ',r,D(0,1,1,0)}}
\DoxyCodeLine{5007       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(0,0,2,0) = '},r,d(0,0,2,0)}
\DoxyCodeLine{5008 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{5009     \textcolor{keywordflow}{if}(r.gt.3.and.rmax.ge.3)\textcolor{keywordflow}{then}}
\DoxyCodeLine{5010       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(1,0,1,0) = '},r,d(1,0,1,0)}
\DoxyCodeLine{5011       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(1,1,0,0) = '},r,d(1,1,0,0)}
\DoxyCodeLine{5012       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(1,0,1,0) = '},r,d(1,0,1,0)}
\DoxyCodeLine{5013       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(1,0,0,1) = '},r,d(1,0,0,1)}
\DoxyCodeLine{5014 \textcolor{comment}{!      write(*,*) 'CalcDg D(1,2,0,0) = ',r,D(1,2,0,0)}}
\DoxyCodeLine{5015       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(0,3,0,0) = '},r,d(0,3,0,0)}
\DoxyCodeLine{5016       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(0,2,1,0) = '},r,d(0,2,1,0)}
\DoxyCodeLine{5017       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(0,2,0,1) = '},r,d(0,2,0,1)}
\DoxyCodeLine{5018       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(0,0,3,0) = '},r,d(0,0,3,0)}
\DoxyCodeLine{5019       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(0,1,1,1) = '},r,d(0,1,1,1)}
\DoxyCodeLine{5020       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(0,0,2,1) = '},r,d(0,0,2,1)}
\DoxyCodeLine{5021 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{5022       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg Dij\_err'},r,dij\_err}
\DoxyCodeLine{5023       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg Dij\_acc'},r,dij\_err/abs(d(0,0,0,0))}
\DoxyCodeLine{5024 }
\DoxyCodeLine{5025       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg err'},r,derr}
\DoxyCodeLine{5026       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg acc'},r,derr/abs(d(0,0,0,0))}
\DoxyCodeLine{5027 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5028 \textcolor{preprocessor}{}}
\DoxyCodeLine{5029       derr2 = max(derr,dij\_err2(0:rmax))}
\DoxyCodeLine{5030       derr = max(derr,dij\_err(0:rmax))}
\DoxyCodeLine{5031 }
\DoxyCodeLine{5032 \textcolor{preprocessor}{\#ifdef Dgtest}}
\DoxyCodeLine{5033 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg exit r'},r,maxval(derr),maxval(derr2),acc\_req\_d*abs(d(0,0,0,0))}
\DoxyCodeLine{5034 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5035 \textcolor{preprocessor}{}}
\DoxyCodeLine{5036 \textcolor{comment}{!     if(maxval(Derr).le.acc\_req\_D*abs(D(0,0,0,0))) exit   ! changed 28.01.15}}
\DoxyCodeLine{5037       \textcolor{comment}{! check if target precision already reached}}
\DoxyCodeLine{5038 \textcolor{preprocessor}{\#ifdef Cutrloop}}
\DoxyCodeLine{5039 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(derr-\/acc\_req\_d*abs(d(0,0,0,0))).le.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5040 }
\DoxyCodeLine{5041         \textcolor{keywordflow}{if} (r.lt.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5042           \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{5043 \textcolor{comment}{!          write(*,*) 'CalcDg exit rloop  =',rg,r,rmax}}
\DoxyCodeLine{5044             \textcolor{keywordflow}{do} n0=0,rg/2}
\DoxyCodeLine{5045               \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{5046                 \textcolor{keywordflow}{do} n2=0,rg-\/2*n0-\/n1}
\DoxyCodeLine{5047                   d(n0,n1,n2,rg-\/2*n0-\/n1-\/n2)=0d0}
\DoxyCodeLine{5048 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{5049 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{5050 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{5051 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{5052           \textcolor{keywordflow}{if}(r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5053             \textcolor{keywordflow}{do} n1=0,r}
\DoxyCodeLine{5054               \textcolor{keywordflow}{do} n2=0,r-\/n1}
\DoxyCodeLine{5055                 d(0,n1,n2,r-\/n1-\/n2)=0d0}
\DoxyCodeLine{5056 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{5057 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{5058 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{5059 }
\DoxyCodeLine{5060 100       \textcolor{keyword}{format}(((a)))}
\DoxyCodeLine{5061 111       \textcolor{keyword}{format}(a22,2(\textcolor{stringliteral}{'('},g24.17,\textcolor{stringliteral}{','},g24.17,\textcolor{stringliteral}{') '}:))}
\DoxyCodeLine{5062           \textcolor{keyword}{call }seterrflag\_coli(-\/5)}
\DoxyCodeLine{5063           \textcolor{keyword}{call }errout\_coli(\textcolor{stringliteral}{'CalcDg'},\textcolor{stringliteral}{' exit rloop for D'}, \&}
\DoxyCodeLine{5064           errorwriteflag)}
\DoxyCodeLine{5065           \textcolor{keywordflow}{if} (errorwriteflag) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5066             \textcolor{keyword}{write}(nerrout\_coli,100)\textcolor{stringliteral}{' CalcDg:  exit rloop for D '}, \&}
\DoxyCodeLine{5067             \textcolor{stringliteral}{'    should not appear'}}
\DoxyCodeLine{5068             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDg: p10 = '},p10}
\DoxyCodeLine{5069             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDg: p21 = '},p21}
\DoxyCodeLine{5070             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDg: p32 = '},p32}
\DoxyCodeLine{5071             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDg: p30 = '},p30}
\DoxyCodeLine{5072             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDg: p20 = '},p20}
\DoxyCodeLine{5073             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDg: p31 = '},p31}
\DoxyCodeLine{5074             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDg: m02 = '},m02}
\DoxyCodeLine{5075             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDg: m12 = '},m12}
\DoxyCodeLine{5076             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDg: m22 = '},m22}
\DoxyCodeLine{5077             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDg: m32 = '},m32}
\DoxyCodeLine{5078 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{5079 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{5080 }
\DoxyCodeLine{5081 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{5082 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(derr-\/acc\_req\_d*abs(d(0,0,0,0))).le.0d0.and.r.ge.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5083 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5084 \textcolor{preprocessor}{}        \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{5085 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{5086 }
\DoxyCodeLine{5087 \textcolor{keywordflow}{    end do} rloop}
\DoxyCodeLine{5088 }
\DoxyCodeLine{5089 }
\DoxyCodeLine{5090     \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2+N3=r, n0>=1 only!!!!!! }}
\DoxyCodeLine{5091     \textcolor{comment}{! already calculated for rmax+1}}
\DoxyCodeLine{5092 \textcolor{comment}{!    do r=rmax+1,2*rmax }}
\DoxyCodeLine{5093 \textcolor{preprocessor}{\#ifdef notneeded}}
\DoxyCodeLine{5094 \textcolor{preprocessor}{}    \textcolor{keywordflow}{do} r=rmax+1,rmax+1}
\DoxyCodeLine{5095       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{5096         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{5097           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{5098             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{5099 }
\DoxyCodeLine{5100             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg exp rmax+1'},r,n0,n1,n2,n3, d(n0,n1,n2,n3)}
\DoxyCodeLine{5101 }
\DoxyCodeLine{5102             d(n0,n1,n2,n3) = (c\_0(n0-\/1,n1,n2,n3) + 2*mm02*d(n0-\/1,n1,n2,n3)  \&}
\DoxyCodeLine{5103                 + 4*duv(n0,n1,n2,n3)  \&}
\DoxyCodeLine{5104                 + f(1)*d(n0-\/1,n1+1,n2,n3) + f(2)*d(n0-\/1,n1,n2+1,n3)  \&}
\DoxyCodeLine{5105                 + f(3)*d(n0-\/1,n1,n2,n3+1)) / (2*(r-\/1)) }
\DoxyCodeLine{5106 }
\DoxyCodeLine{5107             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg dir rmax+1'},r,n0,n1,n2,n3, d(n0,n1,n2,n3)}
\DoxyCodeLine{5108 }
\DoxyCodeLine{5109 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{5110 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{5111 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{5112 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{5113 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5114 \textcolor{preprocessor}{}}
\DoxyCodeLine{5115 \textcolor{preprocessor}{\#ifdef Dgtest}}
\DoxyCodeLine{5116 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(0,0,0,0) = '},d(0,0,0,0)}
\DoxyCodeLine{5117     \textcolor{keywordflow}{if}(rmax.ge.3)\textcolor{keywordflow}{then}}
\DoxyCodeLine{5118       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg D(1,0,1,0) = '},d(1,0,1,0)}
\DoxyCodeLine{5119 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{5120 }
\DoxyCodeLine{5121     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg final err '},derr}
\DoxyCodeLine{5122     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg final acc '},derr/abs(d(0,0,0,0))}
\DoxyCodeLine{5123     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg final err2'},derr2}
\DoxyCodeLine{5124     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDg final acc2'},derr2/abs(d(0,0,0,0))}
\DoxyCodeLine{5125 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{5126 \textcolor{preprocessor}{}       }
\DoxyCodeLine{5127 \textcolor{comment}{!    write(*,*) 'CalcDg Derr ',Derr}}
\DoxyCodeLine{5128 \textcolor{comment}{!    write(*,*) 'CalcDg Derr2',Derr2}}
\DoxyCodeLine{5129            }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiond_a8a603504b8bf40cf8e19483852f1cd58}\label{namespacereductiond_a8a603504b8bf40cf8e19483852f1cd58}} 
\index{reductiond@{reductiond}!calcdgp@{calcdgp}}
\index{calcdgp@{calcdgp}!reductiond@{reductiond}}
\doxysubsubsection{\texorpdfstring{calcdgp()}{calcdgp()}}
{\footnotesize\ttfamily subroutine reductiond\+::calcdgp (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{D,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Duv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{ordgp\+\_\+min,  }\item[{integer, intent(in)}]{ordgp\+\_\+max,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr2 }\end{DoxyParamCaption})}



Definition at line 8622 of file reduction\+D.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{8622   }
\DoxyCodeLine{8623     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobald}{globald}}}
\DoxyCodeLine{8624 }
\DoxyCodeLine{8625     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,ordgp\_min,ordgp\_max,id}
\DoxyCodeLine{8626     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p30,p20,p31,m02,m12,m22,m32}
\DoxyCodeLine{8627     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: D(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{8628     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Duv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{8629     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Derr(0:rmax),Derr2(0:rmax)}
\DoxyCodeLine{8630     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Dexpgp(:,:,:,:,:), DuvExpgp(:,:,:,:)}
\DoxyCodeLine{8631     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_0(:,:,:,:), Cuv\_0(:,:,:,:), Shat(:,:,:)}
\DoxyCodeLine{8632     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_k(:,:,:), Cuv\_k(:,:,:)}
\DoxyCodeLine{8633     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: D\_alt(:,:,:,:)}
\DoxyCodeLine{8634     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: Cerr\_i(:,:),Cerr2\_i(:,:)}
\DoxyCodeLine{8635     \textcolor{keywordtype}{double complex} :: Smod, fk, elimminf2\_coli}
\DoxyCodeLine{8636     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err(:),Dij\_err(:),Cij\_err(:),acc\_req\_Cextra(:)}
\DoxyCodeLine{8637     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err2(:),Dij\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{8638     \textcolor{keywordtype}{double precision} :: maxDexpgp(0:1,0:rmax+ordgp\_min+1,0:ordgp\_max),truncfacexp}
\DoxyCodeLine{8639     \textcolor{keywordtype}{integer} :: rmaxC,rmaxExp,gtrunc,r,n0,n1,n2,n3,k,l,g,rg}
\DoxyCodeLine{8640     \textcolor{keywordtype}{integer} :: bin,nid(0:3),i}
\DoxyCodeLine{8641     \textcolor{keywordtype}{logical} :: errorwriteflag}
\DoxyCodeLine{8642 }
\DoxyCodeLine{8643 \textcolor{preprocessor}{\#ifdef Dgtest}}
\DoxyCodeLine{8644 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp in, ord'},rmax,ordgp\_min,ordgp\_max}
\DoxyCodeLine{8645 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8646 \textcolor{preprocessor}{}\textcolor{comment}{!   write(*,*) 'CalcDgp in, ',rmax,ordgp\_min,ordgp\_max}}
\DoxyCodeLine{8647 }
\DoxyCodeLine{8648     \textcolor{comment}{! calculate adjugated Gram matrix}}
\DoxyCodeLine{8649 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{8650 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{8651 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{8652 \textcolor{comment}{!    mm32 = elimminf2\_coli(m32)}}
\DoxyCodeLine{8653 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{8654 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{8655 \textcolor{comment}{!    q32  = elimminf2\_coli(p32)}}
\DoxyCodeLine{8656 \textcolor{comment}{!    q30  = elimminf2\_coli(p30)}}
\DoxyCodeLine{8657 \textcolor{comment}{!    q31  = elimminf2\_coli(p31)}}
\DoxyCodeLine{8658 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{8659 \textcolor{comment}{!}}
\DoxyCodeLine{8660 \textcolor{comment}{!    Z(1,1) = 2d0*q10}}
\DoxyCodeLine{8661 \textcolor{comment}{!    Z(2,1) = q10+q20-\/q21}}
\DoxyCodeLine{8662 \textcolor{comment}{!    Z(3,1) = q10+q30-\/q31}}
\DoxyCodeLine{8663 \textcolor{comment}{!    Z(1,2) = Z(2,1)}}
\DoxyCodeLine{8664 \textcolor{comment}{!    Z(2,2) = 2d0*q20}}
\DoxyCodeLine{8665 \textcolor{comment}{!    Z(3,2) = q20+q30-\/q32}}
\DoxyCodeLine{8666 \textcolor{comment}{!    Z(1,3) = Z(3,1)}}
\DoxyCodeLine{8667 \textcolor{comment}{!    Z(2,3) = Z(3,2)}}
\DoxyCodeLine{8668 \textcolor{comment}{!    Z(3,3) = 2d0*q30}}
\DoxyCodeLine{8669 \textcolor{comment}{!}}
\DoxyCodeLine{8670 \textcolor{comment}{!    f(1) = q10+mm02-\/mm12}}
\DoxyCodeLine{8671 \textcolor{comment}{!    f(2) = q20+mm02-\/mm22}}
\DoxyCodeLine{8672 \textcolor{comment}{!    f(3) = q30+mm02-\/mm32}}
\DoxyCodeLine{8673       }
\DoxyCodeLine{8674 }
\DoxyCodeLine{8675     \textcolor{comment}{! choose reduction formulas with biggest denominators}}
\DoxyCodeLine{8676     \textcolor{keywordflow}{if} (abs(f(1)).ge.max(abs(f(2)),abs(f(3)))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8677       k = 1}
\DoxyCodeLine{8678     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (abs(f(2)).ge.max(abs(f(1)),abs(f(3)))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8679       k = 2}
\DoxyCodeLine{8680     \textcolor{keywordflow}{else}}
\DoxyCodeLine{8681       k = 3}
\DoxyCodeLine{8682 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{8683     fk = f(k)}
\DoxyCodeLine{8684 }
\DoxyCodeLine{8685 }
\DoxyCodeLine{8686     \textcolor{comment}{! allocation of C functions}}
\DoxyCodeLine{8687     rmaxc = rmax + ordgp\_min}
\DoxyCodeLine{8688     \textcolor{keyword}{allocate}(c\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{8689     \textcolor{keyword}{allocate}(cuv\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{8690     \textcolor{keyword}{allocate}(c\_k(0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{8691     \textcolor{keyword}{allocate}(cuv\_k(0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{8692     \textcolor{keyword}{allocate}(cerr\_i(0:rmaxc,0:3))}
\DoxyCodeLine{8693     \textcolor{keyword}{allocate}(cerr2\_i(0:rmaxc,0:3))}
\DoxyCodeLine{8694     \textcolor{keyword}{allocate}(acc\_req\_cextra(0:rmaxc))}
\DoxyCodeLine{8695 }
\DoxyCodeLine{8696     \textcolor{comment}{! determine binaries for C-\/coefficients}}
\DoxyCodeLine{8697     i=0}
\DoxyCodeLine{8698     bin = 1}
\DoxyCodeLine{8699     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (i.le.3)}
\DoxyCodeLine{8700       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8701         nid(i) = id+bin}
\DoxyCodeLine{8702         i = i+1}
\DoxyCodeLine{8703 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{8704       bin = 2*bin}
\DoxyCodeLine{8705 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{8706 }
\DoxyCodeLine{8707     \textcolor{comment}{! reduce required accuracy of higher rank C's that appear only in expansion by dividing}}
\DoxyCodeLine{8708     \textcolor{comment}{! by estimated suppression factors that are multiplied in expansion}}
\DoxyCodeLine{8709     acc\_req\_cextra(0:rmax) =  acc\_req\_cind}
\DoxyCodeLine{8710     \textcolor{keywordflow}{if}(w\_gp.ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8711       \textcolor{keywordflow}{do} r=rmax+1,rmaxc}
\DoxyCodeLine{8712         acc\_req\_cextra(r)= acc\_req\_cextra(r-\/1)/w\_gp}
\DoxyCodeLine{8713 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{8714     \textcolor{keywordflow}{else} \textcolor{comment}{! 10.07.2017}}
\DoxyCodeLine{8715       acc\_req\_cextra(rmax+1:rmaxc)=acc\_inf}
\DoxyCodeLine{8716 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{8717 }
\DoxyCodeLine{8718     \textcolor{keyword}{call }calcc(c\_0(:,0,:,:),cuv\_0(:,0,:,:),p21,p32,p31,m12,m22,m32,rmaxc,nid(0),cerr\_i(:,0),cerr2\_i(:,0),rmax,acc\_req\_cextra)}
\DoxyCodeLine{8719     \textcolor{keywordflow}{if} (k.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8720       \textcolor{keyword}{call }calcc(c\_k(:,:,:),cuv\_k(:,:,:),p20,p32,p30,m02,m22,m32,rmaxc,nid(1),cerr\_i(:,1),cerr2\_i(:,1),rmax,acc\_req\_cextra)}
\DoxyCodeLine{8721     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (k.eq.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8722       \textcolor{keyword}{call }calcc(c\_k(:,:,:),cuv\_k(:,:,:),p10,p31,p30,m02,m12,m32,rmaxc,nid(2),cerr\_i(:,2),cerr2\_i(:,2),rmax,acc\_req\_cextra)}
\DoxyCodeLine{8723     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (k.eq.3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8724       \textcolor{keyword}{call }calcc(c\_k(:,:,:),cuv\_k(:,:,:),p10,p21,p20,m02,m12,m22,rmaxc,nid(3),cerr\_i(:,3),cerr2\_i(:,3),rmax,acc\_req\_cextra)}
\DoxyCodeLine{8725 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{8726 }
\DoxyCodeLine{8727     \textcolor{comment}{! shift of integration momentum in C\(\backslash\)\{0\}}}
\DoxyCodeLine{8728     \textcolor{keywordflow}{do} n1=1,rmaxc}
\DoxyCodeLine{8729       \textcolor{keywordflow}{do} n2=0,rmaxc-\/n1}
\DoxyCodeLine{8730         \textcolor{keywordflow}{do} n3=0,rmaxc-\/n1-\/n2}
\DoxyCodeLine{8731           n0 = (rmaxc-\/n1-\/n2-\/n3)}
\DoxyCodeLine{8732           c\_0(0:n0,n1,n2,n3) = -\/c\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{8733                             -\/c\_0(0:n0,n1-\/1,n2+1,n3)-\/c\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{8734           cuv\_0(0:n0,n1,n2,n3) = -\/cuv\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{8735                               -\/cuv\_0(0:n0,n1-\/1,n2+1,n3)-\/cuv\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{8736 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8737 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{8738 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{8739 }
\DoxyCodeLine{8740 }
\DoxyCodeLine{8741     \textcolor{comment}{! coefficients Shat defined in (5.13)}}
\DoxyCodeLine{8742     \textcolor{keyword}{allocate}(shat(0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{8743 }
\DoxyCodeLine{8744     \textcolor{keywordflow}{do} r=0,rmaxc}
\DoxyCodeLine{8745       \textcolor{keywordflow}{do} n1=0,r}
\DoxyCodeLine{8746         \textcolor{keywordflow}{do} n2=0,r-\/n1}
\DoxyCodeLine{8747           n3 = r-\/n1-\/n2}
\DoxyCodeLine{8748 }
\DoxyCodeLine{8749           shat(n1,n2,n3) = -\/c\_0(0,n1,n2,n3)}
\DoxyCodeLine{8750 }
\DoxyCodeLine{8751           \textcolor{keywordflow}{if} ((k.eq.1).and.(n1.eq.0)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8752             shat(n1,n2,n3) = shat(n1,n2,n3) + c\_k(0,n2,n3)}
\DoxyCodeLine{8753           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((k.eq.2).and.(n2.eq.0)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8754             shat(n1,n2,n3) = shat(n1,n2,n3) + c\_k(0,n1,n3)}
\DoxyCodeLine{8755           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((k.eq.3).and.(n3.eq.0)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8756             shat(n1,n2,n3) = shat(n1,n2,n3) + c\_k(0,n1,n2)}
\DoxyCodeLine{8757 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{8758 }
\DoxyCodeLine{8759 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8760 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{8761 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{8762 }
\DoxyCodeLine{8763            }
\DoxyCodeLine{8764 }
\DoxyCodeLine{8765     \textcolor{comment}{! allocation of array for det(Z)-\/expanded C-\/coefficients}}
\DoxyCodeLine{8766     rmaxexp = rmaxc+1}
\DoxyCodeLine{8767     \textcolor{keyword}{allocate}(dexpgp(0:rmaxexp/2,0:rmaxexp,0:rmaxexp,0:rmaxexp,0:ordgp\_max))}
\DoxyCodeLine{8768 }
\DoxyCodeLine{8769     \textcolor{comment}{! calculate Duv}}
\DoxyCodeLine{8770     \textcolor{keyword}{allocate}(duvexpgp(0:rmaxexp,0:rmaxexp,0:rmaxexp,0:rmaxexp))}
\DoxyCodeLine{8771     \textcolor{keyword}{call }calcduv(duvexpgp,cuv\_0,mm02,f,rmaxexp,id)}
\DoxyCodeLine{8772     duv(0:rmax,0:rmax,0:rmax,0:rmax) = duvexpgp(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{8773 }
\DoxyCodeLine{8774     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{8775     \textcolor{keyword}{allocate}(d00\_err(0:rmaxexp))}
\DoxyCodeLine{8776     \textcolor{keyword}{allocate}(dij\_err(0:rmaxexp))}
\DoxyCodeLine{8777     \textcolor{keyword}{allocate}(cij\_err(0:rmaxc))}
\DoxyCodeLine{8778 }
\DoxyCodeLine{8779     \textcolor{keyword}{allocate}(d00\_err2(0:rmaxexp))}
\DoxyCodeLine{8780     \textcolor{keyword}{allocate}(dij\_err2(0:rmaxexp))}
\DoxyCodeLine{8781     \textcolor{keyword}{allocate}(cij\_err2(0:rmaxc))}
\DoxyCodeLine{8782 }
\DoxyCodeLine{8783     \textcolor{comment}{! initialize accuracy estimates}}
\DoxyCodeLine{8784     derr = acc\_inf}
\DoxyCodeLine{8785     dij\_err =0d0}
\DoxyCodeLine{8786     d00\_err =0d0}
\DoxyCodeLine{8787 }
\DoxyCodeLine{8788     derr2 = acc\_inf}
\DoxyCodeLine{8789     dij\_err2 =0d0}
\DoxyCodeLine{8790     d00\_err2 =0d0}
\DoxyCodeLine{8791 }
\DoxyCodeLine{8792 \textcolor{comment}{!   write(*,*) 'Dgp Cerr 0 ',Cerr\_i(:,0)}}
\DoxyCodeLine{8793 \textcolor{comment}{!   write(*,*) 'Dgp Cerr k ',Cerr\_i(:,k)}}
\DoxyCodeLine{8794 }
\DoxyCodeLine{8795     cij\_err = max(cerr\_i(:,0),cerr\_i(:,k))}
\DoxyCodeLine{8796     cij\_err2 = max(cerr2\_i(:,0),cerr2\_i(:,k))}
\DoxyCodeLine{8797 }
\DoxyCodeLine{8798 \textcolor{comment}{!    maxZ = maxval(abs(Z))}}
\DoxyCodeLine{8799 \textcolor{comment}{!    maxZ=2d0*q2max }}
\DoxyCodeLine{8800 }
\DoxyCodeLine{8801     \textcolor{comment}{! truncation of expansion if calculated term larger than truncfacexp * previous term}}
\DoxyCodeLine{8802     \textcolor{comment}{! crucial for expansion parameters between 0.1 and 1 !!!}}
\DoxyCodeLine{8803 \textcolor{comment}{!    truncfacexp = sqrt(abs(maxZ/abs(fk))) * truncfacD}}
\DoxyCodeLine{8804     truncfacexp = sqrt(\mbox{\hyperlink{namespaceglobalc_ac6e3d986b3c7aa2041225441a07dddb6}{fac\_gp}}) * truncfacd}
\DoxyCodeLine{8805     gtrunc = ordgp\_max }
\DoxyCodeLine{8806 }
\DoxyCodeLine{8807 \textcolor{comment}{! calculate D(n0,n1,n2,n3) up to rank r for n0>0 and up to rank r-\/1 for n0=0}}
\DoxyCodeLine{8808     rloop: \textcolor{keywordflow}{do} r=1,rmaxexp}
\DoxyCodeLine{8809 }
\DoxyCodeLine{8810       \textcolor{keywordflow}{if} (r.gt.rmax+gtrunc+1) \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{8811 }
\DoxyCodeLine{8812       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{8813       \textcolor{comment}{! 0th-\/order coefficients}}
\DoxyCodeLine{8814       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{8815 }
\DoxyCodeLine{8816       \textcolor{comment}{! calculating}}
\DoxyCodeLine{8817       \textcolor{comment}{! D\_00(a)0000..00 -\/-\/> D\_00(a)ij00..00 -\/-\/> D\_00(a)ijkl00..00 -\/-\/> ... -\/-\/> D\_00(a)ijklmn..}}
\DoxyCodeLine{8818       \textcolor{comment}{! exploiting eq. (5.63)}}
\DoxyCodeLine{8819       maxdexpgp(1,r,0)=0d0}
\DoxyCodeLine{8820       \textcolor{keywordflow}{do} n0=r/2,1,-\/1}
\DoxyCodeLine{8821         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{8822           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{8823             n3=r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{8824 }
\DoxyCodeLine{8825             dexpgp(n0,n1,n2,n3,0) = (2d0*duvexpgp(n0,n1,n2,n3) + c\_0(n0-\/1,n1,n2,n3)  \&}
\DoxyCodeLine{8826                + mm02*dexpgp(n0-\/1,n1,n2,n3,0))/((r-\/n0)+1)/2d0}
\DoxyCodeLine{8827 }
\DoxyCodeLine{8828             \textcolor{keywordflow}{if} (n0.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8829               maxdexpgp(1,r,0) =  maxdexpgp(1,r,0) + abs(dexpgp(n0,n1,n2,n3,0) )}
\DoxyCodeLine{8830 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{8831 }
\DoxyCodeLine{8832             \textcolor{keywordflow}{if} (r-\/n0.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8833               d(n0,n1,n2,n3) = dexpgp(n0,n1,n2,n3,0)}
\DoxyCodeLine{8834 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{8835 }
\DoxyCodeLine{8836 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8837 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8838 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{8839 }
\DoxyCodeLine{8840 \textcolor{preprocessor}{\#ifdef Dgptest      }}
\DoxyCodeLine{8841 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp 0 D(1,0,1,0)= '},r,d(1,0,1,0)}
\DoxyCodeLine{8842 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8843 \textcolor{preprocessor}{}}
\DoxyCodeLine{8844 }
\DoxyCodeLine{8845       \textcolor{comment}{! calculate}}
\DoxyCodeLine{8846       \textcolor{comment}{! D\_00ijkl.. -\/-\/> D\_aijkl..}}
\DoxyCodeLine{8847       \textcolor{comment}{! exploiting eq. (5.62)}}
\DoxyCodeLine{8848       maxdexpgp(0,r-\/1,0)=0d0}
\DoxyCodeLine{8849       \textcolor{keywordflow}{do} n1=0,r-\/1}
\DoxyCodeLine{8850         \textcolor{keywordflow}{do} n2=0,r-\/1-\/n1}
\DoxyCodeLine{8851           n3 = r-\/1-\/n1-\/n2}
\DoxyCodeLine{8852 }
\DoxyCodeLine{8853           smod = shat(n1,n2,n3)}
\DoxyCodeLine{8854           \textcolor{keywordflow}{if} ((k.eq.1).and.(n1.ge.1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8855             smod = smod -\/ 2d0*n1*dexpgp(1,n1-\/1,n2,n3,0)}
\DoxyCodeLine{8856           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((k.eq.2).and.(n2.ge.1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8857             smod = smod -\/ 2d0*n2*dexpgp(1,n1,n2-\/1,n3,0)}
\DoxyCodeLine{8858           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((k.eq.3).and.(n3.ge.1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8859             smod = smod -\/ 2d0*n3*dexpgp(1,n1,n2,n3-\/1,0)}
\DoxyCodeLine{8860 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{8861 }
\DoxyCodeLine{8862           dexpgp(0,n1,n2,n3,0) = smod/fk}
\DoxyCodeLine{8863           maxdexpgp(0,r-\/1,0) =  maxdexpgp(0,r-\/1,0) + abs(dexpgp(0,n1,n2,n3,0))}
\DoxyCodeLine{8864         }
\DoxyCodeLine{8865           \textcolor{keywordflow}{if} (r.le.rmax+1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8866             d(0,n1,n2,n3) = dexpgp(0,n1,n2,n3,0)}
\DoxyCodeLine{8867 \textcolor{comment}{!            Derr(r-\/1) =  abs(maxZ/fk*Dexpgp(0,n1,n2,n3,0))}}
\DoxyCodeLine{8868 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{8869 }
\DoxyCodeLine{8870 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8871 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{8872    }
\DoxyCodeLine{8873       \textcolor{keywordflow}{if} (r.le.rmax+1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8874 \textcolor{comment}{!       Derr(r-\/1) =  abs(maxZ/fk)*maxDexpgp(0,r-\/1,0)}}
\DoxyCodeLine{8875         derr(r-\/1) =  \mbox{\hyperlink{namespaceglobalc_ac6e3d986b3c7aa2041225441a07dddb6}{fac\_gp}}*maxdexpgp(0,r-\/1,0)}
\DoxyCodeLine{8876 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{8877  }
\DoxyCodeLine{8878       \textcolor{comment}{! error propagation from C's}}
\DoxyCodeLine{8879       \textcolor{keywordflow}{if}(r.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{8880         d00\_err(r) = cij\_err(r-\/2)/(2*r)}
\DoxyCodeLine{8881 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{8882       dij\_err(r-\/1)=max(cij\_err(r-\/1),2*d00\_err(r))/abs(fk)}
\DoxyCodeLine{8883 }
\DoxyCodeLine{8884       \textcolor{keywordflow}{if}(r.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{8885         d00\_err2(r) = cij\_err2(r-\/2)/(2*r)}
\DoxyCodeLine{8886 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{8887       dij\_err2(r-\/1)=max(cij\_err2(r-\/1),2*d00\_err2(r))/abs(fk)}
\DoxyCodeLine{8888 }
\DoxyCodeLine{8889       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{8890       \textcolor{comment}{! higher order coefficients}}
\DoxyCodeLine{8891       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{8892 }
\DoxyCodeLine{8893       rg = r}
\DoxyCodeLine{8894       gloop: \textcolor{keywordflow}{do} g=1,min(gtrunc,r-\/1)}
\DoxyCodeLine{8895         rg = rg-\/1}
\DoxyCodeLine{8896 }
\DoxyCodeLine{8897         \textcolor{comment}{! calculating}}
\DoxyCodeLine{8898         \textcolor{comment}{! D\_00(a)0000..00 -\/-\/> D\_00(a)ij00..00 -\/-\/> D\_00(a)ijkl00..00 -\/-\/> ... -\/-\/> D\_00(a)ijklmn..}}
\DoxyCodeLine{8899         \textcolor{comment}{! exploiting eq. (5.63)}}
\DoxyCodeLine{8900         maxdexpgp(1,rg,g) = 0d0}
\DoxyCodeLine{8901         \textcolor{keywordflow}{do} n0=rg/2,1,-\/1}
\DoxyCodeLine{8902           \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{8903             \textcolor{keywordflow}{do} n2=0,rg-\/2*n0-\/n1}
\DoxyCodeLine{8904               n3=rg-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{8905 }
\DoxyCodeLine{8906               dexpgp(n0,n1,n2,n3,g) = (2d0*mm02*dexpgp(n0-\/1,n1,n2,n3,g)  \&}
\DoxyCodeLine{8907                -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)*dexpgp(n0-\/1,n1+2,n2,n3,g-\/1) -\/ 2d0*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)*dexpgp(n0-\/1,n1+1,n2+1,n3,g-\/1)  \&}
\DoxyCodeLine{8908                -\/ 2d0*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)*dexpgp(n0-\/1,n1+1,n2,n3+1,g-\/1) -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)*dexpgp(n0-\/1,n1,n2+2,n3,g-\/1)  \&}
\DoxyCodeLine{8909                -\/ 2d0*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)*dexpgp(n0-\/1,n1,n2+1,n3+1,g-\/1) -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)*dexpgp(n0-\/1,n1,n2,n3+2,g-\/1))  \&}
\DoxyCodeLine{8910                /((rg-\/n0)+1d0)/4d0}
\DoxyCodeLine{8911 }
\DoxyCodeLine{8912               \textcolor{keywordflow}{if}(n0.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8913                 maxdexpgp(1,rg,g) =  maxdexpgp(1,rg,g) + abs(dexpgp(n0,n1,n2,n3,g))}
\DoxyCodeLine{8914 }
\DoxyCodeLine{8915 \textcolor{preprocessor}{\#ifdef Dgptest}}
\DoxyCodeLine{8916 \textcolor{preprocessor}{}                \textcolor{keywordflow}{if}(n0.eq.1.and.n1.eq.0.and.n2.eq.1.and.n3.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8917                   \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp  Dexp(1,0,1,0,g)'},r,rg,g,dexpgp(1,0,1,0,g)}
\DoxyCodeLine{8918                   \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp  D(1,0,1,0)'},r,rg,g,d(1,0,1,0)}
\DoxyCodeLine{8919                   \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp  maxDexpgp(1,rg,g)'},r,rg,g,maxdexpgp(1,rg,g)}
\DoxyCodeLine{8920                   \textcolor{keywordflow}{if}(g.gt.0) \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp  trunc'},abs(dexpgp(n0,n1,n2,n3,g)),   \&}
\DoxyCodeLine{8921                       truncfacexp*maxdexpgp(1,rg,g-\/1),truncfacexp,maxdexpgp(1,rg,g-\/1)}
\DoxyCodeLine{8922 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{8923 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8924 \textcolor{preprocessor}{}}
\DoxyCodeLine{8925                 \textcolor{keywordflow}{if} (g.eq.1.and.abs(dexpgp(1,n1,n2,n3,g)).gt.            \&}
\DoxyCodeLine{8926                     truncfacexp*max(1/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}},maxdexpgp(1,rg,g-\/1)) .or. \&}
\DoxyCodeLine{8927                     g.ge.2.and.abs(dexpgp(1,n1,n2,n3,g)).gt.            \&}
\DoxyCodeLine{8928                     truncfacexp*maxdexpgp(1,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8929 }
\DoxyCodeLine{8930                   gtrunc = g-\/1}
\DoxyCodeLine{8931                   \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{8932 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{8933 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{8934 }
\DoxyCodeLine{8935 }
\DoxyCodeLine{8936 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{8937 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8938 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8939 }
\DoxyCodeLine{8940 \textcolor{preprocessor}{\#ifndef PPEXP00}}
\DoxyCodeLine{8941 \textcolor{preprocessor}{}        \textcolor{keywordflow}{do} n0=rg/2,1,-\/1}
\DoxyCodeLine{8942           \textcolor{keywordflow}{if} (rg-\/n0.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8943             \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{8944               \textcolor{keywordflow}{do} n2=0,rg-\/2*n0-\/n1}
\DoxyCodeLine{8945                 n3=rg-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{8946                 d(n0,n1,n2,n3) = d(n0,n1,n2,n3) + dexpgp(n0,n1,n2,n3,g)}
\DoxyCodeLine{8947 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{8948 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{8949 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{8950 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8951 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8952 \textcolor{preprocessor}{}}
\DoxyCodeLine{8953         \textcolor{comment}{! calculate}}
\DoxyCodeLine{8954         \textcolor{comment}{! D\_00ijkl.. -\/-\/> D\_aijkl..}}
\DoxyCodeLine{8955         \textcolor{comment}{! exploiting eq. (5.62)}}
\DoxyCodeLine{8956         maxdexpgp(0,rg-\/1,g) = 0d0}
\DoxyCodeLine{8957         \textcolor{keywordflow}{do} n1=0,rg-\/1}
\DoxyCodeLine{8958           \textcolor{keywordflow}{do} n2=0,rg-\/1-\/n1}
\DoxyCodeLine{8959             n3 = rg-\/1-\/n1-\/n2}
\DoxyCodeLine{8960 }
\DoxyCodeLine{8961             smod = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,k)*dexpgp(0,n1+1,n2,n3,g-\/1)  \&}
\DoxyCodeLine{8962                    -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,k)*dexpgp(0,n1,n2+1,n3,g-\/1)  \&}
\DoxyCodeLine{8963                    -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,k)*dexpgp(0,n1,n2,n3+1,g-\/1)}
\DoxyCodeLine{8964             \textcolor{keywordflow}{if} ((k.eq.1).and.(n1.ge.1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8965               smod = smod -\/ 2d0*n1*dexpgp(1,n1-\/1,n2,n3,g)}
\DoxyCodeLine{8966             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((k.eq.2).and.(n2.ge.1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8967               smod = smod -\/ 2d0*n2*dexpgp(1,n1,n2-\/1,n3,g)}
\DoxyCodeLine{8968             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((k.eq.3).and.(n3.ge.1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8969               smod = smod -\/ 2d0*n3*dexpgp(1,n1,n2,n3-\/1,g)}
\DoxyCodeLine{8970 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{8971 }
\DoxyCodeLine{8972             dexpgp(0,n1,n2,n3,g) = smod/fk}
\DoxyCodeLine{8973         }
\DoxyCodeLine{8974             maxdexpgp(0,rg-\/1,g) =  maxdexpgp(0,rg-\/1,g) + abs(dexpgp(0,n1,n2,n3,g))}
\DoxyCodeLine{8975 }
\DoxyCodeLine{8976             \textcolor{keywordflow}{if} (g.eq.1.and.abs(dexpgp(0,n1,n2,n3,g)).gt.                  \&}
\DoxyCodeLine{8977                 truncfacexp*max(1/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}**2,maxdexpgp(0,rg-\/1,g-\/1)) .or.  \&}
\DoxyCodeLine{8978                 g.ge.2.and.abs(dexpgp(0,n1,n2,n3,g)).gt.                  \&}
\DoxyCodeLine{8979                 truncfacexp*maxdexpgp(0,rg-\/1,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8980 }
\DoxyCodeLine{8981               gtrunc = g-\/1}
\DoxyCodeLine{8982               \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{8983 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{8984         }
\DoxyCodeLine{8985 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8986 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8987 }
\DoxyCodeLine{8988         \textcolor{comment}{! error propagation from C's}}
\DoxyCodeLine{8989         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{8990           d00\_err(rg) = max(d00\_err(rg),max(2*abs(m02)*dij\_err(rg-\/2),\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*dij\_err(rg))/(4*r))}
\DoxyCodeLine{8991 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{8992         dij\_err(rg-\/1) = max(dij\_err(rg-\/1),max(2*d00\_err(rg),\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*dij\_err(rg))/abs(fk))}
\DoxyCodeLine{8993 }
\DoxyCodeLine{8994         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{8995           d00\_err2(rg) = max(d00\_err2(rg),max(2*abs(m02)*dij\_err2(rg-\/2),\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*dij\_err2(rg))/(4*r))}
\DoxyCodeLine{8996 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{8997         dij\_err2(rg-\/1) = max(dij\_err2(rg-\/1),max(2*d00\_err2(rg),\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*dij\_err2(rg))/abs(fk))}
\DoxyCodeLine{8998 }
\DoxyCodeLine{8999 \textcolor{preprocessor}{\#ifdef PPEXP00}}
\DoxyCodeLine{9000 \textcolor{preprocessor}{}        \textcolor{keywordflow}{do} n0=rg/2,1,-\/1}
\DoxyCodeLine{9001           \textcolor{keywordflow}{if} (rg-\/n0.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9002             \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{9003               \textcolor{keywordflow}{do} n2=0,rg-\/2*n0-\/n1}
\DoxyCodeLine{9004                 n3=rg-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{9005                 d(n0,n1,n2,n3) = d(n0,n1,n2,n3) + dexpgp(n0,n1,n2,n3,g)}
\DoxyCodeLine{9006 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{9007 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{9008 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{9009 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{9010 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9011 \textcolor{preprocessor}{}}
\DoxyCodeLine{9012         \textcolor{keywordflow}{if} ((rg.le.rmax+1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9013           derr(rg-\/1) = 0d0}
\DoxyCodeLine{9014           \textcolor{keywordflow}{do} n1=0,rg-\/1}
\DoxyCodeLine{9015             \textcolor{keywordflow}{do} n2=0,rg-\/1-\/n1}
\DoxyCodeLine{9016               n3 = rg-\/1-\/n1-\/n2}
\DoxyCodeLine{9017               d(0,n1,n2,n3) = d(0,n1,n2,n3) + dexpgp(0,n1,n2,n3,g)}
\DoxyCodeLine{9018               \textcolor{keywordflow}{if}(abs(dexpgp(0,n1,n2,n3,g-\/1)).ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9019 \textcolor{comment}{!              Derr(rg-\/1)=max(Derr(rg-\/1),abs(Dexpgp(0,n1,n2,n3,g))**2/abs(Dexpgp(0,n1,n2,n3,g-\/1)))}}
\DoxyCodeLine{9020                 derr(rg-\/1)=max(derr(rg-\/1),abs(dexpgp(0,n1,n2,n3,g))*min(1d0,abs(dexpgp(0,n1,n2,n3,g))/abs(dexpgp(0,n1,n2,n3,g-\/1))))}
\DoxyCodeLine{9021               \textcolor{keywordflow}{else}}
\DoxyCodeLine{9022                 derr(rg-\/1)=max(derr(rg-\/1),abs(dexpgp(0,n1,n2,n3,g)))}
\DoxyCodeLine{9023 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{9024 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{9025 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{9026 }
\DoxyCodeLine{9027           \textcolor{comment}{! if error from C's larger than error from expansion stop expansion}}
\DoxyCodeLine{9028 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{9029 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(dij\_err2(rg-\/1).gt.3d0*derr(rg-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9030 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{9031 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(dij\_err(rg-\/1).gt.3d0*derr(rg-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9032 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9033 \textcolor{preprocessor}{}             gtrunc = min(g,gtrunc)}
\DoxyCodeLine{9034              }
\DoxyCodeLine{9035 \textcolor{preprocessor}{\#ifdef Dgptest}}
\DoxyCodeLine{9036 \textcolor{preprocessor}{}             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp exit err'},r,g,gtrunc}
\DoxyCodeLine{9037 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9038 \textcolor{preprocessor}{}\textcolor{keywordflow}{          end if}  }
\DoxyCodeLine{9039  }
\DoxyCodeLine{9040 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{9041 }
\DoxyCodeLine{9042 \textcolor{keywordflow}{      end do} gloop}
\DoxyCodeLine{9043 }
\DoxyCodeLine{9044 \textcolor{preprocessor}{\#ifdef Dgptest}}
\DoxyCodeLine{9045 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp D(0,0,0,0)'},r,d(0,0,0,0)}
\DoxyCodeLine{9046       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp D(0,0,1,0)'},r,d(0,0,1,0)}
\DoxyCodeLine{9047       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp D(1,0,0,0)'},r,d(1,0,0,0)}
\DoxyCodeLine{9048       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp D(1,0,1,0)'},r,d(1,0,1,0)}
\DoxyCodeLine{9049       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp D(0,0,3,0)'},r,d(0,0,3,0)}
\DoxyCodeLine{9050 }
\DoxyCodeLine{9051       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp Dij\_err'},r,dij\_err}
\DoxyCodeLine{9052       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp Dij\_acc'},r,dij\_err/abs(d(0,0,0,0))}
\DoxyCodeLine{9053 }
\DoxyCodeLine{9054       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp err'},r,derr}
\DoxyCodeLine{9055       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp acc'},r,derr/abs(d(0,0,0,0))}
\DoxyCodeLine{9056 \textcolor{preprocessor}{\#endif              }}
\DoxyCodeLine{9057 \textcolor{preprocessor}{}}
\DoxyCodeLine{9058       derr2 = max(derr,dij\_err2(0:rmax))}
\DoxyCodeLine{9059       derr = max(derr,dij\_err(0:rmax))}
\DoxyCodeLine{9060 }
\DoxyCodeLine{9061 \textcolor{comment}{!     if(maxval(Derr).le.acc\_req\_D*abs(D(0,0,0,0))) exit     ! changed 28.01.15}}
\DoxyCodeLine{9062       \textcolor{comment}{! check if target precision already reached}}
\DoxyCodeLine{9063 \textcolor{preprocessor}{\#ifdef Cutrloop}}
\DoxyCodeLine{9064 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(derr-\/acc\_req\_d*abs(d(0,0,0,0))).le.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9065         \textcolor{keywordflow}{if} (r.lt.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9066           \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{9067 \textcolor{comment}{!            write(*,*) 'CalcDg exit rloop  =',rg,r,rmax}}
\DoxyCodeLine{9068             \textcolor{keywordflow}{do} n0=0,rg/2}
\DoxyCodeLine{9069               \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{9070                 \textcolor{keywordflow}{do} n2=0,rg-\/2*n0-\/n1}
\DoxyCodeLine{9071                   d(n0,n1,n2,rg-\/2*n0-\/n1-\/n2)=0d0}
\DoxyCodeLine{9072 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{9073 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{9074 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{9075 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{9076           \textcolor{keywordflow}{if}(r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9077             \textcolor{keywordflow}{do} n1=0,r}
\DoxyCodeLine{9078               \textcolor{keywordflow}{do} n2=0,rg-\/n1}
\DoxyCodeLine{9079                 d(0,n1,n2,r-\/n1-\/n2)=0d0}
\DoxyCodeLine{9080 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{9081 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{9082 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{9083           }
\DoxyCodeLine{9084 100       \textcolor{keyword}{format}(((a)))}
\DoxyCodeLine{9085 111       \textcolor{keyword}{format}(a22,2(\textcolor{stringliteral}{'('},g24.17,\textcolor{stringliteral}{','},g24.17,\textcolor{stringliteral}{') '}:))}
\DoxyCodeLine{9086           \textcolor{keyword}{call }seterrflag\_coli(-\/5)}
\DoxyCodeLine{9087           \textcolor{keyword}{call }errout\_coli(\textcolor{stringliteral}{'CalcDgp'},\textcolor{stringliteral}{' exit rloop for D'}, \&}
\DoxyCodeLine{9088           errorwriteflag)}
\DoxyCodeLine{9089           \textcolor{keywordflow}{if} (errorwriteflag) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9090             \textcolor{keyword}{write}(nerrout\_coli,100)\textcolor{stringliteral}{' CalcDgp:  exit rloop for D '}, \&}
\DoxyCodeLine{9091             \textcolor{stringliteral}{'    should not appear'}}
\DoxyCodeLine{9092             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgp: p10 = '},p10}
\DoxyCodeLine{9093             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgp: p21 = '},p21}
\DoxyCodeLine{9094             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgp: p32 = '},p32}
\DoxyCodeLine{9095             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgp: p30 = '},p30}
\DoxyCodeLine{9096             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgp: p20 = '},p20}
\DoxyCodeLine{9097             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgp: p31 = '},p31}
\DoxyCodeLine{9098             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgp: m02 = '},m02}
\DoxyCodeLine{9099             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgp: m12 = '},m12}
\DoxyCodeLine{9100             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgp: m22 = '},m22}
\DoxyCodeLine{9101             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgp: m32 = '},m32}
\DoxyCodeLine{9102 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{9103 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{9104 }
\DoxyCodeLine{9105 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{9106 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(derr-\/acc\_req\_d*abs(d(0,0,0,0))).le.0d0.and.r.ge.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9107 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9108 \textcolor{preprocessor}{}        \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{9109 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{9110 }
\DoxyCodeLine{9111 \textcolor{keywordflow}{    end do} rloop}
\DoxyCodeLine{9112 }
\DoxyCodeLine{9113     \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2+N3=r, n0=1 only!!!!!! }}
\DoxyCodeLine{9114     \textcolor{comment}{! already calculated for rmax+1}}
\DoxyCodeLine{9115 \textcolor{comment}{!    do r=rmax+1,2*rmax}}
\DoxyCodeLine{9116 \textcolor{preprocessor}{\#ifdef notneeded}}
\DoxyCodeLine{9117 \textcolor{preprocessor}{}    \textcolor{keywordflow}{do} r=rmax+1,rmax+1}
\DoxyCodeLine{9118       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{9119         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{9120           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{9121             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{9122 }
\DoxyCodeLine{9123             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp exp rmax+1'},r,n0,n1,n2,n3, d(n0,n1,n2,n3)}
\DoxyCodeLine{9124 }
\DoxyCodeLine{9125             d(n0,n1,n2,n3) = (c\_0(n0-\/1,n1,n2,n3) + 2*mm02*d(n0-\/1,n1,n2,n3)  \&}
\DoxyCodeLine{9126                 + 4*duv(n0,n1,n2,n3)  \&}
\DoxyCodeLine{9127                 + f(1)*d(n0-\/1,n1+1,n2,n3) + f(2)*d(n0-\/1,n1,n2+1,n3)  \&}
\DoxyCodeLine{9128                 + f(3)*d(n0-\/1,n1,n2,n3+1)) / (2*(r-\/1)) }
\DoxyCodeLine{9129 }
\DoxyCodeLine{9130             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp exp rmax+1'},r,n0,n1,n2,n3, d(n0,n1,n2,n3)}
\DoxyCodeLine{9131 }
\DoxyCodeLine{9132 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{9133 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{9134 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{9135 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{9136 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9137 \textcolor{preprocessor}{}}
\DoxyCodeLine{9138 \textcolor{preprocessor}{\#ifdef Dgptest}}
\DoxyCodeLine{9139 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp D(1,0,0,0) fin'},d(1,0,0,0)}
\DoxyCodeLine{9140       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp D(1,0,1,0) fin'},d(1,0,1,0)}
\DoxyCodeLine{9141       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp D(0,0,3,0) fin'},d(0,0,3,0)}
\DoxyCodeLine{9142       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp D(0,1,1,1) fin'},d(0,1,1,1)}
\DoxyCodeLine{9143 }
\DoxyCodeLine{9144     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp final err'},derr}
\DoxyCodeLine{9145     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgp final acc'},derr/abs(d(0,0,0,0))}
\DoxyCodeLine{9146 \textcolor{preprocessor}{\#endif                    }}
\DoxyCodeLine{9147 \textcolor{preprocessor}{}   }
\DoxyCodeLine{9148 }
\DoxyCodeLine{9149 \textcolor{comment}{!    write(*,*) 'CalcDp Derr ',Derr}}
\DoxyCodeLine{9150 \textcolor{comment}{!    write(*,*) 'CalcDp Derr2',Derr2}}
\DoxyCodeLine{9151 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiond_a6feffd7f87c0539742db98aec14cdfac}\label{namespacereductiond_a6feffd7f87c0539742db98aec14cdfac}} 
\index{reductiond@{reductiond}!calcdgpf@{calcdgpf}}
\index{calcdgpf@{calcdgpf}!reductiond@{reductiond}}
\doxysubsubsection{\texorpdfstring{calcdgpf()}{calcdgpf()}}
{\footnotesize\ttfamily subroutine reductiond\+::calcdgpf (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{D,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Duv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{ordgpf\+\_\+min,  }\item[{integer, intent(in)}]{ordgpf\+\_\+max,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr2 }\end{DoxyParamCaption})}



Definition at line 9166 of file reduction\+D.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{9166   }
\DoxyCodeLine{9167     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobald}{globald}}}
\DoxyCodeLine{9168 }
\DoxyCodeLine{9169     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,ordgpf\_min,ordgpf\_max,id}
\DoxyCodeLine{9170     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p30,p20,p31,m02,m12,m22,m32}
\DoxyCodeLine{9171     \textcolor{keywordtype}{double complex} ::Zadj2(4)}
\DoxyCodeLine{9172     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Dexpgpf(:,:,:,:,:), DuvExpgpf(:,:,:,:)}
\DoxyCodeLine{9173     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: D(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{9174     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Duv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{9175     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Derr(0:rmax),Derr2(0:rmax)}
\DoxyCodeLine{9176     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_0(:,:,:,:), C\_i(:,:,:,:), Shat(:,:,:,:,:)}
\DoxyCodeLine{9177     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Cuv\_0(:,:,:,:), Cuv\_i(:,:,:,:)}
\DoxyCodeLine{9178     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: D\_alt(:,:,:,:)}
\DoxyCodeLine{9179     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: Cerr\_i(:,:),Cerr2\_i(:,:)}
\DoxyCodeLine{9180     \textcolor{keywordtype}{double complex} :: Smod(3), Daux, elimminf2\_coli}
\DoxyCodeLine{9181     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err(:),Dij\_err(:),Cij\_err(:),acc\_req\_Cextra(:)}
\DoxyCodeLine{9182     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err2(:),Dij\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{9183     \textcolor{keywordtype}{double precision} :: maxDexpgpf(0:1,0:rmax+2*ordgpf\_min,0:ordgpf\_max),truncfacexp,acc\_aux}
\DoxyCodeLine{9184     \textcolor{keywordtype}{double precision} :: minZk }
\DoxyCodeLine{9185     \textcolor{keywordtype}{integer} :: rmaxC,rmaxExp,gtrunc,r,n0,n1,n2,n3,a,b,i,j,g,rg,m,n}
\DoxyCodeLine{9186     \textcolor{keywordtype}{integer} :: inds0(3),inds(3),inds2(2,4),at,bt,k,l,lt,ltt,nl,nlt,nltt}
\DoxyCodeLine{9187     \textcolor{keywordtype}{integer} :: bin,nid(0:3)}
\DoxyCodeLine{9188     \textcolor{keywordtype}{logical} :: errorwriteflag}
\DoxyCodeLine{9189 }
\DoxyCodeLine{9190 \textcolor{preprocessor}{\#ifdef Dgpftest}}
\DoxyCodeLine{9191 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf in, ord'},rmax,ordgpf\_min,ordgpf\_max}
\DoxyCodeLine{9192 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9193 \textcolor{preprocessor}{}}
\DoxyCodeLine{9194     \textcolor{comment}{! allocation of C functions}}
\DoxyCodeLine{9195     rmaxc = rmax + 2*ordgpf\_min + 1}
\DoxyCodeLine{9196     \textcolor{keyword}{allocate}(c\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{9197     \textcolor{keyword}{allocate}(cuv\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{9198     \textcolor{keyword}{allocate}(c\_i(0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{9199     \textcolor{keyword}{allocate}(cuv\_i(0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{9200     \textcolor{keyword}{allocate}(cerr\_i(0:rmaxc,0:3))}
\DoxyCodeLine{9201     \textcolor{keyword}{allocate}(cerr2\_i(0:rmaxc,0:3))}
\DoxyCodeLine{9202     \textcolor{keyword}{allocate}(acc\_req\_cextra(0:rmaxc))}
\DoxyCodeLine{9203     }
\DoxyCodeLine{9204     \textcolor{comment}{! determine binaries for C-\/coefficients}}
\DoxyCodeLine{9205     k=0}
\DoxyCodeLine{9206     bin = 1}
\DoxyCodeLine{9207     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.3)}
\DoxyCodeLine{9208       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9209         nid(k) = id+bin}
\DoxyCodeLine{9210         k = k+1}
\DoxyCodeLine{9211 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{9212       bin = 2*bin}
\DoxyCodeLine{9213 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{9214 }
\DoxyCodeLine{9215     \textcolor{comment}{! reduce required accuracy of higher rank C's that appear only in expansion by dividing}}
\DoxyCodeLine{9216     \textcolor{comment}{! by estimated suppression factors that are multiplied in expansion}}
\DoxyCodeLine{9217     acc\_req\_cextra(0:rmax+1) = acc\_req\_cind}
\DoxyCodeLine{9218     acc\_aux = acc\_req\_c}
\DoxyCodeLine{9219     \textcolor{keywordflow}{if} (y\_gpf.ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9220       \textcolor{keywordflow}{do} g=1,ordgpf\_min}
\DoxyCodeLine{9221         acc\_req\_cextra(rmax+2*g) = acc\_req\_cextra(rmax+2*g-\/2)/y\_gpf}
\DoxyCodeLine{9222         acc\_req\_cextra(rmax+2*g+1) = acc\_req\_cextra(rmax+2*g-\/1)/y\_gpf}
\DoxyCodeLine{9223         acc\_aux = acc\_aux/max(x\_gpf,v\_gpf*y\_gpf)}
\DoxyCodeLine{9224         acc\_req\_cextra(rmax+g+1) = min(acc\_req\_cextra(rmax+g+1),acc\_aux)}
\DoxyCodeLine{9225 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{9226     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(x\_gpf.ne.0d0) \textcolor{keywordflow}{then} \textcolor{comment}{! 10.07.2017}}
\DoxyCodeLine{9227       \textcolor{keywordflow}{do} g=1,ordgpf\_min}
\DoxyCodeLine{9228         acc\_aux = acc\_aux/x\_gpf}
\DoxyCodeLine{9229         acc\_req\_cextra(rmax+g+1) = acc\_aux}
\DoxyCodeLine{9230 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{9231     \textcolor{keywordflow}{else} \textcolor{comment}{! 10.07.2017}}
\DoxyCodeLine{9232        acc\_req\_cextra(rmax+2:rmax+2*ordgpf\_min+1) = acc\_inf}
\DoxyCodeLine{9233 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{9234    }
\DoxyCodeLine{9235 }
\DoxyCodeLine{9236 }
\DoxyCodeLine{9237 \textcolor{preprocessor}{\#ifdef Dgpftest}}
\DoxyCodeLine{9238 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf: accreq\_Cextra'},acc\_req\_cextra}
\DoxyCodeLine{9239 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9240 \textcolor{preprocessor}{}}
\DoxyCodeLine{9241     \textcolor{keyword}{call }calcc(c\_0(:,0,:,:),cuv\_0(:,0,:,:),p21,p32,p31,m12,m22,m32,rmaxc,nid(0),cerr\_i(:,0),cerr2\_i(:,0),rmax,acc\_req\_cextra)}
\DoxyCodeLine{9242     \textcolor{keyword}{call }calcc(c\_i(:,:,:,1),cuv\_i(:,:,:,1),p20,p32,p30,m02,m22,m32,rmaxc,nid(1),cerr\_i(:,1),cerr2\_i(:,1),rmax,acc\_req\_cextra)}
\DoxyCodeLine{9243     \textcolor{keyword}{call }calcc(c\_i(:,:,:,2),cuv\_i(:,:,:,2),p10,p31,p30,m02,m12,m32,rmaxc,nid(2),cerr\_i(:,2),cerr2\_i(:,2),rmax,acc\_req\_cextra)}
\DoxyCodeLine{9244     \textcolor{keyword}{call }calcc(c\_i(:,:,:,3),cuv\_i(:,:,:,3),p10,p21,p20,m02,m12,m22,rmaxc,nid(3),cerr\_i(:,3),cerr2\_i(:,3),rmax,acc\_req\_cextra)}
\DoxyCodeLine{9245 }
\DoxyCodeLine{9246 \textcolor{preprocessor}{\#ifdef Dgpftest}}
\DoxyCodeLine{9247 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf Cerr 0'},cerr\_i(:,0)}
\DoxyCodeLine{9248     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf Cerr 1'},cerr\_i(:,1)}
\DoxyCodeLine{9249     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf Cerr 2'},cerr\_i(:,2)}
\DoxyCodeLine{9250     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf Cerr 3'},cerr\_i(:,3)}
\DoxyCodeLine{9251 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9252 \textcolor{preprocessor}{}}
\DoxyCodeLine{9253 }
\DoxyCodeLine{9254     \textcolor{comment}{! shift of integration momentum in C\(\backslash\)\{0\}}}
\DoxyCodeLine{9255     \textcolor{keywordflow}{do} n1=1,rmaxc}
\DoxyCodeLine{9256       \textcolor{keywordflow}{do} n2=0,rmaxc-\/n1}
\DoxyCodeLine{9257         \textcolor{keywordflow}{do} n3=0,rmaxc-\/n1-\/n2}
\DoxyCodeLine{9258           n0 = (rmaxc-\/n1-\/n2-\/n3)}
\DoxyCodeLine{9259           c\_0(0:n0,n1,n2,n3) = -\/c\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{9260                             -\/c\_0(0:n0,n1-\/1,n2+1,n3)-\/c\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{9261           cuv\_0(0:n0,n1,n2,n3) = -\/cuv\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{9262                               -\/cuv\_0(0:n0,n1-\/1,n2+1,n3)-\/cuv\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{9263 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{9264 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{9265 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{9266       }
\DoxyCodeLine{9267 }
\DoxyCodeLine{9268 }
\DoxyCodeLine{9269 }
\DoxyCodeLine{9270     \textcolor{comment}{! coefficients Shat defined in (5.13)}}
\DoxyCodeLine{9271     \textcolor{keyword}{allocate}(shat(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{9272 }
\DoxyCodeLine{9273     \textcolor{keywordflow}{do} r=0,rmaxc}
\DoxyCodeLine{9274       \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{9275         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{9276           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{9277             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{9278 }
\DoxyCodeLine{9279             shat(n0,n1,n2,n3,:) = -\/c\_0(n0,n1,n2,n3)}
\DoxyCodeLine{9280 }
\DoxyCodeLine{9281             \textcolor{keywordflow}{if}(n1.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9282               shat(n0,n1,n2,n3,1) = shat(n0,n1,n2,n3,1) + c\_i(n0,n2,n3,1)}
\DoxyCodeLine{9283 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{9284 }
\DoxyCodeLine{9285             \textcolor{keywordflow}{if}(n2.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9286               shat(n0,n1,n2,n3,2) = shat(n0,n1,n2,n3,2) + c\_i(n0,n1,n3,2)}
\DoxyCodeLine{9287 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{9288 }
\DoxyCodeLine{9289             \textcolor{keywordflow}{if}(n3.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9290               shat(n0,n1,n2,n3,3) = shat(n0,n1,n2,n3,3) + c\_i(n0,n1,n2,3)}
\DoxyCodeLine{9291 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{9292 }
\DoxyCodeLine{9293 \textcolor{preprocessor}{\#ifdef Dgpftest}}
\DoxyCodeLine{9294 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(n0.eq.0.and.n1.eq.0.and.n2.eq.0.and.n3.eq.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{9295             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf 0 C\_0'},c\_0(n0,n1,n2,n3)}
\DoxyCodeLine{9296             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf 0 C\_1'},c\_i(n0,n2,n3,1)}
\DoxyCodeLine{9297             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf 0 C\_2'},c\_i(n0,n1,n3,2)}
\DoxyCodeLine{9298             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf 0 C\_3'},c\_i(n0,n1,n2,3)}
\DoxyCodeLine{9299             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf 0 Sh1'},shat(n0,n1,n2,n3,1)}
\DoxyCodeLine{9300             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf 0 Sh2'},shat(n0,n1,n2,n3,2)}
\DoxyCodeLine{9301             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf 0 Sh3'},shat(n0,n1,n2,n3,3)}
\DoxyCodeLine{9302 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{9303 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9304 \textcolor{preprocessor}{}}
\DoxyCodeLine{9305 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{9306 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{9307 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{9308 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{9309 }
\DoxyCodeLine{9310     \textcolor{comment}{! choose reduction formulas with smallest expansion terms}}
\DoxyCodeLine{9311     minzk = \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}}
\DoxyCodeLine{9312     \textcolor{keywordflow}{if} (maxval(abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1:3))).le.minzk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9313       minzk = maxval(abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1:3)))}
\DoxyCodeLine{9314       k = 1}
\DoxyCodeLine{9315       l = 1}
\DoxyCodeLine{9316       lt = 2}
\DoxyCodeLine{9317       ltt = 3 }
\DoxyCodeLine{9318 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{9319     \textcolor{keywordflow}{if} (maxval(abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1:3))).lt.minzk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9320       minzk = maxval(abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1:3)))}
\DoxyCodeLine{9321       k = 2}
\DoxyCodeLine{9322       l = 2}
\DoxyCodeLine{9323       lt = 3}
\DoxyCodeLine{9324       ltt = 1 }
\DoxyCodeLine{9325 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{9326     \textcolor{keywordflow}{if} (maxval(abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1:3))).lt.minzk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9327       minzk = maxval(abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1:3)))}
\DoxyCodeLine{9328       k = 3}
\DoxyCodeLine{9329       l = 3}
\DoxyCodeLine{9330       lt = 1}
\DoxyCodeLine{9331       ltt = 2 }
\DoxyCodeLine{9332 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{9333 }
\DoxyCodeLine{9334 \textcolor{preprocessor}{\#ifdef Dgpftest}}
\DoxyCodeLine{9335 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf: Z'},k, maxval(abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(k,1:3)))}
\DoxyCodeLine{9336 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9337 \textcolor{preprocessor}{}}
\DoxyCodeLine{9338         }
\DoxyCodeLine{9339     \textcolor{comment}{! allocation of array for det(Z)-\/ and det(X)-\/expanded C-\/coefficients}}
\DoxyCodeLine{9340     rmaxexp = rmaxc+1}
\DoxyCodeLine{9341     \textcolor{keyword}{allocate}(dexpgpf(0:max(rmax/2,1),0:rmaxexp-\/2,0:rmaxexp-\/2,0:rmaxexp-\/2,0:ordgpf\_max))}
\DoxyCodeLine{9342    }
\DoxyCodeLine{9343 }
\DoxyCodeLine{9344     \textcolor{comment}{! calculate Cuv}}
\DoxyCodeLine{9345     \textcolor{keyword}{allocate}(duvexpgpf(0:rmaxexp,0:rmaxexp,0:rmaxexp,0:rmaxexp))}
\DoxyCodeLine{9346     \textcolor{keyword}{call }calcduv(duvexpgpf,cuv\_0,mm02,f,rmaxexp,id)}
\DoxyCodeLine{9347     duv(0:rmax,0:rmax,0:rmax,0:rmax) = duvexpgpf(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{9348 }
\DoxyCodeLine{9349     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{9350     \textcolor{keyword}{allocate}(d00\_err(0:rmaxexp))}
\DoxyCodeLine{9351     \textcolor{keyword}{allocate}(dij\_err(0:rmaxexp))}
\DoxyCodeLine{9352     \textcolor{keyword}{allocate}(cij\_err(0:rmaxc))}
\DoxyCodeLine{9353 }
\DoxyCodeLine{9354     \textcolor{keyword}{allocate}(d00\_err2(0:rmaxexp))}
\DoxyCodeLine{9355     \textcolor{keyword}{allocate}(dij\_err2(0:rmaxexp))}
\DoxyCodeLine{9356     \textcolor{keyword}{allocate}(cij\_err2(0:rmaxc))}
\DoxyCodeLine{9357 }
\DoxyCodeLine{9358     \textcolor{comment}{! initialize accuracy estimates}}
\DoxyCodeLine{9359     derr = acc\_inf}
\DoxyCodeLine{9360     dij\_err =0d0}
\DoxyCodeLine{9361     d00\_err =0d0}
\DoxyCodeLine{9362     cij\_err = max(cerr\_i(:,0),cerr\_i(:,1),cerr\_i(:,2),cerr\_i(:,3))}
\DoxyCodeLine{9363 }
\DoxyCodeLine{9364     derr2 = acc\_inf}
\DoxyCodeLine{9365     dij\_err2 =0d0}
\DoxyCodeLine{9366     d00\_err2 =0d0}
\DoxyCodeLine{9367     cij\_err2 = max(cerr2\_i(:,0),cerr2\_i(:,1),cerr2\_i(:,2),cerr2\_i(:,3))}
\DoxyCodeLine{9368 }
\DoxyCodeLine{9369     \textcolor{comment}{! truncation of expansion if calculated term larger than truncfacexp * previous term}}
\DoxyCodeLine{9370     \textcolor{comment}{! crucial for expansion parameters between 0.1 and 1 !!!}}
\DoxyCodeLine{9371     truncfacexp = sqrt(\mbox{\hyperlink{namespaceglobalc_a92c2feddeb644af9e797691976e9143b}{fac\_gpf}}) * truncfacd}
\DoxyCodeLine{9372     gtrunc = ordgpf\_max }
\DoxyCodeLine{9373 }
\DoxyCodeLine{9374 \textcolor{comment}{! calculate D(1,n1,n2,n3) up to rank r+2}}
\DoxyCodeLine{9375 \textcolor{comment}{! calculate D(0,n1,n2,n3) up to rank r  }}
\DoxyCodeLine{9376     rloop: \textcolor{keywordflow}{do} r=0,rmaxexp-\/2}
\DoxyCodeLine{9377 }
\DoxyCodeLine{9378       \textcolor{keywordflow}{if} (r.gt.rmax+2*gtrunc+2) \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{9379 }
\DoxyCodeLine{9380       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{9381       \textcolor{comment}{! 0th-\/order coefficients}}
\DoxyCodeLine{9382       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{9383 }
\DoxyCodeLine{9384       \textcolor{comment}{! calculating D\_00ijk.. exploiting eq. (5.71)}}
\DoxyCodeLine{9385       maxdexpgpf(1,r,0)=0d0}
\DoxyCodeLine{9386       \textcolor{keywordflow}{do} nl=r,0,-\/1}
\DoxyCodeLine{9387         \textcolor{keywordflow}{do} nlt=r-\/nl,0,-\/1}
\DoxyCodeLine{9388           nltt = r-\/nl-\/nlt}
\DoxyCodeLine{9389           inds0(l) = nl}
\DoxyCodeLine{9390           inds0(lt) = nlt}
\DoxyCodeLine{9391           inds0(ltt) = nltt}
\DoxyCodeLine{9392 }
\DoxyCodeLine{9393           inds(l) = nl+1}
\DoxyCodeLine{9394           inds(lt) = nlt}
\DoxyCodeLine{9395           inds(ltt) = nltt}
\DoxyCodeLine{9396 }
\DoxyCodeLine{9397           daux = shat(0,inds(1),inds(2),inds(3),k) }
\DoxyCodeLine{9398 }
\DoxyCodeLine{9399           dexpgpf(1,inds0(1),inds0(2),inds0(3),0) = daux/(2*(nl+1))}
\DoxyCodeLine{9400 }
\DoxyCodeLine{9401           maxdexpgpf(1,r,0) =  maxdexpgpf(1,r,0) + abs(dexpgpf(1,inds0(1),inds0(2),inds0(3),0) )}
\DoxyCodeLine{9402 }
\DoxyCodeLine{9403 \textcolor{comment}{!          if (r+2.le.rmax) then          !  for fixed rank}}
\DoxyCodeLine{9404           \textcolor{keywordflow}{if} (r+1.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9405             d(1,inds0(1),inds0(2),inds0(3)) = dexpgpf(1,inds0(1),inds0(2),inds0(3),0)}
\DoxyCodeLine{9406 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{9407       }
\DoxyCodeLine{9408 }
\DoxyCodeLine{9409 }
\DoxyCodeLine{9410 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{9411 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{9412 }
\DoxyCodeLine{9413       \textcolor{comment}{! calculate D\_ijkl.. exploiting eq. (5.72)}}
\DoxyCodeLine{9414       maxdexpgpf(0,r,0)=0d0}
\DoxyCodeLine{9415       \textcolor{keywordflow}{do} n1=0,r}
\DoxyCodeLine{9416         \textcolor{keywordflow}{do} n2=0,r-\/n1}
\DoxyCodeLine{9417           n3 = r-\/n1-\/n2}
\DoxyCodeLine{9418 }
\DoxyCodeLine{9419           daux = 2d0*(4+r+r)*dexpgpf(1,n1,n2,n3,0) -\/ 4*duvexpgpf(1,n1,n2,n3)  \&}
\DoxyCodeLine{9420             -\/ 2*c\_0(0,n1,n2,n3)}
\DoxyCodeLine{9421 }
\DoxyCodeLine{9422 \textcolor{preprocessor}{\#ifdef Dgpftest}}
\DoxyCodeLine{9423 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(n1.eq.0.and.n2.eq.2.and.n3.eq.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{9424             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf 0 Daux'},daux}
\DoxyCodeLine{9425 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{9426 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9427 \textcolor{preprocessor}{}}
\DoxyCodeLine{9428           dexpgpf(0,n1,n2,n3,0) = daux/(2d0*m02)}
\DoxyCodeLine{9429 }
\DoxyCodeLine{9430 \textcolor{preprocessor}{\#ifdef Dgpftest}}
\DoxyCodeLine{9431 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(n1.eq.1.and.n2.eq.1.and.n3.eq.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{9432             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf D\_0'},r,dexpgpf(0,n1,n2,n3,0) }
\DoxyCodeLine{9433 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{9434 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9435 \textcolor{preprocessor}{}}
\DoxyCodeLine{9436           maxdexpgpf(0,r,0) =  maxdexpgpf(0,r,0) + abs(dexpgpf(0,n1,n2,n3,0))}
\DoxyCodeLine{9437           \textcolor{keywordflow}{if} (r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9438             d(0,n1,n2,n3) = dexpgpf(0,n1,n2,n3,0)}
\DoxyCodeLine{9439 \textcolor{comment}{!            Derr(r) =  abs(maxZadjf/maxXadj*Dexpgpf(0,n1,n2,n3,0))}}
\DoxyCodeLine{9440 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{9441       }
\DoxyCodeLine{9442 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{9443 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{9444 }
\DoxyCodeLine{9445       \textcolor{keywordflow}{if} (r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9446 \textcolor{comment}{!       Derr(r) =  abs(maxZadjf/Xadj(a,b))*maxDexpgpf(0,r,0)}}
\DoxyCodeLine{9447         derr(r) =  \mbox{\hyperlink{namespaceglobalc_a92c2feddeb644af9e797691976e9143b}{fac\_gpf}}*maxdexpgpf(0,r,0)}
\DoxyCodeLine{9448 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{9449 }
\DoxyCodeLine{9450       \textcolor{comment}{! error propagation from C's}}
\DoxyCodeLine{9451       d00\_err(r+2) = cij\_err(r+1)/2d0 }
\DoxyCodeLine{9452       dij\_err(r)=1d0/abs(m02)*max((2*r+4)*d00\_err(r+2),cerr\_i(r,0))}
\DoxyCodeLine{9453 }
\DoxyCodeLine{9454       d00\_err2(r+2) = cij\_err2(r+1)/2d0 }
\DoxyCodeLine{9455       dij\_err2(r)=1d0/abs(m02)*max((2*r+4)*d00\_err2(r+2),cerr2\_i(r,0))}
\DoxyCodeLine{9456       }
\DoxyCodeLine{9457       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{9458       \textcolor{comment}{! higher order coefficients}}
\DoxyCodeLine{9459       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{9460 }
\DoxyCodeLine{9461       rg = r}
\DoxyCodeLine{9462       gloop: \textcolor{keywordflow}{do} g=1,min(gtrunc,r/2)}
\DoxyCodeLine{9463         rg = rg-\/2}
\DoxyCodeLine{9464 }
\DoxyCodeLine{9465         \textcolor{comment}{! calculating D\_00ijk.. exploiting eq. (5.71)}}
\DoxyCodeLine{9466         maxdexpgpf(1,rg,g) = 0d0}
\DoxyCodeLine{9467         \textcolor{keywordflow}{do} nl=rg,0,-\/1}
\DoxyCodeLine{9468           \textcolor{keywordflow}{do} nlt=rg-\/nl,0,-\/1}
\DoxyCodeLine{9469             nltt = rg-\/nl-\/nlt}
\DoxyCodeLine{9470             inds0(l) = nl}
\DoxyCodeLine{9471             inds0(lt) = nlt}
\DoxyCodeLine{9472             inds0(ltt) = nltt}
\DoxyCodeLine{9473 }
\DoxyCodeLine{9474             inds = inds0}
\DoxyCodeLine{9475             inds(l) = inds(l)+1}
\DoxyCodeLine{9476             daux = -\/f(k)*dexpgpf(0,inds(1),inds(2),inds(3),g-\/1)}
\DoxyCodeLine{9477 }
\DoxyCodeLine{9478             inds(l) = inds(l)+1}
\DoxyCodeLine{9479             daux = daux -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(k,l)*dexpgpf(0,inds(1),inds(2),inds(3),g-\/1)}
\DoxyCodeLine{9480 }
\DoxyCodeLine{9481             inds(l) =  inds(l)-\/1}
\DoxyCodeLine{9482             inds(lt) =  inds(lt)+1}
\DoxyCodeLine{9483             daux = daux -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(k,lt)*dexpgpf(0,inds(1),inds(2),inds(3),g-\/1)}
\DoxyCodeLine{9484 }
\DoxyCodeLine{9485             inds(lt) =  inds(lt)-\/1}
\DoxyCodeLine{9486             inds(ltt) =  inds(ltt)+1}
\DoxyCodeLine{9487             daux = daux -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(k,ltt)*dexpgpf(0,inds(1),inds(2),inds(3),g-\/1)}
\DoxyCodeLine{9488 }
\DoxyCodeLine{9489             dexpgpf(1,inds0(1),inds0(2),inds0(3),g) = daux/(2*(nl+1))}
\DoxyCodeLine{9490 }
\DoxyCodeLine{9491             maxdexpgpf(1,rg,g) =  maxdexpgpf(1,rg,g) + abs(dexpgpf(1,inds0(1),inds0(2),inds0(3),g) )}
\DoxyCodeLine{9492 \textcolor{comment}{!            if (rg+2.le.rmax) then}}
\DoxyCodeLine{9493 \textcolor{comment}{!              D(1,inds0(1),inds0(2),inds0(3)) = D(1,inds0(1),inds0(2),inds0(3))  \&}}
\DoxyCodeLine{9494 \textcolor{comment}{!                                              + Dexpgpf(1,inds0(1),inds0(2),inds0(3),g)}}
\DoxyCodeLine{9495 \textcolor{comment}{!            end if}}
\DoxyCodeLine{9496  }
\DoxyCodeLine{9497             }
\DoxyCodeLine{9498             \textcolor{keywordflow}{if} (g.eq.1.and.abs(dexpgpf(1,inds0(1),inds0(2),inds0(3),g)).gt.   \&}
\DoxyCodeLine{9499                 1d1*truncfacexp*max(1/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}},maxdexpgpf(1,rg,g-\/1)) .or.      \&}
\DoxyCodeLine{9500                 g.ge.2.and.abs(dexpgpf(1,inds0(1),inds0(2),inds0(3),g)).gt.   \&}
\DoxyCodeLine{9501                 truncfacexp*maxdexpgpf(1,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9502 }
\DoxyCodeLine{9503 \textcolor{preprocessor}{\#ifdef Dgpftest}}
\DoxyCodeLine{9504 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf exit gloop'},1,inds0(1),inds0(2),inds0(3),g, \&}
\DoxyCodeLine{9505                 abs(dexpgpf(1,inds0(1),inds0(2),inds0(3),g)),abs(dexpgpf(1,inds0(1),inds0(2),inds0(3),g-\/1)),maxdexpgpf(1,rg,g-\/1)}
\DoxyCodeLine{9506 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9507 \textcolor{preprocessor}{}}
\DoxyCodeLine{9508                 gtrunc = g-\/1}
\DoxyCodeLine{9509                 \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{9510 \textcolor{comment}{!               gtrunc = g}}
\DoxyCodeLine{9511 \textcolor{comment}{!               cycle gloop               ! worsens results for Dgy ??}}
\DoxyCodeLine{9512 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{9513        }
\DoxyCodeLine{9514 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{9515 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{9516 }
\DoxyCodeLine{9517 \textcolor{preprocessor}{\#ifndef PPEXP00}}
\DoxyCodeLine{9518 \textcolor{preprocessor}{}\textcolor{comment}{!          if (rg+2.le.rmax) then        ! for fixed rank}}
\DoxyCodeLine{9519         \textcolor{keywordflow}{if} (rg+1.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9520           \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{9521             \textcolor{keywordflow}{do} n2=0,rg-\/n1}
\DoxyCodeLine{9522               n3=rg-\/n1-\/n2}
\DoxyCodeLine{9523               d(1,n1,n2,n3) = d(1,n1,n2,n3) + dexpgpf(1,n1,n2,n3,g)}
\DoxyCodeLine{9524 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{9525 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{9526 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{9527 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9528 \textcolor{preprocessor}{}}
\DoxyCodeLine{9529         \textcolor{comment}{! calculate D\_ijkl.. exploiting eq. (5.72)}}
\DoxyCodeLine{9530         maxdexpgpf(0,rg,g) = 0d0}
\DoxyCodeLine{9531         \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{9532           \textcolor{keywordflow}{do} n2=0,rg-\/n1}
\DoxyCodeLine{9533             n3 = rg-\/n1-\/n2}
\DoxyCodeLine{9534       }
\DoxyCodeLine{9535             inds(1) = n1}
\DoxyCodeLine{9536             inds(2) = n2}
\DoxyCodeLine{9537             inds(3) = n3}
\DoxyCodeLine{9538             daux = 2*(4+rg+rg)*dexpgpf(1,n1,n2,n3,g)}
\DoxyCodeLine{9539 }
\DoxyCodeLine{9540             \textcolor{keywordflow}{do} i=1,3}
\DoxyCodeLine{9541             \textcolor{keywordflow}{do} j=1,3}
\DoxyCodeLine{9542               inds(i)=inds(i)+1}
\DoxyCodeLine{9543               inds(j)=inds(j)+1 }
\DoxyCodeLine{9544               daux = daux + \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(i,j)*dexpgpf(0,inds(1),inds(2),inds(3),g-\/1)}
\DoxyCodeLine{9545               inds(i)=inds(i)-\/1}
\DoxyCodeLine{9546               inds(j)=inds(j)-\/1  }
\DoxyCodeLine{9547 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{9548 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{9549 }
\DoxyCodeLine{9550             dexpgpf(0,n1,n2,n3,g) = daux/(2*m02)}
\DoxyCodeLine{9551 }
\DoxyCodeLine{9552             maxdexpgpf(0,rg,g) =  maxdexpgpf(0,rg,g) + abs(dexpgpf(0,n1,n2,n3,g))}
\DoxyCodeLine{9553 }
\DoxyCodeLine{9554 \textcolor{comment}{!            if (rg.le.rmax) then}}
\DoxyCodeLine{9555 \textcolor{comment}{!              D(0,n1,n2,n3) = D(0,n1,n2,n3) + Dexpgpf(0,n1,n2,n3,g)}}
\DoxyCodeLine{9556 \textcolor{comment}{!            end if}}
\DoxyCodeLine{9557 }
\DoxyCodeLine{9558             \textcolor{keywordflow}{if} (g.eq.1.and.abs(dexpgpf(0,n1,n2,n3,g)).gt.               \&}
\DoxyCodeLine{9559                 truncfacexp*max(1/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}**2,maxdexpgpf(0,rg,g-\/1)) .or. \&}
\DoxyCodeLine{9560                 g.ge.2.and.abs(dexpgpf(0,n1,n2,n3,g)).gt.               \&}
\DoxyCodeLine{9561                 truncfacexp*maxdexpgpf(0,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9562 }
\DoxyCodeLine{9563 \textcolor{preprocessor}{\#ifdef Dgpftest}}
\DoxyCodeLine{9564 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf exit gloop'},n1,n2,n3,g,abs(dexpgpf(0,n1,n2,n3,g)),abs(dexpgpf(0,n1,n2,n3,g-\/1)),maxdexpgpf(0,rg,g-\/1)}
\DoxyCodeLine{9565 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9566 \textcolor{preprocessor}{}}
\DoxyCodeLine{9567               gtrunc = g-\/1}
\DoxyCodeLine{9568               \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{9569 \textcolor{comment}{!             gtrunc = g}}
\DoxyCodeLine{9570 \textcolor{comment}{!             cycle gloop}}
\DoxyCodeLine{9571 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{9572 }
\DoxyCodeLine{9573 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{9574 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{9575 }
\DoxyCodeLine{9576         \textcolor{comment}{! error propagation from C's}}
\DoxyCodeLine{9577         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{9578           d00\_err(rg+2) = max(d00\_err(rg+2),                  \&}
\DoxyCodeLine{9579                               \mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}/2d0*dij\_err(rg+1),         \&}
\DoxyCodeLine{9580                               \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/2d0*dij\_err(rg+2))}
\DoxyCodeLine{9581 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{9582         dij\_err(rg)=max(dij\_err(rg),\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/(2*abs(m02))*dij\_err(rg+2), \&}
\DoxyCodeLine{9583                (2*rg+4)/abs(m02)*d00\_err(rg+2))}
\DoxyCodeLine{9584 }
\DoxyCodeLine{9585         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{9586           d00\_err2(rg+2) = max(d00\_err2(rg+2),                     \&}
\DoxyCodeLine{9587                               \mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}/2d0*dij\_err2(rg+1),     \&}
\DoxyCodeLine{9588                               \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/2d0*dij\_err2(rg+2))}
\DoxyCodeLine{9589 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{9590         dij\_err2(rg)=max(dij\_err2(rg),\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/(2*abs(m02))*dij\_err2(rg+2), \&}
\DoxyCodeLine{9591                (2*rg+4)/abs(m02)*d00\_err2(rg+2))}
\DoxyCodeLine{9592 }
\DoxyCodeLine{9593 \textcolor{preprocessor}{\#ifdef PPEXP00}}
\DoxyCodeLine{9594 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (rg+2.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9595           \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{9596             \textcolor{keywordflow}{do} n2=0,rg-\/n1}
\DoxyCodeLine{9597               n3=rg-\/n1-\/n2}
\DoxyCodeLine{9598               d(1,n1,n2,n3) = d(1,n1,n2,n3) + dexpgpf(1,n1,n2,n3,g)}
\DoxyCodeLine{9599 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{9600 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{9601 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{9602 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9603 \textcolor{preprocessor}{}}
\DoxyCodeLine{9604         \textcolor{keywordflow}{if} (rg.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9605           derr(rg) = 0d0}
\DoxyCodeLine{9606           \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{9607             \textcolor{keywordflow}{do} n2=0,rg-\/n1}
\DoxyCodeLine{9608               n3 = rg-\/n1-\/n2}
\DoxyCodeLine{9609               d(0,n1,n2,n3) = d(0,n1,n2,n3) + dexpgpf(0,n1,n2,n3,g)}
\DoxyCodeLine{9610               \textcolor{keywordflow}{if}(abs(dexpgpf(0,n1,n2,n3,g-\/1)).ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9611                 derr(rg)=max(derr(rg),abs(dexpgpf(0,n1,n2,n3,g))*min(1d0,abs(dexpgpf(0,n1,n2,n3,g))/abs(dexpgpf(0,n1,n2,n3,g-\/1))))}
\DoxyCodeLine{9612               \textcolor{keywordflow}{else}}
\DoxyCodeLine{9613                 derr(rg)=max(derr(rg),abs(dexpgpf(0,n1,n2,n3,g)))}
\DoxyCodeLine{9614 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{9615 }
\DoxyCodeLine{9616 \textcolor{preprocessor}{\#ifdef Dgpftest}}
\DoxyCodeLine{9617 \textcolor{preprocessor}{}\textcolor{comment}{!              write(*,*) 'CalcDgpf Derr calc',rg,Derr(rg),n1,n2,n3,g,abs(Dexpgpf(0,n1,n2,n3,g)),abs(Dexpgpf(0,n1,n2,n3,g-\/1))}}
\DoxyCodeLine{9618 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9619 \textcolor{preprocessor}{}}
\DoxyCodeLine{9620 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{9621 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{9622 }
\DoxyCodeLine{9623           \textcolor{comment}{! if error from C's larger than error from expansion stop expansion}}
\DoxyCodeLine{9624           \textcolor{comment}{! allow for one more term, as each step involves only even or odd ranks}}
\DoxyCodeLine{9625 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{9626 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(dij\_err2(rg).gt.3d0*derr(rg)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9627 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{9628 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(dij\_err(rg).gt.3d0*derr(rg)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9629 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9630 \textcolor{preprocessor}{}            gtrunc = min(g,gtrunc)}
\DoxyCodeLine{9631 \textcolor{comment}{!           gtrunc = min(g+1,gtrunc)}}
\DoxyCodeLine{9632              }
\DoxyCodeLine{9633 \textcolor{preprocessor}{\#ifdef Dgpftest}}
\DoxyCodeLine{9634 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf exit err'},rg,g,gtrunc}
\DoxyCodeLine{9635             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf exit err'},dij\_err(rg),derr(rg)}
\DoxyCodeLine{9636 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9637 \textcolor{preprocessor}{}\textcolor{keywordflow}{          end if}}
\DoxyCodeLine{9638 }
\DoxyCodeLine{9639 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{9640 }
\DoxyCodeLine{9641 \textcolor{keywordflow}{      end do} gloop}
\DoxyCodeLine{9642 }
\DoxyCodeLine{9643 \textcolor{preprocessor}{\#ifdef Dgpftest}}
\DoxyCodeLine{9644 \textcolor{preprocessor}{}}
\DoxyCodeLine{9645       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf D(1,0,0,0)'},r,d(1,0,0,0)}
\DoxyCodeLine{9646       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf D(0,0,0,0)'},r,d(0,0,0,0)}
\DoxyCodeLine{9647       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf D(0,0,0,1)'},r,d(0,0,0,1)}
\DoxyCodeLine{9648       \textcolor{keywordflow}{if} (r.ge.2.and.rmax.ge.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9649       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf D(0,0,0,2)'},r,d(0,0,0,2)}
\DoxyCodeLine{9650 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{9651       \textcolor{keywordflow}{if} (r.ge.3.and.rmax.ge.3)\textcolor{keywordflow}{then}}
\DoxyCodeLine{9652       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf D(1,0,0,1)'},r,d(1,0,0,1)}
\DoxyCodeLine{9653       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf D(0,1,0,2)'},r,d(0,1,0,2)}
\DoxyCodeLine{9654       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf D(0,0,0,3)'},r,d(0,0,0,3)}
\DoxyCodeLine{9655       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf D(0,1,1,1)'},r,d(0,1,1,1)}
\DoxyCodeLine{9656       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf D(0,2,1,0)'},r,d(0,2,1,0)}
\DoxyCodeLine{9657 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{9658 }
\DoxyCodeLine{9659       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf Dij\_err'},r,dij\_err}
\DoxyCodeLine{9660       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf Dij\_acc'},r,dij\_err/abs(d(0,0,0,0))}
\DoxyCodeLine{9661 }
\DoxyCodeLine{9662       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf err'},r,g,derr}
\DoxyCodeLine{9663       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf acc'},r,g,derr/abs(d(0,0,0,0))}
\DoxyCodeLine{9664 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9665 \textcolor{preprocessor}{}}
\DoxyCodeLine{9666       derr2 = max(derr,dij\_err2(0:rmax))}
\DoxyCodeLine{9667       derr = max(derr,dij\_err(0:rmax))}
\DoxyCodeLine{9668 }
\DoxyCodeLine{9669 \textcolor{comment}{!     if(maxval(Derr).le.acc\_req\_D*abs(D(0,0,0,0))) exit     ! changed 28.01.15}}
\DoxyCodeLine{9670       \textcolor{comment}{! check if target precision already reached}}
\DoxyCodeLine{9671 \textcolor{preprocessor}{\#ifdef Cutrloop}}
\DoxyCodeLine{9672 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(derr-\/acc\_req\_d*abs(d(0,0,0,0))).le.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9673         \textcolor{keywordflow}{if} (r.lt.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9674           \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{9675             \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{9676               \textcolor{keywordflow}{do} n2=0,rg-\/n1}
\DoxyCodeLine{9677                 d(0,n1,n2,rg-\/n1-\/n2)=0d0}
\DoxyCodeLine{9678 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{9679 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{9680 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{9681           \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{9682             \textcolor{keywordflow}{do} n1=0,rg-\/2}
\DoxyCodeLine{9683               \textcolor{keywordflow}{do} n2=0,rg-\/2-\/n1}
\DoxyCodeLine{9684                 d(1,n1,n2,rg-\/2-\/n1-\/n2)=0d0}
\DoxyCodeLine{9685 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{9686 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{9687 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{9688           }
\DoxyCodeLine{9689 100       \textcolor{keyword}{format}(((a)))}
\DoxyCodeLine{9690 111       \textcolor{keyword}{format}(a22,2(\textcolor{stringliteral}{'('},g24.17,\textcolor{stringliteral}{','},g24.17,\textcolor{stringliteral}{') '}:))}
\DoxyCodeLine{9691           \textcolor{keyword}{call }seterrflag\_coli(-\/5)}
\DoxyCodeLine{9692           \textcolor{keyword}{call }errout\_coli(\textcolor{stringliteral}{'CalcDgpf'},\textcolor{stringliteral}{' exit rloop for D'}, \&}
\DoxyCodeLine{9693           errorwriteflag)}
\DoxyCodeLine{9694           \textcolor{keywordflow}{if} (errorwriteflag) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9695             \textcolor{keyword}{write}(nerrout\_coli,100)\textcolor{stringliteral}{' CalcDgpf:  exit rloop for D '}, \&}
\DoxyCodeLine{9696             \textcolor{stringliteral}{'    should not appear'}}
\DoxyCodeLine{9697             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgpf: p10 = '},p10}
\DoxyCodeLine{9698             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgpf: p21 = '},p21}
\DoxyCodeLine{9699             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgpf: p32 = '},p32}
\DoxyCodeLine{9700             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgpf: p30 = '},p30}
\DoxyCodeLine{9701             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgpf: p20 = '},p20}
\DoxyCodeLine{9702             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgpf: p31 = '},p31}
\DoxyCodeLine{9703             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgpf: m02 = '},m02}
\DoxyCodeLine{9704             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgpf: m12 = '},m12}
\DoxyCodeLine{9705             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgpf: m22 = '},m22}
\DoxyCodeLine{9706             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgpf: m32 = '},m32}
\DoxyCodeLine{9707 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{9708 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{9709  }
\DoxyCodeLine{9710 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{9711 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(derr-\/acc\_req\_d*abs(d(0,0,0,0))).le.0d0.and.r.ge.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9712 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9713 \textcolor{preprocessor}{}}
\DoxyCodeLine{9714         \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{9715 }
\DoxyCodeLine{9716 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{9717 }
\DoxyCodeLine{9718 \textcolor{keywordflow}{    end do} rloop}
\DoxyCodeLine{9719 }
\DoxyCodeLine{9720 }
\DoxyCodeLine{9721     \textcolor{comment}{! calculating D\_0000ijk.. exploiting eq. (5.71)}}
\DoxyCodeLine{9722     \textcolor{keywordflow}{do} r=4,rmax+1                 \textcolor{comment}{!  includes rmax+1  24.01.16}}
\DoxyCodeLine{9723       \textcolor{keywordflow}{do} n0=2,max(rmax,r/2)       \textcolor{comment}{!  includes rmax+1  24.01.16}}
\DoxyCodeLine{9724         \textcolor{keywordflow}{do} nl=r-\/2*n0,0,-\/1}
\DoxyCodeLine{9725           \textcolor{keywordflow}{do} nlt=r-\/2*n0-\/nl,0,-\/1}
\DoxyCodeLine{9726             nltt = r-\/2*n0-\/nl-\/nlt}
\DoxyCodeLine{9727             inds0(l) = nl}
\DoxyCodeLine{9728             inds0(lt) = nlt}
\DoxyCodeLine{9729             inds0(ltt) = nltt}
\DoxyCodeLine{9730 }
\DoxyCodeLine{9731             inds(l) = nl+1}
\DoxyCodeLine{9732             inds(lt) = nlt}
\DoxyCodeLine{9733             inds(ltt) = nltt}
\DoxyCodeLine{9734             daux = shat(n0-\/1,inds(1),inds(2),inds(3),k)            \&}
\DoxyCodeLine{9735                  -\/ f(k)*d(n0-\/1,inds(1),inds(2),inds(3))            \&}
\DoxyCodeLine{9736                  -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(k,1)*d(n0-\/1,inds(1)+1,inds(2),inds(3))        \&}
\DoxyCodeLine{9737                  -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(k,2)*d(n0-\/1,inds(1),inds(2)+1,inds(3))        \&  }
\DoxyCodeLine{9738                  -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(k,3)*d(n0-\/1,inds(1),inds(2),inds(3)+1)}
\DoxyCodeLine{9739 }
\DoxyCodeLine{9740             d(n0,inds0(1),inds0(2),inds0(3)) = daux/(2*(nl+1))}
\DoxyCodeLine{9741 }
\DoxyCodeLine{9742 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{9743 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{9744 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{9745 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{9746 }
\DoxyCodeLine{9747     \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2+N3=r, n0=1 only!!!!!! }}
\DoxyCodeLine{9748     \textcolor{comment}{! already calculated for rmax+1 with extension of 24.01.16 above}}
\DoxyCodeLine{9749 \textcolor{comment}{!    do r=rmax+1,2*rmax}}
\DoxyCodeLine{9750 \textcolor{preprocessor}{\#ifdef notneeded}}
\DoxyCodeLine{9751 \textcolor{preprocessor}{}    \textcolor{keywordflow}{do} r=rmax+1,rmax+1}
\DoxyCodeLine{9752       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{9753         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{9754           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{9755             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{9756 }
\DoxyCodeLine{9757             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf exp rmax+1'},r,n0,n1,n2,n3, d(n0,n1,n2,n3)}
\DoxyCodeLine{9758 }
\DoxyCodeLine{9759             d(n0,n1,n2,n3) = (c\_0(n0-\/1,n1,n2,n3) + 2*mm02*d(n0-\/1,n1,n2,n3)  \&}
\DoxyCodeLine{9760                 + 4*duv(n0,n1,n2,n3)  \&}
\DoxyCodeLine{9761                 + f(1)*d(n0-\/1,n1+1,n2,n3) + f(2)*d(n0-\/1,n1,n2+1,n3)  \&}
\DoxyCodeLine{9762                 + f(3)*d(n0-\/1,n1,n2,n3+1)) / (2*(r-\/1)) }
\DoxyCodeLine{9763 }
\DoxyCodeLine{9764             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf dir rmax+1'},r,n0,n1,n2,n3, d(n0,n1,n2,n3)}
\DoxyCodeLine{9765 }
\DoxyCodeLine{9766 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{9767 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{9768 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{9769 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{9770 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9771 \textcolor{preprocessor}{}}
\DoxyCodeLine{9772 \textcolor{preprocessor}{\#ifdef Dgpftest}}
\DoxyCodeLine{9773 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(rmax.ge.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9774       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf D(1,0,0,0) fin'},d(1,0,0,0)}
\DoxyCodeLine{9775       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf D(0,0,0,2) fin'},d(0,0,0,2)}
\DoxyCodeLine{9776       \textcolor{keywordflow}{if}(rmax.ge.3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9777       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf D(1,0,1,0) fin'},d(1,0,1,0)}
\DoxyCodeLine{9778       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf D(0,1,1,1) fin'},d(0,1,1,1)}
\DoxyCodeLine{9779 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{9780 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{9781 }
\DoxyCodeLine{9782     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf final err'},derr}
\DoxyCodeLine{9783     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgpf final acc'},derr/abs(d(0,0,0,0))}
\DoxyCodeLine{9784 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{9785 \textcolor{preprocessor}{}}
\DoxyCodeLine{9786 \textcolor{comment}{!    write(*,*) 'CalcDgpf Derr ',Derr}}
\DoxyCodeLine{9787 \textcolor{comment}{!    write(*,*) 'CalcDgpf Derr2',Derr2}}
\DoxyCodeLine{9788 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiond_abd34e414e7b09a95c9f2feda1fa18208}\label{namespacereductiond_abd34e414e7b09a95c9f2feda1fa18208}} 
\index{reductiond@{reductiond}!calcdgr@{calcdgr}}
\index{calcdgr@{calcdgr}!reductiond@{reductiond}}
\doxysubsubsection{\texorpdfstring{calcdgr()}{calcdgr()}}
{\footnotesize\ttfamily subroutine reductiond\+::calcdgr (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{D,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Duv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{ordgr\+\_\+min,  }\item[{integer, intent(in)}]{ordgr\+\_\+max,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr2 }\end{DoxyParamCaption})}



Definition at line 5883 of file reduction\+D.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5883   }
\DoxyCodeLine{5884     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobald}{globald}}}
\DoxyCodeLine{5885 }
\DoxyCodeLine{5886     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,ordgr\_min,ordgr\_max,id}
\DoxyCodeLine{5887     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p30,p20,p31,m02,m12,m22,m32}
\DoxyCodeLine{5888     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: D(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5889     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Duv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5890     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Derr(0:rmax),Derr2(0:rmax)}
\DoxyCodeLine{5891     \textcolor{keywordtype}{double complex} :: Zadjfj,Zadj2(3,3), Zadjkl, Xtilde}
\DoxyCodeLine{5892     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Dexpgr(:,:,:,:,:), DuvExpgr(:,:,:,:)}
\DoxyCodeLine{5893     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_0(:,:,:,:), Cuv\_0(:,:,:,:), Shat(:,:,:,:,:)}
\DoxyCodeLine{5894     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_i(:,:,:,:), Cuv\_i(:,:,:,:)}
\DoxyCodeLine{5895     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: D\_alt(:,:,:,:)}
\DoxyCodeLine{5896     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: Cerr\_i(:,:),Cerr2\_i(:,:)}
\DoxyCodeLine{5897     \textcolor{keywordtype}{double complex} :: Smod(3), Skl, Daux}
\DoxyCodeLine{5898     \textcolor{keywordtype}{double complex} :: cC0f, elimminf2\_coli}
\DoxyCodeLine{5899     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err(:),Dij\_err(:),Cij\_err(:),acc\_req\_Cextra(:)}
\DoxyCodeLine{5900     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err2(:),Dij\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{5901 \textcolor{comment}{!    double precision :: maxDexpgr(0:1,0:rmax+ordgr\_min+1,0:ordgr\_max),truncfacexp}}
\DoxyCodeLine{5902     \textcolor{keywordtype}{double precision} :: maxDexpgr(0:1,0:2*(rmax+ordgr\_min),0:ordgr\_max),truncfacexp}
\DoxyCodeLine{5903     \textcolor{keywordtype}{integer} :: rmaxC,rmaxExp,gtrunc,r,n0,n1,n2,n3,k,l,i,j,m,n,g,rg,nt,mt,nn,nnt,nntt}
\DoxyCodeLine{5904     \textcolor{keywordtype}{integer} :: inds0(3), inds1(3), inds(3)}
\DoxyCodeLine{5905     \textcolor{keywordtype}{integer} :: bin,nid(0:3)}
\DoxyCodeLine{5906     \textcolor{keywordtype}{logical} :: errorwriteflag}
\DoxyCodeLine{5907 }
\DoxyCodeLine{5908 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{5909 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr in, ord'},rmax,ordgr\_min,ordgr\_max}
\DoxyCodeLine{5910 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5911 \textcolor{preprocessor}{}}
\DoxyCodeLine{5912     \textcolor{comment}{! allocation of C functions}}
\DoxyCodeLine{5913     rmaxc = 2*rmax + 2*ordgr\_min}
\DoxyCodeLine{5914     \textcolor{keyword}{allocate}(c\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{5915     \textcolor{keyword}{allocate}(cuv\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{5916     \textcolor{keyword}{allocate}(c\_i(0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{5917     \textcolor{keyword}{allocate}(cuv\_i(0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{5918     \textcolor{keyword}{allocate}(cerr\_i(0:rmaxc,0:3))}
\DoxyCodeLine{5919     \textcolor{keyword}{allocate}(cerr2\_i(0:rmaxc,0:3))}
\DoxyCodeLine{5920     \textcolor{keyword}{allocate}(acc\_req\_cextra(0:rmaxc))}
\DoxyCodeLine{5921     }
\DoxyCodeLine{5922     \textcolor{comment}{! determine binaries for C-\/coefficients}}
\DoxyCodeLine{5923     k=0}
\DoxyCodeLine{5924     bin = 1}
\DoxyCodeLine{5925     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.3)}
\DoxyCodeLine{5926       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5927         nid(k) = id+bin}
\DoxyCodeLine{5928         k = k+1}
\DoxyCodeLine{5929 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{5930       bin = 2*bin}
\DoxyCodeLine{5931 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{5932 }
\DoxyCodeLine{5933     \textcolor{comment}{! reduce required accuracy of higher rank C's that appear only in expansion by dividing}}
\DoxyCodeLine{5934     \textcolor{comment}{! by estimated suppression factors that are multiplied in expansion}}
\DoxyCodeLine{5935     acc\_req\_cextra(0:rmax) = acc\_req\_cind}
\DoxyCodeLine{5936     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}}.ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5937       \textcolor{keywordflow}{do} r=rmax+1,rmaxc}
\DoxyCodeLine{5938 \textcolor{comment}{!        acc\_req\_Cextra(r)= acc\_req\_Cextra(r-\/1)/x\_g}}
\DoxyCodeLine{5939 \textcolor{comment}{! 09.03.15}}
\DoxyCodeLine{5940         acc\_req\_cextra(r)= acc\_req\_cextra(r-\/1)/\mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}}}
\DoxyCodeLine{5941 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{5942     \textcolor{keywordflow}{else} \textcolor{comment}{! 10.07.2017}}
\DoxyCodeLine{5943        acc\_req\_cextra(rmax+1:rmaxc) = acc\_inf}
\DoxyCodeLine{5944 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{5945 }
\DoxyCodeLine{5946     \textcolor{keyword}{call }calcc(c\_0(:,0,:,:),cuv\_0(:,0,:,:),p21,p32,p31,m12,m22,m32,rmaxc,nid(0),cerr\_i(:,0),cerr2\_i(:,0),rmax,acc\_req\_cextra)}
\DoxyCodeLine{5947     \textcolor{keyword}{call }calcc(c\_i(:,:,:,1),cuv\_i(:,:,:,1),p20,p32,p30,m02,m22,m32,rmaxc,nid(1),cerr\_i(:,1),cerr2\_i(:,1),rmax,acc\_req\_cextra)}
\DoxyCodeLine{5948     \textcolor{keyword}{call }calcc(c\_i(:,:,:,2),cuv\_i(:,:,:,2),p10,p31,p30,m02,m12,m32,rmaxc,nid(2),cerr\_i(:,2),cerr2\_i(:,2),rmax,acc\_req\_cextra)}
\DoxyCodeLine{5949     \textcolor{keyword}{call }calcc(c\_i(:,:,:,3),cuv\_i(:,:,:,3),p10,p21,p20,m02,m12,m22,rmaxc,nid(3),cerr\_i(:,3),cerr2\_i(:,3),rmax,acc\_req\_cextra)}
\DoxyCodeLine{5950 }
\DoxyCodeLine{5951 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{5952 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Cerr 0 ='},cerr\_i(0:rmaxc,0)}
\DoxyCodeLine{5953     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Cerr 1 ='},cerr\_i(0:rmaxc,1)}
\DoxyCodeLine{5954     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Cerr 2 ='},cerr\_i(0:rmaxc,2)}
\DoxyCodeLine{5955     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Cerr 3 ='},cerr\_i(0:rmaxc,3)}
\DoxyCodeLine{5956     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Cacc 0 ='},cerr\_i(0:rmaxc,0)/abs(c\_0(0,0,0,0))}
\DoxyCodeLine{5957     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Cacc 1 ='},cerr\_i(0:rmaxc,1)/abs(c\_i(0,0,0,1))}
\DoxyCodeLine{5958     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Cacc 2 ='},cerr\_i(0:rmaxc,2)/abs(c\_i(0,0,0,2))}
\DoxyCodeLine{5959     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Cacc 3 ='},cerr\_i(0:rmaxc,3)/abs(c\_i(0,0,0,3))}
\DoxyCodeLine{5960 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5961 \textcolor{preprocessor}{}}
\DoxyCodeLine{5962     \textcolor{comment}{! shift of integration momentum in C\(\backslash\)\{0\}}}
\DoxyCodeLine{5963     \textcolor{keywordflow}{do} n1=1,rmaxc}
\DoxyCodeLine{5964       \textcolor{keywordflow}{do} n2=0,rmaxc-\/n1}
\DoxyCodeLine{5965         \textcolor{keywordflow}{do} n3=0,rmaxc-\/n1-\/n2}
\DoxyCodeLine{5966           n0 = (rmaxc-\/n1-\/n2-\/n3)}
\DoxyCodeLine{5967           c\_0(0:n0,n1,n2,n3) = -\/c\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{5968                             -\/c\_0(0:n0,n1-\/1,n2+1,n3)-\/c\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{5969           cuv\_0(0:n0,n1,n2,n3) = -\/cuv\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{5970                               -\/cuv\_0(0:n0,n1-\/1,n2+1,n3)-\/cuv\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{5971 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{5972 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{5973 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{5974 }
\DoxyCodeLine{5975 }
\DoxyCodeLine{5976     \textcolor{comment}{! calculate adjugated Gram matrix}}
\DoxyCodeLine{5977 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{5978 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{5979 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{5980 \textcolor{comment}{!    mm32 = elimminf2\_coli(m32)}}
\DoxyCodeLine{5981 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{5982 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{5983 \textcolor{comment}{!    q32  = elimminf2\_coli(p32)}}
\DoxyCodeLine{5984 \textcolor{comment}{!    q30  = elimminf2\_coli(p30)}}
\DoxyCodeLine{5985 \textcolor{comment}{!    q31  = elimminf2\_coli(p31)}}
\DoxyCodeLine{5986 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{5987 }
\DoxyCodeLine{5988 \textcolor{comment}{!    Z(1,1) = 2d0*q10}}
\DoxyCodeLine{5989 \textcolor{comment}{!    Z(2,1) = q10+q20-\/q21}}
\DoxyCodeLine{5990 \textcolor{comment}{!    Z(3,1) = q10+q30-\/q31}}
\DoxyCodeLine{5991 \textcolor{comment}{!    Z(1,2) = Z(2,1)}}
\DoxyCodeLine{5992 \textcolor{comment}{!    Z(2,2) = 2d0*q20}}
\DoxyCodeLine{5993 \textcolor{comment}{!    Z(3,2) = q20+q30-\/q32}}
\DoxyCodeLine{5994 \textcolor{comment}{!    Z(1,3) = Z(3,1)}}
\DoxyCodeLine{5995 \textcolor{comment}{!    Z(2,3) = Z(3,2)}}
\DoxyCodeLine{5996 \textcolor{comment}{!    Z(3,3) = 2d0*q30}}
\DoxyCodeLine{5997 }
\DoxyCodeLine{5998 \textcolor{comment}{!    q1q2 = (q10+q20-\/q21)}}
\DoxyCodeLine{5999 \textcolor{comment}{!    q1q3 = (q10+q30-\/q31)}}
\DoxyCodeLine{6000 \textcolor{comment}{!    q2q3 = (q20+q30-\/q32)}}
\DoxyCodeLine{6001 \textcolor{comment}{!    detZ = 8d0*q10*q30*q20+2D0*q1q2*q1q3*q2q3  \&}}
\DoxyCodeLine{6002 \textcolor{comment}{!     \&    -\/2d0*(q10*q2q3*q2q3+q20*q1q3*q1q3+q30*q1q2*q1q2)}}
\DoxyCodeLine{6003 }
\DoxyCodeLine{6004 \textcolor{comment}{!    Zadj(1,1) = (4d0*q30*q20-\/q2q3*q2q3)}}
\DoxyCodeLine{6005 \textcolor{comment}{!    Zadj(2,1) = (q1q3*q2q3-\/2d0*q30*q1q2)}}
\DoxyCodeLine{6006 \textcolor{comment}{!    Zadj(3,1) = (q1q2*q2q3-\/2d0*q20*q1q3)}}
\DoxyCodeLine{6007 \textcolor{comment}{!    Zadj(1,2) = Zadj(2,1)}}
\DoxyCodeLine{6008 \textcolor{comment}{!    Zadj(2,2) = (4d0*q10*q30-\/q1q3*q1q3)}}
\DoxyCodeLine{6009 \textcolor{comment}{!    Zadj(3,2) = (q1q2*q1q3-\/2d0*q10*q2q3)}}
\DoxyCodeLine{6010 \textcolor{comment}{!    Zadj(1,3) = Zadj(3,1)}}
\DoxyCodeLine{6011 \textcolor{comment}{!    Zadj(2,3) = Zadj(3,2)}}
\DoxyCodeLine{6012 \textcolor{comment}{!    Zadj(3,3) = (4d0*q10*q20-\/q1q2*q1q2)}}
\DoxyCodeLine{6013 \textcolor{comment}{!}}
\DoxyCodeLine{6014 \textcolor{comment}{!    f(1) = q10+mm02-\/mm12}}
\DoxyCodeLine{6015 \textcolor{comment}{!    f(2) = q20+mm02-\/mm22}}
\DoxyCodeLine{6016 \textcolor{comment}{!    f(3) = q30+mm02-\/mm32}}
\DoxyCodeLine{6017       }
\DoxyCodeLine{6018 \textcolor{comment}{!    Zadjf(1) = Zadj(1,1)*f(1)+Zadj(2,1)*f(2)+Zadj(3,1)*f(3)}}
\DoxyCodeLine{6019 \textcolor{comment}{!    Zadjf(2) = Zadj(1,2)*f(1)+Zadj(2,2)*f(2)+Zadj(3,2)*f(3)}}
\DoxyCodeLine{6020 \textcolor{comment}{!    Zadjf(3) = Zadj(1,3)*f(1)+Zadj(2,3)*f(2)+Zadj(3,3)*f(3)}}
\DoxyCodeLine{6021 }
\DoxyCodeLine{6022 }
\DoxyCodeLine{6023     \textcolor{comment}{! coefficients Shat defined in (5.13)}}
\DoxyCodeLine{6024     \textcolor{keyword}{allocate}(shat(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{6025 }
\DoxyCodeLine{6026     \textcolor{keywordflow}{do} r=0,rmaxc}
\DoxyCodeLine{6027       \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{6028         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{6029           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{6030             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{6031 }
\DoxyCodeLine{6032             shat(n0,n1,n2,n3,:) = -\/c\_0(n0,n1,n2,n3)}
\DoxyCodeLine{6033 }
\DoxyCodeLine{6034             \textcolor{keywordflow}{if}(n1.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6035               shat(n0,n1,n2,n3,1) = shat(n0,n1,n2,n3,1) + c\_i(n0,n2,n3,1)}
\DoxyCodeLine{6036 }
\DoxyCodeLine{6037               \textcolor{keywordflow}{if}(n0.eq.3.and.r.eq.6) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6038 \textcolor{comment}{!             write(*,*) 'CalcDgr test ',n0,n2,n3,C\_i(n0,n2,n3,1),Shat(n0,n1,n2,n3,1)}}
\DoxyCodeLine{6039 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6040       }
\DoxyCodeLine{6041 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{6042 }
\DoxyCodeLine{6043             \textcolor{keywordflow}{if}(n2.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6044               shat(n0,n1,n2,n3,2) = shat(n0,n1,n2,n3,2) + c\_i(n0,n1,n3,2)}
\DoxyCodeLine{6045 }
\DoxyCodeLine{6046               \textcolor{keywordflow}{if}(n0.eq.3.and.r.eq.6) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6047 \textcolor{comment}{!             write(*,*) 'CalcDgr test ',n0,n1,n3,C\_i(n0,n1,n3,2),Shat(n0,n1,n2,n3,2)}}
\DoxyCodeLine{6048 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6049 }
\DoxyCodeLine{6050 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{6051 }
\DoxyCodeLine{6052             \textcolor{keywordflow}{if}(n3.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6053  }
\DoxyCodeLine{6054               shat(n0,n1,n2,n3,3) = shat(n0,n1,n2,n3,3) + c\_i(n0,n1,n2,3)}
\DoxyCodeLine{6055 }
\DoxyCodeLine{6056               \textcolor{keywordflow}{if}(n0.eq.3.and.r.eq.6) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6057 \textcolor{comment}{!            write(*,*) 'CalcDgr test ',n0,n1,n2,C\_i(n0,n1,n2,3), Shat(n0,n1,n2,n3,3) }}
\DoxyCodeLine{6058 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6059 }
\DoxyCodeLine{6060 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{6061 }
\DoxyCodeLine{6062 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{6063 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{6064 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{6065 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{6066 }
\DoxyCodeLine{6067 }
\DoxyCodeLine{6068     \textcolor{comment}{! choose reduction formulas with biggest denominators}}
\DoxyCodeLine{6069     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)).ge.max(abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)),abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(3)))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6070       j = 1}
\DoxyCodeLine{6071     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)).ge.max(abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)),abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(3)))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6072       j = 2}
\DoxyCodeLine{6073     \textcolor{keywordflow}{else}}
\DoxyCodeLine{6074       j = 3}
\DoxyCodeLine{6075 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{6076 }
\DoxyCodeLine{6077     maxzadj2f = 0d0                \textcolor{comment}{! Zadj2f(k,n,l) = Zadf2(k,n,l,m)*f(m)}}
\DoxyCodeLine{6078                                    \textcolor{comment}{! Zadj2(n,m) ==  Zadf2(k,n,l,m)}}
\DoxyCodeLine{6079     \textcolor{keywordflow}{if} (abs(zadj2f(1,2,1)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6080       maxzadj2f = abs(zadj2f(1,2,1))}
\DoxyCodeLine{6081       k = 1}
\DoxyCodeLine{6082       n = 2}
\DoxyCodeLine{6083       nt = 3}
\DoxyCodeLine{6084       l = 1}
\DoxyCodeLine{6085       m = 2}
\DoxyCodeLine{6086       mt = 3}
\DoxyCodeLine{6087       zadj2(2,2) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)}
\DoxyCodeLine{6088       zadj2(2,3) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)}
\DoxyCodeLine{6089       zadj2(3,2) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3)}
\DoxyCodeLine{6090       zadj2(3,3) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)}
\DoxyCodeLine{6091 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{6092     \textcolor{keywordflow}{if} (abs(zadj2f(1,2,2)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6093       maxzadj2f = abs(zadj2f(1,2,2))}
\DoxyCodeLine{6094       k = 1}
\DoxyCodeLine{6095       n = 2}
\DoxyCodeLine{6096       nt = 3}
\DoxyCodeLine{6097       l = 2}
\DoxyCodeLine{6098       m = 3}
\DoxyCodeLine{6099       mt = 1}
\DoxyCodeLine{6100       zadj2(2,1) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)}
\DoxyCodeLine{6101       zadj2(2,3) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)}
\DoxyCodeLine{6102       zadj2(3,1) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3)}
\DoxyCodeLine{6103       zadj2(3,3) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{6104 \textcolor{comment}{!      if(abs(Zadj(n,l)).gt.abs(Zadj(k,l))) then}}
\DoxyCodeLine{6105 \textcolor{comment}{!        k = 2}}
\DoxyCodeLine{6106 \textcolor{comment}{!        n = 1}}
\DoxyCodeLine{6107 \textcolor{comment}{!        nt = 3}}
\DoxyCodeLine{6108 \textcolor{comment}{!        Zadj2(1,1) = -\/Z(3,3)}}
\DoxyCodeLine{6109 \textcolor{comment}{!        Zadj2(1,3) =  Z(3,1)}}
\DoxyCodeLine{6110 \textcolor{comment}{!        Zadj2(3,1) =  Z(1,3)}}
\DoxyCodeLine{6111 \textcolor{comment}{!        Zadj2(3,3) = -\/Z(1,1)}}
\DoxyCodeLine{6112 \textcolor{comment}{!      endif}}
\DoxyCodeLine{6113 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{6114     \textcolor{keywordflow}{if} (abs(zadj2f(1,2,3)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6115       maxzadj2f = abs(zadj2f(1,2,3))}
\DoxyCodeLine{6116       k = 1}
\DoxyCodeLine{6117       n = 2}
\DoxyCodeLine{6118       nt = 3}
\DoxyCodeLine{6119       l = 3}
\DoxyCodeLine{6120       m = 1}
\DoxyCodeLine{6121       mt = 2}
\DoxyCodeLine{6122       zadj2(2,1) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)}
\DoxyCodeLine{6123       zadj2(2,2) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)}
\DoxyCodeLine{6124       zadj2(3,1) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)}
\DoxyCodeLine{6125       zadj2(3,2) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{6126 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{6127 }
\DoxyCodeLine{6128     \textcolor{keywordflow}{if} (abs(zadj2f(1,3,1)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6129       maxzadj2f = abs(zadj2f(1,3,1))}
\DoxyCodeLine{6130       k = 1}
\DoxyCodeLine{6131       n = 3}
\DoxyCodeLine{6132       nt = 2}
\DoxyCodeLine{6133       l = 1}
\DoxyCodeLine{6134       m = 2}
\DoxyCodeLine{6135       mt = 3}
\DoxyCodeLine{6136       zadj2(3,2) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3)}
\DoxyCodeLine{6137       zadj2(3,3) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)}
\DoxyCodeLine{6138       zadj2(2,2) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)}
\DoxyCodeLine{6139       zadj2(2,3) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)}
\DoxyCodeLine{6140 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{6141     \textcolor{keywordflow}{if} (abs(zadj2f(1,3,2)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6142       maxzadj2f = abs(zadj2f(1,3,2))}
\DoxyCodeLine{6143       k = 1}
\DoxyCodeLine{6144       n = 3}
\DoxyCodeLine{6145       nt = 2}
\DoxyCodeLine{6146       l = 2}
\DoxyCodeLine{6147       m = 3}
\DoxyCodeLine{6148       mt = 1}
\DoxyCodeLine{6149       zadj2(3,1) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3)}
\DoxyCodeLine{6150       zadj2(3,3) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{6151       zadj2(2,1) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)}
\DoxyCodeLine{6152       zadj2(2,3) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)}
\DoxyCodeLine{6153 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{6154     \textcolor{keywordflow}{if} (abs(zadj2f(1,3,3)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6155       maxzadj2f = abs(zadj2f(1,3,3))}
\DoxyCodeLine{6156       k = 1}
\DoxyCodeLine{6157       n = 3}
\DoxyCodeLine{6158       nt = 2}
\DoxyCodeLine{6159       l = 3}
\DoxyCodeLine{6160       m = 1}
\DoxyCodeLine{6161       mt = 2}
\DoxyCodeLine{6162       zadj2(3,1) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)}
\DoxyCodeLine{6163       zadj2(3,2) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{6164       zadj2(2,1) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)}
\DoxyCodeLine{6165       zadj2(2,2) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)}
\DoxyCodeLine{6166 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{6167 }
\DoxyCodeLine{6168     \textcolor{keywordflow}{if} (abs(zadj2f(2,3,1)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6169       maxzadj2f = abs(zadj2f(2,3,1))}
\DoxyCodeLine{6170       k = 2}
\DoxyCodeLine{6171       n = 3}
\DoxyCodeLine{6172       nt = 1}
\DoxyCodeLine{6173       l = 1}
\DoxyCodeLine{6174       m = 2}
\DoxyCodeLine{6175       mt = 3}
\DoxyCodeLine{6176       zadj2(3,2) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,3)}
\DoxyCodeLine{6177       zadj2(3,3) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2)}
\DoxyCodeLine{6178       zadj2(1,2) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)}
\DoxyCodeLine{6179       zadj2(1,3) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)}
\DoxyCodeLine{6180 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{6181     \textcolor{keywordflow}{if} (abs(zadj2f(2,3,2)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6182       maxzadj2f = abs(zadj2f(2,3,2))}
\DoxyCodeLine{6183       k = 2}
\DoxyCodeLine{6184       n = 3}
\DoxyCodeLine{6185       nt = 1}
\DoxyCodeLine{6186       l = 2}
\DoxyCodeLine{6187       m = 3}
\DoxyCodeLine{6188       mt = 1}
\DoxyCodeLine{6189       zadj2(3,1) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,3)}
\DoxyCodeLine{6190       zadj2(3,3) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)}
\DoxyCodeLine{6191       zadj2(1,1) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)}
\DoxyCodeLine{6192       zadj2(1,3) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)}
\DoxyCodeLine{6193 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{6194     \textcolor{keywordflow}{if} (abs(zadj2f(2,3,3)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6195       maxzadj2f = abs(zadj2f(2,3,3))}
\DoxyCodeLine{6196       k = 2}
\DoxyCodeLine{6197       n = 3}
\DoxyCodeLine{6198       nt = 1}
\DoxyCodeLine{6199       l = 3}
\DoxyCodeLine{6200       m = 1}
\DoxyCodeLine{6201       mt = 2}
\DoxyCodeLine{6202       zadj2(3,1) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2)}
\DoxyCodeLine{6203       zadj2(3,2) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)}
\DoxyCodeLine{6204       zadj2(1,1) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)}
\DoxyCodeLine{6205       zadj2(1,2) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)}
\DoxyCodeLine{6206 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{6207 }
\DoxyCodeLine{6208 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6209 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr maxZadj2f '},maxzadj2f,maxval(abs(zadj2f(:,:,:)))}
\DoxyCodeLine{6210 \textcolor{comment}{!    write(*,*) 'CalcDgr Zadj2f ',Zadj2f}}
\DoxyCodeLine{6211 \textcolor{comment}{!    write(*,*) 'CalcDgr Zadj2f ',Zadj2f(1,1,2),Zadj2f(2,1,1)}}
\DoxyCodeLine{6212 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6213 \textcolor{preprocessor}{}}
\DoxyCodeLine{6214     zadjfj = \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j)}
\DoxyCodeLine{6215     zadjkl = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)}
\DoxyCodeLine{6216 \textcolor{comment}{!    Xtilde = Xadj(k,l)}}
\DoxyCodeLine{6217 }
\DoxyCodeLine{6218 \textcolor{comment}{!    write(*,*) 'CalcDg Xtilde n',Xtilde,Xadj(1,1),Xadj(1,2),Xadj(2,2)}}
\DoxyCodeLine{6219 }
\DoxyCodeLine{6220 }
\DoxyCodeLine{6221 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6222 \textcolor{preprocessor}{}\textcolor{comment}{!    write(*,*) 'CalcDgr k,n,nt,l',k,n,nt,l,m,mt}}
\DoxyCodeLine{6223 \textcolor{comment}{!    write(*,*) 'CalcDgr pars', maxZadj2f,Zadj2f(k,n,l),Zadj(k,l),maxZadj}}
\DoxyCodeLine{6224 \textcolor{comment}{!    write(*,*) 'CalcDgr pars', abs(Zadjf(l)),abs(detZ)}}
\DoxyCodeLine{6225 \textcolor{comment}{!    write(*,*) 'CalcDgr pars',  abs(Zadjf(l)/ maxZadj2f),abs(detZ/maxZadj2f)}}
\DoxyCodeLine{6226 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6227 \textcolor{preprocessor}{}}
\DoxyCodeLine{6228     zadjfj = \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j)}
\DoxyCodeLine{6229     zadjkl = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)}
\DoxyCodeLine{6230 }
\DoxyCodeLine{6231     \textcolor{comment}{! allocation of array for expanded D-\/coefficients}}
\DoxyCodeLine{6232     rmaxexp = rmaxc}
\DoxyCodeLine{6233     \textcolor{keyword}{allocate}(dexpgr(0:rmaxexp/2,0:rmaxexp,0:rmaxexp,0:rmaxexp,0:ordgr\_max))}
\DoxyCodeLine{6234 }
\DoxyCodeLine{6235     \textcolor{comment}{! calculate Duv}}
\DoxyCodeLine{6236     \textcolor{keyword}{allocate}(duvexpgr(0:(rmaxexp+1),0:rmaxexp+1,0:rmaxexp+1,0:rmaxexp+1))}
\DoxyCodeLine{6237 }
\DoxyCodeLine{6238 \textcolor{comment}{!   if(rmaxexp.ge.16)then}}
\DoxyCodeLine{6239 \textcolor{comment}{!   write(*,*) 'CalcDgr Cuv\_0',Cuv\_0(1,3,3,3)}}
\DoxyCodeLine{6240 \textcolor{comment}{!   endif}}
\DoxyCodeLine{6241 }
\DoxyCodeLine{6242     \textcolor{keyword}{call }calcduv(duvexpgr,cuv\_0,mm02,f,rmaxexp+1,id)}
\DoxyCodeLine{6243     duv(0:rmax,0:rmax,0:rmax,0:rmax) = duvexpgr(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{6244 }
\DoxyCodeLine{6245     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{6246     \textcolor{keyword}{allocate}(d00\_err(0:rmaxexp))}
\DoxyCodeLine{6247     \textcolor{keyword}{allocate}(dij\_err(0:rmaxexp))}
\DoxyCodeLine{6248     \textcolor{keyword}{allocate}(cij\_err(0:rmaxc))}
\DoxyCodeLine{6249      }
\DoxyCodeLine{6250     \textcolor{keyword}{allocate}(d00\_err2(0:rmaxexp))}
\DoxyCodeLine{6251     \textcolor{keyword}{allocate}(dij\_err2(0:rmaxexp))}
\DoxyCodeLine{6252     \textcolor{keyword}{allocate}(cij\_err2(0:rmaxc))}
\DoxyCodeLine{6253      }
\DoxyCodeLine{6254     \textcolor{comment}{! initialize accuracy estimates}}
\DoxyCodeLine{6255     derr = acc\_inf}
\DoxyCodeLine{6256     dij\_err =0d0}
\DoxyCodeLine{6257     d00\_err =0d0}
\DoxyCodeLine{6258     cij\_err = max(cerr\_i(:,0),cerr\_i(:,1),cerr\_i(:,2),cerr\_i(:,3))}
\DoxyCodeLine{6259 }
\DoxyCodeLine{6260     derr2 = acc\_inf}
\DoxyCodeLine{6261     dij\_err2 =0d0}
\DoxyCodeLine{6262     d00\_err2 =0d0}
\DoxyCodeLine{6263     cij\_err2 = max(cerr2\_i(:,0),cerr2\_i(:,1),cerr2\_i(:,2),cerr2\_i(:,3))}
\DoxyCodeLine{6264 }
\DoxyCodeLine{6265 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6266 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Cij\_err = '},cij\_err }
\DoxyCodeLine{6267     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr C0\_err = '}, cerr\_i(0,0),cerr\_i(0,1),cerr\_i(0,2),cerr\_i(0,3)}
\DoxyCodeLine{6268     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr C0 = '}, c\_0(0,0,0,0),c\_i(0,0,0,1),c\_i(0,0,0,2),c\_i(0,0,0,3)}
\DoxyCodeLine{6269 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6270 \textcolor{preprocessor}{}}
\DoxyCodeLine{6271 \textcolor{comment}{!    maxZadj = maxval(abs(Zadj))}}
\DoxyCodeLine{6272 \textcolor{comment}{!    maxZadj2f = maxval(abs(f(inds2(1,:))*Zadj2(:)))}}
\DoxyCodeLine{6273 }
\DoxyCodeLine{6274     \textcolor{comment}{! truncation of expansion if calculated term larger than truncfacexp * previous term}}
\DoxyCodeLine{6275     \textcolor{comment}{! crucial for expansion parameters between 0.1 and 1 !!!}}
\DoxyCodeLine{6276     truncfacexp = sqrt(\mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}}) * truncfacd}
\DoxyCodeLine{6277     gtrunc = ordgr\_max }
\DoxyCodeLine{6278 }
\DoxyCodeLine{6279 \textcolor{comment}{! calculate D(n0,n1,n2,n3) up to rank r+n0}}
\DoxyCodeLine{6280     rloop: \textcolor{keywordflow}{do} r=0,rmaxexp/2}
\DoxyCodeLine{6281 }
\DoxyCodeLine{6282 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6283 \textcolor{preprocessor}{}\textcolor{comment}{!      write(*,*) 'CalcDgr rloop',r,rmax,gtrunc}}
\DoxyCodeLine{6284 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6285 \textcolor{preprocessor}{}}
\DoxyCodeLine{6286       \textcolor{keywordflow}{if} (r.gt.rmax+gtrunc) \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{6287 }
\DoxyCodeLine{6288 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6289 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr rloop'},r,rmaxexp,rmaxc}
\DoxyCodeLine{6290 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6291 \textcolor{preprocessor}{}}
\DoxyCodeLine{6292       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{6293       \textcolor{comment}{! 0th-\/order coefficients}}
\DoxyCodeLine{6294       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{6295 }
\DoxyCodeLine{6296       \textcolor{comment}{! calculating}}
\DoxyCodeLine{6297       \textcolor{comment}{! D\_00(a)0000..00 -\/-\/> D\_00(a)ij00..00 -\/-\/> D\_00(a)ijkl00..00 -\/-\/> ... -\/-\/> D\_00(a)ijklmn..}}
\DoxyCodeLine{6298       \textcolor{comment}{! exploiting eq. (5.40) -\/ (5.53) solved for D\_00i1..<ir>...iP}}
\DoxyCodeLine{6299       maxdexpgr(1,r,0)=0d0}
\DoxyCodeLine{6300 }
\DoxyCodeLine{6301 \textcolor{comment}{! Note r is not the rank!  r= n0+n1+n2+n3    rank=2*n0+n1+n2+n3}}
\DoxyCodeLine{6302       \textcolor{keywordflow}{do} n0=r,1,-\/1}
\DoxyCodeLine{6303         \textcolor{keywordflow}{do} nn=r-\/n0,0,-\/1}
\DoxyCodeLine{6304           \textcolor{keywordflow}{do} nnt=r-\/n0-\/nn,0,-\/1}
\DoxyCodeLine{6305             nntt = r-\/n0-\/nn-\/nnt}
\DoxyCodeLine{6306 }
\DoxyCodeLine{6307 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6308 \textcolor{preprocessor}{}\textcolor{comment}{!            write(*,*) 'CalcDgr rloop',n0,nn,nnt,nntt,Zadj2f(k,n,l)}}
\DoxyCodeLine{6309 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6310 \textcolor{preprocessor}{}}
\DoxyCodeLine{6311             inds0(n) = nn}
\DoxyCodeLine{6312             inds0(nt) = nnt}
\DoxyCodeLine{6313             inds0(k) = nntt}
\DoxyCodeLine{6314             }
\DoxyCodeLine{6315 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6316 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr inds0'},n0,inds0}
\DoxyCodeLine{6317 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6318 \textcolor{preprocessor}{}}
\DoxyCodeLine{6319             inds1(n) = nn+1}
\DoxyCodeLine{6320             inds1(nt) = nnt}
\DoxyCodeLine{6321             inds1(k) = nntt}
\DoxyCodeLine{6322 }
\DoxyCodeLine{6323 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6324 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr inds1'},n0,inds1}
\DoxyCodeLine{6325 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6326 \textcolor{preprocessor}{}}
\DoxyCodeLine{6327 \textcolor{comment}{!            Daux = 0d0}}
\DoxyCodeLine{6328             daux = -\/\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)*c\_0(n0-\/1,inds1(1),inds1(2),inds1(3))}
\DoxyCodeLine{6329 }
\DoxyCodeLine{6330 \textcolor{comment}{!            Daux = 2*Zadj(k,l) * (1+r-\/2*n0) * Dexpgr(n0,inds1(1),inds1(2),inds1(3),0)}}
\DoxyCodeLine{6331 }
\DoxyCodeLine{6332 \textcolor{comment}{!            inds = inds1}}
\DoxyCodeLine{6333 \textcolor{comment}{!            inds(k) = inds(k) + 1}}
\DoxyCodeLine{6334 \textcolor{comment}{!            inds(l) = inds(l) + 1}}
\DoxyCodeLine{6335 \textcolor{comment}{!            Daux = Daux + detZ * Dexpgr(n0-\/1,inds(1),inds(2),inds(3),0)}}
\DoxyCodeLine{6336 \textcolor{comment}{!}}
\DoxyCodeLine{6337 \textcolor{comment}{!            inds = inds1}}
\DoxyCodeLine{6338 \textcolor{comment}{!            inds(k) = inds(k) + 1}}
\DoxyCodeLine{6339 \textcolor{comment}{!            Daux = Daux + Zadjf(l) * Dexpgr(n0-\/1,inds(1),inds(2),inds(3),0)}}
\DoxyCodeLine{6340 }
\DoxyCodeLine{6341 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6342 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr C\_0 1c'},n0-\/1,inds1(1),inds1(2),inds1(3),c\_0(n0-\/1,inds1(1),inds1(2),inds1(3))}
\DoxyCodeLine{6343             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 1c'},-\/\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)*c\_0(n0-\/1,inds1(1),inds1(2),inds1(3))}
\DoxyCodeLine{6344             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 1s'},daux,daux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{6345 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6346 \textcolor{preprocessor}{}}
\DoxyCodeLine{6347             inds = inds1}
\DoxyCodeLine{6348             inds(k) = inds(k)+1}
\DoxyCodeLine{6349             \textcolor{keywordflow}{do} i=1,3}
\DoxyCodeLine{6350               daux = daux -\/ \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,l)*shat(n0-\/1,inds(1),inds(2),inds(3),i)}
\DoxyCodeLine{6351 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6352 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 2ci'}, -\/\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,l)*shat(n0-\/1,inds(1),inds(2),inds(3),i)}
\DoxyCodeLine{6353 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6354 \textcolor{preprocessor}{}\textcolor{keywordflow}{            end do}}
\DoxyCodeLine{6355 }
\DoxyCodeLine{6356 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6357 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 2s'},daux,daux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{6358 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6359 \textcolor{preprocessor}{}}
\DoxyCodeLine{6360             \textcolor{keywordflow}{do} i=1,3}
\DoxyCodeLine{6361               inds = inds1}
\DoxyCodeLine{6362               inds(i) = inds(i)+1}
\DoxyCodeLine{6363               daux = daux + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)*shat(n0-\/1,inds(1),inds(2),inds(3),i)}
\DoxyCodeLine{6364 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6365 \textcolor{preprocessor}{}              \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 3ci'},\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)*shat(n0-\/1,inds(1),inds(2),inds(3),i)}
\DoxyCodeLine{6366 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6367 \textcolor{preprocessor}{}\textcolor{keywordflow}{            end do}}
\DoxyCodeLine{6368 }
\DoxyCodeLine{6369 }
\DoxyCodeLine{6370 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6371 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 3s'},daux,daux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{6372 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6373 \textcolor{preprocessor}{}}
\DoxyCodeLine{6374             daux = daux + 2*(nn+1) *zadj2(n ,m )*shat(n0,inds0(1),inds0(2),inds0(3),m)  \&}
\DoxyCodeLine{6375                         + 2*(nn+1) *zadj2(n ,mt)*shat(n0,inds0(1),inds0(2),inds0(3),mt)}
\DoxyCodeLine{6376 }
\DoxyCodeLine{6377 }
\DoxyCodeLine{6378 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6379 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 4ca'}, 2*(nn+1) *zadj2(n ,m )*shat(n0,inds0(1),inds0(2),inds0(3),m) }
\DoxyCodeLine{6380             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 4cb'}, 2*(nn+1) *zadj2(n ,mt)*shat(n0,inds0(1),inds0(2),inds0(3),mt)}
\DoxyCodeLine{6381             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 4s'},daux,daux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{6382 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6383 \textcolor{preprocessor}{}}
\DoxyCodeLine{6384 \textcolor{comment}{!            Daux = Daux -\/ 2*(nn+1)* Zadj2f(k,n,l)*Dexpgr(n0,inds0(1),inds0(2),inds0(3),0) }}
\DoxyCodeLine{6385 }
\DoxyCodeLine{6386             \textcolor{keywordflow}{if} (nnt.gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6387               inds = inds1}
\DoxyCodeLine{6388               inds(nt) = inds(nt)-\/1}
\DoxyCodeLine{6389               daux = daux + 2*nnt*zadj2(nt,m )*shat(n0,inds(1),inds(2),inds(3),m)  \&}
\DoxyCodeLine{6390                           + 2*nnt*zadj2(nt,mt)*shat(n0,inds(1),inds(2),inds(3),mt)}
\DoxyCodeLine{6391               daux = daux -\/ 2*nnt*zadj2f(k,nt,l)*dexpgr(n0,inds(1),inds(2),inds(3),0) }
\DoxyCodeLine{6392 }
\DoxyCodeLine{6393 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6394 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 5ci'}, 2*nnt*zadj2(nt,m )*shat(n0,inds(1),inds(2),inds(3),m) }
\DoxyCodeLine{6395             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 5ci'}, 2*nnt*zadj2(nt,mt)*shat(n0,inds(1),inds(2),inds(3),mt) }
\DoxyCodeLine{6396             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 5ci'}, 2*nnt*zadj2f(k,nt,l)*dexpgr(n0,inds(1),inds(2),inds(3),0) }
\DoxyCodeLine{6397             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 5cii'}, 2*nnt*zadj2(nt,m ),shat(n0,inds(1),inds(2),inds(3),m) }
\DoxyCodeLine{6398             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 5cii'}, 2*nnt*zadj2(nt,mt),shat(n0,inds(1),inds(2),inds(3),mt) }
\DoxyCodeLine{6399             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 5cii'}, 2*nnt*zadj2f(k,nt,l),dexpgr(n0,inds(1),inds(2),inds(3),0) }
\DoxyCodeLine{6400             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 5s'},daux,daux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{6401 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6402 \textcolor{preprocessor}{}\textcolor{keywordflow}{            endif}}
\DoxyCodeLine{6403 }
\DoxyCodeLine{6404 }
\DoxyCodeLine{6405             inds = inds1}
\DoxyCodeLine{6406             \textcolor{keywordflow}{if}(m.eq.n) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6407               \textcolor{keywordflow}{if} (inds(n).gt.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6408                 inds(n) = inds(n)-\/2}
\DoxyCodeLine{6409                 daux = daux -\/ 4*(nn+1)*nn * zadj2(n,m ) * dexpgr(n0+1,inds(1),inds(2),inds(3),0) }
\DoxyCodeLine{6410 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6411 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 6c'},4*(nn+1)*nn* zadj2(n,m ) *dexpgr(n0+1,inds(1),inds(2),inds(3),0) }
\DoxyCodeLine{6412                 \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 6s'},daux,daux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{6413 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6414 \textcolor{preprocessor}{}\textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6415             \textcolor{keywordflow}{else}}
\DoxyCodeLine{6416               \textcolor{keywordflow}{if} (inds(n).gt.0.and.inds(m).gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6417                 inds(n) = inds(n)-\/1}
\DoxyCodeLine{6418                 inds(m) = inds(m)-\/1}
\DoxyCodeLine{6419                 daux = daux -\/ 4*(nn+1)*(inds(m)+1)* zadj2(n,m ) * dexpgr(n0+1,inds(1),inds(2),inds(3),0) }
\DoxyCodeLine{6420 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6421 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 6c'},-\/4*(nn+1)*(inds(m)+1)* zadj2(n,m ) *dexpgr(n0+1,inds(1),inds(2),inds(3),0) }
\DoxyCodeLine{6422                 \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 6s'},daux,daux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{6423 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6424 \textcolor{preprocessor}{}\textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6425 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{6426 }
\DoxyCodeLine{6427 }
\DoxyCodeLine{6428             inds = inds1}
\DoxyCodeLine{6429             \textcolor{keywordflow}{if}(m.eq.nt) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6430               \textcolor{keywordflow}{if} (inds(nt).gt.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6431                 inds(nt) = inds(nt)-\/2}
\DoxyCodeLine{6432                 daux = daux -\/ 4*nnt*(nnt-\/1) * zadj2(nt,m ) * dexpgr(n0+1,inds(1),inds(2),inds(3),0) }
\DoxyCodeLine{6433 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6434 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 7c'},4*nnt*(nnt-\/1) * zadj2(nt,m ) *dexpgr(n0+1,inds(1),inds(2),inds(3),0) }
\DoxyCodeLine{6435                 \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 7s'},daux,daux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{6436 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6437 \textcolor{preprocessor}{}\textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6438             \textcolor{keywordflow}{else}}
\DoxyCodeLine{6439               \textcolor{keywordflow}{if} (inds(nt).gt.0.and.inds(m).gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6440                 inds(nt) = inds(nt)-\/1}
\DoxyCodeLine{6441                 inds(m) = inds(m)-\/1}
\DoxyCodeLine{6442                 daux = daux -\/ 4*nnt*(inds(m)+1)* zadj2(nt,m )* dexpgr(n0+1,inds(1),inds(2),inds(3),0) }
\DoxyCodeLine{6443 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6444 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 7c'},4*nnt*(inds(m)+1)* zadj2(nt,m )* dexpgr(n0,inds(1),inds(2),inds(3),0)}
\DoxyCodeLine{6445                 \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 7s'},daux,daux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{6446 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6447 \textcolor{preprocessor}{}\textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6448 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{6449 }
\DoxyCodeLine{6450 }
\DoxyCodeLine{6451             inds = inds1}
\DoxyCodeLine{6452             \textcolor{keywordflow}{if}(mt.eq.n) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6453               \textcolor{keywordflow}{if} (inds(n).gt.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6454                 inds(n) = inds(n)-\/2}
\DoxyCodeLine{6455                 daux = daux -\/ 4*(nn+1)*nn * zadj2(n ,mt)* dexpgr(n0+1,inds(1),inds(2),inds(3),0) }
\DoxyCodeLine{6456 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6457 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 8c'},-\/ 4*(nn+1)*nn * zadj2(n ,mt)* dexpgr(n0+1,inds(1),inds(2),inds(3),0)  \&}
\DoxyCodeLine{6458              , n0+1,inds(1),inds(2),inds(3)}
\DoxyCodeLine{6459                 \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 8s'},daux,daux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{6460 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6461 \textcolor{preprocessor}{}\textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6462             \textcolor{keywordflow}{else}}
\DoxyCodeLine{6463               \textcolor{keywordflow}{if} (inds(n).gt.0.and.inds(mt).gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6464                 inds(n) = inds(n)-\/1}
\DoxyCodeLine{6465                 inds(mt) = inds(mt)-\/1}
\DoxyCodeLine{6466                 daux = daux -\/ 4*(nn+1)*(inds(mt)+1)* zadj2(n ,mt)* dexpgr(n0+1,inds(1),inds(2),inds(3),0) }
\DoxyCodeLine{6467 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6468 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 8c'},-\/ 4*(nn+1)*(inds(mt)+1)* zadj2(n ,mt)* dexpgr(n0+1,inds(1),inds(2),inds(3),0)   \&}
\DoxyCodeLine{6469              ,n0+1,inds(1),inds(2),inds(3)}
\DoxyCodeLine{6470                 \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 8s'},daux,daux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{6471 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6472 \textcolor{preprocessor}{}\textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6473 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{6474 }
\DoxyCodeLine{6475 }
\DoxyCodeLine{6476             inds = inds1}
\DoxyCodeLine{6477             \textcolor{keywordflow}{if}(mt.eq.nt) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6478               \textcolor{keywordflow}{if} (inds(nt).gt.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6479                 inds(nt) = inds(nt)-\/2}
\DoxyCodeLine{6480                 daux = daux -\/ 4*nnt*(nnt-\/1)  * zadj2(nt,mt)* dexpgr(n0+1,inds(1),inds(2),inds(3),0) }
\DoxyCodeLine{6481 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6482 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 9c'}, -\/ 4*nnt*(nnt-\/1)  * zadj2(nt,mt) * dexpgr(n0+1,inds(1),inds(2),inds(3),0) }
\DoxyCodeLine{6483                 \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 9s'},daux,daux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{6484 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6485 \textcolor{preprocessor}{}\textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6486             \textcolor{keywordflow}{else}}
\DoxyCodeLine{6487               \textcolor{keywordflow}{if} (inds(nt).gt.0.and.inds(mt).gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6488                 inds(nt) = inds(nt)-\/1}
\DoxyCodeLine{6489                 inds(mt) = inds(mt)-\/1}
\DoxyCodeLine{6490                 daux = daux -\/ 4*nnt*(inds(mt)+1) * zadj2(nt,mt)* dexpgr(n0+1,inds(1),inds(2),inds(3),0) }
\DoxyCodeLine{6491 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6492 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 9c'},-\/ 4*nnt*(inds(mt)+1) * zadj2(nt,mt) * dexpgr(n0+1,inds(1),inds(2),inds(3),0) }
\DoxyCodeLine{6493                 \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Daux 9s'},daux,daux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{6494 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6495 \textcolor{preprocessor}{}\textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6496 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{6497 }
\DoxyCodeLine{6498             dexpgr(n0,inds0(1),inds0(2),inds0(3),0) = daux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{6499 }
\DoxyCodeLine{6500 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6501 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Dexpgr'},n0,inds0(1),inds0(2),inds0(3),dexpgr(n0,inds0(1),inds0(2),inds0(3),0)}
\DoxyCodeLine{6502 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6503 \textcolor{preprocessor}{}}
\DoxyCodeLine{6504             \textcolor{keywordflow}{if} (n0.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6505               maxdexpgr(1,r,0) =  maxdexpgr(1,r,0) + abs(dexpgr(n0,inds0(1),inds0(2),inds0(3),0) )}
\DoxyCodeLine{6506 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{6507 }
\DoxyCodeLine{6508 \textcolor{comment}{!            if (r+n0.le.rmax) then          !  for fixed rank}}
\DoxyCodeLine{6509             \textcolor{keywordflow}{if} (r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6510               d(n0,inds0(1),inds0(2),inds0(3)) = dexpgr(n0,inds0(1),inds0(2),inds0(3),0)}
\DoxyCodeLine{6511 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{6512 }
\DoxyCodeLine{6513 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{6514 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{6515 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{6516 }
\DoxyCodeLine{6517       \textcolor{comment}{! calculate}}
\DoxyCodeLine{6518       \textcolor{comment}{! D\_00ijkl.. -\/-\/> D\_aijkl..}}
\DoxyCodeLine{6519       \textcolor{comment}{! exploiting eq. (5.38)}}
\DoxyCodeLine{6520       maxdexpgr(0,r,0)=0d0}
\DoxyCodeLine{6521       \textcolor{keywordflow}{do} n1=0,r}
\DoxyCodeLine{6522         \textcolor{keywordflow}{do} n2=0,r-\/n1}
\DoxyCodeLine{6523           n3 = r-\/n1-\/n2}
\DoxyCodeLine{6524 }
\DoxyCodeLine{6525           smod = shat(0,n1,n2,n3,:)}
\DoxyCodeLine{6526           \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6527             smod(1) = smod(1) -\/ 2d0*n1*dexpgr(1,n1-\/1,n2,n3,0)}
\DoxyCodeLine{6528 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{6529           \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6530             smod(2) = smod(2) -\/ 2d0*n2*dexpgr(1,n1,n2-\/1,n3,0)}
\DoxyCodeLine{6531 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{6532           \textcolor{keywordflow}{if} (n3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6533             smod(3) = smod(3) -\/ 2d0*n3*dexpgr(1,n1,n2,n3-\/1,0)}
\DoxyCodeLine{6534 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{6535 }
\DoxyCodeLine{6536           dexpgr(0,n1,n2,n3,0) = (\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1) +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2)  \&}
\DoxyCodeLine{6537                               +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,j)*smod(3))/zadjfj}
\DoxyCodeLine{6538           maxdexpgr(0,r,0) =  maxdexpgr(0,r,0) + abs(dexpgr(0,n1,n2,n3,0))}
\DoxyCodeLine{6539           \textcolor{keywordflow}{if} (r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6540             d(0,n1,n2,n3) = dexpgr(0,n1,n2,n3,0)}
\DoxyCodeLine{6541 \textcolor{comment}{!            Derr(r-\/1) =  abs(detZ/Zadjfj*Dexpgr(0,n1,n2,n3,0))}}
\DoxyCodeLine{6542 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{6543 }
\DoxyCodeLine{6544 }
\DoxyCodeLine{6545 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6546 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6547 \textcolor{comment}{!            write(*,*) 'CalcDgr D(0,n1,n2,n3,0)=',n1,n2,n3,D(0,n1,n2,n3)}}
\DoxyCodeLine{6548 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{6549 }
\DoxyCodeLine{6550           \textcolor{keywordflow}{if}(n0.eq.0.and.n1.eq.3.and.n2.eq.0.and.n3.eq.0) \textcolor{keywordflow}{then} }
\DoxyCodeLine{6551             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Smod(0,3,0,0,1)= '},shat(0,n1,n2,n3,1)}
\DoxyCodeLine{6552             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Smod(0,3,0,0,2)= '},shat(0,n1,n2,n3,2)}
\DoxyCodeLine{6553             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Smod(0,3,0,0,3)= '},shat(0,n1,n2,n3,3)}
\DoxyCodeLine{6554             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'D(1,2,0,0)= '},0,dexpgr(1,2,n2,n3,0)}
\DoxyCodeLine{6555             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'D(0,3,0,0)= '},0,d(n0,n1,n2,n3)}
\DoxyCodeLine{6556 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{6557 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6558 \textcolor{preprocessor}{}}
\DoxyCodeLine{6559 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{6560 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{6561 }
\DoxyCodeLine{6562 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6563 \textcolor{preprocessor}{}\textcolor{comment}{!      write(*,*) 'CalcDgr maxDexpgr 0',r-\/1, maxDexpgr(0,r-\/1,0)}}
\DoxyCodeLine{6564 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6565 \textcolor{preprocessor}{}}
\DoxyCodeLine{6566       \textcolor{keywordflow}{if}(r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6567 \textcolor{comment}{!       Derr(r) =  abs(detZ/Zadjfj)*maxDexpgr(0,r,0)}}
\DoxyCodeLine{6568         derr(r) =  \mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}}*maxdexpgr(0,r,0)}
\DoxyCodeLine{6569 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{6570 }
\DoxyCodeLine{6571       \textcolor{comment}{! error propagation from C's}}
\DoxyCodeLine{6572       \textcolor{keywordflow}{if}(r.gt.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{6573         d00\_err(r+1) = \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*cij\_err(r+1)/(2*maxzadj2f)}
\DoxyCodeLine{6574 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6575       dij\_err(r)=\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(cij\_err(r),2*d00\_err(r+1))/abs(zadjfj)}
\DoxyCodeLine{6576 }
\DoxyCodeLine{6577       \textcolor{keywordflow}{if}(r.gt.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{6578         d00\_err2(r+1) = \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*cij\_err2(r+1)/(2*maxzadj2f)}
\DoxyCodeLine{6579 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6580       dij\_err2(r)=\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(cij\_err2(r),2*d00\_err2(r+1))/abs(zadjfj)}
\DoxyCodeLine{6581 }
\DoxyCodeLine{6582       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{6583       \textcolor{comment}{! higher order coefficients}}
\DoxyCodeLine{6584       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{6585 }
\DoxyCodeLine{6586       rg = r}
\DoxyCodeLine{6587       gloop: \textcolor{keywordflow}{do} g=1,min(gtrunc,r)}
\DoxyCodeLine{6588         rg = rg-\/1}
\DoxyCodeLine{6589 }
\DoxyCodeLine{6590 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6591 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr: gloop '},r,rg,g}
\DoxyCodeLine{6592 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6593 \textcolor{preprocessor}{}}
\DoxyCodeLine{6594         \textcolor{comment}{! calculating}}
\DoxyCodeLine{6595         \textcolor{comment}{! D\_00(a)0000..00 -\/-\/> D\_00(a)ij00..00 -\/-\/> D\_00(a)ijkl00..00 -\/-\/> ... -\/-\/> D\_00(a)ijklmn..}}
\DoxyCodeLine{6596        \textcolor{comment}{! exploiting eq. (5.40) -\/ (5.53) solved for D\_00i1..<ir>...iP}}
\DoxyCodeLine{6597         maxdexpgr(1,rg,g) = 0d0}
\DoxyCodeLine{6598         \textcolor{keywordflow}{do} n0=rg,1,-\/1                      \textcolor{comment}{!  note rank of tensor = rg+n0}}
\DoxyCodeLine{6599           \textcolor{keywordflow}{do} nn=rg-\/n0,0,-\/1}
\DoxyCodeLine{6600             \textcolor{keywordflow}{do} nnt=rg-\/n0-\/nn,0,-\/1}
\DoxyCodeLine{6601               nntt = rg-\/n0-\/nn-\/nnt}
\DoxyCodeLine{6602               inds0(n) = nn}
\DoxyCodeLine{6603               inds0(nt) = nnt}
\DoxyCodeLine{6604               inds0(k) = nntt}
\DoxyCodeLine{6605               }
\DoxyCodeLine{6606               inds1(n) = nn+1}
\DoxyCodeLine{6607               inds1(nt) = nnt}
\DoxyCodeLine{6608               inds1(k) = nntt}
\DoxyCodeLine{6609               }
\DoxyCodeLine{6610 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6611 \textcolor{preprocessor}{}\textcolor{comment}{!              write(*,*) 'CalcDgr Daux r inds=',n0,inds0}}
\DoxyCodeLine{6612 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{6613 \textcolor{preprocessor}{}}
\DoxyCodeLine{6614               daux = 2*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l) * (2+rg-\/n0) * dexpgr(n0,inds1(1),inds1(2),inds1(3),g-\/1)}
\DoxyCodeLine{6615               }
\DoxyCodeLine{6616 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6617 \textcolor{preprocessor}{}\textcolor{comment}{!              write(*,*) 'CalcDgr Daux r1c',2*Zadj(k,l)*(2+rg-\/n0)* Dexpgr(n0,inds1(1),inds1(2),inds1(3),g-\/1)}}
\DoxyCodeLine{6618 \textcolor{comment}{!              write(*,*) 'CalcDgr Daux r1c',2*Zadj(k,l)*(2+rg-\/n0),Dexpgr(n0,inds1(1),inds1(2),inds1(3),g-\/1) \&}}
\DoxyCodeLine{6619 \textcolor{comment}{!                   ,n0,inds1(1),inds1(2),inds1(3)}}
\DoxyCodeLine{6620 \textcolor{comment}{!              write(*,*) 'CalcDgr Daux r1s',Daux,Daux/(2*(nn+1)* Zadj2f(k,n,l))}}
\DoxyCodeLine{6621 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{6622 \textcolor{preprocessor}{}}
\DoxyCodeLine{6623               \textcolor{keywordflow}{if} (g.gt.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6624                 inds = inds1}
\DoxyCodeLine{6625                 inds(k) = inds(k) + 1}
\DoxyCodeLine{6626                 inds(l) = inds(l) + 1}
\DoxyCodeLine{6627                 daux = daux + \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}} * dexpgr(n0-\/1,inds(1),inds(2),inds(3),g-\/2)}
\DoxyCodeLine{6628                 }
\DoxyCodeLine{6629 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6630 \textcolor{preprocessor}{}\textcolor{comment}{!                write(*,*) 'CalcDgr Daux r2c',detZ * Dexpgr(n0-\/1,inds(1),inds(2),inds(3),g-\/2)}}
\DoxyCodeLine{6631 \textcolor{comment}{!                write(*,*) 'CalcDgr Daux r2s',Daux,Daux/(2*(nn+1)* Zadj2f(k,n,l))}}
\DoxyCodeLine{6632 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{6633 \textcolor{preprocessor}{}\textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6634 }
\DoxyCodeLine{6635               inds = inds1}
\DoxyCodeLine{6636               inds(k) = inds(k) + 1}
\DoxyCodeLine{6637               daux = daux + \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(l) * dexpgr(n0-\/1,inds(1),inds(2),inds(3),g-\/1)}
\DoxyCodeLine{6638               }
\DoxyCodeLine{6639 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6640 \textcolor{preprocessor}{}\textcolor{comment}{!              write(*,*) 'CalcDgr Daux r3c',Zadjf(l)* Dexpgr(n0-\/1,inds(1),inds(2),inds(3),g-\/1)}}
\DoxyCodeLine{6641 \textcolor{comment}{!              write(*,*) 'CalcDgr Daux r3c',Zadjf(l),Dexpgr(n0-\/1,inds(1),inds(2),inds(3),g-\/1),n0-\/1,inds(1),inds(2),inds(3)}}
\DoxyCodeLine{6642 \textcolor{comment}{!              write(*,*) 'CalcDgr Daux r3s',Daux,Daux/(2*(nn+1)* Zadj2f(k,n,l))}}
\DoxyCodeLine{6643 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{6644 \textcolor{preprocessor}{}}
\DoxyCodeLine{6645 \textcolor{comment}{!            Daux = Daux -\/ 2*nn* Zadj2f(k,n,l)*Dexpgr(n0,inds0(1),inds0(2),inds0(3),g) }}
\DoxyCodeLine{6646 }
\DoxyCodeLine{6647               \textcolor{keywordflow}{if} (nnt.gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6648                 inds = inds1}
\DoxyCodeLine{6649                 inds(nt) = inds(nt)-\/1}
\DoxyCodeLine{6650                 daux = daux -\/ 2*nnt*zadj2f(k,nt,l)*dexpgr(n0,inds(1),inds(2),inds(3),g) }
\DoxyCodeLine{6651 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6652 \textcolor{preprocessor}{}\textcolor{comment}{!              write(*,*) 'CalcDgr Daux r4c',-\/ 2*nnt*Zadj2f(k,nt,l)*Dexpgr(n0,inds(1),inds(2),inds(3),g) }}
\DoxyCodeLine{6653 \textcolor{comment}{!              write(*,*) 'CalcDgr Daux r4c',-\/ 2*nnt,Zadj2f(k,nt,l),Dexpgr(n0,inds(1),inds(2),inds(3),g),n0,inds(1),inds(2),inds(3) }}
\DoxyCodeLine{6654 \textcolor{comment}{!              write(*,*) 'CalcDgr Daux r4s',Daux,Daux/(2*(nn+1)* Zadj2f(k,n,l))}}
\DoxyCodeLine{6655 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{6656 \textcolor{preprocessor}{}\textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6657 }
\DoxyCodeLine{6658 }
\DoxyCodeLine{6659               inds = inds1}
\DoxyCodeLine{6660               \textcolor{keywordflow}{if}(m.eq.n) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6661                 \textcolor{keywordflow}{if} (inds(n).gt.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6662                   inds(n) = inds(n)-\/2}
\DoxyCodeLine{6663                   daux = daux -\/ 4*(nn+1)*nn * zadj2(n,m ) * dexpgr(n0+1,inds(1),inds(2),inds(3),g) }
\DoxyCodeLine{6664 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6665 \textcolor{preprocessor}{}\textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r6c',4*(nn+1)*nn* Zadj2(n,m ) *Dexpgr(n0+1,inds(1),inds(2),inds(3),g) }}
\DoxyCodeLine{6666 \textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r6s',Daux,Daux/(2*(nn+1)* Zadj2f(k,n,l))}}
\DoxyCodeLine{6667 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{6668 \textcolor{preprocessor}{}\textcolor{keywordflow}{                endif}}
\DoxyCodeLine{6669               \textcolor{keywordflow}{else}}
\DoxyCodeLine{6670                 \textcolor{keywordflow}{if} (inds(n).gt.0.and.inds(m).gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6671                   inds(n) = inds(n)-\/1}
\DoxyCodeLine{6672                   inds(m) = inds(m)-\/1}
\DoxyCodeLine{6673                   daux = daux -\/ 4*(nn+1)*(inds(m)+1)* zadj2(n,m ) * dexpgr(n0+1,inds(1),inds(2),inds(3),g) }
\DoxyCodeLine{6674 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6675 \textcolor{preprocessor}{}\textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r6c',4*(nn+1)*(inds(m)+1)* Zadj2(n,m ) *Dexpgr(n0+1,inds(1),inds(2),inds(3),g) }}
\DoxyCodeLine{6676 \textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r6c',n,m,nn,4*(nn+1)*(inds(m)+1),Zadj2(n,m ),Dexpgr(n0+1,inds(1),inds(2),inds(3),g) }}
\DoxyCodeLine{6677 \textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r6s',Daux,Daux/(2*(nn+1)* Zadj2f(k,n,l))}}
\DoxyCodeLine{6678 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{6679 \textcolor{preprocessor}{}\textcolor{keywordflow}{                endif}}
\DoxyCodeLine{6680 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6681               }
\DoxyCodeLine{6682               inds = inds1}
\DoxyCodeLine{6683               \textcolor{keywordflow}{if}(m.eq.nt) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6684                 \textcolor{keywordflow}{if} (inds(nt).gt.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6685                   inds(nt) = inds(nt)-\/2}
\DoxyCodeLine{6686                   daux = daux -\/ 4*nnt*(nnt-\/1) * zadj2(nt,m ) * dexpgr(n0+1,inds(1),inds(2),inds(3),g) }
\DoxyCodeLine{6687 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6688 \textcolor{preprocessor}{}\textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r7c',4*nnt*(nnt-\/1) * Zadj2(nt,m ) *Dexpgr(n0+1,inds(1),inds(2),inds(3),g) }}
\DoxyCodeLine{6689 \textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r7s',Daux,Daux/(2*(nn+1)* Zadj2f(k,n,l))}}
\DoxyCodeLine{6690 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{6691 \textcolor{preprocessor}{}\textcolor{keywordflow}{                endif}}
\DoxyCodeLine{6692               \textcolor{keywordflow}{else}}
\DoxyCodeLine{6693                 \textcolor{keywordflow}{if} (inds(nt).gt.0.and.inds(m).gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6694                   inds(nt) = inds(nt)-\/1}
\DoxyCodeLine{6695                   inds(m) = inds(m)-\/1}
\DoxyCodeLine{6696                   daux = daux -\/ 4*nnt*(inds(m)+1)* zadj2(nt,m )* dexpgr(n0+1,inds(1),inds(2),inds(3),g) }
\DoxyCodeLine{6697 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6698 \textcolor{preprocessor}{}\textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r7c',4*nnt*(inds(m)+1)* Zadj2(nt,m )* Dexpgr(n0,inds(1),inds(2),inds(3),g)}}
\DoxyCodeLine{6699 \textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r7s',Daux,Daux/(2*(nn+1)* Zadj2f(k,n,l))}}
\DoxyCodeLine{6700 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{6701 \textcolor{preprocessor}{}\textcolor{keywordflow}{                endif}}
\DoxyCodeLine{6702 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6703 }
\DoxyCodeLine{6704               inds = inds1}
\DoxyCodeLine{6705               \textcolor{keywordflow}{if}(mt.eq.n) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6706                 \textcolor{keywordflow}{if} (inds(n).gt.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6707                   inds(n) = inds(n)-\/2}
\DoxyCodeLine{6708                   daux = daux -\/ 4*(nn+1)*nn * zadj2(n ,mt)* dexpgr(n0+1,inds(1),inds(2),inds(3),g) }
\DoxyCodeLine{6709 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6710 \textcolor{preprocessor}{}\textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r8c',-\/ 4*(nn+1)*nn * Zadj2(n ,mt)* Dexpgr(n0+1,inds(1),inds(2),inds(3),g) }}
\DoxyCodeLine{6711 \textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r8c',n,mt,nn,-\/ 4*(nn+1)*nn,Zadj2(n ,mt),Dexpgr(n0+1,inds(1),inds(2),inds(3),g) }}
\DoxyCodeLine{6712 \textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r8s',Daux,Daux/(2*(nn+1)* Zadj2f(k,n,l))}}
\DoxyCodeLine{6713 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{6714 \textcolor{preprocessor}{}\textcolor{keywordflow}{                endif}}
\DoxyCodeLine{6715               \textcolor{keywordflow}{else}}
\DoxyCodeLine{6716                 \textcolor{keywordflow}{if} (inds(n).gt.0.and.inds(mt).gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6717                   inds(n) = inds(n)-\/1}
\DoxyCodeLine{6718                   inds(mt) = inds(mt)-\/1}
\DoxyCodeLine{6719                   daux = daux -\/ 4*(nn+1)*(inds(mt)+1)* zadj2(n ,mt)* dexpgr(n0+1,inds(1),inds(2),inds(3),g) }
\DoxyCodeLine{6720 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6721 \textcolor{preprocessor}{}\textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r8c',-\/ 4*(nn+1)*(inds(mt)+1)* Zadj2(n ,mt) * Dexpgr(n0+1,inds(1),inds(2),inds(3),g)}}
\DoxyCodeLine{6722 \textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r8s',Daux,Daux/(2*(nn+1)* Zadj2f(k,n,l))}}
\DoxyCodeLine{6723 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{6724 \textcolor{preprocessor}{}\textcolor{keywordflow}{                endif}}
\DoxyCodeLine{6725 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6726 }
\DoxyCodeLine{6727               inds = inds1}
\DoxyCodeLine{6728               \textcolor{keywordflow}{if}(mt.eq.nt) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6729                 \textcolor{keywordflow}{if} (inds(nt).gt.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6730                   inds(nt) = inds(nt)-\/2}
\DoxyCodeLine{6731                   daux = daux -\/ 4*nnt*(nnt-\/1)  * zadj2(nt,mt)* dexpgr(n0+1,inds(1),inds(2),inds(3),g) }
\DoxyCodeLine{6732 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6733 \textcolor{preprocessor}{}\textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r9c', -\/ 4*nnt*(nnt-\/1)  * Zadj2(nt,mt) * Dexpgr(n0+1,inds(1),inds(2),inds(3),g) }}
\DoxyCodeLine{6734 \textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r9s',Daux,Daux/(2*(nn+1)* Zadj2f(k,n,l))}}
\DoxyCodeLine{6735 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{6736 \textcolor{preprocessor}{}\textcolor{keywordflow}{                endif}}
\DoxyCodeLine{6737               \textcolor{keywordflow}{else}}
\DoxyCodeLine{6738                 \textcolor{keywordflow}{if} (inds(nt).gt.0.and.inds(mt).gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6739                   inds(nt) = inds(nt)-\/1}
\DoxyCodeLine{6740                   inds(mt) = inds(mt)-\/1}
\DoxyCodeLine{6741                   daux = daux -\/ 4*nnt*(inds(mt)+1) * zadj2(nt,mt)* dexpgr(n0+1,inds(1),inds(2),inds(3),g) }
\DoxyCodeLine{6742 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6743 \textcolor{preprocessor}{}\textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r9c',-\/ 4*nnt*(inds(mt)+1) * Zadj2(nt,mt) * Dexpgr(n0+1,inds(1),inds(2),inds(3),g) }}
\DoxyCodeLine{6744 \textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r9c',nt,mt,nnt,-\/ 4*nnt*(inds(mt)+1) , Zadj2(nt,mt) , \&}}
\DoxyCodeLine{6745 \textcolor{comment}{!                          Dexpgr(n0+1,inds(1),inds(2),inds(3),g) }}
\DoxyCodeLine{6746 \textcolor{comment}{!                  write(*,*) 'CalcDgr Daux r9s',Daux,Daux/(2*(nn+1)* Zadj2f(k,n,l))}}
\DoxyCodeLine{6747 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{6748 \textcolor{preprocessor}{}\textcolor{keywordflow}{                endif}}
\DoxyCodeLine{6749 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6750 }
\DoxyCodeLine{6751               dexpgr(n0,inds0(1),inds0(2),inds0(3),g) = daux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{6752                              }
\DoxyCodeLine{6753               \textcolor{keywordflow}{if}(n0.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6754                 maxdexpgr(1,rg,g) =  maxdexpgr(1,rg,g) + abs(dexpgr(n0,inds0(1),inds0(2),inds0(3),g))}
\DoxyCodeLine{6755 }
\DoxyCodeLine{6756 }
\DoxyCodeLine{6757                 \textcolor{keywordflow}{if} (g.eq.1.and.abs(dexpgr(1,inds0(1),inds0(2),inds0(3),g)).gt.  \&}
\DoxyCodeLine{6758                     truncfacexp*max(1/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}},maxdexpgr(1,rg,g-\/1)) .or. \&}
\DoxyCodeLine{6759                     g.ge.2.and.abs(dexpgr(1,inds0(1),inds0(2),inds0(3),g)).gt.  \&}
\DoxyCodeLine{6760                     truncfacexp*maxdexpgr(1,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6761 }
\DoxyCodeLine{6762 }
\DoxyCodeLine{6763 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6764 \textcolor{preprocessor}{}\textcolor{comment}{!                  write(*,*) 'CalcDgr exit gloop',n0,inds0(1),inds0(2),inds0(3),g,rg,  \&}}
\DoxyCodeLine{6765 \textcolor{comment}{!                         abs(Dexpgr(n0,inds0(1),inds0(2),inds0(3),g)),maxDexpgr(1,rg,g-\/1),truncfacexp}}
\DoxyCodeLine{6766 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{6767 \textcolor{preprocessor}{}}
\DoxyCodeLine{6768                   gtrunc = g-\/1}
\DoxyCodeLine{6769                   \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{6770 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{6771 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{6772 }
\DoxyCodeLine{6773 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{6774 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{6775 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{6776 }
\DoxyCodeLine{6777 \textcolor{preprocessor}{\#ifndef PPEXP00}}
\DoxyCodeLine{6778 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (rg.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6779           \textcolor{keywordflow}{do} n0=rg,1,-\/1}
\DoxyCodeLine{6780 \textcolor{comment}{!            if (rg+n0.le.rmax) then             ! for fixed rank!}}
\DoxyCodeLine{6781             \textcolor{keywordflow}{if} (rg.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6782               \textcolor{keywordflow}{do} n1=0,rg-\/n0}
\DoxyCodeLine{6783                 \textcolor{keywordflow}{do} n2=0,rg-\/n0-\/n1}
\DoxyCodeLine{6784                   n3=rg-\/n0-\/n1-\/n2}
\DoxyCodeLine{6785                   d(n0,n1,n2,n3) = d(n0,n1,n2,n3) + dexpgr(n0,n1,n2,n3,g)}
\DoxyCodeLine{6786 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{6787 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{6788 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{6789 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{6790 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6791 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6792 \textcolor{preprocessor}{}\textcolor{comment}{!        write(*,*) 'CalcDgr after it1 ',rg}}
\DoxyCodeLine{6793 }
\DoxyCodeLine{6794         \textcolor{comment}{! calculate}}
\DoxyCodeLine{6795         \textcolor{comment}{! D\_00ijkl.. -\/-\/> D\_aijkl..}}
\DoxyCodeLine{6796         \textcolor{comment}{! exploiting eq. (5.38)}}
\DoxyCodeLine{6797 }
\DoxyCodeLine{6798 \textcolor{comment}{!        write(*,*) 'CalcDgr maxDexp',rg,g-\/1,maxDexpgr(0,rg,g-\/1)}}
\DoxyCodeLine{6799 }
\DoxyCodeLine{6800         maxdexpgr(0,rg,g) = 0d0}
\DoxyCodeLine{6801         \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{6802           \textcolor{keywordflow}{do} n2=0,rg-\/n1}
\DoxyCodeLine{6803             n3 = rg-\/n1-\/n2}
\DoxyCodeLine{6804 }
\DoxyCodeLine{6805             smod = 0d0}
\DoxyCodeLine{6806             \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6807               smod(1) = smod(1) -\/ 2d0*n1*dexpgr(1,n1-\/1,n2,n3,g)}
\DoxyCodeLine{6808 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{6809             \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6810               smod(2) = smod(2) -\/ 2d0*n2*dexpgr(1,n1,n2-\/1,n3,g)}
\DoxyCodeLine{6811 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{6812             \textcolor{keywordflow}{if} (n3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6813               smod(3) = smod(3) -\/ 2d0*n3*dexpgr(1,n1,n2,n3-\/1,g)}
\DoxyCodeLine{6814 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{6815 }
\DoxyCodeLine{6816             inds(1) = n1}
\DoxyCodeLine{6817             inds(2) = n2}
\DoxyCodeLine{6818             inds(3) = n3}
\DoxyCodeLine{6819             inds(j) = inds(j)+1}
\DoxyCodeLine{6820             dexpgr(0,n1,n2,n3,g) = (\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1) +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2)  \&}
\DoxyCodeLine{6821                                 +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,j)*smod(3)  \&}
\DoxyCodeLine{6822                                 -\/ \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*dexpgr(0,inds(1),inds(2),inds(3),g-\/1))/zadjfj}
\DoxyCodeLine{6823 }
\DoxyCodeLine{6824             maxdexpgr(0,rg,g) =  maxdexpgr(0,rg,g) + abs(dexpgr(0,n1,n2,n3,g))}
\DoxyCodeLine{6825 }
\DoxyCodeLine{6826 \textcolor{comment}{!              if(n1.eq.0.and.n2.eq.1.and.n3.eq.2) then }}
\DoxyCodeLine{6827 \textcolor{comment}{!                write(*,*) 'D2(2,3,3)= ',g,Dexpgr(0,n1,n2,n3,g)}}
\DoxyCodeLine{6828 \textcolor{comment}{!                write(*,*) 'D2(2,3,3)= ',Zadj(1,j)*Smod(1)/Zadjfj,  Zadj(2,j)*Smod(2)/Zadjfj,  \&}}
\DoxyCodeLine{6829 \textcolor{comment}{!                                +  Zadj(3,j)*Smod(3)/Zadjfj,  \&}}
\DoxyCodeLine{6830 \textcolor{comment}{!                                -\/ detZ*Dexpgr(0,inds(1),inds(2),inds(3),g-\/1)/Zadjfj}}
\DoxyCodeLine{6831 \textcolor{comment}{!                write(*,*) 'D2(2,3,3)= ',inds(1),inds(2),inds(3),         \&}}
\DoxyCodeLine{6832 \textcolor{comment}{!                                -\/ detZ/Zadjfj,Dexpgr(0,inds(1),inds(2),inds(3),g-\/1)}}
\DoxyCodeLine{6833 \textcolor{comment}{!              end if}}
\DoxyCodeLine{6834 }
\DoxyCodeLine{6835             \textcolor{keywordflow}{if} (g.eq.1.and.abs(dexpgr(0,n1,n2,n3,g)).gt.            \&}
\DoxyCodeLine{6836                 truncfacexp*max(1/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}},maxdexpgr(0,rg,g-\/1)) .or. \&}
\DoxyCodeLine{6837                 g.ge.2.and.abs(dexpgr(0,n1,n2,n3,g)).gt.           \&}
\DoxyCodeLine{6838                 truncfacexp*maxdexpgr(0,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6839 }
\DoxyCodeLine{6840 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6841 \textcolor{preprocessor}{}                  \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr exit gloop'},0,n1,n2,n3,g,abs(dexpgr(0,n1,n2,n3,g)),maxdexpgr(0,rg,g-\/1),truncfacexp}
\DoxyCodeLine{6842 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{6843 \textcolor{preprocessor}{}              gtrunc = g-\/1}
\DoxyCodeLine{6844               \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{6845 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{6846 }
\DoxyCodeLine{6847 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{6848 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{6849 }
\DoxyCodeLine{6850         \textcolor{comment}{! error propagation from C's}}
\DoxyCodeLine{6851         \textcolor{keywordflow}{if}(rg.gt.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{6852           d00\_err(rg+1) = max( d00\_err(rg+1),                   \&}
\DoxyCodeLine{6853               max( \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*(2+rg-\/2*n0)*d00\_err(rg+2),       \&}
\DoxyCodeLine{6854                     abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})*dij\_err(rg+2),                \&}
\DoxyCodeLine{6855                     \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err(rg+1)                   \&}
\DoxyCodeLine{6856                  ) / (2*maxzadj2f)  ) }
\DoxyCodeLine{6857 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6858         dij\_err(rg)=max(dij\_err(rg),                \&}
\DoxyCodeLine{6859             max(2*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*d00\_err(rg+1),abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})*dij\_err(rg))/abs(zadjfj) )}
\DoxyCodeLine{6860 }
\DoxyCodeLine{6861         \textcolor{keywordflow}{if}(rg.gt.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{6862           d00\_err2(rg+1) = max( d00\_err2(rg+1),                   \&}
\DoxyCodeLine{6863               max( \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*(2+rg-\/2*n0)*d00\_err2(rg+2),       \&}
\DoxyCodeLine{6864                     abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})*dij\_err2(rg+2),                \&}
\DoxyCodeLine{6865                     \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err2(rg+1)                   \&}
\DoxyCodeLine{6866                  ) / (2*maxzadj2f)  ) }
\DoxyCodeLine{6867 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6868         dij\_err2(rg)=max(dij\_err2(rg),                \&}
\DoxyCodeLine{6869             max(2*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*d00\_err2(rg+1),abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})*dij\_err2(rg))/abs(zadjfj) )}
\DoxyCodeLine{6870 }
\DoxyCodeLine{6871 \textcolor{preprocessor}{\#ifdef PPEXP00}}
\DoxyCodeLine{6872 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (rg.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6873           \textcolor{keywordflow}{do} n0=rg,1,-\/1}
\DoxyCodeLine{6874 \textcolor{comment}{!            if (rg+n0.le.rmax) then             !  for fixed rank}}
\DoxyCodeLine{6875             \textcolor{keywordflow}{if} (rg.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6876               \textcolor{keywordflow}{do} n1=0,rg-\/n0}
\DoxyCodeLine{6877                 \textcolor{keywordflow}{do} n2=0,rg-\/n0-\/n1}
\DoxyCodeLine{6878                   n3=rg-\/n0-\/n1-\/n2}
\DoxyCodeLine{6879                   d(n0,n1,n2,n3) = d(n0,n1,n2,n3) + dexpgr(n0,n1,n2,n3,g)}
\DoxyCodeLine{6880 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{6881 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{6882 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{6883 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{6884 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6885 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6886 \textcolor{preprocessor}{}}
\DoxyCodeLine{6887         \textcolor{keywordflow}{if} (rg.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6888           derr(rg) = 0d0}
\DoxyCodeLine{6889           \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{6890             \textcolor{keywordflow}{do} n2=0,rg-\/n1}
\DoxyCodeLine{6891               n3 = rg-\/n1-\/n2}
\DoxyCodeLine{6892               d(0,n1,n2,n3) = d(0,n1,n2,n3) + dexpgr(0,n1,n2,n3,g)}
\DoxyCodeLine{6893               \textcolor{keywordflow}{if}(abs(dexpgr(0,n1,n2,n3,g-\/1)).ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6894 \textcolor{comment}{!                Derr(rg)=max(Derr(rg),abs(Dexpgr(0,n1,n2,n3,g))**2/abs(Dexpgr(0,n1,n2,n3,g-\/1)))}}
\DoxyCodeLine{6895                 derr(rg)=max(derr(rg),abs(dexpgr(0,n1,n2,n3,g))*min(1d0,abs(dexpgr(0,n1,n2,n3,g))/abs(dexpgr(0,n1,n2,n3,g-\/1))))}
\DoxyCodeLine{6896               \textcolor{keywordflow}{else}}
\DoxyCodeLine{6897                 derr(rg)=max(derr(rg),abs(dexpgr(0,n1,n2,n3,g)))}
\DoxyCodeLine{6898 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{6899 }
\DoxyCodeLine{6900 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6901 \textcolor{preprocessor}{}\textcolor{comment}{!              write(*,*) 'CalcDgr Derr calc',rg,Derr(rg),n1,n2,n3,abs(Dexpgr(0,n1,n2,n3,g)),abs(Dexpgr(0,n1,n2,n3,g-\/1))}}
\DoxyCodeLine{6902 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6903 \textcolor{preprocessor}{}}
\DoxyCodeLine{6904 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{6905 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{6906 }
\DoxyCodeLine{6907           \textcolor{comment}{! if error from C's larger than error from expansion stop expansion}}
\DoxyCodeLine{6908 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{6909 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(dij\_err2(rg).gt.3d0*derr(rg)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6910 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{6911 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(dij\_err(rg).gt.3d0*derr(rg)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6912 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6913 \textcolor{preprocessor}{}            gtrunc = min(g,gtrunc)}
\DoxyCodeLine{6914              }
\DoxyCodeLine{6915 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6916 \textcolor{preprocessor}{}             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr exit err'},r,rg,g,gtrunc,dij\_err(rg),derr(rg)}
\DoxyCodeLine{6917 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6918 \textcolor{preprocessor}{}}
\DoxyCodeLine{6919 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{6920 }
\DoxyCodeLine{6921 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6922 }
\DoxyCodeLine{6923 \textcolor{keywordflow}{      end do} gloop}
\DoxyCodeLine{6924 }
\DoxyCodeLine{6925 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6926 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(0,0,0,0) = '},r,d(0,0,0,0)}
\DoxyCodeLine{6927     \textcolor{keywordflow}{if}(r.ge.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{6928       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(1,0,0,0) = '},r,d(1,0,0,0)}
\DoxyCodeLine{6929       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(0,1,0,0) = '},r,d(0,1,0,0)}
\DoxyCodeLine{6930       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(0,0,1,0) = '},r,d(0,0,1,0)}
\DoxyCodeLine{6931       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(0,0,0,1) = '},r,d(0,0,0,1)}
\DoxyCodeLine{6932 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{6933     \textcolor{keywordflow}{if}(r.ge.2.and.rmax.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{6934       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(1,1,0,0) = '},r,d(1,1,0,0)}
\DoxyCodeLine{6935       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(1,0,1,0) = '},r,d(1,0,1,0)}
\DoxyCodeLine{6936       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(1,0,0,1) = '},r,d(1,0,0,1)}
\DoxyCodeLine{6937       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(0,2,0,0) = '},r,d(0,2,0,0)}
\DoxyCodeLine{6938 \textcolor{comment}{!      write(*,*) 'CalcDgr D(0,1,1,0) = ',r,D(0,1,1,0)}}
\DoxyCodeLine{6939       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(0,0,2,0) = '},r,d(0,0,2,0)}
\DoxyCodeLine{6940 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{6941     \textcolor{keywordflow}{if}(r.ge.3.and.rmax.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{6942 \textcolor{comment}{!      write(*,*) 'CalcDgr D(3,0,0,0) = ',r,D(3,0,0,0)}}
\DoxyCodeLine{6943 \textcolor{comment}{!      write(*,*) 'CalcDgr D(2,0,1,0) = ',r,D(2,0,1,0)}}
\DoxyCodeLine{6944       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(1,2,0,0) = '},r,d(1,2,0,0)}
\DoxyCodeLine{6945       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(1,0,2,0) = '},r,d(1,0,2,0)}
\DoxyCodeLine{6946       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(0,3,0,0) = '},r,d(0,3,0,0)}
\DoxyCodeLine{6947       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(0,2,1,0) = '},r,d(0,2,1,0)}
\DoxyCodeLine{6948       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(0,0,3,0) = '},r,d(0,0,3,0)}
\DoxyCodeLine{6949       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(0,1,1,1) = '},r,d(0,1,1,1)}
\DoxyCodeLine{6950       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr D(0,0,2,1) = '},r,d(0,0,2,1)}
\DoxyCodeLine{6951 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{6952       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Dij\_err'},r,dij\_err}
\DoxyCodeLine{6953       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr Dij\_acc'},r,dij\_err/abs(d(0,0,0,0))}
\DoxyCodeLine{6954 }
\DoxyCodeLine{6955       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr err'},r,derr}
\DoxyCodeLine{6956       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr acc'},r,derr/abs(d(0,0,0,0))}
\DoxyCodeLine{6957 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6958 \textcolor{preprocessor}{}}
\DoxyCodeLine{6959       derr2 = max(derr,dij\_err2(0:rmax))}
\DoxyCodeLine{6960       derr = max(derr,dij\_err(0:rmax))}
\DoxyCodeLine{6961 }
\DoxyCodeLine{6962 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{6963 \textcolor{preprocessor}{}\textcolor{comment}{!      write(*,*) 'CalcDgr exit r',r,maxval(Derr),acc\_req\_D*abs(D(0,0,0,0))}}
\DoxyCodeLine{6964 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6965 \textcolor{preprocessor}{}}
\DoxyCodeLine{6966 \textcolor{comment}{!      if(maxval(Derr).le.acc\_req\_D*abs(D(0,0,0,0))) exit    ! changed 28.01.15}}
\DoxyCodeLine{6967       \textcolor{comment}{! check if target precision already reached}}
\DoxyCodeLine{6968 \textcolor{preprocessor}{\#ifdef Cutrloop}}
\DoxyCodeLine{6969 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(derr-\/acc\_req\_d*abs(d(0,0,0,0))).le.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6970         \textcolor{keywordflow}{if} (r.lt.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6971           \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{6972             \textcolor{keywordflow}{do} n0=0,rg/2}
\DoxyCodeLine{6973               \textcolor{keywordflow}{do} n1=0,rg-\/n0}
\DoxyCodeLine{6974                 \textcolor{keywordflow}{do} n2=0,rg-\/n0-\/n1}
\DoxyCodeLine{6975                   d(n0,n1,n2,rg-\/n0-\/n1-\/n2)=0d0}
\DoxyCodeLine{6976 \textcolor{keywordflow}{                enddo}}
\DoxyCodeLine{6977 \textcolor{keywordflow}{              enddo}}
\DoxyCodeLine{6978 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{6979 \textcolor{keywordflow}{          enddo}}
\DoxyCodeLine{6980 }
\DoxyCodeLine{6981 100       \textcolor{keyword}{format}(((a)))}
\DoxyCodeLine{6982 111       \textcolor{keyword}{format}(a22,2(\textcolor{stringliteral}{'('},g24.17,\textcolor{stringliteral}{','},g24.17,\textcolor{stringliteral}{') '}:))}
\DoxyCodeLine{6983           \textcolor{keyword}{call }seterrflag\_coli(-\/5)}
\DoxyCodeLine{6984           \textcolor{keyword}{call }errout\_coli(\textcolor{stringliteral}{'CalcDgr'},\textcolor{stringliteral}{' exit rloop for D'}, \&}
\DoxyCodeLine{6985           errorwriteflag)}
\DoxyCodeLine{6986           \textcolor{keywordflow}{if} (errorwriteflag) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6987             \textcolor{keyword}{write}(nerrout\_coli,100)\textcolor{stringliteral}{' CalcDgr:  exit rloop for D '}, \&}
\DoxyCodeLine{6988             \textcolor{stringliteral}{'    should not appear'}}
\DoxyCodeLine{6989             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgr: p10 = '},p10}
\DoxyCodeLine{6990             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgr: p21 = '},p21}
\DoxyCodeLine{6991             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgr: p32 = '},p32}
\DoxyCodeLine{6992             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgr: p30 = '},p30}
\DoxyCodeLine{6993             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgr: p20 = '},p20}
\DoxyCodeLine{6994             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgr: p31 = '},p31}
\DoxyCodeLine{6995             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgr: m02 = '},m02}
\DoxyCodeLine{6996             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgr: m12 = '},m12}
\DoxyCodeLine{6997             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgr: m22 = '},m22}
\DoxyCodeLine{6998             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgr: m32 = '},m32}
\DoxyCodeLine{6999 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7000 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{7001         }
\DoxyCodeLine{7002 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{7003 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(derr-\/acc\_req\_d*abs(d(0,0,0,0))).le.0d0.and.r.ge.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7004 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7005 \textcolor{preprocessor}{}        \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{7006 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{7007 }
\DoxyCodeLine{7008 \textcolor{keywordflow}{    end do} rloop}
\DoxyCodeLine{7009 }
\DoxyCodeLine{7010 }
\DoxyCodeLine{7011 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{7012 \textcolor{preprocessor}{}\textcolor{comment}{!    write(*,*) 'CalcDgr D(0,0,0,0) = ',D(0,0,0,0)}}
\DoxyCodeLine{7013 \textcolor{comment}{!    if(rmax.ge.3)then}}
\DoxyCodeLine{7014 \textcolor{comment}{!      write(*,*) 'CalcDgr D(0,1,1,1) = ',D(0,1,1,1)}}
\DoxyCodeLine{7015 \textcolor{comment}{!    endif}}
\DoxyCodeLine{7016 }
\DoxyCodeLine{7017     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr final err'},derr}
\DoxyCodeLine{7018     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr final acc'},derr/abs(d(0,0,0,0))}
\DoxyCodeLine{7019 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{7020 \textcolor{preprocessor}{}       }
\DoxyCodeLine{7021 \textcolor{comment}{!    write(*,*) 'CalcDgr Derr ',Derr}}
\DoxyCodeLine{7022 \textcolor{comment}{!    write(*,*) 'CalcDgr Derr2',Derr2}}
\DoxyCodeLine{7023                     }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiond_a7c913234f60361d5a9d2f529e1445657}\label{namespacereductiond_a7c913234f60361d5a9d2f529e1445657}} 
\index{reductiond@{reductiond}!calcdgx@{calcdgx}}
\index{calcdgx@{calcdgx}!reductiond@{reductiond}}
\doxysubsubsection{\texorpdfstring{calcdgx()}{calcdgx()}}
{\footnotesize\ttfamily subroutine reductiond\+::calcdgx (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{D,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Duv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{ordgx\+\_\+min,  }\item[{integer, intent(in)}]{ordgx\+\_\+max,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr2 }\end{DoxyParamCaption})}



Definition at line 7037 of file reduction\+D.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{7037   }
\DoxyCodeLine{7038     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobald}{globald}}}
\DoxyCodeLine{7039 }
\DoxyCodeLine{7040     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,ordgx\_min,ordgx\_max,id}
\DoxyCodeLine{7041     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p30,p20,p31,m02,m12,m22,m32}
\DoxyCodeLine{7042     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: D(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{7043     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Duv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{7044     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Derr(0:rmax),Derr2(0:rmax)}
\DoxyCodeLine{7045     \textcolor{keywordtype}{double complex} :: Zadjfj,Zadj2(4), Zadjkl, Xtilde}
\DoxyCodeLine{7046     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Dexpgx(:,:,:,:,:), DuvExpgx(:,:,:,:)}
\DoxyCodeLine{7047     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_0(:,:,:,:), Cuv\_0(:,:,:,:), Shat(:,:,:,:,:)}
\DoxyCodeLine{7048     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_i(:,:,:,:), Cuv\_i(:,:,:,:)}
\DoxyCodeLine{7049     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: D\_alt(:,:,:,:)}
\DoxyCodeLine{7050     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: Cerr\_i(:,:),Cerr2\_i(:,:)}
\DoxyCodeLine{7051     \textcolor{keywordtype}{double complex} :: Smod(3), Skl, Daux, DexpgAux}
\DoxyCodeLine{7052     \textcolor{keywordtype}{double complex} :: cC0f, elimminf2\_coli}
\DoxyCodeLine{7053     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err(:),Dij\_err(:),Cij\_err(:),acc\_req\_Cextra(:)}
\DoxyCodeLine{7054     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err2(:),Dij\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{7055     \textcolor{keywordtype}{double precision} :: maxDexpgx(0:1,0:rmax+ordgx\_min+1,0:ordgx\_max),truncfacexp}
\DoxyCodeLine{7056     \textcolor{keywordtype}{integer} :: rmaxC,rmaxExp,gtrunc,r,n0,n1,n2,n3,k,l,i,j,m,n,g,rg,lt,ltt,nl,nlt,nltt}
\DoxyCodeLine{7057     \textcolor{keywordtype}{integer} :: inds0(3), inds(3), inds2(2,4)}
\DoxyCodeLine{7058     \textcolor{keywordtype}{integer} :: bin,nid(0:3)}
\DoxyCodeLine{7059     \textcolor{keywordtype}{logical} :: errorwriteflag}
\DoxyCodeLine{7060 }
\DoxyCodeLine{7061 \textcolor{preprocessor}{\#ifdef Dgxtest}}
\DoxyCodeLine{7062 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx in, ord'},rmax,ordgx\_min,ordgx\_max}
\DoxyCodeLine{7063 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7064 \textcolor{preprocessor}{}}
\DoxyCodeLine{7065     \textcolor{comment}{! allocation of C functions}}
\DoxyCodeLine{7066     rmaxc = rmax + ordgx\_min}
\DoxyCodeLine{7067     \textcolor{keyword}{allocate}(c\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{7068     \textcolor{keyword}{allocate}(cuv\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{7069     \textcolor{keyword}{allocate}(c\_i(0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{7070     \textcolor{keyword}{allocate}(cuv\_i(0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{7071     \textcolor{keyword}{allocate}(cerr\_i(0:rmaxc,0:3))}
\DoxyCodeLine{7072     \textcolor{keyword}{allocate}(cerr2\_i(0:rmaxc,0:3))}
\DoxyCodeLine{7073     \textcolor{keyword}{allocate}(acc\_req\_cextra(0:rmaxc))}
\DoxyCodeLine{7074     }
\DoxyCodeLine{7075     \textcolor{comment}{! determine binaries for C-\/coefficients}}
\DoxyCodeLine{7076     k=0}
\DoxyCodeLine{7077     bin = 1}
\DoxyCodeLine{7078     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.3)}
\DoxyCodeLine{7079       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7080         nid(k) = id+bin}
\DoxyCodeLine{7081         k = k+1}
\DoxyCodeLine{7082 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{7083       bin = 2*bin}
\DoxyCodeLine{7084 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7085 }
\DoxyCodeLine{7086     \textcolor{comment}{! reduce required accuracy of higher rank C's that appear only in expansion by dividing}}
\DoxyCodeLine{7087     \textcolor{comment}{! by estimated suppression factors that are multiplied in expansion}}
\DoxyCodeLine{7088     acc\_req\_cextra(0:rmax) = acc\_req\_cind}
\DoxyCodeLine{7089     \textcolor{keywordflow}{if} (x\_g.ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7090       \textcolor{keywordflow}{do} r=rmax+1,rmaxc}
\DoxyCodeLine{7091         acc\_req\_cextra(r)= acc\_req\_cextra(r-\/1)/x\_g}
\DoxyCodeLine{7092 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7093     \textcolor{keywordflow}{else} \textcolor{comment}{! 10.07.2017}}
\DoxyCodeLine{7094        acc\_req\_cextra(rmax+1:rmaxc) = acc\_inf}
\DoxyCodeLine{7095 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7096 }
\DoxyCodeLine{7097     \textcolor{keyword}{call }calcc(c\_0(:,0,:,:),cuv\_0(:,0,:,:),p21,p32,p31,m12,m22,m32,rmaxc,nid(0),cerr\_i(:,0),cerr2\_i(:,0),rmax,acc\_req\_cextra)}
\DoxyCodeLine{7098     \textcolor{keyword}{call }calcc(c\_i(:,:,:,1),cuv\_i(:,:,:,1),p20,p32,p30,m02,m22,m32,rmaxc,nid(1),cerr\_i(:,1),cerr2\_i(:,1),rmax,acc\_req\_cextra)}
\DoxyCodeLine{7099     \textcolor{keyword}{call }calcc(c\_i(:,:,:,2),cuv\_i(:,:,:,2),p10,p31,p30,m02,m12,m32,rmaxc,nid(2),cerr\_i(:,2),cerr2\_i(:,2),rmax,acc\_req\_cextra)}
\DoxyCodeLine{7100     \textcolor{keyword}{call }calcc(c\_i(:,:,:,3),cuv\_i(:,:,:,3),p10,p21,p20,m02,m12,m22,rmaxc,nid(3),cerr\_i(:,3),cerr2\_i(:,3),rmax,acc\_req\_cextra)}
\DoxyCodeLine{7101 }
\DoxyCodeLine{7102     \textcolor{comment}{! shift of integration momentum in C\(\backslash\)\{0\}}}
\DoxyCodeLine{7103     \textcolor{keywordflow}{do} n1=1,rmaxc}
\DoxyCodeLine{7104       \textcolor{keywordflow}{do} n2=0,rmaxc-\/n1}
\DoxyCodeLine{7105         \textcolor{keywordflow}{do} n3=0,rmaxc-\/n1-\/n2}
\DoxyCodeLine{7106           n0 = (rmaxc-\/n1-\/n2-\/n3)}
\DoxyCodeLine{7107           c\_0(0:n0,n1,n2,n3) = -\/c\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{7108                             -\/c\_0(0:n0,n1-\/1,n2+1,n3)-\/c\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{7109           cuv\_0(0:n0,n1,n2,n3) = -\/cuv\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{7110                               -\/cuv\_0(0:n0,n1-\/1,n2+1,n3)-\/cuv\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{7111 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7112 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7113 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7114 }
\DoxyCodeLine{7115 }
\DoxyCodeLine{7116     \textcolor{comment}{! calculate adjugated Gram matrix}}
\DoxyCodeLine{7117 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{7118 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{7119 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{7120 \textcolor{comment}{!    mm32 = elimminf2\_coli(m32)}}
\DoxyCodeLine{7121 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{7122 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{7123 \textcolor{comment}{!    q32  = elimminf2\_coli(p32)}}
\DoxyCodeLine{7124 \textcolor{comment}{!    q30  = elimminf2\_coli(p30)}}
\DoxyCodeLine{7125 \textcolor{comment}{!    q31  = elimminf2\_coli(p31)}}
\DoxyCodeLine{7126 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{7127 }
\DoxyCodeLine{7128 \textcolor{comment}{!    Z(1,1) = 2d0*q10}}
\DoxyCodeLine{7129 \textcolor{comment}{!    Z(2,1) = q10+q20-\/q21}}
\DoxyCodeLine{7130 \textcolor{comment}{!    Z(3,1) = q10+q30-\/q31}}
\DoxyCodeLine{7131 \textcolor{comment}{!    Z(1,2) = Z(2,1)}}
\DoxyCodeLine{7132 \textcolor{comment}{!    Z(2,2) = 2d0*q20}}
\DoxyCodeLine{7133 \textcolor{comment}{!    Z(3,2) = q20+q30-\/q32}}
\DoxyCodeLine{7134 \textcolor{comment}{!    Z(1,3) = Z(3,1)}}
\DoxyCodeLine{7135 \textcolor{comment}{!    Z(2,3) = Z(3,2)}}
\DoxyCodeLine{7136 \textcolor{comment}{!    Z(3,3) = 2d0*q30}}
\DoxyCodeLine{7137 }
\DoxyCodeLine{7138 \textcolor{comment}{!    q1q2 = (q10+q20-\/q21)}}
\DoxyCodeLine{7139 \textcolor{comment}{!    q1q3 = (q10+q30-\/q31)}}
\DoxyCodeLine{7140 \textcolor{comment}{!    q2q3 = (q20+q30-\/q32)}}
\DoxyCodeLine{7141 \textcolor{comment}{!    detZ = 8d0*q10*q30*q20+2D0*q1q2*q1q3*q2q3  \&}}
\DoxyCodeLine{7142 \textcolor{comment}{!     \&    -\/2d0*(q10*q2q3*q2q3+q20*q1q3*q1q3+q30*q1q2*q1q2)}}
\DoxyCodeLine{7143 }
\DoxyCodeLine{7144 \textcolor{comment}{!    Zadj(1,1) = (4d0*q30*q20-\/q2q3*q2q3)}}
\DoxyCodeLine{7145 \textcolor{comment}{!    Zadj(2,1) = (q1q3*q2q3-\/2d0*q30*q1q2)}}
\DoxyCodeLine{7146 \textcolor{comment}{!    Zadj(3,1) = (q1q2*q2q3-\/2d0*q20*q1q3)}}
\DoxyCodeLine{7147 \textcolor{comment}{!    Zadj(1,2) = Zadj(2,1)}}
\DoxyCodeLine{7148 \textcolor{comment}{!    Zadj(2,2) = (4d0*q10*q30-\/q1q3*q1q3)}}
\DoxyCodeLine{7149 \textcolor{comment}{!    Zadj(3,2) = (q1q2*q1q3-\/2d0*q10*q2q3)}}
\DoxyCodeLine{7150 \textcolor{comment}{!    Zadj(1,3) = Zadj(3,1)}}
\DoxyCodeLine{7151 \textcolor{comment}{!    Zadj(2,3) = Zadj(3,2)}}
\DoxyCodeLine{7152 \textcolor{comment}{!    Zadj(3,3) = (4d0*q10*q20-\/q1q2*q1q2)}}
\DoxyCodeLine{7153 \textcolor{comment}{!}}
\DoxyCodeLine{7154 \textcolor{comment}{!    f(1) = q10+mm02-\/mm12}}
\DoxyCodeLine{7155 \textcolor{comment}{!    f(2) = q20+mm02-\/mm22}}
\DoxyCodeLine{7156 \textcolor{comment}{!    f(3) = q30+mm02-\/mm32}}
\DoxyCodeLine{7157       }
\DoxyCodeLine{7158 \textcolor{comment}{!    Zadjf(1) = Zadj(1,1)*f(1)+Zadj(2,1)*f(2)+Zadj(3,1)*f(3)}}
\DoxyCodeLine{7159 \textcolor{comment}{!    Zadjf(2) = Zadj(1,2)*f(1)+Zadj(2,2)*f(2)+Zadj(3,2)*f(3)}}
\DoxyCodeLine{7160 \textcolor{comment}{!    Zadjf(3) = Zadj(1,3)*f(1)+Zadj(2,3)*f(2)+Zadj(3,3)*f(3)}}
\DoxyCodeLine{7161 }
\DoxyCodeLine{7162 }
\DoxyCodeLine{7163     \textcolor{comment}{! coefficients Shat defined in (5.13)}}
\DoxyCodeLine{7164     \textcolor{keyword}{allocate}(shat(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{7165 }
\DoxyCodeLine{7166     \textcolor{keywordflow}{do} r=0,rmaxc}
\DoxyCodeLine{7167       \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{7168         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{7169           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{7170             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{7171 }
\DoxyCodeLine{7172             shat(n0,n1,n2,n3,:) = -\/c\_0(n0,n1,n2,n3)}
\DoxyCodeLine{7173 }
\DoxyCodeLine{7174             \textcolor{keywordflow}{if}(n1.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7175               shat(n0,n1,n2,n3,1) = shat(n0,n1,n2,n3,1) + c\_i(n0,n2,n3,1)}
\DoxyCodeLine{7176 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{7177 }
\DoxyCodeLine{7178             \textcolor{keywordflow}{if}(n2.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7179               shat(n0,n1,n2,n3,2) = shat(n0,n1,n2,n3,2) + c\_i(n0,n1,n3,2)}
\DoxyCodeLine{7180 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{7181 }
\DoxyCodeLine{7182             \textcolor{keywordflow}{if}(n3.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7183               shat(n0,n1,n2,n3,3) = shat(n0,n1,n2,n3,3) + c\_i(n0,n1,n2,3)}
\DoxyCodeLine{7184 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{7185 }
\DoxyCodeLine{7186 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{7187 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7188 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7189 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7190 }
\DoxyCodeLine{7191 }
\DoxyCodeLine{7192     \textcolor{comment}{! choose reduction formulas with biggest denominators}}
\DoxyCodeLine{7193     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)).ge.max(abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)),abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(3)))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7194       j = 1}
\DoxyCodeLine{7195     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)).ge.max(abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)),abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(3)))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7196       j = 2}
\DoxyCodeLine{7197     \textcolor{keywordflow}{else}}
\DoxyCodeLine{7198       j = 3}
\DoxyCodeLine{7199 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7200 }
\DoxyCodeLine{7201     maxzadj2f = 0d0}
\DoxyCodeLine{7202     \textcolor{keywordflow}{if} (abs(zadj2f(1,2,1)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7203       maxzadj2f = abs(zadj2f(1,2,1))}
\DoxyCodeLine{7204       i = 1}
\DoxyCodeLine{7205       j = 2}
\DoxyCodeLine{7206       l = 1}
\DoxyCodeLine{7207       lt = 2}
\DoxyCodeLine{7208       ltt = 3}
\DoxyCodeLine{7209 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7210     \textcolor{keywordflow}{if} (abs(zadj2f(1,3,1)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7211       maxzadj2f = abs(zadj2f(1,3,1))}
\DoxyCodeLine{7212       i = 1}
\DoxyCodeLine{7213       j = 3}
\DoxyCodeLine{7214       l = 1}
\DoxyCodeLine{7215       lt = 2}
\DoxyCodeLine{7216       ltt = 3}
\DoxyCodeLine{7217 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7218     \textcolor{keywordflow}{if} (abs(zadj2f(1,2,2)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7219       maxzadj2f = abs(zadj2f(1,2,2))}
\DoxyCodeLine{7220       i = 1}
\DoxyCodeLine{7221       j = 2}
\DoxyCodeLine{7222       l = 2}
\DoxyCodeLine{7223       lt = 3}
\DoxyCodeLine{7224       ltt = 1}
\DoxyCodeLine{7225 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7226     \textcolor{keywordflow}{if} (abs(zadj2f(1,3,2)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7227       maxzadj2f = abs(zadj2f(1,3,2))}
\DoxyCodeLine{7228       i = 1}
\DoxyCodeLine{7229       j = 3}
\DoxyCodeLine{7230       l = 2}
\DoxyCodeLine{7231       lt = 3}
\DoxyCodeLine{7232       ltt = 1}
\DoxyCodeLine{7233 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7234     \textcolor{keywordflow}{if} (abs(zadj2f(1,2,3)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7235       maxzadj2f = abs(zadj2f(1,2,3))}
\DoxyCodeLine{7236       i = 1}
\DoxyCodeLine{7237       j = 2}
\DoxyCodeLine{7238       l = 3}
\DoxyCodeLine{7239       lt = 1}
\DoxyCodeLine{7240       ltt = 2}
\DoxyCodeLine{7241 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7242     \textcolor{keywordflow}{if} (abs(zadj2f(1,3,3)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7243       maxzadj2f = abs(zadj2f(1,3,3))}
\DoxyCodeLine{7244       i = 1}
\DoxyCodeLine{7245       j = 3}
\DoxyCodeLine{7246       l = 3}
\DoxyCodeLine{7247       lt = 1}
\DoxyCodeLine{7248       ltt = 2}
\DoxyCodeLine{7249 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7250     \textcolor{keywordflow}{if} (abs(zadj2f(2,3,1)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7251       maxzadj2f = abs(zadj2f(2,3,1))}
\DoxyCodeLine{7252       i = 2}
\DoxyCodeLine{7253       j = 3}
\DoxyCodeLine{7254       l = 1}
\DoxyCodeLine{7255       lt = 2}
\DoxyCodeLine{7256       ltt = 3}
\DoxyCodeLine{7257 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7258     \textcolor{keywordflow}{if} (abs(zadj2f(2,3,2)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7259       maxzadj2f = abs(zadj2f(2,3,2))}
\DoxyCodeLine{7260       i = 2}
\DoxyCodeLine{7261       j = 3}
\DoxyCodeLine{7262       l = 2}
\DoxyCodeLine{7263       lt = 3}
\DoxyCodeLine{7264       ltt = 1}
\DoxyCodeLine{7265 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7266     \textcolor{keywordflow}{if} (abs(zadj2f(2,3,3)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7267       maxzadj2f = abs(zadj2f(2,3,3))}
\DoxyCodeLine{7268       i = 2}
\DoxyCodeLine{7269       j = 3}
\DoxyCodeLine{7270       l = 3}
\DoxyCodeLine{7271       lt = 1}
\DoxyCodeLine{7272       ltt = 2}
\DoxyCodeLine{7273 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7274 }
\DoxyCodeLine{7275 \textcolor{preprocessor}{\#ifdef Dgxtest}}
\DoxyCodeLine{7276 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx i,j,l'},i,j,l,lt,ltt}
\DoxyCodeLine{7277     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx pars'}, maxzadj2f,zadj2f(i,j,l),\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,j),\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}}
\DoxyCodeLine{7278     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx pars'}, abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j)),abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(i,j))}
\DoxyCodeLine{7279     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx pars'},  abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j)/ maxzadj2f),abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(i,j)/maxzadj2f)}
\DoxyCodeLine{7280 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7281 \textcolor{preprocessor}{}}
\DoxyCodeLine{7282     zadjfj = \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j)}
\DoxyCodeLine{7283 }
\DoxyCodeLine{7284     xtilde = \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(k,l)}
\DoxyCodeLine{7285 }
\DoxyCodeLine{7286 \textcolor{comment}{!    write(*,*) 'CalcDgx Xtilde n',Xtilde,Xadj(1,1),Xadj(1,2),Xadj(2,2)}}
\DoxyCodeLine{7287 }
\DoxyCodeLine{7288 }
\DoxyCodeLine{7289     \textcolor{comment}{! allocation of array for det(Z)-\/expanded C-\/coefficients}}
\DoxyCodeLine{7290     rmaxexp = rmaxc+1}
\DoxyCodeLine{7291     \textcolor{keyword}{allocate}(dexpgx(0:rmaxexp/2,0:rmaxexp,0:rmaxexp,0:rmaxexp,0:ordgx\_max))}
\DoxyCodeLine{7292 }
\DoxyCodeLine{7293 }
\DoxyCodeLine{7294     \textcolor{comment}{! calculate Duv}}
\DoxyCodeLine{7295     \textcolor{keyword}{allocate}(duvexpgx(0:rmaxexp,0:rmaxexp,0:rmaxexp,0:rmaxexp))}
\DoxyCodeLine{7296     \textcolor{keyword}{call }calcduv(duvexpgx,cuv\_0,mm02,f,rmaxexp,id)}
\DoxyCodeLine{7297     duv(0:rmax,0:rmax,0:rmax,0:rmax) = duvexpgx(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{7298 }
\DoxyCodeLine{7299     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{7300     \textcolor{keyword}{allocate}(d00\_err(0:rmaxexp))}
\DoxyCodeLine{7301     \textcolor{keyword}{allocate}(dij\_err(0:rmaxexp))}
\DoxyCodeLine{7302     \textcolor{keyword}{allocate}(cij\_err(0:rmaxc))}
\DoxyCodeLine{7303      }
\DoxyCodeLine{7304     \textcolor{keyword}{allocate}(d00\_err2(0:rmaxexp))}
\DoxyCodeLine{7305     \textcolor{keyword}{allocate}(dij\_err2(0:rmaxexp))}
\DoxyCodeLine{7306     \textcolor{keyword}{allocate}(cij\_err2(0:rmaxc))}
\DoxyCodeLine{7307      }
\DoxyCodeLine{7308     \textcolor{comment}{! initialize accuracy estimates}}
\DoxyCodeLine{7309     derr = acc\_inf}
\DoxyCodeLine{7310     dij\_err =0d0}
\DoxyCodeLine{7311     d00\_err =0d0}
\DoxyCodeLine{7312     cij\_err = max(cerr\_i(:,0),cerr\_i(:,1),cerr\_i(:,2),cerr\_i(:,3))}
\DoxyCodeLine{7313 }
\DoxyCodeLine{7314     derr2 = acc\_inf}
\DoxyCodeLine{7315     dij\_err2 =0d0}
\DoxyCodeLine{7316     d00\_err2 =0d0}
\DoxyCodeLine{7317     cij\_err2 = max(cerr2\_i(:,0),cerr2\_i(:,1),cerr2\_i(:,2),cerr2\_i(:,3))}
\DoxyCodeLine{7318 }
\DoxyCodeLine{7319 \textcolor{preprocessor}{\#ifdef Dgxtest}}
\DoxyCodeLine{7320 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx Cij\_err = '},cij\_err }
\DoxyCodeLine{7321     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx C0\_err = '}, cerr\_i(0,0),cerr\_i(0,1),cerr\_i(0,2),cerr\_i(0,3)}
\DoxyCodeLine{7322     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx C0 = '}, c\_0(0,0,0,0),c\_i(0,0,0,1),c\_i(0,0,0,2),c\_i(0,0,0,3)}
\DoxyCodeLine{7323 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7324 \textcolor{preprocessor}{}}
\DoxyCodeLine{7325 \textcolor{comment}{!    maxZadj = maxval(abs(Zadj))}}
\DoxyCodeLine{7326 \textcolor{comment}{!    maxZadj2f = maxval(abs(f(inds2(1,:))*Zadj2(:)))}}
\DoxyCodeLine{7327 }
\DoxyCodeLine{7328     \textcolor{comment}{! truncation of expansion if calculated term larger than truncfacexp * previous term}}
\DoxyCodeLine{7329     \textcolor{comment}{! crucial for expansion parameters between 0.1 and 1 !!!}}
\DoxyCodeLine{7330     truncfacexp = sqrt(\mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}}) * truncfacd}
\DoxyCodeLine{7331     gtrunc = ordgx\_max }
\DoxyCodeLine{7332 }
\DoxyCodeLine{7333 \textcolor{comment}{! calculate D(1,n1,n2,n3) up to rank r}}
\DoxyCodeLine{7334 \textcolor{comment}{! calculate D(0,n1,n2,n3) up to rank r-\/1}}
\DoxyCodeLine{7335     rloop: \textcolor{keywordflow}{do} r=1,rmaxexp}
\DoxyCodeLine{7336 }
\DoxyCodeLine{7337 \textcolor{preprocessor}{\#ifdef Dgxtest}}
\DoxyCodeLine{7338 \textcolor{preprocessor}{}\textcolor{comment}{!      write(*,*) 'CalcDgx rloop',r,rmax,gtrunc}}
\DoxyCodeLine{7339 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7340 \textcolor{preprocessor}{}}
\DoxyCodeLine{7341       \textcolor{keywordflow}{if} (r.gt.rmax+gtrunc+1) \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{7342 }
\DoxyCodeLine{7343 \textcolor{preprocessor}{\#ifdef Dgxtest}}
\DoxyCodeLine{7344 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx rloop'},r}
\DoxyCodeLine{7345 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7346 \textcolor{preprocessor}{}}
\DoxyCodeLine{7347       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{7348       \textcolor{comment}{! 0th-\/order coefficients}}
\DoxyCodeLine{7349       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{7350 }
\DoxyCodeLine{7351       \textcolor{comment}{! calculating D\_00ijk.. exploiting eq. (5.53)}}
\DoxyCodeLine{7352       maxdexpgx(1,r,0)=0d0}
\DoxyCodeLine{7353       \textcolor{keywordflow}{do} nl=r-\/2,0,-\/1}
\DoxyCodeLine{7354         \textcolor{keywordflow}{do} nlt=r-\/2-\/nl,0,-\/1}
\DoxyCodeLine{7355           nltt = r-\/2-\/nl-\/nlt}
\DoxyCodeLine{7356           inds0(l) = nl}
\DoxyCodeLine{7357           inds0(lt) = nlt}
\DoxyCodeLine{7358           inds0(ltt) = nltt}
\DoxyCodeLine{7359 }
\DoxyCodeLine{7360           inds(l) = nl+1}
\DoxyCodeLine{7361           inds(lt) = nlt}
\DoxyCodeLine{7362           inds(ltt) = nltt}
\DoxyCodeLine{7363           daux = zadj2f(i,j,1)*shat(0,inds(1),inds(2),inds(3),1)  \&}
\DoxyCodeLine{7364                + zadj2f(i,j,2)*shat(0,inds(1),inds(2),inds(3),2)  \&}
\DoxyCodeLine{7365                + zadj2f(i,j,3)*shat(0,inds(1),inds(2),inds(3),3)  }
\DoxyCodeLine{7366 }
\DoxyCodeLine{7367           inds = inds0}
\DoxyCodeLine{7368           inds(l) = inds(l)+1}
\DoxyCodeLine{7369           daux = daux -\/ \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,j)*(c\_0(0,inds(1),inds(2),inds(3))      \&}
\DoxyCodeLine{7370                              +4*duvexpgx(1,inds(1),inds(2),inds(3))) }
\DoxyCodeLine{7371 }
\DoxyCodeLine{7372           \textcolor{keywordflow}{if} (nlt.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7373             inds(lt) = nlt-\/1}
\DoxyCodeLine{7374             daux = daux -\/ 2*nlt*zadj2f(i,j,lt)*dexpgx(1,inds(1),inds(2),inds(3),0)}
\DoxyCodeLine{7375 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7376           \textcolor{keywordflow}{if} (nltt.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7377             inds(lt) = nlt}
\DoxyCodeLine{7378             inds(ltt) = nltt-\/1}
\DoxyCodeLine{7379             daux = daux -\/ 2*nltt*zadj2f(i,j,ltt)*dexpgx(1,inds(1),inds(2),inds(3),0)}
\DoxyCodeLine{7380 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7381 }
\DoxyCodeLine{7382           dexpgx(1,inds0(1),inds0(2),inds0(3),0) = daux/(2*(nl+1)*zadj2f(i,j,l))}
\DoxyCodeLine{7383 }
\DoxyCodeLine{7384           maxdexpgx(1,r,0) =  maxdexpgx(1,r,0) + abs(dexpgx(1,inds0(1),inds0(2),inds0(3),0) )}
\DoxyCodeLine{7385 }
\DoxyCodeLine{7386           \textcolor{keywordflow}{if} (r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7387             d(1,inds0(1),inds0(2),inds0(3)) = dexpgx(1,inds0(1),inds0(2),inds0(3),0)}
\DoxyCodeLine{7388 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7389       }
\DoxyCodeLine{7390 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7391 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7392 }
\DoxyCodeLine{7393       \textcolor{comment}{! calculate}}
\DoxyCodeLine{7394       \textcolor{comment}{! D\_00ijkl.. -\/-\/> D\_aijkl..}}
\DoxyCodeLine{7395       \textcolor{comment}{! exploiting eq. (5.38)}}
\DoxyCodeLine{7396       maxdexpgx(0,r-\/1,0)=0d0}
\DoxyCodeLine{7397       \textcolor{keywordflow}{do} n1=0,r-\/1}
\DoxyCodeLine{7398         \textcolor{keywordflow}{do} n2=0,r-\/1-\/n1}
\DoxyCodeLine{7399           n3 = r-\/1-\/n1-\/n2}
\DoxyCodeLine{7400 }
\DoxyCodeLine{7401           smod = shat(0,n1,n2,n3,:)}
\DoxyCodeLine{7402           \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7403             smod(1) = smod(1) -\/ 2d0*n1*dexpgx(1,n1-\/1,n2,n3,0)}
\DoxyCodeLine{7404 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7405           \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7406             smod(2) = smod(2) -\/ 2d0*n2*dexpgx(1,n1,n2-\/1,n3,0)}
\DoxyCodeLine{7407 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7408           \textcolor{keywordflow}{if} (n3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7409             smod(3) = smod(3) -\/ 2d0*n3*dexpgx(1,n1,n2,n3-\/1,0)}
\DoxyCodeLine{7410 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7411 }
\DoxyCodeLine{7412           dexpgx(0,n1,n2,n3,0) = (\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1) +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2)  \&}
\DoxyCodeLine{7413                               +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,j)*smod(3))/zadjfj}
\DoxyCodeLine{7414           maxdexpgx(0,r-\/1,0) =  maxdexpgx(0,r-\/1,0) + abs(dexpgx(0,n1,n2,n3,0))}
\DoxyCodeLine{7415           \textcolor{keywordflow}{if} (r.le.rmax+1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7416             d(0,n1,n2,n3) = dexpgx(0,n1,n2,n3,0)}
\DoxyCodeLine{7417 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7418 }
\DoxyCodeLine{7419 }
\DoxyCodeLine{7420 \textcolor{preprocessor}{\#ifdef Dgxtest}}
\DoxyCodeLine{7421 \textcolor{preprocessor}{}\textcolor{comment}{!          if(n0.eq.0.and.n1.eq.0.and.n2.eq.3.and.n3.eq.0) then }}
\DoxyCodeLine{7422 \textcolor{comment}{!            write(*,*) 'D2(0,0,3,0)= ',0,D(n0,n1,n2,n3)}}
\DoxyCodeLine{7423 \textcolor{comment}{!          end if}}
\DoxyCodeLine{7424 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7425 \textcolor{preprocessor}{}}
\DoxyCodeLine{7426 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7427 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7428 }
\DoxyCodeLine{7429 \textcolor{preprocessor}{\#ifdef Dgxtest}}
\DoxyCodeLine{7430 \textcolor{preprocessor}{}\textcolor{comment}{!      write(*,*) 'CalcDgx maxDexpg 0',r-\/1, maxDexpg(0,r-\/1,0)}}
\DoxyCodeLine{7431 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7432 \textcolor{preprocessor}{}}
\DoxyCodeLine{7433       \textcolor{keywordflow}{if}(r-\/1.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7434 \textcolor{comment}{!       Derr(r-\/1) =  abs(detZ/Zadjfj)*maxDexpg(0,r-\/1,0)}}
\DoxyCodeLine{7435         derr(r-\/1) =  \mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}}*maxdexpgx(0,r-\/1,0)}
\DoxyCodeLine{7436 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{7437 }
\DoxyCodeLine{7438       \textcolor{comment}{! error propagation from C's}}
\DoxyCodeLine{7439       \textcolor{keywordflow}{if}(r.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{7440         d00\_err(r) = max(cij\_err(r-\/1),\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/maxzadj2f*cij\_err(r-\/1))/2d0}
\DoxyCodeLine{7441 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{7442       dij\_err(r-\/1)=\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(cij\_err(r-\/1),2*d00\_err(r))/abs(zadjfj)}
\DoxyCodeLine{7443 }
\DoxyCodeLine{7444       \textcolor{keywordflow}{if}(r.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{7445         d00\_err2(r) = max(cij\_err2(r-\/1),\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/maxzadj2f*cij\_err2(r-\/1))/2d0}
\DoxyCodeLine{7446 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{7447       dij\_err2(r-\/1)=\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(cij\_err2(r-\/1),2*d00\_err2(r))/abs(zadjfj)}
\DoxyCodeLine{7448 }
\DoxyCodeLine{7449       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{7450       \textcolor{comment}{! higher order coefficients}}
\DoxyCodeLine{7451       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{7452 }
\DoxyCodeLine{7453       rg = r}
\DoxyCodeLine{7454       gloop: \textcolor{keywordflow}{do} g=1,min(gtrunc,r-\/1)}
\DoxyCodeLine{7455         rg = rg-\/1}
\DoxyCodeLine{7456 }
\DoxyCodeLine{7457         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'gloop '},g,rg}
\DoxyCodeLine{7458 }
\DoxyCodeLine{7459         \textcolor{comment}{! calculating D\_00ijk.. exploiting eq. (5.53)}}
\DoxyCodeLine{7460         maxdexpgx(1,rg,g) = 0d0}
\DoxyCodeLine{7461         \textcolor{keywordflow}{do} nl=rg-\/2,0,-\/1}
\DoxyCodeLine{7462           \textcolor{keywordflow}{do} nlt=rg-\/2-\/nl,0,-\/1}
\DoxyCodeLine{7463             nltt = rg-\/2-\/nl-\/nlt}
\DoxyCodeLine{7464             inds0(l) = nl}
\DoxyCodeLine{7465             inds0(lt) = nlt}
\DoxyCodeLine{7466             inds0(ltt) = nltt}
\DoxyCodeLine{7467 }
\DoxyCodeLine{7468             inds = inds0}
\DoxyCodeLine{7469             inds(l) = inds(l)+1}
\DoxyCodeLine{7470             daux = -\/\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(i,j)*dexpgx(0,inds(1),inds(2),inds(3),g-\/1)   \&}
\DoxyCodeLine{7471                    +\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,j)*2*rg*dexpgx(1,inds(1),inds(2),inds(3),g-\/1) }
\DoxyCodeLine{7472 }
\DoxyCodeLine{7473             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx con Xij'},-\/\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(i,j)*dexpgx(0,inds(1),inds(2),inds(3),g-\/1)/(2*(nl+1)*zadj2f(i,j,l))  }
\DoxyCodeLine{7474             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx con Zij'},+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,j)*2*(1+rg)*dexpgx(1,inds(1),inds(2),inds(3),g-\/1)/(2*(nl+1)*zadj2f(i,j,l))}
\DoxyCodeLine{7475 }
\DoxyCodeLine{7476             inds(i) = inds(i)+1}
\DoxyCodeLine{7477             daux = daux -\/ zadjfj*dexpgx(0,inds(1),inds(2),inds(3),g-\/1)}
\DoxyCodeLine{7478             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx con Zadj2f'}, -\/ zadjfj*dexpgx(0,inds(1),inds(2),inds(3),g-\/1)/(2*(nl+1)*zadj2f(i,j,l))  }
\DoxyCodeLine{7479 }
\DoxyCodeLine{7480             \textcolor{keywordflow}{if} (nlt.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7481               inds(l) = nl+1}
\DoxyCodeLine{7482               inds(lt) = nlt-\/1}
\DoxyCodeLine{7483               inds(ltt) = nltt}
\DoxyCodeLine{7484               daux = daux -\/ 2*nlt*zadj2f(i,j,lt)*dexpgx(1,inds(1),inds(2),inds(3),g)}
\DoxyCodeLine{7485 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{7486             \textcolor{keywordflow}{if} (nltt.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7487               inds(l) = nl+1}
\DoxyCodeLine{7488               inds(lt) = nlt}
\DoxyCodeLine{7489               inds(ltt) = nltt-\/1}
\DoxyCodeLine{7490               daux = daux -\/ 2*nltt*zadj2f(i,j,ltt)*dexpgx(1,inds(1),inds(2),inds(3),g)}
\DoxyCodeLine{7491 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{7492 }
\DoxyCodeLine{7493             dexpgx(1,inds0(1),inds0(2),inds0(3),g) = daux/(2*(nl+1)*zadj2f(i,j,l))}
\DoxyCodeLine{7494 }
\DoxyCodeLine{7495             maxdexpgx(1,rg,g) =  maxdexpgx(1,rg,g) + abs(dexpgx(1,inds0(1),inds0(2),inds0(3),g) )}
\DoxyCodeLine{7496  }
\DoxyCodeLine{7497             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx gloop 00'},g,rg,nl,nlt,nltt,dexpgx(1,inds0(1),inds0(2),inds0(3),g)}
\DoxyCodeLine{7498 }
\DoxyCodeLine{7499 }
\DoxyCodeLine{7500             \textcolor{keywordflow}{if} (g.eq.1.and.abs(dexpgx(1,inds0(1),inds0(2),inds0(3),g)).gt.           \&}
\DoxyCodeLine{7501                 truncfacexp*max(1/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}},maxdexpgx(1,rg,g-\/1)) .or. \&}
\DoxyCodeLine{7502                 g.ge.2.and.abs(dexpgx(1,inds0(1),inds0(2),inds0(3),g)).gt.           \&}
\DoxyCodeLine{7503                 truncfacexp*maxdexpgx(1,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7504 }
\DoxyCodeLine{7505 \textcolor{preprocessor}{\#ifdef Dgxtest}}
\DoxyCodeLine{7506 \textcolor{preprocessor}{}              \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx cycle loop'},1,inds0(1),inds0(2),inds0(3),g, \&}
\DoxyCodeLine{7507                   abs(dexpgx(1,inds0(1),inds0(2),inds0(3),g)),abs(dexpgx(1,inds0(1),inds0(2),inds0(3),g-\/1)),maxdexpgx(1,rg,g-\/1)}
\DoxyCodeLine{7508 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7509 \textcolor{preprocessor}{}              }
\DoxyCodeLine{7510               gtrunc = g-\/1}
\DoxyCodeLine{7511               \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{7512 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{7513        }
\DoxyCodeLine{7514 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{7515 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7516 }
\DoxyCodeLine{7517 \textcolor{preprocessor}{\#ifndef PPEXP00}}
\DoxyCodeLine{7518 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (rg.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7519           \textcolor{keywordflow}{do} n1=0,rg-\/2}
\DoxyCodeLine{7520             \textcolor{keywordflow}{do} n2=0,rg-\/2-\/n1}
\DoxyCodeLine{7521               n3=rg-\/2-\/n1-\/n2}
\DoxyCodeLine{7522               d(1,n1,n2,n3) = d(1,n1,n2,n3) + dexpgx(1,n1,n2,n3,g)}
\DoxyCodeLine{7523 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{7524 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{7525 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7526 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7527 \textcolor{preprocessor}{}}
\DoxyCodeLine{7528 }
\DoxyCodeLine{7529         \textcolor{comment}{! calculate}}
\DoxyCodeLine{7530         \textcolor{comment}{! D\_00ijkl.. -\/-\/> D\_aijkl..}}
\DoxyCodeLine{7531         \textcolor{comment}{! exploiting eq. (5.38)}}
\DoxyCodeLine{7532 }
\DoxyCodeLine{7533 \textcolor{comment}{!        write(*,*) 'CalcDgx maxDexp',rg-\/1,g-\/1,maxDexpg(0,rg-\/1,g-\/1)}}
\DoxyCodeLine{7534 }
\DoxyCodeLine{7535         maxdexpgx(0,rg-\/1,g) = 0d0}
\DoxyCodeLine{7536         \textcolor{keywordflow}{do} n1=0,rg-\/1}
\DoxyCodeLine{7537           \textcolor{keywordflow}{do} n2=0,rg-\/1-\/n1}
\DoxyCodeLine{7538             n3 = rg-\/1-\/n1-\/n2}
\DoxyCodeLine{7539 }
\DoxyCodeLine{7540             smod = 0d0}
\DoxyCodeLine{7541             \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7542               smod(1) = smod(1) -\/ 2d0*n1*dexpgx(1,n1-\/1,n2,n3,g)}
\DoxyCodeLine{7543 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{7544             \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7545               smod(2) = smod(2) -\/ 2d0*n2*dexpgx(1,n1,n2-\/1,n3,g)}
\DoxyCodeLine{7546 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{7547             \textcolor{keywordflow}{if} (n3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7548               smod(3) = smod(3) -\/ 2d0*n3*dexpgx(1,n1,n2,n3-\/1,g)}
\DoxyCodeLine{7549 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{7550 }
\DoxyCodeLine{7551             inds(1) = n1}
\DoxyCodeLine{7552             inds(2) = n2}
\DoxyCodeLine{7553             inds(3) = n3}
\DoxyCodeLine{7554             inds(j) = inds(j)+1}
\DoxyCodeLine{7555             dexpgx(0,n1,n2,n3,g) = (\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1) +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2)  \&}
\DoxyCodeLine{7556                                 +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,j)*smod(3)  \&}
\DoxyCodeLine{7557                                 -\/ \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*dexpgx(0,inds(1),inds(2),inds(3),g-\/1))/zadjfj}
\DoxyCodeLine{7558 }
\DoxyCodeLine{7559             maxdexpgx(0,rg-\/1,g) =  maxdexpgx(0,rg-\/1,g) + abs(dexpgx(0,n1,n2,n3,g))}
\DoxyCodeLine{7560 }
\DoxyCodeLine{7561 \textcolor{comment}{!              if(n1.eq.0.and.n2.eq.1.and.n3.eq.2) then }}
\DoxyCodeLine{7562 \textcolor{comment}{!                write(*,*) 'D2(2,3,3)= ',g,Dexpg(0,n1,n2,n3,g)}}
\DoxyCodeLine{7563 \textcolor{comment}{!                write(*,*) 'D2(2,3,3)= ',Zadj(1,j)*Smod(1)/Zadjfj,  Zadj(2,j)*Smod(2)/Zadjfj,  \&}}
\DoxyCodeLine{7564 \textcolor{comment}{!                                +  Zadj(3,j)*Smod(3)/Zadjfj,  \&}}
\DoxyCodeLine{7565 \textcolor{comment}{!                                -\/ detZ*Dexpg(0,inds(1),inds(2),inds(3),g-\/1)/Zadjfj}}
\DoxyCodeLine{7566 \textcolor{comment}{!                write(*,*) 'D2(2,3,3)= ',inds(1),inds(2),inds(3),         \&}}
\DoxyCodeLine{7567 \textcolor{comment}{!                                -\/ detZ/Zadjfj,Dexpg(0,inds(1),inds(2),inds(3),g-\/1)}}
\DoxyCodeLine{7568 \textcolor{comment}{!              end if}}
\DoxyCodeLine{7569 }
\DoxyCodeLine{7570             \textcolor{keywordflow}{if} (g.eq.1.and.abs(dexpgx(0,n1,n2,n3,g)).gt.               \&}
\DoxyCodeLine{7571                 truncfacexp*max(1/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}**2,maxdexpgx(0,rg,g-\/1)) .or. \&}
\DoxyCodeLine{7572                 g.ge.2.and.abs(dexpgx(0,n1,n2,n3,g)).gt.              \&}
\DoxyCodeLine{7573                 truncfacexp*maxdexpgx(0,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7574 }
\DoxyCodeLine{7575 \textcolor{preprocessor}{\#ifdef Dgxtest}}
\DoxyCodeLine{7576 \textcolor{preprocessor}{}                  \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx exit gloop'},0,n1,n2,n3,g,abs(dexpgx(0,n1,n2,n3,g)),maxdexpgx(0,rg-\/1,g-\/1),truncfacexp}
\DoxyCodeLine{7577 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{7578 \textcolor{preprocessor}{}              gtrunc = g-\/1}
\DoxyCodeLine{7579               \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{7580 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{7581 }
\DoxyCodeLine{7582 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{7583 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7584 }
\DoxyCodeLine{7585         \textcolor{comment}{! error propagation from C's}}
\DoxyCodeLine{7586         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{7587           d00\_err(rg) = max( d00\_err(rg),                                   \&}
\DoxyCodeLine{7588               max( abs(m02)*dij\_err(rg-\/2),            \&}
\DoxyCodeLine{7589               max( \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err(rg),abs(xtilde)*dij\_err(rg-\/1),         \&}
\DoxyCodeLine{7590               \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*d00\_err(rg+1) ) / abs(2d0*maxzadj2f) )                        \&}
\DoxyCodeLine{7591               /(4*(rg-\/1))   )}
\DoxyCodeLine{7592 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7593         dij\_err(rg-\/1)=max(dij\_err(rg-\/1),                \&}
\DoxyCodeLine{7594             max(2*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*d00\_err(rg),abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})*dij\_err(rg))/abs(zadjfj) )}
\DoxyCodeLine{7595 }
\DoxyCodeLine{7596         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{7597           d00\_err2(rg) = max( d00\_err2(rg),                                   \&}
\DoxyCodeLine{7598               max( abs(m02)*dij\_err2(rg-\/2),            \&}
\DoxyCodeLine{7599               max( \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err2(rg),abs(xtilde)*dij\_err2(rg-\/1),         \&}
\DoxyCodeLine{7600               \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*d00\_err(rg+1) ) / abs(2d0*maxzadj2f) )                        \&}
\DoxyCodeLine{7601               /(4*(rg-\/1))   )}
\DoxyCodeLine{7602 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7603         dij\_err2(rg-\/1)=max(dij\_err2(rg-\/1),                \&}
\DoxyCodeLine{7604             max(2*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*d00\_err2(rg),abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})*dij\_err2(rg))/abs(zadjfj) )}
\DoxyCodeLine{7605 }
\DoxyCodeLine{7606 \textcolor{preprocessor}{\#ifdef PPEXP00}}
\DoxyCodeLine{7607 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (rg.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7608           \textcolor{keywordflow}{do} n1=0,rg-\/1}
\DoxyCodeLine{7609             \textcolor{keywordflow}{do} n2=0,rg-\/1-\/n1}
\DoxyCodeLine{7610               n3=rg-\/1-\/n1-\/n2}
\DoxyCodeLine{7611               d(0,n1,n2,n3) = d(0,n1,n2,n3) + dexpgx(0,n1,n2,n3,g)}
\DoxyCodeLine{7612 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{7613 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{7614 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7615 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7616 \textcolor{preprocessor}{}\textcolor{comment}{!        write(*,*) 'CalcDgx after it1 ',rg}}
\DoxyCodeLine{7617         \textcolor{keywordflow}{if} ((rg.le.rmax+1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7618           derr(rg-\/1) = 0d0}
\DoxyCodeLine{7619           \textcolor{keywordflow}{do} n1=0,rg-\/1}
\DoxyCodeLine{7620             \textcolor{keywordflow}{do} n2=0,rg-\/1-\/n1}
\DoxyCodeLine{7621               n3 = rg-\/1-\/n1-\/n2}
\DoxyCodeLine{7622               d(0,n1,n2,n3) = d(0,n1,n2,n3) + dexpgx(0,n1,n2,n3,g)}
\DoxyCodeLine{7623               \textcolor{keywordflow}{if}(abs(dexpgx(0,n1,n2,n3,g-\/1)).ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7624 \textcolor{comment}{!              Derr(rg-\/1)=max(Derr(rg-\/1),abs(Dexpgx(0,n1,n2,n3,g))**2/abs(Dexpgx(0,n1,n2,n3,g-\/1)))}}
\DoxyCodeLine{7625                 derr(rg-\/1)=max(derr(rg-\/1),abs(dexpgx(0,n1,n2,n3,g))*min(1d0,abs(dexpgx(0,n1,n2,n3,g))/abs(dexpgx(0,n1,n2,n3,g-\/1))))}
\DoxyCodeLine{7626               \textcolor{keywordflow}{else}}
\DoxyCodeLine{7627                 derr(rg-\/1)=max(derr(rg-\/1),abs(dexpgx(0,n1,n2,n3,g)))}
\DoxyCodeLine{7628 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{7629 }
\DoxyCodeLine{7630 \textcolor{preprocessor}{\#ifdef Dgxtest}}
\DoxyCodeLine{7631 \textcolor{preprocessor}{}\textcolor{comment}{!              write(*,*) 'CalcDgx Derr calc',rg-\/1,Derr(rg-\/1),n1,n2,n3,abs(Dexpg(0,n1,n2,n3,g)),abs(Dexpg(0,n1,n2,n3,g-\/1))}}
\DoxyCodeLine{7632 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7633 \textcolor{preprocessor}{}}
\DoxyCodeLine{7634 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{7635 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{7636 }
\DoxyCodeLine{7637           \textcolor{comment}{! if error from C's larger than error from expansion stop expansion}}
\DoxyCodeLine{7638 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{7639 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(dij\_err2(rg-\/1).gt.3d0*derr(rg-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7640 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{7641 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(dij\_err(rg-\/1).gt.3d0*derr(rg-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7642 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7643 \textcolor{preprocessor}{}            gtrunc = min(g,gtrunc)}
\DoxyCodeLine{7644              }
\DoxyCodeLine{7645 \textcolor{preprocessor}{\#ifdef Dgxtest}}
\DoxyCodeLine{7646 \textcolor{preprocessor}{}             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx exit err'},r,rg-\/1,g,gtrunc,dij\_err(rg-\/1),derr(rg-\/1)}
\DoxyCodeLine{7647 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7648 \textcolor{preprocessor}{}}
\DoxyCodeLine{7649 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7650 }
\DoxyCodeLine{7651 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7652 }
\DoxyCodeLine{7653 \textcolor{keywordflow}{      end do} gloop}
\DoxyCodeLine{7654 }
\DoxyCodeLine{7655 \textcolor{preprocessor}{\#ifdef Dgxtest}}
\DoxyCodeLine{7656 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx D(0,0,0,0) = '},r,d(0,0,0,0)}
\DoxyCodeLine{7657     \textcolor{keywordflow}{if}(r.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{7658       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx D(1,0,0,0) = '},r,d(1,0,0,0)}
\DoxyCodeLine{7659       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx D(0,1,0,0) = '},r,d(0,1,0,0)}
\DoxyCodeLine{7660       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx D(0,0,1,0) = '},r,d(0,0,1,0)}
\DoxyCodeLine{7661 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{7662     \textcolor{keywordflow}{if}(r.gt.2.and.rmax.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{7663       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx D(1,1,0,0) = '},r,d(1,1,0,0)}
\DoxyCodeLine{7664 \textcolor{comment}{!      write(*,*) 'CalcDgx D(0,2,0,0) = ',r,D(0,2,0,0)}}
\DoxyCodeLine{7665 \textcolor{comment}{!      write(*,*) 'CalcDgx D(0,1,1,0) = ',r,D(0,1,1,0)}}
\DoxyCodeLine{7666       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx D(0,0,2,0) = '},r,d(0,0,2,0)}
\DoxyCodeLine{7667 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{7668     \textcolor{keywordflow}{if}(r.gt.3.and.rmax.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{7669       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx D(1,0,1,0) = '},r,d(1,0,1,0)}
\DoxyCodeLine{7670       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx D(1,1,0,0) = '},r,d(1,1,0,0)}
\DoxyCodeLine{7671 \textcolor{comment}{!      write(*,*) 'CalcDgx D(1,2,0,0) = ',r,D(1,2,0,0)}}
\DoxyCodeLine{7672       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx D(0,3,0,0) = '},r,d(0,3,0,0)}
\DoxyCodeLine{7673       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx D(0,2,1,0) = '},r,d(0,2,1,0)}
\DoxyCodeLine{7674       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx D(0,0,3,0) = '},r,d(0,0,3,0)}
\DoxyCodeLine{7675       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx D(0,1,1,1) = '},r,d(0,1,1,1)}
\DoxyCodeLine{7676       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx D(0,0,2,1) = '},r,d(0,0,2,1)}
\DoxyCodeLine{7677 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{7678       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx Dij\_err'},r,dij\_err}
\DoxyCodeLine{7679       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx Dij\_acc'},r,dij\_err/abs(d(0,0,0,0))}
\DoxyCodeLine{7680 }
\DoxyCodeLine{7681       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx err'},r,derr}
\DoxyCodeLine{7682       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx acc'},r,derr/abs(d(0,0,0,0))}
\DoxyCodeLine{7683 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7684 \textcolor{preprocessor}{}}
\DoxyCodeLine{7685       derr2 = max(derr,dij\_err2(0:rmax))}
\DoxyCodeLine{7686       derr = max(derr,dij\_err(0:rmax))}
\DoxyCodeLine{7687 }
\DoxyCodeLine{7688 \textcolor{preprocessor}{\#ifdef Dgxtest}}
\DoxyCodeLine{7689 \textcolor{preprocessor}{}\textcolor{comment}{!      write(*,*) 'CalcDgx exit r',r,maxval(Derr),acc\_req\_D*abs(D(0,0,0,0))}}
\DoxyCodeLine{7690 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7691 \textcolor{preprocessor}{}}
\DoxyCodeLine{7692 \textcolor{comment}{!      if(maxval(Derr).le.acc\_req\_D*abs(D(0,0,0,0))) exit    ! changed 28.01.15}}
\DoxyCodeLine{7693       \textcolor{comment}{! check if target precision already reached}}
\DoxyCodeLine{7694 \textcolor{comment}{! NEEDS UPDATE}}
\DoxyCodeLine{7695 \textcolor{preprocessor}{\#ifdef Cutrloop}}
\DoxyCodeLine{7696 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(derr-\/acc\_req\_d*abs(d(0,0,0,0))).le.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7697 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{7698 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(derr-\/acc\_req\_d*abs(d(0,0,0,0))).le.0d0.and.r.ge.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7699 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7700 \textcolor{preprocessor}{}        \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{7701         \textcolor{keywordflow}{do} n0=0,rg/2}
\DoxyCodeLine{7702         \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{7703         \textcolor{keywordflow}{do} n2=0,rg-\/2*n0-\/n1}
\DoxyCodeLine{7704           d(n0,n1,n2,rg-\/2*n0-\/n1-\/n2)=0d0}
\DoxyCodeLine{7705 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{7706 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{7707 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{7708 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{7709 }
\DoxyCodeLine{7710         \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{7711 }
\DoxyCodeLine{7712 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{7713 }
\DoxyCodeLine{7714 \textcolor{keywordflow}{    end do} rloop}
\DoxyCodeLine{7715 }
\DoxyCodeLine{7716 }
\DoxyCodeLine{7717 \textcolor{preprocessor}{\#ifdef Dgxtest}}
\DoxyCodeLine{7718 \textcolor{preprocessor}{}\textcolor{comment}{!    write(*,*) 'CalcDgx D(0,0,0,0) = ',D(0,0,0,0)}}
\DoxyCodeLine{7719 \textcolor{comment}{!    if(rmax.ge.3)then}}
\DoxyCodeLine{7720 \textcolor{comment}{!      write(*,*) 'CalcDgx D(0,1,1,1) = ',D(0,1,1,1)}}
\DoxyCodeLine{7721 \textcolor{comment}{!    endif}}
\DoxyCodeLine{7722 }
\DoxyCodeLine{7723     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx final err'},derr}
\DoxyCodeLine{7724     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgx final acc'},derr/abs(d(0,0,0,0))}
\DoxyCodeLine{7725 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{7726 \textcolor{preprocessor}{}       }
\DoxyCodeLine{7727 \textcolor{comment}{!    write(*,*) 'CalcDgx Derr ',Derr}}
\DoxyCodeLine{7728 \textcolor{comment}{!    write(*,*) 'CalcDgx Derr2',Derr2}}
\DoxyCodeLine{7729                     }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiond_a0a8af515043a0e7891a7944c886f7314}\label{namespacereductiond_a0a8af515043a0e7891a7944c886f7314}} 
\index{reductiond@{reductiond}!calcdgy@{calcdgy}}
\index{calcdgy@{calcdgy}!reductiond@{reductiond}}
\doxysubsubsection{\texorpdfstring{calcdgy()}{calcdgy()}}
{\footnotesize\ttfamily subroutine reductiond\+::calcdgy (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{D,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Duv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{ordgy\+\_\+min,  }\item[{integer, intent(in)}]{ordgy\+\_\+max,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr2 }\end{DoxyParamCaption})}



Definition at line 7749 of file reduction\+D.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{7749   }
\DoxyCodeLine{7750     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobald}{globald}}}
\DoxyCodeLine{7751 }
\DoxyCodeLine{7752     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,ordgy\_min,ordgy\_max,id}
\DoxyCodeLine{7753     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p30,p20,p31,m02,m12,m22,m32}
\DoxyCodeLine{7754     \textcolor{keywordtype}{double complex} ::Zadj2(4)}
\DoxyCodeLine{7755     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Dexpgy(:,:,:,:,:), DuvExpgy(:,:,:,:)}
\DoxyCodeLine{7756     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: D(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{7757     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Duv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{7758     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Derr(0:rmax),Derr2(0:rmax)}
\DoxyCodeLine{7759     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_0(:,:,:,:), C\_i(:,:,:,:), Shat(:,:,:,:,:)}
\DoxyCodeLine{7760     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Cuv\_0(:,:,:,:), Cuv\_i(:,:,:,:)}
\DoxyCodeLine{7761     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: D\_alt(:,:,:,:)}
\DoxyCodeLine{7762     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: Cerr\_i(:,:),Cerr2\_i(:,:)}
\DoxyCodeLine{7763     \textcolor{keywordtype}{double complex} :: Smod(3), Daux, elimminf2\_coli}
\DoxyCodeLine{7764     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err(:),Dij\_err(:),Cij\_err(:),acc\_req\_Cextra(:)}
\DoxyCodeLine{7765     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err2(:),Dij\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{7766     \textcolor{keywordtype}{double precision} :: maxDexpgy(0:1,0:rmax+2*ordgy\_min,0:ordgy\_max),truncfacexp,acc\_aux}
\DoxyCodeLine{7767     \textcolor{keywordtype}{integer} :: rmaxC,rmaxExp,gtrunc,r,n0,n1,n2,n3,a,b,i,g,rg,m,n}
\DoxyCodeLine{7768     \textcolor{keywordtype}{integer} :: inds0(3),inds(3),inds2(2,4),at,bt,k,l,lt,ltt,nl,nlt,nltt}
\DoxyCodeLine{7769     \textcolor{keywordtype}{integer} :: bin,nid(0:3)}
\DoxyCodeLine{7770     \textcolor{keywordtype}{logical} :: errorwriteflag}
\DoxyCodeLine{7771 }
\DoxyCodeLine{7772 \textcolor{preprocessor}{\#ifdef Dgytest}}
\DoxyCodeLine{7773 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy in, ord'},rmax,ordgy\_min,ordgy\_max}
\DoxyCodeLine{7774 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7775 \textcolor{preprocessor}{}}
\DoxyCodeLine{7776     \textcolor{comment}{! allocation of C functions}}
\DoxyCodeLine{7777     rmaxc = rmax + 2*ordgy\_min + 1}
\DoxyCodeLine{7778     \textcolor{keyword}{allocate}(c\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{7779     \textcolor{keyword}{allocate}(cuv\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{7780     \textcolor{keyword}{allocate}(c\_i(0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{7781     \textcolor{keyword}{allocate}(cuv\_i(0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{7782     \textcolor{keyword}{allocate}(cerr\_i(0:rmaxc,0:3))}
\DoxyCodeLine{7783     \textcolor{keyword}{allocate}(cerr2\_i(0:rmaxc,0:3))}
\DoxyCodeLine{7784     \textcolor{keyword}{allocate}(acc\_req\_cextra(0:rmaxc))}
\DoxyCodeLine{7785     }
\DoxyCodeLine{7786     \textcolor{comment}{! determine binaries for C-\/coefficients}}
\DoxyCodeLine{7787     k=0}
\DoxyCodeLine{7788     bin = 1}
\DoxyCodeLine{7789     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.3)}
\DoxyCodeLine{7790       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7791         nid(k) = id+bin}
\DoxyCodeLine{7792         k = k+1}
\DoxyCodeLine{7793 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{7794       bin = 2*bin}
\DoxyCodeLine{7795 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7796 }
\DoxyCodeLine{7797     \textcolor{comment}{! reduce required accuracy of higher rank C's that appear only in expansion by dividing}}
\DoxyCodeLine{7798     \textcolor{comment}{! by estimated suppression factors that are multiplied in expansion}}
\DoxyCodeLine{7799     acc\_req\_cextra(0:rmax+1) = acc\_req\_cind}
\DoxyCodeLine{7800     acc\_aux = acc\_req\_c}
\DoxyCodeLine{7801     \textcolor{keywordflow}{if} (y\_gy.ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7802       \textcolor{keywordflow}{do} g=1,ordgy\_min}
\DoxyCodeLine{7803         acc\_req\_cextra(rmax+2*g) = acc\_req\_cextra(rmax+2*g-\/2)/y\_gy}
\DoxyCodeLine{7804         acc\_req\_cextra(rmax+2*g+1) = acc\_req\_cextra(rmax+2*g-\/1)/y\_gy}
\DoxyCodeLine{7805         acc\_aux = acc\_aux/max(x\_gy,v\_gy*y\_gy)}
\DoxyCodeLine{7806         acc\_req\_cextra(rmax+g+1) = min(acc\_req\_cextra(rmax+g+1),acc\_aux)}
\DoxyCodeLine{7807 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7808     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(x\_gy.ne.0d0) \textcolor{keywordflow}{then} \textcolor{comment}{! 10.07.2017}}
\DoxyCodeLine{7809       \textcolor{keywordflow}{do} g=1,ordgy\_min}
\DoxyCodeLine{7810         acc\_aux = acc\_aux/x\_gy}
\DoxyCodeLine{7811         acc\_req\_cextra(rmax+g+1) = acc\_aux}
\DoxyCodeLine{7812 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7813     \textcolor{keywordflow}{else} \textcolor{comment}{! 10.07.2017}}
\DoxyCodeLine{7814        acc\_req\_cextra(rmax+2:rmax+2*ordgy\_min+1) = acc\_inf}
\DoxyCodeLine{7815 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7816    }
\DoxyCodeLine{7817 }
\DoxyCodeLine{7818 }
\DoxyCodeLine{7819 \textcolor{preprocessor}{\#ifdef Dgytest}}
\DoxyCodeLine{7820 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy: accreq\_Cextra'},acc\_req\_cextra}
\DoxyCodeLine{7821 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7822 \textcolor{preprocessor}{}}
\DoxyCodeLine{7823     \textcolor{keyword}{call }calcc(c\_0(:,0,:,:),cuv\_0(:,0,:,:),p21,p32,p31,m12,m22,m32,rmaxc,nid(0),cerr\_i(:,0),cerr2\_i(:,0),rmax,acc\_req\_cextra)}
\DoxyCodeLine{7824     \textcolor{keyword}{call }calcc(c\_i(:,:,:,1),cuv\_i(:,:,:,1),p20,p32,p30,m02,m22,m32,rmaxc,nid(1),cerr\_i(:,1),cerr2\_i(:,1),rmax,acc\_req\_cextra)}
\DoxyCodeLine{7825     \textcolor{keyword}{call }calcc(c\_i(:,:,:,2),cuv\_i(:,:,:,2),p10,p31,p30,m02,m12,m32,rmaxc,nid(2),cerr\_i(:,2),cerr2\_i(:,2),rmax,acc\_req\_cextra)}
\DoxyCodeLine{7826     \textcolor{keyword}{call }calcc(c\_i(:,:,:,3),cuv\_i(:,:,:,3),p10,p21,p20,m02,m12,m22,rmaxc,nid(3),cerr\_i(:,3),cerr2\_i(:,3),rmax,acc\_req\_cextra)}
\DoxyCodeLine{7827 }
\DoxyCodeLine{7828 \textcolor{preprocessor}{\#ifdef Dgytest}}
\DoxyCodeLine{7829 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy Cerr 0'},cerr\_i(:,0)}
\DoxyCodeLine{7830     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy Cerr 1'},cerr\_i(:,1)}
\DoxyCodeLine{7831     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy Cerr 2'},cerr\_i(:,2)}
\DoxyCodeLine{7832     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy Cerr 3'},cerr\_i(:,3)}
\DoxyCodeLine{7833 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7834 \textcolor{preprocessor}{}}
\DoxyCodeLine{7835 }
\DoxyCodeLine{7836     \textcolor{comment}{! shift of integration momentum in C\(\backslash\)\{0\}}}
\DoxyCodeLine{7837     \textcolor{keywordflow}{do} n1=1,rmaxc}
\DoxyCodeLine{7838       \textcolor{keywordflow}{do} n2=0,rmaxc-\/n1}
\DoxyCodeLine{7839         \textcolor{keywordflow}{do} n3=0,rmaxc-\/n1-\/n2}
\DoxyCodeLine{7840           n0 = (rmaxc-\/n1-\/n2-\/n3)}
\DoxyCodeLine{7841           c\_0(0:n0,n1,n2,n3) = -\/c\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{7842                             -\/c\_0(0:n0,n1-\/1,n2+1,n3)-\/c\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{7843           cuv\_0(0:n0,n1,n2,n3) = -\/cuv\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{7844                               -\/cuv\_0(0:n0,n1-\/1,n2+1,n3)-\/cuv\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{7845 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7846 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7847 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7848       }
\DoxyCodeLine{7849 }
\DoxyCodeLine{7850     \textcolor{comment}{! calculate adjugated Gram and Cayley matrix}}
\DoxyCodeLine{7851 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{7852 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{7853 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{7854 \textcolor{comment}{!    mm32 = elimminf2\_coli(m32)}}
\DoxyCodeLine{7855 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{7856 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{7857 \textcolor{comment}{!    q32  = elimminf2\_coli(p32)}}
\DoxyCodeLine{7858 \textcolor{comment}{!    q30  = elimminf2\_coli(p30)}}
\DoxyCodeLine{7859 \textcolor{comment}{!    q31  = elimminf2\_coli(p31)}}
\DoxyCodeLine{7860 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{7861 \textcolor{comment}{!}}
\DoxyCodeLine{7862 \textcolor{comment}{!    Z(1,1) = 2d0*q10}}
\DoxyCodeLine{7863 \textcolor{comment}{!    Z(2,1) = q10+q20-\/q21}}
\DoxyCodeLine{7864 \textcolor{comment}{!    Z(3,1) = q10+q30-\/q31}}
\DoxyCodeLine{7865 \textcolor{comment}{!    Z(1,2) = Z(2,1)}}
\DoxyCodeLine{7866 \textcolor{comment}{!    Z(2,2) = 2d0*q20}}
\DoxyCodeLine{7867 \textcolor{comment}{!    Z(3,2) = q20+q30-\/q32}}
\DoxyCodeLine{7868 \textcolor{comment}{!    Z(1,3) = Z(3,1)}}
\DoxyCodeLine{7869 \textcolor{comment}{!    Z(2,3) = Z(3,2)}}
\DoxyCodeLine{7870 \textcolor{comment}{!    Z(3,3) = 2d0*q30}}
\DoxyCodeLine{7871 \textcolor{comment}{!}}
\DoxyCodeLine{7872 \textcolor{comment}{!    q1q2 = (q10+q20-\/q21)}}
\DoxyCodeLine{7873 \textcolor{comment}{!    q1q3 = (q10+q30-\/q31)}}
\DoxyCodeLine{7874 \textcolor{comment}{!    q2q3 = (q20+q30-\/q32)}}
\DoxyCodeLine{7875 \textcolor{comment}{!    detZ = 8d0*q10*q30*q20+2D0*q1q2*q1q3*q2q3  \&}}
\DoxyCodeLine{7876 \textcolor{comment}{!     \&    -\/2d0*(q10*q2q3*q2q3+q20*q1q3*q1q3+q30*q1q2*q1q2)}}
\DoxyCodeLine{7877 \textcolor{comment}{!}}
\DoxyCodeLine{7878 \textcolor{comment}{!    Zadj(1,1) = (4d0*q30*q20-\/q2q3*q2q3)}}
\DoxyCodeLine{7879 \textcolor{comment}{!    Zadj(2,1) = (q1q3*q2q3-\/2d0*q30*q1q2)}}
\DoxyCodeLine{7880 \textcolor{comment}{!    Zadj(3,1) = (q1q2*q2q3-\/2d0*q20*q1q3)}}
\DoxyCodeLine{7881 \textcolor{comment}{!    Zadj(1,2) = Zadj(2,1)}}
\DoxyCodeLine{7882 \textcolor{comment}{!    Zadj(2,2) = (4d0*q10*q30-\/q1q3*q1q3)}}
\DoxyCodeLine{7883 \textcolor{comment}{!    Zadj(3,2) = (q1q2*q1q3-\/2d0*q10*q2q3)}}
\DoxyCodeLine{7884 \textcolor{comment}{!    Zadj(1,3) = Zadj(3,1)}}
\DoxyCodeLine{7885 \textcolor{comment}{!    Zadj(2,3) = Zadj(3,2)}}
\DoxyCodeLine{7886 \textcolor{comment}{!    Zadj(3,3) = (4d0*q10*q20-\/q1q2*q1q2)}}
\DoxyCodeLine{7887 \textcolor{comment}{!}}
\DoxyCodeLine{7888 \textcolor{comment}{!    f(1) = q10+mm02-\/mm12}}
\DoxyCodeLine{7889 \textcolor{comment}{!    f(2) = q20+mm02-\/mm22}}
\DoxyCodeLine{7890 \textcolor{comment}{!    f(3) = q30+mm02-\/mm32}}
\DoxyCodeLine{7891 \textcolor{comment}{!      }}
\DoxyCodeLine{7892 \textcolor{comment}{!    Zadjf(1) = Zadj(1,1)*f(1)+Zadj(2,1)*f(2)+Zadj(3,1)*f(3)}}
\DoxyCodeLine{7893 \textcolor{comment}{!    Zadjf(2) = Zadj(1,2)*f(1)+Zadj(2,2)*f(2)+Zadj(3,2)*f(3)}}
\DoxyCodeLine{7894 \textcolor{comment}{!    Zadjf(3) = Zadj(1,3)*f(1)+Zadj(2,3)*f(2)+Zadj(3,3)*f(3)}}
\DoxyCodeLine{7895 }
\DoxyCodeLine{7896 \textcolor{comment}{!    Xadj(1,1) = 2d0*mm02*Zadj(1,1) -\/ f(2)*f(2)*Z(3,3)  \&}}
\DoxyCodeLine{7897 \textcolor{comment}{!              + 2d0*f(2)*f(3)*Z(2,3) -\/ f(3)*f(3)*Z(2,2)}}
\DoxyCodeLine{7898 \textcolor{comment}{!    Xadj(2,1) = 2d0*mm02*Zadj(2,1) + f(1)*f(2)*Z(3,3)  \&}}
\DoxyCodeLine{7899 \textcolor{comment}{!              -\/ f(1)*f(3)*Z(2,3) -\/ f(2)*f(3)*Z(1,3) + f(3)*f(3)*Z(2,1)}}
\DoxyCodeLine{7900 \textcolor{comment}{!    Xadj(3,1) = 2d0*mm02*Zadj(3,1) -\/ f(1)*f(2)*Z(3,2)  \&}}
\DoxyCodeLine{7901 \textcolor{comment}{!              + f(2)*f(2)*Z(3,1) + f(1)*f(3)*Z(2,2) -\/ f(2)*f(3)*Z(1,2)}}
\DoxyCodeLine{7902 \textcolor{comment}{!    Xadj(1,2) = Xadj(2,1)}}
\DoxyCodeLine{7903 \textcolor{comment}{!    Xadj(2,2) = 2d0*mm02*Zadj(2,2) -\/ f(1)*f(1)*Z(3,3)  \&}}
\DoxyCodeLine{7904 \textcolor{comment}{!              + 2d0*f(1)*f(3)*Z(1,3) -\/ f(3)*f(3)*Z(1,1)}}
\DoxyCodeLine{7905 \textcolor{comment}{!    Xadj(3,2) = 2d0*mm02*Zadj(3,2) + f(1)*f(1)*Z(3,2)  \&}}
\DoxyCodeLine{7906 \textcolor{comment}{!              -\/ f(1)*f(2)*Z(3,1) -\/ f(1)*f(3)*Z(2,1) + f(2)*f(3)*Z(1,1)}}
\DoxyCodeLine{7907 \textcolor{comment}{!    Xadj(1,3) = Xadj(3,1)}}
\DoxyCodeLine{7908 \textcolor{comment}{!    Xadj(2,3) = Xadj(3,2)}}
\DoxyCodeLine{7909 \textcolor{comment}{!    Xadj(3,3) = 2d0*mm02*Zadj(3,3) -\/ f(1)*f(1)*Z(2,2)  \&}}
\DoxyCodeLine{7910 \textcolor{comment}{!              + 2d0*f(1)*f(2)*Z(2,1) -\/ f(2)*f(2)*Z(1,1)}}
\DoxyCodeLine{7911 }
\DoxyCodeLine{7912 }
\DoxyCodeLine{7913     \textcolor{comment}{! coefficients Shat defined in (5.13)}}
\DoxyCodeLine{7914     \textcolor{keyword}{allocate}(shat(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{7915 }
\DoxyCodeLine{7916     \textcolor{keywordflow}{do} r=0,rmaxc}
\DoxyCodeLine{7917       \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{7918         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{7919           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{7920             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{7921 }
\DoxyCodeLine{7922             shat(n0,n1,n2,n3,:) = -\/c\_0(n0,n1,n2,n3)}
\DoxyCodeLine{7923 }
\DoxyCodeLine{7924             \textcolor{keywordflow}{if}(n1.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7925               shat(n0,n1,n2,n3,1) = shat(n0,n1,n2,n3,1) + c\_i(n0,n2,n3,1)}
\DoxyCodeLine{7926 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{7927 }
\DoxyCodeLine{7928             \textcolor{keywordflow}{if}(n2.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7929               shat(n0,n1,n2,n3,2) = shat(n0,n1,n2,n3,2) + c\_i(n0,n1,n3,2)}
\DoxyCodeLine{7930 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{7931 }
\DoxyCodeLine{7932             \textcolor{keywordflow}{if}(n3.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7933               shat(n0,n1,n2,n3,3) = shat(n0,n1,n2,n3,3) + c\_i(n0,n1,n2,3)}
\DoxyCodeLine{7934 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{7935 }
\DoxyCodeLine{7936 \textcolor{preprocessor}{\#ifdef Dgytest}}
\DoxyCodeLine{7937 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(n0.eq.0.and.n1.eq.0.and.n2.eq.0.and.n3.eq.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{7938             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy 0 C\_0'},c\_0(n0,n1,n2,n3)}
\DoxyCodeLine{7939             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy 0 C\_1'},c\_i(n0,n2,n3,1)}
\DoxyCodeLine{7940             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy 0 C\_2'},c\_i(n0,n1,n3,2)}
\DoxyCodeLine{7941             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy 0 C\_3'},c\_i(n0,n1,n2,3)}
\DoxyCodeLine{7942             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy 0 Sh1'},shat(n0,n1,n2,n3,1)}
\DoxyCodeLine{7943             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy 0 Sh2'},shat(n0,n1,n2,n3,2)}
\DoxyCodeLine{7944             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy 0 Sh3'},shat(n0,n1,n2,n3,3)}
\DoxyCodeLine{7945 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{7946 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7947 \textcolor{preprocessor}{}}
\DoxyCodeLine{7948 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{7949 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7950 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7951 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7952 }
\DoxyCodeLine{7953     \textcolor{comment}{! choose reduction formulas with biggest denominators}}
\DoxyCodeLine{7954     \mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}} = 0d0}
\DoxyCodeLine{7955     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,1)).gt.\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7956       \mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}} = abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,1))}
\DoxyCodeLine{7957       a = 1}
\DoxyCodeLine{7958       b = 1}
\DoxyCodeLine{7959       inds2 = reshape((/2,2,2,3,3,2,3,3/),shape(inds2))}
\DoxyCodeLine{7960       zadj2(1) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)}
\DoxyCodeLine{7961       zadj2(2) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)}
\DoxyCodeLine{7962       zadj2(3) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3)}
\DoxyCodeLine{7963       zadj2(4) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)}
\DoxyCodeLine{7964 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7965     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,2)).gt.\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7966       \mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}} = abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,2))}
\DoxyCodeLine{7967       a = 2}
\DoxyCodeLine{7968       b = 2}
\DoxyCodeLine{7969       inds2 = reshape((/1,1,1,3,3,1,3,3/),shape(inds2))}
\DoxyCodeLine{7970       zadj2(1) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)}
\DoxyCodeLine{7971       zadj2(2) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)}
\DoxyCodeLine{7972       zadj2(3) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,3)}
\DoxyCodeLine{7973       zadj2(4) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)}
\DoxyCodeLine{7974 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7975     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(3,3)).gt.\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7976       \mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}} = abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(3,3))}
\DoxyCodeLine{7977       a = 3}
\DoxyCodeLine{7978       b = 3}
\DoxyCodeLine{7979       inds2 = reshape((/1,1,1,2,2,1,2,2/),shape(inds2))}
\DoxyCodeLine{7980       zadj2(1) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)}
\DoxyCodeLine{7981       zadj2(2) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{7982       zadj2(3) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2)}
\DoxyCodeLine{7983       zadj2(4) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)}
\DoxyCodeLine{7984 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7985     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,2)).gt.\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7986       \mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}} = abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,2))}
\DoxyCodeLine{7987       a = 1}
\DoxyCodeLine{7988       b = 2}
\DoxyCodeLine{7989       inds2 = reshape((/2,1,2,3,3,1,3,3/),shape(inds2))}
\DoxyCodeLine{7990       zadj2(1) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)}
\DoxyCodeLine{7991       zadj2(2) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)}
\DoxyCodeLine{7992       zadj2(3) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3)}
\DoxyCodeLine{7993       zadj2(4) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{7994 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7995     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,3)).gt.\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7996       \mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}} = abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,3))}
\DoxyCodeLine{7997       a = 1}
\DoxyCodeLine{7998       b = 3}
\DoxyCodeLine{7999       inds2 = reshape((/2,1,2,2,3,1,3,2/),shape(inds2))}
\DoxyCodeLine{8000       zadj2(1) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)}
\DoxyCodeLine{8001       zadj2(2) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)}
\DoxyCodeLine{8002       zadj2(3) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)}
\DoxyCodeLine{8003       zadj2(4) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{8004 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{8005     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,3)).gt.\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8006       a = 2}
\DoxyCodeLine{8007       b = 3}
\DoxyCodeLine{8008       inds2 = reshape((/1,1,1,2,3,1,3,2/),shape(inds2))}
\DoxyCodeLine{8009       zadj2(1) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)}
\DoxyCodeLine{8010       zadj2(2) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)}
\DoxyCodeLine{8011       zadj2(3) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2)}
\DoxyCodeLine{8012       zadj2(4) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)}
\DoxyCodeLine{8013 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{8014 }
\DoxyCodeLine{8015     \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = 0d0}
\DoxyCodeLine{8016     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1)).gt.\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8017       \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1))}
\DoxyCodeLine{8018       k = 1}
\DoxyCodeLine{8019       l = 1}
\DoxyCodeLine{8020       lt = 2}
\DoxyCodeLine{8021       ltt = 3}
\DoxyCodeLine{8022 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{8023     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2)).gt.\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8024       \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2))}
\DoxyCodeLine{8025       k = 2}
\DoxyCodeLine{8026       l = 2}
\DoxyCodeLine{8027       lt = 1}
\DoxyCodeLine{8028       ltt = 3}
\DoxyCodeLine{8029 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{8030     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,3)).gt.\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8031       \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,3))}
\DoxyCodeLine{8032       k = 3}
\DoxyCodeLine{8033       l = 3}
\DoxyCodeLine{8034       lt = 1}
\DoxyCodeLine{8035       ltt = 2}
\DoxyCodeLine{8036 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{8037     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2)).gt.\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8038       \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2))}
\DoxyCodeLine{8039       k = 1}
\DoxyCodeLine{8040       l = 2}
\DoxyCodeLine{8041       lt = 1}
\DoxyCodeLine{8042       ltt = 3}
\DoxyCodeLine{8043 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{8044     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,3)).gt.\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8045       \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,3))}
\DoxyCodeLine{8046       k = 1}
\DoxyCodeLine{8047       l = 3}
\DoxyCodeLine{8048       lt = 1}
\DoxyCodeLine{8049       ltt = 2}
\DoxyCodeLine{8050 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{8051     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,3)).gt.\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8052       k = 2}
\DoxyCodeLine{8053       l = 3}
\DoxyCodeLine{8054       lt = 1}
\DoxyCodeLine{8055       ltt = 2}
\DoxyCodeLine{8056 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{8057 }
\DoxyCodeLine{8058 \textcolor{preprocessor}{\#ifdef Dgytest}}
\DoxyCodeLine{8059 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy: Zadj'},k,l,\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)}
\DoxyCodeLine{8060     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy: Xadj'},a,b,\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(a,b)}
\DoxyCodeLine{8061 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8062 \textcolor{preprocessor}{}}
\DoxyCodeLine{8063         }
\DoxyCodeLine{8064     \textcolor{comment}{! allocation of array for det(Z)-\/ and det(X)-\/expanded C-\/coefficients}}
\DoxyCodeLine{8065     rmaxexp = rmaxc+1}
\DoxyCodeLine{8066     \textcolor{keyword}{allocate}(dexpgy(0:max(rmax/2,1),0:rmaxexp-\/2,0:rmaxexp-\/2,0:rmaxexp-\/2,0:ordgy\_max))}
\DoxyCodeLine{8067    }
\DoxyCodeLine{8068 }
\DoxyCodeLine{8069     \textcolor{comment}{! calculate Cuv}}
\DoxyCodeLine{8070     \textcolor{keyword}{allocate}(duvexpgy(0:rmaxexp,0:rmaxexp,0:rmaxexp,0:rmaxexp))}
\DoxyCodeLine{8071     \textcolor{keyword}{call }calcduv(duvexpgy,cuv\_0,mm02,f,rmaxexp,id)}
\DoxyCodeLine{8072     duv(0:rmax,0:rmax,0:rmax,0:rmax) = duvexpgy(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{8073 }
\DoxyCodeLine{8074     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{8075     \textcolor{keyword}{allocate}(d00\_err(0:rmaxexp))}
\DoxyCodeLine{8076     \textcolor{keyword}{allocate}(dij\_err(0:rmaxexp))}
\DoxyCodeLine{8077     \textcolor{keyword}{allocate}(cij\_err(0:rmaxc))}
\DoxyCodeLine{8078 }
\DoxyCodeLine{8079     \textcolor{keyword}{allocate}(d00\_err2(0:rmaxexp))}
\DoxyCodeLine{8080     \textcolor{keyword}{allocate}(dij\_err2(0:rmaxexp))}
\DoxyCodeLine{8081     \textcolor{keyword}{allocate}(cij\_err2(0:rmaxc))}
\DoxyCodeLine{8082 }
\DoxyCodeLine{8083     \textcolor{comment}{! initialize accuracy estimates}}
\DoxyCodeLine{8084     derr = acc\_inf}
\DoxyCodeLine{8085     dij\_err =0d0}
\DoxyCodeLine{8086     d00\_err =0d0}
\DoxyCodeLine{8087     cij\_err = max(cerr\_i(:,0),cerr\_i(:,1),cerr\_i(:,2),cerr\_i(:,3))}
\DoxyCodeLine{8088 }
\DoxyCodeLine{8089     derr2 = acc\_inf}
\DoxyCodeLine{8090     dij\_err2 =0d0}
\DoxyCodeLine{8091     d00\_err2 =0d0}
\DoxyCodeLine{8092     cij\_err2 = max(cerr2\_i(:,0),cerr2\_i(:,1),cerr2\_i(:,2),cerr2\_i(:,3))}
\DoxyCodeLine{8093 }
\DoxyCodeLine{8094 \textcolor{comment}{!    maxZadj = maxval(abs(Zadj))}}
\DoxyCodeLine{8095 \textcolor{comment}{!    maxZadj2f = maxval(abs(f(inds2(1,:))*Zadj2(:)))}}
\DoxyCodeLine{8096 \textcolor{comment}{!    maxZadjf = maxval(abs(Zadjf))}}
\DoxyCodeLine{8097 \textcolor{comment}{!    adetZ = abs(detZ)}}
\DoxyCodeLine{8098 }
\DoxyCodeLine{8099     \textcolor{comment}{! truncation of expansion if calculated term larger than truncfacexp * previous term}}
\DoxyCodeLine{8100     \textcolor{comment}{! crucial for expansion parameters between 0.1 and 1 !!!}}
\DoxyCodeLine{8101 \textcolor{comment}{!    truncfacexp = sqrt(max(maxZadjf,adetZ)/maxXadj*max(1d0,maxZadj2f/maxZadj)) * truncfacD}}
\DoxyCodeLine{8102     truncfacexp = sqrt(\mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}}) * truncfacd}
\DoxyCodeLine{8103     gtrunc = ordgy\_max }
\DoxyCodeLine{8104 }
\DoxyCodeLine{8105 \textcolor{comment}{! calculate D(1,n1,n2,n3) up to rank r+2}}
\DoxyCodeLine{8106 \textcolor{comment}{! calculate D(0,n1,n2,n3) up to rank r  }}
\DoxyCodeLine{8107     rloop: \textcolor{keywordflow}{do} r=0,rmaxexp-\/2}
\DoxyCodeLine{8108 }
\DoxyCodeLine{8109       \textcolor{keywordflow}{if} (r.gt.rmax+2*gtrunc+2) \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{8110 }
\DoxyCodeLine{8111       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{8112       \textcolor{comment}{! 0th-\/order coefficients}}
\DoxyCodeLine{8113       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{8114 }
\DoxyCodeLine{8115       \textcolor{comment}{! calculating D\_00ijk.. exploiting eq. (5.49)}}
\DoxyCodeLine{8116       maxdexpgy(1,r,0)=0d0}
\DoxyCodeLine{8117       \textcolor{keywordflow}{do} nl=r,0,-\/1}
\DoxyCodeLine{8118         \textcolor{keywordflow}{do} nlt=r-\/nl,0,-\/1}
\DoxyCodeLine{8119           nltt = r-\/nl-\/nlt}
\DoxyCodeLine{8120           inds0(l) = nl}
\DoxyCodeLine{8121           inds0(lt) = nlt}
\DoxyCodeLine{8122           inds0(ltt) = nltt}
\DoxyCodeLine{8123 }
\DoxyCodeLine{8124           inds(l) = nl+1}
\DoxyCodeLine{8125           inds(lt) = nlt}
\DoxyCodeLine{8126           inds(ltt) = nltt}
\DoxyCodeLine{8127 }
\DoxyCodeLine{8128           daux = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,1)*shat(0,inds(1),inds(2),inds(3),1)  \&}
\DoxyCodeLine{8129                + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,2)*shat(0,inds(1),inds(2),inds(3),2)  \&}
\DoxyCodeLine{8130                + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,3)*shat(0,inds(1),inds(2),inds(3),3)}
\DoxyCodeLine{8131 }
\DoxyCodeLine{8132           \textcolor{keywordflow}{if} (nlt.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8133             inds(lt) = nlt-\/1}
\DoxyCodeLine{8134             daux = daux -\/ 2*nlt*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,lt)*dexpgy(1,inds(1),inds(2),inds(3),0)}
\DoxyCodeLine{8135 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{8136 }
\DoxyCodeLine{8137           \textcolor{keywordflow}{if} (nltt.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8138             inds(lt) = nlt}
\DoxyCodeLine{8139             inds(ltt) = nltt-\/1}
\DoxyCodeLine{8140             daux = daux -\/ 2*nltt*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,ltt)*dexpgy(1,inds(1),inds(2),inds(3),0)}
\DoxyCodeLine{8141 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{8142 }
\DoxyCodeLine{8143           dexpgy(1,inds0(1),inds0(2),inds0(3),0) = daux/(2*(nl+1)*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l))}
\DoxyCodeLine{8144 }
\DoxyCodeLine{8145           maxdexpgy(1,r,0) =  maxdexpgy(1,r,0) + abs(dexpgy(1,inds0(1),inds0(2),inds0(3),0) )}
\DoxyCodeLine{8146 }
\DoxyCodeLine{8147 \textcolor{comment}{!          if (r+2.le.rmax) then          !  for fixed rank}}
\DoxyCodeLine{8148           \textcolor{keywordflow}{if} (r+1.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8149             d(1,inds0(1),inds0(2),inds0(3)) = dexpgy(1,inds0(1),inds0(2),inds0(3),0)}
\DoxyCodeLine{8150 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{8151       }
\DoxyCodeLine{8152 }
\DoxyCodeLine{8153 }
\DoxyCodeLine{8154 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8155 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{8156 }
\DoxyCodeLine{8157       \textcolor{comment}{! calculate D\_ijkl.. exploiting eq. (5.53)}}
\DoxyCodeLine{8158       maxdexpgy(0,r,0)=0d0}
\DoxyCodeLine{8159       \textcolor{keywordflow}{do} n1=0,r}
\DoxyCodeLine{8160         \textcolor{keywordflow}{do} n2=0,r-\/n1}
\DoxyCodeLine{8161           n3 = r-\/n1-\/n2}
\DoxyCodeLine{8162 }
\DoxyCodeLine{8163 \textcolor{comment}{! Duv added 16.05.14      }}
\DoxyCodeLine{8164 \textcolor{comment}{!          Daux = (2d0*(1+r)*Dexpgy(1,n1,n2,n3,0) -\/ C\_0(0,n1,n2,n3))*Zadj(a,b)}}
\DoxyCodeLine{8165           daux = (2d0*(1+r)*dexpgy(1,n1,n2,n3,0)  -\/ 4*duvexpgy(1,n1,n2,n3)  \&}
\DoxyCodeLine{8166             -\/ c\_0(0,n1,n2,n3))*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(a,b)}
\DoxyCodeLine{8167 }
\DoxyCodeLine{8168           smod = shat(0,n1,n2,n3,:)}
\DoxyCodeLine{8169 }
\DoxyCodeLine{8170 \textcolor{preprocessor}{\#ifdef Dgytest}}
\DoxyCodeLine{8171 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(n1.eq.0.and.n2.eq.2.and.n3.eq.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{8172             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy 0 Smod'},smod}
\DoxyCodeLine{8173             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy 0 Daux'},daux}
\DoxyCodeLine{8174 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{8175 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8176 \textcolor{preprocessor}{}}
\DoxyCodeLine{8177           \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8178             smod(1) = smod(1) -\/ 2d0*n1*dexpgy(1,n1-\/1,n2,n3,0)}
\DoxyCodeLine{8179 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{8180           \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8181             smod(2) = smod(2) -\/ 2d0*n2*dexpgy(1,n1,n2-\/1,n3,0)}
\DoxyCodeLine{8182 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{8183           \textcolor{keywordflow}{if} (n3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8184             smod(3) = smod(3) -\/ 2d0*n3*dexpgy(1,n1,n2,n3-\/1,0)}
\DoxyCodeLine{8185 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{8186 }
\DoxyCodeLine{8187 \textcolor{preprocessor}{\#ifdef Dgytest}}
\DoxyCodeLine{8188 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(n1.eq.0.and.n2.eq.2.and.n3.eq.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{8189             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy 0'},r,a,b,\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(b)/\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(a,b)}
\DoxyCodeLine{8190             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy 0'},k,l,\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}/\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l),\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(k)/\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)}
\DoxyCodeLine{8191             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy 0 line1'},r,daux/\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(a,b)}
\DoxyCodeLine{8192 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{8193 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8194 \textcolor{preprocessor}{}}
\DoxyCodeLine{8195           \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{8196             n = inds2(1,i)}
\DoxyCodeLine{8197             m = inds2(2,i)}
\DoxyCodeLine{8198             daux = daux + zadj2(i)*f(n)*smod(m)}
\DoxyCodeLine{8199 }
\DoxyCodeLine{8200 \textcolor{preprocessor}{\#ifdef Dgytest}}
\DoxyCodeLine{8201 \textcolor{preprocessor}{}           \textcolor{keywordflow}{if}(n1.eq.0.and.n2.eq.2.and.n3.eq.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{8202              \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy 0 2f'},r,i,zadj2(i)*f(n)*smod(m)/\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(a,b)}
\DoxyCodeLine{8203 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{8204 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8205 \textcolor{preprocessor}{}}
\DoxyCodeLine{8206 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8207 }
\DoxyCodeLine{8208           dexpgy(0,n1,n2,n3,0) = daux/\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(a,b)}
\DoxyCodeLine{8209 }
\DoxyCodeLine{8210 \textcolor{preprocessor}{\#ifdef Dgytest}}
\DoxyCodeLine{8211 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(n1.eq.1.and.n2.eq.1.and.n3.eq.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{8212             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy D\_0'},r,dexpgy(0,n1,n2,n3,0) }
\DoxyCodeLine{8213 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{8214 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8215 \textcolor{preprocessor}{}}
\DoxyCodeLine{8216           maxdexpgy(0,r,0) =  maxdexpgy(0,r,0) + abs(dexpgy(0,n1,n2,n3,0))}
\DoxyCodeLine{8217           \textcolor{keywordflow}{if} (r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8218             d(0,n1,n2,n3) = dexpgy(0,n1,n2,n3,0)}
\DoxyCodeLine{8219 \textcolor{comment}{!            Derr(r) =  abs(maxZadjf/maxXadj*Dexpgy(0,n1,n2,n3,0))}}
\DoxyCodeLine{8220 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{8221       }
\DoxyCodeLine{8222 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8223 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{8224 }
\DoxyCodeLine{8225       \textcolor{keywordflow}{if} (r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8226 \textcolor{comment}{!       Derr(r) =  abs(maxZadjf/Xadj(a,b))*maxDexpgy(0,r,0)}}
\DoxyCodeLine{8227         derr(r) =  \mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}}*maxdexpgy(0,r,0)}
\DoxyCodeLine{8228 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{8229 }
\DoxyCodeLine{8230       \textcolor{comment}{! error propagation from C's}}
\DoxyCodeLine{8231       d00\_err(r+2) = cij\_err(r+1)/2d0 }
\DoxyCodeLine{8232       dij\_err(r)=max(\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}*max(2*(r+1)*d00\_err(r+2),cerr\_i(r,0)), \&}
\DoxyCodeLine{8233                  maxzadj2f/\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}*max(2*d00\_err(r+1),cij\_err(r)))}
\DoxyCodeLine{8234 }
\DoxyCodeLine{8235       d00\_err2(r+2) = cij\_err2(r+1)/2d0 }
\DoxyCodeLine{8236       dij\_err2(r)=max(\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}*max(2*(r+1)*d00\_err2(r+2),cerr2\_i(r,0)), \&}
\DoxyCodeLine{8237                  maxzadj2f/\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}*max(2*d00\_err2(r+1),cij\_err2(r)))}
\DoxyCodeLine{8238       }
\DoxyCodeLine{8239       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{8240       \textcolor{comment}{! higher order coefficients}}
\DoxyCodeLine{8241       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{8242 }
\DoxyCodeLine{8243       rg = r}
\DoxyCodeLine{8244       gloop: \textcolor{keywordflow}{do} g=1,min(gtrunc,r/2)}
\DoxyCodeLine{8245         rg = rg-\/2}
\DoxyCodeLine{8246 }
\DoxyCodeLine{8247         \textcolor{comment}{! calculating D\_00ijk.. exploiting eq. (5.49)}}
\DoxyCodeLine{8248         maxdexpgy(1,rg,g) = 0d0}
\DoxyCodeLine{8249         \textcolor{keywordflow}{do} nl=rg,0,-\/1}
\DoxyCodeLine{8250           \textcolor{keywordflow}{do} nlt=rg-\/nl,0,-\/1}
\DoxyCodeLine{8251             nltt = rg-\/nl-\/nlt}
\DoxyCodeLine{8252             inds0(l) = nl}
\DoxyCodeLine{8253             inds0(lt) = nlt}
\DoxyCodeLine{8254             inds0(ltt) = nltt}
\DoxyCodeLine{8255 }
\DoxyCodeLine{8256             inds = inds0}
\DoxyCodeLine{8257             inds(l) = inds(l)+1}
\DoxyCodeLine{8258             daux = -\/\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(k)*dexpgy(0,inds(1),inds(2),inds(3),g-\/1)}
\DoxyCodeLine{8259 }
\DoxyCodeLine{8260             inds(k) = inds(k)+1}
\DoxyCodeLine{8261             daux = daux -\/ \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*dexpgy(0,inds(1),inds(2),inds(3),g-\/1)}
\DoxyCodeLine{8262 }
\DoxyCodeLine{8263             \textcolor{keywordflow}{if} (nlt.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8264               inds(l) = nl+1}
\DoxyCodeLine{8265               inds(lt) = nlt-\/1}
\DoxyCodeLine{8266               inds(ltt) = nltt}
\DoxyCodeLine{8267               daux = daux -\/ 2*nlt*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,lt)*dexpgy(1,inds(1),inds(2),inds(3),g)}
\DoxyCodeLine{8268 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{8269             \textcolor{keywordflow}{if} (nltt.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8270               inds(l) = nl+1}
\DoxyCodeLine{8271               inds(lt) = nlt}
\DoxyCodeLine{8272               inds(ltt) = nltt-\/1}
\DoxyCodeLine{8273               daux = daux -\/ 2*nltt*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,ltt)*dexpgy(1,inds(1),inds(2),inds(3),g)}
\DoxyCodeLine{8274 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{8275 }
\DoxyCodeLine{8276             dexpgy(1,inds0(1),inds0(2),inds0(3),g) = daux/(2*(nl+1)*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l))}
\DoxyCodeLine{8277 }
\DoxyCodeLine{8278             maxdexpgy(1,rg,g) =  maxdexpgy(1,rg,g) + abs(dexpgy(1,inds0(1),inds0(2),inds0(3),g) )}
\DoxyCodeLine{8279 \textcolor{comment}{!            if (rg+2.le.rmax) then}}
\DoxyCodeLine{8280 \textcolor{comment}{!              D(1,inds0(1),inds0(2),inds0(3)) = D(1,inds0(1),inds0(2),inds0(3))  \&}}
\DoxyCodeLine{8281 \textcolor{comment}{!                                              + Dexpgy(1,inds0(1),inds0(2),inds0(3),g)}}
\DoxyCodeLine{8282 \textcolor{comment}{!            end if}}
\DoxyCodeLine{8283  }
\DoxyCodeLine{8284             }
\DoxyCodeLine{8285 \textcolor{comment}{!  10.08.2017  factor 1d1 added for g=1 since first terms can cancel for certain cases}}
\DoxyCodeLine{8286             \textcolor{keywordflow}{if} (g.eq.1.and.abs(dexpgy(1,inds0(1),inds0(2),inds0(3),g)).gt.   \&}
\DoxyCodeLine{8287                 1d1*truncfacexp*max(1/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}},maxdexpgy(1,rg,g-\/1)) .or. \&}
\DoxyCodeLine{8288                 g.ge.2.and.abs(dexpgy(1,inds0(1),inds0(2),inds0(3),g)).gt.   \&}
\DoxyCodeLine{8289                 truncfacexp*maxdexpgy(1,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8290 }
\DoxyCodeLine{8291 \textcolor{preprocessor}{\#ifdef Dgytest}}
\DoxyCodeLine{8292 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy exit gloop'},1,inds0(1),inds0(2),inds0(3),g, \&}
\DoxyCodeLine{8293                 abs(dexpgy(1,inds0(1),inds0(2),inds0(3),g)),abs(dexpgy(1,inds0(1),inds0(2),inds0(3),g-\/1)),maxdexpgy(1,rg,g-\/1)}
\DoxyCodeLine{8294 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8295 \textcolor{preprocessor}{}}
\DoxyCodeLine{8296                 gtrunc = g-\/1}
\DoxyCodeLine{8297                 \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{8298 \textcolor{comment}{!               gtrunc = g}}
\DoxyCodeLine{8299 \textcolor{comment}{!               cycle gloop               ! worsens results !?}}
\DoxyCodeLine{8300 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{8301        }
\DoxyCodeLine{8302 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8303 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8304 }
\DoxyCodeLine{8305 \textcolor{preprocessor}{\#ifndef PPEXP00}}
\DoxyCodeLine{8306 \textcolor{preprocessor}{}\textcolor{comment}{!          if (rg+2.le.rmax) then        ! for fixed rank}}
\DoxyCodeLine{8307         \textcolor{keywordflow}{if} (rg+1.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8308           \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{8309             \textcolor{keywordflow}{do} n2=0,rg-\/n1}
\DoxyCodeLine{8310               n3=rg-\/n1-\/n2}
\DoxyCodeLine{8311               d(1,n1,n2,n3) = d(1,n1,n2,n3) + dexpgy(1,n1,n2,n3,g)}
\DoxyCodeLine{8312 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{8313 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8314 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{8315 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8316 \textcolor{preprocessor}{}}
\DoxyCodeLine{8317         \textcolor{comment}{! calculate D\_ijkl.. exploiting eq. (5.53)}}
\DoxyCodeLine{8318         maxdexpgy(0,rg,g) = 0d0}
\DoxyCodeLine{8319         \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{8320           \textcolor{keywordflow}{do} n2=0,rg-\/n1}
\DoxyCodeLine{8321             n3 = rg-\/n1-\/n2}
\DoxyCodeLine{8322       }
\DoxyCodeLine{8323             inds(1) = n1}
\DoxyCodeLine{8324             inds(2) = n2}
\DoxyCodeLine{8325             inds(3) = n3}
\DoxyCodeLine{8326             inds(a) = inds(a)+1}
\DoxyCodeLine{8327             daux = 2*(1+rg)*dexpgy(1,n1,n2,n3,g)*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(a,b)  \&}
\DoxyCodeLine{8328                  -\/ \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(b)*dexpgy(0,inds(1),inds(2),inds(3),g-\/1)}
\DoxyCodeLine{8329 }
\DoxyCodeLine{8330             smod = 0d0}
\DoxyCodeLine{8331             \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8332               smod(1) = smod(1) -\/ 2d0*n1*dexpgy(1,n1-\/1,n2,n3,g)}
\DoxyCodeLine{8333 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{8334             \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8335               smod(2) = smod(2) -\/ 2d0*n2*dexpgy(1,n1,n2-\/1,n3,g)}
\DoxyCodeLine{8336 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{8337             \textcolor{keywordflow}{if} (n3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8338               smod(3) = smod(3) -\/ 2d0*n3*dexpgy(1,n1,n2,n3-\/1,g)}
\DoxyCodeLine{8339 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{8340 }
\DoxyCodeLine{8341             \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{8342               n = inds2(1,i)}
\DoxyCodeLine{8343               m = inds2(2,i)}
\DoxyCodeLine{8344               daux = daux + zadj2(i)*f(n)*smod(m)}
\DoxyCodeLine{8345 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{8346 }
\DoxyCodeLine{8347             dexpgy(0,n1,n2,n3,g) = daux/\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(a,b)}
\DoxyCodeLine{8348 }
\DoxyCodeLine{8349             maxdexpgy(0,rg,g) =  maxdexpgy(0,rg,g) + abs(dexpgy(0,n1,n2,n3,g))}
\DoxyCodeLine{8350 }
\DoxyCodeLine{8351 \textcolor{comment}{!            if (rg.le.rmax) then}}
\DoxyCodeLine{8352 \textcolor{comment}{!              D(0,n1,n2,n3) = D(0,n1,n2,n3) + Dexpgy(0,n1,n2,n3,g)}}
\DoxyCodeLine{8353 \textcolor{comment}{!            end if}}
\DoxyCodeLine{8354 }
\DoxyCodeLine{8355             \textcolor{keywordflow}{if} (g.eq.1.and.abs(dexpgy(0,n1,n2,n3,g)).gt.               \&}
\DoxyCodeLine{8356                 truncfacexp*max(1/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}**2,maxdexpgy(0,rg,g-\/1)) .or. \&}
\DoxyCodeLine{8357                 g.ge.2.and.abs(dexpgy(0,n1,n2,n3,g)).gt.              \&}
\DoxyCodeLine{8358                 truncfacexp*maxdexpgy(0,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8359 }
\DoxyCodeLine{8360 \textcolor{preprocessor}{\#ifdef Dgytest}}
\DoxyCodeLine{8361 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy cycle loop'},n1,n2,n3,g,abs(dexpgy(0,n1,n2,n3,g)),abs(dexpgy(0,n1,n2,n3,g-\/1)),maxdexpgy(0,rg,g-\/1)}
\DoxyCodeLine{8362 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8363 \textcolor{preprocessor}{}}
\DoxyCodeLine{8364               gtrunc = g-\/1}
\DoxyCodeLine{8365               \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{8366 \textcolor{comment}{!             gtrunc = g}}
\DoxyCodeLine{8367 \textcolor{comment}{!             cycle gloop}}
\DoxyCodeLine{8368 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{8369 }
\DoxyCodeLine{8370 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8371 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8372 }
\DoxyCodeLine{8373         \textcolor{comment}{! error propagation from C's}}
\DoxyCodeLine{8374         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{8375           d00\_err(rg+2) = max(d00\_err(rg+2),                      \&}
\DoxyCodeLine{8376                               \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/2d0*dij\_err(rg+1),         \&}
\DoxyCodeLine{8377                               abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/2d0*dij\_err(rg+2))}
\DoxyCodeLine{8378 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{8379         dij\_err(rg)=max(dij\_err(rg),\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}*dij\_err(rg+1),     \&}
\DoxyCodeLine{8380                2*(rg+1)*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}*d00\_err(rg+2),                  \&}
\DoxyCodeLine{8381                2*maxzadj2f/\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}*d00\_err(rg+1))}
\DoxyCodeLine{8382 }
\DoxyCodeLine{8383         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{8384           d00\_err2(rg+2) = max(d00\_err2(rg+2),                      \&}
\DoxyCodeLine{8385                               \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/2d0*dij\_err2(rg+1),         \&}
\DoxyCodeLine{8386                               abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/2d0*dij\_err2(rg+2))}
\DoxyCodeLine{8387 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{8388         dij\_err2(rg)=max(dij\_err2(rg),\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}*dij\_err2(rg+1),     \&}
\DoxyCodeLine{8389                2*(rg+1)*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}*d00\_err2(rg+2),                  \&}
\DoxyCodeLine{8390                2*maxzadj2f/\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}*d00\_err2(rg+1))}
\DoxyCodeLine{8391 }
\DoxyCodeLine{8392 \textcolor{preprocessor}{\#ifdef PPEXP00}}
\DoxyCodeLine{8393 \textcolor{preprocessor}{}\textcolor{comment}{!          if (rg+2.le.rmax) then          !  for fixed rank}}
\DoxyCodeLine{8394         \textcolor{keywordflow}{if} (rg+2.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8395           \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{8396             \textcolor{keywordflow}{do} n2=0,rg-\/n1}
\DoxyCodeLine{8397               n3=rg-\/n1-\/n2}
\DoxyCodeLine{8398               d(1,n1,n2,n3) = d(1,n1,n2,n3) + dexpgy(1,n1,n2,n3,g)}
\DoxyCodeLine{8399 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{8400 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8401 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{8402 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8403 \textcolor{preprocessor}{}}
\DoxyCodeLine{8404         \textcolor{keywordflow}{if} ((rg.le.rmax)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8405           derr(rg) = 0d0}
\DoxyCodeLine{8406           \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{8407             \textcolor{keywordflow}{do} n2=0,rg-\/n1}
\DoxyCodeLine{8408               n3 = rg-\/n1-\/n2}
\DoxyCodeLine{8409               d(0,n1,n2,n3) = d(0,n1,n2,n3) + dexpgy(0,n1,n2,n3,g)}
\DoxyCodeLine{8410               \textcolor{keywordflow}{if}(abs(dexpgy(0,n1,n2,n3,g-\/1)).ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8411 \textcolor{comment}{!             Derr(rg)=max(Derr(rg),abs(Dexpgy(0,n1,n2,n3,g))**2/abs(Dexpgy(0,n1,n2,n3,g-\/1)))}}
\DoxyCodeLine{8412                 derr(rg)=max(derr(rg),abs(dexpgy(0,n1,n2,n3,g))*min(1d0,abs(dexpgy(0,n1,n2,n3,g))/abs(dexpgy(0,n1,n2,n3,g-\/1))))}
\DoxyCodeLine{8413               \textcolor{keywordflow}{else}}
\DoxyCodeLine{8414                 derr(rg)=max(derr(rg),abs(dexpgy(0,n1,n2,n3,g)))}
\DoxyCodeLine{8415 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{8416 }
\DoxyCodeLine{8417 \textcolor{preprocessor}{\#ifdef Dgytest}}
\DoxyCodeLine{8418 \textcolor{preprocessor}{}\textcolor{comment}{!              write(*,*) 'CalcDgy Derr calc',rg,Derr(rg),n1,n2,n3,g,abs(Dexpgy(0,n1,n2,n3,g)),abs(Dexpgy(0,n1,n2,n3,g-\/1))}}
\DoxyCodeLine{8419 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8420 \textcolor{preprocessor}{}}
\DoxyCodeLine{8421 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{8422 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8423 }
\DoxyCodeLine{8424           \textcolor{comment}{! if error from C's larger than error from expansion stop expansion}}
\DoxyCodeLine{8425           \textcolor{comment}{! allow for one more term, as each step involves only even or odd ranks}}
\DoxyCodeLine{8426 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{8427 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(dij\_err2(rg).gt.3d0*derr(rg)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8428 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{8429 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(dij\_err(rg).gt.3d0*derr(rg)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8430 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8431 \textcolor{preprocessor}{}            gtrunc = min(g,gtrunc)}
\DoxyCodeLine{8432 \textcolor{comment}{!           gtrunc = min(g+1,gtrunc)}}
\DoxyCodeLine{8433              }
\DoxyCodeLine{8434 \textcolor{preprocessor}{\#ifdef Dgytest}}
\DoxyCodeLine{8435 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy exit err'},rg,g,gtrunc}
\DoxyCodeLine{8436             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy exit err'},dij\_err(rg),derr(rg)}
\DoxyCodeLine{8437 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8438 \textcolor{preprocessor}{}\textcolor{keywordflow}{          end if}}
\DoxyCodeLine{8439 }
\DoxyCodeLine{8440 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{8441 }
\DoxyCodeLine{8442 \textcolor{keywordflow}{      end do} gloop}
\DoxyCodeLine{8443 }
\DoxyCodeLine{8444 \textcolor{preprocessor}{\#ifdef Dgytest}}
\DoxyCodeLine{8445 \textcolor{preprocessor}{}}
\DoxyCodeLine{8446       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy D(1,0,0,0)'},r,d(1,0,0,0)}
\DoxyCodeLine{8447       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy D(0,0,0,0)'},r,d(0,0,0,0)}
\DoxyCodeLine{8448       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy D(0,0,0,1)'},r,d(0,0,0,1)}
\DoxyCodeLine{8449       \textcolor{keywordflow}{if} (r.ge.2.and.rmax.ge.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8450       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy D(0,0,0,2)'},r,d(0,0,0,2)}
\DoxyCodeLine{8451 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{8452       \textcolor{keywordflow}{if} (r.ge.3.and.rmax.ge.3)\textcolor{keywordflow}{then}}
\DoxyCodeLine{8453       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy D(1,0,0,1)'},r,d(1,0,0,1)}
\DoxyCodeLine{8454       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy D(0,1,0,2)'},r,d(0,1,0,2)}
\DoxyCodeLine{8455       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy D(0,0,0,3)'},r,d(0,0,0,3)}
\DoxyCodeLine{8456       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy D(0,1,1,1)'},r,d(0,1,1,1)}
\DoxyCodeLine{8457       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy D(0,2,1,0)'},r,d(0,2,1,0)}
\DoxyCodeLine{8458 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{8459 }
\DoxyCodeLine{8460       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy Dij\_err'},r,dij\_err}
\DoxyCodeLine{8461       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy Dij\_acc'},r,dij\_err/abs(d(0,0,0,0))}
\DoxyCodeLine{8462 }
\DoxyCodeLine{8463       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy err'},r,g,derr}
\DoxyCodeLine{8464       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy acc'},r,g,derr/abs(d(0,0,0,0))}
\DoxyCodeLine{8465 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8466 \textcolor{preprocessor}{}}
\DoxyCodeLine{8467       derr2 = max(derr,dij\_err2(0:rmax))}
\DoxyCodeLine{8468       derr = max(derr,dij\_err(0:rmax))}
\DoxyCodeLine{8469 }
\DoxyCodeLine{8470 \textcolor{comment}{!     if(maxval(Derr).le.acc\_req\_D*abs(D(0,0,0,0))) exit     ! changed 28.01.15}}
\DoxyCodeLine{8471       \textcolor{comment}{! check if target precision already reached}}
\DoxyCodeLine{8472 \textcolor{preprocessor}{\#ifdef Cutrloop}}
\DoxyCodeLine{8473 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(derr-\/acc\_req\_d*abs(d(0,0,0,0))).le.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8474         \textcolor{keywordflow}{if} (r.lt.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8475           \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{8476             \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{8477               \textcolor{keywordflow}{do} n2=0,rg-\/n1}
\DoxyCodeLine{8478                 d(0,n1,n2,rg-\/n1-\/n2)=0d0}
\DoxyCodeLine{8479 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{8480 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{8481 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8482           \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{8483             \textcolor{keywordflow}{do} n1=0,rg-\/2}
\DoxyCodeLine{8484               \textcolor{keywordflow}{do} n2=0,rg-\/2-\/n1}
\DoxyCodeLine{8485                 d(1,n1,n2,rg-\/2-\/n1-\/n2)=0d0}
\DoxyCodeLine{8486 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{8487 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{8488 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8489           }
\DoxyCodeLine{8490 100       \textcolor{keyword}{format}(((a)))}
\DoxyCodeLine{8491 111       \textcolor{keyword}{format}(a22,2(\textcolor{stringliteral}{'('},g24.17,\textcolor{stringliteral}{','},g24.17,\textcolor{stringliteral}{') '}:))}
\DoxyCodeLine{8492           \textcolor{keyword}{call }seterrflag\_coli(-\/5)}
\DoxyCodeLine{8493           \textcolor{keyword}{call }errout\_coli(\textcolor{stringliteral}{'CalcDgy'},\textcolor{stringliteral}{' exit rloop for D'}, \&}
\DoxyCodeLine{8494           errorwriteflag)}
\DoxyCodeLine{8495           \textcolor{keywordflow}{if} (errorwriteflag) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8496             \textcolor{keyword}{write}(nerrout\_coli,100)\textcolor{stringliteral}{' CalcDgy:  exit rloop for D '}, \&}
\DoxyCodeLine{8497             \textcolor{stringliteral}{'    should not appear'}}
\DoxyCodeLine{8498             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgy: p10 = '},p10}
\DoxyCodeLine{8499             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgy: p21 = '},p21}
\DoxyCodeLine{8500             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgy: p32 = '},p32}
\DoxyCodeLine{8501             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgy: p30 = '},p30}
\DoxyCodeLine{8502             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgy: p20 = '},p20}
\DoxyCodeLine{8503             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgy: p31 = '},p31}
\DoxyCodeLine{8504             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgy: m02 = '},m02}
\DoxyCodeLine{8505             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgy: m12 = '},m12}
\DoxyCodeLine{8506             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgy: m22 = '},m22}
\DoxyCodeLine{8507             \textcolor{keyword}{write}(nerrout\_coli,111)\textcolor{stringliteral}{' CalcDgy: m32 = '},m32}
\DoxyCodeLine{8508 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{8509 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{8510  }
\DoxyCodeLine{8511 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{8512 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(derr-\/acc\_req\_d*abs(d(0,0,0,0))).le.0d0.and.r.ge.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8513 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8514 \textcolor{preprocessor}{}}
\DoxyCodeLine{8515         \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{8516 }
\DoxyCodeLine{8517 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{8518 }
\DoxyCodeLine{8519 \textcolor{keywordflow}{    end do} rloop}
\DoxyCodeLine{8520 }
\DoxyCodeLine{8521 }
\DoxyCodeLine{8522     \textcolor{comment}{! calculating D\_0000ijk.. exploiting eq. (5.49)}}
\DoxyCodeLine{8523 \textcolor{comment}{!    do r=4,rmax}}
\DoxyCodeLine{8524 \textcolor{comment}{!!      do n0=2,rmax/2            !   for fixed rank}}
\DoxyCodeLine{8525 \textcolor{comment}{!      do n0=2,rmax}}
\DoxyCodeLine{8526     \textcolor{keywordflow}{do} r=4,rmax+1                 \textcolor{comment}{!  includes rmax+1  24.01.16}}
\DoxyCodeLine{8527       \textcolor{keywordflow}{do} n0=2,max(rmax,r/2)       \textcolor{comment}{!  includes rmax+1  24.01.16}}
\DoxyCodeLine{8528         \textcolor{keywordflow}{do} nl=r-\/2*n0,0,-\/1}
\DoxyCodeLine{8529           \textcolor{keywordflow}{do} nlt=r-\/2*n0-\/nl,0,-\/1}
\DoxyCodeLine{8530             nltt = r-\/2*n0-\/nl-\/nlt}
\DoxyCodeLine{8531             inds0(l) = nl}
\DoxyCodeLine{8532             inds0(lt) = nlt}
\DoxyCodeLine{8533             inds0(ltt) = nltt}
\DoxyCodeLine{8534 }
\DoxyCodeLine{8535             inds(l) = nl+1}
\DoxyCodeLine{8536             inds(lt) = nlt}
\DoxyCodeLine{8537             inds(ltt) = nltt}
\DoxyCodeLine{8538             daux = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,1)*shat(n0-\/1,inds(1),inds(2),inds(3),1)  \&}
\DoxyCodeLine{8539                  + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,2)*shat(n0-\/1,inds(1),inds(2),inds(3),2)  \&}
\DoxyCodeLine{8540                  + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,3)*shat(n0-\/1,inds(1),inds(2),inds(3),3)  \&}
\DoxyCodeLine{8541                  -\/ \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(k)*d(n0-\/1,inds(1),inds(2),inds(3))}
\DoxyCodeLine{8542 }
\DoxyCodeLine{8543             inds(k) = inds(k)+1}
\DoxyCodeLine{8544             daux = daux -\/ \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*d(n0-\/1,inds(1),inds(2),inds(3))}
\DoxyCodeLine{8545             inds(k) = inds(k)-\/1}
\DoxyCodeLine{8546 }
\DoxyCodeLine{8547             \textcolor{keywordflow}{if} (nlt.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8548               inds(lt) = nlt-\/1}
\DoxyCodeLine{8549               daux = daux -\/ 2*nlt*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,lt)*d(n0,inds(1),inds(2),inds(3))}
\DoxyCodeLine{8550 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{8551             \textcolor{keywordflow}{if} (nltt.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8552               inds(lt) = nlt}
\DoxyCodeLine{8553               inds(ltt) = nltt-\/1}
\DoxyCodeLine{8554               daux = daux -\/ 2*nltt*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,ltt)*d(n0,inds(1),inds(2),inds(3))}
\DoxyCodeLine{8555 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{8556 }
\DoxyCodeLine{8557             d(n0,inds0(1),inds0(2),inds0(3)) = daux/(2*(nl+1)*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l))}
\DoxyCodeLine{8558 }
\DoxyCodeLine{8559 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8560 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8561 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{8562 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{8563 }
\DoxyCodeLine{8564     \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2+N3=r, n0=1 only!!!!!! }}
\DoxyCodeLine{8565     \textcolor{comment}{! already calculated for rmax+1 with extension of 24.01.16 above}}
\DoxyCodeLine{8566 \textcolor{comment}{!    do r=rmax+1,2*rmax}}
\DoxyCodeLine{8567 \textcolor{preprocessor}{\#ifdef notneeded}}
\DoxyCodeLine{8568 \textcolor{preprocessor}{}    \textcolor{keywordflow}{do} r=rmax+1,rmax+1}
\DoxyCodeLine{8569       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{8570         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{8571           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{8572             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{8573 }
\DoxyCodeLine{8574             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy exp rmax+1'},r,n0,n1,n2,n3, d(n0,n1,n2,n3)}
\DoxyCodeLine{8575 }
\DoxyCodeLine{8576             d(n0,n1,n2,n3) = (c\_0(n0-\/1,n1,n2,n3) + 2*mm02*d(n0-\/1,n1,n2,n3)  \&}
\DoxyCodeLine{8577                 + 4*duv(n0,n1,n2,n3)  \&}
\DoxyCodeLine{8578                 + f(1)*d(n0-\/1,n1+1,n2,n3) + f(2)*d(n0-\/1,n1,n2+1,n3)  \&}
\DoxyCodeLine{8579                 + f(3)*d(n0-\/1,n1,n2,n3+1)) / (2*(r-\/1)) }
\DoxyCodeLine{8580 }
\DoxyCodeLine{8581             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy dir rmax+1'},r,n0,n1,n2,n3, d(n0,n1,n2,n3)}
\DoxyCodeLine{8582 }
\DoxyCodeLine{8583 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8584 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8585 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{8586 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{8587 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8588 \textcolor{preprocessor}{}}
\DoxyCodeLine{8589 \textcolor{preprocessor}{\#ifdef Dgytest}}
\DoxyCodeLine{8590 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(rmax.ge.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8591       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy D(1,0,0,0) fin'},d(1,0,0,0)}
\DoxyCodeLine{8592       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy D(0,0,2,0) fin'},d(0,0,2,0)}
\DoxyCodeLine{8593       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy D(0,0,0,2) fin'},d(0,0,0,2)}
\DoxyCodeLine{8594       \textcolor{keywordflow}{if}(rmax.ge.3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8595       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy D(1,0,1,0) fin'},d(1,0,1,0)}
\DoxyCodeLine{8596       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy D(0,1,1,1) fin'},d(0,1,1,1)}
\DoxyCodeLine{8597       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy D(0,0,3,0) fin'},d(0,0,3,0)}
\DoxyCodeLine{8598 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{8599 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{8600 }
\DoxyCodeLine{8601     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy final err'},derr}
\DoxyCodeLine{8602     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgy final acc'},derr/abs(d(0,0,0,0))}
\DoxyCodeLine{8603 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8604 \textcolor{preprocessor}{}}
\DoxyCodeLine{8605 \textcolor{comment}{!    write(*,*) 'CalcDgy Derr ',Derr}}
\DoxyCodeLine{8606 \textcolor{comment}{!    write(*,*) 'CalcDgy Derr2',Derr2}}
\DoxyCodeLine{8607 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiond_a07eb55c56430b6a041f61292554c47ad}\label{namespacereductiond_a07eb55c56430b6a041f61292554c47ad}} 
\index{reductiond@{reductiond}!calcdpv@{calcdpv}}
\index{calcdpv@{calcdpv}!reductiond@{reductiond}}
\doxysubsubsection{\texorpdfstring{calcdpv()}{calcdpv()}}
{\footnotesize\ttfamily subroutine reductiond\+::calcdpv (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{D,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Duv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr2 }\end{DoxyParamCaption})}



Definition at line 3532 of file reduction\+D.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{3532   }
\DoxyCodeLine{3533     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobald}{globald}}}
\DoxyCodeLine{3534 }
\DoxyCodeLine{3535     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,id}
\DoxyCodeLine{3536     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p30,p20,p31,m02,m12,m22,m32}
\DoxyCodeLine{3537     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: D(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3538     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Duv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3539     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}  :: Derr(0:rmax),Derr2(0:rmax)}
\DoxyCodeLine{3540     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_0(:,:,:,:), Cuv\_0(:,:,:,:)}
\DoxyCodeLine{3541     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_i(:,:,:,:), Cuv\_i(:,:,:,:)}
\DoxyCodeLine{3542     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: D\_alt(:,:,:,:)}
\DoxyCodeLine{3543     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: Cerr\_i(:,:),Cerr2\_i(:,:)}
\DoxyCodeLine{3544     \textcolor{keywordtype}{double complex} :: Smod(3)}
\DoxyCodeLine{3545     \textcolor{keywordtype}{double complex} :: D0\_coli, elimminf2\_coli}
\DoxyCodeLine{3546     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err(:),Dij\_err(:),Cij\_err(:)}
\DoxyCodeLine{3547     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err2(:),Dij\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{3548     \textcolor{keywordtype}{integer} :: rmaxC,r,n0,n1,n2,n3,nn0,nn1,nn2,nn3,i,j}
\DoxyCodeLine{3549     \textcolor{keywordtype}{integer} :: bin,k,nid(0:3)}
\DoxyCodeLine{3550 }
\DoxyCodeLine{3551 \textcolor{comment}{!    if (id.eq.0) write(*,*) 'CalcDpv in', rmax,id}}
\DoxyCodeLine{3552         }
\DoxyCodeLine{3553     \textcolor{comment}{! calculation of scalar coefficient}}
\DoxyCodeLine{3554     d(0,0,0,0) = d0\_coli(p10,p21,p32,p30,p20,p31,m02,m12,m22,m32)}
\DoxyCodeLine{3555     duv(0,0,0,0) = 0d0}
\DoxyCodeLine{3556 }
\DoxyCodeLine{3557     \textcolor{comment}{! accuracy estimate for D0 function}}
\DoxyCodeLine{3558     derr(0) = acc\_def\_d0*max( abs(d(0,0,0,0)), 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}) )}
\DoxyCodeLine{3559     derr2(0) = acc\_def\_d0*max( abs(d(0,0,0,0)), 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}) )}
\DoxyCodeLine{3560 }
\DoxyCodeLine{3561     \textcolor{keywordflow}{if} (rmax.eq.0) \textcolor{keywordflow}{return}}
\DoxyCodeLine{3562 }
\DoxyCodeLine{3563     \textcolor{comment}{! allocation of C functions}}
\DoxyCodeLine{3564     rmaxc = rmax-\/1}
\DoxyCodeLine{3565     \textcolor{comment}{! rmaxC = max(rmax-\/1,0)}}
\DoxyCodeLine{3566     \textcolor{keyword}{allocate}(c\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{3567     \textcolor{keyword}{allocate}(cuv\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{3568     \textcolor{keyword}{allocate}(c\_i(0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{3569     \textcolor{keyword}{allocate}(cuv\_i(0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{3570     \textcolor{keyword}{allocate}(cerr\_i(0:rmaxc,0:3))}
\DoxyCodeLine{3571     \textcolor{keyword}{allocate}(cerr2\_i(0:rmaxc,0:3))}
\DoxyCodeLine{3572 }
\DoxyCodeLine{3573     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{3574     \textcolor{keyword}{allocate}(d00\_err(0:rmax))}
\DoxyCodeLine{3575     \textcolor{keyword}{allocate}(dij\_err(0:rmax))}
\DoxyCodeLine{3576     \textcolor{keyword}{allocate}(cij\_err(0:rmaxc))}
\DoxyCodeLine{3577 }
\DoxyCodeLine{3578     \textcolor{keyword}{allocate}(d00\_err2(0:rmax))}
\DoxyCodeLine{3579     \textcolor{keyword}{allocate}(dij\_err2(0:rmax))}
\DoxyCodeLine{3580     \textcolor{keyword}{allocate}(cij\_err2(0:rmaxc))}
\DoxyCodeLine{3581     }
\DoxyCodeLine{3582     \textcolor{comment}{! determine binaries for C-\/coefficients}}
\DoxyCodeLine{3583     k=0}
\DoxyCodeLine{3584     bin = 1}
\DoxyCodeLine{3585     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.3)}
\DoxyCodeLine{3586       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3587         nid(k) = id+bin}
\DoxyCodeLine{3588         k = k+1}
\DoxyCodeLine{3589 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3590       bin = 2*bin}
\DoxyCodeLine{3591 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3592 }
\DoxyCodeLine{3593 }
\DoxyCodeLine{3594     \textcolor{keyword}{call }calcc(c\_0(:,0,:,:),cuv\_0(:,0,:,:),p21,p32,p31,m12,m22,m32,rmaxc,nid(0),cerr\_i(:,0),cerr2\_i(:,0))}
\DoxyCodeLine{3595     \textcolor{keyword}{call }calcc(c\_i(:,:,:,1),cuv\_i(:,:,:,1),p20,p32,p30,m02,m22,m32,rmaxc,nid(1),cerr\_i(:,1),cerr2\_i(:,1))}
\DoxyCodeLine{3596     \textcolor{keyword}{call }calcc(c\_i(:,:,:,2),cuv\_i(:,:,:,2),p10,p31,p30,m02,m12,m32,rmaxc,nid(2),cerr\_i(:,2),cerr2\_i(:,2))}
\DoxyCodeLine{3597     \textcolor{keyword}{call }calcc(c\_i(:,:,:,3),cuv\_i(:,:,:,3),p10,p21,p20,m02,m12,m22,rmaxc,nid(3),cerr\_i(:,3),cerr2\_i(:,3))}
\DoxyCodeLine{3598 }
\DoxyCodeLine{3599 \textcolor{preprocessor}{\#ifdef Dpvtest}}
\DoxyCodeLine{3600 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv Cerr\_i='},cerr\_i(:,0)}
\DoxyCodeLine{3601     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv Cerr\_i='},cerr\_i(:,1)}
\DoxyCodeLine{3602     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv Cerr\_i='},cerr\_i(:,2)}
\DoxyCodeLine{3603     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv Cerr\_i='},cerr\_i(:,3)}
\DoxyCodeLine{3604 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3605 \textcolor{preprocessor}{}}
\DoxyCodeLine{3606     \textcolor{comment}{! shift of integration momentum in C\(\backslash\)\{0\}}}
\DoxyCodeLine{3607     \textcolor{keywordflow}{do} n1=1,rmaxc}
\DoxyCodeLine{3608       \textcolor{keywordflow}{do} n2=0,rmaxc-\/n1}
\DoxyCodeLine{3609         \textcolor{keywordflow}{do} n3=0,rmaxc-\/n1-\/n2}
\DoxyCodeLine{3610           n0 = (rmaxc-\/n1-\/n2-\/n3)}
\DoxyCodeLine{3611           c\_0(0:n0,n1,n2,n3) = -\/c\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{3612                             -\/c\_0(0:n0,n1-\/1,n2+1,n3)-\/c\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{3613           cuv\_0(0:n0,n1,n2,n3) = -\/cuv\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{3614                               -\/cuv\_0(0:n0,n1-\/1,n2+1,n3)-\/cuv\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{3615 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3616 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3617 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3618 }
\DoxyCodeLine{3619     }
\DoxyCodeLine{3620     \textcolor{comment}{! determine inverse Gram matrix}}
\DoxyCodeLine{3621 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{3622 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{3623 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{3624 \textcolor{comment}{!    mm32 = elimminf2\_coli(m32)}}
\DoxyCodeLine{3625 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{3626 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{3627 \textcolor{comment}{!    q32  = elimminf2\_coli(p32)}}
\DoxyCodeLine{3628 \textcolor{comment}{!    q30  = elimminf2\_coli(p30)}}
\DoxyCodeLine{3629 \textcolor{comment}{!    q31  = elimminf2\_coli(p31)}}
\DoxyCodeLine{3630 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{3631  }
\DoxyCodeLine{3632 }
\DoxyCodeLine{3633 \textcolor{comment}{!    q1q2 = (q10+q20-\/q21)}}
\DoxyCodeLine{3634 \textcolor{comment}{!    q1q3 = (q10+q30-\/q31)}}
\DoxyCodeLine{3635 \textcolor{comment}{!    q2q3 = (q20+q30-\/q32)}}
\DoxyCodeLine{3636 \textcolor{comment}{!    detZ = 8d0*q10*q30*q20+2D0*q1q2*q1q3*q2q3  \&}}
\DoxyCodeLine{3637 \textcolor{comment}{!     \&    -\/2d0*(q10*q2q3*q2q3+q20*q1q3*q1q3+q30*q1q2*q1q2)}}
\DoxyCodeLine{3638 }
\DoxyCodeLine{3639 \textcolor{comment}{!    Zinv(1,1) = (4d0*q30*q20-\/q2q3*q2q3)/detZ}}
\DoxyCodeLine{3640 \textcolor{comment}{!    Zinv(2,1) = (q1q3*q2q3-\/2d0*q30*q1q2)/detZ}}
\DoxyCodeLine{3641 \textcolor{comment}{!    Zinv(3,1) = (q1q2*q2q3-\/2d0*q20*q1q3)/detZ}}
\DoxyCodeLine{3642 \textcolor{comment}{!    Zinv(1,2) = Zinv(2,1)}}
\DoxyCodeLine{3643 \textcolor{comment}{!    Zinv(2,2) = (4d0*q10*q30-\/q1q3*q1q3)/detZ}}
\DoxyCodeLine{3644 \textcolor{comment}{!    Zinv(3,2) = (q1q2*q1q3-\/2d0*q10*q2q3)/detZ}}
\DoxyCodeLine{3645 \textcolor{comment}{!    Zinv(1,3) = Zinv(3,1)}}
\DoxyCodeLine{3646 \textcolor{comment}{!    Zinv(2,3) = Zinv(3,2)}}
\DoxyCodeLine{3647 \textcolor{comment}{!    Zinv(3,3) = (4d0*q10*q20-\/q1q2*q1q2)/detZ}}
\DoxyCodeLine{3648 \textcolor{comment}{!}}
\DoxyCodeLine{3649 \textcolor{comment}{!    f(1) = q10+mm02-\/mm12}}
\DoxyCodeLine{3650 \textcolor{comment}{!    f(2) = q20+mm02-\/mm22}}
\DoxyCodeLine{3651 \textcolor{comment}{!    f(3) = q30+mm02-\/mm32}}
\DoxyCodeLine{3652 }
\DoxyCodeLine{3653 \textcolor{comment}{!  commented out 2.9.17}}
\DoxyCodeLine{3654 \textcolor{comment}{!   Zinv = Zadj/detZ}}
\DoxyCodeLine{3655 }
\DoxyCodeLine{3656     \textcolor{comment}{! calculate Duv}}
\DoxyCodeLine{3657     \textcolor{keyword}{call }calcduv(duv,cuv\_0,mm02,f,rmax,id)}
\DoxyCodeLine{3658 }
\DoxyCodeLine{3659     \textcolor{comment}{! initialization of error propagation}}
\DoxyCodeLine{3660 \textcolor{comment}{!    Zadj=Zinv*detZ    }}
\DoxyCodeLine{3661 }
\DoxyCodeLine{3662 \textcolor{comment}{!    maxZadj = max(abs(Zadj(1,1)),abs(Zadj(2,1)),abs(Zadj(3,1)),  \&}}
\DoxyCodeLine{3663 \textcolor{comment}{!                  abs(Zadj(2,2)),abs(Zadj(3,2)),abs(Zadj(3,3)))}}
\DoxyCodeLine{3664 }
\DoxyCodeLine{3665 \textcolor{comment}{!    Zadjf(1) = Zadj(1,1)*f(1)+Zadj(2,1)*f(2)+Zadj(3,1)*f(3)}}
\DoxyCodeLine{3666 \textcolor{comment}{!    Zadjf(2) = Zadj(1,2)*f(1)+Zadj(2,2)*f(2)+Zadj(3,2)*f(3)}}
\DoxyCodeLine{3667 \textcolor{comment}{!    Zadjf(3) = Zadj(1,3)*f(1)+Zadj(2,3)*f(2)+Zadj(3,3)*f(3)}}
\DoxyCodeLine{3668 \textcolor{comment}{!    maxZadjf = max(abs(Zadjf(1)),abs(Zadjf(2)),abs(Zadjf(3)))}}
\DoxyCodeLine{3669 \textcolor{comment}{!}}
\DoxyCodeLine{3670 \textcolor{comment}{!    aZadjff = abs(Zadjf(1)*f(1)+Zadjf(2)*f(2)+Zadjf(3)*f(3))}}
\DoxyCodeLine{3671 }
\DoxyCodeLine{3672 \textcolor{comment}{!    adetZ = abs(detZ)}}
\DoxyCodeLine{3673 \textcolor{comment}{!    adetX = abs(2d0*mm02*detZ-\/Zadjf(1)*f(1)-\/Zadjf(2)*f(2)-\/Zadjf(3)*f(3))}}
\DoxyCodeLine{3674 }
\DoxyCodeLine{3675     dij\_err =0d0}
\DoxyCodeLine{3676     d00\_err =0d0}
\DoxyCodeLine{3677     dij\_err(0) = derr(0)}
\DoxyCodeLine{3678     cij\_err = max(cerr\_i(:,0),cerr\_i(:,1),cerr\_i(:,2),cerr\_i(:,3))}
\DoxyCodeLine{3679     }
\DoxyCodeLine{3680     dij\_err2 =0d0}
\DoxyCodeLine{3681     d00\_err2 =0d0}
\DoxyCodeLine{3682     dij\_err2(0) = derr2(0)}
\DoxyCodeLine{3683     cij\_err2 = max(cerr2\_i(:,0),cerr2\_i(:,1),cerr2\_i(:,2),cerr2\_i(:,3))}
\DoxyCodeLine{3684     }
\DoxyCodeLine{3685 \textcolor{preprocessor}{\#ifdef Dpvtest}}
\DoxyCodeLine{3686 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv Cij\_err='},cij\_err}
\DoxyCodeLine{3687     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv Dij\_err(0)='},dij\_err(0)}
\DoxyCodeLine{3688 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3689 \textcolor{preprocessor}{}}
\DoxyCodeLine{3690     \textcolor{keyword}{allocate}(d\_alt(0:rmax,0:rmax,0:rmax,0:rmax))}
\DoxyCodeLine{3691 }
\DoxyCodeLine{3692     \textcolor{comment}{! PV reduction}}
\DoxyCodeLine{3693     \textcolor{keywordflow}{do} r=1,rmax}
\DoxyCodeLine{3694 }
\DoxyCodeLine{3695       \textcolor{keywordflow}{if} (mod(r,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3696         \textcolor{comment}{! reduction formula (5.10) for D(r/2,0,0,0)}}
\DoxyCodeLine{3697         n0 = r/2       }
\DoxyCodeLine{3698         d(n0,0,0,0) = (c\_0(n0-\/1,0,0,0) + 2*mm02*d(n0-\/1,0,0,0) + 4*duv(n0,0,0,0)  \&}
\DoxyCodeLine{3699                        + f(1)*d(n0-\/1,1,0,0) + f(2)*d(n0-\/1,0,1,0)  \&}
\DoxyCodeLine{3700                        + f(3)*d(n0-\/1,0,0,1)) / (2*(r-\/1)) }
\DoxyCodeLine{3701 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3702 }
\DoxyCodeLine{3703 }
\DoxyCodeLine{3704       \textcolor{keywordflow}{do} n0=(r-\/1)/2,0,-\/1}
\DoxyCodeLine{3705         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3706           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{3707             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{3708          }
\DoxyCodeLine{3709             \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3710               nn1 = n1-\/1}
\DoxyCodeLine{3711               nn2 = n2}
\DoxyCodeLine{3712               nn3 = n3}
\DoxyCodeLine{3713               j = 1}
\DoxyCodeLine{3714             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3715               nn1 = n1}
\DoxyCodeLine{3716               nn2 = n2-\/1}
\DoxyCodeLine{3717               nn3 = n3}
\DoxyCodeLine{3718               j = 2}
\DoxyCodeLine{3719             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3720               nn1 = n1}
\DoxyCodeLine{3721               nn2 = n2}
\DoxyCodeLine{3722               nn3 = n3-\/1}
\DoxyCodeLine{3723               j = 3}
\DoxyCodeLine{3724 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3725 }
\DoxyCodeLine{3726             \textcolor{keywordflow}{do} i=1,3}
\DoxyCodeLine{3727               smod(i) = -\/c\_0(n0,nn1,nn2,nn3)-\/f(i)*d(n0,nn1,nn2,nn3)}
\DoxyCodeLine{3728 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{3729           }
\DoxyCodeLine{3730             \textcolor{keywordflow}{if} (nn1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3731               smod(1) = smod(1) -\/ 2*nn1*d(n0+1,nn1-\/1,nn2,nn3)}
\DoxyCodeLine{3732             \textcolor{keywordflow}{else}            }
\DoxyCodeLine{3733               smod(1) = smod(1) + c\_i(n0,nn2,nn3,1)}
\DoxyCodeLine{3734 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3735 }
\DoxyCodeLine{3736             \textcolor{keywordflow}{if} (nn2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3737               smod(2) = smod(2) -\/ 2*nn2*d(n0+1,nn1,nn2-\/1,nn3)}
\DoxyCodeLine{3738             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3739               smod(2) = smod(2) + c\_i(n0,nn1,nn3,2)}
\DoxyCodeLine{3740 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3741 }
\DoxyCodeLine{3742             \textcolor{keywordflow}{if} (nn3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3743               smod(3) = smod(3) -\/ 2*nn3*d(n0+1,nn1,nn2,nn3-\/1)}
\DoxyCodeLine{3744             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3745               smod(3) = smod(3) + c\_i(n0,nn1,nn2,3)}
\DoxyCodeLine{3746 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3747           }
\DoxyCodeLine{3748             d(n0,n1,n2,n3) = \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(1,j)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(2,j)*smod(2)  \&}
\DoxyCodeLine{3749                            + \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(3,j)*smod(3)}
\DoxyCodeLine{3750 }
\DoxyCodeLine{3751 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{3752 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3753 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3754 }
\DoxyCodeLine{3755       \textcolor{comment}{! determine error from symmetry for n0=0 and n1>1, n2>1 }}
\DoxyCodeLine{3756       derr(r)=derr(r-\/1)}
\DoxyCodeLine{3757       derr2(r)=derr2(r-\/1)}
\DoxyCodeLine{3758       n0=0}
\DoxyCodeLine{3759       \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3760         \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{3761           n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{3762           \textcolor{keywordflow}{if} (n1.ge.1.and.n2+n3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3763          }
\DoxyCodeLine{3764             \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3765               nn1 = n1}
\DoxyCodeLine{3766               nn2 = n2-\/1}
\DoxyCodeLine{3767               nn3 = n3}
\DoxyCodeLine{3768               j = 2}
\DoxyCodeLine{3769             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3770               nn1 = n1}
\DoxyCodeLine{3771               nn2 = n2}
\DoxyCodeLine{3772               nn3 = n3-\/1}
\DoxyCodeLine{3773               j = 3}
\DoxyCodeLine{3774 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3775 }
\DoxyCodeLine{3776             \textcolor{keywordflow}{do} i=1,3}
\DoxyCodeLine{3777               smod(i) = -\/c\_0(n0,nn1,nn2,nn3)-\/f(i)*d(n0,nn1,nn2,nn3)}
\DoxyCodeLine{3778 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{3779           }
\DoxyCodeLine{3780             \textcolor{keywordflow}{if} (nn1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3781               smod(1) = smod(1) -\/ 2*nn1*d(n0+1,nn1-\/1,nn2,nn3)}
\DoxyCodeLine{3782             \textcolor{keywordflow}{else}            }
\DoxyCodeLine{3783               smod(1) = smod(1) + c\_i(n0,nn2,nn3,1)}
\DoxyCodeLine{3784 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3785 }
\DoxyCodeLine{3786             \textcolor{keywordflow}{if} (nn2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3787               smod(2) = smod(2) -\/ 2*nn2*d(n0+1,nn1,nn2-\/1,nn3)}
\DoxyCodeLine{3788             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3789               smod(2) = smod(2) + c\_i(n0,nn1,nn3,2)}
\DoxyCodeLine{3790 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3791 }
\DoxyCodeLine{3792             \textcolor{keywordflow}{if} (nn3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3793               smod(3) = smod(3) -\/ 2*nn3*d(n0+1,nn1,nn2,nn3-\/1)}
\DoxyCodeLine{3794             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3795               smod(3) = smod(3) + c\_i(n0,nn1,nn2,3)}
\DoxyCodeLine{3796 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3797           }
\DoxyCodeLine{3798             d\_alt(n0,n1,n2,n3) = \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(1,j)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(2,j)*smod(2)  \&}
\DoxyCodeLine{3799                            + \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(3,j)*smod(3)}
\DoxyCodeLine{3800  }
\DoxyCodeLine{3801             derr(r)=max(derr(r),abs(d(n0,n1,n2,n3)-\/d\_alt(n0,n1,n2,n3)))}
\DoxyCodeLine{3802             derr2(r)=max(derr2(r),abs(d(n0,n1,n2,n3)-\/d\_alt(n0,n1,n2,n3)))}
\DoxyCodeLine{3803 }
\DoxyCodeLine{3804 \textcolor{comment}{!            write(*,*) 'CalcDpv: errpr',r,Derr(r),abs(D(n0,n1,n2,n3)-\/D\_alt(n0,n1,n2,n3)), \&}}
\DoxyCodeLine{3805 \textcolor{comment}{!                        D(n0,n1,n2,n3),D\_alt(n0,n1,n2,n3),n0,n1,n2,n3}}
\DoxyCodeLine{3806 }
\DoxyCodeLine{3807 }
\DoxyCodeLine{3808 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3809 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3810 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3811 }
\DoxyCodeLine{3812       \textcolor{keywordflow}{if}(r.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{3813         d00\_err(r) = max(abs(m02)*dij\_err(r-\/2), cerr\_i(r-\/2,0),    \&}
\DoxyCodeLine{3814               \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*dij\_err(r-\/2),             \&}
\DoxyCodeLine{3815               \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*max(d00\_err(r-\/1),cij\_err(r-\/2)))}
\DoxyCodeLine{3816       \textcolor{keywordflow}{else}}
\DoxyCodeLine{3817         d00\_err(r) = 0d0}
\DoxyCodeLine{3818 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3819       dij\_err(r) = max(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err(r-\/1),   \&}
\DoxyCodeLine{3820               \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(d00\_err(r),cij\_err(r-\/1)))/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3821 }
\DoxyCodeLine{3822       \textcolor{keywordflow}{if}(r.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{3823         d00\_err2(r) = max(abs(m02)*dij\_err2(r-\/2), cerr2\_i(r-\/2,0),    \&}
\DoxyCodeLine{3824               \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*dij\_err2(r-\/2),             \&}
\DoxyCodeLine{3825               \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*max(d00\_err2(r-\/1),cij\_err2(r-\/2)))}
\DoxyCodeLine{3826       \textcolor{keywordflow}{else}}
\DoxyCodeLine{3827         d00\_err2(r) = 0d0}
\DoxyCodeLine{3828 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3829       dij\_err2(r) = max(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err2(r-\/1),   \&}
\DoxyCodeLine{3830               \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(d00\_err2(r),cij\_err2(r-\/1)))/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3831 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3832     }
\DoxyCodeLine{3833       \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2+N3=r, n0=1 only!!!!!! }}
\DoxyCodeLine{3834 \textcolor{comment}{!    do r=rmax+1,2*rmax}}
\DoxyCodeLine{3835     \textcolor{keywordflow}{do} r=rmax+1,rmax+1}
\DoxyCodeLine{3836       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{3837         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3838           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{3839             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{3840 }
\DoxyCodeLine{3841             d(n0,n1,n2,n3) = (c\_0(n0-\/1,n1,n2,n3) + 2*mm02*d(n0-\/1,n1,n2,n3)  \&}
\DoxyCodeLine{3842                 + 4*duv(n0,n1,n2,n3)  \&}
\DoxyCodeLine{3843                 + f(1)*d(n0-\/1,n1+1,n2,n3) + f(2)*d(n0-\/1,n1,n2+1,n3)  \&}
\DoxyCodeLine{3844                 + f(3)*d(n0-\/1,n1,n2,n3+1)) / (2*(r-\/1)) }
\DoxyCodeLine{3845 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{3846 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3847 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3848 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3849 }
\DoxyCodeLine{3850 \textcolor{preprocessor}{\#ifdef Dpvtest}}
\DoxyCodeLine{3851 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv Derrsym'},derr}
\DoxyCodeLine{3852     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv Daccsym'},derr/abs(d(0,0,0,0))}
\DoxyCodeLine{3853 }
\DoxyCodeLine{3854 \textcolor{comment}{!    write(*,*) 'Dij\_err\_jj',maxZadjf*Dij\_err/adetZ}}
\DoxyCodeLine{3855 \textcolor{comment}{!    write(*,*) 'Dij\_err\_00',maxZadj*D00\_err(1:rmax)/adetZ}}
\DoxyCodeLine{3856 \textcolor{comment}{!    write(*,*) 'Dij\_err\_cc',maxZadj*Cij\_err/adetZ}}
\DoxyCodeLine{3857  }
\DoxyCodeLine{3858     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv Dijerr'},dij\_err(1:rmax)}
\DoxyCodeLine{3859     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv Dijacc'},dij\_err(1:rmax)/abs(d(0,0,0,0))}
\DoxyCodeLine{3860 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3861 \textcolor{preprocessor}{}}
\DoxyCodeLine{3862     derr2 = max(derr2,dij\_err2(0:rmax))}
\DoxyCodeLine{3863     derr = max(derr,dij\_err(0:rmax))}
\DoxyCodeLine{3864 }
\DoxyCodeLine{3865 \textcolor{preprocessor}{\#ifdef Dpvtest}}
\DoxyCodeLine{3866 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv Derr'},derr}
\DoxyCodeLine{3867     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv Dacc'},derr/abs(d(0,0,0,0))}
\DoxyCodeLine{3868 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3869 \textcolor{preprocessor}{}}
\DoxyCodeLine{3870     \textcolor{keywordflow}{if} (id.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3871     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv Derr '},derr}
\DoxyCodeLine{3872     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv Derr2'},derr2}
\DoxyCodeLine{3873 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{3874     }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiond_add71cf2cbaa4f0ea03ae3b7b2dbccabf}\label{namespacereductiond_add71cf2cbaa4f0ea03ae3b7b2dbccabf}} 
\index{reductiond@{reductiond}!calcdpv1@{calcdpv1}}
\index{calcdpv1@{calcdpv1}!reductiond@{reductiond}}
\doxysubsubsection{\texorpdfstring{calcdpv1()}{calcdpv1()}}
{\footnotesize\ttfamily subroutine reductiond\+::calcdpv1 (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{D,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Duv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr2 }\end{DoxyParamCaption})}



Definition at line 2738 of file reduction\+D.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2738   }
\DoxyCodeLine{2739     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobald}{globald}}}
\DoxyCodeLine{2740 }
\DoxyCodeLine{2741     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,id}
\DoxyCodeLine{2742     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p30,p20,p31,m02,m12,m22,m32}
\DoxyCodeLine{2743     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: D(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2744     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Duv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2745     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Derr(0:rmax),Derr2(0:rmax)}
\DoxyCodeLine{2746     \textcolor{keywordtype}{double complex} :: C\_0(0:rmax-\/1,0:rmax-\/1,0:rmax-\/1,0:rmax-\/1), Cuv\_0(0:rmax-\/1,0:rmax-\/1,0:rmax-\/1,0:rmax-\/1)}
\DoxyCodeLine{2747     \textcolor{keywordtype}{double complex} :: C\_i(0:rmax-\/1,0:rmax-\/1,0:rmax-\/1,3), Cuv\_i(0:rmax-\/1,0:rmax-\/1,0:rmax-\/1,3)}
\DoxyCodeLine{2748     \textcolor{keywordtype}{double complex} :: D\_alt(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2749     \textcolor{keywordtype}{double precision} :: Cerr\_i(0:rmax-\/1,0:3),Cerr2\_i(0:rmax-\/1,0:3)}
\DoxyCodeLine{2750 \textcolor{comment}{!   double complex, allocatable :: C\_0(:,:,:,:), Cuv\_0(:,:,:,:)}}
\DoxyCodeLine{2751 \textcolor{comment}{!   double complex, allocatable :: C\_i(:,:,:,:), Cuv\_i(:,:,:,:)}}
\DoxyCodeLine{2752 \textcolor{comment}{!   double complex, allocatable :: D\_alt(:,:,:,:)}}
\DoxyCodeLine{2753 \textcolor{comment}{!   double precision, allocatable :: Cerr\_i(:,:),Cerr2\_i(:,:)}}
\DoxyCodeLine{2754     \textcolor{keywordtype}{double complex} :: Smod(3)}
\DoxyCodeLine{2755     \textcolor{keywordtype}{double complex} :: D0\_coli, elimminf2\_coli}
\DoxyCodeLine{2756  \textcolor{comment}{!  double precision, allocatable :: D00\_err(:),Dij\_err(:),Cij\_err(:)}}
\DoxyCodeLine{2757  \textcolor{comment}{!  double precision, allocatable :: D00\_err2(:),Dij\_err2(:),Cij\_err2(:)}}
\DoxyCodeLine{2758     \textcolor{keywordtype}{double precision} :: D00\_err(0:rmax),Dij\_err(0:rmax),Cij\_err(0:rmax-\/1)}
\DoxyCodeLine{2759     \textcolor{keywordtype}{double precision} :: D00\_err2(0:rmax),Dij\_err2(0:rmax),Cij\_err2(0:rmax-\/1)}
\DoxyCodeLine{2760     \textcolor{keywordtype}{integer} :: rmaxC,r,n0,n1,n2,n3,nn0,nn1,nn2,nn3,i,j}
\DoxyCodeLine{2761     \textcolor{keywordtype}{integer} :: bin,k,nid(0:3)}
\DoxyCodeLine{2762 }
\DoxyCodeLine{2763 \textcolor{comment}{!    if (id.eq.0) write(*,*) 'CalcDpv1 in', rmax, id}}
\DoxyCodeLine{2764         }
\DoxyCodeLine{2765     \textcolor{comment}{! calculation of scalar coefficient}}
\DoxyCodeLine{2766     d(0,0,0,0) = d0\_coli(p10,p21,p32,p30,p20,p31,m02,m12,m22,m32)}
\DoxyCodeLine{2767     duv(0,0,0,0) = 0d0}
\DoxyCodeLine{2768 }
\DoxyCodeLine{2769     \textcolor{comment}{! accuracy estimate for D0 function}}
\DoxyCodeLine{2770     derr(0) = acc\_def\_d0*max( abs(d(0,0,0,0)), 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}) )}
\DoxyCodeLine{2771     derr2(0) = acc\_def\_d0*max( abs(d(0,0,0,0)), 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}) )}
\DoxyCodeLine{2772 }
\DoxyCodeLine{2773     \textcolor{keywordflow}{if} (rmax.eq.0) \textcolor{keywordflow}{return}}
\DoxyCodeLine{2774 }
\DoxyCodeLine{2775     \textcolor{comment}{! allocation of C functions}}
\DoxyCodeLine{2776     rmaxc = rmax-\/1}
\DoxyCodeLine{2777     \textcolor{comment}{! rmaxC = max(rmax-\/1,0)}}
\DoxyCodeLine{2778 \textcolor{comment}{!   allocate(C\_0(0:rmaxC,0:rmaxC,0:rmaxC,0:rmaxC))}}
\DoxyCodeLine{2779 \textcolor{comment}{!   allocate(Cuv\_0(0:rmaxC,0:rmaxC,0:rmaxC,0:rmaxC))}}
\DoxyCodeLine{2780 \textcolor{comment}{!   allocate(C\_i(0:rmaxC,0:rmaxC,0:rmaxC,3))}}
\DoxyCodeLine{2781 \textcolor{comment}{!   allocate(Cuv\_i(0:rmaxC,0:rmaxC,0:rmaxC,3))}}
\DoxyCodeLine{2782 \textcolor{comment}{!   allocate(Cerr\_i(0:rmaxC,0:3))}}
\DoxyCodeLine{2783 \textcolor{comment}{!   allocate(Cerr2\_i(0:rmaxC,0:3))}}
\DoxyCodeLine{2784 }
\DoxyCodeLine{2785     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{2786 \textcolor{comment}{!   allocate(D00\_err(0:rmax))}}
\DoxyCodeLine{2787 \textcolor{comment}{!   allocate(Dij\_err(0:rmax))}}
\DoxyCodeLine{2788 \textcolor{comment}{!   allocate(Cij\_err(0:rmaxC))}}
\DoxyCodeLine{2789     }
\DoxyCodeLine{2790 \textcolor{comment}{!   allocate(D00\_err2(0:rmax))}}
\DoxyCodeLine{2791 \textcolor{comment}{!   allocate(Dij\_err2(0:rmax))}}
\DoxyCodeLine{2792 \textcolor{comment}{!   allocate(Cij\_err2(0:rmaxC))}}
\DoxyCodeLine{2793     }
\DoxyCodeLine{2794     \textcolor{comment}{! determine binaries for C-\/coefficients}}
\DoxyCodeLine{2795     k=0}
\DoxyCodeLine{2796     bin = 1}
\DoxyCodeLine{2797     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.3)}
\DoxyCodeLine{2798       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2799         nid(k) = id+bin}
\DoxyCodeLine{2800         k = k+1}
\DoxyCodeLine{2801 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{2802       bin = 2*bin}
\DoxyCodeLine{2803 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{2804 }
\DoxyCodeLine{2805 }
\DoxyCodeLine{2806     \textcolor{keyword}{call }calcc(c\_0(:,0,:,:),cuv\_0(:,0,:,:),p21,p32,p31,m12,m22,m32,rmaxc,nid(0),cerr\_i(:,0),cerr2\_i(:,0))}
\DoxyCodeLine{2807     \textcolor{keyword}{call }calcc(c\_i(:,:,:,1),cuv\_i(:,:,:,1),p20,p32,p30,m02,m22,m32,rmaxc,nid(1),cerr\_i(:,1),cerr2\_i(:,1))}
\DoxyCodeLine{2808     \textcolor{keyword}{call }calcc(c\_i(:,:,:,2),cuv\_i(:,:,:,2),p10,p31,p30,m02,m12,m32,rmaxc,nid(2),cerr\_i(:,2),cerr2\_i(:,2))}
\DoxyCodeLine{2809     \textcolor{keyword}{call }calcc(c\_i(:,:,:,3),cuv\_i(:,:,:,3),p10,p21,p20,m02,m12,m22,rmaxc,nid(3),cerr\_i(:,3),cerr2\_i(:,3))}
\DoxyCodeLine{2810 }
\DoxyCodeLine{2811 \textcolor{preprocessor}{\#ifdef Dpv1test}}
\DoxyCodeLine{2812 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Cerr\_i='},cerr\_i(:,0)}
\DoxyCodeLine{2813     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Cerr\_i='},cerr\_i(:,1)}
\DoxyCodeLine{2814     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Cerr\_i='},cerr\_i(:,2)}
\DoxyCodeLine{2815     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Cerr\_i='},cerr\_i(:,3)}
\DoxyCodeLine{2816 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2817 \textcolor{preprocessor}{}}
\DoxyCodeLine{2818     \textcolor{comment}{! shift of integration momentum in C\(\backslash\)\{0\}}}
\DoxyCodeLine{2819     \textcolor{keywordflow}{do} n1=1,rmaxc}
\DoxyCodeLine{2820       \textcolor{keywordflow}{do} n2=0,rmaxc-\/n1}
\DoxyCodeLine{2821         \textcolor{keywordflow}{do} n3=0,rmaxc-\/n1-\/n2}
\DoxyCodeLine{2822           n0 = (rmaxc-\/n1-\/n2-\/n3)}
\DoxyCodeLine{2823           c\_0(0:n0,n1,n2,n3) = -\/c\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{2824               -\/c\_0(0:n0,n1-\/1,n2+1,n3)-\/c\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{2825           cuv\_0(0:n0,n1,n2,n3) = -\/cuv\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{2826               -\/cuv\_0(0:n0,n1-\/1,n2+1,n3)-\/cuv\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{2827 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{2828 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{2829 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{2830 }
\DoxyCodeLine{2831 }
\DoxyCodeLine{2832     \textcolor{comment}{! calculate Duv}}
\DoxyCodeLine{2833     \textcolor{keyword}{call }calcduv(duv,cuv\_0,mm02,f,rmax,id)}
\DoxyCodeLine{2834 }
\DoxyCodeLine{2835     \textcolor{comment}{! initialization of error propagation}}
\DoxyCodeLine{2836 }
\DoxyCodeLine{2837     dij\_err =0d0}
\DoxyCodeLine{2838     d00\_err =0d0}
\DoxyCodeLine{2839     dij\_err(0) = derr(0)}
\DoxyCodeLine{2840     cij\_err = max(cerr\_i(:,0),cerr\_i(:,1),cerr\_i(:,2),cerr\_i(:,3))}
\DoxyCodeLine{2841     }
\DoxyCodeLine{2842     dij\_err2 =0d0}
\DoxyCodeLine{2843     d00\_err2 =0d0}
\DoxyCodeLine{2844     dij\_err2(0) = derr2(0)}
\DoxyCodeLine{2845     cij\_err2 = max(cerr2\_i(:,0),cerr2\_i(:,1),cerr2\_i(:,2),cerr2\_i(:,3))}
\DoxyCodeLine{2846     }
\DoxyCodeLine{2847 \textcolor{preprocessor}{\#ifdef Dpv1test}}
\DoxyCodeLine{2848 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Cij\_err='},cij\_err}
\DoxyCodeLine{2849     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Dij\_err(0)='},dij\_err(0)}
\DoxyCodeLine{2850     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 test :'}, \& }
\DoxyCodeLine{2851             (1d0 -\/ (\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)+\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)+\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(3))/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}), \&}
\DoxyCodeLine{2852             (\mbox{\hyperlink{namespaceglobalc_ae3a848253264b0b20c9d773d37bbbb44}{detzmzadjf}} + \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(1)*(mm12-\/mm02) + \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(2)*(\mbox{\hyperlink{namespaceglobalc_a7c2a517c5707c2e77eb16e183db3d259}{mm22}}-\/mm02) \&}
\DoxyCodeLine{2853             + \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(3)*(\mbox{\hyperlink{namespaceglobald_af80b3560169e0b08203ed5b1f43ddcc6}{mm32}}-\/mm02) ) /\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}}
\DoxyCodeLine{2854 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2855 \textcolor{preprocessor}{}}
\DoxyCodeLine{2856 \textcolor{comment}{!   allocate(D\_alt(0:rmax,0:rmax,0:rmax,0:rmax))}}
\DoxyCodeLine{2857 }
\DoxyCodeLine{2858     \textcolor{comment}{! PV reduction}}
\DoxyCodeLine{2859     \textcolor{keywordflow}{do} r=1,rmax}
\DoxyCodeLine{2860 }
\DoxyCodeLine{2861       \textcolor{keywordflow}{do} n0=r/2,1,-\/1}
\DoxyCodeLine{2862         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{2863           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{2864             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{2865 }
\DoxyCodeLine{2866     \textcolor{comment}{! reduction formula (5.10) with (5.11) inserted for n0 >= 1}}
\DoxyCodeLine{2867 }
\DoxyCodeLine{2868             d(n0,n1,n2,n3) = 4*duv(n0,n1,n2,n3) + \mbox{\hyperlink{namespaceglobalc_a8dc59fea129282fd82fda20025969b67}{detx}}/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*d(n0-\/1,n1,n2,n3) }
\DoxyCodeLine{2869 }
\DoxyCodeLine{2870             d(n0,n1,n2,n3) = d(n0,n1,n2,n3) \&}
\DoxyCodeLine{2871                 + (\mbox{\hyperlink{namespaceglobalc_ae3a848253264b0b20c9d773d37bbbb44}{detzmzadjf}} + \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(1)*(mm12-\/mm02) + \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(2)*(\mbox{\hyperlink{namespaceglobalc_a7c2a517c5707c2e77eb16e183db3d259}{mm22}}-\/mm02) \&}
\DoxyCodeLine{2872                     + \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(3)*(\mbox{\hyperlink{namespaceglobald_af80b3560169e0b08203ed5b1f43ddcc6}{mm32}}-\/mm02) ) /\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}} * c\_0(n0-\/1,n1,n2,n3)}
\DoxyCodeLine{2873 \textcolor{comment}{!               + (1d0 -\/ (Zadjf(1)+Zadjf(2)+Zadjf(3))/detZ)* C\_0(n0-\/1,n1,n2,n3)}}
\DoxyCodeLine{2874 }
\DoxyCodeLine{2875             \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2876               d(n0,n1,n2,n3) = d(n0,n1,n2,n3) \&}
\DoxyCodeLine{2877                   -\/ 2*n1*\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*d(n0,n1-\/1,n2,n3)}
\DoxyCodeLine{2878             \textcolor{keywordflow}{else}            }
\DoxyCodeLine{2879               d(n0,n1,n2,n3) = d(n0,n1,n2,n3) \&}
\DoxyCodeLine{2880                   + \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}* c\_i(n0-\/1,n2,n3,1)}
\DoxyCodeLine{2881 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{2882 }
\DoxyCodeLine{2883             \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2884               d(n0,n1,n2,n3) = d(n0,n1,n2,n3) \&}
\DoxyCodeLine{2885                   -\/ 2*n2*\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*d(n0,n1,n2-\/1,n3)}
\DoxyCodeLine{2886             \textcolor{keywordflow}{else}            }
\DoxyCodeLine{2887               d(n0,n1,n2,n3) = d(n0,n1,n2,n3) \&}
\DoxyCodeLine{2888                   + \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}} * c\_i(n0-\/1,n1,n3,2)}
\DoxyCodeLine{2889 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{2890 }
\DoxyCodeLine{2891             \textcolor{keywordflow}{if} (n3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2892               d(n0,n1,n2,n3) = d(n0,n1,n2,n3) \&}
\DoxyCodeLine{2893                   -\/ 2*n3*\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(3)/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*d(n0,n1,n2,n3-\/1)}
\DoxyCodeLine{2894             \textcolor{keywordflow}{else}            }
\DoxyCodeLine{2895               d(n0,n1,n2,n3) = d(n0,n1,n2,n3) \&}
\DoxyCodeLine{2896                   + \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(3)/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}} * c\_i(n0-\/1,n1,n2,3)}
\DoxyCodeLine{2897 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{2898 }
\DoxyCodeLine{2899             d(n0,n1,n2,n3) = d(n0,n1,n2,n3)  / (2*(r-\/1)) }
\DoxyCodeLine{2900 }
\DoxyCodeLine{2901 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{2902 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{2903 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{2904 }
\DoxyCodeLine{2905     \textcolor{comment}{! reduction formula (5.11) with (5.10) inserted for n0 = 0}}
\DoxyCodeLine{2906 \textcolor{comment}{!     do n0=(r-\/1)/2,0,-\/1}}
\DoxyCodeLine{2907       n0=0}
\DoxyCodeLine{2908         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{2909           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{2910             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{2911          }
\DoxyCodeLine{2912             \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2913               nn1 = n1-\/1}
\DoxyCodeLine{2914               nn2 = n2}
\DoxyCodeLine{2915               nn3 = n3}
\DoxyCodeLine{2916               j = 1}
\DoxyCodeLine{2917             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2918               nn1 = n1}
\DoxyCodeLine{2919               nn2 = n2-\/1}
\DoxyCodeLine{2920               nn3 = n3}
\DoxyCodeLine{2921               j = 2}
\DoxyCodeLine{2922             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2923               nn1 = n1}
\DoxyCodeLine{2924               nn2 = n2}
\DoxyCodeLine{2925               nn3 = n3-\/1}
\DoxyCodeLine{2926               j = 3}
\DoxyCodeLine{2927 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{2928 }
\DoxyCodeLine{2929 \textcolor{comment}{!            do i=1,3}}
\DoxyCodeLine{2930 \textcolor{comment}{!              Smod(i) = -\/C\_0(n0,nn1,nn2,nn3)}}
\DoxyCodeLine{2931 \textcolor{comment}{!            end do}}
\DoxyCodeLine{2932             smod = 0d0  }
\DoxyCodeLine{2933           }
\DoxyCodeLine{2934             \textcolor{keywordflow}{if} (nn1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2935               smod(1) = smod(1) -\/ 2*nn1*d(n0+1,nn1-\/1,nn2,nn3)}
\DoxyCodeLine{2936             \textcolor{keywordflow}{else}            }
\DoxyCodeLine{2937               smod(1) = smod(1) + c\_i(n0,nn2,nn3,1)}
\DoxyCodeLine{2938 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{2939 }
\DoxyCodeLine{2940             \textcolor{keywordflow}{if} (nn2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2941               smod(2) = smod(2) -\/ 2*nn2*d(n0+1,nn1,nn2-\/1,nn3)}
\DoxyCodeLine{2942             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2943               smod(2) = smod(2) + c\_i(n0,nn1,nn3,2)}
\DoxyCodeLine{2944 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{2945 }
\DoxyCodeLine{2946             \textcolor{keywordflow}{if} (nn3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2947               smod(3) = smod(3) -\/ 2*nn3*d(n0+1,nn1,nn2,nn3-\/1)}
\DoxyCodeLine{2948             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2949               smod(3) = smod(3) + c\_i(n0,nn1,nn2,3)}
\DoxyCodeLine{2950 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{2951           }
\DoxyCodeLine{2952             d(n0,n1,n2,n3) = (\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2)  \&}
\DoxyCodeLine{2953                            + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,j)*smod(3) \&}
\DoxyCodeLine{2954                            -\/ \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(j)*c\_0(n0,nn1,nn2,nn3) \&}
\DoxyCodeLine{2955                            -\/ \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j)*d(n0,nn1,nn2,nn3))/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}}
\DoxyCodeLine{2956 }
\DoxyCodeLine{2957 \textcolor{keywordflow}{         end do}}
\DoxyCodeLine{2958 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{2959 \textcolor{comment}{!     end do}}
\DoxyCodeLine{2960 }
\DoxyCodeLine{2961       \textcolor{comment}{! determine error from symmetry for n0=0 and n1>1, n2>1 }}
\DoxyCodeLine{2962       derr(r)=derr(r-\/1)}
\DoxyCodeLine{2963       derr2(r)=derr2(r-\/1)}
\DoxyCodeLine{2964 }
\DoxyCodeLine{2965 \textcolor{comment}{!      write(*,*) 'CalcDpv1: Derr(r)',r,Derr(r),Derr2(r)}}
\DoxyCodeLine{2966 }
\DoxyCodeLine{2967       n0=0}
\DoxyCodeLine{2968       \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{2969         \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{2970           n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{2971           \textcolor{keywordflow}{if} (n1.ge.1.and.n2+n3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2972          }
\DoxyCodeLine{2973             \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2974               nn1 = n1}
\DoxyCodeLine{2975               nn2 = n2-\/1}
\DoxyCodeLine{2976               nn3 = n3}
\DoxyCodeLine{2977               j = 2}
\DoxyCodeLine{2978             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2979               nn1 = n1}
\DoxyCodeLine{2980               nn2 = n2}
\DoxyCodeLine{2981               nn3 = n3-\/1}
\DoxyCodeLine{2982               j = 3}
\DoxyCodeLine{2983 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{2984 }
\DoxyCodeLine{2985 \textcolor{comment}{!            do i=1,3}}
\DoxyCodeLine{2986 \textcolor{comment}{!              Smod(i) = -\/C\_0(n0,nn1,nn2,nn3)}}
\DoxyCodeLine{2987 \textcolor{comment}{!            end do}}
\DoxyCodeLine{2988             smod = 0d0}
\DoxyCodeLine{2989              }
\DoxyCodeLine{2990             \textcolor{keywordflow}{if} (nn1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2991               smod(1) = smod(1) -\/ 2*nn1*d(n0+1,nn1-\/1,nn2,nn3)}
\DoxyCodeLine{2992             \textcolor{keywordflow}{else}            }
\DoxyCodeLine{2993               smod(1) = smod(1) + c\_i(n0,nn2,nn3,1)}
\DoxyCodeLine{2994 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{2995 }
\DoxyCodeLine{2996             \textcolor{keywordflow}{if} (nn2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2997               smod(2) = smod(2) -\/ 2*nn2*d(n0+1,nn1,nn2-\/1,nn3)}
\DoxyCodeLine{2998             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2999               smod(2) = smod(2) + c\_i(n0,nn1,nn3,2)}
\DoxyCodeLine{3000 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3001 }
\DoxyCodeLine{3002             \textcolor{keywordflow}{if} (nn3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3003               smod(3) = smod(3) -\/ 2*nn3*d(n0+1,nn1,nn2,nn3-\/1)}
\DoxyCodeLine{3004             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3005               smod(3) = smod(3) + c\_i(n0,nn1,nn2,3)}
\DoxyCodeLine{3006 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3007           }
\DoxyCodeLine{3008             d\_alt(n0,n1,n2,n3) = (\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2)  \&}
\DoxyCodeLine{3009                            + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,j)*smod(3) \&}
\DoxyCodeLine{3010                            -\/ \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(j)*c\_0(n0,nn1,nn2,nn3)  \&}
\DoxyCodeLine{3011                            -\/ \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j)*d(n0,nn1,nn2,nn3))/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}}
\DoxyCodeLine{3012  }
\DoxyCodeLine{3013             derr(r)=max(derr(r),abs(d(n0,n1,n2,n3)-\/d\_alt(n0,n1,n2,n3)))}
\DoxyCodeLine{3014             derr2(r)=max(derr2(r),abs(d(n0,n1,n2,n3)-\/d\_alt(n0,n1,n2,n3)))}
\DoxyCodeLine{3015 }
\DoxyCodeLine{3016 \textcolor{preprocessor}{\#ifdef Dpv1test}}
\DoxyCodeLine{3017 \textcolor{preprocessor}{}\textcolor{comment}{!            write(*,*) 'CalcDpv1: errpr',r,Derr(r),abs(D(n0,n1,n2,n3)-\/D\_alt(n0,n1,n2,n3)), \&}}
\DoxyCodeLine{3018 \textcolor{comment}{!                        D(n0,n1,n2,n3),D\_alt(n0,n1,n2,n3),n0,n1,n2,n3}}
\DoxyCodeLine{3019 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3020 \textcolor{preprocessor}{}}
\DoxyCodeLine{3021 }
\DoxyCodeLine{3022 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3023 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3024 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3025 }
\DoxyCodeLine{3026       \textcolor{keywordflow}{if}(r.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{3027 }
\DoxyCodeLine{3028 \textcolor{comment}{! estimate using insertions of (5.11) in (5.10)}}
\DoxyCodeLine{3029         d00\_err(r) = max(2*abs(m02)*dij\_err(r-\/2), cerr\_i(r-\/2,0),    \&}
\DoxyCodeLine{3030               \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*dij\_err(r-\/2),             \&}
\DoxyCodeLine{3031               \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*max(2*d00\_err(r-\/1),cij\_err(r-\/2)))/(2*(r-\/1))}
\DoxyCodeLine{3032       \textcolor{keywordflow}{else}}
\DoxyCodeLine{3033         d00\_err(r) = 0d0}
\DoxyCodeLine{3034 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3035       dij\_err(r) = max(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err(r-\/1),   \&}
\DoxyCodeLine{3036               \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(2*d00\_err(r),cij\_err(r-\/1)))/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3037 }
\DoxyCodeLine{3038       \textcolor{keywordflow}{if}(r.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{3039 \textcolor{comment}{! estimate using insertions of (5.11) in (5.10)}}
\DoxyCodeLine{3040         d00\_err2(r) = max(2*abs(m02)*dij\_err2(r-\/2), cerr2\_i(r-\/2,0),    \&}
\DoxyCodeLine{3041               \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*dij\_err2(r-\/2),             \&}
\DoxyCodeLine{3042               \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*max(2*d00\_err2(r-\/1),cij\_err2(r-\/2)))/(2*(r-\/1))}
\DoxyCodeLine{3043       \textcolor{keywordflow}{else}}
\DoxyCodeLine{3044         d00\_err2(r) = 0d0}
\DoxyCodeLine{3045 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3046       dij\_err2(r) = max(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err2(r-\/1),   \&}
\DoxyCodeLine{3047               \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(2*d00\_err2(r),cij\_err2(r-\/1)))/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3048 }
\DoxyCodeLine{3049 \textcolor{preprocessor}{\#ifdef Dpv1test}}
\DoxyCodeLine{3050 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err(r)'}, r,dij\_err(r),d00\_err(r)}
\DoxyCodeLine{3051     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err\_jj'},\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3052     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err\_00'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*d00\_err(1:rmax)/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3053     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err\_cc'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*cij\_err/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3054     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'factors'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}},\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3055     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err2(r)'}, r,dij\_err2(r),d00\_err2(r)}
\DoxyCodeLine{3056     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err2\_jj'},\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3057     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err2\_00'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*d00\_err(1:rmax)/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3058     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err2\_cc'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*cij\_err/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3059     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'factors2'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}),\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3060 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3061 \textcolor{preprocessor}{}}
\DoxyCodeLine{3062 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3063     }
\DoxyCodeLine{3064       \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2+N3=r, n0=1 only!!!!!! }}
\DoxyCodeLine{3065 \textcolor{comment}{!    do r=rmax+1,2*rmax}}
\DoxyCodeLine{3066     \textcolor{keywordflow}{do} r=rmax+1,rmax+1}
\DoxyCodeLine{3067       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{3068         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3069           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{3070             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{3071 }
\DoxyCodeLine{3072             d(n0,n1,n2,n3) = (c\_0(n0-\/1,n1,n2,n3) + 2*mm02*d(n0-\/1,n1,n2,n3)  \&}
\DoxyCodeLine{3073                 + 4*duv(n0,n1,n2,n3)  \&}
\DoxyCodeLine{3074                 + f(1)*d(n0-\/1,n1+1,n2,n3) + f(2)*d(n0-\/1,n1,n2+1,n3)  \&}
\DoxyCodeLine{3075                 + f(3)*d(n0-\/1,n1,n2,n3+1)) / (2*(r-\/1)) }
\DoxyCodeLine{3076 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{3077 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3078 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3079 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3080 }
\DoxyCodeLine{3081 \textcolor{preprocessor}{\#ifdef Dpv1test}}
\DoxyCodeLine{3082 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Derrsym'},derr}
\DoxyCodeLine{3083     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Daccsym'},derr/abs(d(0,0,0,0))}
\DoxyCodeLine{3084 }
\DoxyCodeLine{3085     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err\_jj'},\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3086     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err\_00'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*d00\_err(1:rmax)/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3087     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err\_cc'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*cij\_err/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3088     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Dijerr'},dij\_err(1:rmax)}
\DoxyCodeLine{3089     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Dijacc'},dij\_err(1:rmax)/abs(d(0,0,0,0))}
\DoxyCodeLine{3090  }
\DoxyCodeLine{3091     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Derr2sym'},derr2}
\DoxyCodeLine{3092     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Dacc2sym'},derr2/abs(d(0,0,0,0))}
\DoxyCodeLine{3093 }
\DoxyCodeLine{3094     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err2\_jj'},\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err2/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3095     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err2\_00'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*d00\_err2(1:rmax)/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3096     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err2\_cc'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*cij\_err2/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3097     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Dijerr2'},dij\_err2(1:rmax)}
\DoxyCodeLine{3098     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Dijacc2'},dij\_err2(1:rmax)/abs(d(0,0,0,0))}
\DoxyCodeLine{3099  }
\DoxyCodeLine{3100 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3101 \textcolor{preprocessor}{}}
\DoxyCodeLine{3102     derr2 = max(derr2,dij\_err2(0:rmax))}
\DoxyCodeLine{3103     derr = max(derr,dij\_err(0:rmax))}
\DoxyCodeLine{3104 }
\DoxyCodeLine{3105 \textcolor{preprocessor}{\#ifdef Dpv1test}}
\DoxyCodeLine{3106 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 D(0,0,0,0) = '},d(0,0,0,0)}
\DoxyCodeLine{3107     \textcolor{keywordflow}{if}(rmax.ge.3)\textcolor{keywordflow}{then}}
\DoxyCodeLine{3108       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 D(0,1,1,1) = '},d(0,1,1,1)}
\DoxyCodeLine{3109 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{3110 }
\DoxyCodeLine{3111     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Derr'},derr}
\DoxyCodeLine{3112     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Dacc'},derr/abs(d(0,0,0,0))}
\DoxyCodeLine{3113     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Derr2'},derr2}
\DoxyCodeLine{3114     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Dacc2'},derr2/abs(d(0,0,0,0))}
\DoxyCodeLine{3115 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3116 \textcolor{preprocessor}{}}
\DoxyCodeLine{3117 \textcolor{comment}{!    if (id.eq.0) then}}
\DoxyCodeLine{3118 \textcolor{comment}{!    write(*,*) 'CalcDpv1 Derr ',Derr}}
\DoxyCodeLine{3119 \textcolor{comment}{!    write(*,*) 'CalcDpv1 Derr2',Derr2}}
\DoxyCodeLine{3120 \textcolor{comment}{!    end if}}
\DoxyCodeLine{3121     }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiond_aff4786024c9f25ebd23e8912d6f5eb91}\label{namespacereductiond_aff4786024c9f25ebd23e8912d6f5eb91}} 
\index{reductiond@{reductiond}!calcdpv1o@{calcdpv1o}}
\index{calcdpv1o@{calcdpv1o}!reductiond@{reductiond}}
\doxysubsubsection{\texorpdfstring{calcdpv1o()}{calcdpv1o()}}
{\footnotesize\ttfamily subroutine reductiond\+::calcdpv1o (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{D,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Duv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr2 }\end{DoxyParamCaption})}



Definition at line 3131 of file reduction\+D.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{3131   }
\DoxyCodeLine{3132     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobald}{globald}}}
\DoxyCodeLine{3133 }
\DoxyCodeLine{3134     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,id}
\DoxyCodeLine{3135     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p30,p20,p31,m02,m12,m22,m32}
\DoxyCodeLine{3136     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: D(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3137     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Duv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3138     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Derr(0:rmax),Derr2(0:rmax)}
\DoxyCodeLine{3139     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_0(:,:,:,:), Cuv\_0(:,:,:,:)}
\DoxyCodeLine{3140     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_i(:,:,:,:), Cuv\_i(:,:,:,:)}
\DoxyCodeLine{3141     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: D\_alt(:,:,:,:)}
\DoxyCodeLine{3142     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: Cerr\_i(:,:),Cerr2\_i(:,:)}
\DoxyCodeLine{3143     \textcolor{keywordtype}{double complex} :: Smod(3)}
\DoxyCodeLine{3144     \textcolor{keywordtype}{double complex} :: D0\_coli, elimminf2\_coli}
\DoxyCodeLine{3145     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err(:),Dij\_err(:),Cij\_err(:)}
\DoxyCodeLine{3146     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err2(:),Dij\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{3147     \textcolor{keywordtype}{integer} :: rmaxC,r,n0,n1,n2,n3,nn0,nn1,nn2,nn3,i,j}
\DoxyCodeLine{3148     \textcolor{keywordtype}{integer} :: bin,k,nid(0:3)}
\DoxyCodeLine{3149 }
\DoxyCodeLine{3150 \textcolor{comment}{!    if (id.eq.0) write(*,*) 'CalcDpv1o in', rmax, id}}
\DoxyCodeLine{3151         }
\DoxyCodeLine{3152     \textcolor{comment}{! calculation of scalar coefficient}}
\DoxyCodeLine{3153     d(0,0,0,0) = d0\_coli(p10,p21,p32,p30,p20,p31,m02,m12,m22,m32)}
\DoxyCodeLine{3154     duv(0,0,0,0) = 0d0}
\DoxyCodeLine{3155 }
\DoxyCodeLine{3156     \textcolor{comment}{! accuracy estimate for D0 function}}
\DoxyCodeLine{3157     derr(0) = acc\_def\_d0*max( abs(d(0,0,0,0)), 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}) )}
\DoxyCodeLine{3158     derr2(0) = acc\_def\_d0*max( abs(d(0,0,0,0)), 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}) )}
\DoxyCodeLine{3159 }
\DoxyCodeLine{3160     \textcolor{keywordflow}{if} (rmax.eq.0) \textcolor{keywordflow}{return}}
\DoxyCodeLine{3161 }
\DoxyCodeLine{3162     \textcolor{comment}{! allocation of C functions}}
\DoxyCodeLine{3163     rmaxc = rmax-\/1}
\DoxyCodeLine{3164     \textcolor{comment}{! rmaxC = max(rmax-\/1,0)}}
\DoxyCodeLine{3165     \textcolor{keyword}{allocate}(c\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{3166     \textcolor{keyword}{allocate}(cuv\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{3167     \textcolor{keyword}{allocate}(c\_i(0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{3168     \textcolor{keyword}{allocate}(cuv\_i(0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{3169     \textcolor{keyword}{allocate}(cerr\_i(0:rmaxc,0:3))}
\DoxyCodeLine{3170     \textcolor{keyword}{allocate}(cerr2\_i(0:rmaxc,0:3))}
\DoxyCodeLine{3171 }
\DoxyCodeLine{3172     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{3173     \textcolor{keyword}{allocate}(d00\_err(0:rmax))}
\DoxyCodeLine{3174     \textcolor{keyword}{allocate}(dij\_err(0:rmax))}
\DoxyCodeLine{3175     \textcolor{keyword}{allocate}(cij\_err(0:rmaxc))}
\DoxyCodeLine{3176     }
\DoxyCodeLine{3177     \textcolor{keyword}{allocate}(d00\_err2(0:rmax))}
\DoxyCodeLine{3178     \textcolor{keyword}{allocate}(dij\_err2(0:rmax))}
\DoxyCodeLine{3179     \textcolor{keyword}{allocate}(cij\_err2(0:rmaxc))}
\DoxyCodeLine{3180     }
\DoxyCodeLine{3181     \textcolor{comment}{! determine binaries for C-\/coefficients}}
\DoxyCodeLine{3182     k=0}
\DoxyCodeLine{3183     bin = 1}
\DoxyCodeLine{3184     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.3)}
\DoxyCodeLine{3185       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3186         nid(k) = id+bin}
\DoxyCodeLine{3187         k = k+1}
\DoxyCodeLine{3188 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3189       bin = 2*bin}
\DoxyCodeLine{3190 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3191 }
\DoxyCodeLine{3192 }
\DoxyCodeLine{3193     \textcolor{keyword}{call }calcc(c\_0(:,0,:,:),cuv\_0(:,0,:,:),p21,p32,p31,m12,m22,m32,rmaxc,nid(0),cerr\_i(:,0),cerr2\_i(:,0))}
\DoxyCodeLine{3194     \textcolor{keyword}{call }calcc(c\_i(:,:,:,1),cuv\_i(:,:,:,1),p20,p32,p30,m02,m22,m32,rmaxc,nid(1),cerr\_i(:,1),cerr2\_i(:,1))}
\DoxyCodeLine{3195     \textcolor{keyword}{call }calcc(c\_i(:,:,:,2),cuv\_i(:,:,:,2),p10,p31,p30,m02,m12,m32,rmaxc,nid(2),cerr\_i(:,2),cerr2\_i(:,2))}
\DoxyCodeLine{3196     \textcolor{keyword}{call }calcc(c\_i(:,:,:,3),cuv\_i(:,:,:,3),p10,p21,p20,m02,m12,m22,rmaxc,nid(3),cerr\_i(:,3),cerr2\_i(:,3))}
\DoxyCodeLine{3197 }
\DoxyCodeLine{3198 \textcolor{preprocessor}{\#ifdef Dpv1otest}}
\DoxyCodeLine{3199 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Cerr\_i='},cerr\_i(:,0)}
\DoxyCodeLine{3200     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Cerr\_i='},cerr\_i(:,1)}
\DoxyCodeLine{3201     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Cerr\_i='},cerr\_i(:,2)}
\DoxyCodeLine{3202     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Cerr\_i='},cerr\_i(:,3)}
\DoxyCodeLine{3203 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3204 \textcolor{preprocessor}{}}
\DoxyCodeLine{3205     \textcolor{comment}{! shift of integration momentum in C\(\backslash\)\{0\}}}
\DoxyCodeLine{3206     \textcolor{keywordflow}{do} n1=1,rmaxc}
\DoxyCodeLine{3207       \textcolor{keywordflow}{do} n2=0,rmaxc-\/n1}
\DoxyCodeLine{3208         \textcolor{keywordflow}{do} n3=0,rmaxc-\/n1-\/n2}
\DoxyCodeLine{3209           n0 = (rmaxc-\/n1-\/n2-\/n3)}
\DoxyCodeLine{3210           c\_0(0:n0,n1,n2,n3) = -\/c\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{3211               -\/c\_0(0:n0,n1-\/1,n2+1,n3)-\/c\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{3212           cuv\_0(0:n0,n1,n2,n3) = -\/cuv\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{3213               -\/cuv\_0(0:n0,n1-\/1,n2+1,n3)-\/cuv\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{3214 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3215 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3216 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3217 }
\DoxyCodeLine{3218     }
\DoxyCodeLine{3219     \textcolor{comment}{! determine inverse Gram matrix}}
\DoxyCodeLine{3220 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{3221 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{3222 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{3223 \textcolor{comment}{!    mm32 = elimminf2\_coli(m32)}}
\DoxyCodeLine{3224 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{3225 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{3226 \textcolor{comment}{!    q32  = elimminf2\_coli(p32)}}
\DoxyCodeLine{3227 \textcolor{comment}{!    q30  = elimminf2\_coli(p30)}}
\DoxyCodeLine{3228 \textcolor{comment}{!    q31  = elimminf2\_coli(p31)}}
\DoxyCodeLine{3229 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{3230  }
\DoxyCodeLine{3231 }
\DoxyCodeLine{3232 \textcolor{comment}{!    q1q2 = (q10+q20-\/q21)}}
\DoxyCodeLine{3233 \textcolor{comment}{!    q1q3 = (q10+q30-\/q31)}}
\DoxyCodeLine{3234 \textcolor{comment}{!    q2q3 = (q20+q30-\/q32)}}
\DoxyCodeLine{3235 \textcolor{comment}{!    detZ = 8d0*q10*q30*q20+2D0*q1q2*q1q3*q2q3  \&}}
\DoxyCodeLine{3236 \textcolor{comment}{!     \&    -\/2d0*(q10*q2q3*q2q3+q20*q1q3*q1q3+q30*q1q2*q1q2)}}
\DoxyCodeLine{3237 }
\DoxyCodeLine{3238 \textcolor{comment}{!    Zinv(1,1) = (4d0*q30*q20-\/q2q3*q2q3)/detZ}}
\DoxyCodeLine{3239 \textcolor{comment}{!    Zinv(2,1) = (q1q3*q2q3-\/2d0*q30*q1q2)/detZ}}
\DoxyCodeLine{3240 \textcolor{comment}{!    Zinv(3,1) = (q1q2*q2q3-\/2d0*q20*q1q3)/detZ}}
\DoxyCodeLine{3241 \textcolor{comment}{!    Zinv(1,2) = Zinv(2,1)}}
\DoxyCodeLine{3242 \textcolor{comment}{!    Zinv(2,2) = (4d0*q10*q30-\/q1q3*q1q3)/detZ}}
\DoxyCodeLine{3243 \textcolor{comment}{!    Zinv(3,2) = (q1q2*q1q3-\/2d0*q10*q2q3)/detZ}}
\DoxyCodeLine{3244 \textcolor{comment}{!    Zinv(1,3) = Zinv(3,1)}}
\DoxyCodeLine{3245 \textcolor{comment}{!    Zinv(2,3) = Zinv(3,2)}}
\DoxyCodeLine{3246 \textcolor{comment}{!    Zinv(3,3) = (4d0*q10*q20-\/q1q2*q1q2)/detZ}}
\DoxyCodeLine{3247 \textcolor{comment}{!}}
\DoxyCodeLine{3248 \textcolor{comment}{!    f(1) = q10+mm02-\/mm12}}
\DoxyCodeLine{3249 \textcolor{comment}{!    f(2) = q20+mm02-\/mm22}}
\DoxyCodeLine{3250 \textcolor{comment}{!    f(3) = q30+mm02-\/mm32}}
\DoxyCodeLine{3251 }
\DoxyCodeLine{3252 \textcolor{comment}{!  commented out 2.9.17}}
\DoxyCodeLine{3253 \textcolor{comment}{!   Zinv = Zadj/detZ}}
\DoxyCodeLine{3254 }
\DoxyCodeLine{3255     \textcolor{comment}{! calculate Duv}}
\DoxyCodeLine{3256     \textcolor{keyword}{call }calcduv(duv,cuv\_0,mm02,f,rmax,id)}
\DoxyCodeLine{3257 }
\DoxyCodeLine{3258     \textcolor{comment}{! initialization of error propagation}}
\DoxyCodeLine{3259 \textcolor{comment}{!    Zadj=Zinv*detZ    }}
\DoxyCodeLine{3260 }
\DoxyCodeLine{3261 \textcolor{comment}{!    maxZadj = max(abs(Zadj(1,1)),abs(Zadj(2,1)),abs(Zadj(3,1)),  \&}}
\DoxyCodeLine{3262 \textcolor{comment}{!                  abs(Zadj(2,2)),abs(Zadj(3,2)),abs(Zadj(3,3)))}}
\DoxyCodeLine{3263 }
\DoxyCodeLine{3264 \textcolor{comment}{!    Zadjf(1) = Zadj(1,1)*f(1)+Zadj(2,1)*f(2)+Zadj(3,1)*f(3)}}
\DoxyCodeLine{3265 \textcolor{comment}{!    Zadjf(2) = Zadj(1,2)*f(1)+Zadj(2,2)*f(2)+Zadj(3,2)*f(3)}}
\DoxyCodeLine{3266 \textcolor{comment}{!    Zadjf(3) = Zadj(1,3)*f(1)+Zadj(2,3)*f(2)+Zadj(3,3)*f(3)}}
\DoxyCodeLine{3267 \textcolor{comment}{!    maxZadjf = max(abs(Zadjf(1)),abs(Zadjf(2)),abs(Zadjf(3)))}}
\DoxyCodeLine{3268 \textcolor{comment}{!}}
\DoxyCodeLine{3269 \textcolor{comment}{!    aZadjff = abs(Zadjf(1)*f(1)+Zadjf(2)*f(2)+Zadjf(3)*f(3))}}
\DoxyCodeLine{3270 }
\DoxyCodeLine{3271 \textcolor{comment}{!    adetZ = abs(detZ)}}
\DoxyCodeLine{3272 \textcolor{comment}{!    adetX = abs(2d0*mm02*detZ-\/Zadjf(1)*f(1)-\/Zadjf(2)*f(2)-\/Zadjf(3)*f(3))}}
\DoxyCodeLine{3273 }
\DoxyCodeLine{3274     dij\_err =0d0}
\DoxyCodeLine{3275     d00\_err =0d0}
\DoxyCodeLine{3276     dij\_err(0) = derr(0)}
\DoxyCodeLine{3277     cij\_err = max(cerr\_i(:,0),cerr\_i(:,1),cerr\_i(:,2),cerr\_i(:,3))}
\DoxyCodeLine{3278     }
\DoxyCodeLine{3279     dij\_err2 =0d0}
\DoxyCodeLine{3280     d00\_err2 =0d0}
\DoxyCodeLine{3281     dij\_err2(0) = derr2(0)}
\DoxyCodeLine{3282     cij\_err2 = max(cerr2\_i(:,0),cerr2\_i(:,1),cerr2\_i(:,2),cerr2\_i(:,3))}
\DoxyCodeLine{3283     }
\DoxyCodeLine{3284 \textcolor{preprocessor}{\#ifdef Dpv1otest}}
\DoxyCodeLine{3285 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Cij\_err='},cij\_err}
\DoxyCodeLine{3286     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Dij\_err(0)='},dij\_err(0)}
\DoxyCodeLine{3287 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3288 \textcolor{preprocessor}{}}
\DoxyCodeLine{3289     \textcolor{keyword}{allocate}(d\_alt(0:rmax,0:rmax,0:rmax,0:rmax))}
\DoxyCodeLine{3290 }
\DoxyCodeLine{3291     \textcolor{comment}{! PV reduction}}
\DoxyCodeLine{3292     \textcolor{keywordflow}{do} r=1,rmax}
\DoxyCodeLine{3293 }
\DoxyCodeLine{3294       \textcolor{keywordflow}{do} n0=r/2,1,-\/1}
\DoxyCodeLine{3295         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3296           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{3297             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{3298 }
\DoxyCodeLine{3299         \textcolor{comment}{! reduction formula (5.10) for D(r/2,0,0,0)}}
\DoxyCodeLine{3300             d(n0,n1,n2,n3) = (c\_0(n0-\/1,n1,n2,n3) + 2*mm02*d(n0-\/1,n1,n2,n3) + 4*duv(n0,n1,n2,n3)  \&}
\DoxyCodeLine{3301                 + f(1)*d(n0-\/1,n1+1,n2,n3) + f(2)*d(n0-\/1,n1,n2+1,n3)  \&}
\DoxyCodeLine{3302                 + f(3)*d(n0-\/1,n1,n2,n3+1)) / (2*(r-\/1)) }
\DoxyCodeLine{3303 }
\DoxyCodeLine{3304 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{3305 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3306 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3307 }
\DoxyCodeLine{3308 }
\DoxyCodeLine{3309 \textcolor{comment}{!     do n0=(r-\/1)/2,0,-\/1}}
\DoxyCodeLine{3310       n0=0}
\DoxyCodeLine{3311         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3312           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{3313             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{3314          }
\DoxyCodeLine{3315             \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3316               nn1 = n1-\/1}
\DoxyCodeLine{3317               nn2 = n2}
\DoxyCodeLine{3318               nn3 = n3}
\DoxyCodeLine{3319               j = 1}
\DoxyCodeLine{3320             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3321               nn1 = n1}
\DoxyCodeLine{3322               nn2 = n2-\/1}
\DoxyCodeLine{3323               nn3 = n3}
\DoxyCodeLine{3324               j = 2}
\DoxyCodeLine{3325             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3326               nn1 = n1}
\DoxyCodeLine{3327               nn2 = n2}
\DoxyCodeLine{3328               nn3 = n3-\/1}
\DoxyCodeLine{3329               j = 3}
\DoxyCodeLine{3330 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3331 }
\DoxyCodeLine{3332             \textcolor{keywordflow}{do} i=1,3}
\DoxyCodeLine{3333               smod(i) = -\/c\_0(n0,nn1,nn2,nn3)-\/f(i)*d(n0,nn1,nn2,nn3)}
\DoxyCodeLine{3334 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{3335           }
\DoxyCodeLine{3336             \textcolor{keywordflow}{if} (nn1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3337               smod(1) = smod(1) -\/ 2*nn1*d(n0+1,nn1-\/1,nn2,nn3)}
\DoxyCodeLine{3338             \textcolor{keywordflow}{else}            }
\DoxyCodeLine{3339               smod(1) = smod(1) + c\_i(n0,nn2,nn3,1)}
\DoxyCodeLine{3340 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3341 }
\DoxyCodeLine{3342             \textcolor{keywordflow}{if} (nn2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3343               smod(2) = smod(2) -\/ 2*nn2*d(n0+1,nn1,nn2-\/1,nn3)}
\DoxyCodeLine{3344             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3345               smod(2) = smod(2) + c\_i(n0,nn1,nn3,2)}
\DoxyCodeLine{3346 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3347 }
\DoxyCodeLine{3348             \textcolor{keywordflow}{if} (nn3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3349               smod(3) = smod(3) -\/ 2*nn3*d(n0+1,nn1,nn2,nn3-\/1)}
\DoxyCodeLine{3350             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3351               smod(3) = smod(3) + c\_i(n0,nn1,nn2,3)}
\DoxyCodeLine{3352 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3353           }
\DoxyCodeLine{3354             d(n0,n1,n2,n3) = \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(1,j)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(2,j)*smod(2)  \&}
\DoxyCodeLine{3355                            + \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(3,j)*smod(3)}
\DoxyCodeLine{3356 }
\DoxyCodeLine{3357 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{3358 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3359 \textcolor{comment}{!     end do}}
\DoxyCodeLine{3360 }
\DoxyCodeLine{3361       \textcolor{comment}{! determine error from symmetry for n0=0 and n1>1, n2>1 }}
\DoxyCodeLine{3362       derr(r)=derr(r-\/1)}
\DoxyCodeLine{3363       derr2(r)=derr2(r-\/1)}
\DoxyCodeLine{3364       n0=0}
\DoxyCodeLine{3365       \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3366         \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{3367           n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{3368           \textcolor{keywordflow}{if} (n1.ge.1.and.n2+n3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3369          }
\DoxyCodeLine{3370             \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3371               nn1 = n1}
\DoxyCodeLine{3372               nn2 = n2-\/1}
\DoxyCodeLine{3373               nn3 = n3}
\DoxyCodeLine{3374               j = 2}
\DoxyCodeLine{3375             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3376               nn1 = n1}
\DoxyCodeLine{3377               nn2 = n2}
\DoxyCodeLine{3378               nn3 = n3-\/1}
\DoxyCodeLine{3379               j = 3}
\DoxyCodeLine{3380 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3381 }
\DoxyCodeLine{3382             \textcolor{keywordflow}{do} i=1,3}
\DoxyCodeLine{3383               smod(i) = -\/c\_0(n0,nn1,nn2,nn3)-\/f(i)*d(n0,nn1,nn2,nn3)}
\DoxyCodeLine{3384 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{3385           }
\DoxyCodeLine{3386             \textcolor{keywordflow}{if} (nn1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3387               smod(1) = smod(1) -\/ 2*nn1*d(n0+1,nn1-\/1,nn2,nn3)}
\DoxyCodeLine{3388             \textcolor{keywordflow}{else}            }
\DoxyCodeLine{3389               smod(1) = smod(1) + c\_i(n0,nn2,nn3,1)}
\DoxyCodeLine{3390 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3391 }
\DoxyCodeLine{3392             \textcolor{keywordflow}{if} (nn2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3393               smod(2) = smod(2) -\/ 2*nn2*d(n0+1,nn1,nn2-\/1,nn3)}
\DoxyCodeLine{3394             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3395               smod(2) = smod(2) + c\_i(n0,nn1,nn3,2)}
\DoxyCodeLine{3396 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3397 }
\DoxyCodeLine{3398             \textcolor{keywordflow}{if} (nn3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3399               smod(3) = smod(3) -\/ 2*nn3*d(n0+1,nn1,nn2,nn3-\/1)}
\DoxyCodeLine{3400             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3401               smod(3) = smod(3) + c\_i(n0,nn1,nn2,3)}
\DoxyCodeLine{3402 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3403           }
\DoxyCodeLine{3404             d\_alt(n0,n1,n2,n3) = \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(1,j)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(2,j)*smod(2)  \&}
\DoxyCodeLine{3405                            + \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(3,j)*smod(3)}
\DoxyCodeLine{3406  }
\DoxyCodeLine{3407             derr(r)=max(derr(r),abs(d(n0,n1,n2,n3)-\/d\_alt(n0,n1,n2,n3)))}
\DoxyCodeLine{3408             derr2(r)=max(derr2(r),abs(d(n0,n1,n2,n3)-\/d\_alt(n0,n1,n2,n3)))}
\DoxyCodeLine{3409 }
\DoxyCodeLine{3410 \textcolor{preprocessor}{\#ifdef Dpv1otest}}
\DoxyCodeLine{3411 \textcolor{preprocessor}{}\textcolor{comment}{!            write(*,*) 'CalcDpv: errpr',r,Derr(r),abs(D(n0,n1,n2,n3)-\/D\_alt(n0,n1,n2,n3)), \&}}
\DoxyCodeLine{3412 \textcolor{comment}{!                        D(n0,n1,n2,n3),D\_alt(n0,n1,n2,n3),n0,n1,n2,n3}}
\DoxyCodeLine{3413 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3414 \textcolor{preprocessor}{}}
\DoxyCodeLine{3415 }
\DoxyCodeLine{3416 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3417 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3418 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3419 }
\DoxyCodeLine{3420       \textcolor{keywordflow}{if}(r.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{3421 \textcolor{comment}{! 09.02.2016}}
\DoxyCodeLine{3422 \textcolor{comment}{! old estimate using insertions of (5.11) in (5.10)}}
\DoxyCodeLine{3423         d00\_err(r) = max(2*abs(m02)*dij\_err(r-\/2), cerr\_i(r-\/2,0),    \&}
\DoxyCodeLine{3424               \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*dij\_err(r-\/2),             \&}
\DoxyCodeLine{3425               \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*max(2*d00\_err(r-\/1),cij\_err(r-\/2)))/(2*(r-\/1))}
\DoxyCodeLine{3426 \textcolor{comment}{! new estimate }}
\DoxyCodeLine{3427 \textcolor{comment}{!       D00\_err(r) = max(2*abs(m02)*Dij\_err(r-\/2), Cerr\_i(r-\/2,0),    \&}}
\DoxyCodeLine{3428 \textcolor{comment}{!             fmax*Dij\_err(r-\/1) )/(2*(r-\/1))}}
\DoxyCodeLine{3429       \textcolor{keywordflow}{else}}
\DoxyCodeLine{3430         d00\_err(r) = 0d0}
\DoxyCodeLine{3431 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3432       dij\_err(r) = max(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err(r-\/1),   \&}
\DoxyCodeLine{3433               \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(2*d00\_err(r),cij\_err(r-\/1)))/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3434 }
\DoxyCodeLine{3435       \textcolor{keywordflow}{if}(r.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{3436 \textcolor{comment}{! old estimate using insertions of (5.11) in (5.10)}}
\DoxyCodeLine{3437         d00\_err2(r) = max(2*abs(m02)*dij\_err2(r-\/2), cerr2\_i(r-\/2,0),    \&}
\DoxyCodeLine{3438               \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*dij\_err2(r-\/2),             \&}
\DoxyCodeLine{3439               \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*max(2*d00\_err2(r-\/1),cij\_err2(r-\/2)))/(2*(r-\/1))}
\DoxyCodeLine{3440 \textcolor{comment}{! new estimate }}
\DoxyCodeLine{3441 \textcolor{comment}{!       D00\_err2(r) = max(2*abs(m02)*Dij\_err2(r-\/2), Cerr2\_i(r-\/2,0),    \&}}
\DoxyCodeLine{3442 \textcolor{comment}{!             fmax*Dij\_err2(r-\/1)  )/(2*(r-\/1))}}
\DoxyCodeLine{3443       \textcolor{keywordflow}{else}}
\DoxyCodeLine{3444         d00\_err2(r) = 0d0}
\DoxyCodeLine{3445 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3446       dij\_err2(r) = max(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err2(r-\/1),   \&}
\DoxyCodeLine{3447               \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(2*d00\_err2(r),cij\_err2(r-\/1)))/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3448 }
\DoxyCodeLine{3449 \textcolor{preprocessor}{\#ifdef Dpv1otest}}
\DoxyCodeLine{3450 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err(r)'}, r,dij\_err(r),d00\_err(r)}
\DoxyCodeLine{3451     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err\_jj'},\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3452     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err\_00'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*d00\_err(1:rmax)/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3453     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err\_cc'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*cij\_err/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3454     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'factors'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}},\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3455     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err2(r)'}, r,dij\_err2(r),d00\_err2(r)}
\DoxyCodeLine{3456     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err2\_jj'},\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3457     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err2\_00'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*d00\_err(1:rmax)/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3458     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err2\_cc'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*cij\_err/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3459     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'factors2'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}),\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3460 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3461 \textcolor{preprocessor}{}}
\DoxyCodeLine{3462 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3463     }
\DoxyCodeLine{3464       \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2+N3=r, n0=1 only!!!!!! }}
\DoxyCodeLine{3465 \textcolor{comment}{!    do r=rmax+1,2*rmax}}
\DoxyCodeLine{3466     \textcolor{keywordflow}{do} r=rmax+1,rmax+1}
\DoxyCodeLine{3467       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{3468         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3469           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{3470             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{3471 }
\DoxyCodeLine{3472             d(n0,n1,n2,n3) = (c\_0(n0-\/1,n1,n2,n3) + 2*mm02*d(n0-\/1,n1,n2,n3)  \&}
\DoxyCodeLine{3473                 + 4*duv(n0,n1,n2,n3)  \&}
\DoxyCodeLine{3474                 + f(1)*d(n0-\/1,n1+1,n2,n3) + f(2)*d(n0-\/1,n1,n2+1,n3)  \&}
\DoxyCodeLine{3475                 + f(3)*d(n0-\/1,n1,n2,n3+1)) / (2*(r-\/1)) }
\DoxyCodeLine{3476 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{3477 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3478 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3479 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3480 }
\DoxyCodeLine{3481 \textcolor{preprocessor}{\#ifdef Dpv1otest}}
\DoxyCodeLine{3482 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Derrsym'},derr}
\DoxyCodeLine{3483     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Daccsym'},derr/abs(d(0,0,0,0))}
\DoxyCodeLine{3484 }
\DoxyCodeLine{3485     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err\_jj'},\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3486     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err\_00'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*d00\_err(1:rmax)/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3487     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err\_cc'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*cij\_err/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3488     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Dijerr'},dij\_err(1:rmax)}
\DoxyCodeLine{3489     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Dijacc'},dij\_err(1:rmax)/abs(d(0,0,0,0))}
\DoxyCodeLine{3490  }
\DoxyCodeLine{3491     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Derr2sym'},derr2}
\DoxyCodeLine{3492     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Dacc2sym'},derr2/abs(d(0,0,0,0))}
\DoxyCodeLine{3493 }
\DoxyCodeLine{3494     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err2\_jj'},\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*dij\_err2/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3495     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err2\_00'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*d00\_err2(1:rmax)/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3496     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Dij\_err2\_cc'},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*cij\_err2/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3497     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Dijerr2'},dij\_err2(1:rmax)}
\DoxyCodeLine{3498     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Dijacc2'},dij\_err2(1:rmax)/abs(d(0,0,0,0))}
\DoxyCodeLine{3499  }
\DoxyCodeLine{3500 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3501 \textcolor{preprocessor}{}}
\DoxyCodeLine{3502     derr2 = max(derr2,dij\_err2(0:rmax))}
\DoxyCodeLine{3503     derr = max(derr,dij\_err(0:rmax))}
\DoxyCodeLine{3504 }
\DoxyCodeLine{3505 \textcolor{preprocessor}{\#ifdef Dpv1otest}}
\DoxyCodeLine{3506 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o D(0,0,0,0) = '},d(0,0,0,0)}
\DoxyCodeLine{3507     \textcolor{keywordflow}{if}(rmax.ge.3)\textcolor{keywordflow}{then}}
\DoxyCodeLine{3508       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o D(0,1,1,1) = '},d(0,1,1,1)}
\DoxyCodeLine{3509 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{3510 }
\DoxyCodeLine{3511     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Derr'},derr}
\DoxyCodeLine{3512     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Dacc'},derr/abs(d(0,0,0,0))}
\DoxyCodeLine{3513     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Derr2'},derr2}
\DoxyCodeLine{3514     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1o Dacc2'},derr2/abs(d(0,0,0,0))}
\DoxyCodeLine{3515 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3516 \textcolor{preprocessor}{}}
\DoxyCodeLine{3517 \textcolor{comment}{!    if (id.eq.0) then}}
\DoxyCodeLine{3518 \textcolor{comment}{!    write(*,*) 'CalcDpv1o Derr ',Derr}}
\DoxyCodeLine{3519 \textcolor{comment}{!    write(*,*) 'CalcDpv1o Derr2',Derr2}}
\DoxyCodeLine{3520 \textcolor{comment}{!    end if}}
\DoxyCodeLine{3521     }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiond_ae9662beb597df14d1122ae9fd86f5b04}\label{namespacereductiond_ae9662beb597df14d1122ae9fd86f5b04}} 
\index{reductiond@{reductiond}!calcdpv2@{calcdpv2}}
\index{calcdpv2@{calcdpv2}!reductiond@{reductiond}}
\doxysubsubsection{\texorpdfstring{calcdpv2()}{calcdpv2()}}
{\footnotesize\ttfamily subroutine reductiond\+::calcdpv2 (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{D,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Duv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr2 }\end{DoxyParamCaption})}



Definition at line 3887 of file reduction\+D.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{3887 }
\DoxyCodeLine{3888     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobald}{globald}}}
\DoxyCodeLine{3889   }
\DoxyCodeLine{3890     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,id}
\DoxyCodeLine{3891     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p30,p20,p31,m02,m12,m22,m32}
\DoxyCodeLine{3892     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: D(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3893     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Duv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3894     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}  :: Derr(0:rmax),Derr2(0:rmax)}
\DoxyCodeLine{3895     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_0(:,:,:,:), Cuv\_0(:,:,:,:)}
\DoxyCodeLine{3896     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_i(:,:,:,:), Cuv\_i(:,:,:,:)}
\DoxyCodeLine{3897     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: D\_alt(:,:,:,:)}
\DoxyCodeLine{3898     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: Cerr\_i(:,:),Cerr2\_i(:,:)}
\DoxyCodeLine{3899     \textcolor{keywordtype}{double complex} :: D0\_coli, elimminf2\_coli}
\DoxyCodeLine{3900     \textcolor{keywordtype}{double complex} :: Daux(1:rmax/2+1,0:rmax-\/1,0:rmax-\/1,0:rmax-\/1), Smod(3)}
\DoxyCodeLine{3901     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err(:),Dij\_err(:),Cij\_err(:)}
\DoxyCodeLine{3902     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: D00\_err2(:),Dij\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{3903     \textcolor{keywordtype}{integer} :: rmaxC,r,n0,n1,n2,n3,k}
\DoxyCodeLine{3904     \textcolor{keywordtype}{integer} :: bin,nid(0:3)}
\DoxyCodeLine{3905 }
\DoxyCodeLine{3906 \textcolor{preprocessor}{\#ifdef Dpv2test}}
\DoxyCodeLine{3907 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 in'}}
\DoxyCodeLine{3908 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3909 \textcolor{preprocessor}{}\textcolor{comment}{!    write(*,*) 'CalcDpv2 in', rmax, id}}
\DoxyCodeLine{3910 }
\DoxyCodeLine{3911     \textcolor{comment}{! calculation of scalar coefficient}}
\DoxyCodeLine{3912     d(0,0,0,0) = d0\_coli(p10,p21,p32,p30,p20,p31,m02,m12,m22,m32)}
\DoxyCodeLine{3913     duv(0,0,0,0) = 0d0}
\DoxyCodeLine{3914 }
\DoxyCodeLine{3915     \textcolor{comment}{! accuracy estimate for D0 function}}
\DoxyCodeLine{3916     derr(0) = acc\_def\_d0*max( abs(d(0,0,0,0)), 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}) )}
\DoxyCodeLine{3917     derr2(0) = acc\_def\_d0*max( abs(d(0,0,0,0)), 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}) )}
\DoxyCodeLine{3918 }
\DoxyCodeLine{3919     \textcolor{keywordflow}{if} (rmax.eq.0) \textcolor{keywordflow}{return}}
\DoxyCodeLine{3920 }
\DoxyCodeLine{3921     \textcolor{comment}{! allocation of C functions}}
\DoxyCodeLine{3922     rmaxc = rmax-\/1}
\DoxyCodeLine{3923     \textcolor{comment}{! rmaxC = max(rmax-\/1,0)}}
\DoxyCodeLine{3924     \textcolor{keyword}{allocate}(c\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{3925     \textcolor{keyword}{allocate}(cuv\_0(0:rmaxc,0:rmaxc,0:rmaxc,0:rmaxc))}
\DoxyCodeLine{3926     \textcolor{keyword}{allocate}(c\_i(0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{3927     \textcolor{keyword}{allocate}(cuv\_i(0:rmaxc,0:rmaxc,0:rmaxc,3))}
\DoxyCodeLine{3928     \textcolor{keyword}{allocate}(cerr\_i(0:rmaxc,0:3))}
\DoxyCodeLine{3929     \textcolor{keyword}{allocate}(cerr2\_i(0:rmaxc,0:3))}
\DoxyCodeLine{3930     }
\DoxyCodeLine{3931     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{3932     \textcolor{keyword}{allocate}(d00\_err(0:rmax+1))}
\DoxyCodeLine{3933     \textcolor{keyword}{allocate}(dij\_err(0:rmax))}
\DoxyCodeLine{3934     \textcolor{keyword}{allocate}(cij\_err(0:rmaxc))}
\DoxyCodeLine{3935 }
\DoxyCodeLine{3936     \textcolor{keyword}{allocate}(d00\_err2(0:rmax+1))}
\DoxyCodeLine{3937     \textcolor{keyword}{allocate}(dij\_err2(0:rmax))}
\DoxyCodeLine{3938     \textcolor{keyword}{allocate}(cij\_err2(0:rmaxc))}
\DoxyCodeLine{3939    }
\DoxyCodeLine{3940 }
\DoxyCodeLine{3941     \textcolor{comment}{! determine binaries for C-\/coefficients}}
\DoxyCodeLine{3942     k=0}
\DoxyCodeLine{3943     bin = 1}
\DoxyCodeLine{3944     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.3)}
\DoxyCodeLine{3945       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3946         nid(k) = id+bin}
\DoxyCodeLine{3947         k = k+1}
\DoxyCodeLine{3948 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3949       bin = 2*bin}
\DoxyCodeLine{3950 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3951 }
\DoxyCodeLine{3952     \textcolor{keyword}{call }calcc(c\_0(:,0,:,:),cuv\_0(:,0,:,:),p21,p32,p31,m12,m22,m32,rmaxc,nid(0),cerr\_i(:,0),cerr2\_i(:,0))}
\DoxyCodeLine{3953     \textcolor{keyword}{call }calcc(c\_i(:,:,:,1),cuv\_i(:,:,:,1),p20,p32,p30,m02,m22,m32,rmaxc,nid(1),cerr\_i(:,1),cerr2\_i(:,1))}
\DoxyCodeLine{3954     \textcolor{keyword}{call }calcc(c\_i(:,:,:,2),cuv\_i(:,:,:,2),p10,p31,p30,m02,m12,m32,rmaxc,nid(2),cerr\_i(:,2),cerr2\_i(:,2))}
\DoxyCodeLine{3955     \textcolor{keyword}{call }calcc(c\_i(:,:,:,3),cuv\_i(:,:,:,3),p10,p21,p20,m02,m12,m22,rmaxc,nid(3),cerr\_i(:,3),cerr2\_i(:,3))}
\DoxyCodeLine{3956 }
\DoxyCodeLine{3957     \textcolor{comment}{! shift of integration momentum in C\(\backslash\)\{0\}}}
\DoxyCodeLine{3958     \textcolor{keywordflow}{do} n1=1,rmaxc}
\DoxyCodeLine{3959       \textcolor{keywordflow}{do} n2=0,rmaxc-\/n1}
\DoxyCodeLine{3960         \textcolor{keywordflow}{do} n3=0,rmaxc-\/n1-\/n2}
\DoxyCodeLine{3961           n0 = (rmaxc-\/n1-\/n2-\/n3)}
\DoxyCodeLine{3962           c\_0(0:n0,n1,n2,n3) = -\/c\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{3963                             -\/c\_0(0:n0,n1-\/1,n2+1,n3)-\/c\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{3964           cuv\_0(0:n0,n1,n2,n3) = -\/cuv\_0(0:n0,n1-\/1,n2,n3)  \&}
\DoxyCodeLine{3965                               -\/cuv\_0(0:n0,n1-\/1,n2+1,n3)-\/cuv\_0(0:n0,n1-\/1,n2,n3+1)}
\DoxyCodeLine{3966 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3967 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3968 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3969 }
\DoxyCodeLine{3970     }
\DoxyCodeLine{3971     \textcolor{comment}{! determine inverse modified Cayley matrix}}
\DoxyCodeLine{3972 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{3973 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{3974 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{3975 \textcolor{comment}{!    mm32 = elimminf2\_coli(m32)}}
\DoxyCodeLine{3976 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{3977 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{3978 \textcolor{comment}{!    q32  = elimminf2\_coli(p32)}}
\DoxyCodeLine{3979 \textcolor{comment}{!    q30  = elimminf2\_coli(p30)}}
\DoxyCodeLine{3980 \textcolor{comment}{!    q31  = elimminf2\_coli(p31)}}
\DoxyCodeLine{3981 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{3982 }
\DoxyCodeLine{3983     \textcolor{comment}{! calculate Duv}}
\DoxyCodeLine{3984     \textcolor{keyword}{call }calcduv(duv,cuv\_0,mm02,\mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(1:3,0),rmax,id)    }
\DoxyCodeLine{3985 }
\DoxyCodeLine{3986     \textcolor{comment}{! initialization of error propagation}}
\DoxyCodeLine{3987 }
\DoxyCodeLine{3988 \textcolor{comment}{!    adetX = abs(chdet(4,mx))}}
\DoxyCodeLine{3989 \textcolor{comment}{!    maxZadjf=maxval(abs(mxinv(0,1:3)))*adetX}}
\DoxyCodeLine{3990 \textcolor{comment}{!    maxXadj=maxval(abs(mxinv(1:3,1:3)))*adetX}}
\DoxyCodeLine{3991 \textcolor{comment}{!    adetZ=abs(mxinv(0,0))*adetX}}
\DoxyCodeLine{3992 }
\DoxyCodeLine{3993 \textcolor{comment}{!    write(*,*) 'CalcDpv adetX ',adetX,maxZadjf,maxXadj,adetZ}}
\DoxyCodeLine{3994 }
\DoxyCodeLine{3995     dij\_err =0d0}
\DoxyCodeLine{3996     d00\_err =0d0}
\DoxyCodeLine{3997     dij\_err(0) = derr(0)}
\DoxyCodeLine{3998     cij\_err = max(cerr\_i(:,0),cerr\_i(:,1),cerr\_i(:,2),cerr\_i(:,3))}
\DoxyCodeLine{3999 }
\DoxyCodeLine{4000     dij\_err2 =0d0}
\DoxyCodeLine{4001     d00\_err2 =0d0}
\DoxyCodeLine{4002     dij\_err2(0) = derr2(0)}
\DoxyCodeLine{4003     cij\_err2 = max(cerr2\_i(:,0),cerr2\_i(:,1),cerr2\_i(:,2),cerr2\_i(:,3))}
\DoxyCodeLine{4004 }
\DoxyCodeLine{4005 \textcolor{comment}{!   write(*,*) 'CalcDpv2 Cerr \_i0=',Cerr\_i(:,0)}}
\DoxyCodeLine{4006 \textcolor{comment}{!   write(*,*) 'CalcDpv2 Cerr2\_i0=',Cerr2\_i(:,0)}}
\DoxyCodeLine{4007 \textcolor{comment}{!   write(*,*) 'CalcDpv2 Cerr \_i1=',Cerr\_i(:,1)}}
\DoxyCodeLine{4008 \textcolor{comment}{!   write(*,*) 'CalcDpv2 Cerr2\_i1=',Cerr2\_i(:,1)}}
\DoxyCodeLine{4009 \textcolor{comment}{!   write(*,*) 'CalcDpv2 Cerr \_i2=',Cerr\_i(:,2)}}
\DoxyCodeLine{4010 \textcolor{comment}{!   write(*,*) 'CalcDpv2 Cerr2\_i2=',Cerr2\_i(:,2)}}
\DoxyCodeLine{4011 \textcolor{comment}{!   write(*,*) 'CalcDpv2 Cerr \_i3=',Cerr\_i(:,3)}}
\DoxyCodeLine{4012 \textcolor{comment}{!   write(*,*) 'CalcDpv2 Cerr2\_i3=',Cerr2\_i(:,3)}}
\DoxyCodeLine{4013 \textcolor{comment}{!   write(*,*) 'CalcDpv2 Cij\_err=',Cij\_err}}
\DoxyCodeLine{4014 \textcolor{comment}{!   write(*,*) 'CalcDpv2 Cij\_err2=',Cij\_err2}}
\DoxyCodeLine{4015 \textcolor{preprocessor}{\#ifdef Dpv2test}}
\DoxyCodeLine{4016 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Dij\_err(0)='},dij\_err(0)}
\DoxyCodeLine{4017     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Dij\_acc(0)='},dij\_err(0)/d(0,0,0,0)}
\DoxyCodeLine{4018     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Cij\_err='},cij\_err}
\DoxyCodeLine{4019 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4020 \textcolor{preprocessor}{}    }
\DoxyCodeLine{4021     \textcolor{keyword}{allocate}(d\_alt(0:rmax,0:rmax,0:rmax,0:rmax))}
\DoxyCodeLine{4022 }
\DoxyCodeLine{4023     \textcolor{comment}{! alternative PV-\/like reduction}}
\DoxyCodeLine{4024     \textcolor{keywordflow}{do} r=1,rmax}
\DoxyCodeLine{4025 }
\DoxyCodeLine{4026       \textcolor{keywordflow}{do} n0=2,r/2}
\DoxyCodeLine{4027         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{4028           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{4029             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{4030 }
\DoxyCodeLine{4031             \textcolor{keywordflow}{do} k=1,3}
\DoxyCodeLine{4032               smod(k) = -\/c\_0(n0-\/1,n1,n2,n3)}
\DoxyCodeLine{4033 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{4034 }
\DoxyCodeLine{4035             \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4036               smod(1) = smod(1) -\/ 2*n1*d(n0,n1-\/1,n2,n3)}
\DoxyCodeLine{4037             \textcolor{keywordflow}{else}}
\DoxyCodeLine{4038               smod(1) = smod(1) + c\_i(n0-\/1,n2,n3,1)}
\DoxyCodeLine{4039 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4040 }
\DoxyCodeLine{4041             \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4042               smod(2) = smod(2) -\/ 2*n2*d(n0,n1,n2-\/1,n3)}
\DoxyCodeLine{4043             \textcolor{keywordflow}{else}}
\DoxyCodeLine{4044               smod(2) = smod(2) + c\_i(n0-\/1,n1,n3,2)}
\DoxyCodeLine{4045 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4046 }
\DoxyCodeLine{4047             \textcolor{keywordflow}{if} (n3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4048               smod(3) = smod(3) -\/ 2*n3*d(n0,n1,n2,n3-\/1)}
\DoxyCodeLine{4049             \textcolor{keywordflow}{else}}
\DoxyCodeLine{4050               smod(3) = smod(3) + c\_i(n0-\/1,n1,n2,3)}
\DoxyCodeLine{4051 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4052 }
\DoxyCodeLine{4053             daux(n0,n1,n2,n3) = (d(n0-\/1,n1,n2,n3) -\/ \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(1,0)*smod(1)  \&}
\DoxyCodeLine{4054                               -\/ \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(2,0)*smod(2) -\/ \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(3,0)*smod(3))/\mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(0,0)}
\DoxyCodeLine{4055 }
\DoxyCodeLine{4056 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4057 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4058 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4059 }
\DoxyCodeLine{4060       }
\DoxyCodeLine{4061       \textcolor{keywordflow}{do} n0=1,r/2}
\DoxyCodeLine{4062         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{4063           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{4064             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{4065 }
\DoxyCodeLine{4066             d(n0,n1,n2,n3) = (daux(n0,n1,n2,n3) + 4d0*duv(n0,n1,n2,n3)  \&}
\DoxyCodeLine{4067                              + c\_0(n0-\/1,n1,n2,n3))/(r-\/1)/2d0    }
\DoxyCodeLine{4068 }
\DoxyCodeLine{4069 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4070 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4071 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4072 }
\DoxyCodeLine{4073 \textcolor{comment}{!      do n1=0,r-\/1}}
\DoxyCodeLine{4074 \textcolor{comment}{!        do n2=0,r-\/1-\/n1}}
\DoxyCodeLine{4075 \textcolor{comment}{!          n3 = r-\/1-\/n1-\/n2}}
\DoxyCodeLine{4076 \textcolor{comment}{!}}
\DoxyCodeLine{4077 \textcolor{comment}{!          do k=1,3}}
\DoxyCodeLine{4078 \textcolor{comment}{!            Smod(k) = -\/C\_0(0,n1,n2,n3)}}
\DoxyCodeLine{4079 \textcolor{comment}{!          end do}}
\DoxyCodeLine{4080 \textcolor{comment}{!}}
\DoxyCodeLine{4081 \textcolor{comment}{!          if (n1.ge.1) then}}
\DoxyCodeLine{4082 \textcolor{comment}{!            Smod(1) = Smod(1) -\/ 2*n1*D(1,n1-\/1,n2,n3)}}
\DoxyCodeLine{4083 \textcolor{comment}{!          else}}
\DoxyCodeLine{4084 \textcolor{comment}{!            Smod(1) = Smod(1) + C\_i(0,n2,n3,1)}}
\DoxyCodeLine{4085 \textcolor{comment}{!          end if}}
\DoxyCodeLine{4086 \textcolor{comment}{!}}
\DoxyCodeLine{4087 \textcolor{comment}{!          if (n2.ge.1) then}}
\DoxyCodeLine{4088 \textcolor{comment}{!            Smod(2) = Smod(2) -\/ 2*n2*D(1,n1,n2-\/1,n3)}}
\DoxyCodeLine{4089 \textcolor{comment}{!          else}}
\DoxyCodeLine{4090 \textcolor{comment}{!            Smod(2) = Smod(2) + C\_i(0,n1,n3,2)}}
\DoxyCodeLine{4091 \textcolor{comment}{!          end if}}
\DoxyCodeLine{4092 \textcolor{comment}{!}}
\DoxyCodeLine{4093 \textcolor{comment}{!          if (n3.ge.1) then}}
\DoxyCodeLine{4094 \textcolor{comment}{!            Smod(3) = Smod(3) -\/ 2*n3*D(1,n1,n2,n3-\/1)}}
\DoxyCodeLine{4095 \textcolor{comment}{!          else}}
\DoxyCodeLine{4096 \textcolor{comment}{!            Smod(3) = Smod(3) + C\_i(0,n1,n2,3)}}
\DoxyCodeLine{4097 \textcolor{comment}{!          end if}}
\DoxyCodeLine{4098 \textcolor{comment}{!}}
\DoxyCodeLine{4099 \textcolor{comment}{!          Daux(1,n1,n2,n3) = (D(0,n1,n2,n3) -\/ mxinv(1,0)*Smod(1)  \&}}
\DoxyCodeLine{4100 \textcolor{comment}{!                             -\/ mxinv(2,0)*Smod(2) -\/ mxinv(3,0)*Smod(3))/mxinv(0,0)}}
\DoxyCodeLine{4101 \textcolor{comment}{!}}
\DoxyCodeLine{4102 \textcolor{comment}{!          D(0,n1+1,n2,n3) = mxinv(0,1)*Daux(1,n1,n2,n3)  \&}}
\DoxyCodeLine{4103 \textcolor{comment}{!                          + mxinv(1,1)*Smod(1) + mxinv(2,1)*Smod(2) + mxinv(3,1)*Smod(3)}}
\DoxyCodeLine{4104 \textcolor{comment}{!          D(0,n1,n2+1,n3) = mxinv(0,2)*Daux(1,n1,n2,n3)  \&}}
\DoxyCodeLine{4105 \textcolor{comment}{!                          + mxinv(1,2)*Smod(1) + mxinv(2,2)*Smod(2) + mxinv(3,2)*Smod(3)}}
\DoxyCodeLine{4106 \textcolor{comment}{!          D(0,n1,n2,n3+1) = mxinv(0,3)*Daux(1,n1,n2,n3)  \&}}
\DoxyCodeLine{4107 \textcolor{comment}{!                          + mxinv(1,3)*Smod(1) + mxinv(2,3)*Smod(2) + mxinv(3,3)*Smod(3)}}
\DoxyCodeLine{4108 \textcolor{comment}{!}}
\DoxyCodeLine{4109 \textcolor{comment}{!        end do}}
\DoxyCodeLine{4110 \textcolor{comment}{!      end do }}
\DoxyCodeLine{4111       }
\DoxyCodeLine{4112       \textcolor{comment}{! calculate D and determine error from symmetry for n0=0 and n1>0, n2>0, n3>0 }}
\DoxyCodeLine{4113       derr(r)=derr(r-\/1)}
\DoxyCodeLine{4114       derr2(r)=derr2(r-\/1)}
\DoxyCodeLine{4115 }
\DoxyCodeLine{4116       \textcolor{keywordflow}{do} n1=0,r-\/1}
\DoxyCodeLine{4117         \textcolor{keywordflow}{do} n2=0,r-\/1-\/n1}
\DoxyCodeLine{4118           n3 = r-\/1-\/n1-\/n2}
\DoxyCodeLine{4119 }
\DoxyCodeLine{4120           \textcolor{keywordflow}{do} k=1,3}
\DoxyCodeLine{4121             smod(k) = -\/c\_0(0,n1,n2,n3)}
\DoxyCodeLine{4122 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4123 }
\DoxyCodeLine{4124           \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4125             smod(1) = smod(1) -\/ 2*n1*d(1,n1-\/1,n2,n3)}
\DoxyCodeLine{4126           \textcolor{keywordflow}{else}}
\DoxyCodeLine{4127             smod(1) = smod(1) + c\_i(0,n2,n3,1)}
\DoxyCodeLine{4128 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4129 }
\DoxyCodeLine{4130           \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4131             smod(2) = smod(2) -\/ 2*n2*d(1,n1,n2-\/1,n3)}
\DoxyCodeLine{4132           \textcolor{keywordflow}{else}}
\DoxyCodeLine{4133             smod(2) = smod(2) + c\_i(0,n1,n3,2)}
\DoxyCodeLine{4134 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4135 }
\DoxyCodeLine{4136           \textcolor{keywordflow}{if} (n3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4137             smod(3) = smod(3) -\/ 2*n3*d(1,n1,n2,n3-\/1)}
\DoxyCodeLine{4138           \textcolor{keywordflow}{else}}
\DoxyCodeLine{4139             smod(3) = smod(3) + c\_i(0,n1,n2,3)}
\DoxyCodeLine{4140 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4141 }
\DoxyCodeLine{4142           daux(1,n1,n2,n3) = (d(0,n1,n2,n3) -\/ \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(1,0)*smod(1)  \&}
\DoxyCodeLine{4143                              -\/ \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(2,0)*smod(2) -\/ \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(3,0)*smod(3))/\mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(0,0)}
\DoxyCodeLine{4144 }
\DoxyCodeLine{4145           d(0,n1+1,n2,n3) = \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(0,1)*daux(1,n1,n2,n3)  \&}
\DoxyCodeLine{4146                           + \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(1,1)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(2,1)*smod(2) + \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(3,1)*smod(3)}
\DoxyCodeLine{4147           d(0,n1,n2+1,n3) = \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(0,2)*daux(1,n1,n2,n3)  \&}
\DoxyCodeLine{4148                           + \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(1,2)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(2,2)*smod(2) + \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(3,2)*smod(3)}
\DoxyCodeLine{4149           d\_alt(0,n1,n2,n3+1) = \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(0,3)*daux(1,n1,n2,n3)  \&}
\DoxyCodeLine{4150                           + \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(1,3)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(2,3)*smod(2) + \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(3,3)*smod(3)}
\DoxyCodeLine{4151 }
\DoxyCodeLine{4152           \textcolor{keywordflow}{if}(n3.eq.r-\/1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4153              d(0,0,0,r) = d\_alt(0,0,0,r)          }
\DoxyCodeLine{4154           \textcolor{keywordflow}{else}}
\DoxyCodeLine{4155 \textcolor{comment}{!             write(*,*) 'errsym=',abs(D(0,n1,n2,n3+1)-\/D\_alt(0,n1,n2,n3+1)),  \&}}
\DoxyCodeLine{4156 \textcolor{comment}{!                     D(0,n1,n2,n3+1),D\_alt(0,n1,n2,n3+1)}}
\DoxyCodeLine{4157 }
\DoxyCodeLine{4158              derr(r)=max(derr(r),abs(d(0,n1,n2,n3+1)-\/d\_alt(0,n1,n2,n3+1)))}
\DoxyCodeLine{4159              derr2(r)=max(derr2(r),abs(d(0,n1,n2,n3+1)-\/d\_alt(0,n1,n2,n3+1)))}
\DoxyCodeLine{4160 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4161 }
\DoxyCodeLine{4162 \textcolor{comment}{!          write(*,*) 'Da(0,n1,n2,n3)=',n1+1,n2,n3,D(0,n1+1,n2,n3)}}
\DoxyCodeLine{4163 \textcolor{comment}{!          write(*,*) 'Da(0,n1,n2,n3)=',n1,n2+1,n3,D(0,n1,n2+1,n3)}}
\DoxyCodeLine{4164 \textcolor{comment}{!          write(*,*) 'Db(0,n1,n2,n3)=',n1,n2,n3+1,D\_alt(0,n1,n2,n3+1)}}
\DoxyCodeLine{4165 }
\DoxyCodeLine{4166 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4167 \textcolor{keywordflow}{      end do} }
\DoxyCodeLine{4168 }
\DoxyCodeLine{4169       d00\_err(r+1) = max(cerr\_i(r-\/1,0),\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*dij\_err(r-\/1),      \&}
\DoxyCodeLine{4170                              \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*max(cij\_err(r-\/1),2*d00\_err(r)))/(2*r)}
\DoxyCodeLine{4171       dij\_err(r) = max(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*max(2*r*d00\_err(r+1),cerr\_i(r-\/1,0)),   \&}
\DoxyCodeLine{4172               \mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}*max(2*d00\_err(r),cij\_err(r-\/1)))/\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}}
\DoxyCodeLine{4173       }
\DoxyCodeLine{4174       d00\_err2(r+1) = max(cerr2\_i(r-\/1,0),\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*dij\_err2(r-\/1),      \&}
\DoxyCodeLine{4175                              \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*max(cij\_err2(r-\/1),2*d00\_err2(r)))/(2*r)}
\DoxyCodeLine{4176       dij\_err2(r) = max(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*max(2*r*d00\_err2(r+1),cerr2\_i(r-\/1,0)),   \&}
\DoxyCodeLine{4177               \mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}*max(2*d00\_err2(r),cij\_err2(r-\/1)))/\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}*sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}/(\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}))}
\DoxyCodeLine{4178       }
\DoxyCodeLine{4179 \textcolor{preprocessor}{\#ifdef Dpv2test}}
\DoxyCodeLine{4180 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Cerr\_i  '},r-\/1, cerr\_i(r-\/1,0)}
\DoxyCodeLine{4181       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Cij\_err '},r-\/1, cij\_err(r-\/1)}
\DoxyCodeLine{4182       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 D00\_err '},r+1, d00\_err(r+1)}
\DoxyCodeLine{4183       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Dij\_err '},r, dij\_err(r)}
\DoxyCodeLine{4184       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Cerr2\_i '},r-\/1, cerr2\_i(r-\/1,0)}
\DoxyCodeLine{4185       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Cij\_err2'},r-\/1, cij\_err2(r-\/1)}
\DoxyCodeLine{4186       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 D00\_err2'},r+1, d00\_err2(r+1)}
\DoxyCodeLine{4187       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Dij\_err2'},r, dij\_err2(r)}
\DoxyCodeLine{4188 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4189 \textcolor{preprocessor}{}}
\DoxyCodeLine{4190 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{4191 }
\DoxyCodeLine{4192       \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2+N3=r, n0=1 only!!!!!! }}
\DoxyCodeLine{4193 \textcolor{comment}{!    do r=rmax+1,2*rmax}}
\DoxyCodeLine{4194     \textcolor{keywordflow}{do} r=rmax+1,rmax+1}
\DoxyCodeLine{4195 }
\DoxyCodeLine{4196 \textcolor{preprocessor}{\#ifdef Dpv2test}}
\DoxyCodeLine{4197 \textcolor{preprocessor}{}\textcolor{comment}{! pv1 version gets unstable for some cases!}}
\DoxyCodeLine{4198       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{4199         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{4200           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{4201             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{4202 }
\DoxyCodeLine{4203             d(n0,n1,n2,n3) = (c\_0(n0-\/1,n1,n2,n3) + 2*mm02*d(n0-\/1,n1,n2,n3)  \&}
\DoxyCodeLine{4204                 + 4*duv(n0,n1,n2,n3)  \&}
\DoxyCodeLine{4205                 + f(1)*d(n0-\/1,n1+1,n2,n3) + f(2)*d(n0-\/1,n1,n2+1,n3)  \&}
\DoxyCodeLine{4206                 + f(3)*d(n0-\/1,n1,n2,n3+1)) / (2*(r-\/1)) }
\DoxyCodeLine{4207 }
\DoxyCodeLine{4208 \textcolor{comment}{!            write(*,*) 'D1(n0+1)',n0,n1,n2,n3}}
\DoxyCodeLine{4209 \textcolor{comment}{!            write(*,*) 'D1(n0+1)',(C\_0(n0-\/1,n1,n2,n3) + 2*mm02*D(n0-\/1,n1,n2,n3)  \&}}
\DoxyCodeLine{4210 \textcolor{comment}{!                + 4*Duv(n0,n1,n2,n3)  \&}}
\DoxyCodeLine{4211 \textcolor{comment}{!                + f(1)*D(n0-\/1,n1+1,n2,n3) + f(2)*D(n0-\/1,n1,n2+1,n3)  \&}}
\DoxyCodeLine{4212 \textcolor{comment}{!                + f(3)*D(n0-\/1,n1,n2,n3+1)) / (2*(r-\/1))}}
\DoxyCodeLine{4213 }
\DoxyCodeLine{4214 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4215 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4216 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4217 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4218 \textcolor{preprocessor}{}}
\DoxyCodeLine{4219 \textcolor{comment}{! pv2 formulas added 24.01.2016}}
\DoxyCodeLine{4220       \textcolor{keywordflow}{do} n0=max(2,r-\/rmax),r/2}
\DoxyCodeLine{4221         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{4222           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{4223             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{4224 }
\DoxyCodeLine{4225             \textcolor{keywordflow}{do} k=1,3}
\DoxyCodeLine{4226               smod(k) = -\/c\_0(n0-\/1,n1,n2,n3)}
\DoxyCodeLine{4227 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{4228 }
\DoxyCodeLine{4229             \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4230               smod(1) = smod(1) -\/ 2*n1*d(n0,n1-\/1,n2,n3)}
\DoxyCodeLine{4231             \textcolor{keywordflow}{else}}
\DoxyCodeLine{4232               smod(1) = smod(1) + c\_i(n0-\/1,n2,n3,1)}
\DoxyCodeLine{4233 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4234 }
\DoxyCodeLine{4235             \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4236               smod(2) = smod(2) -\/ 2*n2*d(n0,n1,n2-\/1,n3)}
\DoxyCodeLine{4237             \textcolor{keywordflow}{else}}
\DoxyCodeLine{4238               smod(2) = smod(2) + c\_i(n0-\/1,n1,n3,2)}
\DoxyCodeLine{4239 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4240 }
\DoxyCodeLine{4241             \textcolor{keywordflow}{if} (n3.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4242               smod(3) = smod(3) -\/ 2*n3*d(n0,n1,n2,n3-\/1)}
\DoxyCodeLine{4243             \textcolor{keywordflow}{else}}
\DoxyCodeLine{4244               smod(3) = smod(3) + c\_i(n0-\/1,n1,n2,3)}
\DoxyCodeLine{4245 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4246 }
\DoxyCodeLine{4247             daux(n0,n1,n2,n3) = (d(n0-\/1,n1,n2,n3) -\/ \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(1,0)*smod(1)  \&}
\DoxyCodeLine{4248                               -\/ \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(2,0)*smod(2) -\/ \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(3,0)*smod(3))/\mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(0,0)}
\DoxyCodeLine{4249 }
\DoxyCodeLine{4250 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4251 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4252 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4253 }
\DoxyCodeLine{4254       }
\DoxyCodeLine{4255       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{4256         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{4257           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{4258             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{4259 }
\DoxyCodeLine{4260             d(n0,n1,n2,n3) = (daux(n0,n1,n2,n3) + 4d0*duv(n0,n1,n2,n3)  \&}
\DoxyCodeLine{4261                              + c\_0(n0-\/1,n1,n2,n3))/(r-\/1)/2d0    }
\DoxyCodeLine{4262 }
\DoxyCodeLine{4263 \textcolor{preprocessor}{\#ifdef Dpv2test}}
\DoxyCodeLine{4264 \textcolor{preprocessor}{}\textcolor{comment}{!            write(*,*) 'D2(n0+1)',n0,n1,n2,n3}}
\DoxyCodeLine{4265 \textcolor{comment}{!            write(*,*) 'D2(n0+1)',(Daux(n0,n1,n2,n3) + 4d0*Duv(n0,n1,n2,n3)  \&}}
\DoxyCodeLine{4266 \textcolor{comment}{!                             + C\_0(n0-\/1,n1,n2,n3))/(r-\/1)/2d0}}
\DoxyCodeLine{4267 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4268 \textcolor{preprocessor}{}\textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4269 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4270 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4271 }
\DoxyCodeLine{4272 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{4273 }
\DoxyCodeLine{4274 \textcolor{preprocessor}{\#ifdef Dpv2test}}
\DoxyCodeLine{4275 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Derrsym'},derr}
\DoxyCodeLine{4276     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Daccsym'},derr/abs(d(0,0,0,0))}
\DoxyCodeLine{4277     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Derr2sym'},derr2}
\DoxyCodeLine{4278     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Dacc2sym'},derr2/abs(d(0,0,0,0))}
\DoxyCodeLine{4279 }
\DoxyCodeLine{4280     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Dijerr'},dij\_err}
\DoxyCodeLine{4281     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Dijacc'},dij\_err/abs(d(0,0,0,0))}
\DoxyCodeLine{4282 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4283 \textcolor{preprocessor}{}    }
\DoxyCodeLine{4284     derr2 = max(derr2,dij\_err2(0:rmax))}
\DoxyCodeLine{4285     derr = max(derr,dij\_err(0:rmax))}
\DoxyCodeLine{4286 }
\DoxyCodeLine{4287 \textcolor{preprocessor}{\#ifdef Dpv2test}}
\DoxyCodeLine{4288 \textcolor{preprocessor}{}\textcolor{comment}{!    write(*,*) 'CalcDpv2 D(0,0,0,0) = ',D(0,0,0,0)}}
\DoxyCodeLine{4289 \textcolor{comment}{!    if(rmax.ge.2)then}}
\DoxyCodeLine{4290 \textcolor{comment}{!      write(*,*) 'CalcDpv2 D(1,0,1,0) = ',D(1,0,1,0)}}
\DoxyCodeLine{4291 \textcolor{comment}{!    endif}}
\DoxyCodeLine{4292 \textcolor{comment}{!    if(rmax.ge.3)then}}
\DoxyCodeLine{4293 \textcolor{comment}{!      write(*,*) 'CalcDpv2 D(0,1,1,1) = ',D(0,1,1,1)}}
\DoxyCodeLine{4294 \textcolor{comment}{!    endif}}
\DoxyCodeLine{4295 }
\DoxyCodeLine{4296     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Derr '},derr}
\DoxyCodeLine{4297     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Dacc '},derr/abs(d(0,0,0,0))}
\DoxyCodeLine{4298     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Derr2'},derr2}
\DoxyCodeLine{4299     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv2 Dacc2'},derr2/abs(d(0,0,0,0))}
\DoxyCodeLine{4300 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4301 \textcolor{preprocessor}{}}
\DoxyCodeLine{4302 \textcolor{comment}{!    write(*,*) 'CalcDpv2 Derr ',Derr}}
\DoxyCodeLine{4303 \textcolor{comment}{!    write(*,*) 'CalcDpv2 Derr2',Derr2}}
\DoxyCodeLine{4304     }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiond_a7e9d3a0b1d8deaf7143765c780cfa2b5}\label{namespacereductiond_a7e9d3a0b1d8deaf7143765c780cfa2b5}} 
\index{reductiond@{reductiond}!calcdred@{calcdred}}
\index{calcdred@{calcdred}!reductiond@{reductiond}}
\doxysubsubsection{\texorpdfstring{calcdred()}{calcdred()}}
{\footnotesize\ttfamily subroutine reductiond\+::calcdred (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{D,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Duv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p32,  }\item[{double complex, intent(in)}]{p30,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{p31,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{double complex, intent(in)}]{m32,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr1,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Derr2 }\end{DoxyParamCaption})}



Definition at line 320 of file reduction\+D.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{320 }
\DoxyCodeLine{321     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobald}{globald}}}
\DoxyCodeLine{322   }
\DoxyCodeLine{323     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,id}
\DoxyCodeLine{324     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p32,p30,p20,p31,m02,m12,m22,m32}
\DoxyCodeLine{325 \textcolor{comment}{!    integer :: scheme\_C0(rmax-\/1:rmax\_C),scheme\_C1(rmax-\/1:rmax\_C)}}
\DoxyCodeLine{326 \textcolor{comment}{!    integer :: scheme\_C2(rmax-\/1:rmax\_C),scheme\_C3(rmax-\/1,rmax\_C)}}
\DoxyCodeLine{327     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: D(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{328     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Duv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{329     \textcolor{keywordtype}{double complex} :: elimminf2\_coli}
\DoxyCodeLine{330     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}  :: Derr1(0:rmax),Derr2(0:rmax)}
\DoxyCodeLine{331     \textcolor{keywordtype}{double precision} :: D0est,Dtyp}
\DoxyCodeLine{332 \textcolor{preprocessor}{\#ifdef USED0}}
\DoxyCodeLine{333 \textcolor{preprocessor}{}    \textcolor{keywordtype}{double complex} :: D0\_coli}
\DoxyCodeLine{334 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{335 \textcolor{preprocessor}{}\textcolor{comment}{!    double complex :: detX}}
\DoxyCodeLine{336     \textcolor{keywordtype}{double complex} :: chdet}
\DoxyCodeLine{337     \textcolor{keywordtype}{integer} :: rmaxC,r,rid,n0,n1,n2,n3,g,gy,gp,gr,gm,gpf,i,iexp}
\DoxyCodeLine{338     \textcolor{keywordtype}{integer} :: bin,k,nid(0:3)}
\DoxyCodeLine{339     \textcolor{keywordtype}{logical} :: use\_pv,use\_pv2,use\_g,use\_gy,use\_gp,use\_gr,use\_gm,use\_gpf}
\DoxyCodeLine{340 }
\DoxyCodeLine{341     \textcolor{keywordtype}{integer} :: r\_alt,Drmethod(0:rmax),DrCalc(0:rmax),DCalc}
\DoxyCodeLine{342     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_i(:,:,:,:), Cuv\_i(:,:,:,:)}
\DoxyCodeLine{343     \textcolor{keywordtype}{double complex} :: D\_alt(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{344     \textcolor{keywordtype}{double complex} :: Duv\_alt(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{345     \textcolor{keywordtype}{double precision} :: Derr(0:rmax),Derr\_alt(0:rmax),Derr1\_alt(0:rmax),Derr2\_alt(0:rmax)}
\DoxyCodeLine{346     \textcolor{keywordtype}{integer} :: Drmethod\_alt(0:rmax)    }
\DoxyCodeLine{347 }
\DoxyCodeLine{348     \textcolor{keywordtype}{double precision} :: err\_pv(0:rmax),err\_pv2(0:rmax),err\_g(0:rmax),err\_gy(0:rmax),err\_gp(0:rmax)}
\DoxyCodeLine{349     \textcolor{keywordtype}{double precision} :: err\_gr(0:rmax),err\_gm(0:rmax),err\_gpf(0:rmax)}
\DoxyCodeLine{350     \textcolor{keywordtype}{double precision} :: h\_pv,w\_pv,v\_pv,z\_pv,h\_pv2,w\_pv2,v\_pv2,z\_pv2,hw\_pv2}
\DoxyCodeLine{351     \textcolor{keywordtype}{double precision} :: u\_g,z\_g,err\_g\_C,err\_g\_Cr,err\_g\_exp}
\DoxyCodeLine{352     \textcolor{keywordtype}{double precision} :: u\_gm,z\_gm,err\_gm\_C,err\_gm\_Cr,err\_gm\_exp}
\DoxyCodeLine{353     \textcolor{keywordtype}{double precision} :: v1\_gy,b\_gy,err\_gy\_C,err\_gy\_Cr,err\_gy\_exp}
\DoxyCodeLine{354     \textcolor{keywordtype}{double precision} :: v\_gp,v1\_gp,z\_gp,err\_gp\_C,err\_gp\_Cr,err\_gp\_exp}
\DoxyCodeLine{355     \textcolor{keywordtype}{double precision} :: v1\_gpf,b\_gpf,err\_gpf\_C,err\_gpf\_Cr,err\_gpf\_exp}
\DoxyCodeLine{356     \textcolor{keywordtype}{double precision} :: x\_gr,y\_gr,y1\_gr,a\_gr,err\_gr\_C,err\_gr\_Cr,err\_gr\_exp}
\DoxyCodeLine{357     \textcolor{keywordtype}{double precision} :: err\_C0,Cerr\_i(0:rmax\_C,0:3),err\_C(0:rmax\_C),err\_D0,acc\_D,errfac(0:3),err\_req\_D,err\_inf,Cerr2\_i(0:rmax\_C,0:3)}
\DoxyCodeLine{358     \textcolor{keywordtype}{double precision} :: checkest,norm,Dscale2}
\DoxyCodeLine{359     \textcolor{keywordtype}{logical} :: lerr\_D0,errorwriteflag}
\DoxyCodeLine{360 }
\DoxyCodeLine{361     \textcolor{keywordtype}{character(len=*)},\textcolor{keywordtype}{parameter} :: fmt1 = \textcolor{stringliteral}{"(A7,'dcmplx(',d25.18,' , ',d25.18,' )')"}}
\DoxyCodeLine{362     \textcolor{keywordtype}{character(len=*)},\textcolor{keywordtype}{parameter} :: fmt10 = \textcolor{stringliteral}{"(A17,'(',d25.18,' , ',d25.18,' )')"}}
\DoxyCodeLine{363 }
\DoxyCodeLine{364 \textcolor{preprocessor}{\#ifdef CritPointsCOLI}}
\DoxyCodeLine{365 \textcolor{preprocessor}{}    \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: MaxCritPointD=50}
\DoxyCodeLine{366 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{367 \textcolor{preprocessor}{}    \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: MaxCritPointD=0}
\DoxyCodeLine{368 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{369 \textcolor{preprocessor}{}    \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{save} :: CritPointCntD}
\DoxyCodeLine{370     \textcolor{keywordtype}{integer} ncount}
\DoxyCodeLine{371 }
\DoxyCodeLine{372     \textcolor{keyword}{data} critpointcntd /0/}
\DoxyCodeLine{373 }
\DoxyCodeLine{374 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{375 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred in'},rmax,id,acc\_req\_d}
\DoxyCodeLine{376     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred acc\_req'},acc\_req\_d,reqacc\_coli}
\DoxyCodeLine{377     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred in'},p10,p21,p32,p30,p20,p31,m02,m12,m22,m32}
\DoxyCodeLine{378 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{379 \textcolor{preprocessor}{}}
\DoxyCodeLine{380     \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{381     \textcolor{comment}{! calculate 3-\/point functions for rank < rmax }}
\DoxyCodeLine{382     \textcolor{comment}{! and corresponding accuracy estimates}}
\DoxyCodeLine{383     \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{384 }
\DoxyCodeLine{385     \textcolor{comment}{! allocation of C functions}}
\DoxyCodeLine{386     \textcolor{comment}{! bad estimate of higher C coefficients leads to bad estimates for expansions -\/> not tried!}}
\DoxyCodeLine{387     \textcolor{comment}{! do not involve estimate of C0 in extrapolations!    }}
\DoxyCodeLine{388     rmaxc = max(rmax-\/1,3)}
\DoxyCodeLine{389     \textcolor{keyword}{allocate}(c\_i(0:rmaxc,0:rmaxc,0:rmaxc,0:3))}
\DoxyCodeLine{390     \textcolor{keyword}{allocate}(cuv\_i(0:rmaxc,0:rmaxc,0:rmaxc,0:3))}
\DoxyCodeLine{391 }
\DoxyCodeLine{392     \textcolor{comment}{! determine binaries for C-\/coefficients}}
\DoxyCodeLine{393     k=0}
\DoxyCodeLine{394     bin = 1}
\DoxyCodeLine{395     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.3)}
\DoxyCodeLine{396       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{397         nid(k) = id+bin}
\DoxyCodeLine{398         k = k+1}
\DoxyCodeLine{399 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{400       bin = 2*bin}
\DoxyCodeLine{401 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{402 }
\DoxyCodeLine{403     \textcolor{comment}{! caution: C\_i in first call not properly defined!}}
\DoxyCodeLine{404     \textcolor{keyword}{call }calcc(c\_i(:,:,:,0),cuv\_i(:,:,:,0),p21,p32,p31,m12,m22,m32,rmaxc,nid(0),cerr\_i(0:rmaxc,0),cerr2\_i(0:rmaxc,0))}
\DoxyCodeLine{405     \textcolor{keyword}{call }calcc(c\_i(:,:,:,1),cuv\_i(:,:,:,1),p20,p32,p30,m02,m22,m32,rmaxc,nid(1),cerr\_i(0:rmaxc,1),cerr2\_i(0:rmaxc,1))}
\DoxyCodeLine{406     \textcolor{keyword}{call }calcc(c\_i(:,:,:,2),cuv\_i(:,:,:,2),p10,p31,p30,m02,m12,m32,rmaxc,nid(2),cerr\_i(0:rmaxc,2),cerr2\_i(0:rmaxc,2))}
\DoxyCodeLine{407     \textcolor{keyword}{call }calcc(c\_i(:,:,:,3),cuv\_i(:,:,:,3),p10,p21,p20,m02,m12,m22,rmaxc,nid(3),cerr\_i(0:rmaxc,3),cerr2\_i(0:rmaxc,3))}
\DoxyCodeLine{408 }
\DoxyCodeLine{409 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{410 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Cerr 0 ='},cerr\_i(0:rmaxc,0)}
\DoxyCodeLine{411     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Cerr 1 ='},cerr\_i(0:rmaxc,1)}
\DoxyCodeLine{412     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Cerr 2 ='},cerr\_i(0:rmaxc,2)}
\DoxyCodeLine{413     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Cerr 3 ='},cerr\_i(0:rmaxc,3)}
\DoxyCodeLine{414     \textcolor{keywordflow}{if} (abs(c\_i(0,0,0,0)).ne.0d0) \&}
\DoxyCodeLine{415         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Cacc 0 ='},cerr\_i(0:rmaxc,0)/abs(c\_i(0,0,0,0))}
\DoxyCodeLine{416     \textcolor{keywordflow}{if} (abs(c\_i(0,0,0,1)).ne.0d0) \&}
\DoxyCodeLine{417         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Cacc 1 ='},cerr\_i(0:rmaxc,1)/abs(c\_i(0,0,0,1))}
\DoxyCodeLine{418     \textcolor{keywordflow}{if} (abs(c\_i(0,0,0,2)).ne.0d0) \&}
\DoxyCodeLine{419         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Cacc 2 ='},cerr\_i(0:rmaxc,2)/abs(c\_i(0,0,0,2))}
\DoxyCodeLine{420     \textcolor{keywordflow}{if} (abs(c\_i(0,0,0,3)).ne.0d0) \&}
\DoxyCodeLine{421         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Cacc 3 ='},cerr\_i(0:rmaxc,3)/abs(c\_i(0,0,0,3))}
\DoxyCodeLine{422 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{423 \textcolor{preprocessor}{} }
\DoxyCodeLine{424 \textcolor{comment}{!   acc\_C(0:rmaxC)=max((Cerr\_i(0:rmaxC,0))/abs(C\_i(0,0,0,0)),  \& }}
\DoxyCodeLine{425 \textcolor{comment}{!                      (Cerr\_i(0:rmaxC,1))/abs(C\_i(0,0,0,1)),  \& }}
\DoxyCodeLine{426 \textcolor{comment}{!                      (Cerr\_i(0:rmaxC,2))/abs(C\_i(0,0,0,2)),  \& }}
\DoxyCodeLine{427 \textcolor{comment}{!                      (Cerr\_i(0:rmaxC,3))/abs(C\_i(0,0,0,3))) }}
\DoxyCodeLine{428 }
\DoxyCodeLine{429 }
\DoxyCodeLine{430     \textcolor{keywordflow}{do} i=0,3}
\DoxyCodeLine{431 \textcolor{comment}{! changed 01.07.2015 to avoid bad estimates that excluded expansions}}
\DoxyCodeLine{432 \textcolor{comment}{!      errfac(i)=max(Cerr\_i(rmaxC,i)/Cerr\_i(rmaxC-\/1,i),sqrt(Cerr\_i(rmaxC,i)/Cerr\_i(rmaxC-\/2,i)))}}
\DoxyCodeLine{433        errfac(i) = 1d0}
\DoxyCodeLine{434       \textcolor{keywordflow}{do} r=rmaxc+1,rmax\_c}
\DoxyCodeLine{435         cerr\_i(r,i)=cerr\_i(r-\/1,i)*errfac(i)}
\DoxyCodeLine{436 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{437 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{438 }
\DoxyCodeLine{439     \textcolor{keywordflow}{do} r=0,rmax\_c}
\DoxyCodeLine{440       err\_c(r)=maxval(cerr\_i(r,0:3))}
\DoxyCodeLine{441 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{442 }
\DoxyCodeLine{443     err\_c0=err\_c(0)}
\DoxyCodeLine{444 }
\DoxyCodeLine{445 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{446 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred err\_C0:'},err\_c0}
\DoxyCodeLine{447     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Cerr 0 ='},cerr\_i(0:rmax\_c,0)}
\DoxyCodeLine{448     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Cerr 1 ='},cerr\_i(0:rmax\_c,1)}
\DoxyCodeLine{449     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Cerr 2 ='},cerr\_i(0:rmax\_c,2)}
\DoxyCodeLine{450     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Cerr 3 ='},cerr\_i(0:rmax\_c,3)}
\DoxyCodeLine{451     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Cerr   ='}, err\_c(0:rmax\_c)}
\DoxyCodeLine{452 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{453 \textcolor{preprocessor}{}}
\DoxyCodeLine{454     }
\DoxyCodeLine{455 }
\DoxyCodeLine{456 }
\DoxyCodeLine{457 }
\DoxyCodeLine{458     \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{459     \textcolor{comment}{! choose reduction scheme}}
\DoxyCodeLine{460     \textcolor{comment}{! by estimating expected errors}}
\DoxyCodeLine{461     \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{462 }
\DoxyCodeLine{463     \textcolor{comment}{! eliminate infinitesimal masses}}
\DoxyCodeLine{464     mm02 = elimminf2\_coli(m02)}
\DoxyCodeLine{465     mm12 = elimminf2\_coli(m12)}
\DoxyCodeLine{466     \mbox{\hyperlink{namespaceglobalc_a7c2a517c5707c2e77eb16e183db3d259}{mm22}} = elimminf2\_coli(m22)}
\DoxyCodeLine{467     \mbox{\hyperlink{namespaceglobald_af80b3560169e0b08203ed5b1f43ddcc6}{mm32}} = elimminf2\_coli(m32)}
\DoxyCodeLine{468     \mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}  = elimminf2\_coli(p10)}
\DoxyCodeLine{469     \mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}  = elimminf2\_coli(p21)}
\DoxyCodeLine{470     \mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}  = elimminf2\_coli(p32)}
\DoxyCodeLine{471     \mbox{\hyperlink{namespaceglobald_aa0b536e964913c8bc01a6b8f0b2a8822}{q30}}  = elimminf2\_coli(p30)}
\DoxyCodeLine{472     \mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}}  = elimminf2\_coli(p31)}
\DoxyCodeLine{473     \mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}  = elimminf2\_coli(p20)}
\DoxyCodeLine{474 }
\DoxyCodeLine{475     \textcolor{comment}{! set mass scales}}
\DoxyCodeLine{476     \mbox{\hyperlink{namespaceglobalc_a63210e2d88e5fe40f4b927fe139e7232}{q2max}} = max(abs(\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}),abs(\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}),abs(\mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}),abs(\mbox{\hyperlink{namespaceglobald_aa0b536e964913c8bc01a6b8f0b2a8822}{q30}}),abs(\mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}}),abs(\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}))}
\DoxyCodeLine{477     \mbox{\hyperlink{namespaceglobalc_a45c0f5c169a73fb12286352743b5a557}{m2max}} = max(abs(mm02),abs(mm12),abs(\mbox{\hyperlink{namespaceglobalc_a7c2a517c5707c2e77eb16e183db3d259}{mm22}}),abs(\mbox{\hyperlink{namespaceglobald_af80b3560169e0b08203ed5b1f43ddcc6}{mm32}}))}
\DoxyCodeLine{478     \mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}} = max(\mbox{\hyperlink{namespaceglobalc_a63210e2d88e5fe40f4b927fe139e7232}{q2max}},\mbox{\hyperlink{namespaceglobalc_a45c0f5c169a73fb12286352743b5a557}{m2max}})}
\DoxyCodeLine{479 }
\DoxyCodeLine{480     \textcolor{comment}{! Gram and related stuff}}
\DoxyCodeLine{481 \textcolor{comment}{!   q1q2 = (q10+q20-\/q21)/2D0}}
\DoxyCodeLine{482 \textcolor{comment}{!   q1q3 = (q10+q30-\/q31)/2D0}}
\DoxyCodeLine{483 \textcolor{comment}{!   q2q3 = (q20+q30-\/q32)/2D0}}
\DoxyCodeLine{484 }
\DoxyCodeLine{485     \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1) = 2d0*\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}}
\DoxyCodeLine{486     \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1) = \mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}+\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}-\/\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}}
\DoxyCodeLine{487     \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1) = \mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}+\mbox{\hyperlink{namespaceglobald_aa0b536e964913c8bc01a6b8f0b2a8822}{q30}}-\/\mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}}}
\DoxyCodeLine{488     \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{489     \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2) = 2d0*\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}}
\DoxyCodeLine{490     \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2) = \mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}+\mbox{\hyperlink{namespaceglobald_aa0b536e964913c8bc01a6b8f0b2a8822}{q30}}-\/\mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}}
\DoxyCodeLine{491     \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,3) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)}
\DoxyCodeLine{492     \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)}
\DoxyCodeLine{493     \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3) = 2d0*\mbox{\hyperlink{namespaceglobald_aa0b536e964913c8bc01a6b8f0b2a8822}{q30}}}
\DoxyCodeLine{494 \textcolor{comment}{!    write(*,*) 'Zn ',Z}}
\DoxyCodeLine{495 }
\DoxyCodeLine{496     \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}} = maxval(abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}))}
\DoxyCodeLine{497 }
\DoxyCodeLine{498     \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}} = chdet(3,\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}})}
\DoxyCodeLine{499     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}.ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{500       \textcolor{keyword}{call }chinv(3,\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}},\mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}})}
\DoxyCodeLine{501       \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}} = \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}} * \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}}
\DoxyCodeLine{502     \textcolor{keywordflow}{else}}
\DoxyCodeLine{503 \textcolor{comment}{!     Zadj(1,1) = 4d0*(q30*q20-\/q2q3*q2q3)}}
\DoxyCodeLine{504 \textcolor{comment}{!     Zadj(2,1) = 4d0*(q1q3*q2q3-\/q30*q1q2)}}
\DoxyCodeLine{505 \textcolor{comment}{!     Zadj(3,1) = 4d0*(q1q2*q2q3-\/q20*q1q3)}}
\DoxyCodeLine{506 \textcolor{comment}{!     Zadj(1,2) = Zadj(2,1)}}
\DoxyCodeLine{507 \textcolor{comment}{!     Zadj(2,2) = 4d0*(q10*q30-\/q1q3*q1q3)}}
\DoxyCodeLine{508 \textcolor{comment}{!     Zadj(3,2) = 4d0*(q1q2*q1q3-\/q10*q2q3)}}
\DoxyCodeLine{509 \textcolor{comment}{!     Zadj(1,3) = Zadj(3,1)}}
\DoxyCodeLine{510 \textcolor{comment}{!     Zadj(2,3) = Zadj(3,2)}}
\DoxyCodeLine{511 \textcolor{comment}{!     Zadj(3,3) = 4d0*(q10*q20-\/q1q2*q1q2)}}
\DoxyCodeLine{512 }
\DoxyCodeLine{513       \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1) = (\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)-\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3))}
\DoxyCodeLine{514       \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,1) = (\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,3)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3)-\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2))}
\DoxyCodeLine{515       \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,1) = (\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3)-\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,3))}
\DoxyCodeLine{516       \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2) = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,1)}
\DoxyCodeLine{517       \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2) = (\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)-\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,3)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,3))}
\DoxyCodeLine{518       \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,2) = (\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,3)-\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3))}
\DoxyCodeLine{519       \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,3) = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,1)}
\DoxyCodeLine{520       \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,3) = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,2)}
\DoxyCodeLine{521       \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,3) = (\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)-\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2))}
\DoxyCodeLine{522 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{523 \textcolor{comment}{!    write(*,*) 'Zadjn ',Zadj}}
\DoxyCodeLine{524 \textcolor{comment}{!    write(*,*) 'detZn ',detZ}}
\DoxyCodeLine{525 }
\DoxyCodeLine{526 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{527 \textcolor{preprocessor}{}    \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(1) = \mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}*(\mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}}+\mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}-\/\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}) + \mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}}*(\mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}-\/\mbox{\hyperlink{namespaceglobald_aa0b536e964913c8bc01a6b8f0b2a8822}{q30}})   \&}
\DoxyCodeLine{528          + \mbox{\hyperlink{namespaceglobald_aa0b536e964913c8bc01a6b8f0b2a8822}{q30}}*(\mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}+\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}) -\/ \mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}*(\mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}+2d0*\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}-\/\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}})}
\DoxyCodeLine{529     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Zadjs(1) '},\mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(1), \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,3)}
\DoxyCodeLine{530     \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(3) = \mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}*(\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}+\mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}}-\/\mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}) + (\mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}}-\/\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}})*(\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}-\/\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}})  \&}
\DoxyCodeLine{531          -\/ 2d0*\mbox{\hyperlink{namespaceglobald_aa0b536e964913c8bc01a6b8f0b2a8822}{q30}}*\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}} + \mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}*(\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}+\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}})}
\DoxyCodeLine{532     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Zadjs(3) '},\mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(3), \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,1)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,2)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,3)}
\DoxyCodeLine{533 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{534 \textcolor{preprocessor}{}}
\DoxyCodeLine{535     \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(1) = \mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}*(-\/2d0*\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}} + \mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}+\mbox{\hyperlink{namespaceglobald_aa0b536e964913c8bc01a6b8f0b2a8822}{q30}}+\mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}}+\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}} -\/ \mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}) \&}
\DoxyCodeLine{536          + (\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}-\/\mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}})*(\mbox{\hyperlink{namespaceglobald_aa0b536e964913c8bc01a6b8f0b2a8822}{q30}}-\/\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}})}
\DoxyCodeLine{537     \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(2) = \mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}}*(-\/2d0*\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}} + \mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}+\mbox{\hyperlink{namespaceglobald_aa0b536e964913c8bc01a6b8f0b2a8822}{q30}}+\mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}+\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}} -\/ \mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}}) \&}
\DoxyCodeLine{538          + (\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}-\/\mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}})*(\mbox{\hyperlink{namespaceglobald_aa0b536e964913c8bc01a6b8f0b2a8822}{q30}}-\/\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}})}
\DoxyCodeLine{539     \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(3) = \mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}*(-\/2d0*\mbox{\hyperlink{namespaceglobald_aa0b536e964913c8bc01a6b8f0b2a8822}{q30}} + \mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}+\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}+\mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}+\mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}} -\/ \mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}) \&}
\DoxyCodeLine{540          + (\mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}}-\/\mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}})*(\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}-\/\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}})}
\DoxyCodeLine{541 }
\DoxyCodeLine{542 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{543 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Zadjs(1) '},\mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(1), \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,3)}
\DoxyCodeLine{544     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Zadjs(2) '},\mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(2), \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,1)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,3)}
\DoxyCodeLine{545     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Zadjs(3) '},\mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(3), \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,1)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,2)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,3)}
\DoxyCodeLine{546 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{547 \textcolor{preprocessor}{}}
\DoxyCodeLine{548     \mbox{\hyperlink{namespaceglobalc_ae3a848253264b0b20c9d773d37bbbb44}{detzmzadjf}} = -\/2*\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}*\mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}}*\mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}} + \mbox{\hyperlink{namespaceglobald_aa0b536e964913c8bc01a6b8f0b2a8822}{q30}}*\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}*(-\/\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}} + \mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}} + \mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}) \& }
\DoxyCodeLine{549          + \mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}*\mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}}*(\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}} -\/ \mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}} + \mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}) + \mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}*\mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}}*(\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}} + \mbox{\hyperlink{namespaceglobald_a01ca17c939b881ad0e3f0b626459baaa}{q31}} -\/ \mbox{\hyperlink{namespaceglobald_aad1299bdc45e8fd60e79fcb9c58abd97}{q32}})}
\DoxyCodeLine{550          }
\DoxyCodeLine{551     \mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}} = abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})}
\DoxyCodeLine{552     \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = max(abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1)),abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,1)),abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,1)),  \&}
\DoxyCodeLine{553                   abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2)),abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,2)),abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,3)))}
\DoxyCodeLine{554 }
\DoxyCodeLine{555     f(1) = \mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}+mm02-\/mm12}
\DoxyCodeLine{556     f(2) = \mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}+mm02-\/\mbox{\hyperlink{namespaceglobalc_a7c2a517c5707c2e77eb16e183db3d259}{mm22}}}
\DoxyCodeLine{557     f(3) = \mbox{\hyperlink{namespaceglobald_aa0b536e964913c8bc01a6b8f0b2a8822}{q30}}+mm02-\/\mbox{\hyperlink{namespaceglobald_af80b3560169e0b08203ed5b1f43ddcc6}{mm32}}}
\DoxyCodeLine{558     \mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}} = max(abs(f(1)),abs(f(2)),abs(f(3)))}
\DoxyCodeLine{559       }
\DoxyCodeLine{560     \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(0,0) = 2d0*mm02}
\DoxyCodeLine{561     \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(1,0) = \mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}} -\/ mm12 + mm02}
\DoxyCodeLine{562     \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(2,0) = \mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}} -\/ \mbox{\hyperlink{namespaceglobalc_a7c2a517c5707c2e77eb16e183db3d259}{mm22}} + mm02}
\DoxyCodeLine{563     \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(3,0) = \mbox{\hyperlink{namespaceglobald_aa0b536e964913c8bc01a6b8f0b2a8822}{q30}} -\/ \mbox{\hyperlink{namespaceglobald_af80b3560169e0b08203ed5b1f43ddcc6}{mm32}} + mm02}
\DoxyCodeLine{564     \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(0,1) = \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(1,0)}
\DoxyCodeLine{565     \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(0,2) = \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(2,0)}
\DoxyCodeLine{566     \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(0,3) = \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(3,0)}
\DoxyCodeLine{567     \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(1:3,1:3) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1:3,1:3)}
\DoxyCodeLine{568 }
\DoxyCodeLine{569     \mbox{\hyperlink{namespaceglobalc_a8dc59fea129282fd82fda20025969b67}{detx}} = chdet(4,\mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}})}
\DoxyCodeLine{570 }
\DoxyCodeLine{571     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_a8dc59fea129282fd82fda20025969b67}{detx}}.ne.0d0.and.\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}.ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{572       \textcolor{keyword}{call }chinv(4,\mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}},\mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}})}
\DoxyCodeLine{573       \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}} = \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}} * \mbox{\hyperlink{namespaceglobalc_a8dc59fea129282fd82fda20025969b67}{detx}}}
\DoxyCodeLine{574 }
\DoxyCodeLine{575       \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1:3) = -\/\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(0,1:3)}
\DoxyCodeLine{576     }
\DoxyCodeLine{577       \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(1:3,1:3) = \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1:3,1:3) -\/ 2d0*mm02*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1:3,1:3)}
\DoxyCodeLine{578     \textcolor{keywordflow}{else}}
\DoxyCodeLine{579       \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1) = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1)*f(1)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,1)*f(2)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,1)*f(3)}
\DoxyCodeLine{580       \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2) = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2)*f(1)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2)*f(2)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,2)*f(3)}
\DoxyCodeLine{581       \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(3) = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,3)*f(1)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,3)*f(2)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,3)*f(3)}
\DoxyCodeLine{582 }
\DoxyCodeLine{583       \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(1,1) = -\/f(2)*f(2)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3) -\/ f(3)*f(3)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)  \&}
\DoxyCodeLine{584                    + 2*f(2)*f(3)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)}
\DoxyCodeLine{585       \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(2,1) = f(2)*f(1)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3) -\/ f(3)*f(1)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3)  \&}
\DoxyCodeLine{586                    -\/ f(2)*f(3)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,3) + f(3)*f(3)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2) }
\DoxyCodeLine{587       \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(3,1) = -\/f(2)*f(1)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2) + f(3)*f(1)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)  \&}
\DoxyCodeLine{588                    + f(2)*f(2)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1) -\/ f(3)*f(2)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{589       \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(1,2) = \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(2,1)}
\DoxyCodeLine{590       \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(2,2) = -\/f(1)*f(1)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3) -\/ f(3)*f(3)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)  \&}
\DoxyCodeLine{591                    + 2*f(1)*f(3)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,3)}
\DoxyCodeLine{592       \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(3,2) = f(1)*f(1)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3) -\/ f(1)*f(2)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,3)  \&}
\DoxyCodeLine{593                    -\/ f(3)*f(1)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1) + f(3)*f(2)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)}
\DoxyCodeLine{594       \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(1,3) = \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(3,1)}
\DoxyCodeLine{595       \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(2,3) = \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(3,2) }
\DoxyCodeLine{596       \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(3,3) = -\/f(1)*f(1)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2) -\/ f(2)*f(2)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)  \&}
\DoxyCodeLine{597                    + 2*f(1)*f(2)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{598 }
\DoxyCodeLine{599       \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,1) = 2d0*mm02*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1) + \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(1,1)}
\DoxyCodeLine{600       \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,1) = 2d0*mm02*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,1) + \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(2,1)}
\DoxyCodeLine{601       \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(3,1) = 2d0*mm02*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,1) + \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(3,1)}
\DoxyCodeLine{602       \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,2) = \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,1)}
\DoxyCodeLine{603       \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,2) = 2d0*mm02*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2) + \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(2,2)}
\DoxyCodeLine{604       \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(3,2) = 2d0*mm02*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,2) + \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(3,2)}
\DoxyCodeLine{605       \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,3) = \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(3,1)}
\DoxyCodeLine{606       \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,3) = \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(3,2)}
\DoxyCodeLine{607       \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(3,3) = 2d0*mm02*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(3,3) + \mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(3,3)}
\DoxyCodeLine{608 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{609 }
\DoxyCodeLine{610 }
\DoxyCodeLine{611 \textcolor{comment}{!   write(*,*) 'Xadjn ',Xadj}}
\DoxyCodeLine{612 \textcolor{comment}{!   write(*,*) 'detXn ',detX}}
\DoxyCodeLine{613 \textcolor{comment}{!   write(*,*) 'Zadjfn',Zadjf}}
\DoxyCodeLine{614 \textcolor{comment}{!   write(*,*) 'Zadj2ffn',Zadj2ff}}
\DoxyCodeLine{615 }
\DoxyCodeLine{616     \mbox{\hyperlink{namespaceglobald_abb53ba199b80e317f07ea24a998e4879}{maxzadj2ff}} = max(abs(\mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(1,1)),abs(\mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(2,1)),abs(\mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(3,1)),  \&}
\DoxyCodeLine{617                      abs(\mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(2,2)),abs(\mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(3,2)),abs(\mbox{\hyperlink{namespaceglobald_a19d73e9d8e36895745531c9c4f6451ff}{zadj2ff}}(3,3)))}
\DoxyCodeLine{618     \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}} = max(abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)),abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)),abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(3)))}
\DoxyCodeLine{619     \mbox{\hyperlink{namespaceglobalc_a2066e024d434b31a1734a85603ee6544}{maxzadjfd}} = max(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}},\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})}
\DoxyCodeLine{620     \mbox{\hyperlink{namespaceglobald_a38ac8b62fc3afe476f46735a660f3cdf}{zadjff}} = \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)*f(1)+\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)*f(2)+\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(3)*f(3)}
\DoxyCodeLine{621     \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}} = abs(\mbox{\hyperlink{namespaceglobald_a38ac8b62fc3afe476f46735a660f3cdf}{zadjff}})}
\DoxyCodeLine{622     \mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}} = abs(2d0*mm02*\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}-\/\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)*f(1)-\/\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)*f(2)-\/\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(3)*f(3))}
\DoxyCodeLine{623     }
\DoxyCodeLine{624 \textcolor{comment}{!    write(*,*) 'fs', f(1), f(2), f(3)}}
\DoxyCodeLine{625 \textcolor{comment}{!    write(*,*) aZadjff, maxZadjf*fmax}}
\DoxyCodeLine{626 }
\DoxyCodeLine{627     \mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}} = max(abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,1)),abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,1)),abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(3,1)),  \&}
\DoxyCodeLine{628                   abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,2)),abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(3,2)),abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(3,3)))}
\DoxyCodeLine{629 }
\DoxyCodeLine{630 \textcolor{comment}{!    write(*,*) 'CalcDred acc\_inf=',acc\_inf}}
\DoxyCodeLine{631 \textcolor{comment}{!    write(*,*) 'CalcDred Derr=',Derr}}
\DoxyCodeLine{632 }
\DoxyCodeLine{633 \textcolor{comment}{!    write(*,*) 'CalcDred adetX ',adetX,maxZadjf,maxXadj,adetZ}}
\DoxyCodeLine{634 \textcolor{comment}{!    write(*,*) 'CalcDred Zadj2ff',maxZadj2ff}}
\DoxyCodeLine{635 \textcolor{comment}{!    write(*,*) 'CalcDred maxZadj',maxZadj}}
\DoxyCodeLine{636 \textcolor{comment}{!    write(*,*) 'CalcDred Zadjf',Zadjf}}
\DoxyCodeLine{637 \textcolor{comment}{!    write(*,*) 'CalcDred f',f}}
\DoxyCodeLine{638 \textcolor{comment}{!    write(*,*) 'CalcDred Zadjff',Zadjff}}
\DoxyCodeLine{639 }
\DoxyCodeLine{640     zadj2f = 0d0}
\DoxyCodeLine{641     zadj2f(1,2,1) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)*f(3) -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)*f(2)}
\DoxyCodeLine{642     zadj2f(1,3,1) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)*f(3) + \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3)*f(2)}
\DoxyCodeLine{643     zadj2f(2,3,1) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2)*f(3) -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,3)*f(2)}
\DoxyCodeLine{644     zadj2f(1,2,2) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)*f(3) + \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,3)*f(1)}
\DoxyCodeLine{645     zadj2f(1,3,2) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)*f(3) -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,3)*f(1)}
\DoxyCodeLine{646     zadj2f(2,3,2) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)*f(3) + \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,3)*f(1)}
\DoxyCodeLine{647     zadj2f(1,2,3) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,1)*f(2) -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(3,2)*f(1)}
\DoxyCodeLine{648     zadj2f(1,3,3) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)*f(2) + \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)*f(1)}
\DoxyCodeLine{649     zadj2f(2,3,3) =  \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)*f(2) -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2)*f(1)}
\DoxyCodeLine{650     zadj2f(2,1,1) =  -\/zadj2f(1,2,1)}
\DoxyCodeLine{651     zadj2f(3,1,1) =  -\/zadj2f(1,3,1)}
\DoxyCodeLine{652     zadj2f(3,2,1) =  -\/zadj2f(2,3,1)}
\DoxyCodeLine{653     zadj2f(2,1,2) =  -\/zadj2f(1,2,2)}
\DoxyCodeLine{654     zadj2f(3,1,2) =  -\/zadj2f(1,3,2)}
\DoxyCodeLine{655     zadj2f(3,2,2) =  -\/zadj2f(2,3,2)}
\DoxyCodeLine{656     zadj2f(2,1,3) =  -\/zadj2f(1,2,3)}
\DoxyCodeLine{657     zadj2f(3,1,3) =  -\/zadj2f(1,3,3)}
\DoxyCodeLine{658     zadj2f(3,2,3) =  -\/zadj2f(2,3,3)}
\DoxyCodeLine{659 }
\DoxyCodeLine{660     maxzadj2f=maxval(abs(zadj2f))}
\DoxyCodeLine{661 }
\DoxyCodeLine{662 \textcolor{comment}{!    write(*,*) 'CalcDred Zadj2f',maxZadj2f}}
\DoxyCodeLine{663 }
\DoxyCodeLine{664 \textcolor{comment}{!    write(*,*) 'CalcDred m2scale',m2scale}}
\DoxyCodeLine{665 }
\DoxyCodeLine{666     \textcolor{comment}{!   1/sqrt(adetX) seems to describe scale of D0 well}}
\DoxyCodeLine{667     \textcolor{comment}{!   scale ratio between D0 and C0's better described by maximal scale (missing in at least one C0 function) }}
\DoxyCodeLine{668     \textcolor{comment}{!    m2scale = sqrt(adetX)/q2max}}
\DoxyCodeLine{669 }
\DoxyCodeLine{670 \textcolor{comment}{!    write(*,*) 'CalcDred m2scale',m2scale}}
\DoxyCodeLine{671 \textcolor{comment}{!    write(*,*) 'CalcDred 1/sX  ',1/sqrt(adetX)}}
\DoxyCodeLine{672 }
\DoxyCodeLine{673 \textcolor{comment}{!    Zadj2ff = Zadj2f(:,1,:)*f(1)+Zadj2f(:,2,:)*f(2)+Zadj2f(:,3,:)*f(3)}}
\DoxyCodeLine{674 }
\DoxyCodeLine{675 \textcolor{comment}{!    write(*,*) 'CalcDred Zadj2ff',Zadj2ff}}
\DoxyCodeLine{676 }
\DoxyCodeLine{677 }
\DoxyCodeLine{678     \textcolor{comment}{! quantities for modified error estimates}}
\DoxyCodeLine{679     \textcolor{comment}{! momentum weights}}
\DoxyCodeLine{680 \textcolor{comment}{!    do i = 1,3}}
\DoxyCodeLine{681 \textcolor{comment}{!      pweight(i) = max(abs(Z(i,1))/maxval(abs(Z(1:3,1))),  \&}}
\DoxyCodeLine{682 \textcolor{comment}{!          abs(Z(i,2))/maxval(abs(Z(1:3,2))),               \& }}
\DoxyCodeLine{683 \textcolor{comment}{!          abs(Z(i,3))/maxval(abs(Z(1:3,3))))}}
\DoxyCodeLine{684 \textcolor{comment}{!    end do}}
\DoxyCodeLine{685 }
\DoxyCodeLine{686 \textcolor{comment}{!    wmaxZadj = max(pweight(1)*abs(Zadj(1,1)), \&}}
\DoxyCodeLine{687 \textcolor{comment}{!        pweight(1)*abs(Zadj(1,2)),pweight(1)*abs(Zadj(1,3)),  \&}}
\DoxyCodeLine{688 \textcolor{comment}{!        pweight(2)*abs(Zadj(2,1)),pweight(3)*abs(Zadj(3,1)),  \&}}
\DoxyCodeLine{689 \textcolor{comment}{!        pweight(2)*abs(Zadj(2,3)),pweight(3)*abs(Zadj(3,2)),  \&}}
\DoxyCodeLine{690 \textcolor{comment}{!        pweight(2)*abs(Zadj(2,2)),pweight(3)*abs(Zadj(3,3)))}}
\DoxyCodeLine{691 }
\DoxyCodeLine{692 \textcolor{comment}{!    wmaxZadjf = max(pweight(1)*abs(Zadjf(1)),pweight(2)*abs(Zadjf(2)),  \&}}
\DoxyCodeLine{693 \textcolor{comment}{!        pweight(3)*abs(Zadjf(3)))}}
\DoxyCodeLine{694 }
\DoxyCodeLine{695 \textcolor{comment}{!    wmaxXadj = max(pweight(1)*abs(Xadj(1,1)),   \&}}
\DoxyCodeLine{696 \textcolor{comment}{!        pweight(1)*abs(Xadj(1,2)),pweight(1)*abs(Xadj(1,3)),  \&}}
\DoxyCodeLine{697 \textcolor{comment}{!        pweight(2)*abs(Xadj(2,1)),pweight(2)*abs(Xadj(2,3)),  \&}}
\DoxyCodeLine{698 \textcolor{comment}{!        pweight(3)*abs(Xadj(3,1)),pweight(3)*abs(Xadj(3,2)),  \&}}
\DoxyCodeLine{699 \textcolor{comment}{!        pweight(2)*abs(Xadj(2,2)),pweight(3)*abs(Xadj(3,3)))}}
\DoxyCodeLine{700 \textcolor{comment}{!    wmaxXadj = max(2d0*abs(mm02)*sqrt(adetZ*maxZadj/maxZ),maxZadj2ff*maxZadjf/(maxZadj*fmax))}}
\DoxyCodeLine{701 }
\DoxyCodeLine{702 \textcolor{comment}{!    write(*,*) 'CalcDred pweight',pweight(1:3)}}
\DoxyCodeLine{703 \textcolor{comment}{!    write(*,*) 'CalcDred wmaxZadj',maxZadj,wmaxZadj}}
\DoxyCodeLine{704 \textcolor{comment}{!    write(*,*) 'CalcDred wmaxZadjf',maxZadjf,wmaxZadjf}}
\DoxyCodeLine{705 \textcolor{comment}{!    write(*,*) 'CalcDred wmaxZadjf',maxXadj,wmaxXadj}}
\DoxyCodeLine{706 }
\DoxyCodeLine{707     \textcolor{comment}{! rough estimate for D0 to set the scale, to be improved}}
\DoxyCodeLine{708      dscale2 = max(abs(p10*p32),abs(p21*p30),abs(p20*p31),abs(m02*m02), \(\backslash\)}
\DoxyCodeLine{709               abs(m12*m12),abs(m22*m22),abs(m32*m32))}
\DoxyCodeLine{710 \textcolor{preprocessor}{\#ifdef USED0}}
\DoxyCodeLine{711 \textcolor{preprocessor}{}    d0est = max(abs(d0\_coli(p10,p21,p32,p30,p20,p31,m02,m12,m22,m32)),  \(\backslash\)}
\DoxyCodeLine{712              1d0/dscale2)}
\DoxyCodeLine{713     lerr\_d0 = .true.}
\DoxyCodeLine{714 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{715 \textcolor{preprocessor}{}\textcolor{comment}{! changed 09.09.16}}
\DoxyCodeLine{716      \textcolor{keywordflow}{if}(dscale2.ne.0d0) \textcolor{keywordflow}{then} }
\DoxyCodeLine{717        d0est = 1d0/dscale2}
\DoxyCodeLine{718      \textcolor{keywordflow}{else}}
\DoxyCodeLine{719        d0est = 1d0}
\DoxyCodeLine{720 \textcolor{keywordflow}{     end if}}
\DoxyCodeLine{721 \textcolor{comment}{!    if (adetX.ne.0d0) then}}
\DoxyCodeLine{722 \textcolor{comment}{!      D0est = 1d0/sqrt(adetX)}}
\DoxyCodeLine{723 \textcolor{comment}{!    elseif (m2max.ne.0d0) then}}
\DoxyCodeLine{724 \textcolor{comment}{!      D0est = 1d0/m2max**2}}
\DoxyCodeLine{725 \textcolor{comment}{!    else if (maxZ.ne.0d0) then}}
\DoxyCodeLine{726 \textcolor{comment}{!      D0est = 1d0/maxZ**2}}
\DoxyCodeLine{727 \textcolor{comment}{!    else}}
\DoxyCodeLine{728 \textcolor{comment}{!      D0est = 1d0 }}
\DoxyCodeLine{729 \textcolor{comment}{!    endif}}
\DoxyCodeLine{730     lerr\_d0 = .false.}
\DoxyCodeLine{731 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{732 \textcolor{preprocessor}{}    err\_inf = acc\_inf*d0est}
\DoxyCodeLine{733     dtyp = d0est}
\DoxyCodeLine{734 }
\DoxyCodeLine{735 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{736 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}.ne.0d0) \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'D0est'},1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}})}
\DoxyCodeLine{737     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_a45c0f5c169a73fb12286352743b5a557}{m2max}}.ne.0d0) \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'D0est'},1d0/\mbox{\hyperlink{namespaceglobalc_a45c0f5c169a73fb12286352743b5a557}{m2max}}**2}
\DoxyCodeLine{738     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}.ne.0d0) \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'D0est'},1d0/\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}**2}
\DoxyCodeLine{739     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'D0est'},d0est}
\DoxyCodeLine{740 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{741 \textcolor{preprocessor}{}}
\DoxyCodeLine{742     dcalc = 0}
\DoxyCodeLine{743     drcalc = 0}
\DoxyCodeLine{744     drmethod = 0}
\DoxyCodeLine{745     derr1 = err\_inf}
\DoxyCodeLine{746     derr2 = err\_inf}
\DoxyCodeLine{747     derr  = err\_inf}
\DoxyCodeLine{748     acc\_d = acc\_inf}
\DoxyCodeLine{749     dcount(0) = dcount(0)+1}
\DoxyCodeLine{750 }
\DoxyCodeLine{751     \textcolor{comment}{! error estimate of D0}}
\DoxyCodeLine{752     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}.ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{753       err\_d0 = acc\_def\_d0*max( d0est, 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}) )}
\DoxyCodeLine{754     \textcolor{keywordflow}{else}}
\DoxyCodeLine{755       err\_d0 = acc\_def\_d0*d0est}
\DoxyCodeLine{756 \textcolor{keywordflow}{    endif}     }
\DoxyCodeLine{757 }
\DoxyCodeLine{758 }
\DoxyCodeLine{759 }
\DoxyCodeLine{760     err\_req\_d = acc\_req\_d * d0est}
\DoxyCodeLine{761 }
\DoxyCodeLine{762 \textcolor{comment}{!   write(*,*) 'CalcDred err\_req ',err\_req\_D,acc\_req\_D , D0est}}
\DoxyCodeLine{763 }
\DoxyCodeLine{764     \textcolor{comment}{! estimate accuracy of PV-\/reduction}}
\DoxyCodeLine{765 \textcolor{comment}{!    if (adetZ.eq.0d0) then}}
\DoxyCodeLine{766 \textcolor{comment}{!    if (adetZ.lt.dprec\_cll*maxZ**3) then}}
\DoxyCodeLine{767     h\_pv = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{768     w\_pv = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{769     v\_pv = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{770     z\_pv = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{771 }
\DoxyCodeLine{772 \textcolor{comment}{!    if (adetZ.lt.dprec\_cll*maxZadjf.or.adetZ.eq.0d0) then}}
\DoxyCodeLine{773 \textcolor{comment}{!   14.07.2017}}
\DoxyCodeLine{774     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}.lt.dprec\_cll*\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}.or.\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}.lt.dprec\_cll*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}**3.or.\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}.eq.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{775       use\_pv = .false.}
\DoxyCodeLine{776       err\_pv = err\_inf}
\DoxyCodeLine{777     \textcolor{keywordflow}{else}}
\DoxyCodeLine{778       use\_pv = .true.}
\DoxyCodeLine{779       \textcolor{keywordflow}{if} (rmax.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{780         err\_pv(0) = err\_d0}
\DoxyCodeLine{781       \textcolor{keywordflow}{else} }
\DoxyCodeLine{782 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{783 \textcolor{preprocessor}{}        h\_pv = sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}/(\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}))}
\DoxyCodeLine{784         w\_pv = max((\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*h\_pv/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})**2, abs(mm02)*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*h\_pv/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}, \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*(h\_pv/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})**2)}
\DoxyCodeLine{785         v\_pv = \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*h\_pv/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{786         z\_pv = \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*h\_pv/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{787 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{788 \textcolor{preprocessor}{}        w\_pv = max((\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})**2, abs(mm02)*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}, \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}**2)}
\DoxyCodeLine{789         v\_pv = \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{790         z\_pv = \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{791 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{792 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (mod(rmax,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{793           err\_pv(rmax) = max( w\_pv**((rmax-\/1)/2) * v\_pv * err\_d0,  \&}
\DoxyCodeLine{794                         w\_pv**((rmax-\/1)/2) * z\_pv * err\_c0, z\_pv * err\_c(rmax-\/1) )}
\DoxyCodeLine{795 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{796 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred w\_pv: '},w\_pv,v\_pv,z\_pv,err\_d0,err\_c0,rmax}
\DoxyCodeLine{797 }
\DoxyCodeLine{798           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred err\_pv con: '},err\_pv(rmax), w\_pv**((rmax-\/1)/2) * v\_pv * err\_d0,  \&}
\DoxyCodeLine{799                         w\_pv**((rmax-\/1)/2) * z\_pv * err\_c0, z\_pv * err\_c(rmax-\/1)}
\DoxyCodeLine{800 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{801 \textcolor{preprocessor}{}        \textcolor{keywordflow}{else}}
\DoxyCodeLine{802           err\_pv(rmax) = max( w\_pv**(rmax/2) * err\_d0,  \&}
\DoxyCodeLine{803                         w\_pv**(rmax/2-\/1) * v\_pv * z\_pv * err\_c0, z\_pv * err\_c(rmax-\/1) )}
\DoxyCodeLine{804 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{805 \textcolor{preprocessor}{}         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred w\_pv: '},w\_pv,v\_pv,z\_pv}
\DoxyCodeLine{806          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred err\_pv con: '},err\_pv(rmax), w\_pv**((rmax)/2) * err\_d0,  \&}
\DoxyCodeLine{807                        w\_pv**(rmax/2-\/1) * v\_pv * z\_pv * err\_c0, z\_pv * err\_c(rmax-\/1)}
\DoxyCodeLine{808          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred err\_pv con: '},err\_pv(rmax), w\_pv**((rmax)/2),err\_d0,  \&}
\DoxyCodeLine{809                        w\_pv**(rmax/2-\/1) * v\_pv,err\_c0, z\_pv,err\_c(rmax-\/1)}
\DoxyCodeLine{810 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{811 \textcolor{preprocessor}{}\textcolor{keywordflow}{        end if}}
\DoxyCodeLine{812 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{813 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{814 }
\DoxyCodeLine{815 }
\DoxyCodeLine{816     \textcolor{comment}{! estimate accuracy of alternative PV-\/reduction}}
\DoxyCodeLine{817 \textcolor{comment}{!    if ((adetZ.eq.0).or.(adetX.eq.0)) then}}
\DoxyCodeLine{818 \textcolor{comment}{!    if ((adetZ.lt.dprec\_cll*maxZ**3).or.(adetX.lt.dprec\_cll*maxval(abs(mx))**4)) then}}
\DoxyCodeLine{819     w\_pv2 = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{820     h\_pv2 = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{821     hw\_pv2 = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{822     v\_pv2 = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{823     z\_pv2 = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{824 }
\DoxyCodeLine{825 \textcolor{comment}{!    if ((adetZ.lt.dprec\_cll*maxZadjf).or.(adetX.lt.dprec\_cll*maxval(abs(mx))*adetZ).or.adetZ.eq.0d0.or.adetX.eq.0d0) then}}
\DoxyCodeLine{826 \textcolor{comment}{!    14.07.2017   }}
\DoxyCodeLine{827     \textcolor{keywordflow}{if} ((\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}.lt.dprec\_cll*\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}).or.(\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}.lt.dprec\_cll*maxval(abs(\mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}))*\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}).or.  \&}
\DoxyCodeLine{828          (\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}.lt.dprec\_cll*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}**3).or.\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}.eq.0d0.or.\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}.eq.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{829       use\_pv2 = .false.}
\DoxyCodeLine{830       err\_pv2 = err\_inf}
\DoxyCodeLine{831     \textcolor{keywordflow}{else}}
\DoxyCodeLine{832       use\_pv2 = .true.}
\DoxyCodeLine{833       \textcolor{keywordflow}{if} (rmax.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{834         err\_pv2(0) = err\_d0}
\DoxyCodeLine{835       \textcolor{keywordflow}{else}}
\DoxyCodeLine{836         w\_pv2 = \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{837 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{838 \textcolor{preprocessor}{}        h\_pv2 = sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}/(\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}))}
\DoxyCodeLine{839         hw\_pv2 =  w\_pv2*h\_pv2}
\DoxyCodeLine{840 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{841 \textcolor{preprocessor}{}        hw\_pv2 =  w\_pv2 }
\DoxyCodeLine{842 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{843 \textcolor{preprocessor}{}        v\_pv2 = \mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{844         z\_pv2 = \mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}/\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}} }
\DoxyCodeLine{845 }
\DoxyCodeLine{846 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{847 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred w\_pv2: '},w\_pv2,v\_pv2,z\_pv2}
\DoxyCodeLine{848         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred w\_pv2: '},mod(rmax,2).eq.1}
\DoxyCodeLine{849 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{850 \textcolor{preprocessor}{}}
\DoxyCodeLine{851         \textcolor{keywordflow}{if} (mod(rmax,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{852 \textcolor{comment}{! change 21.10.15 for PVEST2}}
\DoxyCodeLine{853 \textcolor{comment}{!          err\_pv2(rmax) = max( err\_D0 * max(w\_pv2**rmax,    \&}}
\DoxyCodeLine{854 \textcolor{comment}{!               w\_pv2*v\_pv2**((rmax-\/1)/2) ),  \&}}
\DoxyCodeLine{855 \textcolor{comment}{!               err\_C0 * z\_pv2*max(w\_pv2**(rmax+1), \&}}
\DoxyCodeLine{856 \textcolor{comment}{!                                  w\_pv2*v\_pv2**((rmax-\/1)/2), \& }}
\DoxyCodeLine{857 \textcolor{comment}{!                                  v\_pv2**((rmax+1)/2)),  \&}}
\DoxyCodeLine{858 \textcolor{comment}{!               err\_C(rmax-\/1) * z\_pv2 * max(w\_pv2,w\_pv2**2,v\_pv2) )}}
\DoxyCodeLine{859           err\_pv2(rmax) = max( err\_d0 * max(hw\_pv2**rmax,    \&}
\DoxyCodeLine{860                                hw\_pv2*v\_pv2**((rmax-\/1)/2) ),  \&}
\DoxyCodeLine{861                err\_c0 * z\_pv2*max(w\_pv2*hw\_pv2**(rmax), \&}
\DoxyCodeLine{862                                   max(1d0,w\_pv2)*hw\_pv2*v\_pv2**((rmax-\/1)/2), \& }
\DoxyCodeLine{863                                   v\_pv2**((rmax+1)/2)),  \&}
\DoxyCodeLine{864                err\_c(rmax-\/1) * z\_pv2 * max(hw\_pv2,hw\_pv2*w\_pv2,v\_pv2)  )}
\DoxyCodeLine{865 }
\DoxyCodeLine{866 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{867 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred err\_pv2: '},   \&}
\DoxyCodeLine{868         err\_pv2(rmax) ,     err\_d0,err\_d0*w\_pv2**rmax,err\_d0*v\_pv2**((rmax-\/1)/2),    \&}
\DoxyCodeLine{869                                      err\_d0*w\_pv2*v\_pv2**((rmax-\/1)/2)}
\DoxyCodeLine{870        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred err\_pv2: '}  \&}
\DoxyCodeLine{871        ,err\_pv2(rmax) ,     err\_d0 * max(1d0,w\_pv2**rmax,v\_pv2**((rmax-\/1)/2),    \&}
\DoxyCodeLine{872                                    w\_pv2*v\_pv2**((rmax-\/1)/2) )  \&}
\DoxyCodeLine{873                      , err\_c0 * z\_pv2*max(w\_pv2**(rmax+1), \&}
\DoxyCodeLine{874                                w\_pv2*v\_pv2**((rmax-\/1)/2), \& }
\DoxyCodeLine{875                                v\_pv2**((rmax+1)/2))  \&}
\DoxyCodeLine{876                     ,  err\_c(rmax-\/1) * max(z\_pv2*w\_pv2, \&}
\DoxyCodeLine{877                                z\_pv2*w\_pv2**2,z\_pv2*v\_pv2) }
\DoxyCodeLine{878         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred err\_pv2: '},   \&}
\DoxyCodeLine{879                        err\_c0 * z\_pv2*w\_pv2**(rmax+1), \&}
\DoxyCodeLine{880                         err\_c0 * z\_pv2* w\_pv2*v\_pv2**((rmax-\/1)/2), \& }
\DoxyCodeLine{881                        err\_c0 * z\_pv2*  v\_pv2**((rmax+1)/2)    ,  \&}
\DoxyCodeLine{882                        err\_c0}
\DoxyCodeLine{883 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{884 \textcolor{preprocessor}{}}
\DoxyCodeLine{885         \textcolor{keywordflow}{else}}
\DoxyCodeLine{886 \textcolor{comment}{! change 21.10.15 for PVEST2}}
\DoxyCodeLine{887 \textcolor{comment}{!          err\_pv2(rmax) = max( err\_D0 * max(w\_pv2**rmax,v\_pv2**(rmax/2)),  \& }}
\DoxyCodeLine{888 \textcolor{comment}{!                err\_C0 * z\_pv2 * max(w\_pv2**(rmax+1),  \&}}
\DoxyCodeLine{889 \textcolor{comment}{!                         v\_pv2**(rmax/2),w\_pv2*v\_pv2**(rmax/2)), \&}}
\DoxyCodeLine{890 \textcolor{comment}{!                err\_C(rmax-\/1) * z\_pv2 * max(w\_pv2, w\_pv2**2, v\_pv2) )}}
\DoxyCodeLine{891           err\_pv2(rmax) = max( err\_d0 * max(hw\_pv2**rmax,v\_pv2**(rmax/2)),  \& }
\DoxyCodeLine{892                 err\_c0 * z\_pv2 * max(w\_pv2*hw\_pv2**(rmax),  \&}
\DoxyCodeLine{893                          v\_pv2**(rmax/2),w\_pv2*v\_pv2**(rmax/2)), \&}
\DoxyCodeLine{894                 err\_c(rmax-\/1) * z\_pv2 * max(hw\_pv2,hw\_pv2*w\_pv2, v\_pv2) )}
\DoxyCodeLine{895                                   }
\DoxyCodeLine{896 }
\DoxyCodeLine{897 \textcolor{comment}{!         write(*,*) 'CalcDred err\_pv2: ',   \&}}
\DoxyCodeLine{898 \textcolor{comment}{!         err\_pv2(rmax) , err\_D0 * max(1d0,w\_pv2**rmax,v\_pv2**(rmax/2)),  \&}}
\DoxyCodeLine{899 \textcolor{comment}{!                        err\_C0 * z\_pv2 * max(w\_pv2**(rmax+1),  \&}}
\DoxyCodeLine{900 \textcolor{comment}{!                                 v\_pv2**(rmax/2),w\_pv2*v\_pv2**(rmax/2)), \&}}
\DoxyCodeLine{901 \textcolor{comment}{!                        err\_C(rmax-\/1) * max(1d0,z\_pv2*w\_pv2,  \&}}
\DoxyCodeLine{902 \textcolor{comment}{!                                 z\_pv2*w\_pv2**2,z\_pv2*v\_pv2)}}
\DoxyCodeLine{903 \textcolor{comment}{!         write(*,*) 'CalcDred err\_pv2: ',   \&}}
\DoxyCodeLine{904 \textcolor{comment}{!                        err\_C0 * z\_pv2 * w\_pv2**(rmax+1),  \&}}
\DoxyCodeLine{905 \textcolor{comment}{!                        err\_C0 * z\_pv2 *          v\_pv2**(rmax/2), \&}}
\DoxyCodeLine{906 \textcolor{comment}{!                        err\_C0 * z\_pv2 * w\_pv2*v\_pv2**(rmax/2), \&}}
\DoxyCodeLine{907 \textcolor{comment}{!                        err\_C0}}
\DoxyCodeLine{908 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{909 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{910 \textcolor{keywordflow}{    end if} }
\DoxyCodeLine{911 }
\DoxyCodeLine{912     \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{913     err\_pv(rmax)  = err\_pv(rmax)/impest\_d}
\DoxyCodeLine{914     err\_pv2(rmax) = err\_pv2(rmax)/impest\_d     }
\DoxyCodeLine{915 }
\DoxyCodeLine{916 \textcolor{comment}{!    write(*,*) 'CalcDred err\_pv: ',err\_pv, w\_pv**((rmax-\/1)/2) * v\_pv * err\_D0,  \&}}
\DoxyCodeLine{917 \textcolor{comment}{!                        w\_pv**((rmax-\/1)/2) * z\_pv * err\_C0, z\_pv * err\_C(rmax-\/1)}}
\DoxyCodeLine{918 }
\DoxyCodeLine{919 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{920 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: err\_pv'},err\_pv(rmax),err\_pv2(rmax),err\_req\_d}
\DoxyCodeLine{921     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: acc\_pv'},err\_pv(rmax)/d0est,err\_pv2(rmax)/d0est,acc\_req\_d}
\DoxyCodeLine{922 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{923 \textcolor{preprocessor}{}}
\DoxyCodeLine{924 \textcolor{preprocessor}{\#ifdef TEST}}
\DoxyCodeLine{925 \textcolor{preprocessor}{}  use\_pv = .false.}
\DoxyCodeLine{926   use\_pv2 = .false.}
\DoxyCodeLine{927   use\_pv = .true.}
\DoxyCodeLine{928 \textcolor{comment}{!  use\_pv2 = .true.}}
\DoxyCodeLine{929   err\_pv2(rmax) = 1d30}
\DoxyCodeLine{930 \textcolor{comment}{!  err\_pv(rmax) = 1d30}}
\DoxyCodeLine{931 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{932 \textcolor{preprocessor}{}}
\DoxyCodeLine{933 }
\DoxyCodeLine{934 \textcolor{comment}{!    Dtyp = real(undefined\_D)}}
\DoxyCodeLine{935     dtyp = d0est}
\DoxyCodeLine{936 \textcolor{preprocessor}{\#ifdef ALWAYSPV}}
\DoxyCodeLine{937 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if}(use\_pv.or.use\_pv2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{938 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{939 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (min(err\_pv(rmax),err\_pv2(rmax)).le.err\_req\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{940 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{941 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if} (err\_pv(rmax).le.err\_pv2(rmax)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{942 }
\DoxyCodeLine{943 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{944 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: call Dpv 1 '},rmax,id,err\_pv(rmax)}
\DoxyCodeLine{945 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{946 \textcolor{preprocessor}{}}
\DoxyCodeLine{947         \textcolor{comment}{! use PV-\/reduction if appropriate}}
\DoxyCodeLine{948         \textcolor{keyword}{call }calcdpv1(d,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,rmax,id,derr1,derr2)}
\DoxyCodeLine{949 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{950 \textcolor{preprocessor}{}        derr = derr2}
\DoxyCodeLine{951 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{952 \textcolor{preprocessor}{}        derr = derr1}
\DoxyCodeLine{953 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{954 \textcolor{preprocessor}{}}
\DoxyCodeLine{955         dcount(1) = dcount(1)+1}
\DoxyCodeLine{956         drcalc(0:rmax) = drcalc(0:rmax)+1}
\DoxyCodeLine{957         dcalc = dcalc+1}
\DoxyCodeLine{958         drmethod(0:rmax) = 1}
\DoxyCodeLine{959 \textcolor{comment}{!        err\_D = err\_pv}}
\DoxyCodeLine{960 }
\DoxyCodeLine{961 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{962 \textcolor{preprocessor}{}        checkest=derr(rmax)/err\_pv(rmax)}
\DoxyCodeLine{963         \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_d.or.checkest.lt.1d-\/2*impest\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{964           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: estimate err\_pv imprecise'},err\_pv(rmax),derr(rmax)}
\DoxyCodeLine{965 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{966 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{967 \textcolor{preprocessor}{}}
\DoxyCodeLine{968         err\_pv=derr}
\DoxyCodeLine{969 }
\DoxyCodeLine{970       \textcolor{keywordflow}{else}}
\DoxyCodeLine{971 }
\DoxyCodeLine{972 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{973 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: call Dpv2 1'},rmax,id,err\_pv2(rmax)}
\DoxyCodeLine{974 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{975 \textcolor{preprocessor}{}}
\DoxyCodeLine{976         \textcolor{comment}{! use alternative PV-\/reduction if appropriate}}
\DoxyCodeLine{977         \textcolor{keyword}{call }calcdpv2(d,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,rmax,id,derr1,derr2)}
\DoxyCodeLine{978 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{979 \textcolor{preprocessor}{}        derr = derr2}
\DoxyCodeLine{980 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{981 \textcolor{preprocessor}{}        derr = derr1}
\DoxyCodeLine{982 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{983 \textcolor{preprocessor}{}        dcount(2) = dcount(2)+1}
\DoxyCodeLine{984         drcalc(0:rmax)=drcalc(0:rmax)+2}
\DoxyCodeLine{985         dcalc = dcalc+2}
\DoxyCodeLine{986         drmethod(0:rmax)=2}
\DoxyCodeLine{987 }
\DoxyCodeLine{988 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{989 \textcolor{preprocessor}{}        checkest=derr(rmax)/err\_pv2(rmax)}
\DoxyCodeLine{990         \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_d.or.checkest.lt.1d-\/2*impest\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{991           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: estimate err\_pv2 imprecise'},err\_pv2(rmax),derr(rmax)}
\DoxyCodeLine{992 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{993 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{994 \textcolor{preprocessor}{}        err\_pv2=derr}
\DoxyCodeLine{995 }
\DoxyCodeLine{996 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{997 }
\DoxyCodeLine{998 \textcolor{preprocessor}{\#ifndef USED0}}
\DoxyCodeLine{999 \textcolor{preprocessor}{}      \textcolor{comment}{! refine error estimate for D0}}
\DoxyCodeLine{1000 \textcolor{comment}{!      D0est =  abs(D(0,0,0,0))}}
\DoxyCodeLine{1001       err\_d0 = acc\_def\_d0*max( abs(d(0,0,0,0)), 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}) )}
\DoxyCodeLine{1002       err\_req\_d = acc\_req\_d * abs(d(0,0,0,0))}
\DoxyCodeLine{1003       lerr\_d0 = .true.}
\DoxyCodeLine{1004 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1005 \textcolor{preprocessor}{}}
\DoxyCodeLine{1006       \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1007         dtyp =  max(abs(d(0,0,0,0)),        \&}
\DoxyCodeLine{1008                abs(d(0,1,0,0)),abs(d(0,0,1,0)),abs(d(0,0,0,1)))}
\DoxyCodeLine{1009       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1010         dtyp =  abs(d(0,0,0,0))}
\DoxyCodeLine{1011 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1012       \textcolor{keywordflow}{if}(dtyp.eq.0d0) dtyp = d0est}
\DoxyCodeLine{1013       err\_req\_d = acc\_req\_d * dtyp}
\DoxyCodeLine{1014 }
\DoxyCodeLine{1015 }
\DoxyCodeLine{1016 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1017 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Derr1 after PV = '},derr1}
\DoxyCodeLine{1018 \textcolor{comment}{!      write(*,*) 'CalcDred Dacc1 after PV = ',Derr1/abs(D(0,0,0,0))}}
\DoxyCodeLine{1019       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Dacc1 after PV = '},derr1/dtyp}
\DoxyCodeLine{1020       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred err1\_D'},derr1(rmax)}
\DoxyCodeLine{1021       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Derr2 after PV = '},derr2}
\DoxyCodeLine{1022 \textcolor{comment}{!      write(*,*) 'CalcDred Dacc2 after PV = ',Derr2/abs(D(0,0,0,0))}}
\DoxyCodeLine{1023       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred Dacc2 after PV = '},derr2/dtyp}
\DoxyCodeLine{1024       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred err2\_D'},derr2(rmax)}
\DoxyCodeLine{1025 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1026 \textcolor{preprocessor}{}}
\DoxyCodeLine{1027 \textcolor{comment}{!  Derr = Derr2 might lead to imprecise results}}
\DoxyCodeLine{1028       \textcolor{keywordflow}{if} (derr1(rmax).lt.err\_req\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1029         dcount(dcalc+dcountoffset0) = dcount(dcalc+dcountoffset0)+1}
\DoxyCodeLine{1030         \textcolor{keywordflow}{return}}
\DoxyCodeLine{1031 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1032 }
\DoxyCodeLine{1033     \textcolor{keywordflow}{else}   \textcolor{comment}{!  added 14.07.2017}}
\DoxyCodeLine{1034       d = 0d0}
\DoxyCodeLine{1035       duv = 0d0}
\DoxyCodeLine{1036       derr1 = err\_inf}
\DoxyCodeLine{1037       derr2 = err\_inf}
\DoxyCodeLine{1038 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{1039 }
\DoxyCodeLine{1040 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1041 \textcolor{preprocessor}{}\textcolor{comment}{!   return}}
\DoxyCodeLine{1042 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1043 \textcolor{preprocessor}{}}
\DoxyCodeLine{1044 \textcolor{comment}{!    allocate(D\_alt(0:rmax,0:rmax,0:rmax,0:rmax))}}
\DoxyCodeLine{1045 \textcolor{comment}{!    allocate(Duv\_alt(0:rmax,0:rmax,0:rmax,0:rmax))}}
\DoxyCodeLine{1046 \textcolor{comment}{!    allocate(Derr1\_alt(0:rmax))}}
\DoxyCodeLine{1047 \textcolor{comment}{!    allocate(Derr2\_alt(0:rmax))}}
\DoxyCodeLine{1048 \textcolor{comment}{!    allocate(Drmethod\_alt(0:rmax))}}
\DoxyCodeLine{1049 }
\DoxyCodeLine{1050     \textcolor{comment}{! choose most promising expansion scheme}}
\DoxyCodeLine{1051     \textcolor{comment}{! Gram expansion    }}
\DoxyCodeLine{1052 \textcolor{comment}{!    if (maxZadjf.ne.0d0) then}}
\DoxyCodeLine{1053     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}.gt.\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}**3*dprec\_cll) \textcolor{keywordflow}{then}   \textcolor{comment}{!  10.07.2017}}
\DoxyCodeLine{1054       x\_g = \mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}/\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}}
\DoxyCodeLine{1055 \textcolor{comment}{!      u\_g = max(1d0,maxZadj2ff/maxZadjf/4d0,abs(mm02)*maxZadj/maxZadjf/4d0)}}
\DoxyCodeLine{1056 \textcolor{comment}{! 03.03.15   large P counts!}}
\DoxyCodeLine{1057 \textcolor{comment}{!      u\_g = max(1d0,maxZadj2ff/maxZadjf/2d0,abs(mm02)*maxZadj/maxZadjf/2d0)}}
\DoxyCodeLine{1058 \textcolor{comment}{! 24.04.15  term appear only combined}}
\DoxyCodeLine{1059       u\_g = max(1d0,\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}/\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/2d0)}
\DoxyCodeLine{1060       \mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}} = x\_g*u\_g}
\DoxyCodeLine{1061       err\_g = err\_inf}
\DoxyCodeLine{1062       g = -\/1}
\DoxyCodeLine{1063       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}}.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1064         use\_g = .false.}
\DoxyCodeLine{1065         err\_g\_exp = err\_inf}
\DoxyCodeLine{1066         err\_g\_c = err\_c(rmax)         \textcolor{comment}{! dummy}}
\DoxyCodeLine{1067         err\_g\_cr = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1068         z\_g = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1069       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1070         use\_g = .true.}
\DoxyCodeLine{1071 \textcolor{comment}{!       z\_g = max(1d0,m2scale*maxZadj/maxZadjf)}}
\DoxyCodeLine{1072         z\_g = \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}}
\DoxyCodeLine{1073         err\_g\_cr = max( err\_c(rmax), err\_c0 * u\_g**rmax ) * z\_g }
\DoxyCodeLine{1074         err\_g\_c = err\_g\_cr}
\DoxyCodeLine{1075         err\_g\_exp = u\_g**(rmax-\/1) * dtyp}
\DoxyCodeLine{1076 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1077     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1078       use\_g = .false.}
\DoxyCodeLine{1079       err\_g = err\_inf}
\DoxyCodeLine{1080       g = -\/1}
\DoxyCodeLine{1081       err\_g\_exp = err\_inf}
\DoxyCodeLine{1082       err\_g\_c = err\_c(rmax)         \textcolor{comment}{! dummy}}
\DoxyCodeLine{1083       u\_g = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1084       z\_g = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1085       err\_g\_cr = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1086 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{1087 }
\DoxyCodeLine{1088 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1089 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after Gram pars'},use\_g,\mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}},x\_g,u\_g,z\_g,err\_g\_cr,err\_c(rmax),err\_c0,err\_g\_exp}
\DoxyCodeLine{1090 \textcolor{comment}{!    write(*,*) 'CalcDred: after Gram pars',adetZ,maxZadjf,maxXadj,maxZ}}
\DoxyCodeLine{1091     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after Gram pars'},err\_c(rmax), err\_c0 * u\_g**rmax }
\DoxyCodeLine{1092 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1093 \textcolor{preprocessor}{}}
\DoxyCodeLine{1094 \textcolor{preprocessor}{\#ifdef USEGM}}
\DoxyCodeLine{1095 \textcolor{preprocessor}{}    \textcolor{comment}{! modified Gram expansion    }}
\DoxyCodeLine{1096 \textcolor{comment}{!   if (aZadjff.ne.0d0) then}}
\DoxyCodeLine{1097     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}.gt.\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}**4*dprec\_cll) \textcolor{keywordflow}{then}   \textcolor{comment}{!  10.07.2017}}
\DoxyCodeLine{1098       \mbox{\hyperlink{namespaceglobald_aefbd3281b672edaf16cfc1c91f64ff77}{x\_gm}} = \mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}/\mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}}
\DoxyCodeLine{1099 \textcolor{comment}{!      u\_gm = max(1d0,maxZadj2ff/maxZadjf/4d0,abs(mm02)*maxZadj/maxZadjf/4d0)}}
\DoxyCodeLine{1100 \textcolor{comment}{! 03.03.15   large P counts!}}
\DoxyCodeLine{1101 \textcolor{comment}{!      u\_gm = max(1d0,maxZadj2ff/maxZadjf/2d0,abs(mm02)*maxZadj/maxZadjf/2d0)}}
\DoxyCodeLine{1102 \textcolor{comment}{! 24.04.15  term appear only combined}}
\DoxyCodeLine{1103       u\_gm = max(1d0,\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}/\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/2d0)}
\DoxyCodeLine{1104       \mbox{\hyperlink{namespaceglobald_af592a0bdf2d43f6fa584350670853b8e}{fac\_gm}} = \mbox{\hyperlink{namespaceglobald_aefbd3281b672edaf16cfc1c91f64ff77}{x\_gm}}*u\_gm}
\DoxyCodeLine{1105       err\_gm = err\_inf}
\DoxyCodeLine{1106       gm = -\/1}
\DoxyCodeLine{1107       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobald_af592a0bdf2d43f6fa584350670853b8e}{fac\_gm}}.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1108         use\_gm = .false.}
\DoxyCodeLine{1109         err\_gm\_exp = err\_inf}
\DoxyCodeLine{1110         err\_gm\_c = err\_c(rmax)         \textcolor{comment}{! dummy}}
\DoxyCodeLine{1111       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1112         use\_gm = .true.}
\DoxyCodeLine{1113 \textcolor{comment}{!       z\_gm = max(1d0,m2scale*maxZadj/maxZadjf)}}
\DoxyCodeLine{1114         z\_gm = \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}}
\DoxyCodeLine{1115         err\_gm\_cr = max( err\_c(rmax), err\_c0 * u\_gm**rmax ) * z\_gm }
\DoxyCodeLine{1116         err\_gm\_c = err\_gm\_cr}
\DoxyCodeLine{1117         err\_gm\_exp = u\_gm**(rmax-\/1) * dtyp}
\DoxyCodeLine{1118 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1119     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1120       use\_gm = .false.}
\DoxyCodeLine{1121       err\_gm = err\_inf}
\DoxyCodeLine{1122       gm = -\/1}
\DoxyCodeLine{1123       err\_gm\_exp = err\_inf}
\DoxyCodeLine{1124       err\_gm\_c = err\_c(rmax)         \textcolor{comment}{! dummy}}
\DoxyCodeLine{1125 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{1126 }
\DoxyCodeLine{1127 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1128 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after mod Gram pars'},use\_gm,\mbox{\hyperlink{namespaceglobald_af592a0bdf2d43f6fa584350670853b8e}{fac\_gm}},\mbox{\hyperlink{namespaceglobald_aefbd3281b672edaf16cfc1c91f64ff77}{x\_gm}},u\_gm,z\_gm,err\_gm\_cr,err\_c(rmax),err\_c0,err\_gm\_exp}
\DoxyCodeLine{1129 \textcolor{comment}{!    write(*,*) 'CalcDred: after mod Gram pars',1d0,maxZadj2ff/maxZadjf,abs(mm02)*maxZadj/maxZadjf}}
\DoxyCodeLine{1130     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after mod Gram pars'},err\_c(rmax), err\_c0 * u\_gm**rmax }
\DoxyCodeLine{1131     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after mod Gram pars'},  \mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}},\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}},\mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}}
\DoxyCodeLine{1132 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1133 \textcolor{preprocessor}{}}
\DoxyCodeLine{1134 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1135 \textcolor{preprocessor}{}      use\_gm = .false.}
\DoxyCodeLine{1136       err\_gm = err\_inf}
\DoxyCodeLine{1137       gm = -\/1 }
\DoxyCodeLine{1138       err\_gm\_exp = err\_inf}
\DoxyCodeLine{1139       err\_gm\_c = err\_c(rmax)         \textcolor{comment}{! dummy}}
\DoxyCodeLine{1140 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1141 \textcolor{preprocessor}{}}
\DoxyCodeLine{1142     \textcolor{comment}{! Gram-\/Cayley expansion}}
\DoxyCodeLine{1143 \textcolor{comment}{!    if (maxXadj.ne.0d0.and.maxZadj.ne.0) then}}
\DoxyCodeLine{1144     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}.gt.\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}**3*dprec\_cll.and.\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}.gt.\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}*dprec\_cll) \textcolor{keywordflow}{then}   \textcolor{comment}{!  10.07.2017}}
\DoxyCodeLine{1145       x\_gy = \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}}
\DoxyCodeLine{1146       y\_gy = \mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}/\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}}
\DoxyCodeLine{1147       v\_gy = maxzadj2f/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}}
\DoxyCodeLine{1148       v1\_gy = max(1d0,v\_gy)}
\DoxyCodeLine{1149       \mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}} = max(x\_gy,y\_gy)*v1\_gy}
\DoxyCodeLine{1150       err\_gy = err\_inf}
\DoxyCodeLine{1151       gy = -\/1}
\DoxyCodeLine{1152       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}}.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1153         use\_gy = .false.}
\DoxyCodeLine{1154         err\_gy\_exp = err\_inf}
\DoxyCodeLine{1155         err\_gy\_c = err\_c(rmax+1)         \textcolor{comment}{! dummy}}
\DoxyCodeLine{1156         err\_gy\_cr = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1157         b\_gy = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1158       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1159         use\_gy = .true.}
\DoxyCodeLine{1160 \textcolor{comment}{!       b\_gy = max(1d0,m2scale*maxZadj/maxXadj)}}
\DoxyCodeLine{1161         b\_gy = \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}}
\DoxyCodeLine{1162         err\_gy\_cr =  max( err\_c(rmax) * v1\_gy, err\_c(rmax+1) ) }
\DoxyCodeLine{1163         err\_gy\_c = err\_gy\_cr * b\_gy}
\DoxyCodeLine{1164         err\_gy\_exp = 1d0 * dtyp}
\DoxyCodeLine{1165 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1166     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1167       use\_gy = .false.}
\DoxyCodeLine{1168       err\_gy = err\_inf}
\DoxyCodeLine{1169       gy = -\/1}
\DoxyCodeLine{1170       err\_gy\_exp = err\_inf}
\DoxyCodeLine{1171       err\_gy\_c = err\_c(rmax+1)         \textcolor{comment}{! dummy}}
\DoxyCodeLine{1172       v1\_gy = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1173       b\_gy = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1174       err\_gy\_cr = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1175 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{1176 }
\DoxyCodeLine{1177 }
\DoxyCodeLine{1178 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1179 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after GramCay pars'},use\_gy,\mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}},x\_gy,y\_gy,v\_gy,b\_gy,err\_gy\_cr,err\_gy\_exp}
\DoxyCodeLine{1180     \textcolor{keywordflow}{if} (use\_gy) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1181       \textcolor{keyword}{write}(*,*)  \textcolor{stringliteral}{'CalcDred: after GramCay pars'},\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}},1/v\_gy,1/v\_gy*\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}},1/v\_gy*\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*x\_gy}
\DoxyCodeLine{1182 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{1183 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1184 \textcolor{preprocessor}{}}
\DoxyCodeLine{1185     \textcolor{comment}{! expansion in small momenta}}
\DoxyCodeLine{1186 \textcolor{comment}{!    if (fmax.ne.0d0) then}}
\DoxyCodeLine{1187     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}.gt.\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}*dprec\_cll) \textcolor{keywordflow}{then}   \textcolor{comment}{!  10.07.2017}}
\DoxyCodeLine{1188       w\_gp = \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}                        \textcolor{comment}{! was q2max}}
\DoxyCodeLine{1189       v\_gp = abs(mm02/\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}})}
\DoxyCodeLine{1190       v1\_gp = max(1d0,v\_gp)}
\DoxyCodeLine{1191       \mbox{\hyperlink{namespaceglobalc_ac6e3d986b3c7aa2041225441a07dddb6}{fac\_gp}} = w\_gp*v1\_gp}
\DoxyCodeLine{1192       err\_gp = err\_inf}
\DoxyCodeLine{1193       gp = -\/1}
\DoxyCodeLine{1194       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_ac6e3d986b3c7aa2041225441a07dddb6}{fac\_gp}}.ge.1d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1195         use\_gp = .false.}
\DoxyCodeLine{1196         err\_gp\_exp = err\_inf}
\DoxyCodeLine{1197         err\_gp\_c = err\_c(rmax)  \textcolor{comment}{! dummy}}
\DoxyCodeLine{1198         err\_gp\_cr = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1199         z\_gp = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1200       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1201         use\_gp = .true.}
\DoxyCodeLine{1202 \textcolor{comment}{!       z\_gp = max(1d0,m2scale/fmax)}}
\DoxyCodeLine{1203         z\_gp = 1d0/\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}}
\DoxyCodeLine{1204         err\_gp\_cr = max(err\_c0 * v\_gp**rmax , err\_c(rmax)) *  z\_gp}
\DoxyCodeLine{1205         err\_gp\_c = err\_gp\_cr}
\DoxyCodeLine{1206         err\_gp\_exp = v1\_gp**(rmax-\/1) * dtyp}
\DoxyCodeLine{1207 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1208     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1209       use\_gp = .false.}
\DoxyCodeLine{1210       err\_gp = err\_inf}
\DoxyCodeLine{1211       gp = -\/1}
\DoxyCodeLine{1212       err\_gp\_exp = err\_inf}
\DoxyCodeLine{1213       err\_gp\_c = err\_c(rmax)  \textcolor{comment}{! dummy}}
\DoxyCodeLine{1214       v1\_gp = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1215       v\_gp = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1216       z\_gp = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1217       err\_gp\_cr = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1218 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{1219 }
\DoxyCodeLine{1220 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1221 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after Mom pars'},use\_gp,\mbox{\hyperlink{namespaceglobalc_ac6e3d986b3c7aa2041225441a07dddb6}{fac\_gp}},w\_gp,v\_gp,z\_gp,err\_gp\_cr,err\_gp\_exp}
\DoxyCodeLine{1222 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1223 \textcolor{preprocessor}{}}
\DoxyCodeLine{1224     \textcolor{comment}{! reversed Gram expansion}}
\DoxyCodeLine{1225 \textcolor{comment}{!    if (maxZadjf.ne.0d0.and.maxZadj2f.ne.0d0) then}}
\DoxyCodeLine{1226     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}.gt.\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}**3*dprec\_cll.and.maxzadj2f.gt.\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}**2*dprec\_cll) \textcolor{keywordflow}{then}   \textcolor{comment}{!  10.07.2017}}
\DoxyCodeLine{1227       x\_gr = \mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}/\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}}
\DoxyCodeLine{1228       y\_gr = \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/maxzadj2f              \textcolor{comment}{! c*y    c=2}}
\DoxyCodeLine{1229       y1\_gr = max(1d0,y\_gr)}
\DoxyCodeLine{1230       a\_gr = \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}}
\DoxyCodeLine{1231       \mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}} = max(x\_gr,y\_gr)}
\DoxyCodeLine{1232       err\_gr = err\_inf}
\DoxyCodeLine{1233       gr = -\/1}
\DoxyCodeLine{1234       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}}.ge.1.or.2*rmax.gt.rmax\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1235         use\_gr = .false.}
\DoxyCodeLine{1236         err\_gr\_exp = err\_inf}
\DoxyCodeLine{1237         err\_gr\_c = err\_c(rmax)   \textcolor{comment}{! dummy}}
\DoxyCodeLine{1238         err\_gr\_cr = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1239       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1240         use\_gr = .true.}
\DoxyCodeLine{1241         err\_gr\_cr = err\_c(rmax) }
\DoxyCodeLine{1242         err\_gr\_c = err\_gr\_cr * a\_gr}
\DoxyCodeLine{1243         err\_gr\_exp = y1\_gr * dtyp}
\DoxyCodeLine{1244 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1245     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1246       use\_gr = .false.}
\DoxyCodeLine{1247       err\_gr = err\_inf}
\DoxyCodeLine{1248       gr = -\/1}
\DoxyCodeLine{1249       err\_gr\_exp = err\_inf}
\DoxyCodeLine{1250       err\_gr\_c = err\_c(rmax)   \textcolor{comment}{! dummy}}
\DoxyCodeLine{1251       a\_gr = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1252       y\_gr = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1253       y1\_gr = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1254       err\_gr\_cr = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1255 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{1256 }
\DoxyCodeLine{1257 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1258 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after revGram pars'},use\_gr,\mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}},x\_gr,y\_gr,y1\_gr,a\_gr,err\_gr\_cr,err\_c(rmax),err\_c0,err\_gr\_exp}
\DoxyCodeLine{1259     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after revGram pars'},err\_gr\_c,dtyp}
\DoxyCodeLine{1260 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1261 \textcolor{preprocessor}{}}
\DoxyCodeLine{1262     \textcolor{comment}{! expansion in small momenta and f's}}
\DoxyCodeLine{1263 \textcolor{comment}{!  estimates to be confirmed 16.08.17, r dependence may be different}}
\DoxyCodeLine{1264 \textcolor{comment}{!  since D\_mni... is needed in contrast to Dgy expansion}}
\DoxyCodeLine{1265     \textcolor{keywordflow}{if} (abs(m02).gt.\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}*dprec\_cll) \textcolor{keywordflow}{then} }
\DoxyCodeLine{1266       x\_gpf = \mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}/abs(m02)}
\DoxyCodeLine{1267       y\_gpf = \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/abs(m02)}
\DoxyCodeLine{1268       v\_gpf = 0d0}
\DoxyCodeLine{1269       v1\_gpf = max(1d0,v\_gpf)}
\DoxyCodeLine{1270       \mbox{\hyperlink{namespaceglobalc_a92c2feddeb644af9e797691976e9143b}{fac\_gpf}} = max(x\_gpf,y\_gpf)}
\DoxyCodeLine{1271       err\_gpf = err\_inf}
\DoxyCodeLine{1272       gpf = -\/1}
\DoxyCodeLine{1273       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_a92c2feddeb644af9e797691976e9143b}{fac\_gpf}}.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1274         use\_gpf = .false.}
\DoxyCodeLine{1275         err\_gpf\_exp = err\_inf}
\DoxyCodeLine{1276         err\_gpf\_c = err\_c(rmax+1)         \textcolor{comment}{! dummy}}
\DoxyCodeLine{1277         err\_gpf\_cr = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1278         b\_gpf = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1279       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1280         use\_gpf = .true.}
\DoxyCodeLine{1281         b\_gpf = 1d0/abs(m02)}
\DoxyCodeLine{1282         err\_gpf\_cr =  max( err\_c(rmax), err\_c(rmax+1) ) }
\DoxyCodeLine{1283         err\_gpf\_c = err\_gpf\_cr * b\_gpf}
\DoxyCodeLine{1284         err\_gpf\_exp = 1d0 * dtyp}
\DoxyCodeLine{1285 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1286     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1287       use\_gpf = .false.}
\DoxyCodeLine{1288       err\_gpf = err\_inf}
\DoxyCodeLine{1289       gpf = -\/1}
\DoxyCodeLine{1290       err\_gpf\_exp = err\_inf}
\DoxyCodeLine{1291       err\_gpf\_c = err\_c(rmax+1)         \textcolor{comment}{! dummy}}
\DoxyCodeLine{1292       b\_gpf = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1293       err\_gpf\_cr = real(\mbox{\hyperlink{namespaceglobald_ab2ab85506acfe18e53cad65329884001}{undefined\_d}})}
\DoxyCodeLine{1294 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{1295 }
\DoxyCodeLine{1296 }
\DoxyCodeLine{1297 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1298 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after pf pars'},use\_gpf,\mbox{\hyperlink{namespaceglobalc_a92c2feddeb644af9e797691976e9143b}{fac\_gpf}},x\_gpf,y\_gpf,v\_gpf,b\_gpf,err\_gpf\_cr,err\_gpf\_exp,err\_gpf}
\DoxyCodeLine{1299     \textcolor{keywordflow}{if} (use\_gpf) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1300       \textcolor{keyword}{write}(*,*)  \textcolor{stringliteral}{'CalcDred: after pf pars'},\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}},1/v\_gpf,1/v\_gpf*\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}},1/v\_gpf*\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*x\_gpf}
\DoxyCodeLine{1301 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{1302 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1303 \textcolor{preprocessor}{}}
\DoxyCodeLine{1304 \textcolor{comment}{! no method works}}
\DoxyCodeLine{1305     \textcolor{keywordflow}{if}(use\_pv.or.use\_pv2.or.use\_g.or.use\_gy.or.use\_gp.or.use\_gr.or.use\_gm.or.use\_gpf.eqv..false.) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1306       \textcolor{keyword}{call }seterrflag\_coli(-\/6)}
\DoxyCodeLine{1307       \textcolor{keyword}{call }errout\_coli(\textcolor{stringliteral}{'CalcDred'},\textcolor{stringliteral}{' no reduction method works'},  \&}
\DoxyCodeLine{1308          errorwriteflag)}
\DoxyCodeLine{1309 \textcolor{comment}{!      write(nerrout\_coli,'((a))')  '  no reduction method works'}}
\DoxyCodeLine{1310       \textcolor{keywordflow}{if} (errorwriteflag) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1311         \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcDred: p10 = '},p10}
\DoxyCodeLine{1312         \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcDred: p21 = '},p21}
\DoxyCodeLine{1313         \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcDred: p32 = '},p32}
\DoxyCodeLine{1314         \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcDred: p30 = '},p30}
\DoxyCodeLine{1315         \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcDred: p20 = '},p20}
\DoxyCodeLine{1316         \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcDred: p31 = '},p31}
\DoxyCodeLine{1317         \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcDred: m02 = '},m02}
\DoxyCodeLine{1318         \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcDred: m12 = '},m12}
\DoxyCodeLine{1319         \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcDred: m22 = '},m22   }
\DoxyCodeLine{1320         \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcDred: m32 = '},m32   }
\DoxyCodeLine{1321 \textcolor{keywordflow}{      end if} }
\DoxyCodeLine{1322       d = 0d0}
\DoxyCodeLine{1323       duv = 0d0}
\DoxyCodeLine{1324       derr1 = err\_inf}
\DoxyCodeLine{1325       derr2 = err\_inf}
\DoxyCodeLine{1326 }
\DoxyCodeLine{1327 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1328 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: exit'}}
\DoxyCodeLine{1329 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1330 \textcolor{preprocessor}{}}
\DoxyCodeLine{1331       \textcolor{keywordflow}{return}}
\DoxyCodeLine{1332 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{1333 }
\DoxyCodeLine{1334 \textcolor{preprocessor}{\#ifdef TEST}}
\DoxyCodeLine{1335 \textcolor{preprocessor}{}\textcolor{comment}{! switched off for testing}}
\DoxyCodeLine{1336     use\_g  = .false.}
\DoxyCodeLine{1337 \textcolor{comment}{!    use\_gy = .false.}}
\DoxyCodeLine{1338     use\_gp = .false.}
\DoxyCodeLine{1339     use\_gr = .false.}
\DoxyCodeLine{1340 \textcolor{comment}{!    use\_gpf= .false.}}
\DoxyCodeLine{1341 \textcolor{comment}{!    use\_g  = .true.}}
\DoxyCodeLine{1342 \textcolor{comment}{!    use\_gy = .true.}}
\DoxyCodeLine{1343 \textcolor{comment}{!    use\_gp = .true.}}
\DoxyCodeLine{1344 \textcolor{comment}{!    use\_gr = .true.}}
\DoxyCodeLine{1345 \textcolor{preprocessor}{\#endif }}
\DoxyCodeLine{1346 \textcolor{preprocessor}{}}
\DoxyCodeLine{1347     iexp = 0}
\DoxyCodeLine{1348     \textcolor{keywordflow}{do} i=0,rmax\_d-\/rmax}
\DoxyCodeLine{1349 }
\DoxyCodeLine{1350       \textcolor{keywordflow}{if} (use\_g) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1351         \textcolor{keywordflow}{if} (err\_g\_exp.gt.err\_g\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1352           g = i}
\DoxyCodeLine{1353           err\_g\_exp = err\_g\_exp*\mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}}}
\DoxyCodeLine{1354           err\_g\_c = max(err\_g\_cr,err\_c(rmax+g)*z\_g*x\_g**g)}
\DoxyCodeLine{1355           err\_g(rmax) = max(err\_g\_exp,err\_g\_c)}
\DoxyCodeLine{1356           \textcolor{keywordflow}{if}(err\_g(rmax).lt.err\_req\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1357             iexp = 1}
\DoxyCodeLine{1358             \textcolor{comment}{! increase g by 2 to account for bad estimates}}
\DoxyCodeLine{1359             g = min(max(g+2,3*g/2),rmax\_d-\/rmax)}
\DoxyCodeLine{1360             \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1361 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1362 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1363 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1364 }
\DoxyCodeLine{1365 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1366 \textcolor{preprocessor}{}\textcolor{comment}{!       write(*,*) 'CalcDred: it g',g, err\_g\_exp, err\_g\_C,  err\_g(rmax) }}
\DoxyCodeLine{1367 \textcolor{comment}{!       write(*,*) 'CalcDred: it g',err\_g\_Cr,err\_C(rmax+g)*z\_g*x\_g**g}}
\DoxyCodeLine{1368 \textcolor{comment}{!       write(*,*) 'CalcDred: it g',err\_C(rmax+g),z\_g,x\_g}}
\DoxyCodeLine{1369 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1370 \textcolor{preprocessor}{}}
\DoxyCodeLine{1371 \textcolor{preprocessor}{\#ifdef USEGM}}
\DoxyCodeLine{1372 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if} (use\_gm) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1373         \textcolor{keywordflow}{if} (err\_gm\_exp.gt.err\_gm\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1374           gm = i}
\DoxyCodeLine{1375           err\_gm\_exp = err\_gm\_exp*\mbox{\hyperlink{namespaceglobald_af592a0bdf2d43f6fa584350670853b8e}{fac\_gm}}}
\DoxyCodeLine{1376           err\_gm\_c = max(err\_gm\_cr,err\_c(rmax+gm)*z\_gm*\mbox{\hyperlink{namespaceglobald_aefbd3281b672edaf16cfc1c91f64ff77}{x\_gm}}**gm)}
\DoxyCodeLine{1377           err\_gm(rmax) = max(err\_gm\_exp,err\_gm\_c)}
\DoxyCodeLine{1378           \textcolor{keywordflow}{if}(err\_gm(rmax).lt.err\_req\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1379             iexp = 7}
\DoxyCodeLine{1380             \textcolor{comment}{! increase gm by 2 to account for bad estimates}}
\DoxyCodeLine{1381             gm = min(max(gm+2,3*gm/2),rmax\_d-\/rmax)}
\DoxyCodeLine{1382             \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1383 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1384 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1385 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1386 }
\DoxyCodeLine{1387 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1388 \textcolor{preprocessor}{}\textcolor{comment}{!      write(*,*) 'CalcDred: it gm',gm, err\_gm\_exp, err\_gm\_C,  err\_gm(rmax) }}
\DoxyCodeLine{1389 \textcolor{comment}{!      write(*,*) 'CalcDred: it gm',err\_gm\_Cr,err\_C(rmax+gm)*z\_gm*x\_gm**gm}}
\DoxyCodeLine{1390 \textcolor{comment}{!      write(*,*) 'CalcDred: it gm',err\_C(rmax+gm),z\_gm,x\_gm}}
\DoxyCodeLine{1391 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1392 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1393 \textcolor{preprocessor}{}}
\DoxyCodeLine{1394 }
\DoxyCodeLine{1395       \textcolor{keywordflow}{if} (mod(i,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1396 }
\DoxyCodeLine{1397 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1398 \textcolor{preprocessor}{}       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: it gy'},use\_gy,err\_gy\_exp,err\_gy\_c,err\_gy(rmax),err\_req\_d}
\DoxyCodeLine{1399 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1400 \textcolor{preprocessor}{}}
\DoxyCodeLine{1401         \textcolor{keywordflow}{if} (use\_gy) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1402           \textcolor{keywordflow}{if} (err\_gy\_exp.gt.err\_gy\_c.and.err\_gy(rmax).gt.err\_req\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1403             gy = i/2}
\DoxyCodeLine{1404             err\_gy\_exp = err\_gy\_exp*\mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}}}
\DoxyCodeLine{1405             err\_gy\_c = b\_gy*max(err\_gy\_cr,                   \&}
\DoxyCodeLine{1406                 max(err\_c(rmax+2*gy)*v1\_gy,err\_c(rmax+2*gy+1))*y\_gy**gy,      \&          }
\DoxyCodeLine{1407                 max(err\_c(rmax+gy)*v1\_gy,err\_c(rmax+gy+1))*(max(x\_gy,v\_gy*y\_gy))**gy) }
\DoxyCodeLine{1408             err\_gy(rmax) = max(err\_gy\_exp,err\_gy\_c)}
\DoxyCodeLine{1409 }
\DoxyCodeLine{1410 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1411 \textcolor{preprocessor}{}         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred i gy'},i,gy,err\_gy\_exp,err\_gy\_c,err\_gy(rmax) }
\DoxyCodeLine{1412          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred i '},err\_gy\_cr,                   \&}
\DoxyCodeLine{1413                max(err\_c(rmax+2*gy)*v1\_gy,err\_c(rmax+2*gy+1))*y\_gy**gy,      \&          }
\DoxyCodeLine{1414                max(err\_c(rmax+gy)*v1\_gy,err\_c(rmax+gy+1))*(max(x\_gy,v\_gy*y\_gy))**gy}
\DoxyCodeLine{1415           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred i '}, b\_gy*err\_c(rmax+2*gy)*v1\_gy*y\_gy**gy, \&}
\DoxyCodeLine{1416                 b\_gy*err\_c(rmax+2*gy+1)*y\_gy**gy}
\DoxyCodeLine{1417           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred i '}, \& }
\DoxyCodeLine{1418                 b\_gy,err\_c(rmax+2*gy+1),y\_gy**gy }
\DoxyCodeLine{1419           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred i '}, b\_gy*x\_gy**gy*err\_c(rmax+gy)*v1\_gy, \&}
\DoxyCodeLine{1420                 b\_gy*err\_c(rmax+gy+1)*x\_gy**gy }
\DoxyCodeLine{1421           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred i '}, \& }
\DoxyCodeLine{1422                 b\_gy,err\_c(rmax+gy+1),x\_gy**gy,x\_gy,gy }
\DoxyCodeLine{1423 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1424 \textcolor{preprocessor}{}}
\DoxyCodeLine{1425             \textcolor{keywordflow}{if}(err\_gy(rmax).lt.err\_req\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1426               iexp = 2}
\DoxyCodeLine{1427               \textcolor{comment}{! increase gy by 2 to account for bad estimates}}
\DoxyCodeLine{1428               gy = min(max(gy+2,2*gy),(rmax\_d-\/rmax)/2)}
\DoxyCodeLine{1429               \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1430 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{1431 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1432 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1433 }
\DoxyCodeLine{1434 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1435 \textcolor{preprocessor}{}\textcolor{comment}{!       write(*,*) 'CalcDred: it gy',i,gy, err\_gy\_exp,err\_gy\_C ,err\_gy(rmax)}}
\DoxyCodeLine{1436 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1437 \textcolor{preprocessor}{}}
\DoxyCodeLine{1438 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1439 }
\DoxyCodeLine{1440 \textcolor{comment}{!      write(*,*) 'CalcDred bef gp it',err\_gp(rmax),err\_gp\_C,err\_req\_D}}
\DoxyCodeLine{1441 }
\DoxyCodeLine{1442       \textcolor{keywordflow}{if} (use\_gp) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1443         \textcolor{keywordflow}{if} (err\_gp\_exp.gt.err\_gp\_c.and.err\_gp(rmax).gt.err\_req\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1444           gp = i}
\DoxyCodeLine{1445           err\_gp\_exp = err\_gp\_exp*\mbox{\hyperlink{namespaceglobalc_ac6e3d986b3c7aa2041225441a07dddb6}{fac\_gp}}}
\DoxyCodeLine{1446           err\_gp\_c = max(err\_c(rmax+gp)*z\_gp*w\_gp**gp,err\_gp\_cr)}
\DoxyCodeLine{1447           err\_gp(rmax) = max(err\_gp\_exp,err\_gp\_c)}
\DoxyCodeLine{1448           \textcolor{keywordflow}{if}(err\_gp(rmax).lt.err\_req\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1449             iexp = 3}
\DoxyCodeLine{1450             \textcolor{comment}{! increase gp by 2 to account for bad estimates}}
\DoxyCodeLine{1451             gp = min(max(gp+2,3*gp/2),rmax\_d-\/rmax)}
\DoxyCodeLine{1452             \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1453 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1454 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1455 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1456 }
\DoxyCodeLine{1457 \textcolor{comment}{!        write(*,*) 'CalcDred: it gp',gp,err\_gp, err\_gp\_C,  err\_gp(rmax) }}
\DoxyCodeLine{1458 }
\DoxyCodeLine{1459       \textcolor{keywordflow}{if} (mod(i,2).eq.1.and.i.le.rmax\_c-\/2*rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1460 }
\DoxyCodeLine{1461 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1462 \textcolor{preprocessor}{}\textcolor{comment}{!        write(*,*) 'CalcDred: it gr',use\_gr,err\_gr\_exp,err\_gr\_C,err\_gr(rmax),  \&}}
\DoxyCodeLine{1463 \textcolor{comment}{!                                     err\_req\_D}}
\DoxyCodeLine{1464 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1465 \textcolor{preprocessor}{}}
\DoxyCodeLine{1466         \textcolor{keywordflow}{if} (use\_gr) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1467           \textcolor{keywordflow}{if} (err\_gr\_exp.gt.err\_gr\_c.and.err\_gr(rmax).gt.err\_req\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1468             gr = i/2}
\DoxyCodeLine{1469             err\_gr\_exp = err\_gr\_exp*\mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}}}
\DoxyCodeLine{1470             err\_gr\_c = a\_gr*max(err\_gr\_cr,                   \&}
\DoxyCodeLine{1471                 max(err\_c(rmax+gr),err\_c(rmax+gr+1)*y\_gr)*\mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}}**gr)}
\DoxyCodeLine{1472             err\_gr(rmax) = max(err\_gr\_exp,err\_gr\_c)}
\DoxyCodeLine{1473 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1474 \textcolor{preprocessor}{}\textcolor{comment}{!          write(*,*) 'CalcDred: it gr',gr,err\_gr(rmax),err\_req\_D}}
\DoxyCodeLine{1475 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1476 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if}(err\_gr(rmax).lt.err\_req\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1477               iexp = 4}
\DoxyCodeLine{1478               \textcolor{comment}{! increase gy by 2 to account for bad estimates}}
\DoxyCodeLine{1479 \textcolor{comment}{! changed 25.07.14}}
\DoxyCodeLine{1480 \textcolor{comment}{!             gr = min(max(gr+2,2*gr),(rmax\_D-\/rmax)/2,(rmax\_C-\/2*rmax)/2)}}
\DoxyCodeLine{1481               gr = min(max(gr+2,2*gr),rmax\_d-\/rmax,max(0,(rmax\_c-\/2*rmax)/2))}
\DoxyCodeLine{1482               \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1483 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{1484 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1485 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1486 }
\DoxyCodeLine{1487 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1488 \textcolor{preprocessor}{}\textcolor{comment}{!      write(*,*) 'CalcDred: it gr',i,gr, err\_gr\_exp,err\_gr\_C ,err\_gr(rmax)}}
\DoxyCodeLine{1489 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1490 \textcolor{preprocessor}{}}
\DoxyCodeLine{1491       \textcolor{keywordflow}{if} (mod(i,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1492 }
\DoxyCodeLine{1493 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1494 \textcolor{preprocessor}{}       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: it gy'},use\_gy,err\_gy\_exp,err\_gy\_c,err\_gy(rmax),err\_req\_d}
\DoxyCodeLine{1495 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1496 \textcolor{preprocessor}{}}
\DoxyCodeLine{1497         \textcolor{keywordflow}{if} (use\_gpf) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1498           \textcolor{keywordflow}{if} (err\_gpf\_exp.gt.err\_gpf\_c.and.err\_gpf(rmax).gt.err\_req\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1499             gpf = i/2}
\DoxyCodeLine{1500             err\_gpf\_exp = err\_gpf\_exp*\mbox{\hyperlink{namespaceglobalc_a92c2feddeb644af9e797691976e9143b}{fac\_gpf}}}
\DoxyCodeLine{1501             err\_gpf\_c = b\_gpf*max(err\_gpf\_cr,                   \&}
\DoxyCodeLine{1502                 max(err\_c(rmax+2*gpf)*v1\_gpf,err\_c(rmax+2*gpf+1))*y\_gpf**gpf,      \&          }
\DoxyCodeLine{1503                 max(err\_c(rmax+gpf)*v1\_gpf,err\_c(rmax+gpf+1))*(max(x\_gpf,v\_gpf*y\_gpf))**gpf) }
\DoxyCodeLine{1504             err\_gpf(rmax) = max(err\_gpf\_exp,err\_gpf\_c)}
\DoxyCodeLine{1505 }
\DoxyCodeLine{1506 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1507 \textcolor{preprocessor}{}         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred i gpf'},i,gpf,err\_gpf\_exp,err\_gpf\_c,err\_gpf(rmax) }
\DoxyCodeLine{1508          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred i '},err\_gpf\_cr,                   \&}
\DoxyCodeLine{1509                max(err\_c(rmax+2*gpf)*v1\_gpf,err\_c(rmax+2*gpf+1))*y\_gpf**gpf,      \&          }
\DoxyCodeLine{1510                max(err\_c(rmax+gpf)*v1\_gpf,err\_c(rmax+gpf+1))*(max(x\_gpf,v\_gpf*y\_gpf))**gpf}
\DoxyCodeLine{1511           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred i '}, b\_gpf*err\_c(rmax+2*gpf)*v1\_gpf*y\_gpf**gpf, \&}
\DoxyCodeLine{1512                 b\_gpf*err\_c(rmax+2*gpf+1)*y\_gpf**gpf}
\DoxyCodeLine{1513           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred i '}, \& }
\DoxyCodeLine{1514                 b\_gpf,err\_c(rmax+2*gpf+1),y\_gpf**gpf }
\DoxyCodeLine{1515           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred i '}, b\_gpf*x\_gpf**gpf*err\_c(rmax+gpf)*v1\_gpf, \&}
\DoxyCodeLine{1516                 b\_gpf*err\_c(rmax+gpf+1)*x\_gpf**gpf }
\DoxyCodeLine{1517           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred i '}, \& }
\DoxyCodeLine{1518                 b\_gpf,err\_c(rmax+gpf+1),x\_gpf**gpf,x\_gpf,gpf }
\DoxyCodeLine{1519 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1520 \textcolor{preprocessor}{}}
\DoxyCodeLine{1521             \textcolor{keywordflow}{if}(err\_gpf(rmax).lt.err\_req\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1522               iexp = 5}
\DoxyCodeLine{1523               \textcolor{comment}{! increase gpf by 2 to account for bad estimates}}
\DoxyCodeLine{1524               gpf = min(max(gpf+2,2*gpf),(rmax\_d-\/rmax)/2)}
\DoxyCodeLine{1525               \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1526 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{1527 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1528 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1529 }
\DoxyCodeLine{1530 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1531 \textcolor{preprocessor}{}\textcolor{comment}{!       write(*,*) 'CalcDred: it gpf',i,gpf, err\_gpf\_exp,err\_gpf\_C ,err\_gpf(rmax)}}
\DoxyCodeLine{1532 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1533 \textcolor{preprocessor}{}}
\DoxyCodeLine{1534 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1535 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1536 }
\DoxyCodeLine{1537 }
\DoxyCodeLine{1538 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{1539 }
\DoxyCodeLine{1540     \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{1541     err\_g(rmax)  =  err\_g(rmax)/impest\_d}
\DoxyCodeLine{1542     err\_gy(rmax) =  err\_gy(rmax)/impest\_d     }
\DoxyCodeLine{1543     err\_gp(rmax) =  err\_gp(rmax)/impest\_d}
\DoxyCodeLine{1544     err\_gr(rmax) =  err\_gr(rmax)/impest\_d     }
\DoxyCodeLine{1545     err\_gm(rmax) =  err\_gm(rmax)/impest\_d     }
\DoxyCodeLine{1546     err\_gpf(rmax) =  err\_gpf(rmax)/impest\_d     }
\DoxyCodeLine{1547 }
\DoxyCodeLine{1548 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1549 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'iexp='},iexp}
\DoxyCodeLine{1550     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'facexp='},\mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}},\mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}},\mbox{\hyperlink{namespaceglobalc_ac6e3d986b3c7aa2041225441a07dddb6}{fac\_gp}},\mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}},\mbox{\hyperlink{namespaceglobald_af592a0bdf2d43f6fa584350670853b8e}{fac\_gm}},\mbox{\hyperlink{namespaceglobalc_a92c2feddeb644af9e797691976e9143b}{fac\_gpf}}}
\DoxyCodeLine{1551     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'errexp='},err\_g\_exp,err\_gy\_exp,err\_gp\_exp,err\_gr\_exp,err\_gm\_exp,err\_gpf\_exp,err\_req\_d}
\DoxyCodeLine{1552     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'errexptot='},i,g,err\_g(rmax),gy,err\_gy(rmax),gp,err\_gp(rmax), \&}
\DoxyCodeLine{1553 }
\DoxyCodeLine{1554         gr,err\_gr(rmax),gm,err\_gm(rmax),gpf,err\_gpf(rmax)}
\DoxyCodeLine{1555     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'accexptot='},i,g,err\_g(rmax)/dtyp,gy,err\_gy(rmax)/dtyp, \&}
\DoxyCodeLine{1556         gp,err\_gp(rmax)/dtyp,gr,err\_gr(rmax)/dtyp,gm,err\_gm(rmax)/dtyp, \&}
\DoxyCodeLine{1557         gpf,err\_gpf(rmax)/dtyp}
\DoxyCodeLine{1558 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1559 \textcolor{preprocessor}{}}
\DoxyCodeLine{1560 \textcolor{comment}{! call expansions with estimated order to save CPU time}}
\DoxyCodeLine{1561 }
\DoxyCodeLine{1562 \textcolor{preprocessor}{\#ifdef TEST}}
\DoxyCodeLine{1563 \textcolor{preprocessor}{}\textcolor{comment}{!     iexp = 0}}
\DoxyCodeLine{1564 \textcolor{comment}{!     iexp = 5}}
\DoxyCodeLine{1565 \textcolor{comment}{!     gm = 10}}
\DoxyCodeLine{1566 \textcolor{comment}{!      iexp = 1}}
\DoxyCodeLine{1567 \textcolor{comment}{!      g = 10}}
\DoxyCodeLine{1568 \textcolor{comment}{!     iexp = 4}}
\DoxyCodeLine{1569 \textcolor{comment}{!     gr = 3}}
\DoxyCodeLine{1570       iexp = 2}
\DoxyCodeLine{1571       gy = 4}
\DoxyCodeLine{1572 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1573 \textcolor{preprocessor}{}}
\DoxyCodeLine{1574     \textcolor{keywordflow}{select case} (iexp)}
\DoxyCodeLine{1575 }
\DoxyCodeLine{1576     \textcolor{keywordflow}{case} (1)}
\DoxyCodeLine{1577       \textcolor{keyword}{call }calcdg(d\_alt,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,rmax,g,g,id,derr1\_alt,derr2\_alt)}
\DoxyCodeLine{1578 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{1579 \textcolor{preprocessor}{}      derr\_alt = derr2\_alt}
\DoxyCodeLine{1580 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1581 \textcolor{preprocessor}{}      derr\_alt = derr1\_alt}
\DoxyCodeLine{1582 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1583 \textcolor{preprocessor}{}      dcount(3) = dcount(3)+1}
\DoxyCodeLine{1584       drcalc(0:rmax)=drcalc(0:rmax)+4}
\DoxyCodeLine{1585       dcalc = dcalc+4}
\DoxyCodeLine{1586       drmethod\_alt(0:rmax)=4}
\DoxyCodeLine{1587         }
\DoxyCodeLine{1588 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1589 \textcolor{preprocessor}{}      checkest=derr\_alt(rmax)/err\_g(rmax)}
\DoxyCodeLine{1590       \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_d.or.checkest.lt.1d-\/2*impest\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1591         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: estimate err\_g imprecise '},err\_g(rmax),derr\_alt(rmax)}
\DoxyCodeLine{1592 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1593 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1594 \textcolor{preprocessor}{}}
\DoxyCodeLine{1595       err\_g=derr\_alt}
\DoxyCodeLine{1596 }
\DoxyCodeLine{1597       \textcolor{keyword}{call }copydimp3(d,d\_alt,derr,derr\_alt,derr1,derr1\_alt,derr2,derr2\_alt,drmethod,drmethod\_alt,rmax,rmax)}
\DoxyCodeLine{1598               }
\DoxyCodeLine{1599 }
\DoxyCodeLine{1600 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1601 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp Derr='},derr,err\_req\_d}
\DoxyCodeLine{1602 \textcolor{comment}{!     write(*,*) 'CalcDred after exp Dacc=',Derr/abs(D(0,0,0,0))}}
\DoxyCodeLine{1603       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp Dacc='},derr/dtyp}
\DoxyCodeLine{1604       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp method='},drmethod}
\DoxyCodeLine{1605 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1606 \textcolor{preprocessor}{}}
\DoxyCodeLine{1607     \textcolor{keywordflow}{case} (2)}
\DoxyCodeLine{1608       \textcolor{keyword}{call }calcdgy(d\_alt,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,rmax,gy,gy,id,derr1\_alt,derr2\_alt)}
\DoxyCodeLine{1609 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{1610 \textcolor{preprocessor}{}      derr\_alt = derr2\_alt}
\DoxyCodeLine{1611 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1612 \textcolor{preprocessor}{}      derr\_alt = derr1\_alt}
\DoxyCodeLine{1613 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1614 \textcolor{preprocessor}{}      dcount(4) = dcount(4)+1}
\DoxyCodeLine{1615       drcalc(0:rmax)=drcalc(0:rmax)+8}
\DoxyCodeLine{1616       dcalc = dcalc+8}
\DoxyCodeLine{1617       drmethod\_alt(0:rmax)=8}
\DoxyCodeLine{1618 }
\DoxyCodeLine{1619 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1620 \textcolor{preprocessor}{}      checkest=derr\_alt(rmax)/err\_gy(rmax)}
\DoxyCodeLine{1621       \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_d.or.checkest.lt.1d-\/2*impest\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1622         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: estimate err\_gy imprecise'},err\_gy(rmax),derr\_alt(rmax),checkest}
\DoxyCodeLine{1623 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1624 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1625 \textcolor{preprocessor}{}      err\_gy=derr\_alt}
\DoxyCodeLine{1626 }
\DoxyCodeLine{1627       \textcolor{keyword}{call }copydimp3(d,d\_alt,derr,derr\_alt,derr1,derr1\_alt,derr2,derr2\_alt,drmethod,drmethod\_alt,rmax,rmax)}
\DoxyCodeLine{1628 }
\DoxyCodeLine{1629 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1630 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp Derr='},derr,err\_req\_d}
\DoxyCodeLine{1631       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp Dacc='},derr/dtyp}
\DoxyCodeLine{1632       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp method='},drmethod}
\DoxyCodeLine{1633 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1634 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1635 \textcolor{preprocessor}{}\textcolor{comment}{!      write(*,*) 'after CalcDgy D(1,0,1,0)',D\_alt(1,0,1,0),D(1,0,1,0)}}
\DoxyCodeLine{1636 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1637 \textcolor{preprocessor}{}}
\DoxyCodeLine{1638 }
\DoxyCodeLine{1639     \textcolor{keywordflow}{case} (3)}
\DoxyCodeLine{1640       \textcolor{keyword}{call }calcdgp(d\_alt,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,rmax,gp,gp,id,derr1\_alt,derr2\_alt)}
\DoxyCodeLine{1641 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{1642 \textcolor{preprocessor}{}      derr\_alt = derr2\_alt}
\DoxyCodeLine{1643 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1644 \textcolor{preprocessor}{}      derr\_alt = derr1\_alt}
\DoxyCodeLine{1645 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1646 \textcolor{preprocessor}{}      dcount(5) = dcount(5)+1}
\DoxyCodeLine{1647       drcalc(0:rmax)=drcalc(0:rmax)+16}
\DoxyCodeLine{1648       dcalc = dcalc+16}
\DoxyCodeLine{1649       drmethod\_alt(0:rmax)=16}
\DoxyCodeLine{1650 }
\DoxyCodeLine{1651 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1652 \textcolor{preprocessor}{}      checkest=derr\_alt(rmax)/err\_gp(rmax)}
\DoxyCodeLine{1653       \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_d.or.checkest.lt.1d-\/2*impest\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1654         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: estimate err\_gp imprecise'},err\_gp(rmax),derr\_alt(rmax)}
\DoxyCodeLine{1655 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1656 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1657 \textcolor{preprocessor}{}      err\_gp=derr\_alt}
\DoxyCodeLine{1658 }
\DoxyCodeLine{1659       \textcolor{keyword}{call }copydimp3(d,d\_alt,derr,derr\_alt,derr1,derr1\_alt,derr2,derr2\_alt,drmethod,drmethod\_alt,rmax,rmax)}
\DoxyCodeLine{1660 }
\DoxyCodeLine{1661 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1662 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp Derr='},derr,err\_req\_d}
\DoxyCodeLine{1663       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp Dacc='},derr/dtyp}
\DoxyCodeLine{1664       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp method='},drmethod}
\DoxyCodeLine{1665 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1666 \textcolor{preprocessor}{}}
\DoxyCodeLine{1667     \textcolor{keywordflow}{case} (4)}
\DoxyCodeLine{1668       \textcolor{keyword}{call }calcdgr(d\_alt,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,rmax,gr,gr,id,derr1\_alt,derr2\_alt)}
\DoxyCodeLine{1669 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{1670 \textcolor{preprocessor}{}      derr\_alt = derr2\_alt}
\DoxyCodeLine{1671 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1672 \textcolor{preprocessor}{}      derr\_alt = derr1\_alt}
\DoxyCodeLine{1673 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1674 \textcolor{preprocessor}{}      dcount(6) = dcount(6)+1}
\DoxyCodeLine{1675       drcalc(0:rmax)=drcalc(0:rmax)+32}
\DoxyCodeLine{1676       dcalc = dcalc+32}
\DoxyCodeLine{1677       drmethod\_alt(0:rmax)=32}
\DoxyCodeLine{1678 }
\DoxyCodeLine{1679 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1680 \textcolor{preprocessor}{}      checkest=derr\_alt(rmax)/err\_gr(rmax)}
\DoxyCodeLine{1681       \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_d.or.checkest.lt.1d-\/2*impest\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1682         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: estimate err\_gr imprecise'},err\_gr(rmax),derr\_alt(rmax)}
\DoxyCodeLine{1683 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1684 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1685 \textcolor{preprocessor}{}      err\_gr=derr\_alt}
\DoxyCodeLine{1686 }
\DoxyCodeLine{1687       \textcolor{keyword}{call }copydimp3(d,d\_alt,derr,derr\_alt,derr1,derr1\_alt,derr2,derr2\_alt,drmethod,drmethod\_alt,rmax,rmax)}
\DoxyCodeLine{1688 }
\DoxyCodeLine{1689 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1690 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp Derr='},derr,err\_req\_d}
\DoxyCodeLine{1691       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp Dacc='},derr/dtyp}
\DoxyCodeLine{1692       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp method='},drmethod}
\DoxyCodeLine{1693 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1694 \textcolor{preprocessor}{}}
\DoxyCodeLine{1695 \textcolor{preprocessor}{\#ifdef USEGM}}
\DoxyCodeLine{1696 \textcolor{preprocessor}{}    \textcolor{keywordflow}{case} (7)}
\DoxyCodeLine{1697       \textcolor{keyword}{call }calcdgm(d\_alt,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,rmax,gm,gm,id,derr1\_alt,derr2\_alt)}
\DoxyCodeLine{1698 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{1699 \textcolor{preprocessor}{}      derr\_alt = derr2\_alt}
\DoxyCodeLine{1700 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1701 \textcolor{preprocessor}{}      derr\_alt = derr1\_alt}
\DoxyCodeLine{1702 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1703 \textcolor{preprocessor}{}      dcount(7) = dcount(7)+1}
\DoxyCodeLine{1704       drcalc(0:rmax)=drcalc(0:rmax)+64}
\DoxyCodeLine{1705       dcalc = dcalc+64}
\DoxyCodeLine{1706       drmethod\_alt(0:rmax)=64}
\DoxyCodeLine{1707 }
\DoxyCodeLine{1708 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1709 \textcolor{preprocessor}{}      checkest=derr\_alt(rmax)/err\_gm(rmax)}
\DoxyCodeLine{1710       \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_d.or.checkest.lt.1d-\/2*impest\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1711         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: estimate err\_gm imprecise'},err\_gm(rmax),derr\_alt(rmax)}
\DoxyCodeLine{1712 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1713 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1714 \textcolor{preprocessor}{}      err\_gm=derr\_alt}
\DoxyCodeLine{1715 }
\DoxyCodeLine{1716       \textcolor{keyword}{call }copydimp3(d,d\_alt,derr,derr\_alt,derr1,derr1\_alt,derr2,derr2\_alt,drmethod,drmethod\_alt,rmax,rmax)}
\DoxyCodeLine{1717 }
\DoxyCodeLine{1718 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1719 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp Derr='},derr,err\_req\_d}
\DoxyCodeLine{1720       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp Dacc='},derr/dtyp}
\DoxyCodeLine{1721       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp method='},drmethod}
\DoxyCodeLine{1722 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1723 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1724 \textcolor{preprocessor}{}}
\DoxyCodeLine{1725     \textcolor{keywordflow}{case} (5)}
\DoxyCodeLine{1726       \textcolor{keyword}{call }calcdgpf(d\_alt,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,rmax,gpf,gpf,id,derr1\_alt,derr2\_alt)}
\DoxyCodeLine{1727 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{1728 \textcolor{preprocessor}{}      derr\_alt = derr2\_alt}
\DoxyCodeLine{1729 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1730 \textcolor{preprocessor}{}      derr\_alt = derr1\_alt}
\DoxyCodeLine{1731 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1732 \textcolor{preprocessor}{}      dcount(7) = dcount(7)+1}
\DoxyCodeLine{1733       drcalc(0:rmax)=drcalc(0:rmax)+64}
\DoxyCodeLine{1734       dcalc = dcalc+64}
\DoxyCodeLine{1735       drmethod\_alt(0:rmax)=64}
\DoxyCodeLine{1736 }
\DoxyCodeLine{1737 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1738 \textcolor{preprocessor}{}      checkest=derr\_alt(rmax)/err\_gpf(rmax)}
\DoxyCodeLine{1739       \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_d.or.checkest.lt.1d-\/2*impest\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1740         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: estimate err\_gpf imprecise'},err\_gpf(rmax),derr\_alt(rmax),checkest}
\DoxyCodeLine{1741 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1742 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1743 \textcolor{preprocessor}{}      err\_gpf=derr\_alt}
\DoxyCodeLine{1744 }
\DoxyCodeLine{1745       \textcolor{keyword}{call }copydimp3(d,d\_alt,derr,derr\_alt,derr1,derr1\_alt,derr2,derr2\_alt,drmethod,drmethod\_alt,rmax,rmax)}
\DoxyCodeLine{1746 }
\DoxyCodeLine{1747 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1748 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp Derr='},derr,err\_req\_d}
\DoxyCodeLine{1749       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp Dacc='},derr/dtyp}
\DoxyCodeLine{1750       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred after exp method='},drmethod}
\DoxyCodeLine{1751 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1752 \textcolor{preprocessor}{}}
\DoxyCodeLine{1753 \textcolor{keywordflow}{    end select}}
\DoxyCodeLine{1754 }
\DoxyCodeLine{1755 \textcolor{comment}{!   write(*,*) 'CalcDred Calc',DrCalc(rmax)}}
\DoxyCodeLine{1756 }
\DoxyCodeLine{1757 \textcolor{preprocessor}{\#ifndef USED0}}
\DoxyCodeLine{1758 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifndef ALWAYSPV}}
\DoxyCodeLine{1759 \textcolor{preprocessor}{}    \textcolor{comment}{! refine error estimate for D0}}
\DoxyCodeLine{1760     \textcolor{keywordflow}{if}(.not.lerr\_d0.and.iexp.ne.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1761 \textcolor{comment}{!      D0est =  abs(D(0,0,0,0))}}
\DoxyCodeLine{1762       err\_d0 = acc\_def\_d0*max( abs(d(0,0,0,0)), 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}) )}
\DoxyCodeLine{1763 \textcolor{comment}{!      err\_req\_D = acc\_req\_D * abs(D(0,0,0,0))}}
\DoxyCodeLine{1764       lerr\_d0 = .true.}
\DoxyCodeLine{1765 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{1766 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1767 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1768 \textcolor{preprocessor}{}}
\DoxyCodeLine{1769     \textcolor{keywordflow}{if} (iexp.ne.0) \textcolor{keywordflow}{then}           \textcolor{comment}{!  if added 21.11.2016}}
\DoxyCodeLine{1770       \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1771         dtyp =  max(abs(d(0,0,0,0)),        \&}
\DoxyCodeLine{1772             abs(d(0,1,0,0)),abs(d(0,0,1,0)),abs(d(0,0,0,1)))  }
\DoxyCodeLine{1773       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1774         dtyp =  abs(d(0,0,0,0))}
\DoxyCodeLine{1775 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1776       err\_req\_d = acc\_req\_d * dtyp}
\DoxyCodeLine{1777     }
\DoxyCodeLine{1778 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1779 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred '},rmax,derr1(rmax),err\_req\_d}
\DoxyCodeLine{1780 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1781 \textcolor{preprocessor}{}}
\DoxyCodeLine{1782       \textcolor{keywordflow}{if} (derr1(rmax).le.err\_req\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1783         dcount(dcalc+dcountoffset0) = dcount(dcalc+dcountoffset0)+1}
\DoxyCodeLine{1784         \textcolor{keywordflow}{return}}
\DoxyCodeLine{1785 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1786 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{1787 }
\DoxyCodeLine{1788 \textcolor{preprocessor}{\#ifdef TEST}}
\DoxyCodeLine{1789 \textcolor{preprocessor}{}    \textcolor{keywordflow}{return}}
\DoxyCodeLine{1790 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1791 \textcolor{preprocessor}{}}
\DoxyCodeLine{1792 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{1793 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred no optimal method'}}
\DoxyCodeLine{1794     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'err\_req\_D='},err\_req\_d}
\DoxyCodeLine{1795     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'err\_est='},err\_pv(rmax),err\_pv2(rmax),err\_g(rmax),err\_gy(rmax),err\_gp(rmax),err\_gr(rmax),err\_gpf(rmax)}
\DoxyCodeLine{1796 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1797 \textcolor{preprocessor}{}}
\DoxyCodeLine{1798     \textcolor{comment}{! no method does work optimal}}
\DoxyCodeLine{1799     \textcolor{comment}{! use the least problematic (for each rank)}}
\DoxyCodeLine{1800     \textcolor{keywordflow}{do} r=rmax,0,-\/1}
\DoxyCodeLine{1801      }
\DoxyCodeLine{1802       \textcolor{keywordflow}{if}(use\_pv.and.mod(drcalc(r),2).ne.1) \textcolor{keywordflow}{then}   }
\DoxyCodeLine{1803     \textcolor{comment}{! estimate accuracy of PV-\/reduction}}
\DoxyCodeLine{1804         \textcolor{keywordflow}{if} (use\_pv) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1805 }
\DoxyCodeLine{1806           \textcolor{keywordflow}{if} (mod(r,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1807             err\_pv(r) = max( w\_pv**((r-\/1)/2) * v\_pv * err\_d0,  \&}
\DoxyCodeLine{1808                 w\_pv**((r-\/1)/2) * z\_pv * err\_c0, z\_pv * err\_c(r-\/1) )}
\DoxyCodeLine{1809             }
\DoxyCodeLine{1810 \textcolor{comment}{!            write(*,*) 'CalcDred w\_pv: ',w\_pv,v\_pv,err\_D0,r}}
\DoxyCodeLine{1811             }
\DoxyCodeLine{1812 \textcolor{comment}{!            write(*,*) 'CalcDred err\_pv: ',err\_pv(r), w\_pv**((r-\/1)/2) * v\_pv * err\_D0,  \&}}
\DoxyCodeLine{1813 \textcolor{comment}{!                        w\_pv**((r-\/1)/2) * z\_pv * err\_C0, z\_pv * err\_C(r-\/1)}}
\DoxyCodeLine{1814             }
\DoxyCodeLine{1815           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (r.ne.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1816             err\_pv(r) = max( w\_pv**(r/2) * err\_d0,  \&}
\DoxyCodeLine{1817                 w\_pv**(r/2-\/1) * v\_pv * z\_pv * err\_c0, z\_pv * err\_c(r-\/1) )}
\DoxyCodeLine{1818             }
\DoxyCodeLine{1819 \textcolor{comment}{!            write(*,*) 'CalcDred err\_pv: ',err\_pv(r), w\_pv**((r)/2) * err\_D0,  \&}}
\DoxyCodeLine{1820 \textcolor{comment}{!                        w\_pv**(r/2-\/1) * v\_pv * z\_pv * err\_C0, z\_pv * err\_C(r-\/1)}}
\DoxyCodeLine{1821 }
\DoxyCodeLine{1822           \textcolor{keywordflow}{else}}
\DoxyCodeLine{1823             err\_pv(r) = err\_d0}
\DoxyCodeLine{1824 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1825 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1826         \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{1827         err\_pv(r)  = err\_pv(r)/impest\_d}
\DoxyCodeLine{1828 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1829 }
\DoxyCodeLine{1830       \textcolor{keywordflow}{if} (use\_pv2.and.mod(drcalc(r),4)-\/mod(drcalc(r),2).ne.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1831     \textcolor{comment}{! estimate accuracy of alternative PV-\/reduction}}
\DoxyCodeLine{1832         \textcolor{keywordflow}{if} (use\_pv2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1833 }
\DoxyCodeLine{1834 \textcolor{comment}{!         write(*,*) 'CalcDred err\_pv2',  r,w\_pv2,v\_pv2,z\_pv2,err\_D0,err\_C0}}
\DoxyCodeLine{1835 }
\DoxyCodeLine{1836           \textcolor{keywordflow}{if} (mod(r,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1837 \textcolor{comment}{! changed 21.10.15 for PVEST2}}
\DoxyCodeLine{1838 \textcolor{comment}{!            err\_pv2(r) = max( err\_D0 * max(w\_pv2**r,    \&}}
\DoxyCodeLine{1839 \textcolor{comment}{!                w\_pv2*v\_pv2**((r-\/1)/2) ),  \&}}
\DoxyCodeLine{1840 \textcolor{comment}{!                err\_C0 * z\_pv2* max(w\_pv2**(r+1), \&}}
\DoxyCodeLine{1841 \textcolor{comment}{!                                    w\_pv2*v\_pv2**((r-\/1)/2), \& }}
\DoxyCodeLine{1842 \textcolor{comment}{!                                    v\_pv2**((r+1)/2)),  \&}}
\DoxyCodeLine{1843 \textcolor{comment}{!                err\_C(r-\/1) * z\_pv2 * max(w\_pv2,w\_pv2**2,v\_pv2) )}}
\DoxyCodeLine{1844             err\_pv2(r) = max( err\_d0 * max(hw\_pv2**r,    \&}
\DoxyCodeLine{1845                 hw\_pv2*v\_pv2**((r-\/1)/2) ),  \&}
\DoxyCodeLine{1846                 err\_c0 * z\_pv2* max(w\_pv2*w\_pv2**(r), \&}
\DoxyCodeLine{1847                                     hw\_pv2*v\_pv2**((r-\/1)/2), \& }
\DoxyCodeLine{1848                                     w\_pv2*hw\_pv2*v\_pv2**((r-\/1)/2), \& }
\DoxyCodeLine{1849                                     v\_pv2**((r+1)/2)),  \&}
\DoxyCodeLine{1850                 err\_c(r-\/1) * z\_pv2 * max(hw\_pv2,w\_pv2*hw\_pv2**2,v\_pv2) )}
\DoxyCodeLine{1851                                   }
\DoxyCodeLine{1852 }
\DoxyCodeLine{1853 \textcolor{comment}{!           write(*,*) 'CalcDred err\_pv2: ',   \&}}
\DoxyCodeLine{1854 \textcolor{comment}{!               err\_pv2(r) ,     err\_D0,err\_D0*w\_pv2**r,err\_D0*v\_pv2**((r-\/1)/2),    \&}}
\DoxyCodeLine{1855 \textcolor{comment}{!                                     err\_D0*w\_pv2*v\_pv2**((r-\/1)/2),       \&}}
\DoxyCodeLine{1856 \textcolor{comment}{!                                 err\_C0 * z\_pv2*w\_pv2**(r+1), \&}}
\DoxyCodeLine{1857 \textcolor{comment}{!                                  err\_C0 * z\_pv2*w\_pv2*v\_pv2**((r-\/1)/2), \& }}
\DoxyCodeLine{1858 \textcolor{comment}{!                                  err\_C0 * z\_pv2*v\_pv2**((r+1)/2),     \&}}
\DoxyCodeLine{1859 \textcolor{comment}{!               err\_C(r-\/1),  err\_C(r-\/1)*z\_pv2*w\_pv2, \&}}
\DoxyCodeLine{1860 \textcolor{comment}{!                                err\_C(r-\/1)*  z\_pv2*w\_pv2**2, err\_C(r-\/1)*z\_pv2*v\_pv2}}
\DoxyCodeLine{1861 }
\DoxyCodeLine{1862 }
\DoxyCodeLine{1863           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (r.ne.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1864 \textcolor{comment}{! changed 21.10.15 for PVEST2}}
\DoxyCodeLine{1865 \textcolor{comment}{!            err\_pv2(r) = max( err\_D0 * max(w\_pv2**r,v\_pv2**(r/2)),  \&}}
\DoxyCodeLine{1866 \textcolor{comment}{!                err\_C0 * z\_pv2 * max(w\_pv2**(r+1),  \&}}
\DoxyCodeLine{1867 \textcolor{comment}{!                                     v\_pv2**(r/2),w\_pv2*v\_pv2**(r/2)), \&}}
\DoxyCodeLine{1868 \textcolor{comment}{!                err\_C(r-\/1) * z\_pv2 * max(w\_pv2, w\_pv2**2, v\_pv2) )}}
\DoxyCodeLine{1869             err\_pv2(r) = max( err\_d0 * max(hw\_pv2**r,v\_pv2**(r/2)),  \&}
\DoxyCodeLine{1870                 err\_c0 * z\_pv2 * max(w\_pv2*hw\_pv2**(r),  \&}
\DoxyCodeLine{1871                                      v\_pv2**(r/2),w\_pv2*v\_pv2**(r/2)), \&}
\DoxyCodeLine{1872                 err\_c(r-\/1) * z\_pv2 * max(hw\_pv2, w\_pv2*hw\_pv2**2, v\_pv2) )}
\DoxyCodeLine{1873                                   }
\DoxyCodeLine{1874 }
\DoxyCodeLine{1875 \textcolor{comment}{!         write(*,*) 'CalcDred err\_pv2: ',   \&}}
\DoxyCodeLine{1876 \textcolor{comment}{!         err\_pv2(r) , err\_D0 * max(1d0,w\_pv2**r,v\_pv2**(r/2)),  \&}}
\DoxyCodeLine{1877 \textcolor{comment}{!                        err\_C0 * z\_pv2 * max(w\_pv2**(r+1),z\_pv2*w\_pv2,  \&}}
\DoxyCodeLine{1878 \textcolor{comment}{!                                 v\_pv2**(r/2),w\_pv2*v\_pv2**(r/2)), \&}}
\DoxyCodeLine{1879 \textcolor{comment}{!                        err\_C(r-\/1) * max(1d0,z\_pv2*w\_pv2,  \&}}
\DoxyCodeLine{1880 \textcolor{comment}{!                                 z\_pv2*w\_pv2**2,z\_pv2*v\_pv2)}}
\DoxyCodeLine{1881 }
\DoxyCodeLine{1882           \textcolor{keywordflow}{else}}
\DoxyCodeLine{1883             err\_pv2(r) = err\_d0}
\DoxyCodeLine{1884 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1885 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1886         \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{1887         err\_pv2(r) = err\_pv2(r)/impest\_d     }
\DoxyCodeLine{1888 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1889 }
\DoxyCodeLine{1890       \textcolor{keywordflow}{if} (mod(drcalc(r),8)-\/mod(drcalc(r),4).ne.4.and.use\_g) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1891       \textcolor{comment}{! estimate accuracy of alternative Gram expansion}}
\DoxyCodeLine{1892         err\_g\_cr = max( err\_c(r), err\_c0 * u\_g**r ) * z\_g }
\DoxyCodeLine{1893         err\_g\_c = err\_g\_cr}
\DoxyCodeLine{1894         err\_g\_exp = u\_g**(r-\/1) * dtyp}
\DoxyCodeLine{1895 }
\DoxyCodeLine{1896       \textcolor{comment}{! determine optimal order of expansion }}
\DoxyCodeLine{1897         \textcolor{keywordflow}{do} i=0,rmax\_d-\/r}
\DoxyCodeLine{1898           g = i}
\DoxyCodeLine{1899           err\_g\_exp = err\_g\_exp*\mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}}}
\DoxyCodeLine{1900           err\_g\_c = max(err\_g\_cr,err\_c(r+g)*z\_g*x\_g**g)}
\DoxyCodeLine{1901           err\_g(r) = max(err\_g\_exp,err\_g\_c)}
\DoxyCodeLine{1902           \textcolor{keywordflow}{if} (err\_g\_exp.lt.err\_g\_c.or.err\_g(r).lt.err\_req\_d) \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1903 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1904       \textcolor{comment}{! increase g by 2 to account for bad estimates}}
\DoxyCodeLine{1905         g = min(max(g+2,2*g),rmax\_d-\/r)}
\DoxyCodeLine{1906       \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{1907         err\_g(r)  =  err\_g(r)/impest\_d}
\DoxyCodeLine{1908 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1909 }
\DoxyCodeLine{1910       \textcolor{keywordflow}{if} (mod(drcalc(r),16)-\/mod(drcalc(r),8).ne.8.and.use\_gy) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1911       \textcolor{comment}{! estimate accuracy of alternative Gram expansion}}
\DoxyCodeLine{1912         err\_gy\_cr =  max( err\_c(r) * v1\_gy, err\_c(r+1) ) }
\DoxyCodeLine{1913         err\_gy\_c = err\_gy\_cr * b\_gy}
\DoxyCodeLine{1914         err\_gy\_exp = 1d0 * dtyp}
\DoxyCodeLine{1915 }
\DoxyCodeLine{1916       \textcolor{comment}{! determine optimal order of expansion }}
\DoxyCodeLine{1917         gy = 0}
\DoxyCodeLine{1918         \textcolor{keywordflow}{do} i=0,rmax\_d-\/r}
\DoxyCodeLine{1919           \textcolor{keywordflow}{if} (mod(i,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1920             gy = i/2}
\DoxyCodeLine{1921             err\_gy\_exp = err\_gy\_exp*\mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}}}
\DoxyCodeLine{1922             err\_gy\_c = b\_gy*max(err\_gy\_cr,                   \&}
\DoxyCodeLine{1923                 max(err\_c(r+2*gy)*v1\_gy,err\_c(r+2*gy+1))*y\_gy**gy,      \&          }
\DoxyCodeLine{1924                 max(err\_c(r+gy)*v1\_gy,err\_c(r+gy+1))*(max(x\_gy,v\_gy*y\_gy))**gy) }
\DoxyCodeLine{1925             err\_gy(r) = max(err\_gy\_exp,err\_gy\_c)            }
\DoxyCodeLine{1926             \textcolor{keywordflow}{if} (err\_gy\_exp.lt.err\_gy\_c.or.err\_gy(r).lt.err\_req\_d) \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1927 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1928 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1929       \textcolor{comment}{! increase gy to account for bad estimates}}
\DoxyCodeLine{1930         gy = min(max(gy+2,2*gy),(rmax\_d-\/r)/2)}
\DoxyCodeLine{1931       \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{1932         err\_gy(r) =  err\_gy(r)/impest\_d     }
\DoxyCodeLine{1933 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1934 }
\DoxyCodeLine{1935       \textcolor{keywordflow}{if} (mod(drcalc(r),32)-\/mod(drcalc(r),16).ne.16.and.use\_gp) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1936       \textcolor{comment}{! estimate accuracy of small momenta expansion}}
\DoxyCodeLine{1937         err\_gp\_cr = max(err\_c0*v\_gp**r,err\_c(r))*z\_gp}
\DoxyCodeLine{1938         err\_gp\_exp = v1\_gp**(r-\/1) * dtyp}
\DoxyCodeLine{1939 }
\DoxyCodeLine{1940       \textcolor{comment}{! determine optimal order of expansion }}
\DoxyCodeLine{1941         \textcolor{keywordflow}{do} i=0,rmax\_d-\/r}
\DoxyCodeLine{1942           gp = i}
\DoxyCodeLine{1943           err\_gp\_exp = err\_gp\_exp*\mbox{\hyperlink{namespaceglobalc_ac6e3d986b3c7aa2041225441a07dddb6}{fac\_gp}}}
\DoxyCodeLine{1944           err\_gp\_c = max(err\_c(r+gp)*z\_gp*w\_gp**gp,err\_gp\_cr)}
\DoxyCodeLine{1945           err\_gp(r) = max(err\_gp\_exp,err\_gp\_c)}
\DoxyCodeLine{1946           \textcolor{keywordflow}{if} (err\_gp\_exp.lt.err\_gp\_c.or.err\_gp(r).lt.err\_req\_d) \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1947 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1948       \textcolor{comment}{! increase gp to account for bad estimates}}
\DoxyCodeLine{1949         gp = min(max(gp+2,3*gp/2),rmax\_d-\/r)}
\DoxyCodeLine{1950       \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{1951         err\_gp(r) =  err\_gp(r)/impest\_d}
\DoxyCodeLine{1952 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1953 }
\DoxyCodeLine{1954       \textcolor{keywordflow}{if} (mod(drcalc(r),64)-\/mod(drcalc(r),32).ne.32.and.use\_gr) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1955       \textcolor{comment}{! estimate accuracy of alternative Gram expansion}}
\DoxyCodeLine{1956         err\_gr\_cr = err\_c(r) }
\DoxyCodeLine{1957         err\_gr\_c = err\_gr\_cr * a\_gr}
\DoxyCodeLine{1958         err\_gr\_exp = y1\_gr * dtyp}
\DoxyCodeLine{1959 }
\DoxyCodeLine{1960       \textcolor{comment}{! determine optimal order of expansion }}
\DoxyCodeLine{1961         gr = 0}
\DoxyCodeLine{1962         \textcolor{keywordflow}{do} i=0,min(rmax\_d-\/r,rmax\_c-\/2*r)}
\DoxyCodeLine{1963           \textcolor{keywordflow}{if} (mod(i,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1964             gr = i/2}
\DoxyCodeLine{1965             err\_gr\_exp = err\_gr\_exp*\mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}}}
\DoxyCodeLine{1966             err\_gr\_c = a\_gr*max(err\_gr\_cr,                   \&}
\DoxyCodeLine{1967                 max(err\_c(r+gr),err\_c(r+gr+1)*y\_gr)*\mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}}**gr)}
\DoxyCodeLine{1968             err\_gr(r) = max(err\_gr\_exp,err\_gr\_c)}
\DoxyCodeLine{1969 }
\DoxyCodeLine{1970 \textcolor{preprocessor}{\#ifdef Dgrtest}}
\DoxyCodeLine{1971 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDgr err\_gr'},i,gr,err\_gr\_exp,err\_gr\_c,err\_gr(r),err\_req\_d}
\DoxyCodeLine{1972 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1973 \textcolor{preprocessor}{}}
\DoxyCodeLine{1974             \textcolor{keywordflow}{if} (err\_gr\_exp.lt.err\_gr\_c.or.err\_gr(r).lt.err\_req\_d) \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1975 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1976 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1977       \textcolor{comment}{! increase gr to account for bad estimates}}
\DoxyCodeLine{1978 \textcolor{comment}{! changed 28.07.14}}
\DoxyCodeLine{1979 \textcolor{comment}{!       gr = min(max(gr+2,2*gr),(rmax\_D-\/r)/2,(rmax\_C-\/2*r)/2)}}
\DoxyCodeLine{1980         gr = min(max(gr+2,2*gr),rmax\_d-\/r,max(0,(rmax\_c-\/2*r)/2))}
\DoxyCodeLine{1981       \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{1982         err\_gr(r) =  err\_gr(r)/impest\_d     }
\DoxyCodeLine{1983 }
\DoxyCodeLine{1984 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1985 }
\DoxyCodeLine{1986       \textcolor{keywordflow}{if} (mod(drcalc(r),128)-\/mod(drcalc(r),64).ne.64.and.use\_gpf) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1987       \textcolor{comment}{! estimate accuracy of small momenta and f expansion}}
\DoxyCodeLine{1988         err\_gpf\_cr =  max( err\_c(r) * v1\_gpf, err\_c(r+1) ) }
\DoxyCodeLine{1989         err\_gpf\_c = err\_gpf\_cr * b\_gpf}
\DoxyCodeLine{1990         err\_gpf\_exp = 1d0 * dtyp}
\DoxyCodeLine{1991 }
\DoxyCodeLine{1992       \textcolor{comment}{! determine optimal order of expansion }}
\DoxyCodeLine{1993         gpf = 0}
\DoxyCodeLine{1994         \textcolor{keywordflow}{do} i=0,rmax\_d-\/r}
\DoxyCodeLine{1995           \textcolor{keywordflow}{if} (mod(i,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1996             gpf = i/2}
\DoxyCodeLine{1997             err\_gpf\_exp = err\_gpf\_exp*\mbox{\hyperlink{namespaceglobalc_a92c2feddeb644af9e797691976e9143b}{fac\_gpf}}}
\DoxyCodeLine{1998             err\_gpf\_c = b\_gpf*max(err\_gpf\_cr,                   \&}
\DoxyCodeLine{1999                 max(err\_c(r+2*gpf)*v1\_gpf,err\_c(r+2*gpf+1))*y\_gpf**gpf,      \&          }
\DoxyCodeLine{2000                 max(err\_c(r+gpf)*v1\_gpf,err\_c(r+gpf+1))*(max(x\_gpf,v\_gpf*y\_gpf))**gpf) }
\DoxyCodeLine{2001             err\_gpf(r) = max(err\_gpf\_exp,err\_gpf\_c)            }
\DoxyCodeLine{2002             \textcolor{keywordflow}{if} (err\_gpf\_exp.lt.err\_gpf\_c.or.err\_gpf(r).lt.err\_req\_d) \textcolor{keywordflow}{exit}}
\DoxyCodeLine{2003 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2004 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{2005       \textcolor{comment}{! increase gpf to account for bad estimates}}
\DoxyCodeLine{2006         gpf = min(max(gpf+2,2*gpf),(rmax\_d-\/r)/2)}
\DoxyCodeLine{2007       \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{2008         err\_gpf(r) =  err\_gpf(r)/impest\_d     }
\DoxyCodeLine{2009 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{2010 }
\DoxyCodeLine{2011 }
\DoxyCodeLine{2012 }
\DoxyCodeLine{2013 \textcolor{preprocessor}{\#ifdef USEGM}}
\DoxyCodeLine{2014 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if} (mod(drcalc(r),128)-\/mod(drcalc(r),64).ne.64.and.use\_gm) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2015       \textcolor{comment}{! estimate accuracy of modified Gram expansion}}
\DoxyCodeLine{2016         err\_gm\_cr = max( err\_c(r), err\_c0 * u\_gm**r ) * z\_gm }
\DoxyCodeLine{2017         err\_gm\_c = err\_gm\_cr}
\DoxyCodeLine{2018         err\_gm\_exp = u\_gm**(r-\/1) * dtyp}
\DoxyCodeLine{2019 }
\DoxyCodeLine{2020       \textcolor{comment}{! determine optimal order of expansion }}
\DoxyCodeLine{2021         \textcolor{keywordflow}{do} i=0,rmax\_d-\/r}
\DoxyCodeLine{2022           gm = i}
\DoxyCodeLine{2023           err\_gm\_exp = err\_gm\_exp*\mbox{\hyperlink{namespaceglobald_af592a0bdf2d43f6fa584350670853b8e}{fac\_gm}}}
\DoxyCodeLine{2024           err\_gm\_c = max(err\_gm\_cr,err\_c(r+gm)*z\_gm*\mbox{\hyperlink{namespaceglobald_aefbd3281b672edaf16cfc1c91f64ff77}{x\_gm}}**gm)}
\DoxyCodeLine{2025           err\_gm(r) = max(err\_gm\_exp,err\_gm\_c)}
\DoxyCodeLine{2026           \textcolor{keywordflow}{if} (err\_gm\_exp.lt.err\_gm\_c.or.err\_gm(r).lt.err\_req\_d) \textcolor{keywordflow}{exit}}
\DoxyCodeLine{2027 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{2028       \textcolor{comment}{! increase gm by 2 to account for bad estimates}}
\DoxyCodeLine{2029         gm = min(max(gm+2,2*gm),rmax\_d-\/r)}
\DoxyCodeLine{2030       \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{2031         err\_gm(r)  =  err\_gm(r)/impest\_d}
\DoxyCodeLine{2032 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{2033 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2034 \textcolor{preprocessor}{}}
\DoxyCodeLine{2035 }
\DoxyCodeLine{2036 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2037 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: bef final loop ord methods'},r,g,gy,gp,gr,gm,gpf}
\DoxyCodeLine{2038       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: bef final loop err methods'},r,err\_pv(r),err\_pv2(r), \&}
\DoxyCodeLine{2039           err\_g(r),err\_gy(r),err\_gp(r),err\_gr(r),err\_gm(r),err\_gpf(r)}
\DoxyCodeLine{2040       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: bef final loop acc methods'},r,err\_pv(r)/dtyp,err\_pv2(r)/dtyp,   \&}
\DoxyCodeLine{2041           err\_g(r)/dtyp,err\_gy(r)/dtyp,err\_gp(r)/dtyp, \&}
\DoxyCodeLine{2042           err\_gr(r)/dtyp,err\_gm(r)/dtyp,err\_gpf(r)/dtyp}
\DoxyCodeLine{2043       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: bef final loop method'},r,drcalc(r),drmethod(r)}
\DoxyCodeLine{2044 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2045 \textcolor{preprocessor}{}}
\DoxyCodeLine{2046 100   \textcolor{keywordflow}{continue}   \textcolor{comment}{! try other methods if error larger than expected}}
\DoxyCodeLine{2047       \textcolor{keywordflow}{if} (min(err\_pv(r),err\_pv2(r)).le.min(err\_g(r),err\_gy(r),err\_gp(r),err\_gr(r),err\_gpf(r))       \&}
\DoxyCodeLine{2048           .and.min(err\_pv(r),err\_pv2(r)).lt.err\_inf) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2049 }
\DoxyCodeLine{2050         \textcolor{keywordflow}{if} (use\_pv.and.err\_pv(r).le.err\_pv2(r).and.mod(drcalc(r),2).ne.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2051 }
\DoxyCodeLine{2052 \textcolor{comment}{!          deallocate(D\_alt)}}
\DoxyCodeLine{2053 \textcolor{comment}{!          deallocate(Duv\_alt)}}
\DoxyCodeLine{2054 \textcolor{comment}{!          deallocate(Derr1\_alt)}}
\DoxyCodeLine{2055 \textcolor{comment}{!          deallocate(Derr2\_alt)}}
\DoxyCodeLine{2056 \textcolor{comment}{!          deallocate(Drmethod\_alt)}}
\DoxyCodeLine{2057 \textcolor{comment}{!          allocate(D\_alt(0:r,0:r,0:r,0:r))}}
\DoxyCodeLine{2058 \textcolor{comment}{!          allocate(Duv\_alt(0:r,0:r,0:r,0:r))}}
\DoxyCodeLine{2059 \textcolor{comment}{!          allocate(Derr1\_alt(0:r))}}
\DoxyCodeLine{2060 \textcolor{comment}{!          allocate(Derr2\_alt(0:r))}}
\DoxyCodeLine{2061 \textcolor{comment}{!          allocate(Drmethod\_alt(0:r))}}
\DoxyCodeLine{2062 }
\DoxyCodeLine{2063 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2064 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: call Dpv 2'},r,id}
\DoxyCodeLine{2065 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2066 \textcolor{preprocessor}{}          }
\DoxyCodeLine{2067 \textcolor{comment}{!         write(*,*) 'CalcDred: Dpv r',r,rmax,p10}}
\DoxyCodeLine{2068 \textcolor{comment}{!         write(*,*) 'CalcDred: Dpv Duv',size(Duv)}}
\DoxyCodeLine{2069 \textcolor{comment}{!         write(*,*) 'CalcDred: Dpv Duv\_alt',size(Duv\_alt)}}
\DoxyCodeLine{2070          }
\DoxyCodeLine{2071 }
\DoxyCodeLine{2072           \textcolor{keywordflow}{if} (r.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2073             \textcolor{keyword}{call }calcdpv1(d\_alt,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,r,id,derr1\_alt,derr2\_alt)}
\DoxyCodeLine{2074           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2075             \textcolor{keyword}{call }calcdpv1(d\_alt(0:r,0:r,0:r,0:r),duv\_alt(0:r,0:r,0:r,0:r),  \&}
\DoxyCodeLine{2076                 p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,r,id,derr1\_alt(0:r),derr2\_alt(0:r))}
\DoxyCodeLine{2077 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2078 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{2079 \textcolor{preprocessor}{}          derr\_alt = derr2\_alt}
\DoxyCodeLine{2080 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2081 \textcolor{preprocessor}{}          derr\_alt = derr1\_alt}
\DoxyCodeLine{2082 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2083 \textcolor{preprocessor}{}          dcount(11) = dcount(11)+1}
\DoxyCodeLine{2084           drcalc(0:r)=drcalc(0:r)+1}
\DoxyCodeLine{2085           dcalc = dcalc+1}
\DoxyCodeLine{2086           drmethod\_alt(0:r)=1}
\DoxyCodeLine{2087           checkest=derr\_alt(r)/err\_pv(r)}
\DoxyCodeLine{2088           }
\DoxyCodeLine{2089 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2090 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_d.or.checkest.lt.1d-\/2*impest\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2091             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: estimate err\_pv imprecise'},err\_pv(r),derr\_alt(r)}
\DoxyCodeLine{2092 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2093 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2094 \textcolor{preprocessor}{}}
\DoxyCodeLine{2095 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2096 \textcolor{preprocessor}{}       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'final loop r Dpv D(1,0,1,0)'},r,d\_alt(1,0,1,0),d(1,0,1,0)}
\DoxyCodeLine{2097        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'final loop r Dpv Derr'},derr\_alt(2),derr(2)}
\DoxyCodeLine{2098 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2099 \textcolor{preprocessor}{}          err\_pv(0:r)=derr\_alt(0:r)}
\DoxyCodeLine{2100 }
\DoxyCodeLine{2101           \textcolor{keyword}{call }copydimp3(d,d\_alt(0:r,0:r,0:r,0:r),derr,derr\_alt(0:r),derr1,derr1\_alt(0:r),   \&}
\DoxyCodeLine{2102               derr2,derr2\_alt(0:r),drmethod,drmethod\_alt(0:r),rmax,r)}
\DoxyCodeLine{2103 }
\DoxyCodeLine{2104           \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2105             dtyp =  max(abs(d(0,0,0,0)),        \&}
\DoxyCodeLine{2106                 abs(d(0,1,0,0)),abs(d(0,0,1,0)),abs(d(0,0,0,1)))}
\DoxyCodeLine{2107           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2108             dtyp =  abs(d(0,0,0,0))}
\DoxyCodeLine{2109 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2110           err\_req\_d = acc\_req\_d * dtyp}
\DoxyCodeLine{2111 }
\DoxyCodeLine{2112 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2113 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after pv 2nd try Dmethod\_alt='},drmethod\_alt}
\DoxyCodeLine{2114           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after pv 2nd try Derr\_alt(r)='},derr\_alt}
\DoxyCodeLine{2115           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after pv 2nd try Dacc\_alt(r)='},derr\_alt/dtyp}
\DoxyCodeLine{2116           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after pv 2nd try Dmethod='},drmethod}
\DoxyCodeLine{2117           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after pv 2nd try Derr(r)='},derr}
\DoxyCodeLine{2118           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after pv 2nd try Dacc(r)='},derr/dtyp}
\DoxyCodeLine{2119 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2120 \textcolor{preprocessor}{}}
\DoxyCodeLine{2121 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2122 \textcolor{preprocessor}{}\textcolor{comment}{!       if(r.gt.2)then}}
\DoxyCodeLine{2123 \textcolor{comment}{!       write(*,*) 'after CalcDpv D(1,0,0,0)',r,D\_alt(1,0,0,0),D(1,0,0,0)}}
\DoxyCodeLine{2124 \textcolor{comment}{!       endif}}
\DoxyCodeLine{2125 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2126 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(checkest.gt.impest\_d.and.mode\_coli.lt.1) \textcolor{keywordflow}{goto} 100     \textcolor{comment}{! error larger than expected: try other methods}}
\DoxyCodeLine{2127           }
\DoxyCodeLine{2128         \textcolor{keywordflow}{elseif} (use\_pv2.and.err\_pv2(r).le.err\_pv(r).and.mod(drcalc(r),4)-\/mod(drcalc(r),2).ne.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2129 }
\DoxyCodeLine{2130 \textcolor{comment}{!          deallocate(D\_alt)}}
\DoxyCodeLine{2131 \textcolor{comment}{!          deallocate(Duv\_alt)}}
\DoxyCodeLine{2132 \textcolor{comment}{!          deallocate(Derr\_alt)}}
\DoxyCodeLine{2133 \textcolor{comment}{!          deallocate(Derr2\_alt)}}
\DoxyCodeLine{2134 \textcolor{comment}{!          deallocate(Drmethod\_alt)}}
\DoxyCodeLine{2135 \textcolor{comment}{!          allocate(D\_alt(0:r,0:r,0:r,0:r))}}
\DoxyCodeLine{2136 \textcolor{comment}{!          allocate(Duv\_alt(0:r,0:r,0:r,0:r))}}
\DoxyCodeLine{2137 \textcolor{comment}{!          allocate(Derr\_alt(0:r))}}
\DoxyCodeLine{2138 \textcolor{comment}{!          allocate(Derr2\_alt(0:r))}}
\DoxyCodeLine{2139 \textcolor{comment}{!          allocate(Drmethod\_alt(0:r))}}
\DoxyCodeLine{2140 }
\DoxyCodeLine{2141 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2142 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: call Dpv2 2'},r,id}
\DoxyCodeLine{2143 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2144 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if} (r.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2145             \textcolor{keyword}{call }calcdpv2(d\_alt,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,r,id,derr1\_alt,derr2\_alt)}
\DoxyCodeLine{2146           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2147             \textcolor{keyword}{call }calcdpv2(d\_alt(0:r,0:r,0:r,0:r),duv\_alt(0:r,0:r,0:r,0:r),  \&}
\DoxyCodeLine{2148                 p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,r,id,derr1\_alt(0:r),derr2\_alt(0:r))}
\DoxyCodeLine{2149 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2150 }
\DoxyCodeLine{2151 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{2152 \textcolor{preprocessor}{}          derr\_alt = derr2\_alt}
\DoxyCodeLine{2153 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2154 \textcolor{preprocessor}{}          derr\_alt = derr1\_alt}
\DoxyCodeLine{2155 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2156 \textcolor{preprocessor}{}          dcount(12) = dcount(12)+1}
\DoxyCodeLine{2157           drcalc(0:r)=drcalc(0:r)+2}
\DoxyCodeLine{2158           dcalc = dcalc+2}
\DoxyCodeLine{2159           drmethod\_alt(0:r)=2}
\DoxyCodeLine{2160           checkest=derr\_alt(r)/err\_pv2(r)}
\DoxyCodeLine{2161           }
\DoxyCodeLine{2162 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2163 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_d.or.checkest.lt.1d-\/2*impest\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2164             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: estimate err\_pv2 imprecise'},err\_pv2(r),derr\_alt(r)}
\DoxyCodeLine{2165 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2166 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2167 \textcolor{preprocessor}{}          err\_pv2(0:r)=derr\_alt(0:r)}
\DoxyCodeLine{2168 }
\DoxyCodeLine{2169 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2170 \textcolor{preprocessor}{}       \textcolor{keywordflow}{if}(r.ge.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2171        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'final loop r Dpv2 D(1,0,1,0)'},r,d\_alt(1,0,1,0),d(1,0,1,0)}
\DoxyCodeLine{2172        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'final loop r Dpv2 Derr'},derr\_alt(2),derr(2)}
\DoxyCodeLine{2173 \textcolor{keywordflow}{       endif}}
\DoxyCodeLine{2174 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2175 \textcolor{preprocessor}{}          \textcolor{keyword}{call }copydimp3(d,d\_alt(0:r,0:r,0:r,0:r),derr,derr\_alt(0:r),derr1,derr1\_alt(0:r),   \&}
\DoxyCodeLine{2176               derr2,derr2\_alt(0:r),drmethod,drmethod\_alt(0:r),rmax,r)}
\DoxyCodeLine{2177 }
\DoxyCodeLine{2178           \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2179             dtyp =  max(abs(d(0,0,0,0)),        \&}
\DoxyCodeLine{2180                 abs(d(0,1,0,0)),abs(d(0,0,1,0)),abs(d(0,0,0,1)))}
\DoxyCodeLine{2181           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2182             dtyp =  abs(d(0,0,0,0))}
\DoxyCodeLine{2183 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2184           err\_req\_d = acc\_req\_d * dtyp}
\DoxyCodeLine{2185 }
\DoxyCodeLine{2186           \textcolor{keywordflow}{if}(checkest.gt.impest\_d.and.mode\_coli.lt.1) \textcolor{keywordflow}{goto} 100     \textcolor{comment}{! error larger than expected: try other methods}}
\DoxyCodeLine{2187           }
\DoxyCodeLine{2188 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2189 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after pv 2nd try Dmethod='},drmethod}
\DoxyCodeLine{2190           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after pv 2nd try Derr(r)='},derr}
\DoxyCodeLine{2191           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after pv 2nd try Dacc(r)='},derr/dtyp}
\DoxyCodeLine{2192 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2193 \textcolor{preprocessor}{}}
\DoxyCodeLine{2194 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{2195 }
\DoxyCodeLine{2196       \textcolor{keywordflow}{else} }
\DoxyCodeLine{2197 }
\DoxyCodeLine{2198 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2199 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: explore exps once more'}}
\DoxyCodeLine{2200 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2201 \textcolor{preprocessor}{}}
\DoxyCodeLine{2202         \textcolor{keywordflow}{if} (use\_g.and.err\_g(r).le.min(err\_gy(r),err\_gp(r),err\_gr(r),err\_gpf(r))        \&}
\DoxyCodeLine{2203             .and.mod(drcalc(r),8)-\/mod(drcalc(r),4).ne.4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2204 }
\DoxyCodeLine{2205 \textcolor{comment}{!          deallocate(D\_alt)}}
\DoxyCodeLine{2206 \textcolor{comment}{!          deallocate(Duv\_alt)}}
\DoxyCodeLine{2207 \textcolor{comment}{!          deallocate(Derr\_alt)}}
\DoxyCodeLine{2208 \textcolor{comment}{!          deallocate(Derr2\_alt)}}
\DoxyCodeLine{2209 \textcolor{comment}{!          deallocate(Drmethod\_alt)}}
\DoxyCodeLine{2210 \textcolor{comment}{!          allocate(D\_alt(0:r,0:r,0:r,0:r))}}
\DoxyCodeLine{2211 \textcolor{comment}{!          allocate(Duv\_alt(0:r,0:r,0:r,0:r))}}
\DoxyCodeLine{2212 \textcolor{comment}{!          allocate(Derr\_alt(0:r))}}
\DoxyCodeLine{2213 \textcolor{comment}{!          allocate(Derr2\_alt(0:r))}}
\DoxyCodeLine{2214 \textcolor{comment}{!          allocate(Drmethod\_alt(0:r))}}
\DoxyCodeLine{2215 }
\DoxyCodeLine{2216           \textcolor{keywordflow}{if} (r.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2217             \textcolor{keyword}{call }calcdg(d\_alt,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,r,g,rmax\_d,id,derr1\_alt,derr2\_alt)}
\DoxyCodeLine{2218           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2219             \textcolor{keyword}{call }calcdg(d\_alt(0:r,0:r,0:r,0:r),duv\_alt(0:r,0:r,0:r,0:r),  \&}
\DoxyCodeLine{2220                 p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,r,g,rmax\_d,id,derr1\_alt(0:r),derr2\_alt(0:r))}
\DoxyCodeLine{2221 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2222 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{2223 \textcolor{preprocessor}{}          derr\_alt = derr2\_alt}
\DoxyCodeLine{2224 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2225 \textcolor{preprocessor}{}          derr\_alt = derr1\_alt}
\DoxyCodeLine{2226 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2227 \textcolor{preprocessor}{}          dcount(13) = dcount(13)+1}
\DoxyCodeLine{2228           drcalc(0:r)=drcalc(0:r)+4}
\DoxyCodeLine{2229           dcalc = dcalc+4}
\DoxyCodeLine{2230           drmethod\_alt(0:r)=4}
\DoxyCodeLine{2231           checkest=derr\_alt(r)/err\_g(r)}
\DoxyCodeLine{2232 }
\DoxyCodeLine{2233 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2234 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_d.or.checkest.lt.1d-\/2*impest\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2235             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: estimate err\_g imprecise '},err\_g(r),derr\_alt(r)}
\DoxyCodeLine{2236 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2237 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2238 \textcolor{preprocessor}{}          }
\DoxyCodeLine{2239           err\_g(0:r)=derr\_alt(0:r)}
\DoxyCodeLine{2240 }
\DoxyCodeLine{2241           \textcolor{keyword}{call }copydimp3(d,d\_alt(0:r,0:r,0:r,0:r),derr,derr\_alt(0:r),derr1,derr1\_alt(0:r),  \&}
\DoxyCodeLine{2242               derr2,derr2\_alt(0:r),drmethod,drmethod\_alt(0:r),rmax,r)}
\DoxyCodeLine{2243 }
\DoxyCodeLine{2244           \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2245             dtyp =  max(abs(d(0,0,0,0)),        \&}
\DoxyCodeLine{2246                 abs(d(0,1,0,0)),abs(d(0,0,1,0)),abs(d(0,0,0,1)))}
\DoxyCodeLine{2247           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2248             dtyp =  abs(d(0,0,0,0))}
\DoxyCodeLine{2249 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2250           err\_req\_d = acc\_req\_d * dtyp}
\DoxyCodeLine{2251 }
\DoxyCodeLine{2252 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2253 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Dmethod='},drmethod}
\DoxyCodeLine{2254           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Derr(r)='},derr}
\DoxyCodeLine{2255           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Dacc(r)='},derr/dtyp}
\DoxyCodeLine{2256 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2257 \textcolor{preprocessor}{}}
\DoxyCodeLine{2258 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2259 \textcolor{preprocessor}{}\textcolor{comment}{!       if(r.gt.2)then}}
\DoxyCodeLine{2260 \textcolor{comment}{!       write(*,*) 'after CalcDg D(1,0,1,0)',r,D\_alt(1,0,1,0),D(1,0,1,0)}}
\DoxyCodeLine{2261 \textcolor{comment}{!       endif}}
\DoxyCodeLine{2262 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2263 \textcolor{preprocessor}{}}
\DoxyCodeLine{2264           \textcolor{keywordflow}{if}(checkest.gt.impest\_d.and.mode\_coli.lt.1) \textcolor{keywordflow}{goto} 100     \textcolor{comment}{! error larger than expected: try other methods}}
\DoxyCodeLine{2265           }
\DoxyCodeLine{2266         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (use\_gy.and.err\_gy(r).le.min(err\_g(r),err\_gp(r),err\_gr(r),err\_gpf(r))        \&}
\DoxyCodeLine{2267             .and.mod(drcalc(r),16)-\/mod(drcalc(r),8).ne.8) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2268 }
\DoxyCodeLine{2269 \textcolor{comment}{!          deallocate(D\_alt)}}
\DoxyCodeLine{2270 \textcolor{comment}{!          deallocate(Duv\_alt)}}
\DoxyCodeLine{2271 \textcolor{comment}{!          deallocate(Derr\_alt)}}
\DoxyCodeLine{2272 \textcolor{comment}{!          deallocate(Derr2\_alt)}}
\DoxyCodeLine{2273 \textcolor{comment}{!          deallocate(Drmethod\_alt)}}
\DoxyCodeLine{2274 \textcolor{comment}{!          allocate(D\_alt(0:r,0:r,0:r,0:r))}}
\DoxyCodeLine{2275 \textcolor{comment}{!          allocate(Duv\_alt(0:r,0:r,0:r,0:r))}}
\DoxyCodeLine{2276 \textcolor{comment}{!          allocate(Derr\_alt(0:r))}}
\DoxyCodeLine{2277 \textcolor{comment}{!          allocate(Derr2\_alt(0:r))}}
\DoxyCodeLine{2278 \textcolor{comment}{!          allocate(Drmethod\_alt(0:r))}}
\DoxyCodeLine{2279 }
\DoxyCodeLine{2280           \textcolor{keywordflow}{if} (r.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2281             \textcolor{keyword}{call }calcdgy(d\_alt,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,r,gy,(rmax\_d)/2,id,derr1\_alt,derr2\_alt)}
\DoxyCodeLine{2282           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2283             \textcolor{keyword}{call }calcdgy(d\_alt(0:r,0:r,0:r,0:r),duv\_alt(0:r,0:r,0:r,0:r),   \&}
\DoxyCodeLine{2284                 p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,r,gy,(rmax\_d)/2,id,derr1\_alt(0:r),derr2\_alt(0:r))}
\DoxyCodeLine{2285 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2286 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{2287 \textcolor{preprocessor}{}          derr\_alt = derr2\_alt}
\DoxyCodeLine{2288 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2289 \textcolor{preprocessor}{}          derr\_alt = derr1\_alt}
\DoxyCodeLine{2290 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2291 \textcolor{preprocessor}{}          dcount(14) = dcount(14)+1}
\DoxyCodeLine{2292           drcalc(0:r)=drcalc(0:r)+8}
\DoxyCodeLine{2293           dcalc = dcalc+8}
\DoxyCodeLine{2294           drmethod\_alt(0:r)=8}
\DoxyCodeLine{2295           checkest=derr\_alt(r)/err\_gy(r)}
\DoxyCodeLine{2296 }
\DoxyCodeLine{2297 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2298 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_d.or.checkest.lt.1d-\/2*impest\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2299             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: estimate err\_gy imprecise'},err\_gy(r),derr\_alt(r)}
\DoxyCodeLine{2300 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2301 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2302 \textcolor{preprocessor}{}          }
\DoxyCodeLine{2303           err\_gy(0:r)=derr\_alt(0:r)}
\DoxyCodeLine{2304 }
\DoxyCodeLine{2305           \textcolor{keyword}{call }copydimp3(d,d\_alt(0:r,0:r,0:r,0:r),derr,derr\_alt(0:r),derr1,derr1\_alt(0:r),  \&}
\DoxyCodeLine{2306               derr2,derr2\_alt(0:r),drmethod,drmethod\_alt(0:r),rmax,r)}
\DoxyCodeLine{2307 }
\DoxyCodeLine{2308           \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2309             dtyp =  max(abs(d(0,0,0,0)),        \&}
\DoxyCodeLine{2310                 abs(d(0,1,0,0)),abs(d(0,0,1,0)),abs(d(0,0,0,1)))}
\DoxyCodeLine{2311           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2312             dtyp =  abs(d(0,0,0,0))}
\DoxyCodeLine{2313 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2314           err\_req\_d = acc\_req\_d * dtyp}
\DoxyCodeLine{2315 }
\DoxyCodeLine{2316 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2317 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Dmethod='},drmethod}
\DoxyCodeLine{2318           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Derr(r)='},derr}
\DoxyCodeLine{2319           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Dacc(r)='},derr/dtyp}
\DoxyCodeLine{2320 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2321 \textcolor{preprocessor}{}}
\DoxyCodeLine{2322 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2323 \textcolor{preprocessor}{}\textcolor{comment}{!       if(rmax.ge.3)then}}
\DoxyCodeLine{2324 \textcolor{comment}{!       write(*,*) 'after CalcDgy D(1,0,0,0)',r,D\_alt(1,0,0,0),D(1,0,0,0)}}
\DoxyCodeLine{2325 \textcolor{comment}{!       endif}}
\DoxyCodeLine{2326 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2327 \textcolor{preprocessor}{}}
\DoxyCodeLine{2328           \textcolor{keywordflow}{if}(checkest.gt.impest\_d.and.mode\_coli.lt.1) \textcolor{keywordflow}{goto} 100     \textcolor{comment}{! error larger than expected: try other methods}}
\DoxyCodeLine{2329 }
\DoxyCodeLine{2330         \textcolor{keywordflow}{elseif} (use\_gp.and.err\_gp(r).le.min(err\_g(r),err\_gy(r),err\_gr(r),err\_gpf(r))    \&}
\DoxyCodeLine{2331             .and.mod(drcalc(r),32)-\/mod(drcalc(r),16).ne.16) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2332 }
\DoxyCodeLine{2333 \textcolor{comment}{!          deallocate(D\_alt)}}
\DoxyCodeLine{2334 \textcolor{comment}{!          deallocate(Duv\_alt)}}
\DoxyCodeLine{2335 \textcolor{comment}{!          deallocate(Derr\_alt)}}
\DoxyCodeLine{2336 \textcolor{comment}{!          deallocate(Derr2\_alt)}}
\DoxyCodeLine{2337 \textcolor{comment}{!          deallocate(Drmethod\_alt)}}
\DoxyCodeLine{2338 \textcolor{comment}{!          allocate(D\_alt(0:r,0:r,0:r,0:r))}}
\DoxyCodeLine{2339 \textcolor{comment}{!          allocate(Duv\_alt(0:r,0:r,0:r,0:r))}}
\DoxyCodeLine{2340 \textcolor{comment}{!          allocate(Derr\_alt(0:r))}}
\DoxyCodeLine{2341 \textcolor{comment}{!          allocate(Derr2\_alt(0:r))}}
\DoxyCodeLine{2342 \textcolor{comment}{!          allocate(Drmethod\_alt(0:r))}}
\DoxyCodeLine{2343 }
\DoxyCodeLine{2344           \textcolor{keywordflow}{if} (r.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2345             \textcolor{keyword}{call }calcdgp(d\_alt,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,r,gp,rmax\_d,id,derr1\_alt,derr2\_alt)}
\DoxyCodeLine{2346           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2347             \textcolor{keyword}{call }calcdgp(d\_alt(0:r,0:r,0:r,0:r),duv\_alt(0:r,0:r,0:r,0:r),   \&}
\DoxyCodeLine{2348                 p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,r,gp,rmax\_d,id,derr1\_alt(0:r),derr2\_alt(0:r))}
\DoxyCodeLine{2349 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{2350 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{2351 \textcolor{preprocessor}{}          derr\_alt = derr2\_alt}
\DoxyCodeLine{2352 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2353 \textcolor{preprocessor}{}          derr\_alt = derr1\_alt}
\DoxyCodeLine{2354 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2355 \textcolor{preprocessor}{}          dcount(15) = dcount(15)+1}
\DoxyCodeLine{2356           drcalc(0:r)=drcalc(0:r)+16}
\DoxyCodeLine{2357           dcalc = dcalc+16}
\DoxyCodeLine{2358           drmethod\_alt(0:r)=16}
\DoxyCodeLine{2359           checkest=derr\_alt(r)/err\_gp(r)}
\DoxyCodeLine{2360 }
\DoxyCodeLine{2361 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2362 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_d.or.checkest.lt.1d-\/2*impest\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2363             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: estimate err\_gp imprecise'},err\_gp(r),derr\_alt(r)}
\DoxyCodeLine{2364 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2365 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2366 \textcolor{preprocessor}{}          }
\DoxyCodeLine{2367           err\_gp(0:r)=derr\_alt(0:r)}
\DoxyCodeLine{2368 }
\DoxyCodeLine{2369           \textcolor{keyword}{call }copydimp3(d,d\_alt(0:r,0:r,0:r,0:r),derr,derr\_alt(0:r),derr1,derr1\_alt(0:r),   \&}
\DoxyCodeLine{2370               derr2,derr2\_alt(0:r),drmethod,drmethod\_alt(0:r),rmax,r)}
\DoxyCodeLine{2371 }
\DoxyCodeLine{2372           \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2373             dtyp =  max(abs(d(0,0,0,0)),        \&}
\DoxyCodeLine{2374                 abs(d(0,1,0,0)),abs(d(0,0,1,0)),abs(d(0,0,0,1)))}
\DoxyCodeLine{2375           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2376             dtyp =  abs(d(0,0,0,0))}
\DoxyCodeLine{2377 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2378           err\_req\_d = acc\_req\_d * dtyp}
\DoxyCodeLine{2379 }
\DoxyCodeLine{2380 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2381 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Dmethod='},drmethod}
\DoxyCodeLine{2382           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Derr(r)='},derr}
\DoxyCodeLine{2383           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Dacc(r)='},derr/dtyp}
\DoxyCodeLine{2384 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2385 \textcolor{preprocessor}{}}
\DoxyCodeLine{2386           \textcolor{keywordflow}{if}(checkest.gt.impest\_d.and.mode\_coli.lt.1) \textcolor{keywordflow}{goto} 100     \textcolor{comment}{! error larger than expected: try other methods}}
\DoxyCodeLine{2387           }
\DoxyCodeLine{2388         \textcolor{keywordflow}{elseif} (use\_gr.and.err\_gr(r).le.min(err\_g(r),err\_gy(r),err\_gp(r),err\_gpf(r))        \&}
\DoxyCodeLine{2389             .and.mod(drcalc(r),64)-\/mod(drcalc(r),32).ne.32) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2390 }
\DoxyCodeLine{2391 \textcolor{comment}{!          deallocate(D\_alt)}}
\DoxyCodeLine{2392 \textcolor{comment}{!          deallocate(Duv\_alt)}}
\DoxyCodeLine{2393 \textcolor{comment}{!          deallocate(Derr\_alt)}}
\DoxyCodeLine{2394 \textcolor{comment}{!          deallocate(Derr2\_alt)}}
\DoxyCodeLine{2395 \textcolor{comment}{!          deallocate(Drmethod\_alt)}}
\DoxyCodeLine{2396 \textcolor{comment}{!          allocate(D\_alt(0:r,0:r,0:r,0:r))}}
\DoxyCodeLine{2397 \textcolor{comment}{!          allocate(Duv\_alt(0:r,0:r,0:r,0:r))}}
\DoxyCodeLine{2398 \textcolor{comment}{!          allocate(Derr\_alt(0:r))}}
\DoxyCodeLine{2399 \textcolor{comment}{!          allocate(Derr2\_alt(0:r))}}
\DoxyCodeLine{2400 \textcolor{comment}{!          allocate(Drmethod\_alt(0:r))}}
\DoxyCodeLine{2401 }
\DoxyCodeLine{2402           \textcolor{keywordflow}{if} (r.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2403             \textcolor{keyword}{call }calcdgr(d\_alt,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,r,gr,rmax\_d,id,derr1\_alt,derr2\_alt)}
\DoxyCodeLine{2404           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2405             \textcolor{keyword}{call }calcdgr(d\_alt(0:r,0:r,0:r,0:r),duv\_alt(0:r,0:r,0:r,0:r),  \&}
\DoxyCodeLine{2406                 p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,r,gr,rmax\_d,id,derr1\_alt(0:r),derr2\_alt(0:r))}
\DoxyCodeLine{2407 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{2408 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{2409 \textcolor{preprocessor}{}          derr\_alt = derr2\_alt}
\DoxyCodeLine{2410 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2411 \textcolor{preprocessor}{}          derr\_alt = derr1\_alt}
\DoxyCodeLine{2412 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2413 \textcolor{preprocessor}{}          dcount(16) = dcount(16)+1}
\DoxyCodeLine{2414           drcalc(0:r)=drcalc(0:r)+32}
\DoxyCodeLine{2415           dcalc = dcalc+32}
\DoxyCodeLine{2416           drmethod\_alt(0:r)=32}
\DoxyCodeLine{2417           checkest=derr\_alt(r)/err\_gr(r)}
\DoxyCodeLine{2418 }
\DoxyCodeLine{2419 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2420 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_d.or.checkest.lt.1d-\/2*impest\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2421             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: estimate err\_gr imprecise'},err\_gr(r),derr\_alt(r)}
\DoxyCodeLine{2422 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2423 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2424 \textcolor{preprocessor}{}          }
\DoxyCodeLine{2425           err\_gr(0:r)=derr\_alt(0:r)}
\DoxyCodeLine{2426 }
\DoxyCodeLine{2427           \textcolor{keyword}{call }copydimp3(d,d\_alt(0:r,0:r,0:r,0:r),derr,derr\_alt(0:r),derr1,derr1\_alt(0:r),    \&  }
\DoxyCodeLine{2428               derr2,derr2\_alt(0:r),drmethod,drmethod\_alt(0:r),rmax,r)}
\DoxyCodeLine{2429  }
\DoxyCodeLine{2430           \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2431             dtyp =  max(abs(d(0,0,0,0)),        \&}
\DoxyCodeLine{2432                 abs(d(0,1,0,0)),abs(d(0,0,1,0)),abs(d(0,0,0,1)))}
\DoxyCodeLine{2433           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2434             dtyp =  abs(d(0,0,0,0))}
\DoxyCodeLine{2435 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2436           err\_req\_d = acc\_req\_d * dtyp}
\DoxyCodeLine{2437 }
\DoxyCodeLine{2438 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2439 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Dmethod='},drmethod}
\DoxyCodeLine{2440           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Derr(r)='},derr}
\DoxyCodeLine{2441           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Dacc(r)='},derr/dtyp}
\DoxyCodeLine{2442 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2443 \textcolor{preprocessor}{}}
\DoxyCodeLine{2444           \textcolor{keywordflow}{if}(checkest.gt.impest\_d.and.mode\_coli.lt.1) \textcolor{keywordflow}{goto} 100     \textcolor{comment}{! error larger than expected: try other methods}}
\DoxyCodeLine{2445           }
\DoxyCodeLine{2446 }
\DoxyCodeLine{2447 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2448 \textcolor{preprocessor}{}\textcolor{comment}{!     if(r.gt.2)then}}
\DoxyCodeLine{2449 \textcolor{comment}{!       write(*,*) 'CalcDred D(1,0,1,0)',r,D(1,0,1,0)}}
\DoxyCodeLine{2450 \textcolor{comment}{!     endif}}
\DoxyCodeLine{2451 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2452 \textcolor{preprocessor}{}}
\DoxyCodeLine{2453         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (use\_gpf.and.err\_gpf(r).le.min(err\_g(r),err\_gy(r),err\_gp(r),err\_gr(r))        \&}
\DoxyCodeLine{2454             .and.mod(drcalc(r),128)-\/mod(drcalc(r),64).ne.64) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2455 }
\DoxyCodeLine{2456           \textcolor{keywordflow}{if} (r.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2457             \textcolor{keyword}{call }calcdgpf(d\_alt,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,r,gpf,(rmax\_d)/2,id,derr1\_alt,derr2\_alt)}
\DoxyCodeLine{2458           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2459             \textcolor{keyword}{call }calcdgpf(d\_alt(0:r,0:r,0:r,0:r),duv\_alt(0:r,0:r,0:r,0:r),   \&}
\DoxyCodeLine{2460                 p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,r,gpf,(rmax\_d)/2,id,derr1\_alt(0:r),derr2\_alt(0:r))}
\DoxyCodeLine{2461 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2462 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{2463 \textcolor{preprocessor}{}          derr\_alt = derr2\_alt}
\DoxyCodeLine{2464 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2465 \textcolor{preprocessor}{}          derr\_alt = derr1\_alt}
\DoxyCodeLine{2466 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2467 \textcolor{preprocessor}{}          dcount(17) = dcount(17)+1}
\DoxyCodeLine{2468           drcalc(0:r)=drcalc(0:r)+64}
\DoxyCodeLine{2469           dcalc = dcalc+64}
\DoxyCodeLine{2470           drmethod\_alt(0:r)=64}
\DoxyCodeLine{2471           checkest=derr\_alt(r)/err\_gpf(r)}
\DoxyCodeLine{2472 }
\DoxyCodeLine{2473 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2474 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_d.or.checkest.lt.1d-\/2*impest\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2475             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: estimate err\_gpf imprecise'},err\_gpf(r),derr\_alt(r)}
\DoxyCodeLine{2476 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2477 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2478 \textcolor{preprocessor}{}          }
\DoxyCodeLine{2479           err\_gpf(0:r)=derr\_alt(0:r)}
\DoxyCodeLine{2480           \textcolor{keyword}{call }copydimp3(d,d\_alt(0:r,0:r,0:r,0:r),derr,derr\_alt(0:r),derr1,derr1\_alt(0:r),  \&}
\DoxyCodeLine{2481               derr2,derr2\_alt(0:r),drmethod,drmethod\_alt(0:r),rmax,r)}
\DoxyCodeLine{2482 }
\DoxyCodeLine{2483           \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2484             dtyp =  max(abs(d(0,0,0,0)),        \&}
\DoxyCodeLine{2485                 abs(d(0,1,0,0)),abs(d(0,0,1,0)),abs(d(0,0,0,1)))}
\DoxyCodeLine{2486           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2487             dtyp =  abs(d(0,0,0,0))}
\DoxyCodeLine{2488 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2489           err\_req\_d = acc\_req\_d * dtyp}
\DoxyCodeLine{2490 }
\DoxyCodeLine{2491 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2492 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Dmethod='},drmethod}
\DoxyCodeLine{2493           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Derr(r)='},derr}
\DoxyCodeLine{2494           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Dacc(r)='},derr/dtyp}
\DoxyCodeLine{2495 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2496 \textcolor{preprocessor}{}}
\DoxyCodeLine{2497 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2498 \textcolor{preprocessor}{}\textcolor{comment}{!       if(rmax.ge.3)then}}
\DoxyCodeLine{2499 \textcolor{comment}{!       write(*,*) 'after CalcDgpf D(1,0,0,0)',r,D\_alt(1,0,0,0),D(1,0,0,0)}}
\DoxyCodeLine{2500 \textcolor{comment}{!       endif}}
\DoxyCodeLine{2501 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2502 \textcolor{preprocessor}{}}
\DoxyCodeLine{2503           \textcolor{keywordflow}{if}(checkest.gt.impest\_d.and.mode\_coli.lt.1) \textcolor{keywordflow}{goto} 100     \textcolor{comment}{! error larger than expected: try other methods}}
\DoxyCodeLine{2504 }
\DoxyCodeLine{2505 \textcolor{preprocessor}{\#ifdef USEGM}}
\DoxyCodeLine{2506 \textcolor{preprocessor}{}        \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (use\_gm.and.err\_gm(r).le.min(err\_gy(r),err\_gp(r),err\_gr(r),err\_g(r))        \&}
\DoxyCodeLine{2507             .and.mod(drcalc(r),128)-\/mod(drcalc(r),64).ne.64) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2508 }
\DoxyCodeLine{2509 \textcolor{comment}{!          deallocate(D\_alt)}}
\DoxyCodeLine{2510 \textcolor{comment}{!          deallocate(Duv\_alt)}}
\DoxyCodeLine{2511 \textcolor{comment}{!          deallocate(Derr\_alt)}}
\DoxyCodeLine{2512 \textcolor{comment}{!          deallocate(Derr2\_alt)}}
\DoxyCodeLine{2513 \textcolor{comment}{!          deallocate(Drmethod\_alt)}}
\DoxyCodeLine{2514 \textcolor{comment}{!          allocate(D\_alt(0:r,0:r,0:r,0:r))}}
\DoxyCodeLine{2515 \textcolor{comment}{!          allocate(Duv\_alt(0:r,0:r,0:r,0:r))}}
\DoxyCodeLine{2516 \textcolor{comment}{!          allocate(Derr\_alt(0:r))}}
\DoxyCodeLine{2517 \textcolor{comment}{!          allocate(Derr2\_alt(0:r))}}
\DoxyCodeLine{2518 \textcolor{comment}{!          allocate(Drmethod\_alt(0:r))}}
\DoxyCodeLine{2519 }
\DoxyCodeLine{2520           \textcolor{keywordflow}{if} (r.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2521             \textcolor{keyword}{call }calcdgm(d\_alt,duv,p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,r,g,rmax\_d,id,derr1\_alt,derr2\_alt)}
\DoxyCodeLine{2522           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2523             \textcolor{keyword}{call }calcdgm(d\_alt(0:r,0:r,0:r,0:r),duv\_alt(0:r,0:r,0:r,0:r),  \&}
\DoxyCodeLine{2524                 p10,p21,p32,p30,p20,p31,m02,m12,m22,m32,r,g,rmax\_d,id,derr1\_alt(0:r),derr2\_alt(0:r))}
\DoxyCodeLine{2525 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2526 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{2527 \textcolor{preprocessor}{}          derr\_alt = derr2\_alt}
\DoxyCodeLine{2528 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2529 \textcolor{preprocessor}{}          derr\_alt = derr1\_alt}
\DoxyCodeLine{2530 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2531 \textcolor{preprocessor}{}          dcount(17) = dcount(17)+1}
\DoxyCodeLine{2532           drcalc(0:r)=drcalc(0:r)+64}
\DoxyCodeLine{2533           dcalc = dcalc+64}
\DoxyCodeLine{2534           drmethod\_alt(0:r)=64}
\DoxyCodeLine{2535           checkest=derr\_alt(r)/err\_gm(r)}
\DoxyCodeLine{2536 }
\DoxyCodeLine{2537 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2538 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_d.or.checkest.lt.1d-\/2*impest\_d) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2539             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: estimate err\_g imprecise '},err\_gm(r),derr\_alt(r)}
\DoxyCodeLine{2540 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2541 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2542 \textcolor{preprocessor}{}          }
\DoxyCodeLine{2543           err\_gm(0:r)=derr\_alt(0:r)}
\DoxyCodeLine{2544 }
\DoxyCodeLine{2545           \textcolor{keyword}{call }copydimp3(d,d\_alt(0:r,0:r,0:r,0:r),derr,derr\_alt(0:r),derr1,derr1\_alt(0:r),  \&  }
\DoxyCodeLine{2546               derr2,derr2\_alt(0:r),drmethod,drmethod\_alt(0:r),rmax,r)}
\DoxyCodeLine{2547 }
\DoxyCodeLine{2548           \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2549             dtyp =  max(abs(d(0,0,0,0)),        \&}
\DoxyCodeLine{2550                 abs(d(0,1,0,0)),abs(d(0,0,1,0)),abs(d(0,0,0,1)))}
\DoxyCodeLine{2551           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2552             dtyp =  abs(d(0,0,0,0))}
\DoxyCodeLine{2553 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2554           err\_req\_d = acc\_req\_d * dtyp}
\DoxyCodeLine{2555 }
\DoxyCodeLine{2556 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2557 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Dmethod='},drmethod}
\DoxyCodeLine{2558           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Derr(r)='},derr}
\DoxyCodeLine{2559           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: after exp 2nd try Dacc(r)='},derr/dtyp}
\DoxyCodeLine{2560 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2561 \textcolor{preprocessor}{}}
\DoxyCodeLine{2562 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2563 \textcolor{preprocessor}{}\textcolor{comment}{!       if(r.gt.2)then}}
\DoxyCodeLine{2564 \textcolor{comment}{!       write(*,*) 'after CalcDg D(1,0,1,0)',r,D\_alt(1,0,1,0),D(1,0,1,0)}}
\DoxyCodeLine{2565 \textcolor{comment}{!       endif}}
\DoxyCodeLine{2566 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2567 \textcolor{preprocessor}{}}
\DoxyCodeLine{2568           \textcolor{keywordflow}{if}(checkest.gt.impest\_d.and.mode\_coli.lt.1) \textcolor{keywordflow}{goto} 100     \textcolor{comment}{! error larger than expected: try other methods}}
\DoxyCodeLine{2569 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2570 \textcolor{preprocessor}{}          }
\DoxyCodeLine{2571 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{2572 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{2573 }
\DoxyCodeLine{2574 \textcolor{preprocessor}{\#ifndef USED0}}
\DoxyCodeLine{2575 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifndef ALWAYSPV}}
\DoxyCodeLine{2576 \textcolor{preprocessor}{}      \textcolor{comment}{! refine error estimate for D0}}
\DoxyCodeLine{2577       \textcolor{keywordflow}{if}(.not.lerr\_d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2578 \textcolor{comment}{!        D0est =  abs(D(0,0,0,0))}}
\DoxyCodeLine{2579         err\_d0 = acc\_def\_d0*max( abs(d(0,0,0,0)), 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}) )}
\DoxyCodeLine{2580 \textcolor{comment}{!        err\_req\_D = acc\_req\_D * abs(D(0,0,0,0))}}
\DoxyCodeLine{2581         lerr\_d0 = .true.}
\DoxyCodeLine{2582 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{2583 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2584 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2585 \textcolor{preprocessor}{}}
\DoxyCodeLine{2586 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2587 \textcolor{preprocessor}{}\textcolor{comment}{!       if(r.ge.2) then}}
\DoxyCodeLine{2588 \textcolor{comment}{!       write(*,*) 'after r CalcDg D(1,0,1,0)',r,D\_alt(1,0,1,0),D(1,0,1,0)}}
\DoxyCodeLine{2589 \textcolor{comment}{!       write(*,*) 'after r CalcDg Derr',Derr\_alt(2),Derr(2)}}
\DoxyCodeLine{2590 \textcolor{comment}{!       endif}}
\DoxyCodeLine{2591 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2592 \textcolor{preprocessor}{}}
\DoxyCodeLine{2593 }
\DoxyCodeLine{2594 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2595 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: final loop err methods'},r,err\_pv(r),err\_pv2(r), \&}
\DoxyCodeLine{2596           err\_g(r),err\_gy(r),err\_gp(r),err\_gr(r),err\_gm(r),err\_gpf(r)}
\DoxyCodeLine{2597       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: final loop acc methods'},r,err\_pv(r)/dtyp,err\_pv2(r)/dtyp,   \&}
\DoxyCodeLine{2598           err\_g(r)/dtyp,err\_gy(r)/dtyp,err\_gp(r)/dtyp, \&}
\DoxyCodeLine{2599           err\_gr(r)/dtyp,err\_gm(r)/dtyp,err\_gpf(r)/dtyp}
\DoxyCodeLine{2600       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred: final loop method'},r,drcalc(r),drmethod(r)}
\DoxyCodeLine{2601 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2602 \textcolor{preprocessor}{}}
\DoxyCodeLine{2603 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{2604 }
\DoxyCodeLine{2605     norm = abs(d(0,0,0,0))}
\DoxyCodeLine{2606 }
\DoxyCodeLine{2607     \textcolor{keywordflow}{do} r=1,rmax}
\DoxyCodeLine{2608       \textcolor{keywordflow}{do} n1=0,rmax}
\DoxyCodeLine{2609         \textcolor{keywordflow}{do} n2=0,rmax-\/n1}
\DoxyCodeLine{2610           n3 = rmax-\/n1-\/n2}
\DoxyCodeLine{2611           norm =  max(norm,abs(d(0,n1,n2,n3)))}
\DoxyCodeLine{2612 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{2613 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{2614 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{2615     acc\_d = derr(rmax)/norm}
\DoxyCodeLine{2616 }
\DoxyCodeLine{2617     dcount(dcalc+dcountoffset0) = dcount(dcalc+dcountoffset0)+1}
\DoxyCodeLine{2618 }
\DoxyCodeLine{2619 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2620 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred final err\_D='},derr}
\DoxyCodeLine{2621     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred final acc\_D='},derr/norm,critacc\_coli}
\DoxyCodeLine{2622     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred final method\_D='},drmethod}
\DoxyCodeLine{2623 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2624 \textcolor{preprocessor}{}}
\DoxyCodeLine{2625     \textcolor{keywordflow}{if} (acc\_d.gt.sqrt(reqacc\_coli)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2626       dcount(dcalc+dcountoffset3) = dcount(dcalc+dcountoffset3)+1}
\DoxyCodeLine{2627 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{2628 }
\DoxyCodeLine{2629     \textcolor{keywordflow}{if} (acc\_d.gt.reqacc\_coli) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2630       dcount(dcalc+dcountoffset1) = dcount(dcalc+dcountoffset1)+1}
\DoxyCodeLine{2631 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{2632 }
\DoxyCodeLine{2633     \textcolor{keywordflow}{if} (acc\_d.gt.critacc\_coli) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2634 }
\DoxyCodeLine{2635       dcount(dcalc+dcountoffset2) = dcount(dcalc+dcountoffset2)+1}
\DoxyCodeLine{2636 }
\DoxyCodeLine{2637 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2638 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CritPoint D'},critacc\_coli,acc\_d}
\DoxyCodeLine{2639       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CritPoint D'},critpointcntd,maxcritpointd}
\DoxyCodeLine{2640 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{2641 \textcolor{preprocessor}{}}
\DoxyCodeLine{2642 \textcolor{comment}{!      call SetErrFlag\_coli(-\/5)}}
\DoxyCodeLine{2643 \textcolor{comment}{!      call ErrOut\_coli('CalcDred',' critical accuracy not reached',  \&}}
\DoxyCodeLine{2644 \textcolor{comment}{!         errorwriteflag)}}
\DoxyCodeLine{2645 }
\DoxyCodeLine{2646 \textcolor{preprocessor}{\#ifdef CritPointsCOLI }}
\DoxyCodeLine{2647 \textcolor{preprocessor}{}      critpointcntd = critpointcntd + 1    }
\DoxyCodeLine{2648 }
\DoxyCodeLine{2649       \textcolor{keywordflow}{if} (critpointcntd.le.maxcritpointd.and.monitoring) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2650 }
\DoxyCodeLine{2651         \textcolor{keyword}{call }critpointsout\_coli(\textcolor{stringliteral}{'D\_coli'},acc\_d)}
\DoxyCodeLine{2652         \textcolor{keyword}{write}(ncpout\_coli,*) \textcolor{stringliteral}{'arguments of CalcDred\_coli:'}}
\DoxyCodeLine{2653         \textcolor{keyword}{write}(ncpout\_coli,*) \textcolor{stringliteral}{'rank = '}, rmax}
\DoxyCodeLine{2654         \textcolor{keyword}{write}(ncpout\_coli,fmt1) \textcolor{stringliteral}{'p10 = '}, p10}
\DoxyCodeLine{2655         \textcolor{keyword}{write}(ncpout\_coli,fmt1) \textcolor{stringliteral}{'p21 = '}, p21}
\DoxyCodeLine{2656         \textcolor{keyword}{write}(ncpout\_coli,fmt1) \textcolor{stringliteral}{'p32 = '}, p32}
\DoxyCodeLine{2657         \textcolor{keyword}{write}(ncpout\_coli,fmt1) \textcolor{stringliteral}{'p30 = '}, p30}
\DoxyCodeLine{2658         \textcolor{keyword}{write}(ncpout\_coli,fmt1) \textcolor{stringliteral}{'p20 = '}, p20}
\DoxyCodeLine{2659         \textcolor{keyword}{write}(ncpout\_coli,fmt1) \textcolor{stringliteral}{'p31 = '}, p31}
\DoxyCodeLine{2660         \textcolor{keyword}{write}(ncpout\_coli,fmt1) \textcolor{stringliteral}{'m02 = '}, m02}
\DoxyCodeLine{2661         \textcolor{keyword}{write}(ncpout\_coli,fmt1) \textcolor{stringliteral}{'m12 = '}, m12}
\DoxyCodeLine{2662         \textcolor{keyword}{write}(ncpout\_coli,fmt1) \textcolor{stringliteral}{'m22 = '}, m22}
\DoxyCodeLine{2663         \textcolor{keyword}{write}(ncpout\_coli,fmt1) \textcolor{stringliteral}{'m32 = '}, m32}
\DoxyCodeLine{2664         \textcolor{keywordflow}{if} (critpointcntd.eq.maxcritpointd) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2665           \textcolor{keyword}{write}(ncpout\_coli,*)}
\DoxyCodeLine{2666           \textcolor{keyword}{write}(ncpout\_coli,*)}
\DoxyCodeLine{2667           \textcolor{keyword}{write}(ncpout\_coli,*)}
\DoxyCodeLine{2668           \textcolor{keyword}{write}(ncpout\_coli,*) \textcolor{stringliteral}{'***********************************************************'}}
\DoxyCodeLine{2669           \textcolor{keyword}{write}(ncpout\_coli,*)}
\DoxyCodeLine{2670           \textcolor{keyword}{write}(ncpout\_coli,*) \textcolor{stringliteral}{' Further output of bad D functions will be suppressed '}}
\DoxyCodeLine{2671 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{2672 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{2673 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2674 \textcolor{preprocessor}{}\textcolor{keywordflow}{    end if}}
\DoxyCodeLine{2675 }
\DoxyCodeLine{2676 \textcolor{preprocessor}{\#ifdef Dredtest}}
\DoxyCodeLine{2677 \textcolor{preprocessor}{}       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDred exit D(1,0,0,0)'},r,d\_alt(1,0,0,0),d(1,0,0,0)}
\DoxyCodeLine{2678 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2679 \textcolor{preprocessor}{}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiond_a537a9b81a52414b89483076d05a402bb}\label{namespacereductiond_a537a9b81a52414b89483076d05a402bb}} 
\index{reductiond@{reductiond}!calcduv@{calcduv}}
\index{calcduv@{calcduv}!reductiond@{reductiond}}
\doxysubsubsection{\texorpdfstring{calcduv()}{calcduv()}}
{\footnotesize\ttfamily subroutine reductiond\+::calcduv (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(inout)}]{Duv,  }\item[{double complex, dimension(0\+:rmax-\/1,0\+:rmax-\/1,0\+:rmax-\/1,0\+:rmax-\/1), intent(in)}]{Cuv\+\_\+0,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, dimension(3), intent(in)}]{f,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id }\end{DoxyParamCaption})}



Definition at line 2694 of file reduction\+D.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2694   }
\DoxyCodeLine{2695     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,id}
\DoxyCodeLine{2696     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: m02,f(3)}
\DoxyCodeLine{2697     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(inout)} :: Duv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2698     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: Cuv\_0(0:rmax-\/1,0:rmax-\/1,0:rmax-\/1,0:rmax-\/1)}
\DoxyCodeLine{2699     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3}
\DoxyCodeLine{2700         }
\DoxyCodeLine{2701     \textcolor{comment}{! D\_(n0,n1,n2,n3) UV-\/finite for n0<2}}
\DoxyCodeLine{2702     duv(0:min(rmax,1),:,:,:) = 0d0}
\DoxyCodeLine{2703     }
\DoxyCodeLine{2704     \textcolor{comment}{! PV reduction (5.10)}}
\DoxyCodeLine{2705 \textcolor{comment}{!    do r=4,rmax}}
\DoxyCodeLine{2706 \textcolor{comment}{!      do n0=2,r/2}}
\DoxyCodeLine{2707     \textcolor{keywordflow}{do} r=4,rmax+1}
\DoxyCodeLine{2708       \textcolor{keywordflow}{do} n0=max(2,r-\/rmax),r/2}
\DoxyCodeLine{2709         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{2710           \textcolor{keywordflow}{do} n2=0,r-\/2*n0-\/n1}
\DoxyCodeLine{2711             n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{2712         }
\DoxyCodeLine{2713             duv(n0,n1,n2,n3) = (cuv\_0(n0-\/1,n1,n2,n3) + 2*m02*duv(n0-\/1,n1,n2,n3)  \&}
\DoxyCodeLine{2714                                 + f(1)*duv(n0-\/1,n1+1,n2,n3)  \& }
\DoxyCodeLine{2715                                 + f(2)*duv(n0-\/1,n1,n2+1,n3)  \& }
\DoxyCodeLine{2716                                 + f(3)*duv(n0-\/1,n1,n2,n3+1)) / (2*(r-\/1))}
\DoxyCodeLine{2717     }
\DoxyCodeLine{2718 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{2719 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{2720 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{2721 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{2722     }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiond_a17b840a4e6732340891e224e6f0f8995}\label{namespacereductiond_a17b840a4e6732340891e224e6f0f8995}} 
\index{reductiond@{reductiond}!copydimp3@{copydimp3}}
\index{copydimp3@{copydimp3}!reductiond@{reductiond}}
\doxysubsubsection{\texorpdfstring{copydimp3()}{copydimp3()}}
{\footnotesize\ttfamily subroutine reductiond\+::copydimp3 (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax,0\+:rmax), intent(inout)}]{D,  }\item[{double complex, dimension(0\+:r\+\_\+alt,0\+:r\+\_\+alt,0\+:r\+\_\+alt,0\+:r\+\_\+alt), intent(in)}]{D\+\_\+alt,  }\item[{double precision, dimension(0\+:rmax), intent(inout)}]{Derr,  }\item[{double precision, dimension(0\+:r\+\_\+alt), intent(in)}]{Derr\+\_\+alt,  }\item[{double precision, dimension(0\+:rmax), intent(inout)}]{Derr1,  }\item[{double precision, dimension(0\+:r\+\_\+alt), intent(in)}]{Derr1\+\_\+alt,  }\item[{double precision, dimension(0\+:rmax), intent(inout)}]{Derr2,  }\item[{double precision, dimension(0\+:r\+\_\+alt), intent(in)}]{Derr2\+\_\+alt,  }\item[{integer, dimension(0\+:rmax), intent(inout)}]{Drmethod,  }\item[{integer, dimension(0\+:r\+\_\+alt), intent(in)}]{Drmethod\+\_\+alt,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{r\+\_\+alt }\end{DoxyParamCaption})}



Definition at line 9800 of file reduction\+D.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{9800   }
\DoxyCodeLine{9801     \textcolor{keywordtype}{integer},   \textcolor{keywordtype}{intent(in)} :: rmax,r\_alt}
\DoxyCodeLine{9802     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(inout)} :: D(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{9803     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(inout)} :: Derr(0:rmax),Derr1(0:rmax),Derr2(0:rmax)}
\DoxyCodeLine{9804     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(inout)} :: Drmethod(0:rmax)}
\DoxyCodeLine{9805     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: D\_alt(0:r\_alt,0:r\_alt,0:r\_alt,0:r\_alt)}
\DoxyCodeLine{9806     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(in)} :: Derr\_alt(0:r\_alt),Derr1\_alt(0:r\_alt),Derr2\_alt(0:r\_alt)}
\DoxyCodeLine{9807     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: Drmethod\_alt(0:r\_alt)}
\DoxyCodeLine{9808 }
\DoxyCodeLine{9809     \textcolor{keywordtype}{integer} :: r,n1,n2,n0}
\DoxyCodeLine{9810 }
\DoxyCodeLine{9811     \textcolor{keywordflow}{do} r=0,r\_alt}
\DoxyCodeLine{9812       \textcolor{keywordflow}{if} (derr\_alt(r).lt.derr(r)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{9813         drmethod(r)=drmethod\_alt(r)}
\DoxyCodeLine{9814         derr(r)=derr\_alt(r)}
\DoxyCodeLine{9815         derr1(r)=derr1\_alt(r)}
\DoxyCodeLine{9816         derr2(r)=derr2\_alt(r)}
\DoxyCodeLine{9817         \textcolor{keywordflow}{forall} (n0=0:r/2)}
\DoxyCodeLine{9818           \textcolor{keywordflow}{forall} (n1=0:2*r-\/n0)}
\DoxyCodeLine{9819             \textcolor{keywordflow}{forall} (n2=0:r-\/2*n0-\/n1)}
\DoxyCodeLine{9820               d(n0,n1,n2,r-\/2*n0-\/n1-\/n2) = d\_alt(n0,n1,n2,r-\/2*n0-\/n1-\/n2)}
\DoxyCodeLine{9821 \textcolor{keywordflow}{            end forall}}
\DoxyCodeLine{9822 \textcolor{keywordflow}{          end forall}}
\DoxyCodeLine{9823 \textcolor{keywordflow}{        end forall}}
\DoxyCodeLine{9824         \textcolor{keywordflow}{forall} (n0=1:(r+1)/2)}
\DoxyCodeLine{9825           \textcolor{keywordflow}{forall} (n1=0:r+1-\/2*n0)}
\DoxyCodeLine{9826             \textcolor{keywordflow}{forall} (n2=0:r+1-\/2*n0-\/n1)}
\DoxyCodeLine{9827               d(n0,n1,n2,r+1-\/2*n0-\/n1-\/n2) = d\_alt(n0,n1,n2,r+1-\/2*n0-\/n1-\/n2)}
\DoxyCodeLine{9828 \textcolor{keywordflow}{            end forall}}
\DoxyCodeLine{9829 \textcolor{keywordflow}{          end forall}}
\DoxyCodeLine{9830 \textcolor{keywordflow}{        end forall}}
\DoxyCodeLine{9831 \textcolor{comment}{!       forall (n0=0:r)}}
\DoxyCodeLine{9832 \textcolor{comment}{!         forall (n1=0:r-\/n0)}}
\DoxyCodeLine{9833 \textcolor{comment}{!           forall (n2=0:r-\/n0-\/n1)}}
\DoxyCodeLine{9834 \textcolor{comment}{!             D(n0,n1,n2,r-\/n0-\/n1-\/n2) = D\_alt(n0,n1,n2,r-\/n0-\/n1-\/n2)}}
\DoxyCodeLine{9835 \textcolor{comment}{!           end forall}}
\DoxyCodeLine{9836 \textcolor{comment}{!         end forall}}
\DoxyCodeLine{9837 \textcolor{comment}{!       end forall}}
\DoxyCodeLine{9838 \textcolor{comment}{!        forall (n1=0:r)}}
\DoxyCodeLine{9839 \textcolor{comment}{!          forall (n2=0:r-\/n1)}}
\DoxyCodeLine{9840 \textcolor{comment}{!            forall (n3=0:r-\/n1-\/n2)}}
\DoxyCodeLine{9841 \textcolor{comment}{!              D((r-\/n1-\/n2-\/n3)/2,n1,n2,n3) = D\_alt((r-\/n1-\/n2-\/n3)/2,n1,n2,n3)}}
\DoxyCodeLine{9842 \textcolor{comment}{!            end forall}}
\DoxyCodeLine{9843 \textcolor{comment}{!          end forall}}
\DoxyCodeLine{9844 \textcolor{comment}{!        end forall}}
\DoxyCodeLine{9845 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{9846 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{9847 }

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacereductiond_a8e58a33ce50f6fc2bdd83b7f3bb3e4da}\label{namespacereductiond_a8e58a33ce50f6fc2bdd83b7f3bb3e4da}} 
\index{reductiond@{reductiond}!truncfacd@{truncfacd}}
\index{truncfacd@{truncfacd}!reductiond@{reductiond}}
\doxysubsubsection{\texorpdfstring{truncfacd}{truncfacd}}
{\footnotesize\ttfamily double precision, parameter reductiond\+::truncfacd = 1d2}



Definition at line 80 of file reduction\+D.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{80   \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{parameter} :: truncfacD = 1d2}

\end{DoxyCode}
