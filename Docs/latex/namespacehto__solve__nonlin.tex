\hypertarget{namespacehto__solve__nonlin}{}\doxysection{hto\+\_\+solve\+\_\+nonlin Module Reference}
\label{namespacehto__solve__nonlin}\index{hto\_solve\_nonlin@{hto\_solve\_nonlin}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public \mbox{\hyperlink{namespacehto__solve__nonlin_a4913ccbfdbf22332947aa02f3df9eee5}{hto\+\_\+hbrd}} (H\+T\+O\+\_\+\+F\+CN, n, x, fvec, epsfcn, tol, info, diag)
\item 
subroutine, public \mbox{\hyperlink{namespacehto__solve__nonlin_a2fedece7d4082c4306271f14df72387e}{hto\+\_\+hybrd}} (H\+T\+O\+\_\+\+F\+CN, n, x, fvec, xtol, maxfev, ml, mu, epsfcn, diag, mode, factor, nprint, info, nfev)
\item 
subroutine \mbox{\hyperlink{namespacehto__solve__nonlin_afe4e5fea1ad06250f9e5ce2a5ac37e33}{hto\+\_\+dogleg}} (n, r, lr, diag, qtb, delta, x, wa1, wa2)
\item 
subroutine \mbox{\hyperlink{namespacehto__solve__nonlin_a9b9991931fe83ae42bd577aa132fd691}{hto\+\_\+fdjac1}} (H\+T\+O\+\_\+\+F\+CN, n, x, fvec, fjac, ldfjac, iflag, ml, mu, epsfcn, wa1, wa2)
\item 
subroutine \mbox{\hyperlink{namespacehto__solve__nonlin_a6c27c7948dee7924b448527cd0e47aff}{hto\+\_\+qform}} (m, n, q, ldq, wa)
\item 
subroutine \mbox{\hyperlink{namespacehto__solve__nonlin_a98884f67245c484b378efff769d60f69}{hto\+\_\+qrfac}} (m, n, a, lda, pivot, ipvt, lipvt, rdiag, acnorm, wa)
\item 
subroutine \mbox{\hyperlink{namespacehto__solve__nonlin_a89a4ef64a31dd4d201b9b6bb3c077ab1}{hto\+\_\+r1mpyq}} (m, n, a, lda, v, w)
\item 
subroutine \mbox{\hyperlink{namespacehto__solve__nonlin_af73d8384fe07fde7b063afc452466f03}{hto\+\_\+r1updt}} (m, n, s, ls, u, v, w, sing)
\item 
real $\ast$8 function \mbox{\hyperlink{namespacehto__solve__nonlin_a52df74850a83808488fb1b90d7e539ed}{hto\+\_\+enorm}} (n, x)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacehto__solve__nonlin_afe4e5fea1ad06250f9e5ce2a5ac37e33}\label{namespacehto__solve__nonlin_afe4e5fea1ad06250f9e5ce2a5ac37e33}} 
\index{hto\_solve\_nonlin@{hto\_solve\_nonlin}!hto\_dogleg@{hto\_dogleg}}
\index{hto\_dogleg@{hto\_dogleg}!hto\_solve\_nonlin@{hto\_solve\_nonlin}}
\doxysubsubsection{\texorpdfstring{hto\_dogleg()}{hto\_dogleg()}}
{\footnotesize\ttfamily subroutine hto\+\_\+solve\+\_\+nonlin\+::hto\+\_\+dogleg (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{n,  }\item[{real$\ast$8, dimension(lr), intent(in)}]{r,  }\item[{integer, intent(in)}]{lr,  }\item[{real$\ast$8, dimension(n), intent(in)}]{diag,  }\item[{real$\ast$8, dimension(n), intent(in)}]{qtb,  }\item[{real$\ast$8, intent(in)}]{delta,  }\item[{real$\ast$8, dimension(n), intent(inout)}]{x,  }\item[{real$\ast$8, dimension(n), intent(out)}]{wa1,  }\item[{real$\ast$8, dimension(n), intent(out)}]{wa2 }\end{DoxyParamCaption})}



Definition at line 5805 of file C\+A\+L\+L\+I\+N\+G\+\_\+cp\+H\+T\+O.\+f.


\begin{DoxyCode}{0}
\DoxyCodeLine{5805 \textcolor{comment}{*}}
\DoxyCodeLine{5806       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: n}
\DoxyCodeLine{5807       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: lr}
\DoxyCodeLine{5808       real*8, \textcolor{keywordtype}{INTENT(IN)}      :: r(lr)}
\DoxyCodeLine{5809       real*8, \textcolor{keywordtype}{INTENT(IN)}      :: diag(n)}
\DoxyCodeLine{5810       real*8, \textcolor{keywordtype}{INTENT(IN)}      :: qtb(n)}
\DoxyCodeLine{5811       real*8, \textcolor{keywordtype}{INTENT(IN)}      :: delta}
\DoxyCodeLine{5812       real*8, \textcolor{keywordtype}{INTENT(IN OUT)}  :: x(n)}
\DoxyCodeLine{5813       real*8, \textcolor{keywordtype}{INTENT(OUT)}     :: wa1(n)}
\DoxyCodeLine{5814       real*8, \textcolor{keywordtype}{INTENT(OUT)}     :: wa2(n)}
\DoxyCodeLine{5815 }
\DoxyCodeLine{5816 \textcolor{comment}{!     **********}}
\DoxyCodeLine{5817 }
\DoxyCodeLine{5818 \textcolor{comment}{!     SUBROUTINE HTO\_DOGLEG}}
\DoxyCodeLine{5819 }
\DoxyCodeLine{5820 \textcolor{comment}{!     GIVEN AN M BY N MATRIX A, AN N BY N NONSINGULAR DIAGONAL}}
\DoxyCodeLine{5821 \textcolor{comment}{!     MATRIX D, AN M-\/VECTOR B, AND A POSITIVE NUMBER DELTA, THE}}
\DoxyCodeLine{5822 \textcolor{comment}{!     PROBLEM IS TO DETERMINE THE CONVEX COMBINATION X OF THE}}
\DoxyCodeLine{5823 \textcolor{comment}{!     GAUSS-\/NEWTON AND SCALED GRADIENT DIRECTIONS THAT MINIMIZES}}
\DoxyCodeLine{5824 \textcolor{comment}{!     (A*X -\/ B) IN THE LEAST SQUARES SENSE, SUBJECT TO THE}}
\DoxyCodeLine{5825 \textcolor{comment}{!     RESTRICTION THAT THE EUCLIDEAN NORM OF D*X BE AT MOST DELTA.}}
\DoxyCodeLine{5826 }
\DoxyCodeLine{5827 \textcolor{comment}{!     THIS SUBROUTINE HTO\_COMPLETES THE SOLUTION OF THE PROBLEM}}
\DoxyCodeLine{5828 \textcolor{comment}{!     IF IT IS PROVIDED WITH THE NECESSARY INFORMATION FROM THE}}
\DoxyCodeLine{5829 \textcolor{comment}{!     QR FACTORIZATION OF A. THAT IS, IF A= Q*R, WHERE Q HAS}}
\DoxyCodeLine{5830 \textcolor{comment}{!     ORTHOGONAL COLUMNS AND R IS AN UPPER TRIANGULAR MATRIX,}}
\DoxyCodeLine{5831 \textcolor{comment}{!     THEN DOGLEG EXPECTS THE FULL UPPER TRIANGLE OF R AND}}
\DoxyCodeLine{5832 \textcolor{comment}{!     THE FIRST N COMPONENTS OF (Q TRANSPOSE)*B.}}
\DoxyCodeLine{5833 }
\DoxyCodeLine{5834 \textcolor{comment}{!     THE SUBROUTINE HTO\_STATEMENT IS}}
\DoxyCodeLine{5835 }
\DoxyCodeLine{5836 \textcolor{comment}{!       SUBROUTINE HTO\_DOGLEG(N,R,LR,DIAG,QTB,DELTA,X,WA1,WA2)}}
\DoxyCodeLine{5837 }
\DoxyCodeLine{5838 \textcolor{comment}{!     WHERE}}
\DoxyCodeLine{5839 }
\DoxyCodeLine{5840 \textcolor{comment}{!       N IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE ORDER OF R.}}
\DoxyCodeLine{5841 }
\DoxyCodeLine{5842 \textcolor{comment}{!       R IS AN INPUT ARRAY OF LENGTH LR WHICH MUST CONTAIN THE UPPER}}
\DoxyCodeLine{5843 \textcolor{comment}{!         TRIANGULAR MATRIX R STORED BY ROWS.}}
\DoxyCodeLine{5844 }
\DoxyCodeLine{5845 \textcolor{comment}{!       LR IS A POSITIVE INTEGER INPUT VARIABLE NOT LESS THAN}}
\DoxyCodeLine{5846 \textcolor{comment}{!         (N*(N+1))/2.}}
\DoxyCodeLine{5847 }
\DoxyCodeLine{5848 \textcolor{comment}{!       DIAG IS AN INPUT ARRAY OF LENGTH N WHICH MUST CONTAIN THE}}
\DoxyCodeLine{5849 \textcolor{comment}{!         DIAGONAL ELEMENTS OF THE MATRIX D.}}
\DoxyCodeLine{5850 }
\DoxyCodeLine{5851 \textcolor{comment}{!       QTB IS AN INPUT ARRAY OF LENGTH N WHICH MUST CONTAIN THE FIRST}}
\DoxyCodeLine{5852 \textcolor{comment}{!         N ELEMENTS OF THE VECTOR (Q TRANSPOSE)*B.}}
\DoxyCodeLine{5853 }
\DoxyCodeLine{5854 \textcolor{comment}{!       DELTA IS A POSITIVE INPUT VARIABLE WHICH SPECIFIES AN UPPER}}
\DoxyCodeLine{5855 \textcolor{comment}{!         BOUND ON THE EUCLIDEAN NORM OF D*X.}}
\DoxyCodeLine{5856 }
\DoxyCodeLine{5857 \textcolor{comment}{!       X IS AN OUTPUT ARRAY OF LENGTH N WHICH CONTAINS THE DESIRED}}
\DoxyCodeLine{5858 \textcolor{comment}{!         CONVEX COMBINATION OF THE GAUSS-\/NEWTON DIRECTION AND THE}}
\DoxyCodeLine{5859 \textcolor{comment}{!         SCALED GRADIENT DIRECTION.}}
\DoxyCodeLine{5860 }
\DoxyCodeLine{5861 \textcolor{comment}{!       WA1 AND WA2 ARE WORK ARRAYS OF LENGTH N.}}
\DoxyCodeLine{5862 }
\DoxyCodeLine{5863 \textcolor{comment}{!     SUBPROGRAMS CALLED}}
\DoxyCodeLine{5864 }
\DoxyCodeLine{5865 \textcolor{comment}{!       MINPACK-\/SUPPLIED ... SPMPAR,ENORM}}
\DoxyCodeLine{5866 }
\DoxyCodeLine{5867 \textcolor{comment}{!       FORTRAN-\/SUPPLIED ... ABS,MAX,MIN,SQRT}}
\DoxyCodeLine{5868 }
\DoxyCodeLine{5869 \textcolor{comment}{!     ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.}}
\DoxyCodeLine{5870 \textcolor{comment}{!     BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE}}
\DoxyCodeLine{5871 }
\DoxyCodeLine{5872 \textcolor{comment}{!     **********}}
\DoxyCodeLine{5873 }
\DoxyCodeLine{5874       \textcolor{keywordtype}{INTEGER}    :: i,j,jj,jp1,k,l}
\DoxyCodeLine{5875       real*8  :: alpha,bnorm,epsmch,gnorm,qnorm,sgnorm,sum,temp}
\DoxyCodeLine{5876 \textcolor{comment}{*}}
\DoxyCodeLine{5877       epsmch= epsilon(1.0d0)}
\DoxyCodeLine{5878       jj= (n*(n+1))/2+1}
\DoxyCodeLine{5879       \textcolor{keywordflow}{DO} k= 1,n}
\DoxyCodeLine{5880        j= n-\/k+1}
\DoxyCodeLine{5881        jp1= j+1}
\DoxyCodeLine{5882        jj= jj-\/k}
\DoxyCodeLine{5883        l= jj+1}
\DoxyCodeLine{5884        sum= 0.0}
\DoxyCodeLine{5885        \textcolor{keywordflow}{IF}(n >= jp1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5886         \textcolor{keywordflow}{DO} i= jp1,n}
\DoxyCodeLine{5887          sum= sum+r(l)*x(i)}
\DoxyCodeLine{5888          l= l+1}
\DoxyCodeLine{5889 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{5890 \textcolor{keywordflow}{       ENDIF}}
\DoxyCodeLine{5891        temp= r(jj)}
\DoxyCodeLine{5892        \textcolor{keywordflow}{IF}(temp == 0.0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5893         l= j}
\DoxyCodeLine{5894         \textcolor{keywordflow}{DO} i= 1,j}
\DoxyCodeLine{5895          temp= max(temp,abs(r(l)))}
\DoxyCodeLine{5896          l= l+n-\/i}
\DoxyCodeLine{5897 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{5898         temp= epsmch*temp}
\DoxyCodeLine{5899         \textcolor{keywordflow}{IF}(temp == 0.0) temp= epsmch}
\DoxyCodeLine{5900 \textcolor{keywordflow}{       ENDIF}}
\DoxyCodeLine{5901        x(j)= (qtb(j)-\/sum)/temp}
\DoxyCodeLine{5902 \textcolor{keywordflow}{      ENDDO}}
\DoxyCodeLine{5903 \textcolor{comment}{*}}
\DoxyCodeLine{5904       \textcolor{keywordflow}{DO} j= 1,n}
\DoxyCodeLine{5905        wa1(j)= 0.0}
\DoxyCodeLine{5906        wa2(j)= diag(j)*x(j)}
\DoxyCodeLine{5907 \textcolor{keywordflow}{      ENDDO}}
\DoxyCodeLine{5908       qnorm= \mbox{\hyperlink{namespacehto__solve__nonlin_a52df74850a83808488fb1b90d7e539ed}{hto\_enorm}}(n,wa2)}
\DoxyCodeLine{5909 \textcolor{comment}{*}}
\DoxyCodeLine{5910       \textcolor{keywordflow}{IF}(qnorm > delta) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5911        l= 1}
\DoxyCodeLine{5912        \textcolor{keywordflow}{DO} j= 1,n}
\DoxyCodeLine{5913         temp= qtb(j)}
\DoxyCodeLine{5914         \textcolor{keywordflow}{DO} i= j,n}
\DoxyCodeLine{5915          wa1(i)= wa1(i)+r(l)*temp}
\DoxyCodeLine{5916          l= l+1}
\DoxyCodeLine{5917 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{5918         wa1(j)= wa1(j)/diag(j)}
\DoxyCodeLine{5919 \textcolor{keywordflow}{       ENDDO}}
\DoxyCodeLine{5920        gnorm= \mbox{\hyperlink{namespacehto__solve__nonlin_a52df74850a83808488fb1b90d7e539ed}{hto\_enorm}}(n,wa1)}
\DoxyCodeLine{5921        sgnorm= 0.0}
\DoxyCodeLine{5922        alpha= delta/qnorm}
\DoxyCodeLine{5923        \textcolor{keywordflow}{IF}(gnorm /= 0.0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5924         \textcolor{keywordflow}{DO} j= 1,n}
\DoxyCodeLine{5925          wa1(j)= (wa1(j)/gnorm)/diag(j)}
\DoxyCodeLine{5926 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{5927         l= 1}
\DoxyCodeLine{5928         \textcolor{keywordflow}{DO} j= 1,n}
\DoxyCodeLine{5929          sum= 0.0}
\DoxyCodeLine{5930          \textcolor{keywordflow}{DO} i= j,n}
\DoxyCodeLine{5931           sum= sum+r(l)*wa1(i)}
\DoxyCodeLine{5932           l= l+1}
\DoxyCodeLine{5933 \textcolor{keywordflow}{         ENDDO}}
\DoxyCodeLine{5934          wa2(j)= sum}
\DoxyCodeLine{5935 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{5936         temp= \mbox{\hyperlink{namespacehto__solve__nonlin_a52df74850a83808488fb1b90d7e539ed}{hto\_enorm}}(n,wa2)}
\DoxyCodeLine{5937         sgnorm= (gnorm/temp)/temp}
\DoxyCodeLine{5938         alpha= 0.0}
\DoxyCodeLine{5939         \textcolor{keywordflow}{IF}(sgnorm < delta) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5940          bnorm= \mbox{\hyperlink{namespacehto__solve__nonlin_a52df74850a83808488fb1b90d7e539ed}{hto\_enorm}}(n,qtb)}
\DoxyCodeLine{5941          temp= (bnorm/gnorm)*(bnorm/qnorm)*(sgnorm/delta)}
\DoxyCodeLine{5942          temp= temp-\/(delta/qnorm)*(sgnorm/delta)**2+}
\DoxyCodeLine{5943      \#         sqrt((temp-\/(delta/qnorm))**2+(1.0d0-\/(delta/qnorm)**2)*}
\DoxyCodeLine{5944      \#         (1.0d0-\/( sgnorm/delta)**2))}
\DoxyCodeLine{5945          alpha= ((delta/qnorm)*(1.0d0-\/(sgnorm/delta)**2))/temp}
\DoxyCodeLine{5946 \textcolor{keywordflow}{        ENDIF}}
\DoxyCodeLine{5947 \textcolor{keywordflow}{       ENDIF}}
\DoxyCodeLine{5948        temp= (1.0d0-\/alpha)*min(sgnorm,delta)}
\DoxyCodeLine{5949        \textcolor{keywordflow}{DO} j= 1,n}
\DoxyCodeLine{5950         x(j)= temp*wa1(j)+alpha*x(j)}
\DoxyCodeLine{5951 \textcolor{keywordflow}{       ENDDO}}
\DoxyCodeLine{5952 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{5953 \textcolor{comment}{*}}
\DoxyCodeLine{5954       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{5955 \textcolor{comment}{*}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacehto__solve__nonlin_a52df74850a83808488fb1b90d7e539ed}\label{namespacehto__solve__nonlin_a52df74850a83808488fb1b90d7e539ed}} 
\index{hto\_solve\_nonlin@{hto\_solve\_nonlin}!hto\_enorm@{hto\_enorm}}
\index{hto\_enorm@{hto\_enorm}!hto\_solve\_nonlin@{hto\_solve\_nonlin}}
\doxysubsubsection{\texorpdfstring{hto\_enorm()}{hto\_enorm()}}
{\footnotesize\ttfamily real$\ast$8 function hto\+\_\+solve\+\_\+nonlin\+::hto\+\_\+enorm (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{n,  }\item[{real$\ast$8, dimension(n), intent(in)}]{x }\end{DoxyParamCaption})}



Definition at line 6621 of file C\+A\+L\+L\+I\+N\+G\+\_\+cp\+H\+T\+O.\+f.


\begin{DoxyCode}{0}
\DoxyCodeLine{6621 \textcolor{comment}{* }}
\DoxyCodeLine{6622       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}    :: n}
\DoxyCodeLine{6623       real*8, \textcolor{keywordtype}{INTENT(IN)}  :: x(n)}
\DoxyCodeLine{6624       real*8              :: fn\_val}
\DoxyCodeLine{6625 }
\DoxyCodeLine{6626 \textcolor{comment}{!   **********}}
\DoxyCodeLine{6627 }
\DoxyCodeLine{6628 \textcolor{comment}{!   FUNCTION ENORM}}
\DoxyCodeLine{6629 }
\DoxyCodeLine{6630 \textcolor{comment}{!   GIVEN AN N-\/VECTOR X, THIS FUNCTION CALCULATES THE EUCLIDEAN NORM OF X.}}
\DoxyCodeLine{6631 }
\DoxyCodeLine{6632 \textcolor{comment}{!   THE EUCLIDEAN NORM IS COMPUTED BY ACCUMULATING THE SUM OF SQUARES IN THREE}}
\DoxyCodeLine{6633 \textcolor{comment}{!   DIFFERENT SUMS.  THE SUMS OF SQUARES FOR THE SMALL AND LARGE COMPONENTS}}
\DoxyCodeLine{6634 \textcolor{comment}{!   ARE SCALED SO THAT NO OVERFLOWS OCCUR.  NON-\/DESTRUCTIVE UNDERFLOWS ARE}}
\DoxyCodeLine{6635 \textcolor{comment}{!   PERMITTED.  UNDERFLOWS AND OVERFLOWS DO NOT OCCUR IN THE COMPUTATION OF THE UNSCALED}}
\DoxyCodeLine{6636 \textcolor{comment}{!   SUM OF SQUARES FOR THE INTERMEDIATE COMPONENTS.}}
\DoxyCodeLine{6637 \textcolor{comment}{!   THE DEFINITIONS OF SMALL, INTERMEDIATE AND LARGE COMPONENTS DEPEND ON}}
\DoxyCodeLine{6638 \textcolor{comment}{!   TWO CONSTANTS, RDWARF AND RGIANT.  THE MAIN RESTRICTIONS ON THESE CONSTANTS}}
\DoxyCodeLine{6639 \textcolor{comment}{!   ARE THAT RDWARF**2 NOT UNDERFLOW AND RGIANT**2 NOT OVERFLOW.}}
\DoxyCodeLine{6640 \textcolor{comment}{!   THE CONSTANTS GIVEN HERE ARE SUITABLE FOR EVERY KNOWN COMPUTER.}}
\DoxyCodeLine{6641 }
\DoxyCodeLine{6642 \textcolor{comment}{!   THE FUNCTION STATEMENT IS}}
\DoxyCodeLine{6643 }
\DoxyCodeLine{6644 \textcolor{comment}{!     REAL FUNCTION ENORM(N, X)}}
\DoxyCodeLine{6645 }
\DoxyCodeLine{6646 \textcolor{comment}{!   WHERE}}
\DoxyCodeLine{6647 }
\DoxyCodeLine{6648 \textcolor{comment}{!     N IS A POSITIVE INTEGER INPUT VARIABLE.}}
\DoxyCodeLine{6649 }
\DoxyCodeLine{6650 \textcolor{comment}{!     X IS AN INPUT ARRAY OF LENGTH N.}}
\DoxyCodeLine{6651 }
\DoxyCodeLine{6652 \textcolor{comment}{!   SUBPROGRAMS CALLED}}
\DoxyCodeLine{6653 }
\DoxyCodeLine{6654 \textcolor{comment}{!     FORTRAN-\/SUPPLIED ... ABS,SQRT}}
\DoxyCodeLine{6655 }
\DoxyCodeLine{6656 \textcolor{comment}{!   ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.}}
\DoxyCodeLine{6657 \textcolor{comment}{!   BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE}}
\DoxyCodeLine{6658 }
\DoxyCodeLine{6659 \textcolor{comment}{!   **********}}
\DoxyCodeLine{6660 }
\DoxyCodeLine{6661       \textcolor{keywordtype}{INTEGER}    :: i}
\DoxyCodeLine{6662       real*8  :: agiant,floatn,s1,s2,s3,xabs,x1max,x3max}
\DoxyCodeLine{6663       real*8, \textcolor{keywordtype}{PARAMETER}  :: rdwarf= 1.0d-\/100,rgiant= 1.0d+100}
\DoxyCodeLine{6664 \textcolor{comment}{*}}
\DoxyCodeLine{6665       s1= 0.0d0}
\DoxyCodeLine{6666       s2= 0.0d0}
\DoxyCodeLine{6667       s3= 0.0d0}
\DoxyCodeLine{6668       x1max= 0.0d0}
\DoxyCodeLine{6669       x3max= 0.0d0}
\DoxyCodeLine{6670       floatn= n}
\DoxyCodeLine{6671       agiant= rgiant/floatn}
\DoxyCodeLine{6672       \textcolor{keywordflow}{DO} i= 1,n}
\DoxyCodeLine{6673        xabs= abs(x(i))}
\DoxyCodeLine{6674        \textcolor{keywordflow}{IF}(xabs <= rdwarf.or.xabs >= agiant) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6675         \textcolor{keywordflow}{IF}(xabs > rdwarf) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6676          \textcolor{keywordflow}{IF}(xabs > x1max) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6677           s1= 1.0d0+s1*(x1max/xabs)**2}
\DoxyCodeLine{6678           x1max= xabs}
\DoxyCodeLine{6679          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{6680           s1= s1+(xabs/x1max)**2}
\DoxyCodeLine{6681 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{6682         \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{6683          \textcolor{keywordflow}{IF}(xabs > x3max) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6684           s3= 1.0d0+s3*(x3max/xabs)**2}
\DoxyCodeLine{6685           x3max= xabs}
\DoxyCodeLine{6686          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{6687           \textcolor{keywordflow}{IF}(xabs /= 0.0d0) s3= s3+(xabs/x3max)**2}
\DoxyCodeLine{6688 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{6689 \textcolor{keywordflow}{        ENDIF}}
\DoxyCodeLine{6690        \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{6691         s2= s2+xabs**2}
\DoxyCodeLine{6692 \textcolor{keywordflow}{       ENDIF}}
\DoxyCodeLine{6693 \textcolor{keywordflow}{      ENDDO}}
\DoxyCodeLine{6694       \textcolor{keywordflow}{IF}(s1 /= 0.0d0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6695        fn\_val= x1max*sqrt(s1+(s2/x1max)/x1max)}
\DoxyCodeLine{6696       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{6697        \textcolor{keywordflow}{IF}(s2 /= 0.0d0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6698         \textcolor{keywordflow}{IF}(s2 >= x3max) fn\_val= sqrt(s2*(1.0d0+(x3max/s2)*(x3max*s3)))}
\DoxyCodeLine{6699         \textcolor{keywordflow}{IF}(s2 < x3max) fn\_val= sqrt(x3max*((s2/x3max)+(x3max*s3)))}
\DoxyCodeLine{6700        \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{6701         fn\_val= x3max*sqrt(s3)}
\DoxyCodeLine{6702 \textcolor{keywordflow}{       ENDIF}}
\DoxyCodeLine{6703 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{6704 \textcolor{comment}{*}}
\DoxyCodeLine{6705       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{6706 \textcolor{comment}{*}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacehto__solve__nonlin_a9b9991931fe83ae42bd577aa132fd691}\label{namespacehto__solve__nonlin_a9b9991931fe83ae42bd577aa132fd691}} 
\index{hto\_solve\_nonlin@{hto\_solve\_nonlin}!hto\_fdjac1@{hto\_fdjac1}}
\index{hto\_fdjac1@{hto\_fdjac1}!hto\_solve\_nonlin@{hto\_solve\_nonlin}}
\doxysubsubsection{\texorpdfstring{hto\_fdjac1()}{hto\_fdjac1()}}
{\footnotesize\ttfamily subroutine hto\+\_\+solve\+\_\+nonlin\+::hto\+\_\+fdjac1 (\begin{DoxyParamCaption}\item[{}]{H\+T\+O\+\_\+\+F\+CN,  }\item[{integer, intent(in)}]{n,  }\item[{real$\ast$8, dimension(n), intent(inout)}]{x,  }\item[{real$\ast$8, dimension(n), intent(in)}]{fvec,  }\item[{real$\ast$8, dimension(ldfjac,n), intent(out)}]{fjac,  }\item[{integer, intent(in)}]{ldfjac,  }\item[{integer, intent(inout)}]{iflag,  }\item[{integer, intent(in)}]{ml,  }\item[{integer, intent(in)}]{mu,  }\item[{real$\ast$8, intent(in)}]{epsfcn,  }\item[{real$\ast$8, dimension(n), intent(inout)}]{wa1,  }\item[{real$\ast$8, dimension(n), intent(out)}]{wa2 }\end{DoxyParamCaption})}



Definition at line 5962 of file C\+A\+L\+L\+I\+N\+G\+\_\+cp\+H\+T\+O.\+f.


\begin{DoxyCode}{0}
\DoxyCodeLine{5962 \textcolor{comment}{*}}
\DoxyCodeLine{5963       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: n}
\DoxyCodeLine{5964       real*8, \textcolor{keywordtype}{INTENT(IN OUT)}  :: x(n)}
\DoxyCodeLine{5965       real*8, \textcolor{keywordtype}{INTENT(IN)}      :: fvec(n)}
\DoxyCodeLine{5966       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: ldfjac}
\DoxyCodeLine{5967       real*8, \textcolor{keywordtype}{INTENT(OUT)}     :: fjac(ldfjac,n)}
\DoxyCodeLine{5968       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN OUT)}    :: iflag}
\DoxyCodeLine{5969       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: ml}
\DoxyCodeLine{5970       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: mu}
\DoxyCodeLine{5971       real*8, \textcolor{keywordtype}{INTENT(IN)}      :: epsfcn}
\DoxyCodeLine{5972       real*8, \textcolor{keywordtype}{INTENT(IN OUT)}  :: wa1(n)}
\DoxyCodeLine{5973       real*8, \textcolor{keywordtype}{INTENT(OUT)}     :: wa2(n)}
\DoxyCodeLine{5974        }
\DoxyCodeLine{5975 \textcolor{comment}{! EXTERNAL fcn}}
\DoxyCodeLine{5976       }
\DoxyCodeLine{5977       \textcolor{keyword}{INTERFACE}}
\DoxyCodeLine{5978        \textcolor{keyword}{SUBROUTINE }hto\_fcn(N,X,FVEC,IFLAG)}
\DoxyCodeLine{5979        \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{5980        \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{PARAMETER}  :: dp= selected\_real\_kind(14,60)}
\DoxyCodeLine{5981        \textcolor{keywordtype}{INTEGER},\textcolor{keywordtype}{INTENT(IN)}      :: n}
\DoxyCodeLine{5982        real*8,\textcolor{keywordtype}{INTENT(IN)}    :: x(n)}
\DoxyCodeLine{5983        real*8, \textcolor{keywordtype}{INTENT(OUT)}   :: fvec(n)}
\DoxyCodeLine{5984        \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN OUT)}  :: iflag}
\DoxyCodeLine{5985        \textcolor{keyword}{END SUBROUTINE }hto\_fcn}
\DoxyCodeLine{5986       \textcolor{keyword}{END INTERFACE}}
\DoxyCodeLine{5987 }
\DoxyCodeLine{5988 \textcolor{comment}{!   **********}}
\DoxyCodeLine{5989 }
\DoxyCodeLine{5990 \textcolor{comment}{!   SUBROUTINE HTO\_FDJAC1}}
\DoxyCodeLine{5991 }
\DoxyCodeLine{5992 \textcolor{comment}{!   THIS SUBROUTINE HTO\_COMPUTES A FORWARD-\/DIFFERENCE APPROXIMATION TO THE N BY N}}
\DoxyCodeLine{5993 \textcolor{comment}{!   JACOBIAN MATRIX ASSOCIATED WITH A SPECIFIED PROBLEM OF N FUNCTIONS IN N}}
\DoxyCodeLine{5994 \textcolor{comment}{!   VARIABLES.  IF THE JACOBIAN HAS A BANDED FORM, THEN FUNCTION EVALUATIONS}}
\DoxyCodeLine{5995 \textcolor{comment}{!   ARE SAVED BY ONLY APPROXIMATING THE NONZERO TERMS.}}
\DoxyCodeLine{5996 }
\DoxyCodeLine{5997 \textcolor{comment}{!   THE SUBROUTINE HTO\_STATEMENT IS}}
\DoxyCodeLine{5998 }
\DoxyCodeLine{5999 \textcolor{comment}{!     SUBROUTINE HTO\_FDJAC1(FCN,N,X,FVEC,FJAC,LDFJAC,IFLAG,ML,MU,EPSFCN,}}
\DoxyCodeLine{6000 \textcolor{comment}{!                       WA1,WA2)}}
\DoxyCodeLine{6001 }
\DoxyCodeLine{6002 \textcolor{comment}{!   WHERE}}
\DoxyCodeLine{6003 }
\DoxyCodeLine{6004 \textcolor{comment}{!     FCN IS THE NAME OF THE USER-\/SUPPLIED SUBROUTINE HTO\_WHICH CALCULATES}}
\DoxyCodeLine{6005 \textcolor{comment}{!       THE FUNCTIONS.  FCN MUST BE DECLARED IN AN EXTERNAL STATEMENT IN}}
\DoxyCodeLine{6006 \textcolor{comment}{!       THE USER CALLING PROGRAM, AND SHOULD BE WRITTEN AS FOLLOWS.}}
\DoxyCodeLine{6007 }
\DoxyCodeLine{6008 \textcolor{comment}{!       SUBROUTINE HTO\_FCN(N,X,FVEC,IFLAG)}}
\DoxyCodeLine{6009 \textcolor{comment}{!       INTEGER N,IFLAG}}
\DoxyCodeLine{6010 \textcolor{comment}{!       REAL X(N),FVEC(N)}}
\DoxyCodeLine{6011 \textcolor{comment}{!       -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{6012 \textcolor{comment}{!       CALCULATE THE FUNCTIONS AT X AND}}
\DoxyCodeLine{6013 \textcolor{comment}{!       RETURN THIS VECTOR IN FVEC.}}
\DoxyCodeLine{6014 \textcolor{comment}{!       -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{6015 \textcolor{comment}{!       RETURN}}
\DoxyCodeLine{6016 \textcolor{comment}{!       END}}
\DoxyCodeLine{6017 }
\DoxyCodeLine{6018 \textcolor{comment}{!       THE VALUE OF IFLAG SHOULD NOT BE CHANGED BY FCN UNLESS}}
\DoxyCodeLine{6019 \textcolor{comment}{!       THE USER WANTS TO TERMINATE EXECUTION OF FDJAC1.}}
\DoxyCodeLine{6020 \textcolor{comment}{!       IN THIS CASE SET IFLAG TO A NEGATIVE INTEGER.}}
\DoxyCodeLine{6021 }
\DoxyCodeLine{6022 \textcolor{comment}{!     N IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER}}
\DoxyCodeLine{6023 \textcolor{comment}{!       OF FUNCTIONS AND VARIABLES.}}
\DoxyCodeLine{6024 }
\DoxyCodeLine{6025 \textcolor{comment}{!     X IS AN INPUT ARRAY OF LENGTH N.}}
\DoxyCodeLine{6026 }
\DoxyCodeLine{6027 \textcolor{comment}{!     FVEC IS AN INPUT ARRAY OF LENGTH N WHICH MUST CONTAIN THE}}
\DoxyCodeLine{6028 \textcolor{comment}{!       FUNCTIONS EVALUATED AT X.}}
\DoxyCodeLine{6029 }
\DoxyCodeLine{6030 \textcolor{comment}{!     FJAC IS AN OUTPUT N BY N ARRAY WHICH CONTAINS THE}}
\DoxyCodeLine{6031 \textcolor{comment}{!       APPROXIMATION TO THE JACOBIAN MATRIX EVALUATED AT X.}}
\DoxyCodeLine{6032 }
\DoxyCodeLine{6033 \textcolor{comment}{!     LDFJAC IS A POSITIVE INTEGER INPUT VARIABLE NOT LESS THAN N}}
\DoxyCodeLine{6034 \textcolor{comment}{!       WHICH SPECIFIES THE LEADING DIMENSION OF THE ARRAY FJAC.}}
\DoxyCodeLine{6035 }
\DoxyCodeLine{6036 \textcolor{comment}{!     IFLAG IS AN INTEGER VARIABLE WHICH CAN BE USED TO TERMINATE}}
\DoxyCodeLine{6037 \textcolor{comment}{!       THE EXECUTION OF FDJAC1.  SEE DESCRIPTION OF FCN.}}
\DoxyCodeLine{6038 }
\DoxyCodeLine{6039 \textcolor{comment}{!     ML IS A NONNEGATIVE INTEGER INPUT VARIABLE WHICH SPECIFIES}}
\DoxyCodeLine{6040 \textcolor{comment}{!       THE NUMBER OF SUBDIAGONALS WITHIN THE BAND OF THE}}
\DoxyCodeLine{6041 \textcolor{comment}{!       JACOBIAN MATRIX. IF THE JACOBIAN IS NOT BANDED, SET}}
\DoxyCodeLine{6042 \textcolor{comment}{!       ML TO AT LEAST N -\/ 1.}}
\DoxyCodeLine{6043 }
\DoxyCodeLine{6044 \textcolor{comment}{!     EPSFCN IS AN INPUT VARIABLE USED IN DETERMINING A SUITABLE}}
\DoxyCodeLine{6045 \textcolor{comment}{!       STEP LENGTH FOR THE FORWARD-\/DIFFERENCE APPROXIMATION. THIS}}
\DoxyCodeLine{6046 \textcolor{comment}{!       APPROXIMATION ASSUMES THAT THE RELATIVE ERRORS IN THE}}
\DoxyCodeLine{6047 \textcolor{comment}{!       FUNCTIONS ARE OF THE ORDER OF EPSFCN. IF EPSFCN IS LESS}}
\DoxyCodeLine{6048 \textcolor{comment}{!       THAN THE MACHINE PRECISION, IT IS ASSUMED THAT THE RELATIVE}}
\DoxyCodeLine{6049 \textcolor{comment}{!       ERRORS IN THE FUNCTIONS ARE OF THE ORDER OF THE MACHINE PRECISION.}}
\DoxyCodeLine{6050 }
\DoxyCodeLine{6051 \textcolor{comment}{!     MU IS A NONNEGATIVE INTEGER INPUT VARIABLE WHICH SPECIFIES}}
\DoxyCodeLine{6052 \textcolor{comment}{!       THE NUMBER OF SUPERDIAGONALS WITHIN THE BAND OF THE}}
\DoxyCodeLine{6053 \textcolor{comment}{!       JACOBIAN MATRIX. IF THE JACOBIAN IS NOT BANDED, SET}}
\DoxyCodeLine{6054 \textcolor{comment}{!       MU TO AT LEAST N -\/ 1.}}
\DoxyCodeLine{6055 }
\DoxyCodeLine{6056 \textcolor{comment}{!     WA1 AND WA2 ARE WORK ARRAYS OF LENGTH N.  IF ML + MU + 1 IS AT}}
\DoxyCodeLine{6057 \textcolor{comment}{!       LEAST N, THEN THE JACOBIAN IS CONSIDERED DENSE, AND WA2 IS}}
\DoxyCodeLine{6058 \textcolor{comment}{!       NOT REFERENCED.}}
\DoxyCodeLine{6059 }
\DoxyCodeLine{6060 \textcolor{comment}{!   SUBPROGRAMS CALLED}}
\DoxyCodeLine{6061 }
\DoxyCodeLine{6062 \textcolor{comment}{!     MINPACK-\/SUPPLIED ... SPMPAR}}
\DoxyCodeLine{6063 }
\DoxyCodeLine{6064 \textcolor{comment}{!     FORTRAN-\/SUPPLIED ... ABS,MAX,SQRT}}
\DoxyCodeLine{6065 }
\DoxyCodeLine{6066 \textcolor{comment}{!   ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.}}
\DoxyCodeLine{6067 \textcolor{comment}{!   BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE}}
\DoxyCodeLine{6068 }
\DoxyCodeLine{6069 \textcolor{comment}{!   **********}}
\DoxyCodeLine{6070 \textcolor{comment}{*}}
\DoxyCodeLine{6071       }
\DoxyCodeLine{6072       \textcolor{keywordtype}{INTEGER}    :: i,j,k,msum}
\DoxyCodeLine{6073       real*8  :: \mbox{\hyperlink{namespacehto__units_abab92a867fb77543c0c4ff069d1783d4}{eps}},epsmch,h,temp}
\DoxyCodeLine{6074       real*8, \textcolor{keywordtype}{PARAMETER}  :: \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}= 0.0d0}
\DoxyCodeLine{6075 \textcolor{comment}{*}}
\DoxyCodeLine{6076       epsmch= epsilon(1.0d0)}
\DoxyCodeLine{6077       \mbox{\hyperlink{namespacehto__units_abab92a867fb77543c0c4ff069d1783d4}{eps}}= sqrt(max(epsfcn,epsmch))}
\DoxyCodeLine{6078       msum= ml+mu+1}
\DoxyCodeLine{6079       \textcolor{keywordflow}{IF}(msum >= n) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6080        \textcolor{keywordflow}{DO} j= 1,n}
\DoxyCodeLine{6081         temp= x(j)}
\DoxyCodeLine{6082         h= \mbox{\hyperlink{namespacehto__units_abab92a867fb77543c0c4ff069d1783d4}{eps}}*abs(temp)}
\DoxyCodeLine{6083         \textcolor{keywordflow}{IF}(h == \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) h= \mbox{\hyperlink{namespacehto__units_abab92a867fb77543c0c4ff069d1783d4}{eps}}}
\DoxyCodeLine{6084         x(j)= temp+h}
\DoxyCodeLine{6085         \textcolor{keyword}{CALL }hto\_fcn(n,x,wa1,iflag)}
\DoxyCodeLine{6086         \textcolor{keywordflow}{IF}(iflag < 0) \textcolor{keywordflow}{EXIT}}
\DoxyCodeLine{6087         x(j)= temp}
\DoxyCodeLine{6088         \textcolor{keywordflow}{DO} i= 1,n}
\DoxyCodeLine{6089          fjac(i,j)= (wa1(i)-\/fvec(i))/h}
\DoxyCodeLine{6090 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{6091 \textcolor{keywordflow}{       ENDDO}}
\DoxyCodeLine{6092       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{6093        \textcolor{keywordflow}{DO} k= 1,msum}
\DoxyCodeLine{6094         \textcolor{keywordflow}{DO} j= k,n,msum}
\DoxyCodeLine{6095          wa2(j)= x(j)}
\DoxyCodeLine{6096          h= \mbox{\hyperlink{namespacehto__units_abab92a867fb77543c0c4ff069d1783d4}{eps}}*abs(wa2(j))}
\DoxyCodeLine{6097          \textcolor{keywordflow}{IF}(h == \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) h= \mbox{\hyperlink{namespacehto__units_abab92a867fb77543c0c4ff069d1783d4}{eps}}}
\DoxyCodeLine{6098          x(j)= wa2(j)+h}
\DoxyCodeLine{6099 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{6100         \textcolor{keyword}{CALL }hto\_fcn(n,x,wa1,iflag)}
\DoxyCodeLine{6101         \textcolor{keywordflow}{IF}(iflag < 0) \textcolor{keywordflow}{EXIT}}
\DoxyCodeLine{6102         \textcolor{keywordflow}{DO} j= k,n,msum}
\DoxyCodeLine{6103          x(j)= wa2(j)}
\DoxyCodeLine{6104          h= \mbox{\hyperlink{namespacehto__units_abab92a867fb77543c0c4ff069d1783d4}{eps}}*abs(wa2(j))}
\DoxyCodeLine{6105          \textcolor{keywordflow}{IF}(h == \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) h= \mbox{\hyperlink{namespacehto__units_abab92a867fb77543c0c4ff069d1783d4}{eps}}}
\DoxyCodeLine{6106          \textcolor{keywordflow}{DO} i= 1,n}
\DoxyCodeLine{6107           fjac(i,j)= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}}
\DoxyCodeLine{6108           \textcolor{keywordflow}{IF}(i >= j-\/mu.and.i <= j+ml) fjac(i,j)= (wa1(i)-\/fvec(i))/h}
\DoxyCodeLine{6109 \textcolor{keywordflow}{         ENDDO}}
\DoxyCodeLine{6110 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{6111 \textcolor{keywordflow}{       ENDDO}}
\DoxyCodeLine{6112 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{6113 \textcolor{comment}{* }}
\DoxyCodeLine{6114       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{6115 \textcolor{comment}{*}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacehto__solve__nonlin_a4913ccbfdbf22332947aa02f3df9eee5}\label{namespacehto__solve__nonlin_a4913ccbfdbf22332947aa02f3df9eee5}} 
\index{hto\_solve\_nonlin@{hto\_solve\_nonlin}!hto\_hbrd@{hto\_hbrd}}
\index{hto\_hbrd@{hto\_hbrd}!hto\_solve\_nonlin@{hto\_solve\_nonlin}}
\doxysubsubsection{\texorpdfstring{hto\_hbrd()}{hto\_hbrd()}}
{\footnotesize\ttfamily subroutine, public hto\+\_\+solve\+\_\+nonlin\+::hto\+\_\+hbrd (\begin{DoxyParamCaption}\item[{}]{H\+T\+O\+\_\+\+F\+CN,  }\item[{integer, intent(in)}]{n,  }\item[{real$\ast$8, dimension(n), intent(inout)}]{x,  }\item[{real$\ast$8, dimension(n), intent(inout)}]{fvec,  }\item[{real$\ast$8, intent(in)}]{epsfcn,  }\item[{real$\ast$8, intent(in)}]{tol,  }\item[{integer, intent(out)}]{info,  }\item[{real$\ast$8, dimension(n), intent(out)}]{diag }\end{DoxyParamCaption})}



Definition at line 5311 of file C\+A\+L\+L\+I\+N\+G\+\_\+cp\+H\+T\+O.\+f.


\begin{DoxyCode}{0}
\DoxyCodeLine{5311 \textcolor{comment}{* }}
\DoxyCodeLine{5312 \textcolor{comment}{! Code converted using TO\_F90 by Alan Miller}}
\DoxyCodeLine{5313 \textcolor{comment}{! Date: 2003-\/07-\/15  Time: 13:27:42}}
\DoxyCodeLine{5314 \textcolor{comment}{*}}
\DoxyCodeLine{5315       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}     :: n}
\DoxyCodeLine{5316       real*8, \textcolor{keywordtype}{INTENT(IN OUT)}  :: x(n)}
\DoxyCodeLine{5317       real*8, \textcolor{keywordtype}{INTENT(IN OUT)}  :: fvec(n)}
\DoxyCodeLine{5318       real*8, \textcolor{keywordtype}{INTENT(IN)}      :: epsfcn}
\DoxyCodeLine{5319       real*8, \textcolor{keywordtype}{INTENT(IN)}      :: tol}
\DoxyCodeLine{5320       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(OUT)}    :: info}
\DoxyCodeLine{5321       real*8, \textcolor{keywordtype}{INTENT(OUT)}     :: diag(n)}
\DoxyCodeLine{5322 \textcolor{comment}{*}}
\DoxyCodeLine{5323 \textcolor{comment}{! EXTERNAL fcn}}
\DoxyCodeLine{5324 \textcolor{comment}{*}}
\DoxyCodeLine{5325       \textcolor{keyword}{INTERFACE}}
\DoxyCodeLine{5326        \textcolor{keyword}{SUBROUTINE }hto\_fcn(N,X,FVEC,IFLAG)}
\DoxyCodeLine{5327        \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{5328        \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}      :: n}
\DoxyCodeLine{5329        real*8, \textcolor{keywordtype}{INTENT(IN)}    :: x(n)}
\DoxyCodeLine{5330        real*8, \textcolor{keywordtype}{INTENT(OUT)}   :: fvec(n)}
\DoxyCodeLine{5331        \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN OUT)}  :: iflag}
\DoxyCodeLine{5332        \textcolor{keyword}{END SUBROUTINE }hto\_fcn}
\DoxyCodeLine{5333       \textcolor{keyword}{END INTERFACE}}
\DoxyCodeLine{5334 }
\DoxyCodeLine{5335 \textcolor{comment}{!   **********}}
\DoxyCodeLine{5336 }
\DoxyCodeLine{5337 \textcolor{comment}{!   SUBROUTINE HTO\_HBRD}}
\DoxyCodeLine{5338 }
\DoxyCodeLine{5339 \textcolor{comment}{!   THE PURPOSE OF HBRD IS TO FIND A ZERO OF A SYSTEM OF N NONLINEAR}}
\DoxyCodeLine{5340 \textcolor{comment}{!   FUNCTIONS IN N VARIABLES BY A MODIFICATION OF THE POWELL HYBRID METHOD.}}
\DoxyCodeLine{5341 \textcolor{comment}{!   THIS IS DONE BY USING THE MORE GENERAL NONLINEAR EQUATION SOLVER HYBRD.}}
\DoxyCodeLine{5342 \textcolor{comment}{!   THE USER MUST PROVIDE A SUBROUTINE HTO\_WHICH CALCULATES THE FUNCTIONS.}}
\DoxyCodeLine{5343 \textcolor{comment}{!   THE JACOBIAN IS THEN CALCULATED BY A FORWARD-\/DIFFERENCE APPROXIMATION.}}
\DoxyCodeLine{5344 }
\DoxyCodeLine{5345 \textcolor{comment}{!   THE SUBROUTINE HTO\_STATEMENT IS}}
\DoxyCodeLine{5346 }
\DoxyCodeLine{5347 \textcolor{comment}{!     SUBROUTINE HTO\_HBRD(N,X,FVEC,EPSFCN,TOL,INFO,WA,LWA)}}
\DoxyCodeLine{5348 }
\DoxyCodeLine{5349 \textcolor{comment}{!   WHERE}}
\DoxyCodeLine{5350 }
\DoxyCodeLine{5351 \textcolor{comment}{!     FCN IS THE NAME OF THE USER-\/SUPPLIED SUBROUTINE HTO\_WHICH CALCULATES}}
\DoxyCodeLine{5352 \textcolor{comment}{!       THE FUNCTIONS.  FCN MUST BE DECLARED IN AN EXTERNAL STATEMENT}}
\DoxyCodeLine{5353 \textcolor{comment}{!       IN THE USER CALLING PROGRAM, AND SHOULD BE WRITTEN AS FOLLOWS.}}
\DoxyCodeLine{5354 }
\DoxyCodeLine{5355 \textcolor{comment}{!       SUBROUTINE HTO\_FCN(N,X,FVEC,IFLAG)}}
\DoxyCodeLine{5356 \textcolor{comment}{!       INTEGER N,IFLAG}}
\DoxyCodeLine{5357 \textcolor{comment}{!       REAL X(N),FVEC(N)}}
\DoxyCodeLine{5358 \textcolor{comment}{!       -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{5359 \textcolor{comment}{!       CALCULATE THE FUNCTIONS AT X AND RETURN THIS VECTOR IN FVEC.}}
\DoxyCodeLine{5360 \textcolor{comment}{!       -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{5361 \textcolor{comment}{!       RETURN}}
\DoxyCodeLine{5362 \textcolor{comment}{!       END}}
\DoxyCodeLine{5363 }
\DoxyCodeLine{5364 \textcolor{comment}{!       THE VALUE OF IFLAG NOT BE CHANGED BY FCN UNLESS}}
\DoxyCodeLine{5365 \textcolor{comment}{!       THE USER WANTS TO TERMINATE THE EXECUTION OF HBRD.}}
\DoxyCodeLine{5366 \textcolor{comment}{!       IN THIS CASE SET IFLAG TO A NEGATIVE INTEGER.}}
\DoxyCodeLine{5367 }
\DoxyCodeLine{5368 \textcolor{comment}{!     N IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER}}
\DoxyCodeLine{5369 \textcolor{comment}{!       OF FUNCTIONS AND VARIABLES.}}
\DoxyCodeLine{5370 }
\DoxyCodeLine{5371 \textcolor{comment}{!     X IS AN ARRAY OF LENGTH N. ON INPUT X MUST CONTAIN AN INITIAL}}
\DoxyCodeLine{5372 \textcolor{comment}{!       ESTIMATE OF THE SOLUTION VECTOR.  ON OUTPUT X CONTAINS THE}}
\DoxyCodeLine{5373 \textcolor{comment}{!       FINAL ESTIMATE OF THE SOLUTION VECTOR.}}
\DoxyCodeLine{5374 }
\DoxyCodeLine{5375 \textcolor{comment}{!     FVEC IS AN OUTPUT ARRAY OF LENGTH N WHICH CONTAINS}}
\DoxyCodeLine{5376 \textcolor{comment}{!       THE FUNCTIONS EVALUATED AT THE OUTPUT X.}}
\DoxyCodeLine{5377 }
\DoxyCodeLine{5378 \textcolor{comment}{!     EPSFCN IS AN INPUT VARIABLE USED IN DETERMINING A SUITABLE STEP LENGTH}}
\DoxyCodeLine{5379 \textcolor{comment}{!       FOR THE FORWARD-\/DIFFERENCE APPROXIMATION.  THIS APPROXIMATION ASSUMES}}
\DoxyCodeLine{5380 \textcolor{comment}{!       THAT THE RELATIVE ERRORS IN THE FUNCTIONS ARE OF THE ORDER OF EPSFCN.}}
\DoxyCodeLine{5381 \textcolor{comment}{!       IF EPSFCN IS LESS THAN THE MACHINE PRECISION, IT IS ASSUMED THAT THE}}
\DoxyCodeLine{5382 \textcolor{comment}{!       RELATIVE ERRORS IN THE FUNCTIONS ARE OF THE ORDER OF THE MACHINE}}
\DoxyCodeLine{5383 \textcolor{comment}{!       PRECISION.}}
\DoxyCodeLine{5384 }
\DoxyCodeLine{5385 \textcolor{comment}{!     TOL IS A NONNEGATIVE INPUT VARIABLE.  TERMINATION OCCURS WHEN THE}}
\DoxyCodeLine{5386 \textcolor{comment}{!       ALGORITHM ESTIMATES THAT THE RELATIVE ERROR BETWEEN X AND THE SOLUTION}}
\DoxyCodeLine{5387 \textcolor{comment}{!       IS AT MOST TOL.}}
\DoxyCodeLine{5388 }
\DoxyCodeLine{5389 \textcolor{comment}{!     INFO IS AN INTEGER OUTPUT VARIABLE.  IF THE USER HAS TERMINATED}}
\DoxyCodeLine{5390 \textcolor{comment}{!       EXECUTION, INFO IS SET TO THE (NEGATIVE) VALUE OF IFLAG.}}
\DoxyCodeLine{5391 \textcolor{comment}{!       SEE DESCRIPTION OF FCN.  OTHERWISE, INFO IS SET AS FOLLOWS.}}
\DoxyCodeLine{5392 }
\DoxyCodeLine{5393 \textcolor{comment}{!       INFO= 0   IMPROPER INPUT PARAMETERS.}}
\DoxyCodeLine{5394 }
\DoxyCodeLine{5395 \textcolor{comment}{!       INFO= 1   ALGORITHM ESTIMATES THAT THE RELATIVE ERROR}}
\DoxyCodeLine{5396 \textcolor{comment}{!                  BETWEEN X AND THE SOLUTION IS AT MOST TOL.}}
\DoxyCodeLine{5397 }
\DoxyCodeLine{5398 \textcolor{comment}{!       INFO= 2   NUMBER OF CALLS TO FCN HAS REACHED OR EXCEEDED 200*(N+1).}}
\DoxyCodeLine{5399 }
\DoxyCodeLine{5400 \textcolor{comment}{!       INFO= 3   TOL IS TOO SMALL. NO FURTHER IMPROVEMENT IN}}
\DoxyCodeLine{5401 \textcolor{comment}{!                  THE APPROXIMATE SOLUTION X IS POSSIBLE.}}
\DoxyCodeLine{5402 }
\DoxyCodeLine{5403 \textcolor{comment}{!       INFO= 4   ITERATION IS NOT MAKING GOOD PROGRESS.}}
\DoxyCodeLine{5404 }
\DoxyCodeLine{5405 \textcolor{comment}{!   SUBPROGRAMS CALLED}}
\DoxyCodeLine{5406 }
\DoxyCodeLine{5407 \textcolor{comment}{!     USER-\/SUPPLIED ...... FCN}}
\DoxyCodeLine{5408 }
\DoxyCodeLine{5409 \textcolor{comment}{!     MINPACK-\/SUPPLIED ... HYBRD}}
\DoxyCodeLine{5410 }
\DoxyCodeLine{5411 \textcolor{comment}{!   ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.}}
\DoxyCodeLine{5412 \textcolor{comment}{!   BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE}}
\DoxyCodeLine{5413 }
\DoxyCodeLine{5414 \textcolor{comment}{! Reference:}}
\DoxyCodeLine{5415 \textcolor{comment}{! Powell, M.J.D. 'A hybrid method for nonlinear equations' in Numerical Methods}}
\DoxyCodeLine{5416 \textcolor{comment}{!      for Nonlinear Algebraic Equations', P.Rabinowitz (editor), Gordon and}}
\DoxyCodeLine{5417 \textcolor{comment}{!      Breach, London 1970.}}
\DoxyCodeLine{5418 \textcolor{comment}{!   **********}}
\DoxyCodeLine{5419       \textcolor{keywordtype}{INTEGER} :: maxfev, ml,mode,mu,nfev,nprint}
\DoxyCodeLine{5420       real*8  :: xtol}
\DoxyCodeLine{5421       real*8, \textcolor{keywordtype}{PARAMETER}  :: factor= 100.0d0,\mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}= 0.0d0}
\DoxyCodeLine{5422       }
\DoxyCodeLine{5423       info= 0}
\DoxyCodeLine{5424 }
\DoxyCodeLine{5425 \textcolor{comment}{!     CHECK THE INPUT PARAMETERS FOR ERRORS.}}
\DoxyCodeLine{5426 }
\DoxyCodeLine{5427       \textcolor{keywordflow}{IF}(n <= 0.or.epsfcn < \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}.or.tol < \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) \textcolor{keywordflow}{GO TO} 20}
\DoxyCodeLine{5428 }
\DoxyCodeLine{5429 \textcolor{comment}{!     CALL HTO\_HYBRD.}}
\DoxyCodeLine{5430 }
\DoxyCodeLine{5431       maxfev= 200*(n+1)}
\DoxyCodeLine{5432       xtol= tol}
\DoxyCodeLine{5433       ml= n-\/1}
\DoxyCodeLine{5434       mu= n-\/1}
\DoxyCodeLine{5435       mode= 2}
\DoxyCodeLine{5436       nprint= 0}
\DoxyCodeLine{5437       \textcolor{keyword}{CALL }\mbox{\hyperlink{namespacehto__solve__nonlin_a2fedece7d4082c4306271f14df72387e}{hto\_hybrd}}(hto\_fcn,n,x,fvec,xtol,maxfev,ml,mu,epsfcn,diag,}
\DoxyCodeLine{5438      \#               mode,factor,nprint,info,nfev)}
\DoxyCodeLine{5439       \textcolor{keywordflow}{IF}(info == 5) info= 4}
\DoxyCodeLine{5440    20 \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{5441        }
\DoxyCodeLine{5442 \textcolor{comment}{!     LAST CARD OF SUBROUTINE HTO\_HBRD.}}
\DoxyCodeLine{5443 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacehto__solve__nonlin_a2fedece7d4082c4306271f14df72387e}\label{namespacehto__solve__nonlin_a2fedece7d4082c4306271f14df72387e}} 
\index{hto\_solve\_nonlin@{hto\_solve\_nonlin}!hto\_hybrd@{hto\_hybrd}}
\index{hto\_hybrd@{hto\_hybrd}!hto\_solve\_nonlin@{hto\_solve\_nonlin}}
\doxysubsubsection{\texorpdfstring{hto\_hybrd()}{hto\_hybrd()}}
{\footnotesize\ttfamily subroutine, public hto\+\_\+solve\+\_\+nonlin\+::hto\+\_\+hybrd (\begin{DoxyParamCaption}\item[{}]{H\+T\+O\+\_\+\+F\+CN,  }\item[{integer, intent(in)}]{n,  }\item[{real$\ast$8, dimension(n), intent(inout)}]{x,  }\item[{real$\ast$8, dimension(n), intent(inout)}]{fvec,  }\item[{real$\ast$8, intent(in)}]{xtol,  }\item[{integer, intent(inout)}]{maxfev,  }\item[{integer, intent(inout)}]{ml,  }\item[{integer, intent(in)}]{mu,  }\item[{real$\ast$8, intent(in)}]{epsfcn,  }\item[{real$\ast$8, dimension(n), intent(out)}]{diag,  }\item[{integer, intent(in)}]{mode,  }\item[{real$\ast$8, intent(in)}]{factor,  }\item[{integer, intent(inout)}]{nprint,  }\item[{integer, intent(out)}]{info,  }\item[{integer, intent(out)}]{nfev }\end{DoxyParamCaption})}



Definition at line 5450 of file C\+A\+L\+L\+I\+N\+G\+\_\+cp\+H\+T\+O.\+f.


\begin{DoxyCode}{0}
\DoxyCodeLine{5450 }
\DoxyCodeLine{5451       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: n}
\DoxyCodeLine{5452       real*8, \textcolor{keywordtype}{INTENT(IN OUT)}  :: x(n)}
\DoxyCodeLine{5453       real*8, \textcolor{keywordtype}{INTENT(IN OUT)}  :: fvec(n)}
\DoxyCodeLine{5454       real*8, \textcolor{keywordtype}{INTENT(IN)}      :: xtol}
\DoxyCodeLine{5455       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN OUT)}    :: maxfev}
\DoxyCodeLine{5456       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN OUT)}    :: ml}
\DoxyCodeLine{5457       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: mu}
\DoxyCodeLine{5458       real*8, \textcolor{keywordtype}{INTENT(IN)}      :: epsfcn}
\DoxyCodeLine{5459       real*8, \textcolor{keywordtype}{INTENT(OUT)}     :: diag(n)}
\DoxyCodeLine{5460       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: mode}
\DoxyCodeLine{5461       real*8, \textcolor{keywordtype}{INTENT(IN)}      :: factor}
\DoxyCodeLine{5462       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN OUT)}    :: nprint}
\DoxyCodeLine{5463       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(OUT)}       :: info}
\DoxyCodeLine{5464       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(OUT)}       :: nfev}
\DoxyCodeLine{5465 }
\DoxyCodeLine{5466 \textcolor{comment}{! EXTERNAL fcn}}
\DoxyCodeLine{5467 }
\DoxyCodeLine{5468       \textcolor{keyword}{INTERFACE}}
\DoxyCodeLine{5469        \textcolor{keyword}{SUBROUTINE }hto\_fcn(N,X,FVEC,IFLAG)}
\DoxyCodeLine{5470        \textcolor{keywordtype}{IMPLICIT NONE}}
\DoxyCodeLine{5471        \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}      :: n}
\DoxyCodeLine{5472        real*8, \textcolor{keywordtype}{INTENT(IN)}    :: x(n)}
\DoxyCodeLine{5473        real*8, \textcolor{keywordtype}{INTENT(OUT)}   :: fvec(n)}
\DoxyCodeLine{5474        \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN OUT)}  :: iflag}
\DoxyCodeLine{5475        \textcolor{keyword}{END SUBROUTINE }hto\_fcn}
\DoxyCodeLine{5476       \textcolor{keyword}{END INTERFACE}}
\DoxyCodeLine{5477 }
\DoxyCodeLine{5478 \textcolor{comment}{!   **********}}
\DoxyCodeLine{5479 }
\DoxyCodeLine{5480 \textcolor{comment}{!   SUBROUTINE HTO\_HYBRD}}
\DoxyCodeLine{5481 }
\DoxyCodeLine{5482 \textcolor{comment}{!   THE PURPOSE OF HYBRD IS TO FIND A ZERO OF A SYSTEM OF N NONLINEAR}}
\DoxyCodeLine{5483 \textcolor{comment}{!   FUNCTIONS IN N VARIABLES BY A MODIFICATION OF THE POWELL HYBRID METHOD.}}
\DoxyCodeLine{5484 \textcolor{comment}{!   THE USER MUST PROVIDE A SUBROUTINE HTO\_WHICH CALCULATES THE FUNCTIONS.}}
\DoxyCodeLine{5485 \textcolor{comment}{!   THE JACOBIAN IS THEN CALCULATED BY A FORWARD-\/DIFFERENCE APPROXIMATION.}}
\DoxyCodeLine{5486 }
\DoxyCodeLine{5487 \textcolor{comment}{!   THE SUBROUTINE HTO\_STATEMENT IS}}
\DoxyCodeLine{5488 }
\DoxyCodeLine{5489 \textcolor{comment}{!     SUBROUTINE HTO\_HYBRD(FCN,N,X,FVEC,XTOL,MAXFEV,ML,MU,EPSFCN,}}
\DoxyCodeLine{5490 \textcolor{comment}{!                      DIAG,MODE,FACTOR,NPRINT,INFO,NFEV,FJAC,}}
\DoxyCodeLine{5491 \textcolor{comment}{!                      LDFJAC,R,LR,QTF,WA1,WA2,WA3,WA4)}}
\DoxyCodeLine{5492 }
\DoxyCodeLine{5493 \textcolor{comment}{!   WHERE}}
\DoxyCodeLine{5494 }
\DoxyCodeLine{5495 \textcolor{comment}{!     FCN IS THE NAME OF THE USER-\/SUPPLIED SUBROUTINE HTO\_WHICH CALCULATES}}
\DoxyCodeLine{5496 \textcolor{comment}{!       THE FUNCTIONS.  FCN MUST BE DECLARED IN AN EXTERNAL STATEMENT IN}}
\DoxyCodeLine{5497 \textcolor{comment}{!       THE USER CALLING PROGRAM, AND SHOULD BE WRITTEN AS FOLLOWS.}}
\DoxyCodeLine{5498 }
\DoxyCodeLine{5499 \textcolor{comment}{!       SUBROUTINE HTO\_FCN(N, X, FVEC, IFLAG)}}
\DoxyCodeLine{5500 \textcolor{comment}{!       INTEGER N, IFLAG}}
\DoxyCodeLine{5501 \textcolor{comment}{!       REAL X(N), FVEC(N)}}
\DoxyCodeLine{5502 \textcolor{comment}{!       -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{5503 \textcolor{comment}{!       CALCULATE THE FUNCTIONS AT X AND}}
\DoxyCodeLine{5504 \textcolor{comment}{!       RETURN THIS VECTOR IN FVEC.}}
\DoxyCodeLine{5505 \textcolor{comment}{!       -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{5506 \textcolor{comment}{!       RETURN}}
\DoxyCodeLine{5507 \textcolor{comment}{!       END}}
\DoxyCodeLine{5508 }
\DoxyCodeLine{5509 \textcolor{comment}{!       THE VALUE OF IFLAG SHOULD NOT BE CHANGED BY FCN UNLESS}}
\DoxyCodeLine{5510 \textcolor{comment}{!       THE USER WANTS TO TERMINATE EXECUTION OF HYBRD.}}
\DoxyCodeLine{5511 \textcolor{comment}{!       IN THIS CASE SET IFLAG TO A NEGATIVE INTEGER.}}
\DoxyCodeLine{5512 }
\DoxyCodeLine{5513 \textcolor{comment}{!     N IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER}}
\DoxyCodeLine{5514 \textcolor{comment}{!       OF FUNCTIONS AND VARIABLES.}}
\DoxyCodeLine{5515 }
\DoxyCodeLine{5516 \textcolor{comment}{!     X IS AN ARRAY OF LENGTH N.  ON INPUT X MUST CONTAIN AN INITIAL}}
\DoxyCodeLine{5517 \textcolor{comment}{!       ESTIMATE OF THE SOLUTION VECTOR.  ON OUTPUT X CONTAINS THE FINAL}}
\DoxyCodeLine{5518 \textcolor{comment}{!       ESTIMATE OF THE SOLUTION VECTOR.}}
\DoxyCodeLine{5519 }
\DoxyCodeLine{5520 \textcolor{comment}{!     FVEC IS AN OUTPUT ARRAY OF LENGTH N WHICH CONTAINS}}
\DoxyCodeLine{5521 \textcolor{comment}{!       THE FUNCTIONS EVALUATED AT THE OUTPUT X.}}
\DoxyCodeLine{5522 }
\DoxyCodeLine{5523 \textcolor{comment}{!     XTOL IS A NONNEGATIVE INPUT VARIABLE.  TERMINATION OCCURS WHEN THE}}
\DoxyCodeLine{5524 \textcolor{comment}{!       RELATIVE ERROR BETWEEN TWO CONSECUTIVE ITERATES IS AT MOST XTOL.}}
\DoxyCodeLine{5525 }
\DoxyCodeLine{5526 \textcolor{comment}{!     MAXFEV IS A POSITIVE INTEGER INPUT VARIABLE.  TERMINATION OCCURS WHEN}}
\DoxyCodeLine{5527 \textcolor{comment}{!       THE NUMBER OF CALLS TO FCN IS AT LEAST MAXFEV BY THE END OF AN}}
\DoxyCodeLine{5528 \textcolor{comment}{!       ITERATION.}}
\DoxyCodeLine{5529 }
\DoxyCodeLine{5530 \textcolor{comment}{!     ML IS A NONNEGATIVE INTEGER INPUT VARIABLE WHICH SPECIFIES THE}}
\DoxyCodeLine{5531 \textcolor{comment}{!       NUMBER OF SUBDIAGONALS WITHIN THE BAND OF THE JACOBIAN MATRIX.}}
\DoxyCodeLine{5532 \textcolor{comment}{!       IF THE JACOBIAN IS NOT BANDED, SET ML TO AT LEAST N -\/ 1.}}
\DoxyCodeLine{5533 }
\DoxyCodeLine{5534 \textcolor{comment}{!     MU IS A NONNEGATIVE INTEGER INPUT VARIABLE WHICH SPECIFIES THE NUMBER}}
\DoxyCodeLine{5535 \textcolor{comment}{!       OF SUPERDIAGONALS WITHIN THE BAND OF THE JACOBIAN MATRIX.}}
\DoxyCodeLine{5536 \textcolor{comment}{!       IF THE JACOBIAN IS NOT BANDED, SET MU TO AT LEAST N -\/ 1.}}
\DoxyCodeLine{5537 }
\DoxyCodeLine{5538 \textcolor{comment}{!     EPSFCN IS AN INPUT VARIABLE USED IN DETERMINING A SUITABLE STEP LENGTH}}
\DoxyCodeLine{5539 \textcolor{comment}{!       FOR THE FORWARD-\/DIFFERENCE APPROXIMATION.  THIS APPROXIMATION}}
\DoxyCodeLine{5540 \textcolor{comment}{!       ASSUMES THAT THE RELATIVE ERRORS IN THE FUNCTIONS ARE OF THE ORDER}}
\DoxyCodeLine{5541 \textcolor{comment}{!       OF EPSFCN. IF EPSFCN IS LESS THAN THE MACHINE PRECISION,}}
\DoxyCodeLine{5542 \textcolor{comment}{!       IT IS ASSUMED THAT THE RELATIVE ERRORS IN THE FUNCTIONS ARE OF THE}}
\DoxyCodeLine{5543 \textcolor{comment}{!       ORDER OF THE MACHINE PRECISION.}}
\DoxyCodeLine{5544 }
\DoxyCodeLine{5545 \textcolor{comment}{!     DIAG IS AN ARRAY OF LENGTH N. IF MODE= 1 (SEE BELOW),}}
\DoxyCodeLine{5546 \textcolor{comment}{!       DIAG IS INTERNALLY SET.  IF MODE= 2, DIAG MUST CONTAIN POSITIVE}}
\DoxyCodeLine{5547 \textcolor{comment}{!       ENTRIES THAT SERVE AS MULTIPLICATIVE SCALE FACTORS FOR THE}}
\DoxyCodeLine{5548 \textcolor{comment}{!       VARIABLES.}}
\DoxyCodeLine{5549 }
\DoxyCodeLine{5550 \textcolor{comment}{!     MODE IS AN INTEGER INPUT VARIABLE. IF MODE= 1, THE VARIABLES WILL BE}}
\DoxyCodeLine{5551 \textcolor{comment}{!       SCALED INTERNALLY.  IF MODE= 2, THE SCALING IS SPECIFIED BY THE}}
\DoxyCodeLine{5552 \textcolor{comment}{!       INPUT DIAG.  OTHER VALUES OF MODE ARE EQUIVALENT TO MODE= 1.}}
\DoxyCodeLine{5553 }
\DoxyCodeLine{5554 \textcolor{comment}{!     FACTOR IS A POSITIVE INPUT VARIABLE USED IN DETERMINING THE}}
\DoxyCodeLine{5555 \textcolor{comment}{!       INITIAL STEP BOUND. THIS BOUND IS SET TO THE PRODUCT OF}}
\DoxyCodeLine{5556 \textcolor{comment}{!       FACTOR AND THE EUCLIDEAN NORM OF DIAG*X IF NONZERO, OR ELSE}}
\DoxyCodeLine{5557 \textcolor{comment}{!       TO FACTOR ITSELF. IN MOST CASES FACTOR SHOULD LIE IN THE}}
\DoxyCodeLine{5558 \textcolor{comment}{!       INTERVAL (.1,100.). 100. IS A GENERALLY RECOMMENDED VALUE.}}
\DoxyCodeLine{5559 }
\DoxyCodeLine{5560 \textcolor{comment}{!     NPRINT IS AN INTEGER INPUT VARIABLE THAT ENABLES CONTROLLED}}
\DoxyCodeLine{5561 \textcolor{comment}{!       PRINTING OF ITERATES IF IT IS POSITIVE. IN THIS CASE,}}
\DoxyCodeLine{5562 \textcolor{comment}{!       FCN IS CALLED WITH IFLAG= 0 AT THE BEGINNING OF THE FIRST}}
\DoxyCodeLine{5563 \textcolor{comment}{!       ITERATION AND EVERY NPRINT ITERATIONS THEREAFTER AND}}
\DoxyCodeLine{5564 \textcolor{comment}{!       IMMEDIATELY PRIOR TO RETURN, WITH X AND FVEC AVAILABLE}}
\DoxyCodeLine{5565 \textcolor{comment}{!       FOR PRINTING. IF NPRINT IS NOT POSITIVE, NO SPECIAL CALLS}}
\DoxyCodeLine{5566 \textcolor{comment}{!       OF FCN WITH IFLAG= 0 ARE MADE.}}
\DoxyCodeLine{5567 }
\DoxyCodeLine{5568 \textcolor{comment}{!     INFO IS AN INTEGER OUTPUT VARIABLE. IF THE USER HAS}}
\DoxyCodeLine{5569 \textcolor{comment}{!       TERMINATED EXECUTION, INFO IS SET TO THE (NEGATIVE)}}
\DoxyCodeLine{5570 \textcolor{comment}{!       VALUE OF IFLAG. SEE DESCRIPTION OF FCN. OTHERWISE,}}
\DoxyCodeLine{5571 \textcolor{comment}{!       INFO IS SET AS FOLLOWS.}}
\DoxyCodeLine{5572 }
\DoxyCodeLine{5573 \textcolor{comment}{!       INFO= 0   IMPROPER INPUT PARAMETERS.}}
\DoxyCodeLine{5574 }
\DoxyCodeLine{5575 \textcolor{comment}{!       INFO= 1   RELATIVE ERROR BETWEEN TWO CONSECUTIVE ITERATES}}
\DoxyCodeLine{5576 \textcolor{comment}{!                  IS AT MOST XTOL.}}
\DoxyCodeLine{5577 }
\DoxyCodeLine{5578 \textcolor{comment}{!       INFO= 2   NUMBER OF CALLS TO FCN HAS REACHED OR EXCEEDED MAXFEV.}}
\DoxyCodeLine{5579 }
\DoxyCodeLine{5580 \textcolor{comment}{!       INFO= 3   XTOL IS TOO SMALL. NO FURTHER IMPROVEMENT IN}}
\DoxyCodeLine{5581 \textcolor{comment}{!                  THE APPROXIMATE SOLUTION X IS POSSIBLE.}}
\DoxyCodeLine{5582 }
\DoxyCodeLine{5583 \textcolor{comment}{!       INFO= 4   ITERATION IS NOT MAKING GOOD PROGRESS, AS}}
\DoxyCodeLine{5584 \textcolor{comment}{!                  MEASURED BY THE IMPROVEMENT FROM THE LAST}}
\DoxyCodeLine{5585 \textcolor{comment}{!                  FIVE JACOBIAN EVALUATIONS.}}
\DoxyCodeLine{5586 }
\DoxyCodeLine{5587 \textcolor{comment}{!       INFO= 5   ITERATION IS NOT MAKING GOOD PROGRESS, AS MEASURED BY}}
\DoxyCodeLine{5588 \textcolor{comment}{!                  THE IMPROVEMENT FROM THE LAST TEN ITERATIONS.}}
\DoxyCodeLine{5589 }
\DoxyCodeLine{5590 \textcolor{comment}{!     NFEV IS AN INTEGER OUTPUT VARIABLE SET TO THE NUMBER OF CALLS TO FCN.}}
\DoxyCodeLine{5591 }
\DoxyCodeLine{5592 \textcolor{comment}{!     FJAC IS AN OUTPUT N BY N ARRAY WHICH CONTAINS THE ORTHOGONAL MATRIX Q}}
\DoxyCodeLine{5593 \textcolor{comment}{!       PRODUCED BY THE QR FACTORIZATION OF THE FINAL APPROXIMATE JACOBIAN.}}
\DoxyCodeLine{5594 }
\DoxyCodeLine{5595 \textcolor{comment}{!     LDFJAC IS A POSITIVE INTEGER INPUT VARIABLE NOT LESS THAN N}}
\DoxyCodeLine{5596 \textcolor{comment}{!       WHICH SPECIFIES THE LEADING DIMENSION OF THE ARRAY FJAC.}}
\DoxyCodeLine{5597 }
\DoxyCodeLine{5598 \textcolor{comment}{!     R IS AN OUTPUT ARRAY OF LENGTH LR WHICH CONTAINS THE}}
\DoxyCodeLine{5599 \textcolor{comment}{!       UPPER TRIANGULAR MATRIX PRODUCED BY THE QR FACTORIZATION}}
\DoxyCodeLine{5600 \textcolor{comment}{!       OF THE FINAL APPROXIMATE JACOBIAN, STORED ROWWISE.}}
\DoxyCodeLine{5601 }
\DoxyCodeLine{5602 \textcolor{comment}{!     LR IS A POSITIVE INTEGER INPUT VARIABLE NOT LESS THAN (N*(N+1))/2.}}
\DoxyCodeLine{5603 }
\DoxyCodeLine{5604 \textcolor{comment}{!     QTF IS AN OUTPUT ARRAY OF LENGTH N WHICH CONTAINS}}
\DoxyCodeLine{5605 \textcolor{comment}{!       THE VECTOR (Q TRANSPOSE)*FVEC.}}
\DoxyCodeLine{5606 }
\DoxyCodeLine{5607 \textcolor{comment}{!     WA1, WA2, WA3, AND WA4 ARE WORK ARRAYS OF LENGTH N.}}
\DoxyCodeLine{5608 }
\DoxyCodeLine{5609 \textcolor{comment}{!   SUBPROGRAMS CALLED}}
\DoxyCodeLine{5610 }
\DoxyCodeLine{5611 \textcolor{comment}{!     USER-\/SUPPLIED ...... FCN}}
\DoxyCodeLine{5612 }
\DoxyCodeLine{5613 \textcolor{comment}{!     MINPACK-\/SUPPLIED ... DOGLEG,SPMPAR,ENORM,FDJAC1,}}
\DoxyCodeLine{5614 \textcolor{comment}{!                          QFORM,QRFAC,R1MPYQ,R1UPDT}}
\DoxyCodeLine{5615 }
\DoxyCodeLine{5616 \textcolor{comment}{!     FORTRAN-\/SUPPLIED ... ABS,MAX,MIN,MIN,MOD}}
\DoxyCodeLine{5617 }
\DoxyCodeLine{5618 \textcolor{comment}{!   ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.}}
\DoxyCodeLine{5619 \textcolor{comment}{!   BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE}}
\DoxyCodeLine{5620 }
\DoxyCodeLine{5621 \textcolor{comment}{!   **********}}
\DoxyCodeLine{5622       }
\DoxyCodeLine{5623       \textcolor{keywordtype}{INTEGER}    :: i,iflag,iter,j,jm1,l,lr,msum,ncfail,ncsuc,}
\DoxyCodeLine{5624      \#              nslow1,nslow2}
\DoxyCodeLine{5625       \textcolor{keywordtype}{INTEGER}    :: iwa(1)}
\DoxyCodeLine{5626       \textcolor{keywordtype}{LOGICAL}    :: jeval,sing}
\DoxyCodeLine{5627       real*8  :: actred,delta,epsmch,fnorm,fnorm1,pnorm,prered,  }
\DoxyCodeLine{5628      \#           ratio,sum,temp,xnorm}
\DoxyCodeLine{5629       real*8, \textcolor{keywordtype}{PARAMETER}  :: \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}= 1.0d0,p1= 0.1d0,p5= 0.5d0,  }
\DoxyCodeLine{5630      \#                      p001= 0.001d0,p0001= 0.0001d0,\mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}= 0.0d0}
\DoxyCodeLine{5631       real*8  :: fjac(n,n),r(n*(n+1)/2),qtf(n),wa1(n),wa2(n),}
\DoxyCodeLine{5632      \#           wa3(n),wa4(n)}
\DoxyCodeLine{5633 \textcolor{comment}{*}}
\DoxyCodeLine{5634       epsmch= epsilon(1.0d0)}
\DoxyCodeLine{5635       info= 0}
\DoxyCodeLine{5636       iflag= 0}
\DoxyCodeLine{5637       nfev= 0}
\DoxyCodeLine{5638       lr= n*(n+1)/2}
\DoxyCodeLine{5639       \textcolor{keywordflow}{IF}(n > 0.and.xtol >= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}.and.maxfev > 0.and.ml >= 0}
\DoxyCodeLine{5640      \#        .and.mu >= 0.and.factor > \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}} ) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5641       \textcolor{keywordflow}{IF}(mode == 2) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5642        diag(1:n)= \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}}
\DoxyCodeLine{5643 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{5644       iflag= 1}
\DoxyCodeLine{5645       \textcolor{keyword}{CALL }hto\_fcn(n,x,fvec,iflag)}
\DoxyCodeLine{5646       nfev= 1}
\DoxyCodeLine{5647       \textcolor{keywordflow}{IF}(iflag >= 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5648       fnorm= \mbox{\hyperlink{namespacehto__solve__nonlin_a52df74850a83808488fb1b90d7e539ed}{hto\_enorm}}(n,fvec)}
\DoxyCodeLine{5649       msum= min(ml+mu+1,n)}
\DoxyCodeLine{5650       iter= 1}
\DoxyCodeLine{5651       ncsuc= 0}
\DoxyCodeLine{5652       ncfail= 0}
\DoxyCodeLine{5653       nslow1= 0}
\DoxyCodeLine{5654       nslow2= 0}
\DoxyCodeLine{5655   20  jeval= .true.}
\DoxyCodeLine{5656       iflag= 2}
\DoxyCodeLine{5657       \textcolor{keyword}{CALL }\mbox{\hyperlink{namespacehto__solve__nonlin_a9b9991931fe83ae42bd577aa132fd691}{hto\_fdjac1}}(hto\_fcn,n,x,fvec,fjac,n,iflag,ml,mu,epsfcn,}
\DoxyCodeLine{5658      \#                wa1,wa2)}
\DoxyCodeLine{5659       nfev= nfev+msum}
\DoxyCodeLine{5660       \textcolor{keywordflow}{IF}(iflag >= 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5661       \textcolor{keyword}{CALL }\mbox{\hyperlink{namespacehto__solve__nonlin_a98884f67245c484b378efff769d60f69}{hto\_qrfac}}(n,n,fjac,n,.false.,iwa,1,wa1,wa2,wa3)}
\DoxyCodeLine{5662       \textcolor{keywordflow}{IF}(iter == 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5663       \textcolor{keywordflow}{IF}(mode /= 2) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5664        \textcolor{keywordflow}{DO} j= 1,n}
\DoxyCodeLine{5665         diag(j)= wa2(j)}
\DoxyCodeLine{5666         \textcolor{keywordflow}{IF}(wa2(j) == \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) diag(j)= \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}}
\DoxyCodeLine{5667 \textcolor{keywordflow}{       ENDDO}}
\DoxyCodeLine{5668 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{5669       wa3(1:n)= diag(1:n)*x(1:n)}
\DoxyCodeLine{5670       xnorm= \mbox{\hyperlink{namespacehto__solve__nonlin_a52df74850a83808488fb1b90d7e539ed}{hto\_enorm}}(n,wa3)}
\DoxyCodeLine{5671       delta= factor*xnorm}
\DoxyCodeLine{5672       \textcolor{keywordflow}{IF}(delta == \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) delta= factor}
\DoxyCodeLine{5673 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{5674       qtf(1:n)= fvec(1:n)}
\DoxyCodeLine{5675       \textcolor{keywordflow}{DO} j= 1,n}
\DoxyCodeLine{5676        \textcolor{keywordflow}{IF}(fjac(j,j) /= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5677         sum= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}}
\DoxyCodeLine{5678         \textcolor{keywordflow}{DO} i= j,n}
\DoxyCodeLine{5679           sum= sum+fjac(i,j)*qtf(i)}
\DoxyCodeLine{5680 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{5681         temp= -\/sum/fjac(j,j)}
\DoxyCodeLine{5682         \textcolor{keywordflow}{DO} i= j,n}
\DoxyCodeLine{5683           qtf(i)= qtf(i)+fjac(i,j)*temp}
\DoxyCodeLine{5684 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{5685 \textcolor{keywordflow}{       ENDIF}}
\DoxyCodeLine{5686 \textcolor{keywordflow}{      ENDDO}}
\DoxyCodeLine{5687       sing= .false.}
\DoxyCodeLine{5688       \textcolor{keywordflow}{DO} j= 1,n}
\DoxyCodeLine{5689        l= j}
\DoxyCodeLine{5690        jm1= j-\/1}
\DoxyCodeLine{5691        \textcolor{keywordflow}{IF}(jm1 >= 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5692         \textcolor{keywordflow}{DO} i= 1,jm1}
\DoxyCodeLine{5693          r(l)= fjac(i,j)}
\DoxyCodeLine{5694          l= l+n-\/i}
\DoxyCodeLine{5695 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{5696 \textcolor{keywordflow}{       ENDIF}}
\DoxyCodeLine{5697        r(l)= wa1(j)}
\DoxyCodeLine{5698        \textcolor{keywordflow}{IF}(wa1(j) == \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) sing= .true.}
\DoxyCodeLine{5699 \textcolor{keywordflow}{      ENDDO}}
\DoxyCodeLine{5700       \textcolor{keyword}{CALL }\mbox{\hyperlink{namespacehto__solve__nonlin_a6c27c7948dee7924b448527cd0e47aff}{hto\_qform}}(n,n,fjac,n,wa1)}
\DoxyCodeLine{5701       \textcolor{keywordflow}{IF}(mode /= 2) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5702        \textcolor{keywordflow}{DO} j= 1,n}
\DoxyCodeLine{5703         diag(j)= max(diag(j),wa2(j))}
\DoxyCodeLine{5704 \textcolor{keywordflow}{       ENDDO}}
\DoxyCodeLine{5705 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{5706   120 \textcolor{keywordflow}{IF}(nprint > 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5707        iflag= 0}
\DoxyCodeLine{5708        \textcolor{keywordflow}{IF}(mod(iter-\/1,nprint) == 0) \textcolor{keyword}{CALL }hto\_fcn(n,x,fvec,iflag)}
\DoxyCodeLine{5709        \textcolor{keywordflow}{IF}(iflag < 0) \textcolor{keywordflow}{GO TO} 190}
\DoxyCodeLine{5710 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{5711       \textcolor{keyword}{CALL }\mbox{\hyperlink{namespacehto__solve__nonlin_afe4e5fea1ad06250f9e5ce2a5ac37e33}{hto\_dogleg}}(n,r,lr,diag,qtf,delta,wa1,wa2,wa3)}
\DoxyCodeLine{5712       \textcolor{keywordflow}{DO} j= 1,n}
\DoxyCodeLine{5713        wa1(j)= -\/wa1(j)}
\DoxyCodeLine{5714        wa2(j)= x(j)+wa1(j)}
\DoxyCodeLine{5715        wa3(j)= diag(j)*wa1(j)}
\DoxyCodeLine{5716 \textcolor{keywordflow}{      ENDDO}}
\DoxyCodeLine{5717       pnorm= \mbox{\hyperlink{namespacehto__solve__nonlin_a52df74850a83808488fb1b90d7e539ed}{hto\_enorm}}(n,wa3)}
\DoxyCodeLine{5718       \textcolor{keywordflow}{IF}(iter == 1) delta= min(delta,pnorm)}
\DoxyCodeLine{5719       iflag= 1}
\DoxyCodeLine{5720       \textcolor{keyword}{CALL }hto\_fcn(n,wa2,wa4,iflag)}
\DoxyCodeLine{5721       nfev= nfev+1}
\DoxyCodeLine{5722       \textcolor{keywordflow}{IF}(iflag >= 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5723       fnorm1= \mbox{\hyperlink{namespacehto__solve__nonlin_a52df74850a83808488fb1b90d7e539ed}{hto\_enorm}}(n,wa4)}
\DoxyCodeLine{5724       actred= -\/\mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}}
\DoxyCodeLine{5725       \textcolor{keywordflow}{IF}(fnorm1 < fnorm) actred= \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}-\/(fnorm1/fnorm)**2}
\DoxyCodeLine{5726       l= 1}
\DoxyCodeLine{5727       \textcolor{keywordflow}{DO} i= 1,n}
\DoxyCodeLine{5728        sum= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}}
\DoxyCodeLine{5729        \textcolor{keywordflow}{DO} j= i,n}
\DoxyCodeLine{5730         sum= sum+r(l)*wa1(j)}
\DoxyCodeLine{5731         l= l+1}
\DoxyCodeLine{5732 \textcolor{keywordflow}{       ENDDO}}
\DoxyCodeLine{5733        wa3(i)= qtf(i)+sum}
\DoxyCodeLine{5734 \textcolor{keywordflow}{      ENDDO}}
\DoxyCodeLine{5735       temp= \mbox{\hyperlink{namespacehto__solve__nonlin_a52df74850a83808488fb1b90d7e539ed}{hto\_enorm}}(n,wa3)}
\DoxyCodeLine{5736       prered= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}}
\DoxyCodeLine{5737       \textcolor{keywordflow}{IF}(temp < fnorm) prered= \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}-\/(temp/fnorm)**2}
\DoxyCodeLine{5738       ratio= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}}
\DoxyCodeLine{5739       \textcolor{keywordflow}{IF}(prered > \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) ratio= actred/prered}
\DoxyCodeLine{5740       \textcolor{keywordflow}{IF}(ratio < p1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5741        ncsuc= 0}
\DoxyCodeLine{5742        ncfail= ncfail+1}
\DoxyCodeLine{5743        delta= p5*delta}
\DoxyCodeLine{5744       \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{5745        ncfail= 0}
\DoxyCodeLine{5746        ncsuc= ncsuc+1}
\DoxyCodeLine{5747        \textcolor{keywordflow}{IF}(ratio >= p5.or.ncsuc > 1) delta= max(delta,pnorm/p5)}
\DoxyCodeLine{5748        \textcolor{keywordflow}{IF}(abs(ratio-\/\mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}) <= p1) delta= pnorm/p5}
\DoxyCodeLine{5749 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{5750       \textcolor{keywordflow}{IF}(ratio >= p0001) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5751        \textcolor{keywordflow}{DO} j= 1,n}
\DoxyCodeLine{5752         x(j)= wa2(j)}
\DoxyCodeLine{5753         wa2(j)= diag(j)*x(j)}
\DoxyCodeLine{5754         fvec(j)= wa4(j)}
\DoxyCodeLine{5755 \textcolor{keywordflow}{       ENDDO}}
\DoxyCodeLine{5756        xnorm= \mbox{\hyperlink{namespacehto__solve__nonlin_a52df74850a83808488fb1b90d7e539ed}{hto\_enorm}}(n,wa2)}
\DoxyCodeLine{5757        fnorm= fnorm1}
\DoxyCodeLine{5758        iter= iter+1}
\DoxyCodeLine{5759 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{5760       nslow1= nslow1+1}
\DoxyCodeLine{5761       \textcolor{keywordflow}{IF}(actred >= p001) nslow1= 0}
\DoxyCodeLine{5762       \textcolor{keywordflow}{IF}(jeval) nslow2= nslow2+1}
\DoxyCodeLine{5763       \textcolor{keywordflow}{IF}(actred >= p1) nslow2= 0}
\DoxyCodeLine{5764       \textcolor{keywordflow}{IF}(delta <= xtol*xnorm.or.fnorm == \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) info= 1}
\DoxyCodeLine{5765       \textcolor{keywordflow}{IF}(info == 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5766       \textcolor{keywordflow}{IF}(nfev >= maxfev) info= 2}
\DoxyCodeLine{5767       \textcolor{keywordflow}{IF}(p1*max(p1*delta,pnorm) <= epsmch*xnorm) info= 3}
\DoxyCodeLine{5768       \textcolor{keywordflow}{IF}(nslow2 == 5) info= 4}
\DoxyCodeLine{5769       \textcolor{keywordflow}{IF}(nslow1 == 10) info= 5}
\DoxyCodeLine{5770       \textcolor{keywordflow}{IF}(info == 0) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5771       \textcolor{keywordflow}{IF}(ncfail /= 2) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{5772       \textcolor{keywordflow}{DO} j= 1,n}
\DoxyCodeLine{5773        sum= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}}
\DoxyCodeLine{5774        \textcolor{keywordflow}{DO} i= 1,n}
\DoxyCodeLine{5775         sum= sum+fjac(i,j)*wa4(i)}
\DoxyCodeLine{5776 \textcolor{keywordflow}{       ENDDO}}
\DoxyCodeLine{5777        wa2(j)= (sum-\/wa3(j))/pnorm}
\DoxyCodeLine{5778        wa1(j)= diag(j)*((diag(j)*wa1(j))/pnorm)}
\DoxyCodeLine{5779        \textcolor{keywordflow}{IF}(ratio >= p0001) qtf(j)= sum}
\DoxyCodeLine{5780 \textcolor{keywordflow}{      ENDDO}}
\DoxyCodeLine{5781       \textcolor{keyword}{CALL }\mbox{\hyperlink{namespacehto__solve__nonlin_af73d8384fe07fde7b063afc452466f03}{hto\_r1updt}}(n,n,r,lr,wa1,wa2,wa3,sing)}
\DoxyCodeLine{5782       \textcolor{keyword}{CALL }\mbox{\hyperlink{namespacehto__solve__nonlin_a89a4ef64a31dd4d201b9b6bb3c077ab1}{hto\_r1mpyq}}(n,n,fjac,n,wa2,wa3)}
\DoxyCodeLine{5783       \textcolor{keyword}{CALL }\mbox{\hyperlink{namespacehto__solve__nonlin_a89a4ef64a31dd4d201b9b6bb3c077ab1}{hto\_r1mpyq}}(1,n,qtf,1,wa2,wa3)}
\DoxyCodeLine{5784       jeval= .false.}
\DoxyCodeLine{5785       \textcolor{keywordflow}{GO TO} 120}
\DoxyCodeLine{5786 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{5787       \textcolor{keywordflow}{GO TO} 20}
\DoxyCodeLine{5788 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{5789 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{5790 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{5791 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{5792 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{5793 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{5794 \textcolor{comment}{*}}
\DoxyCodeLine{5795  190  \textcolor{keywordflow}{IF}(iflag < 0) info= iflag}
\DoxyCodeLine{5796       iflag= 0}
\DoxyCodeLine{5797       \textcolor{keywordflow}{IF}(nprint > 0) \textcolor{keyword}{CALL }hto\_fcn(n,x,fvec,iflag)}
\DoxyCodeLine{5798       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{5799 \textcolor{comment}{*}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacehto__solve__nonlin_a6c27c7948dee7924b448527cd0e47aff}\label{namespacehto__solve__nonlin_a6c27c7948dee7924b448527cd0e47aff}} 
\index{hto\_solve\_nonlin@{hto\_solve\_nonlin}!hto\_qform@{hto\_qform}}
\index{hto\_qform@{hto\_qform}!hto\_solve\_nonlin@{hto\_solve\_nonlin}}
\doxysubsubsection{\texorpdfstring{hto\_qform()}{hto\_qform()}}
{\footnotesize\ttfamily subroutine hto\+\_\+solve\+\_\+nonlin\+::hto\+\_\+qform (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{m,  }\item[{integer, intent(in)}]{n,  }\item[{real$\ast$8, dimension(ldq,m), intent(out)}]{q,  }\item[{integer, intent(in)}]{ldq,  }\item[{real$\ast$8, dimension(m), intent(out)}]{wa }\end{DoxyParamCaption})}



Definition at line 6121 of file C\+A\+L\+L\+I\+N\+G\+\_\+cp\+H\+T\+O.\+f.


\begin{DoxyCode}{0}
\DoxyCodeLine{6121 \textcolor{comment}{*}}
\DoxyCodeLine{6122       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}     :: m}
\DoxyCodeLine{6123       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}     :: n}
\DoxyCodeLine{6124       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}     :: ldq}
\DoxyCodeLine{6125       real*8, \textcolor{keywordtype}{INTENT(OUT)}  :: q(ldq,m)}
\DoxyCodeLine{6126       real*8, \textcolor{keywordtype}{INTENT(OUT)}  :: wa(m)}
\DoxyCodeLine{6127 }
\DoxyCodeLine{6128 \textcolor{comment}{!   **********}}
\DoxyCodeLine{6129 }
\DoxyCodeLine{6130 \textcolor{comment}{!   SUBROUTINE HTO\_QFORM}}
\DoxyCodeLine{6131 }
\DoxyCodeLine{6132 \textcolor{comment}{!   THIS SUBROUTINE HTO\_PROCEEDS FROM THE COMPUTED QR FACTORIZATION OF AN M BY N}}
\DoxyCodeLine{6133 \textcolor{comment}{!   MATRIX A TO ACCUMULATE THE M BY M ORTHOGONAL MATRIX Q FROM ITS FACTORED FORM.}}
\DoxyCodeLine{6134 }
\DoxyCodeLine{6135 \textcolor{comment}{!   THE SUBROUTINE HTO\_STATEMENT IS}}
\DoxyCodeLine{6136 }
\DoxyCodeLine{6137 \textcolor{comment}{!     SUBROUTINE HTO\_QFORM(M,N,Q,LDQ,WA)}}
\DoxyCodeLine{6138 }
\DoxyCodeLine{6139 \textcolor{comment}{!   WHERE}}
\DoxyCodeLine{6140 }
\DoxyCodeLine{6141 \textcolor{comment}{!     M IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER}}
\DoxyCodeLine{6142 \textcolor{comment}{!       OF ROWS OF A AND THE ORDER OF Q.}}
\DoxyCodeLine{6143 }
\DoxyCodeLine{6144 \textcolor{comment}{!     N IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER OF COLUMNS OF A.}}
\DoxyCodeLine{6145 }
\DoxyCodeLine{6146 \textcolor{comment}{!     Q IS AN M BY M ARRAY. ON INPUT THE FULL LOWER TRAPEZOID IN}}
\DoxyCodeLine{6147 \textcolor{comment}{!       THE FIRST MIN(M,N) COLUMNS OF Q CONTAINS THE FACTORED FORM.}}
\DoxyCodeLine{6148 \textcolor{comment}{!       ON OUTPUT Q HAS BEEN ACCUMULATED INTO A SQUARE MATRIX.}}
\DoxyCodeLine{6149 }
\DoxyCodeLine{6150 \textcolor{comment}{!     LDQ IS A POSITIVE INTEGER INPUT VARIABLE NOT LESS THAN M}}
\DoxyCodeLine{6151 \textcolor{comment}{!       WHICH SPECIFIES THE LEADING DIMENSION OF THE ARRAY Q.}}
\DoxyCodeLine{6152 }
\DoxyCodeLine{6153 \textcolor{comment}{!     WA IS A WORK ARRAY OF LENGTH M.}}
\DoxyCodeLine{6154 }
\DoxyCodeLine{6155 \textcolor{comment}{!   SUBPROGRAMS CALLED}}
\DoxyCodeLine{6156 }
\DoxyCodeLine{6157 \textcolor{comment}{!     FORTRAN-\/SUPPLIED ... MIN}}
\DoxyCodeLine{6158 }
\DoxyCodeLine{6159 \textcolor{comment}{!   ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.}}
\DoxyCodeLine{6160 \textcolor{comment}{!   BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE}}
\DoxyCodeLine{6161 }
\DoxyCodeLine{6162 \textcolor{comment}{!   **********}}
\DoxyCodeLine{6163 \textcolor{comment}{*}}
\DoxyCodeLine{6164       \textcolor{keywordtype}{INTEGER}    :: i,j,jm1,k,l,minmn,np1}
\DoxyCodeLine{6165       real*8  :: sum,temp}
\DoxyCodeLine{6166       real*8, \textcolor{keywordtype}{PARAMETER}  :: \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}= 1.0d0,\mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}= 0.0d0}
\DoxyCodeLine{6167 \textcolor{comment}{*}}
\DoxyCodeLine{6168       minmn= min(m,n)}
\DoxyCodeLine{6169       \textcolor{keywordflow}{IF}(minmn >= 2) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6170        \textcolor{keywordflow}{DO} j= 2,minmn}
\DoxyCodeLine{6171         jm1= j-\/1}
\DoxyCodeLine{6172         \textcolor{keywordflow}{DO} i= 1,jm1}
\DoxyCodeLine{6173          q(i,j)= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}}
\DoxyCodeLine{6174 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{6175 \textcolor{keywordflow}{       ENDDO}}
\DoxyCodeLine{6176 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{6177       np1= n+1}
\DoxyCodeLine{6178       \textcolor{keywordflow}{IF}(m >= np1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6179        \textcolor{keywordflow}{DO} j= np1,m}
\DoxyCodeLine{6180         \textcolor{keywordflow}{DO} i= 1,m}
\DoxyCodeLine{6181          q(i,j)= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}}
\DoxyCodeLine{6182 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{6183         q(j,j)= \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}}
\DoxyCodeLine{6184 \textcolor{keywordflow}{       ENDDO}}
\DoxyCodeLine{6185 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{6186       \textcolor{keywordflow}{DO} l= 1,minmn}
\DoxyCodeLine{6187        k= minmn-\/l+1}
\DoxyCodeLine{6188        \textcolor{keywordflow}{DO} i= k,m}
\DoxyCodeLine{6189         wa(i)= q(i,k)}
\DoxyCodeLine{6190         q(i,k)= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}}
\DoxyCodeLine{6191 \textcolor{keywordflow}{       ENDDO}}
\DoxyCodeLine{6192        q(k,k)= \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}}
\DoxyCodeLine{6193        \textcolor{keywordflow}{IF}(wa(k) /= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6194         \textcolor{keywordflow}{DO} j= k,m}
\DoxyCodeLine{6195          sum= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}}
\DoxyCodeLine{6196          \textcolor{keywordflow}{DO} i= k,m}
\DoxyCodeLine{6197           sum= sum+q(i,j)*wa(i)}
\DoxyCodeLine{6198 \textcolor{keywordflow}{         ENDDO}}
\DoxyCodeLine{6199          temp= sum/wa(k)}
\DoxyCodeLine{6200          \textcolor{keywordflow}{DO} i= k,m}
\DoxyCodeLine{6201           q(i,j)= q(i,j)-\/temp*wa(i)}
\DoxyCodeLine{6202 \textcolor{keywordflow}{         ENDDO}}
\DoxyCodeLine{6203 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{6204 \textcolor{keywordflow}{       ENDIF}}
\DoxyCodeLine{6205 \textcolor{keywordflow}{      ENDDO}}
\DoxyCodeLine{6206 \textcolor{comment}{* }}
\DoxyCodeLine{6207       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{6208 \textcolor{comment}{*}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacehto__solve__nonlin_a98884f67245c484b378efff769d60f69}\label{namespacehto__solve__nonlin_a98884f67245c484b378efff769d60f69}} 
\index{hto\_solve\_nonlin@{hto\_solve\_nonlin}!hto\_qrfac@{hto\_qrfac}}
\index{hto\_qrfac@{hto\_qrfac}!hto\_solve\_nonlin@{hto\_solve\_nonlin}}
\doxysubsubsection{\texorpdfstring{hto\_qrfac()}{hto\_qrfac()}}
{\footnotesize\ttfamily subroutine hto\+\_\+solve\+\_\+nonlin\+::hto\+\_\+qrfac (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{m,  }\item[{integer, intent(in)}]{n,  }\item[{real$\ast$8, dimension(lda,n), intent(inout)}]{a,  }\item[{integer, intent(in)}]{lda,  }\item[{logical, intent(in)}]{pivot,  }\item[{integer, dimension(lipvt), intent(out)}]{ipvt,  }\item[{integer, intent(in)}]{lipvt,  }\item[{real$\ast$8, dimension(n), intent(out)}]{rdiag,  }\item[{real$\ast$8, dimension(n), intent(out)}]{acnorm,  }\item[{real$\ast$8, dimension(n), intent(out)}]{wa }\end{DoxyParamCaption})}



Definition at line 6214 of file C\+A\+L\+L\+I\+N\+G\+\_\+cp\+H\+T\+O.\+f.


\begin{DoxyCode}{0}
\DoxyCodeLine{6214 \textcolor{comment}{*}}
\DoxyCodeLine{6215       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: m}
\DoxyCodeLine{6216       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: n}
\DoxyCodeLine{6217       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: lda}
\DoxyCodeLine{6218       real*8, \textcolor{keywordtype}{INTENT(IN OUT)}  :: a(lda,n)}
\DoxyCodeLine{6219       \textcolor{keywordtype}{LOGICAL}, \textcolor{keywordtype}{INTENT(IN)}        :: pivot}
\DoxyCodeLine{6220       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: lipvt}
\DoxyCodeLine{6221       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(OUT)}       :: ipvt(lipvt)}
\DoxyCodeLine{6222       real*8, \textcolor{keywordtype}{INTENT(OUT)}     :: rdiag(n)}
\DoxyCodeLine{6223       real*8, \textcolor{keywordtype}{INTENT(OUT)}     :: acnorm(n)}
\DoxyCodeLine{6224       real*8, \textcolor{keywordtype}{INTENT(OUT)}     :: wa(n)}
\DoxyCodeLine{6225 }
\DoxyCodeLine{6226 \textcolor{comment}{!   **********}}
\DoxyCodeLine{6227 }
\DoxyCodeLine{6228 \textcolor{comment}{!   SUBROUTINE HTO\_QRFAC}}
\DoxyCodeLine{6229 }
\DoxyCodeLine{6230 \textcolor{comment}{!   THIS SUBROUTINE HTO\_USES HOUSEHOLDER TRANSFORMATIONS WITH COLUMN PIVOTING}}
\DoxyCodeLine{6231 \textcolor{comment}{!   (OPTIONAL) TO COMPUTE A QR FACTORIZATION OF THE M BY N MATRIX A.}}
\DoxyCodeLine{6232 \textcolor{comment}{!   THAT IS, QRFAC DETERMINES AN ORTHOGONAL MATRIX Q, A PERMUTATION MATRIX P,}}
\DoxyCodeLine{6233 \textcolor{comment}{!   AND AN UPPER TRAPEZOIDAL MATRIX R WITH DIAGONAL ELEMENTS OF NONINCREASING}}
\DoxyCodeLine{6234 \textcolor{comment}{!   MAGNITUDE, SUCH THAT A*P= Q*R.  THE HOUSEHOLDER TRANSFORMATION FOR}}
\DoxyCodeLine{6235 \textcolor{comment}{!   COLUMN K, K= 1,2,...,MIN(M,N), IS OF THE FORM}}
\DoxyCodeLine{6236 }
\DoxyCodeLine{6237 \textcolor{comment}{!                         T}}
\DoxyCodeLine{6238 \textcolor{comment}{!         I -\/ (1/U(K))*U*U}}
\DoxyCodeLine{6239 }
\DoxyCodeLine{6240 \textcolor{comment}{!   WHERE U HAS ZEROS IN THE FIRST K-\/1 POSITIONS.  THE FORM OF THIS}}
\DoxyCodeLine{6241 \textcolor{comment}{!   TRANSFORMATION AND THE METHOD OF PIVOTING FIRST APPEARED IN THE}}
\DoxyCodeLine{6242 \textcolor{comment}{!   CORRESPONDING LINPACK SUBROUTINE.}}
\DoxyCodeLine{6243 }
\DoxyCodeLine{6244 \textcolor{comment}{!   THE SUBROUTINE HTO\_STATEMENT IS}}
\DoxyCodeLine{6245 }
\DoxyCodeLine{6246 \textcolor{comment}{!     SUBROUTINE HTO\_QRFAC(M,N,A,LDA,PIVOT,IPVT,LIPVT,RDIAG,ACNORM,WA)}}
\DoxyCodeLine{6247 }
\DoxyCodeLine{6248 \textcolor{comment}{!   WHERE}}
\DoxyCodeLine{6249 }
\DoxyCodeLine{6250 \textcolor{comment}{!     M IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER OF ROWS OF A.}}
\DoxyCodeLine{6251 }
\DoxyCodeLine{6252 \textcolor{comment}{!     N IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER}}
\DoxyCodeLine{6253 \textcolor{comment}{!       OF COLUMNS OF A.}}
\DoxyCodeLine{6254 }
\DoxyCodeLine{6255 \textcolor{comment}{!     A IS AN M BY N ARRAY.  ON INPUT A CONTAINS THE MATRIX FOR WHICH THE}}
\DoxyCodeLine{6256 \textcolor{comment}{!       QR FACTORIZATION IS TO BE COMPUTED.  ON OUTPUT THE STRICT UPPER}}
\DoxyCodeLine{6257 \textcolor{comment}{!       TRAPEZOIDAL PART OF A CONTAINS THE STRICT UPPER TRAPEZOIDAL PART OF R,}}
\DoxyCodeLine{6258 \textcolor{comment}{!       AND THE LOWER TRAPEZOIDAL PART OF A CONTAINS A FACTORED FORM OF Q}}
\DoxyCodeLine{6259 \textcolor{comment}{!       (THE NON-\/TRIVIAL ELEMENTS OF THE U VECTORS DESCRIBED ABOVE).}}
\DoxyCodeLine{6260 }
\DoxyCodeLine{6261 \textcolor{comment}{!     LDA IS A POSITIVE INTEGER INPUT VARIABLE NOT LESS THAN M}}
\DoxyCodeLine{6262 \textcolor{comment}{!       WHICH SPECIFIES THE LEADING DIMENSION OF THE ARRAY A.}}
\DoxyCodeLine{6263 }
\DoxyCodeLine{6264 \textcolor{comment}{!     PIVOT IS A LOGICAL INPUT VARIABLE.  IF PIVOT IS SET TRUE,}}
\DoxyCodeLine{6265 \textcolor{comment}{!       THEN COLUMN PIVOTING IS ENFORCED.  IF PIVOT IS SET FALSE,}}
\DoxyCodeLine{6266 \textcolor{comment}{!       THEN NO COLUMN PIVOTING IS DONE.}}
\DoxyCodeLine{6267 }
\DoxyCodeLine{6268 \textcolor{comment}{!     IPVT IS AN INTEGER OUTPUT ARRAY OF LENGTH LIPVT.  IPVT DEFINES THE}}
\DoxyCodeLine{6269 \textcolor{comment}{!       PERMUTATION MATRIX P SUCH THAT A*P= Q*R.}}
\DoxyCodeLine{6270 \textcolor{comment}{!       COLUMN J OF P IS COLUMN IPVT(J) OF THE IDENTITY MATRIX.}}
\DoxyCodeLine{6271 \textcolor{comment}{!       IF PIVOT IS FALSE, IPVT IS NOT REFERENCED.}}
\DoxyCodeLine{6272 }
\DoxyCodeLine{6273 \textcolor{comment}{!     LIPVT IS A POSITIVE INTEGER INPUT VARIABLE.  IF PIVOT IS FALSE,}}
\DoxyCodeLine{6274 \textcolor{comment}{!       THEN LIPVT MAY BE AS SMALL AS 1.  IF PIVOT IS TRUE, THEN}}
\DoxyCodeLine{6275 \textcolor{comment}{!       LIPVT MUST BE AT LEAST N.}}
\DoxyCodeLine{6276 }
\DoxyCodeLine{6277 \textcolor{comment}{!     RDIAG IS AN OUTPUT ARRAY OF LENGTH N WHICH CONTAINS THE}}
\DoxyCodeLine{6278 \textcolor{comment}{!       DIAGONAL ELEMENTS OF R.}}
\DoxyCodeLine{6279 }
\DoxyCodeLine{6280 \textcolor{comment}{!     ACNORM IS AN OUTPUT ARRAY OF LENGTH N WHICH CONTAINS THE NORMS OF}}
\DoxyCodeLine{6281 \textcolor{comment}{!       THE CORRESPONDING COLUMNS OF THE INPUT MATRIX A.}}
\DoxyCodeLine{6282 \textcolor{comment}{!       IF THIS INFORMATION IS NOT NEEDED, THEN ACNORM CAN COINCIDE WITH RDIAG.}}
\DoxyCodeLine{6283 }
\DoxyCodeLine{6284 \textcolor{comment}{!     WA IS A WORK ARRAY OF LENGTH N. IF PIVOT IS FALSE, THEN WA}}
\DoxyCodeLine{6285 \textcolor{comment}{!       CAN COINCIDE WITH RDIAG.}}
\DoxyCodeLine{6286 }
\DoxyCodeLine{6287 \textcolor{comment}{!   SUBPROGRAMS CALLED}}
\DoxyCodeLine{6288 }
\DoxyCodeLine{6289 \textcolor{comment}{!     MINPACK-\/SUPPLIED ... SPMPAR,ENORM}}
\DoxyCodeLine{6290 }
\DoxyCodeLine{6291 \textcolor{comment}{!     FORTRAN-\/SUPPLIED ... MAX,SQRT,MIN}}
\DoxyCodeLine{6292 }
\DoxyCodeLine{6293 \textcolor{comment}{!   ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.}}
\DoxyCodeLine{6294 \textcolor{comment}{!   BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE}}
\DoxyCodeLine{6295 }
\DoxyCodeLine{6296 \textcolor{comment}{!   **********}}
\DoxyCodeLine{6297       \textcolor{keywordtype}{INTEGER}    :: i,j,jp1,k,kmax,minmn}
\DoxyCodeLine{6298       real*8  :: ajnorm,epsmch,sum,temp}
\DoxyCodeLine{6299       real*8, \textcolor{keywordtype}{PARAMETER}  :: \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}= 1.0d0,p05= 0.05d0,\mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}= 0.0d0}
\DoxyCodeLine{6300 \textcolor{comment}{*}}
\DoxyCodeLine{6301       epsmch= epsilon(1.0d0)}
\DoxyCodeLine{6302       \textcolor{keywordflow}{DO} j= 1,n}
\DoxyCodeLine{6303        acnorm(j)= \mbox{\hyperlink{namespacehto__solve__nonlin_a52df74850a83808488fb1b90d7e539ed}{hto\_enorm}}(m,a(1:,j))}
\DoxyCodeLine{6304        rdiag(j)= acnorm(j)}
\DoxyCodeLine{6305        wa(j)= rdiag(j)}
\DoxyCodeLine{6306        \textcolor{keywordflow}{IF}(pivot) ipvt(j)= j}
\DoxyCodeLine{6307 \textcolor{keywordflow}{      ENDDO}}
\DoxyCodeLine{6308       minmn= min(m,n)}
\DoxyCodeLine{6309       \textcolor{keywordflow}{DO} j= 1,minmn}
\DoxyCodeLine{6310        \textcolor{keywordflow}{IF}(pivot) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6311         kmax= j}
\DoxyCodeLine{6312         \textcolor{keywordflow}{DO} k= j,n}
\DoxyCodeLine{6313          \textcolor{keywordflow}{IF}(rdiag(k) > rdiag(kmax)) kmax= k}
\DoxyCodeLine{6314 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{6315         \textcolor{keywordflow}{IF}(kmax /= j) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6316          \textcolor{keywordflow}{DO} i= 1,m}
\DoxyCodeLine{6317           temp= a(i,j)}
\DoxyCodeLine{6318           a(i,j)= a(i,kmax)}
\DoxyCodeLine{6319           a(i,kmax)= temp}
\DoxyCodeLine{6320 \textcolor{keywordflow}{         ENDDO}}
\DoxyCodeLine{6321          rdiag(kmax)= rdiag(j)}
\DoxyCodeLine{6322          wa(kmax)= wa(j)}
\DoxyCodeLine{6323          k= ipvt(j)}
\DoxyCodeLine{6324          ipvt(j)= ipvt(kmax)}
\DoxyCodeLine{6325          ipvt(kmax)= k}
\DoxyCodeLine{6326 \textcolor{keywordflow}{        ENDIF}}
\DoxyCodeLine{6327 \textcolor{keywordflow}{       ENDIF}}
\DoxyCodeLine{6328        ajnorm= \mbox{\hyperlink{namespacehto__solve__nonlin_a52df74850a83808488fb1b90d7e539ed}{hto\_enorm}}(m-\/j+1,a(j:,j))}
\DoxyCodeLine{6329        \textcolor{keywordflow}{IF}(ajnorm /= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6330         \textcolor{keywordflow}{IF}(a(j,j) < \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) ajnorm= -\/ajnorm}
\DoxyCodeLine{6331         \textcolor{keywordflow}{DO} i= j,m}
\DoxyCodeLine{6332          a(i,j)= a(i,j)/ajnorm}
\DoxyCodeLine{6333 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{6334         a(j,j)= a(j,j)+\mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}}
\DoxyCodeLine{6335         jp1= j+1}
\DoxyCodeLine{6336         \textcolor{keywordflow}{IF}(n >= jp1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6337          \textcolor{keywordflow}{DO} k= jp1,n}
\DoxyCodeLine{6338           sum= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}}
\DoxyCodeLine{6339           \textcolor{keywordflow}{DO} i= j,m}
\DoxyCodeLine{6340            sum= sum+a(i,j)*a(i,k)}
\DoxyCodeLine{6341 \textcolor{keywordflow}{          ENDDO}}
\DoxyCodeLine{6342           temp= sum/a(j,j)}
\DoxyCodeLine{6343           \textcolor{keywordflow}{DO} i= j,m}
\DoxyCodeLine{6344            a(i,k)= a(i,k)-\/temp*a(i,j)}
\DoxyCodeLine{6345 \textcolor{keywordflow}{          ENDDO}}
\DoxyCodeLine{6346           \textcolor{keywordflow}{IF}(.NOT.(.NOT.pivot.OR.rdiag(k) == \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}})) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6347            temp= a(j,k)/rdiag(k)}
\DoxyCodeLine{6348            rdiag(k)= rdiag(k)*sqrt(max(\mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}},\mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}-\/temp**2))}
\DoxyCodeLine{6349            \textcolor{keywordflow}{IF}(p05*(rdiag(k)/wa(k))**2 <= epsmch) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6350             rdiag(k)= \mbox{\hyperlink{namespacehto__solve__nonlin_a52df74850a83808488fb1b90d7e539ed}{hto\_enorm}}(m-\/j,a(jp1:,k))}
\DoxyCodeLine{6351             wa(k)= rdiag(k)}
\DoxyCodeLine{6352 \textcolor{keywordflow}{           ENDIF}}
\DoxyCodeLine{6353 \textcolor{keywordflow}{          ENDIF}}
\DoxyCodeLine{6354 \textcolor{keywordflow}{         ENDDO}}
\DoxyCodeLine{6355 \textcolor{keywordflow}{        ENDIF}}
\DoxyCodeLine{6356 \textcolor{keywordflow}{       ENDIF}}
\DoxyCodeLine{6357        rdiag(j)= -\/ajnorm}
\DoxyCodeLine{6358 \textcolor{keywordflow}{      ENDDO}}
\DoxyCodeLine{6359 \textcolor{comment}{*}}
\DoxyCodeLine{6360       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{6361 \textcolor{comment}{*}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacehto__solve__nonlin_a89a4ef64a31dd4d201b9b6bb3c077ab1}\label{namespacehto__solve__nonlin_a89a4ef64a31dd4d201b9b6bb3c077ab1}} 
\index{hto\_solve\_nonlin@{hto\_solve\_nonlin}!hto\_r1mpyq@{hto\_r1mpyq}}
\index{hto\_r1mpyq@{hto\_r1mpyq}!hto\_solve\_nonlin@{hto\_solve\_nonlin}}
\doxysubsubsection{\texorpdfstring{hto\_r1mpyq()}{hto\_r1mpyq()}}
{\footnotesize\ttfamily subroutine hto\+\_\+solve\+\_\+nonlin\+::hto\+\_\+r1mpyq (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{m,  }\item[{integer, intent(in)}]{n,  }\item[{real$\ast$8, dimension(lda,n), intent(inout)}]{a,  }\item[{integer, intent(in)}]{lda,  }\item[{real$\ast$8, dimension(n), intent(in)}]{v,  }\item[{real$\ast$8, dimension(n), intent(in)}]{w }\end{DoxyParamCaption})}



Definition at line 6367 of file C\+A\+L\+L\+I\+N\+G\+\_\+cp\+H\+T\+O.\+f.


\begin{DoxyCode}{0}
\DoxyCodeLine{6367 \textcolor{comment}{*}}
\DoxyCodeLine{6368       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: m}
\DoxyCodeLine{6369       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: n}
\DoxyCodeLine{6370       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: lda}
\DoxyCodeLine{6371       real*8, \textcolor{keywordtype}{INTENT(IN OUT)}  :: a(lda,n)}
\DoxyCodeLine{6372       real*8, \textcolor{keywordtype}{INTENT(IN)}      :: v(n)}
\DoxyCodeLine{6373       real*8, \textcolor{keywordtype}{INTENT(IN)}      :: w(n)}
\DoxyCodeLine{6374 }
\DoxyCodeLine{6375 \textcolor{comment}{!   **********}}
\DoxyCodeLine{6376 }
\DoxyCodeLine{6377 \textcolor{comment}{!   SUBROUTINE HTO\_R1MPYQ}}
\DoxyCodeLine{6378 }
\DoxyCodeLine{6379 \textcolor{comment}{!   GIVEN AN M BY N MATRIX A, THIS SUBROUTINE HTO\_COMPUTES A*Q WHERE}}
\DoxyCodeLine{6380 \textcolor{comment}{!   Q IS THE PRODUCT OF 2*(N -\/ 1) TRANSFORMATIONS}}
\DoxyCodeLine{6381 }
\DoxyCodeLine{6382 \textcolor{comment}{!         GV(N-\/1)*...*GV(1)*GW(1)*...*GW(N-\/1)}}
\DoxyCodeLine{6383 }
\DoxyCodeLine{6384 \textcolor{comment}{!   AND GV(I), GW(I) ARE GIVENS ROTATIONS IN THE (I,N) PLANE WHICH}}
\DoxyCodeLine{6385 \textcolor{comment}{!   ELIMINATE ELEMENTS IN THE I-\/TH AND N-\/TH PLANES, RESPECTIVELY.}}
\DoxyCodeLine{6386 \textcolor{comment}{!   Q ITSELF IS NOT GIVEN, RATHER THE INFORMATION TO RECOVER THE}}
\DoxyCodeLine{6387 \textcolor{comment}{!   GV, GW ROTATIONS IS SUPPLIED.}}
\DoxyCodeLine{6388 }
\DoxyCodeLine{6389 \textcolor{comment}{!   THE SUBROUTINE HTO\_STATEMENT IS}}
\DoxyCodeLine{6390 }
\DoxyCodeLine{6391 \textcolor{comment}{!     SUBROUTINE HTO\_R1MPYQ(M, N, A, LDA, V, W)}}
\DoxyCodeLine{6392 }
\DoxyCodeLine{6393 \textcolor{comment}{!   WHERE}}
\DoxyCodeLine{6394 }
\DoxyCodeLine{6395 \textcolor{comment}{!     M IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER OF ROWS OF A.}}
\DoxyCodeLine{6396 }
\DoxyCodeLine{6397 \textcolor{comment}{!     N IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER OF COLUMNS OF A.}}
\DoxyCodeLine{6398 }
\DoxyCodeLine{6399 \textcolor{comment}{!     A IS AN M BY N ARRAY.  ON INPUT A MUST CONTAIN THE MATRIX TO BE}}
\DoxyCodeLine{6400 \textcolor{comment}{!       POSTMULTIPLIED BY THE ORTHOGONAL MATRIX Q DESCRIBED ABOVE.}}
\DoxyCodeLine{6401 \textcolor{comment}{!       ON OUTPUT A*Q HAS REPLACED A.}}
\DoxyCodeLine{6402 }
\DoxyCodeLine{6403 \textcolor{comment}{!     LDA IS A POSITIVE INTEGER INPUT VARIABLE NOT LESS THAN M}}
\DoxyCodeLine{6404 \textcolor{comment}{!       WHICH SPECIFIES THE LEADING DIMENSION OF THE ARRAY A.}}
\DoxyCodeLine{6405 }
\DoxyCodeLine{6406 \textcolor{comment}{!     V IS AN INPUT ARRAY OF LENGTH N. V(I) MUST CONTAIN THE INFORMATION}}
\DoxyCodeLine{6407 \textcolor{comment}{!       NECESSARY TO RECOVER THE GIVENS ROTATION GV(I) DESCRIBED ABOVE.}}
\DoxyCodeLine{6408 }
\DoxyCodeLine{6409 \textcolor{comment}{!     W IS AN INPUT ARRAY OF LENGTH N. W(I) MUST CONTAIN THE INFORMATION}}
\DoxyCodeLine{6410 \textcolor{comment}{!       NECESSARY TO RECOVER THE GIVENS ROTATION GW(I) DESCRIBED ABOVE.}}
\DoxyCodeLine{6411 }
\DoxyCodeLine{6412 \textcolor{comment}{!   SUBROUTINES CALLED}}
\DoxyCodeLine{6413 }
\DoxyCodeLine{6414 \textcolor{comment}{!     FORTRAN-\/SUPPLIED ... ABS, SQRT}}
\DoxyCodeLine{6415 }
\DoxyCodeLine{6416 \textcolor{comment}{!   ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.}}
\DoxyCodeLine{6417 \textcolor{comment}{!   BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE}}
\DoxyCodeLine{6418 }
\DoxyCodeLine{6419 \textcolor{comment}{!   **********}}
\DoxyCodeLine{6420       }
\DoxyCodeLine{6421       \textcolor{keywordtype}{INTEGER}    :: i,j,nmj,nm1}
\DoxyCodeLine{6422       real*8  :: cos,sin,temp}
\DoxyCodeLine{6423       real*8, \textcolor{keywordtype}{PARAMETER}  :: \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}= 1.0d0}
\DoxyCodeLine{6424 \textcolor{comment}{*}}
\DoxyCodeLine{6425       nm1= n-\/1}
\DoxyCodeLine{6426       \textcolor{keywordflow}{IF}(nm1 >= 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6427        \textcolor{keywordflow}{DO} nmj= 1,nm1}
\DoxyCodeLine{6428         j= n-\/nmj}
\DoxyCodeLine{6429         \textcolor{keywordflow}{IF}(abs(v(j)) > \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}) cos= \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}/v(j)}
\DoxyCodeLine{6430         \textcolor{keywordflow}{IF}(abs(v(j)) > \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}) sin= sqrt(\mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}-\/cos**2)}
\DoxyCodeLine{6431         \textcolor{keywordflow}{IF}(abs(v(j)) <= \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}) sin= v(j)}
\DoxyCodeLine{6432         \textcolor{keywordflow}{IF}(abs(v(j)) <= \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}) cos= sqrt(\mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}-\/sin**2)}
\DoxyCodeLine{6433         \textcolor{keywordflow}{DO} i= 1,m}
\DoxyCodeLine{6434          temp= cos*a(i,j)-\/sin*a(i,n)}
\DoxyCodeLine{6435          a(i,n)= sin*a(i,j)+cos*a(i,n)}
\DoxyCodeLine{6436          a(i,j)= temp}
\DoxyCodeLine{6437 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{6438 \textcolor{keywordflow}{       ENDDO}}
\DoxyCodeLine{6439        \textcolor{keywordflow}{DO} j= 1,nm1}
\DoxyCodeLine{6440         \textcolor{keywordflow}{IF}(abs(w(j)) > \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}) cos= \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}/w(j)}
\DoxyCodeLine{6441         \textcolor{keywordflow}{IF}(abs(w(j)) > \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}) sin= sqrt(\mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}-\/cos**2)}
\DoxyCodeLine{6442         \textcolor{keywordflow}{IF}(abs(w(j)) <= \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}) sin= w(j)}
\DoxyCodeLine{6443         \textcolor{keywordflow}{IF}(abs(w(j)) <= \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}) cos= sqrt(\mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}-\/sin**2)}
\DoxyCodeLine{6444         \textcolor{keywordflow}{DO} i= 1,m}
\DoxyCodeLine{6445          temp= cos*a(i,j)+sin*a(i,n)}
\DoxyCodeLine{6446          a(i,n)= -\/sin*a(i,j)+cos*a(i,n)}
\DoxyCodeLine{6447          a(i,j)= temp}
\DoxyCodeLine{6448 \textcolor{keywordflow}{        ENDDO}}
\DoxyCodeLine{6449 \textcolor{keywordflow}{       ENDDO}}
\DoxyCodeLine{6450 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{6451 \textcolor{comment}{*}}
\DoxyCodeLine{6452       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{6453 \textcolor{comment}{*}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacehto__solve__nonlin_af73d8384fe07fde7b063afc452466f03}\label{namespacehto__solve__nonlin_af73d8384fe07fde7b063afc452466f03}} 
\index{hto\_solve\_nonlin@{hto\_solve\_nonlin}!hto\_r1updt@{hto\_r1updt}}
\index{hto\_r1updt@{hto\_r1updt}!hto\_solve\_nonlin@{hto\_solve\_nonlin}}
\doxysubsubsection{\texorpdfstring{hto\_r1updt()}{hto\_r1updt()}}
{\footnotesize\ttfamily subroutine hto\+\_\+solve\+\_\+nonlin\+::hto\+\_\+r1updt (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{m,  }\item[{integer, intent(in)}]{n,  }\item[{real$\ast$8, dimension(ls), intent(inout)}]{s,  }\item[{integer, intent(in)}]{ls,  }\item[{real$\ast$8, dimension(m), intent(in)}]{u,  }\item[{real$\ast$8, dimension(n), intent(inout)}]{v,  }\item[{real$\ast$8, dimension(m), intent(out)}]{w,  }\item[{logical, intent(out)}]{sing }\end{DoxyParamCaption})}



Definition at line 6459 of file C\+A\+L\+L\+I\+N\+G\+\_\+cp\+H\+T\+O.\+f.


\begin{DoxyCode}{0}
\DoxyCodeLine{6459 \textcolor{comment}{*}}
\DoxyCodeLine{6460       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: m}
\DoxyCodeLine{6461       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: n}
\DoxyCodeLine{6462       \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)}        :: ls}
\DoxyCodeLine{6463       real*8, \textcolor{keywordtype}{INTENT(IN OUT)}  :: s(ls)}
\DoxyCodeLine{6464       real*8, \textcolor{keywordtype}{INTENT(IN)}      :: u(m)}
\DoxyCodeLine{6465       real*8, \textcolor{keywordtype}{INTENT(IN OUT)}  :: v(n)}
\DoxyCodeLine{6466       real*8, \textcolor{keywordtype}{INTENT(OUT)}     :: w(m)}
\DoxyCodeLine{6467       \textcolor{keywordtype}{LOGICAL}, \textcolor{keywordtype}{INTENT(OUT)}       :: sing}
\DoxyCodeLine{6468 }
\DoxyCodeLine{6469 \textcolor{comment}{!   **********}}
\DoxyCodeLine{6470 }
\DoxyCodeLine{6471 \textcolor{comment}{!   SUBROUTINE HTO\_R1UPDT}}
\DoxyCodeLine{6472 }
\DoxyCodeLine{6473 \textcolor{comment}{!   GIVEN AN M BY N LOWER TRAPEZOIDAL MATRIX S, AN M-\/VECTOR U,}}
\DoxyCodeLine{6474 \textcolor{comment}{!   AND AN N-\/VECTOR V, THE PROBLEM IS TO DETERMINE AN}}
\DoxyCodeLine{6475 \textcolor{comment}{!   ORTHOGONAL MATRIX Q SUCH THAT}}
\DoxyCodeLine{6476 }
\DoxyCodeLine{6477 \textcolor{comment}{!                 T}}
\DoxyCodeLine{6478 \textcolor{comment}{!         (S + U*V )*Q}}
\DoxyCodeLine{6479 }
\DoxyCodeLine{6480 \textcolor{comment}{!   IS AGAIN LOWER TRAPEZOIDAL.}}
\DoxyCodeLine{6481 }
\DoxyCodeLine{6482 \textcolor{comment}{!   THIS SUBROUTINE HTO\_DETERMINES Q AS THE PRODUCT OF 2*(N -\/ 1) TRANSFORMATIONS}}
\DoxyCodeLine{6483 }
\DoxyCodeLine{6484 \textcolor{comment}{!         GV(N-\/1)*...*GV(1)*GW(1)*...*GW(N-\/1)}}
\DoxyCodeLine{6485 }
\DoxyCodeLine{6486 \textcolor{comment}{!   WHERE GV(I), GW(I) ARE GIVENS ROTATIONS IN THE (I,N) PLANE}}
\DoxyCodeLine{6487 \textcolor{comment}{!   WHICH ELIMINATE ELEMENTS IN THE I-\/TH AND N-\/TH PLANES, RESPECTIVELY.}}
\DoxyCodeLine{6488 \textcolor{comment}{!   Q ITSELF IS NOT ACCUMULATED, RATHER THE INFORMATION TO RECOVER THE GV,}}
\DoxyCodeLine{6489 \textcolor{comment}{!   GW ROTATIONS IS RETURNED.}}
\DoxyCodeLine{6490 }
\DoxyCodeLine{6491 \textcolor{comment}{!   THE SUBROUTINE HTO\_STATEMENT IS}}
\DoxyCodeLine{6492 }
\DoxyCodeLine{6493 \textcolor{comment}{!     SUBROUTINE HTO\_R1UPDT(M,N,S,LS,U,V,W,SING)}}
\DoxyCodeLine{6494 }
\DoxyCodeLine{6495 \textcolor{comment}{!   WHERE}}
\DoxyCodeLine{6496 }
\DoxyCodeLine{6497 \textcolor{comment}{!     M IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER OF ROWS OF S.}}
\DoxyCodeLine{6498 }
\DoxyCodeLine{6499 \textcolor{comment}{!     N IS A POSITIVE INTEGER INPUT VARIABLE SET TO THE NUMBER}}
\DoxyCodeLine{6500 \textcolor{comment}{!       OF COLUMNS OF S.  N MUST NOT EXCEED M.}}
\DoxyCodeLine{6501 }
\DoxyCodeLine{6502 \textcolor{comment}{!     S IS AN ARRAY OF LENGTH LS. ON INPUT S MUST CONTAIN THE LOWER}}
\DoxyCodeLine{6503 \textcolor{comment}{!       TRAPEZOIDAL MATRIX S STORED BY COLUMNS. ON OUTPUT S CONTAINS}}
\DoxyCodeLine{6504 \textcolor{comment}{!       THE LOWER TRAPEZOIDAL MATRIX PRODUCED AS DESCRIBED ABOVE.}}
\DoxyCodeLine{6505 }
\DoxyCodeLine{6506 \textcolor{comment}{!     LS IS A POSITIVE INTEGER INPUT VARIABLE NOT LESS THAN}}
\DoxyCodeLine{6507 \textcolor{comment}{!       (N*(2*M-\/N+1))/2.}}
\DoxyCodeLine{6508 }
\DoxyCodeLine{6509 \textcolor{comment}{!     U IS AN INPUT ARRAY OF LENGTH M WHICH MUST CONTAIN THE VECTOR U.}}
\DoxyCodeLine{6510 }
\DoxyCodeLine{6511 \textcolor{comment}{!     V IS AN ARRAY OF LENGTH N. ON INPUT V MUST CONTAIN THE VECTOR V.}}
\DoxyCodeLine{6512 \textcolor{comment}{!       ON OUTPUT V(I) CONTAINS THE INFORMATION NECESSARY TO}}
\DoxyCodeLine{6513 \textcolor{comment}{!       RECOVER THE GIVENS ROTATION GV(I) DESCRIBED ABOVE.}}
\DoxyCodeLine{6514 }
\DoxyCodeLine{6515 \textcolor{comment}{!     W IS AN OUTPUT ARRAY OF LENGTH M. W(I) CONTAINS INFORMATION}}
\DoxyCodeLine{6516 \textcolor{comment}{!       NECESSARY TO RECOVER THE GIVENS ROTATION GW(I) DESCRIBED ABOVE.}}
\DoxyCodeLine{6517 }
\DoxyCodeLine{6518 \textcolor{comment}{!     SING IS A LOGICAL OUTPUT VARIABLE.  SING IS SET TRUE IF ANY OF THE}}
\DoxyCodeLine{6519 \textcolor{comment}{!       DIAGONAL ELEMENTS OF THE OUTPUT S ARE ZERO.  OTHERWISE SING IS}}
\DoxyCodeLine{6520 \textcolor{comment}{!       SET FALSE.}}
\DoxyCodeLine{6521 }
\DoxyCodeLine{6522 \textcolor{comment}{!   SUBPROGRAMS CALLED}}
\DoxyCodeLine{6523 }
\DoxyCodeLine{6524 \textcolor{comment}{!     MINPACK-\/SUPPLIED ... SPMPAR}}
\DoxyCodeLine{6525 }
\DoxyCodeLine{6526 \textcolor{comment}{!     FORTRAN-\/SUPPLIED ... ABS,SQRT}}
\DoxyCodeLine{6527 }
\DoxyCodeLine{6528 \textcolor{comment}{!   ARGONNE NATIONAL LABORATORY. MINPACK PROJECT. MARCH 1980.}}
\DoxyCodeLine{6529 \textcolor{comment}{!   BURTON S. GARBOW, KENNETH E. HILLSTROM, JORGE J. MORE, JOHN L. NAZARETH}}
\DoxyCodeLine{6530 }
\DoxyCodeLine{6531 \textcolor{comment}{!   **********}}
\DoxyCodeLine{6532 }
\DoxyCodeLine{6533       \textcolor{keywordtype}{INTEGER}    :: i,j,jj,l,nmj,nm1}
\DoxyCodeLine{6534       real*8  :: cos,cotan,giant,sin,tan,tau,temp}
\DoxyCodeLine{6535       real*8, \textcolor{keywordtype}{PARAMETER}  :: \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}= 1.0d0,p5= 0.5d0,p25= 0.25d0,\mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}= 0.0d0}
\DoxyCodeLine{6536 \textcolor{comment}{*}}
\DoxyCodeLine{6537       giant= huge(1.0d0)}
\DoxyCodeLine{6538       jj= (n*(2*m-\/n+1))/2-\/(m-\/n)}
\DoxyCodeLine{6539       l= jj}
\DoxyCodeLine{6540       \textcolor{keywordflow}{DO} i= n,m}
\DoxyCodeLine{6541        w(i)= s(l)}
\DoxyCodeLine{6542        l= l+1}
\DoxyCodeLine{6543 \textcolor{keywordflow}{      ENDDO}}
\DoxyCodeLine{6544       nm1= n-\/1}
\DoxyCodeLine{6545       \textcolor{keywordflow}{IF}(nm1 >= 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6546        \textcolor{keywordflow}{DO} nmj= 1,nm1}
\DoxyCodeLine{6547         j= n-\/nmj}
\DoxyCodeLine{6548         jj= jj-\/(m-\/j+1)}
\DoxyCodeLine{6549         w(j)= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}}
\DoxyCodeLine{6550         \textcolor{keywordflow}{IF}(v(j) /= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6551          \textcolor{keywordflow}{IF}(abs(v(n)) < abs(v(j))) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6552           cotan= v(n)/v(j)}
\DoxyCodeLine{6553           sin= p5/sqrt(p25+p25*cotan**2)}
\DoxyCodeLine{6554           cos= sin*cotan}
\DoxyCodeLine{6555           tau= \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}}
\DoxyCodeLine{6556           \textcolor{keywordflow}{IF}(abs(cos)*giant > \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}) tau= \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}/cos}
\DoxyCodeLine{6557          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{6558           tan= v(j)/v(n)}
\DoxyCodeLine{6559           cos= p5/sqrt(p25+p25*tan**2)}
\DoxyCodeLine{6560           sin= cos*tan}
\DoxyCodeLine{6561           tau= sin}
\DoxyCodeLine{6562 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{6563          v(n)= sin*v(j)+cos*v(n)}
\DoxyCodeLine{6564          v(j)= tau}
\DoxyCodeLine{6565          l= jj}
\DoxyCodeLine{6566          \textcolor{keywordflow}{DO} i= j,m}
\DoxyCodeLine{6567           temp= cos*s(l)-\/sin*w(i)}
\DoxyCodeLine{6568           w(i)= sin*s(l)+cos*w(i)}
\DoxyCodeLine{6569           s(l)= temp}
\DoxyCodeLine{6570           l= l+1}
\DoxyCodeLine{6571 \textcolor{keywordflow}{         ENDDO}}
\DoxyCodeLine{6572 \textcolor{keywordflow}{        ENDIF}}
\DoxyCodeLine{6573 \textcolor{keywordflow}{       ENDDO}}
\DoxyCodeLine{6574 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{6575       \textcolor{keywordflow}{DO} i= 1,m}
\DoxyCodeLine{6576        w(i)= w(i)+v(n)*u(i)}
\DoxyCodeLine{6577 \textcolor{keywordflow}{      ENDDO}}
\DoxyCodeLine{6578       sing= .false.}
\DoxyCodeLine{6579       \textcolor{keywordflow}{IF}(nm1 >= 1) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6580        \textcolor{keywordflow}{DO} j= 1,nm1}
\DoxyCodeLine{6581         \textcolor{keywordflow}{IF}(w(j) /= \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6582          \textcolor{keywordflow}{IF}(abs(s(jj)) < abs(w(j))) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{6583           cotan= s(jj)/w(j)}
\DoxyCodeLine{6584           sin= p5/sqrt(p25+p25*cotan**2)}
\DoxyCodeLine{6585           cos= sin*cotan}
\DoxyCodeLine{6586           tau= \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}}
\DoxyCodeLine{6587           \textcolor{keywordflow}{IF}(abs(cos)*giant > \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}) tau= \mbox{\hyperlink{namespacehto__units_adb7ab93d326f14720c354f68b0f7ee6c}{one}}/cos}
\DoxyCodeLine{6588          \textcolor{keywordflow}{ELSE}}
\DoxyCodeLine{6589           tan= w(j)/s(jj)}
\DoxyCodeLine{6590           cos= p5/sqrt(p25+p25*tan**2)}
\DoxyCodeLine{6591           sin= cos*tan}
\DoxyCodeLine{6592           tau= sin}
\DoxyCodeLine{6593 \textcolor{keywordflow}{         ENDIF}}
\DoxyCodeLine{6594          l= jj}
\DoxyCodeLine{6595          \textcolor{keywordflow}{DO} i= j,m}
\DoxyCodeLine{6596           temp= cos*s(l)+sin*w(i)}
\DoxyCodeLine{6597           w(i)= -\/sin*s(l)+cos*w(i)}
\DoxyCodeLine{6598           s(l)= temp}
\DoxyCodeLine{6599           l= l+1}
\DoxyCodeLine{6600 \textcolor{keywordflow}{         ENDDO}}
\DoxyCodeLine{6601          w(j)= tau}
\DoxyCodeLine{6602 \textcolor{keywordflow}{        ENDIF}}
\DoxyCodeLine{6603         \textcolor{keywordflow}{IF}(s(jj) == \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) sing= .true.}
\DoxyCodeLine{6604         jj= jj+(m-\/j+1)}
\DoxyCodeLine{6605 \textcolor{keywordflow}{       ENDDO}}
\DoxyCodeLine{6606 \textcolor{keywordflow}{      ENDIF}}
\DoxyCodeLine{6607       l= jj}
\DoxyCodeLine{6608       \textcolor{keywordflow}{DO} i= n,m}
\DoxyCodeLine{6609        s(l)= w(i)}
\DoxyCodeLine{6610        l= l+1}
\DoxyCodeLine{6611 \textcolor{keywordflow}{      ENDDO}}
\DoxyCodeLine{6612       \textcolor{keywordflow}{IF}(s(jj) == \mbox{\hyperlink{namespacehto__units_a99185641f2fef22fbd699ff69ee64f18}{zero}}) sing= .true.}
\DoxyCodeLine{6613 \textcolor{comment}{*}}
\DoxyCodeLine{6614       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{6615 \textcolor{comment}{*}}

\end{DoxyCode}
