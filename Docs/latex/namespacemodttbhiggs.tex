\hypertarget{namespacemodttbhiggs}{}\doxysection{modttbhiggs Module Reference}
\label{namespacemodttbhiggs}\index{modttbhiggs@{modttbhiggs}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfacemodttbhiggs_1_1operator_07_8ndot_8_08}{operator(.\+ndot.)}}
\item 
type \mbox{\hyperlink{structmodttbhiggs_1_1particle}{particle}}
\item 
type \mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}
\item 
type \mbox{\hyperlink{structmodttbhiggs_1_1treeprocess}{treeprocess}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public \mbox{\hyperlink{namespacemodttbhiggs_a02a58de06c7a82420c58721567c36927}{evalxsec\+\_\+pp\+\_\+ttbh}} (Mom, Select\+Process, Res)
\item 
subroutine, public \mbox{\hyperlink{namespacemodttbhiggs_a65e3275546f4df87be8563957d0d2907}{evalxsec\+\_\+pp\+\_\+bbbh}} (Mom, Select\+Process, Res)
\item 
subroutine, public \mbox{\hyperlink{namespacemodttbhiggs_a5c94ac5f8e9e04d9c6b3950545a44d48}{initprocess\+\_\+ttbh}} ()
\item 
subroutine, public \mbox{\hyperlink{namespacemodttbhiggs_a40d35869f3706c38d358332860891b9c}{exitprocess\+\_\+ttbh}} ()
\item 
subroutine, public \mbox{\hyperlink{namespacemodttbhiggs_aa7190026459c187d5653d724aac7ffe4}{evalamp\+\_\+gg\+\_\+ttbh}} (Mom, Sq\+Amp)
\item 
subroutine, public \mbox{\hyperlink{namespacemodttbhiggs_addb2d779063d5155da736dd7ed41d091}{evalamp\+\_\+qqb\+\_\+ttbh}} (Mom, Sq\+Amp)
\item 
subroutine \mbox{\hyperlink{namespacemodttbhiggs_a982192d11209498ce988df66d10a8c0e}{new\+\_\+calc\+\_\+ampl}} (tag\+\_\+f, tag\+\_\+Z, Tree\+Proc, Res)
\item 
subroutine \mbox{\hyperlink{namespacemodttbhiggs_a593e2b56b0306035b7527938b164e4ee}{linktreeparticles}} (The\+Tree\+Amp, The\+Particles)
\item 
complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}}) \mbox{\hyperlink{namespacemodttbhiggs_a1600f3895fd4d0e6828f9a3a3f63ee1d}{cur\+\_\+f\+\_\+2fv}} (Gluons, Quark, Quark1\+Part\+Type, Boson, Num\+Glu)
\item 
recursive complex(8) function, dimension(size(sp)) \mbox{\hyperlink{namespacemodttbhiggs_a34ef86c930ffb557abd146d64486e7ae}{fv}} (e, k, sp, p, mass, Quark\+Flavor, eV, kV, ms)
\item 
recursive complex(8) function, dimension(size(sp)) \mbox{\hyperlink{namespacemodttbhiggs_a6cf6e9462f72b415424686a3de71ac61}{bfv}} (e, k, sp, p, mass, Quark\+Flavor, eV, kV, ms)
\item 
complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}}) \mbox{\hyperlink{namespacemodttbhiggs_abc69cbe148d81013745b94be70548d62}{cur\+\_\+f\+\_\+4fv}} (Gluons, Quarks, Quark1\+Part\+Type, Boson, Boson\+Vertex, Num\+Glu, tag\+\_\+f, tag\+\_\+Z)
\item 
complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}}) \mbox{\hyperlink{namespacemodttbhiggs_a2b50d80982627a5e499fe2c4eec44c88}{cur\+\_\+f\+\_\+4f}} (Gluons, Quarks, Quark1\+Part\+Type, Num\+Glu, tag\+\_\+f, tag\+\_\+\+Z\+\_\+arg)
\item 
recursive complex(8) function, dimension(size(e, dim=1)) \mbox{\hyperlink{namespacemodttbhiggs_a235b60cc7641638d472db6f260b76d34}{g}} (e, k)
\item 
complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}) \mbox{\hyperlink{namespacemodttbhiggs_a0dc774774e5e2448b8831066fb707b53}{cur\+\_\+g}} (Gluons, Num\+Glu)
\item 
recursive complex(8) function, dimension(size(sp)) \mbox{\hyperlink{namespacemodttbhiggs_adad982f9354a9487600f7cc5dbc4123c}{f}} (e, k, sp, p, mass, flout, flin, ms)
\item 
recursive complex(8) function, dimension(size(sp)) \mbox{\hyperlink{namespacemodttbhiggs_a41f4ae90288c5e36dad4f4634dd93c40}{bf}} (e, k, sp, p, mass, flout, flin, ms)
\item 
complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}) \mbox{\hyperlink{namespacemodttbhiggs_ac2974da70d23237fa04bb606cce64e0d}{cur\+\_\+g\+\_\+2f}} (Gluons, Quarks, Num\+Glu)
\item 
complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}) \mbox{\hyperlink{namespacemodttbhiggs_a10392cd5645a49f21e9eedfe34cff22a}{cur\+\_\+g\+\_\+2fv}} (Gluons, Quarks, Boson, Num\+Glu)
\item 
complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}}) \mbox{\hyperlink{namespacemodttbhiggs_a60f6b75e3113bbfd04d46ef7f3e8ae2c}{cur\+\_\+f\+\_\+2f}} (Gluons, Quarks, Quark1\+Part\+Type, Num\+Glu)
\item 
complex(8) function, dimension(\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}) \mbox{\hyperlink{namespacemodttbhiggs_a82bea00e16ce7c2b885be798bb71bd76}{cur\+\_\+g\+\_\+4f}} (Gluons, Quarks, Num\+Glu)
\item 
complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}}) \mbox{\hyperlink{namespacemodttbhiggs_ae785e0d6b1486d410b4df20499e9f48f}{cur\+\_\+f\+\_\+6f}} (Gluons, Quarks, Quark1\+Part\+Type, Num\+Glu, tag\+\_\+f, tag\+\_\+Z)
\item 
complex(8) function, dimension(\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}) \mbox{\hyperlink{namespacemodttbhiggs_a94a94906ea77f211ca50b80310f0da1c}{cur\+\_\+g\+\_\+4fv}} (Gluons, Quarks, Boson, Boson\+Vertex, Num\+Glu)
\item 
complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}}) \mbox{\hyperlink{namespacemodttbhiggs_adf47ca461bff280d07ab94c06f982305}{cur\+\_\+f\+\_\+6fv}} (Gluons, Quarks, Quark1\+Part\+Type, Boson, Boson\+Vertex, Num\+Glu, tag\+\_\+f)
\item 
complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}) \mbox{\hyperlink{namespacemodttbhiggs_a0b1723a80e27200260bd362a8ac62788}{summom}} (Particles, i1, i2)
\item 
complex(8) function \mbox{\hyperlink{namespacemodttbhiggs_aaa7b206d44682122266c543abc74fd1f}{fourvecdot}} (p1, p2)
\item 
complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}) \mbox{\hyperlink{namespacemodttbhiggs_a288ffcd69e7511bab4de892ff5b4972c}{eval\+\_\+tripvert}} (k1, k2, v1, v2)
\item 
complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}) \mbox{\hyperlink{namespacemodttbhiggs_afca1d82cc226d765fdffe455835ca6d5}{eval\+\_\+quadvert}} (k1, k2, k3)
\item 
integer function \mbox{\hyperlink{namespacemodttbhiggs_a16ddc269abb6f66df5607491a89ecc65}{linear\+\_\+map}} (i1, i2, Ngluons)
\item 
subroutine \mbox{\hyperlink{namespacemodttbhiggs_aee7a049ddac0cf1681dffd71093a36cf}{copyparticleptr}} (In\+Pointer, Out\+Pointer)
\item 
subroutine \mbox{\hyperlink{namespacemodttbhiggs_aabd6b0430e2766e11b744504ae344a72}{spi2}} (Dv, Ds, v, sp, \mbox{\hyperlink{namespacemodttbhiggs_adad982f9354a9487600f7cc5dbc4123c}{f}})
\item 
double complex function, dimension(size(sp)) \mbox{\hyperlink{namespacemodttbhiggs_a5ad23d4a036af583552482ced325bf9b}{spi2\+\_\+}} (v, sp)
\item 
double complex function, dimension(size(sp)) \mbox{\hyperlink{namespacemodttbhiggs_ad5dba1690a2142af045213493a451f7a}{spivl}} (sp, v)
\item 
subroutine \mbox{\hyperlink{namespacemodttbhiggs_a299bd2c18d43760781811270fe270da4}{spb2}} (Dv, Ds, sp, v, \mbox{\hyperlink{namespacemodttbhiggs_adad982f9354a9487600f7cc5dbc4123c}{f}})
\item 
double complex function, dimension(size(sp)) \mbox{\hyperlink{namespacemodttbhiggs_a9a1c65c401f7769cf3b25ee32dd38947}{spb2\+\_\+}} (sp, v)
\item 
complex(8) function \mbox{\hyperlink{namespacemodttbhiggs_a7b29e228d381ca9e221522f8c42bbb98}{psp1\+\_\+}} (sp1, sp2)
\item 
recursive double complex function, dimension(size(sp)) \mbox{\hyperlink{namespacemodttbhiggs_a6ff336a409158adea0b84ed7c7b00ec8}{chir}} (sign, sp)
\item 
recursive double complex function, dimension(size(sp)) \mbox{\hyperlink{namespacemodttbhiggs_a691b8daf9b0359f845579cedad904110}{ichir}} (sign, sp)
\item 
complex(8) function, dimension(size(sp)) \mbox{\hyperlink{namespacemodttbhiggs_ae1b6e6df57b28d1e2182621e940e0844}{vbqv}} (sp, e1, coupl\+\_\+left, coupl\+\_\+right)
\item 
complex(8) function, dimension(size(sp)) \mbox{\hyperlink{namespacemodttbhiggs_a3d24c4cb137f694c79a6b2bf661197ed}{vvq}} (e1, sp, coupl\+\_\+left, coupl\+\_\+right)
\item 
complex(8) function \mbox{\hyperlink{namespacemodttbhiggs_acd313348e371d4b4ce20b49e13bd8150}{sc\+\_\+}} (p1, p2)
\item 
subroutine \mbox{\hyperlink{namespacemodttbhiggs_a99dfd6ee0756556121a9b1c6afc52438}{rsc\+\_\+}} (n, x, y, r)
\item 
complex(8) function, dimension(size(e1)) \mbox{\hyperlink{namespacemodttbhiggs_a48cd166d20e787937992441341647c89}{vggg}} (e1, k1, e2, k2)
\item 
complex(8) function, dimension(size(e1)) \mbox{\hyperlink{namespacemodttbhiggs_a2ce118a94d782b404e2b1a2ea351c712}{vgggg}} (e1, e2, e3)
\item 
complex(8) function, dimension(size(sp)) \mbox{\hyperlink{namespacemodttbhiggs_ac3c1479d53b579f46ac4c03fb2ecd0d2}{vqg}} (sp, e1)
\item 
complex(8) function, dimension(size(sp)) \mbox{\hyperlink{namespacemodttbhiggs_ac4f079809619d88cb2e1b6baeb3f7a6b}{vgq}} (e1, sp)
\item 
complex(8) function, dimension(size(sp)) \mbox{\hyperlink{namespacemodttbhiggs_a0b9541da43e68bf247f4df1f5815eb3b}{vbqg}} (sp, e1)
\item 
complex(8) function, dimension(size(sp)) \mbox{\hyperlink{namespacemodttbhiggs_aeca72a3609fdd110519e863051ae0f41}{vgbq}} (e1, sp)
\item 
complex(8) function, dimension(4) \mbox{\hyperlink{namespacemodttbhiggs_ac3051975f148046a7367290dcdb74ca0}{vbqq}} (Dummy, sp1, sp2)
\item 
complex(8) function, dimension(4, 4) \mbox{\hyperlink{namespacemodttbhiggs_a5b104066b13a69934a51cabea496a60d}{vvbqq}} (sp1, sp2)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer, parameter \mbox{\hyperlink{namespacemodttbhiggs_ac443a0bbcc3995d84eb7cebb785ded23}{colorlesstag}} = 1
\item 
real(8), parameter \mbox{\hyperlink{namespacemodttbhiggs_abbd7324dda04127446e49c1c30e969c2}{propcut}} = 1.\+0d-\/8
\item 
integer, parameter \mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}} =4
\item 
integer, parameter \mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}} =4
\item 
type(\mbox{\hyperlink{structmodttbhiggs_1_1particle}{particle}}), dimension(1\+:7), save \mbox{\hyperlink{namespacemodttbhiggs_ab922587e9b30199ee7eab7c5f37af3f0}{extparticles}}
\item 
type(\mbox{\hyperlink{structmodttbhiggs_1_1treeprocess}{treeprocess}}), dimension(1\+:2), save \mbox{\hyperlink{namespacemodttbhiggs_abca7fa4f7a865911adc4c444a6926295}{thetreeamps\+\_\+gg\+\_\+ttbh}}
\item 
type(\mbox{\hyperlink{structmodttbhiggs_1_1treeprocess}{treeprocess}}), dimension(1\+:1), save \mbox{\hyperlink{namespacemodttbhiggs_a1f8089d51466581a31c1b6b62e861282}{thetreeamps\+\_\+qqb\+\_\+ttbh}}
\item 
complex(8) \mbox{\hyperlink{namespacemodttbhiggs_a2f0eff3b1324eeeaf015ebcbd94e111b}{couplhtt\+\_\+right\+\_\+dyn}}
\item 
complex(8) \mbox{\hyperlink{namespacemodttbhiggs_a52094e1c2f161117f051ce4438845fc3}{couplhtt\+\_\+left\+\_\+dyn}}
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacemodttbhiggs_a41f4ae90288c5e36dad4f4634dd93c40}\label{namespacemodttbhiggs_a41f4ae90288c5e36dad4f4634dd93c40}} 
\index{modttbhiggs@{modttbhiggs}!bf@{bf}}
\index{bf@{bf}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{bf()}{bf()}}
{\footnotesize\ttfamily recursive complex(8) function, dimension(size(sp)) modttbhiggs\+::bf (\begin{DoxyParamCaption}\item[{complex(8), dimension(\+:,\+:), intent(in)}]{e,  }\item[{complex(8), dimension(\+:,\+:), intent(in)}]{k,  }\item[{complex(8), dimension(\+:), intent(in)}]{sp,  }\item[{complex(8), dimension(\+:), intent(in)}]{p,  }\item[{real(8)}]{mass,  }\item[{character, intent(in)}]{flout,  }\item[{character, intent(in)}]{flin,  }\item[{integer, intent(in)}]{ms }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1892 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1892       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1893       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: e(:,:), k(:,:)}
\DoxyCodeLine{1894       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: sp(:), p(:)}
\DoxyCodeLine{1895       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} ::  ms}
\DoxyCodeLine{1896       \textcolor{keywordtype}{character}, \textcolor{keywordtype}{intent(in)} :: flout*3  \textcolor{comment}{! flavor of on-\/shell f-\/line}}
\DoxyCodeLine{1897       \textcolor{keywordtype}{character}, \textcolor{keywordtype}{intent(in)} :: flin*3   \textcolor{comment}{! flavor of off-\/shell f-\/line}}
\DoxyCodeLine{1898       \textcolor{keywordtype}{integer}             :: ms1,m,ng1, ng2}
\DoxyCodeLine{1899       \textcolor{keywordtype}{integer} :: ngluon}
\DoxyCodeLine{1900       \textcolor{keywordtype}{complex(8)}             :: res(size(sp))}
\DoxyCodeLine{1901       \textcolor{keywordtype}{complex(8)}             :: tmp(size(sp))}
\DoxyCodeLine{1902       \textcolor{keywordtype}{complex(8)}             :: k1(size(p))}
\DoxyCodeLine{1903       \textcolor{keywordtype}{complex(8)}             :: k2(size(p))}
\DoxyCodeLine{1904       \textcolor{keywordtype}{complex(8)}             :: sp2(size(sp))}
\DoxyCodeLine{1905       \textcolor{keywordtype}{complex(8)}             :: sp3(size(sp))}
\DoxyCodeLine{1906       \textcolor{keywordtype}{complex(8)}             :: e1(size(e,dim=1))}
\DoxyCodeLine{1907       \textcolor{keywordtype}{complex(8)}             :: e2(size(e,dim=1))}
\DoxyCodeLine{1908       \textcolor{keywordtype}{complex(8)}  :: k1sq,k2sq,k3sq}
\DoxyCodeLine{1909 \textcolor{keywordtype}{      real}(8) :: mass}
\DoxyCodeLine{1910 }
\DoxyCodeLine{1911 }
\DoxyCodeLine{1912        \textcolor{keywordflow}{if} (flout.ne.flin) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1913           res = (0d0,0d0)}
\DoxyCodeLine{1914        \textcolor{keywordflow}{else}}
\DoxyCodeLine{1915 }
\DoxyCodeLine{1916        ngluon = \textcolor{keyword}{size}(e,dim=2)}
\DoxyCodeLine{1917       ng1 = ms   \textcolor{comment}{!\#gluons to the left of a f-\/line}}
\DoxyCodeLine{1918       ng2 = ngluon -\/ ms  \textcolor{comment}{!\#gluons to the right of the f-\/line}}
\DoxyCodeLine{1919 }
\DoxyCodeLine{1920       \textcolor{keywordflow}{if} (ng2 < 0) \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'WRONG DEFINITION OF CURRENT B'}}
\DoxyCodeLine{1921       \textcolor{keywordflow}{if} (ngluon == 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1922          res = sp}
\DoxyCodeLine{1923       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1924 }
\DoxyCodeLine{1925        res = (0d0,0d0)}
\DoxyCodeLine{1926        \textcolor{keywordflow}{do} m=0,ng2-\/1}
\DoxyCodeLine{1927            k1 = sum(k(:,ng1+1+m:ngluon),dim=2)}
\DoxyCodeLine{1928            e1=g(e(:,ng1+1+m:ngluon),k(:,ng1+1+m:ngluon))}
\DoxyCodeLine{1929            k1sq=sc\_(k1,k1)}
\DoxyCodeLine{1930 }
\DoxyCodeLine{1931            k2 = sum(k(:,1:ng1+m),dim=2)}
\DoxyCodeLine{1932            k2 = -\/k2 -\/ p}
\DoxyCodeLine{1933            k2sq = sc\_(k2,k2)-\/mass**2}
\DoxyCodeLine{1934            sp2 = bf(e(:,1:ng1+m),k(:,1:ng1+m),sp,p,mass,flout,flin,ng1)}
\DoxyCodeLine{1935            \textcolor{keywordflow}{if} (ng1>0.or.m>0) sp2 = spi2\_(k2,sp2)+mass*sp2}
\DoxyCodeLine{1936 }
\DoxyCodeLine{1937             tmp = vbqg(sp2,e1)}
\DoxyCodeLine{1938 }
\DoxyCodeLine{1939            \textcolor{keywordflow}{if} (m < ng2-\/1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1940             \textcolor{keywordflow}{if} (abs(k1sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1941            tmp = -\/(0d0,1d0)/k1sq*tmp}
\DoxyCodeLine{1942             \textcolor{keywordflow}{else}}
\DoxyCodeLine{1943            tmp = (0d0,0d0)}
\DoxyCodeLine{1944 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{1945 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{1946            \textcolor{keywordflow}{if} (ng1>0.or.m>0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1947             \textcolor{keywordflow}{if} (abs(k2sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1948            tmp =  (0d0,1d0)/k2sq*tmp}
\DoxyCodeLine{1949             \textcolor{keywordflow}{else}}
\DoxyCodeLine{1950             tmp = (0d0,0d0)}
\DoxyCodeLine{1951 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{1952 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{1953 }
\DoxyCodeLine{1954            res = res + tmp}
\DoxyCodeLine{1955 }
\DoxyCodeLine{1956 }
\DoxyCodeLine{1957 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{1958 }
\DoxyCodeLine{1959 }
\DoxyCodeLine{1960         \textcolor{keywordflow}{do} m=1,ng1}
\DoxyCodeLine{1961 }
\DoxyCodeLine{1962            k1 = sum(k(:,1:m),dim=2)}
\DoxyCodeLine{1963            e1=g(e(:,1:m),k(:,1:m))}
\DoxyCodeLine{1964            k1sq = sc\_(k1,k1)}
\DoxyCodeLine{1965 }
\DoxyCodeLine{1966            k2 = sum(k(:,m+1:ngluon),dim=2)}
\DoxyCodeLine{1967            k2 = -\/k2 -\/ p}
\DoxyCodeLine{1968            k2sq = sc\_(k2,k2) -\/ mass**2}
\DoxyCodeLine{1969            ms1 = ng1 -\/ m}
\DoxyCodeLine{1970            sp2=bf(e(:,m+1:ngluon),k(:,m+1:ngluon),sp,p,mass,flout,flin,ms1\textcolor{comment}{)}}
\DoxyCodeLine{1971 \textcolor{comment}{}}
\DoxyCodeLine{1972            \textcolor{keywordflow}{if} (ng2 > 0.or.m < ng1) sp2 = spi2\_(k2,sp2)+mass*sp2}
\DoxyCodeLine{1973 }
\DoxyCodeLine{1974            tmp = vgbq(e1,sp2)}
\DoxyCodeLine{1975 }
\DoxyCodeLine{1976            \textcolor{keywordflow}{if} (m > 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1977                \textcolor{keywordflow}{if} (abs(k1sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1978               tmp=-\/(0d0,1d0)/k1sq*tmp}
\DoxyCodeLine{1979               \textcolor{keywordflow}{else}}
\DoxyCodeLine{1980               tmp = (0d0,0d0)}
\DoxyCodeLine{1981 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{1982 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{1983 }
\DoxyCodeLine{1984            \textcolor{keywordflow}{if} (ng2 > 0.or. m < ng1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1985               \textcolor{keywordflow}{if} (abs(k2sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1986               tmp=(0d0,1d0)/k2sq*tmp}
\DoxyCodeLine{1987               \textcolor{keywordflow}{else}}
\DoxyCodeLine{1988               tmp = (0d0,0d0)}
\DoxyCodeLine{1989 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{1990 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{1991 }
\DoxyCodeLine{1992            res = res + tmp}
\DoxyCodeLine{1993 }
\DoxyCodeLine{1994 \textcolor{keywordflow}{           enddo}}
\DoxyCodeLine{1995 }
\DoxyCodeLine{1996 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{1997 \textcolor{keywordflow}{          endif} \textcolor{comment}{! endif for flavor consisency condition}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a6cf6e9462f72b415424686a3de71ac61}\label{namespacemodttbhiggs_a6cf6e9462f72b415424686a3de71ac61}} 
\index{modttbhiggs@{modttbhiggs}!bfv@{bfv}}
\index{bfv@{bfv}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{bfv()}{bfv()}}
{\footnotesize\ttfamily recursive complex(8) function, dimension(size(sp)) modttbhiggs\+::bfv (\begin{DoxyParamCaption}\item[{complex(8), dimension(\+:,\+:), intent(in)}]{e,  }\item[{complex(8), dimension(\+:,\+:), intent(in)}]{k,  }\item[{complex(8), dimension(\+:), intent(in)}]{sp,  }\item[{complex(8), dimension(\+:), intent(in)}]{p,  }\item[{real(8)}]{mass,  }\item[{integer, intent(in)}]{Quark\+Flavor,  }\item[{complex(8), dimension(\+:), intent(in)}]{eV,  }\item[{complex(8), dimension(\+:), intent(in)}]{kV,  }\item[{integer, intent(in)}]{ms }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 815 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{815       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{816       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: e(:,:), k(:,:)}
\DoxyCodeLine{817       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: sp(:), p(:)}
\DoxyCodeLine{818       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: eV(:), kV(:)}
\DoxyCodeLine{819       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} ::  ms,QuarkFlavor}
\DoxyCodeLine{820       \textcolor{keywordtype}{integer}             :: ms1,m,ng1, ng2}
\DoxyCodeLine{821       \textcolor{keywordtype}{integer} :: ngluon}
\DoxyCodeLine{822       \textcolor{keywordtype}{complex(8)}             :: res(size(sp))}
\DoxyCodeLine{823       \textcolor{keywordtype}{complex(8)}             :: tmp(size(sp))}
\DoxyCodeLine{824       \textcolor{keywordtype}{complex(8)}             :: k1(size(p))}
\DoxyCodeLine{825       \textcolor{keywordtype}{complex(8)}             :: k2(size(p))}
\DoxyCodeLine{826       \textcolor{keywordtype}{complex(8)}             :: sp2(size(sp))}
\DoxyCodeLine{827       \textcolor{keywordtype}{complex(8)}             :: sp3(size(sp))}
\DoxyCodeLine{828       \textcolor{keywordtype}{complex(8)}             :: e1(size(e,dim=1))}
\DoxyCodeLine{829       \textcolor{keywordtype}{complex(8)}             :: e2(size(e,dim=1))}
\DoxyCodeLine{830       \textcolor{keywordtype}{complex(8)}  :: k1sq,k2sq,k3sq}
\DoxyCodeLine{831 \textcolor{keywordtype}{      real}(8) :: mass}
\DoxyCodeLine{832       \textcolor{keywordtype}{complex(8)} :: couplVQQ\_left,couplVQQ\_right,couplVQQ\_left2,couplVQQ\_right2}
\DoxyCodeLine{833       \textcolor{keywordtype}{character},\textcolor{keywordtype}{parameter} :: FerFla*3=\textcolor{stringliteral}{"dum"} \textcolor{comment}{! dummy, only used for check of flavor consistency inside the functions f,bf}}
\DoxyCodeLine{834 }
\DoxyCodeLine{835 }
\DoxyCodeLine{836       ngluon = \textcolor{keyword}{size}(e,dim=2)}
\DoxyCodeLine{837       ng1 = ms   \textcolor{comment}{!\#gluons to the left of a f-\/line}}
\DoxyCodeLine{838       ng2 = ngluon -\/ ms  \textcolor{comment}{!\#gluons to the right of the f-\/line}}
\DoxyCodeLine{839 }
\DoxyCodeLine{840       \textcolor{keywordflow}{if} (ng2 < 0) \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'WRONG DEFINITION OF CURRENT fbV'}}
\DoxyCodeLine{841 }
\DoxyCodeLine{842       \textcolor{keywordflow}{if}( abs(quarkflavor).eq.top\_ .or. abs(quarkflavor).eq.bot\_ ) then\textcolor{comment}{!   note that Bot\_ is treated as top quark in TOPAZ!}}
\DoxyCodeLine{843           couplvqq\_left  = couplhtt\_left\_dyn}
\DoxyCodeLine{844           couplvqq\_right = couplhtt\_right\_dyn}
\DoxyCodeLine{845       \textcolor{keywordflow}{else}}
\DoxyCodeLine{846           couplvqq\_left=0d0}
\DoxyCodeLine{847           couplvqq\_right=0d0}
\DoxyCodeLine{848           print *, \textcolor{stringliteral}{"this should not happen for the Higgs"},quarkflavor,top\_}
\DoxyCodeLine{849 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{850 }
\DoxyCodeLine{851 }
\DoxyCodeLine{852 }
\DoxyCodeLine{853 \textcolor{keywordflow}{if} (ngluon == 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{854          res = vvq(ev,sp,couplvqq\_left,couplvqq\_right)}
\DoxyCodeLine{855 \textcolor{keywordflow}{else}}
\DoxyCodeLine{856 }
\DoxyCodeLine{857        res = (0d0,0d0)}
\DoxyCodeLine{858        \textcolor{keywordflow}{do} m=0,ng2-\/1}
\DoxyCodeLine{859            k1 = sum(k(:,ng1+1+m:ngluon),dim=2)}
\DoxyCodeLine{860            e1=g(e(:,ng1+1+m:ngluon),k(:,ng1+1+m:ngluon))}
\DoxyCodeLine{861            k1sq=sc\_(k1,k1)}
\DoxyCodeLine{862 }
\DoxyCodeLine{863            k2 = sum(k(:,1:ng1+m),dim=2)}
\DoxyCodeLine{864            k2 = -\/k2 -\/ p -\/ kv}
\DoxyCodeLine{865            k2sq = sc\_(k2,k2)-\/mass**2}
\DoxyCodeLine{866 }
\DoxyCodeLine{867            sp2 = bfv(e(:,1:ng1+m),k(:,1:ng1+m),sp,p,mass,quarkflavor,ev,kv\textcolor{comment}{,ng1)}}
\DoxyCodeLine{868 \textcolor{comment}{}           sp2 = spi2\_(k2,sp2)+mass*sp2}
\DoxyCodeLine{869 }
\DoxyCodeLine{870            tmp = vbqg(sp2,e1)}
\DoxyCodeLine{871 }
\DoxyCodeLine{872            \textcolor{keywordflow}{if} (m < ng2-\/1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{873             \textcolor{keywordflow}{if} (abs(k1sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{874                 tmp = -\/(0d0,1d0)/k1sq*tmp}
\DoxyCodeLine{875             \textcolor{keywordflow}{else}}
\DoxyCodeLine{876                 tmp = (0d0,0d0)}
\DoxyCodeLine{877 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{878 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{879 }
\DoxyCodeLine{880            \textcolor{keywordflow}{if} (abs(k2sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{881               tmp =  (0d0,1d0)/k2sq*tmp}
\DoxyCodeLine{882            \textcolor{keywordflow}{else}}
\DoxyCodeLine{883                tmp = (0d0,0d0)}
\DoxyCodeLine{884 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{885 }
\DoxyCodeLine{886            res = res + tmp}
\DoxyCodeLine{887 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{888 }
\DoxyCodeLine{889 }
\DoxyCodeLine{890         \textcolor{keywordflow}{do} m=1,ng1}
\DoxyCodeLine{891 }
\DoxyCodeLine{892            k1 = sum(k(:,1:m),dim=2)}
\DoxyCodeLine{893            e1=g(e(:,1:m),k(:,1:m))}
\DoxyCodeLine{894            k1sq = sc\_(k1,k1)}
\DoxyCodeLine{895 }
\DoxyCodeLine{896            k2 = sum(k(:,m+1:ngluon),dim=2)}
\DoxyCodeLine{897            k2 = -\/k2 -\/ p -\/ kv}
\DoxyCodeLine{898            k2sq = sc\_(k2,k2) -\/ mass**2}
\DoxyCodeLine{899            ms1 = ng1 -\/ m}
\DoxyCodeLine{900            sp2=bfv(e(:,m+1:ngluon),k(:,m+1:ngluon),sp,p,mass,quarkflavor\textcolor{comment}{,ev,kv,ms1)}}
\DoxyCodeLine{901 \textcolor{comment}{}}
\DoxyCodeLine{902            sp2 = spi2\_(k2,sp2)+mass*sp2}
\DoxyCodeLine{903 }
\DoxyCodeLine{904            tmp = vgbq(e1,sp2)}
\DoxyCodeLine{905 }
\DoxyCodeLine{906            \textcolor{keywordflow}{if} (m > 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{907               \textcolor{keywordflow}{if} (abs(k1sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{908                   tmp=-\/(0d0,1d0)/k1sq*tmp}
\DoxyCodeLine{909               \textcolor{keywordflow}{else}}
\DoxyCodeLine{910                   tmp = (0d0,0d0)}
\DoxyCodeLine{911 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{912 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{913 }
\DoxyCodeLine{914            \textcolor{keywordflow}{if} (abs(k2sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{915                  tmp=(0d0,1d0)/k2sq*tmp}
\DoxyCodeLine{916               \textcolor{keywordflow}{else}}
\DoxyCodeLine{917                  tmp = (0d0,0d0)}
\DoxyCodeLine{918 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{919 }
\DoxyCodeLine{920            res = res + tmp}
\DoxyCodeLine{921 }
\DoxyCodeLine{922 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{923 }
\DoxyCodeLine{924 }
\DoxyCodeLine{925 }
\DoxyCodeLine{926         sp2 = bf(e,k,sp,p,mass,ferfla,ferfla,ms)}
\DoxyCodeLine{927         k2 = sum(k(:,1:ngluon),dim=2)}
\DoxyCodeLine{928         k2 = -\/k2 -\/ p}
\DoxyCodeLine{929         k2sq = sc\_(k2,k2)   -\/mass**2}
\DoxyCodeLine{930 }
\DoxyCodeLine{931 \textcolor{comment}{!        sp2 = spb2\_(sp2,k2) +mass*sp2}}
\DoxyCodeLine{932         sp2 = spi2\_(k2,sp2) +mass*sp2}
\DoxyCodeLine{933 }
\DoxyCodeLine{934         tmp = vvq(ev,sp2,couplvqq\_left,couplvqq\_right)}
\DoxyCodeLine{935         \textcolor{keywordflow}{if} (abs(k2sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{936                tmp = (0d0,1d0)/k2sq*tmp}
\DoxyCodeLine{937         \textcolor{keywordflow}{else}}
\DoxyCodeLine{938                tmp = (0d0,0d0)}
\DoxyCodeLine{939 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{940         res = res + tmp}
\DoxyCodeLine{941 }
\DoxyCodeLine{942 \textcolor{keywordflow}{endif}}
\DoxyCodeLine{943 }
\DoxyCodeLine{944 }
\DoxyCodeLine{945 }
\DoxyCodeLine{946 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a6ff336a409158adea0b84ed7c7b00ec8}\label{namespacemodttbhiggs_a6ff336a409158adea0b84ed7c7b00ec8}} 
\index{modttbhiggs@{modttbhiggs}!chir@{chir}}
\index{chir@{chir}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{chir()}{chir()}}
{\footnotesize\ttfamily recursive double complex function, dimension(size(sp)) modttbhiggs\+::chir (\begin{DoxyParamCaption}\item[{logical}]{sign,  }\item[{double complex, dimension(\+:)}]{sp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5403 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5403                \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5404                \textcolor{keywordtype}{logical} :: sign}
\DoxyCodeLine{5405                \textcolor{keywordtype}{double complex} :: sp(:)}
\DoxyCodeLine{5406                \textcolor{keywordtype}{double complex} :: res(size(sp))}
\DoxyCodeLine{5407                \textcolor{keywordtype}{integer}        :: D}
\DoxyCodeLine{5408 }
\DoxyCodeLine{5409                d = \textcolor{keyword}{size}(sp)}
\DoxyCodeLine{5410                \textcolor{keywordflow}{if} ( d .eq. 4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5411                   \textcolor{keywordflow}{if}(sign) \textcolor{keywordflow}{then} \textcolor{comment}{!omega\_+}}
\DoxyCodeLine{5412                      res(1) = 0.5d0*(sp(1)+sp(3))}
\DoxyCodeLine{5413                      res(2) = 0.5d0*(sp(2)+sp(4))}
\DoxyCodeLine{5414                      res(3) = res(1)}
\DoxyCodeLine{5415                      res(4) = res(2)}
\DoxyCodeLine{5416                   \textcolor{keywordflow}{else} \textcolor{comment}{!omega\_-\/}}
\DoxyCodeLine{5417                      res(1) = 0.5d0*(sp(1)-\/sp(3))}
\DoxyCodeLine{5418                      res(2) = 0.5d0*(sp(2)-\/sp(4))}
\DoxyCodeLine{5419                      res(3) =-\/res(1)}
\DoxyCodeLine{5420                      res(4) =-\/res(2)}
\DoxyCodeLine{5421 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{5422                \textcolor{keywordflow}{else}}
\DoxyCodeLine{5423                   res(1:d/2)     =  chir(sign,sp(1:d/2))}
\DoxyCodeLine{5424                   res((d/2+1):d) =  chir(sign,sp( (d/2+1):d ))}
\DoxyCodeLine{5425 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{5426 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_aee7a049ddac0cf1681dffd71093a36cf}\label{namespacemodttbhiggs_aee7a049ddac0cf1681dffd71093a36cf}} 
\index{modttbhiggs@{modttbhiggs}!copyparticleptr@{copyparticleptr}}
\index{copyparticleptr@{copyparticleptr}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{copyparticleptr()}{copyparticleptr()}}
{\footnotesize\ttfamily subroutine modttbhiggs\+::copyparticleptr (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), intent(in)}]{In\+Pointer,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), intent(out)}]{Out\+Pointer }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5064 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5064 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5065 \textcolor{keywordtype}{type}(PtrToParticle), \textcolor{keywordtype}{intent(in)} :: InPointer}
\DoxyCodeLine{5066 \textcolor{keywordtype}{type}(PtrToParticle), \textcolor{keywordtype}{intent(out)}:: OutPointer}
\DoxyCodeLine{5067 }
\DoxyCodeLine{5068    outpointer\%PartType => inpointer\%PartType}
\DoxyCodeLine{5069    outpointer\%ExtRef => inpointer\%ExtRef}
\DoxyCodeLine{5070    outpointer\%Mass => inpointer\%Mass}
\DoxyCodeLine{5071    outpointer\%Mass2 => inpointer\%Mass2}
\DoxyCodeLine{5072    outpointer\%Helicity => inpointer\%Helicity}
\DoxyCodeLine{5073    outpointer\%Mom => inpointer\%Mom}
\DoxyCodeLine{5074    outpointer\%Pol => inpointer\%Pol}
\DoxyCodeLine{5075 \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a60f6b75e3113bbfd04d46ef7f3e8ae2c}\label{namespacemodttbhiggs_a60f6b75e3113bbfd04d46ef7f3e8ae2c}} 
\index{modttbhiggs@{modttbhiggs}!cur\_f\_2f@{cur\_f\_2f}}
\index{cur\_f\_2f@{cur\_f\_2f}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{cur\_f\_2f()}{cur\_f\_2f()}}
{\footnotesize\ttfamily complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}}) modttbhiggs\+::cur\+\_\+f\+\_\+2f (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(1\+:)}]{Gluons,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(2\+:2)}]{Quarks,  }\item[{integer}]{Quark1\+Part\+Type,  }\item[{integer, dimension(0\+:2)}]{Num\+Glu }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 2273 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2273 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{2274 \textcolor{keywordtype}{complex(8)} :: Res(1:Ds)}
\DoxyCodeLine{2275 \textcolor{keywordtype}{integer} :: NumGlu(0:2),i,rIn,rOut,Quark1PartType}
\DoxyCodeLine{2276 \textcolor{keywordtype}{type}(PtrToParticle) :: Gluons(1:),Quarks(2:2)      \textcolor{comment}{! off-\/shell quark is not included in Quarks(:)}}
\DoxyCodeLine{2277 \textcolor{keywordtype}{complex(8)} :: GluMom(1:Dv,NumGlu(0)), QuarkMom(1:Dv)}
\DoxyCodeLine{2278 \textcolor{keywordtype}{complex(8)} :: GluPol(1:Dv,NumGlu(0)), QuarkPol(1:Ds)}
\DoxyCodeLine{2279 \textcolor{keywordtype}{character} :: FerFla1*3,FerFla2*3}
\DoxyCodeLine{2280 \textcolor{keywordtype}{integer} :: PartKey,HelKey,CurrKey,Hel\_Tmp}
\DoxyCodeLine{2281 }
\DoxyCodeLine{2282 }
\DoxyCodeLine{2283 }
\DoxyCodeLine{2284 }
\DoxyCodeLine{2285 }
\DoxyCodeLine{2286 }
\DoxyCodeLine{2287 \textcolor{comment}{!DEC\$ IF (\_DebugGeneralChecks==1)}}
\DoxyCodeLine{2288    \textcolor{keywordflow}{if}( quarks(2)\%PartType .eq.0 .or. .not.isaquark(quarks(2)\%PartType)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2289       print *, \textcolor{stringliteral}{"Error in cur\_f\_2f"}}
\DoxyCodeLine{2290       stop}
\DoxyCodeLine{2291 \textcolor{keywordflow}{   endif}}
\DoxyCodeLine{2292 \textcolor{comment}{!DEC\$ ENDIF}}
\DoxyCodeLine{2293 \textcolor{comment}{!DEC\$ IF (\_DebugCheckMyImpl1==1)}}
\DoxyCodeLine{2294     \textcolor{keywordflow}{if}( numglu(0)-\/numglu(1)-\/numglu(2).ne.0 ) print *, \textcolor{stringliteral}{"wrong number of gluons in cur\_f\_2f"}}
\DoxyCodeLine{2295     \textcolor{keywordflow}{if}( quarks(2)\%PartType.ne.-\/quark1parttype ) print *, \textcolor{stringliteral}{"unequal flavors in cur\_f\_2f"}}
\DoxyCodeLine{2296 \textcolor{comment}{!DEC\$ ENDIF}}
\DoxyCodeLine{2297 }
\DoxyCodeLine{2298 }
\DoxyCodeLine{2299    \textcolor{keywordflow}{do} i=1,numglu(0)}
\DoxyCodeLine{2300     glumom(1:dv,i) = gluons(i)\%Mom(1:dv)}
\DoxyCodeLine{2301     glupol(1:dv,i) = gluons(i)\%Pol(1:dv)}
\DoxyCodeLine{2302 \textcolor{keywordflow}{   enddo}}
\DoxyCodeLine{2303    quarkmom(1:dv) = quarks(2)\%Mom(1:dv)}
\DoxyCodeLine{2304    quarkpol(1:ds) = quarks(2)\%Pol(1:ds)}
\DoxyCodeLine{2305 }
\DoxyCodeLine{2306    \textcolor{keywordflow}{if}( abs(quark1parttype).eq.5 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2307     ferfla1=\textcolor{stringliteral}{"top"}}
\DoxyCodeLine{2308    \textcolor{keywordflow}{elseif}( abs(quark1parttype).eq.6 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2309     ferfla1=\textcolor{stringliteral}{"bot"}}
\DoxyCodeLine{2310    \textcolor{keywordflow}{elseif}( abs(quark1parttype).eq.3 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2311     ferfla1=\textcolor{stringliteral}{"chm"}}
\DoxyCodeLine{2312    \textcolor{keywordflow}{else}}
\DoxyCodeLine{2313     ferfla1=\textcolor{stringliteral}{"str"}}
\DoxyCodeLine{2314 \textcolor{keywordflow}{   endif}}
\DoxyCodeLine{2315 }
\DoxyCodeLine{2316    \textcolor{keywordflow}{if}( abs(quarks(2)\%PartType).eq.5 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2317     ferfla2=\textcolor{stringliteral}{"top"}}
\DoxyCodeLine{2318    \textcolor{keywordflow}{elseif}( abs(quarks(2)\%PartType).eq.6 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2319     ferfla2=\textcolor{stringliteral}{"bot"}}
\DoxyCodeLine{2320    \textcolor{keywordflow}{elseif}( abs(quarks(2)\%PartType).eq.3 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2321     ferfla2=\textcolor{stringliteral}{"chm"}}
\DoxyCodeLine{2322    \textcolor{keywordflow}{else}}
\DoxyCodeLine{2323     ferfla2=\textcolor{stringliteral}{"str"}}
\DoxyCodeLine{2324 \textcolor{keywordflow}{   endif}}
\DoxyCodeLine{2325 }
\DoxyCodeLine{2326    rin =1}
\DoxyCodeLine{2327    rout=numglu(0)}
\DoxyCodeLine{2328    \textcolor{keywordflow}{if}( quarks(2)\%PartType .gt.0 ) \textcolor{keywordflow}{then}      \textcolor{comment}{!    X-\/-\/-\/-\/-\/>-\/-\/-\/-\/}}
\DoxyCodeLine{2329       res(:) = f(glupol(1:dv,rin:rout),glumom(1:dv,rin:rout),quarkpol(1:ds),quarkmom(1:dv),quarks(2)\%Mass,ferfla2,ferfla1,numglu(1))}
\DoxyCodeLine{2330    \textcolor{keywordflow}{else}                                     \textcolor{comment}{!    X-\/-\/-\/-\/-\/<-\/-\/-\/-\/}}
\DoxyCodeLine{2331       res(:) = bf(glupol(1:dv,rin:rout),glumom(1:dv,rin:rout),quarkpol(1:ds),quarkmom(1:dv),quarks(2)\%Mass,ferfla2,ferfla1,numglu(1))}
\DoxyCodeLine{2332 \textcolor{keywordflow}{   endif}}
\DoxyCodeLine{2333 }
\DoxyCodeLine{2334 }
\DoxyCodeLine{2335 \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a1600f3895fd4d0e6828f9a3a3f63ee1d}\label{namespacemodttbhiggs_a1600f3895fd4d0e6828f9a3a3f63ee1d}} 
\index{modttbhiggs@{modttbhiggs}!cur\_f\_2fv@{cur\_f\_2fv}}
\index{cur\_f\_2fv@{cur\_f\_2fv}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{cur\_f\_2fv()}{cur\_f\_2fv()}}
{\footnotesize\ttfamily complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}}) modttbhiggs\+::cur\+\_\+f\+\_\+2fv (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(1\+:)}]{Gluons,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(2\+:2)}]{Quark,  }\item[{integer}]{Quark1\+Part\+Type,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}})}]{Boson,  }\item[{integer, dimension(0\+:2)}]{Num\+Glu }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 649 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{649 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{650 \textcolor{keywordtype}{complex(8)} :: Res(1:Ds)}
\DoxyCodeLine{651 \textcolor{keywordtype}{integer} :: NumGlu(0:2),i,rIn,rOut,Quark1PartType}
\DoxyCodeLine{652 \textcolor{keywordtype}{type}(PtrToParticle) :: Gluons(1:),Boson,Quark(2:2)}
\DoxyCodeLine{653 \textcolor{keywordtype}{complex(8)} :: GluMom(1:Dv,NumGlu(0)), QuarkMom(1:Dv)}
\DoxyCodeLine{654 \textcolor{keywordtype}{complex(8)} :: GluPol(1:Dv,NumGlu(0)), QuarkPol(1:Ds)}
\DoxyCodeLine{655 }
\DoxyCodeLine{656 }
\DoxyCodeLine{657 }
\DoxyCodeLine{658    \textcolor{keywordflow}{do} i=1,numglu(0)}
\DoxyCodeLine{659     glumom(1:dv,i) = gluons(i)\%Mom(1:dv)}
\DoxyCodeLine{660     glupol(1:dv,i) = gluons(i)\%Pol(1:dv)}
\DoxyCodeLine{661 \textcolor{keywordflow}{   enddo}}
\DoxyCodeLine{662    quarkmom(1:dv) = quark(2)\%Mom(1:dv)}
\DoxyCodeLine{663    quarkpol(1:ds) = quark(2)\%Pol(1:ds)}
\DoxyCodeLine{664 }
\DoxyCodeLine{665    \textcolor{keywordflow}{if}( quark1parttype.ne.-\/quark(2)\%PartType ) print *, \textcolor{stringliteral}{"Wrong quark flavors in cur\_f\_2fV"}}
\DoxyCodeLine{666    \textcolor{keywordflow}{if}( numglu(0)-\/numglu(1)-\/numglu(2).ne.0 ) print *, \textcolor{stringliteral}{"Wrong NumGlu in cur\_f\_2fV"},numglu(0)-\/numglu(1)-\/numglu(2)}
\DoxyCodeLine{667 }
\DoxyCodeLine{668    rin =1}
\DoxyCodeLine{669    rout=numglu(0)}
\DoxyCodeLine{670    \textcolor{keywordflow}{if}( quark(2)\%PartType .gt.0 ) \textcolor{keywordflow}{then}      \textcolor{comment}{!    X-\/-\/-\/-\/-\/>-\/-\/-\/-\/}}
\DoxyCodeLine{671       res(:) = fv(glupol(1:dv,rin:rout),glumom(1:dv,rin:rout),quarkpol(1:ds),quarkmom(1:dv),quark(2)\%Mass,quark1parttype,boson\%Pol(1:dv),boson\%Mom(1:dv),numglu(1))}
\DoxyCodeLine{672    \textcolor{keywordflow}{else}}
\DoxyCodeLine{673       res(:) = bfv(glupol(1:dv,rin:rout),glumom(1:dv,rin:rout),quarkpol(1:ds),quarkmom(1:dv),quark(2)\%Mass,quark1parttype,boson\%Pol(1:dv),boson\%Mom(1:dv),numglu(1))}
\DoxyCodeLine{674 \textcolor{keywordflow}{   endif}}
\DoxyCodeLine{675 }
\DoxyCodeLine{676 }
\DoxyCodeLine{677 \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a2b50d80982627a5e499fe2c4eec44c88}\label{namespacemodttbhiggs_a2b50d80982627a5e499fe2c4eec44c88}} 
\index{modttbhiggs@{modttbhiggs}!cur\_f\_4f@{cur\_f\_4f}}
\index{cur\_f\_4f@{cur\_f\_4f}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{cur\_f\_4f()}{cur\_f\_4f()}}
{\footnotesize\ttfamily complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}}) modttbhiggs\+::cur\+\_\+f\+\_\+4f (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(1\+:)}]{Gluons,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(2\+:4)}]{Quarks,  }\item[{integer}]{Quark1\+Part\+Type,  }\item[{integer, dimension(0\+:4)}]{Num\+Glu,  }\item[{integer}]{tag\+\_\+f,  }\item[{integer, optional}]{tag\+\_\+\+Z\+\_\+arg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1401 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1401 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1402 \textcolor{keywordtype}{integer} :: NumGlu(0:4),Quark1PartType}
\DoxyCodeLine{1403 \textcolor{keywordtype}{type}(PtrToParticle) :: Gluons(1:),Quarks(2:4)}
\DoxyCodeLine{1404 \textcolor{keywordtype}{integer} :: tag\_f,tag\_Z}
\DoxyCodeLine{1405 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{optional} :: tag\_Z\_arg}
\DoxyCodeLine{1406 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{target} :: TmpExtRef}
\DoxyCodeLine{1407 \textcolor{keywordtype}{complex(8)} :: res(1:Ds),tmp(1:Ds)}
\DoxyCodeLine{1408 \textcolor{keywordtype}{complex(8)} :: ubar1(1:Ds)}
\DoxyCodeLine{1409 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: ubar0(1:Ds)}
\DoxyCodeLine{1410 \textcolor{keywordtype}{complex(8)} :: eps1(1:Dv)}
\DoxyCodeLine{1411 \textcolor{keywordtype}{complex(8)} :: eps2(1:Dv)}
\DoxyCodeLine{1412 \textcolor{keywordtype}{type}(PtrToParticle) :: TmpGluons(1:NumGlu(1)+NumGlu(4)),TmpQuark(1:1)}
\DoxyCodeLine{1413 \textcolor{keywordtype}{complex(8)} :: PropFac1,PropFac2}
\DoxyCodeLine{1414 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: pmom1(1:Dv)}
\DoxyCodeLine{1415 \textcolor{keywordtype}{complex(8)} :: pmom2(1:Dv)}
\DoxyCodeLine{1416 \textcolor{keywordtype}{integer} :: n1a,n1b,n2a,n2b,n3a,n3b,n4a,n4b}
\DoxyCodeLine{1417 \textcolor{keywordtype}{integer} :: rIn,rOut,i,counter}
\DoxyCodeLine{1418 }
\DoxyCodeLine{1419 }
\DoxyCodeLine{1420 \textcolor{comment}{!DEC\$ IF (\_DebugCheckMyImpl1==1)}}
\DoxyCodeLine{1421     \textcolor{keywordflow}{if}( numglu(0)-\/numglu(1)-\/numglu(2)-\/numglu(3)-\/numglu(4).ne.0 ) print *, \textcolor{stringliteral}{"wrong number of gluons in cur\_f\_4f"}}
\DoxyCodeLine{1422     \textcolor{keywordflow}{if}(quarks(3)\%PartType.eq.-\/quarks(4)\%PartType .and. quark1parttype.ne.-\/quarks(2)\%PartType ) print *,\textcolor{stringliteral}{"wrong flavor in cur\_f\_4f (1)"}}
\DoxyCodeLine{1423     \textcolor{keywordflow}{if}(quarks(2)\%PartType.eq.-\/quarks(3)\%PartType .and. quark1parttype.ne.-\/quarks(4)\%PartType ) print *,\textcolor{stringliteral}{"wrong flavor in cur\_f\_4f (2)"}}
\DoxyCodeLine{1424 \textcolor{comment}{!DEC\$ ENDIF}}
\DoxyCodeLine{1425 }
\DoxyCodeLine{1426    res(:)=(0d0,0d0)}
\DoxyCodeLine{1427 }
\DoxyCodeLine{1428    tag\_z=0}
\DoxyCodeLine{1429    \textcolor{keywordflow}{if}( \textcolor{keyword}{present}(tag\_z\_arg) ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1430       tag\_z=tag\_z\_arg}
\DoxyCodeLine{1431 \textcolor{keywordflow}{   endif}}
\DoxyCodeLine{1432 }
\DoxyCodeLine{1433    \textcolor{keywordflow}{if}( quark1parttype.eq.-\/quarks(2)\%PartType .and. quarks(3)\%PartType.eq.-\/quarks(4)\%PartType ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1434 \textcolor{comment}{!     (I)}}
\DoxyCodeLine{1435       \textcolor{keywordflow}{do} n2a=0,numglu(2)}
\DoxyCodeLine{1436       \textcolor{keywordflow}{do} n4a=0,numglu(4)}
\DoxyCodeLine{1437          n2b = numglu(2)-\/n2a}
\DoxyCodeLine{1438          n4b = numglu(4)-\/n4a}
\DoxyCodeLine{1439 }
\DoxyCodeLine{1440          rin =numglu(1)+n2a+1}
\DoxyCodeLine{1441          rout=numglu(1)+numglu(2)+numglu(3)+n4a}
\DoxyCodeLine{1442          eps2 = cur\_g\_2f(gluons(rin:rout),quarks(3:4),(/1+n2b+numglu(3)+n4a,n2b,numglu(3),n4a/))}
\DoxyCodeLine{1443          pmom1(:) = summom(gluons,rin,rout) + quarks(3)\%Mom + quarks(4)\%Mom}
\DoxyCodeLine{1444          propfac1 = (0d0,-\/1d0)/sc\_(pmom1,pmom1)}
\DoxyCodeLine{1445          \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)).lt.propcut ) cycle}
\DoxyCodeLine{1446          eps2 = eps2*propfac1}
\DoxyCodeLine{1447          \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{1448             n1b = numglu(1)-\/n1a}
\DoxyCodeLine{1449             \textcolor{comment}{! Fer2}}
\DoxyCodeLine{1450             rin =n1a+1}
\DoxyCodeLine{1451             rout=numglu(1)+n2a}
\DoxyCodeLine{1452             ubar1(:) = cur\_f\_2f(gluons(rin:rout),quarks(2:2),-\/quarks(2)\%PartType,(/n2a+n1b,n1b,n2a/) )}
\DoxyCodeLine{1453             \textcolor{keywordflow}{if}(n1b.ge.1 .or. n2a.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1454                pmom2(:) = quarks(2)\%Mom + summom(gluons,rin,rout)  \textcolor{comment}{! can be moved outside the n1a-\/loop}}
\DoxyCodeLine{1455                propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{1456                \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{1457                \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1458                   ubar1(:) = (-\/spi2\_(pmom2,ubar1)+quarks(2)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{1459                \textcolor{keywordflow}{else}}
\DoxyCodeLine{1460                   ubar1(:) = (+spb2\_(ubar1,pmom2)+quarks(2)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{1461 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{1462 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{1463             \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1464                ubar0(:) = vbqg(ubar1,eps2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{1465             \textcolor{keywordflow}{else}}
\DoxyCodeLine{1466                ubar0(:) = vqg(ubar1,eps2)        \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{1467 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{1468 }
\DoxyCodeLine{1469             pmom1 = quarks(2)\%Mom+quarks(3)\%Mom+quarks(4)\%Mom+summom(gluons,n1a+1,numglu(1)+numglu(2)+numglu(3)+n4a)}
\DoxyCodeLine{1470             \textcolor{keywordflow}{if}(n1a.ge.1 .or. n4b.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1471                propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{1472                \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)-\/quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{1473                \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1474                   ubar0(:) = (-\/spi2\_(pmom1,ubar0)+quarks(2)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{1475                \textcolor{keywordflow}{else}}
\DoxyCodeLine{1476                   ubar0(:) = (+spb2\_(ubar0,pmom1)+quarks(2)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{1477 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{1478 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{1479 }
\DoxyCodeLine{1480             tmpquark(1)\%Mom  => pmom1(:)}
\DoxyCodeLine{1481             tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{1482             tmpquark(1)\%Mass => quarks(2)\%Mass}
\DoxyCodeLine{1483             tmpquark(1)\%Mass2=> quarks(2)\%Mass2}
\DoxyCodeLine{1484             tmpextref = -\/1}
\DoxyCodeLine{1485             tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{1486             tmpquark(1)\%PartType => quarks(2)\%PartType}
\DoxyCodeLine{1487             counter=1}
\DoxyCodeLine{1488             rin =1}
\DoxyCodeLine{1489             rout=n1a}
\DoxyCodeLine{1490             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{1491               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{1492               counter=counter+1}
\DoxyCodeLine{1493 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{1494             rin =numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{1495             rout=numglu(0)}
\DoxyCodeLine{1496             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{1497               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{1498               counter=counter+1}
\DoxyCodeLine{1499 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{1500             tmp(:) = cur\_f\_2f(tmpgluons(1:counter-\/1),tmpquark(1:1),-\/tmpquark(1)\%PartType,(/counter-\/1,n1a,n4b/) )}
\DoxyCodeLine{1501             res(:) = res(:) + tmp(:)}
\DoxyCodeLine{1502 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{1503 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1504 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1505 \textcolor{keywordflow}{   endif}}
\DoxyCodeLine{1506 }
\DoxyCodeLine{1507 }
\DoxyCodeLine{1508 \textcolor{comment}{!    if( (Quark1PartType.eq.-\/Quarks(4)\%PartType .and. Quarks(2)\%PartType.eq.-\/Quarks(3)\%PartType) .AND.  \&}}
\DoxyCodeLine{1509 \textcolor{comment}{!        ((abs(Quark1PartType).ne.abs(Quarks(2)\%PartType).and.(tag\_f.ne.3)) .or. \&}}
\DoxyCodeLine{1510 \textcolor{comment}{!         (abs(Quark1PartType).eq.abs(Quarks(2)\%PartType).and.(tag\_f.ne.1.and.tag\_f.ne.3))) ) then}}
\DoxyCodeLine{1511 \textcolor{comment}{!    if( (Quark1PartType.eq.-\/Quarks(4)\%PartType .and. Quarks(2)\%PartType.eq.-\/Quarks(3)\%PartType) .AND.  \&}}
\DoxyCodeLine{1512 \textcolor{comment}{!        .not.(Quarks(4)\%ExtRef.eq.-\/1 .and. tag\_f.eq.1 .and. abs(Quark1PartType).eq.(Quarks(2)\%PartType))  ) then}}
\DoxyCodeLine{1513    \textcolor{keywordflow}{if}( (quark1parttype.eq.-\/quarks(4)\%PartType .and. quarks(2)\%PartType.eq.-\/quarks(3)\%PartType) .AND.  \&}
\DoxyCodeLine{1514        (quarks(4)\%ExtRef.ne.-\/1 .or. tag\_f.ne.1 .or. abs(quark1parttype).ne.abs(quarks(2)\%PartType)) \&}
\DoxyCodeLine{1515      ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1516 \textcolor{comment}{!     (II)}}
\DoxyCodeLine{1517       \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{1518       \textcolor{keywordflow}{do} n3b=0,numglu(3)}
\DoxyCodeLine{1519          n1b = numglu(1)-\/n1a}
\DoxyCodeLine{1520          n3a = numglu(3)-\/n3b}
\DoxyCodeLine{1521          rin =n1a+1}
\DoxyCodeLine{1522          rout=numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{1523 }
\DoxyCodeLine{1524 }
\DoxyCodeLine{1525 \textcolor{comment}{! This prevents color issues with a Z on the quark loop, see RR notes}}
\DoxyCodeLine{1526          \textcolor{keywordflow}{if} ( tag\_z .eq. 1 .and. (n1b+numglu(2)+n3a .eq. numglu(0)) .and. quarks(4)\%ExtRef .eq. -\/1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1527 \textcolor{comment}{!             print  * , "cycle for tag\_Z=1 in cur\_f\_4f",n1a,n1b}}
\DoxyCodeLine{1528             cycle}
\DoxyCodeLine{1529 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{1530 }
\DoxyCodeLine{1531 }
\DoxyCodeLine{1532 }
\DoxyCodeLine{1533 }
\DoxyCodeLine{1534          eps2 = cur\_g\_2f(gluons(rin:rout),quarks(2:3),(/1+n1b+numglu(2)+n3a,n1b,numglu(2),n3a/))}
\DoxyCodeLine{1535          pmom1(:) = summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{1536          propfac1 = (0d0,-\/1d0)/sc\_(pmom1,pmom1)}
\DoxyCodeLine{1537          \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)).lt.propcut ) cycle}
\DoxyCodeLine{1538          eps2 = eps2*propfac1}
\DoxyCodeLine{1539 }
\DoxyCodeLine{1540          \textcolor{keywordflow}{do} n4a=0,numglu(4)}
\DoxyCodeLine{1541             n4b = numglu(4)-\/n4a}
\DoxyCodeLine{1542             \textcolor{comment}{! Fer4}}
\DoxyCodeLine{1543             rin =numglu(1)+numglu(2)+n3a+1}
\DoxyCodeLine{1544             rout=numglu(1)+numglu(2)+numglu(3)+n4a}
\DoxyCodeLine{1545             ubar1(:) = cur\_f\_2f(gluons(rin:rout),quarks(4:4),-\/quarks(4)\%PartType,(/numglu(3)+n4a-\/n3a,n3b,n4a/) )}
\DoxyCodeLine{1546             \textcolor{keywordflow}{if}(n3b.ge.1 .or. n4a.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1547                pmom2(:) = quarks(4)\%Mom + summom(gluons,rin,rout)}
\DoxyCodeLine{1548                propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2)-\/quarks(4)\%Mass2)}
\DoxyCodeLine{1549                \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2)-\/quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{1550                \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1551                   ubar1(:) = (-\/spi2\_(pmom2,ubar1)+quarks(4)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{1552                \textcolor{keywordflow}{else}}
\DoxyCodeLine{1553                   ubar1(:) = (+spb2\_(ubar1,pmom2)+quarks(4)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{1554 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{1555 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{1556             \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1557                ubar0(:) = vgbq(eps2,ubar1)   \textcolor{comment}{!! changed from vqg(ubar1,eps2)       ! re-\/checked}}
\DoxyCodeLine{1558             \textcolor{keywordflow}{else}}
\DoxyCodeLine{1559                ubar0(:) = vgq(eps2,ubar1)   \textcolor{comment}{!! changed from vbqg(ubar1,eps2)       ! re-\/checked}}
\DoxyCodeLine{1560 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{1561 }
\DoxyCodeLine{1562             pmom1 = quarks(2)\%Mom+quarks(3)\%Mom+quarks(4)\%Mom+summom(gluons,n1a+1,numglu(1)+numglu(2)+numglu(3)+n4a)}
\DoxyCodeLine{1563             \textcolor{keywordflow}{if}(n1a.ge.1 .or. n4b.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1564                propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1)-\/quarks(4)\%Mass2)}
\DoxyCodeLine{1565                \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)-\/quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{1566                \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1567                   ubar0(:) = (-\/spi2\_(pmom1,ubar0)+quarks(4)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{1568                \textcolor{keywordflow}{else}}
\DoxyCodeLine{1569                   ubar0(:) = (+spb2\_(ubar0,pmom1)+quarks(4)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{1570 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{1571 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{1572             tmpquark(1)\%Mom  => pmom1(:)}
\DoxyCodeLine{1573             tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{1574             tmpquark(1)\%Mass => quarks(4)\%Mass}
\DoxyCodeLine{1575             tmpquark(1)\%Mass2=> quarks(4)\%Mass2}
\DoxyCodeLine{1576             tmpextref = -\/1}
\DoxyCodeLine{1577             tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{1578             tmpquark(1)\%PartType => quarks(4)\%PartType}
\DoxyCodeLine{1579             counter=1}
\DoxyCodeLine{1580             rin =1}
\DoxyCodeLine{1581             rout=n1a}
\DoxyCodeLine{1582             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{1583               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{1584               counter=counter+1}
\DoxyCodeLine{1585 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{1586             rin =numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{1587             rout=numglu(0)}
\DoxyCodeLine{1588             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{1589               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{1590               counter=counter+1}
\DoxyCodeLine{1591 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{1592             tmp(:) = cur\_f\_2f(tmpgluons(1:counter-\/1),tmpquark(1:1),-\/tmpquark(1)\%PartType,(/counter-\/1,n1a,n4b/) )}
\DoxyCodeLine{1593             res(:) = res(:) + tmp(:)}
\DoxyCodeLine{1594 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{1595 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1596 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1597 \textcolor{keywordflow}{   endif}}
\DoxyCodeLine{1598 \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_abc69cbe148d81013745b94be70548d62}\label{namespacemodttbhiggs_abc69cbe148d81013745b94be70548d62}} 
\index{modttbhiggs@{modttbhiggs}!cur\_f\_4fv@{cur\_f\_4fv}}
\index{cur\_f\_4fv@{cur\_f\_4fv}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{cur\_f\_4fv()}{cur\_f\_4fv()}}
{\footnotesize\ttfamily complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}}) modttbhiggs\+::cur\+\_\+f\+\_\+4fv (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(1\+:)}]{Gluons,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(2\+:4)}]{Quarks,  }\item[{integer}]{Quark1\+Part\+Type,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}})}]{Boson,  }\item[{integer}]{Boson\+Vertex,  }\item[{integer, dimension(0\+:4)}]{Num\+Glu,  }\item[{integer}]{tag\+\_\+f,  }\item[{integer}]{tag\+\_\+Z }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 954 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{954 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{955 \textcolor{keywordtype}{integer} :: NumGlu(0:4),Quark1PartType}
\DoxyCodeLine{956 \textcolor{keywordtype}{type}(PtrToParticle) :: Gluons(1:),Quarks(2:4),Boson}
\DoxyCodeLine{957 \textcolor{keywordtype}{integer} :: tag\_f,BosonVertex,tag\_Z}
\DoxyCodeLine{958 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{target} :: TmpExtRef}
\DoxyCodeLine{959 \textcolor{keywordtype}{complex(8)} :: res(1:Ds),tmp(1:Ds)}
\DoxyCodeLine{960 \textcolor{keywordtype}{complex(8)} :: ubar1(1:Ds)}
\DoxyCodeLine{961 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: ubar0(1:Ds)}
\DoxyCodeLine{962 \textcolor{keywordtype}{complex(8)} :: eps1(1:Dv)}
\DoxyCodeLine{963 \textcolor{keywordtype}{complex(8)} :: eps2(1:Dv)}
\DoxyCodeLine{964 \textcolor{keywordtype}{type}(PtrToParticle) :: TmpGluons(1:NumGlu(1)+NumGlu(4)),TmpQuark(1:1)}
\DoxyCodeLine{965 \textcolor{keywordtype}{complex(8)} :: PropFac1,PropFac2}
\DoxyCodeLine{966 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: pmom1(1:Dv)}
\DoxyCodeLine{967 \textcolor{keywordtype}{complex(8)} :: pmom2(1:Dv)}
\DoxyCodeLine{968 \textcolor{keywordtype}{integer} :: n1a,n1b,n2a,n2b,n3a,n3b,n4a,n4b}
\DoxyCodeLine{969 \textcolor{keywordtype}{integer} :: rIn,rOut,i,counter}
\DoxyCodeLine{970 }
\DoxyCodeLine{971 }
\DoxyCodeLine{972 \textcolor{comment}{!DEC\$ IF (\_DebugCheckMyImpl1==1)}}
\DoxyCodeLine{973     \textcolor{keywordflow}{if}( numglu(0)-\/numglu(1)-\/numglu(2)-\/numglu(3)-\/numglu(4).ne.0 ) print *, \textcolor{stringliteral}{"wrong number of gluons in cur\_f\_4f"}}
\DoxyCodeLine{974     \textcolor{keywordflow}{if}(quarks(3)\%PartType.eq.-\/quarks(4)\%PartType .and. quark1parttype.ne.-\/quarks(2)\%PartType ) print *,\textcolor{stringliteral}{"wrong flavor in cur\_f\_4f (1)"}}
\DoxyCodeLine{975     \textcolor{keywordflow}{if}(quarks(2)\%PartType.eq.-\/quarks(3)\%PartType .and. quark1parttype.ne.-\/quarks(4)\%PartType ) print *,\textcolor{stringliteral}{"wrong flavor in cur\_f\_4f (2)"}}
\DoxyCodeLine{976 \textcolor{comment}{!DEC\$ ENDIF}}
\DoxyCodeLine{977     res(:)=(0d0,0d0)}
\DoxyCodeLine{978    \textcolor{keywordflow}{if} ( quark1parttype.eq.-\/quarks(2)\%PartType .and. quarks(3)\%PartType.eq.-\/quarks(4)\%PartType ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{979       \textcolor{keywordflow}{do} n2a=0,numglu(2)}
\DoxyCodeLine{980          \textcolor{keywordflow}{do} n4a=0,numglu(4)}
\DoxyCodeLine{981             n2b = numglu(2)-\/n2a}
\DoxyCodeLine{982             n4b = numglu(4)-\/n4a}
\DoxyCodeLine{983             rin =numglu(1)+n2a+1}
\DoxyCodeLine{984             rout=numglu(1)+numglu(2)+numglu(3)+n4a}
\DoxyCodeLine{985             \textcolor{keywordflow}{if} (bosonvertex .eq. 1 .or. bosonvertex .eq. 2 .or. bosonvertex .eq. 4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{986                eps2 = cur\_g\_2f(gluons(rin:rout),quarks(3:4),(/1+n2b+numglu(3)+n4a,n2b,numglu(3),n4a/))}
\DoxyCodeLine{987                pmom1(:) = summom(gluons,rin,rout) + quarks(3)\%Mom + quarks(4)\%Mom}
\DoxyCodeLine{988             \textcolor{keywordflow}{elseif} (bosonvertex .eq. 3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{989                eps2 = cur\_g\_2fv(gluons(rin:rout),quarks(3:4),boson,(/1+n2b+numglu(3)+n4a,n2b,numglu(3),n4a/))}
\DoxyCodeLine{990                pmom1(:) = summom(gluons,rin,rout) + quarks(3)\%Mom(:) + quarks(4)\%Mom(:) + boson\%Mom(:)}
\DoxyCodeLine{991 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{992             propfac1 = (0d0,-\/1d0)/sc\_(pmom1,pmom1)}
\DoxyCodeLine{993             \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)).lt.propcut ) cycle}
\DoxyCodeLine{994             eps2 = eps2*propfac1}
\DoxyCodeLine{995             \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{996                n1b = numglu(1)-\/n1a}
\DoxyCodeLine{997                \textcolor{comment}{! Fer2}}
\DoxyCodeLine{998                \textcolor{keywordflow}{if} (bosonvertex.eq.1 .or. bosonvertex.eq.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{999                   rin =n1a+1}
\DoxyCodeLine{1000                   rout=numglu(1)+n2a}
\DoxyCodeLine{1001                   ubar1(:) = cur\_f\_2fv(gluons(rin:rout),quarks(2:2),-\/quarks(2)\%PartType,boson,(/n2a+n1b,n1b,n2a/) )}
\DoxyCodeLine{1002                   pmom2(:) = quarks(2)\%Mom(:) + summom(gluons,rin,rout) + boson\%Mom(:)}
\DoxyCodeLine{1003                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{1004 }
\DoxyCodeLine{1005                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2).lt.propcut ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1006                      propfac2=(0d0,0d0)}
\DoxyCodeLine{1007 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{1008 }
\DoxyCodeLine{1009                   \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1010                      ubar1(:) = (-\/spi2\_(pmom2,ubar1)+quarks(2)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{1011                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{1012                      ubar1(:) = (+spb2\_(ubar1,pmom2)+quarks(2)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{1013 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{1014 }
\DoxyCodeLine{1015                   \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1016                      ubar0(:) = vbqg(ubar1,eps2)}
\DoxyCodeLine{1017                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{1018                      ubar0(:) = vqg(ubar1,eps2)}
\DoxyCodeLine{1019 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{1020 }
\DoxyCodeLine{1021                   pmom1 = quarks(2)\%Mom+quarks(3)\%Mom+quarks(4)\%Mom+summom(gluons,n1a+1,numglu(1)+numglu(2)+numglu(3)+n4a) + boson\%Mom(:)}
\DoxyCodeLine{1022                   \textcolor{keywordflow}{if}(n1a.ge.1 .or. n4b.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1023                      propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{1024                      \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)-\/quarks(2)\%Mass2).lt.propcut ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1025                         propfac1=(0d0,0d0)}
\DoxyCodeLine{1026 \textcolor{keywordflow}{                     endif}}
\DoxyCodeLine{1027                      \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1028                         ubar0(:) = (-\/spi2\_(pmom1,ubar0)+quarks(2)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{1029                      \textcolor{keywordflow}{else}}
\DoxyCodeLine{1030                         ubar0(:) = (+spb2\_(ubar0,pmom1)+quarks(2)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{1031 \textcolor{keywordflow}{                     endif}}
\DoxyCodeLine{1032 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{1033 }
\DoxyCodeLine{1034                   tmpquark(1)\%Mom  => pmom1(:)}
\DoxyCodeLine{1035                   tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{1036                   tmpquark(1)\%Mass => quarks(2)\%Mass}
\DoxyCodeLine{1037                   tmpquark(1)\%Mass2=> quarks(2)\%Mass2}
\DoxyCodeLine{1038                   tmpextref = -\/1}
\DoxyCodeLine{1039                   tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{1040                   tmpquark(1)\%PartType => quarks(2)\%PartType}
\DoxyCodeLine{1041                   counter=1}
\DoxyCodeLine{1042                   rin =1}
\DoxyCodeLine{1043                   rout=n1a}
\DoxyCodeLine{1044                   \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{1045                      \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{1046                      counter=counter+1}
\DoxyCodeLine{1047 \textcolor{keywordflow}{                  enddo}}
\DoxyCodeLine{1048                   rin =numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{1049                   rout=numglu(0)}
\DoxyCodeLine{1050                   \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{1051                      \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{1052                      counter=counter+1}
\DoxyCodeLine{1053 \textcolor{keywordflow}{                  enddo}}
\DoxyCodeLine{1054                   tmp(:) = cur\_f\_2f(tmpgluons(1:counter-\/1),tmpquark(1:1),-\/tmpquark(1)\%PartType,(/counter-\/1,n1a,n4b/) )}
\DoxyCodeLine{1055                   res(:) = res(:) + tmp(:)}
\DoxyCodeLine{1056 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{1057 }
\DoxyCodeLine{1058                 \textcolor{comment}{! Fer 3}}
\DoxyCodeLine{1059                 \textcolor{keywordflow}{if} (bosonvertex .eq. 1 .or. bosonvertex .eq. 4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1060                    rin =n1a+1}
\DoxyCodeLine{1061                    rout=numglu(1)+n2a}
\DoxyCodeLine{1062                    ubar1(:) = cur\_f\_2f(gluons(rin:rout),quarks(2:2),-\/quarks(2)\%PartType,(/n2a+n1b,n1b,n2a/) )}
\DoxyCodeLine{1063                    \textcolor{keywordflow}{if}(n1b.ge.1 .or. n2a.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1064                       pmom2(:) = quarks(2)\%Mom + summom(gluons,rin,rout)  \textcolor{comment}{! can be moved outside the n1a-\/loop}}
\DoxyCodeLine{1065                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{1066                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{1067                       \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1068                          ubar1(:) = (-\/spi2\_(pmom2,ubar1)+quarks(2)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{1069                       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1070                          ubar1(:) = (+spb2\_(ubar1,pmom2)+quarks(2)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{1071 \textcolor{keywordflow}{                      endif}}
\DoxyCodeLine{1072 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1073                    \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1074                       ubar0(:) = vbqg(ubar1,eps2)}
\DoxyCodeLine{1075                    \textcolor{keywordflow}{else}}
\DoxyCodeLine{1076                       ubar0(:) = vqg(ubar1,eps2)}
\DoxyCodeLine{1077 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1078 }
\DoxyCodeLine{1079                    pmom1 = quarks(2)\%Mom+quarks(3)\%Mom+quarks(4)\%Mom+summom(gluons,n1a+1,numglu(1)+numglu(2)+numglu(3)+n4a)}
\DoxyCodeLine{1080                    propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{1081                    \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)-\/quarks(2)\%Mass2).lt.propcut ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1082                       propfac1=(0d0,0d0)}
\DoxyCodeLine{1083 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1084                    \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1085                       ubar0(:) = (-\/spi2\_(pmom1,ubar0)+quarks(2)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{1086                    \textcolor{keywordflow}{else}}
\DoxyCodeLine{1087                       ubar0(:) = (+spb2\_(ubar0,pmom1)+quarks(2)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{1088 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1089 }
\DoxyCodeLine{1090                    tmpquark(1)\%Mom  => pmom1(:)}
\DoxyCodeLine{1091                    tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{1092                    tmpquark(1)\%Mass => quarks(2)\%Mass}
\DoxyCodeLine{1093                    tmpquark(1)\%Mass2=> quarks(2)\%Mass2}
\DoxyCodeLine{1094                    tmpextref = -\/1}
\DoxyCodeLine{1095                    tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{1096                    tmpquark(1)\%PartType => quarks(2)\%PartType}
\DoxyCodeLine{1097                    counter=1}
\DoxyCodeLine{1098                    rin =1}
\DoxyCodeLine{1099                    rout=n1a}
\DoxyCodeLine{1100                    \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{1101                       \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{1102                       counter=counter+1}
\DoxyCodeLine{1103 \textcolor{keywordflow}{                   enddo}}
\DoxyCodeLine{1104                    rin =numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{1105                    rout=numglu(0)}
\DoxyCodeLine{1106                    \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{1107                       \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{1108                       counter=counter+1}
\DoxyCodeLine{1109 \textcolor{keywordflow}{                   enddo}}
\DoxyCodeLine{1110                    tmp(:) = cur\_f\_2fv(tmpgluons(1:counter-\/1),tmpquark(1:1),-\/tmpquark(1)\%PartType,boson,(/counter-\/1,n1a,n4b/) )}
\DoxyCodeLine{1111                    res(:) = res(:) + tmp(:)}
\DoxyCodeLine{1112 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{1113 }
\DoxyCodeLine{1114                 \textcolor{keywordflow}{if} (bosonvertex .eq. 3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1115                    rin =n1a+1}
\DoxyCodeLine{1116                    rout=numglu(1)+n2a}
\DoxyCodeLine{1117                    ubar1(:) = cur\_f\_2f(gluons(rin:rout),quarks(2:2),-\/quarks(2)\%PartType,(/n2a+n1b,n1b,n2a/) )}
\DoxyCodeLine{1118                    \textcolor{keywordflow}{if}(n1b.ge.1 .or. n2a.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1119                       pmom2(:) = quarks(2)\%Mom + summom(gluons,rin,rout)  \textcolor{comment}{! can be moved outside the n1a-\/loop}}
\DoxyCodeLine{1120                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{1121                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2).lt.propcut ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1122                          propfac2=(0d0,0d0)}
\DoxyCodeLine{1123 \textcolor{keywordflow}{                      endif}}
\DoxyCodeLine{1124                       \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1125                          ubar1(:) = (-\/spi2\_(pmom2,ubar1)+quarks(2)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{1126                       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1127                          ubar1(:) = (+spb2\_(ubar1,pmom2)+quarks(2)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{1128 \textcolor{keywordflow}{                      endif}}
\DoxyCodeLine{1129 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1130                    \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1131                       ubar0(:) = vbqg(ubar1,eps2)}
\DoxyCodeLine{1132                    \textcolor{keywordflow}{else}}
\DoxyCodeLine{1133                       ubar0(:) = vqg(ubar1,eps2)}
\DoxyCodeLine{1134 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1135 }
\DoxyCodeLine{1136                    pmom1 = quarks(2)\%Mom+quarks(3)\%Mom+quarks(4)\%Mom+summom(gluons,n1a+1,numglu(1)+numglu(2)+numglu(3)+n4a)+boson\%Mom}
\DoxyCodeLine{1137                    \textcolor{keywordflow}{if}(n1a.ge.1 .or. n4b.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1138                       propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{1139                       \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)-\/quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{1140                       \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1141                          ubar0(:) = (-\/spi2\_(pmom1,ubar0)+quarks(2)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{1142                       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1143                          ubar0(:) = (+spb2\_(ubar0,pmom1)+quarks(2)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{1144 \textcolor{keywordflow}{                      endif}}
\DoxyCodeLine{1145 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1146 }
\DoxyCodeLine{1147                    tmpquark(1)\%Mom  => pmom1(:)}
\DoxyCodeLine{1148                    tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{1149                    tmpquark(1)\%Mass => quarks(2)\%Mass}
\DoxyCodeLine{1150                    tmpquark(1)\%Mass2=> quarks(2)\%Mass2}
\DoxyCodeLine{1151                    tmpextref = -\/1}
\DoxyCodeLine{1152                    tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{1153                    tmpquark(1)\%PartType => quarks(2)\%PartType}
\DoxyCodeLine{1154                    counter=1}
\DoxyCodeLine{1155                    rin =1}
\DoxyCodeLine{1156                    rout=n1a}
\DoxyCodeLine{1157                    \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{1158                       \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{1159                       counter=counter+1}
\DoxyCodeLine{1160 \textcolor{keywordflow}{                   enddo}}
\DoxyCodeLine{1161                    rin =numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{1162                    rout=numglu(0)}
\DoxyCodeLine{1163                    \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{1164                       \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{1165                       counter=counter+1}
\DoxyCodeLine{1166 \textcolor{keywordflow}{                   enddo}}
\DoxyCodeLine{1167                    tmp(:) = cur\_f\_2f(tmpgluons(1:counter-\/1),tmpquark(1:1),-\/tmpquark(1)\%PartType,(/counter-\/1,n1a,n4b/) )}
\DoxyCodeLine{1168                    res(:) = res(:) + tmp(:)}
\DoxyCodeLine{1169 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{1170 \textcolor{keywordflow}{             enddo}}
\DoxyCodeLine{1171 \textcolor{keywordflow}{          enddo}}
\DoxyCodeLine{1172 \textcolor{keywordflow}{       enddo}}
\DoxyCodeLine{1173 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{1174 }
\DoxyCodeLine{1175 }
\DoxyCodeLine{1176     \textcolor{keywordflow}{if}( (quark1parttype.eq.-\/quarks(4)\%PartType .and. quarks(2)\%PartType.eq.-\/quarks(3)\%PartType)      .AND.  \&}
\DoxyCodeLine{1177          (quarks(4)\%ExtRef.ne.-\/1 .or. tag\_f.ne.1 .or. abs(quark1parttype).ne.abs(quarks(2)\%PartType)) ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1178 }
\DoxyCodeLine{1179        \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{1180           \textcolor{keywordflow}{do} n3a=0,numglu(3)}
\DoxyCodeLine{1181              n1b = numglu(1)-\/n1a}
\DoxyCodeLine{1182              n3b = numglu(3)-\/n3a}
\DoxyCodeLine{1183 }
\DoxyCodeLine{1184              rin =n1a+1}
\DoxyCodeLine{1185              rout=numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{1186 }
\DoxyCodeLine{1187 \textcolor{comment}{! This means that all the ext gluons are on this lines,}}
\DoxyCodeLine{1188 \textcolor{comment}{! and we must remove this to prevent color issues with a Z on the quark loop, see RR notes}}
\DoxyCodeLine{1189 }
\DoxyCodeLine{1190              \textcolor{keywordflow}{if} (bosonvertex.eq.1 .or. bosonvertex.eq.3 .or. bosonvertex.eq.4)  \textcolor{keywordflow}{then}}
\DoxyCodeLine{1191                 \textcolor{keywordflow}{if} ( tag\_z .eq. 1 .and. n1b+numglu(2)+n3a .eq. numglu(0) ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1192 \textcolor{comment}{!                     print  * , "cycle for tag\_Z=1 in cur\_f\_4fV"}}
\DoxyCodeLine{1193                     cycle}
\DoxyCodeLine{1194 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{1195                 eps2 = cur\_g\_2f(gluons(rin:rout),quarks(2:3),(/1+n1b+numglu(2)+n3a,n1b,numglu(2),n3a/))}
\DoxyCodeLine{1196                 pmom1(:) = summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{1197              \textcolor{keywordflow}{elseif} (bosonvertex .eq. 2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1198                 eps2 = cur\_g\_2fv(gluons(rin:rout),quarks(2:3),boson,(/1+n1b+numglu(2)+n3a,n1b,numglu(2),n3a/))}
\DoxyCodeLine{1199                 pmom1(:) = summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom + boson\%Mom}
\DoxyCodeLine{1200 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{1201              propfac1 = (0d0,-\/1d0)/sc\_(pmom1,pmom1)}
\DoxyCodeLine{1202              \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)).lt.propcut ) cycle}
\DoxyCodeLine{1203              eps2 = eps2*propfac1}
\DoxyCodeLine{1204 }
\DoxyCodeLine{1205              \textcolor{keywordflow}{do} n4a=0,numglu(4)}
\DoxyCodeLine{1206                 n4b = numglu(4)-\/n4a}
\DoxyCodeLine{1207                 \textcolor{comment}{! radiate V off Fer4}}
\DoxyCodeLine{1208                 \textcolor{keywordflow}{if} (bosonvertex .eq. 3 .or. bosonvertex .eq. 4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1209                    rin =numglu(1)+numglu(2)+n3a+1}
\DoxyCodeLine{1210                    rout=numglu(1)+numglu(2)+numglu(3)+n4a}
\DoxyCodeLine{1211 }
\DoxyCodeLine{1212                    ubar1(:) = cur\_f\_2fv(gluons(rin:rout),quarks(4:4),-\/quarks(4)\%PartType,boson,(/n3b+n4a,n3b,n4a/) )}
\DoxyCodeLine{1213                    pmom2(:) = quarks(4)\%Mom(:) + summom(gluons,rin,rout) + boson\%Mom(:)}
\DoxyCodeLine{1214                    propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2)-\/quarks(4)\%Mass2)}
\DoxyCodeLine{1215                    \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2)-\/quarks(4)\%Mass2).lt.propcut ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1216                       propfac2=(0d0,0d0)}
\DoxyCodeLine{1217 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1218 }
\DoxyCodeLine{1219                    \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1220                       ubar1(:) = (-\/spi2\_(pmom2,ubar1)+quarks(4)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{1221                    \textcolor{keywordflow}{else}}
\DoxyCodeLine{1222                       ubar1(:) = (+spb2\_(ubar1,pmom2)+quarks(4)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{1223 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1224                    \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1225                       ubar0(:) = vgbq(eps2,ubar1)}
\DoxyCodeLine{1226                    \textcolor{keywordflow}{else}}
\DoxyCodeLine{1227                       ubar0(:) = vgq(eps2,ubar1)}
\DoxyCodeLine{1228 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1229 }
\DoxyCodeLine{1230                    pmom1 = quarks(2)\%Mom+quarks(3)\%Mom+quarks(4)\%Mom+summom(gluons,n1a+1,numglu(1)+numglu(2)+numglu(3)+n4a) + boson\%Mom(:)}
\DoxyCodeLine{1231                    \textcolor{keywordflow}{if}(n1a.ge.1 .or. n4b.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1232                       propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1)-\/quarks(4)\%Mass2)}
\DoxyCodeLine{1233                       \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)-\/quarks(4)\%Mass2).lt.propcut ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1234                          propfac1=(0d0,0d0)}
\DoxyCodeLine{1235 \textcolor{keywordflow}{                      endif}}
\DoxyCodeLine{1236                       \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1237                          ubar0(:) = (-\/spi2\_(pmom1,ubar0)+quarks(4)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{1238                       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1239                          ubar0(:) = (+spb2\_(ubar0,pmom1)+quarks(4)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{1240 \textcolor{keywordflow}{                      endif}}
\DoxyCodeLine{1241 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1242 }
\DoxyCodeLine{1243                    tmpquark(1)\%Mom  => pmom1(:)}
\DoxyCodeLine{1244                    tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{1245                    tmpquark(1)\%Mass => quarks(4)\%Mass}
\DoxyCodeLine{1246                    tmpquark(1)\%Mass2=> quarks(4)\%Mass2}
\DoxyCodeLine{1247                    tmpextref = -\/1}
\DoxyCodeLine{1248                    tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{1249                    tmpquark(1)\%PartType => quarks(4)\%PartType}
\DoxyCodeLine{1250                    counter=1}
\DoxyCodeLine{1251                    rin =1}
\DoxyCodeLine{1252                    rout=n1a}
\DoxyCodeLine{1253                    \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{1254                       \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{1255                       counter=counter+1}
\DoxyCodeLine{1256 \textcolor{keywordflow}{                   enddo}}
\DoxyCodeLine{1257                    rin =numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{1258                    rout=numglu(0)}
\DoxyCodeLine{1259                    \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{1260                       \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{1261                       counter=counter+1}
\DoxyCodeLine{1262 \textcolor{keywordflow}{                   enddo}}
\DoxyCodeLine{1263                    tmp(:) = cur\_f\_2f(tmpgluons(1:counter-\/1),tmpquark(1:1),-\/tmpquark(1)\%PartType,(/counter-\/1,n1a,n4b/) )}
\DoxyCodeLine{1264                    res(:) = res(:) + tmp(:)}
\DoxyCodeLine{1265 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{1266 }
\DoxyCodeLine{1267                 \textcolor{keywordflow}{if} (bosonvertex .eq. 1 .or. bosonvertex .eq. 4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1268                    \textcolor{comment}{! radiate V off Fer1}}
\DoxyCodeLine{1269                    rin =numglu(1)+numglu(2)+n3a+1}
\DoxyCodeLine{1270                    rout=numglu(1)+numglu(2)+numglu(3)+n4a}
\DoxyCodeLine{1271                    ubar1(:) = cur\_f\_2f(gluons(rin:rout),quarks(4:4),-\/quarks(4)\%PartType,(/n3b+n4a,n3b,n4a/) )}
\DoxyCodeLine{1272                    \textcolor{keywordflow}{if}(n3b.ge.1 .or. n4a.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1273                       pmom2(:) = quarks(4)\%Mom + summom(gluons,rin,rout)  \textcolor{comment}{! can be moved outside the n1a-\/loop}}
\DoxyCodeLine{1274                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2)-\/quarks(4)\%Mass2)}
\DoxyCodeLine{1275                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2)-\/quarks(4)\%Mass2).lt.propcut ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1276                          propfac2=(0d0,0d0)}
\DoxyCodeLine{1277 \textcolor{keywordflow}{                      endif}}
\DoxyCodeLine{1278 }
\DoxyCodeLine{1279                       \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1280                          ubar1(:) = (-\/spi2\_(pmom2,ubar1)+quarks(4)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{1281                       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1282                          ubar1(:) = (+spb2\_(ubar1,pmom2)+quarks(4)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{1283 \textcolor{keywordflow}{                      endif}}
\DoxyCodeLine{1284 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1285                    \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1286                       ubar0(:) = vgbq(eps2,ubar1)}
\DoxyCodeLine{1287                    \textcolor{keywordflow}{else}}
\DoxyCodeLine{1288                       ubar0(:) = vgq(eps2,ubar1)}
\DoxyCodeLine{1289 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1290 }
\DoxyCodeLine{1291                    pmom1 = quarks(2)\%Mom+quarks(3)\%Mom+quarks(4)\%Mom+summom(gluons,n1a+1,numglu(1)+numglu(2)+numglu(3)+n4a)}
\DoxyCodeLine{1292                    propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1)-\/quarks(4)\%Mass2)}
\DoxyCodeLine{1293                    \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)-\/quarks(4)\%Mass2).lt.propcut ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1294                       propfac1=(0d0,0d0)}
\DoxyCodeLine{1295 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1296                    \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1297                       ubar0(:) = (-\/spi2\_(pmom1,ubar0)+quarks(4)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{1298                    \textcolor{keywordflow}{else}}
\DoxyCodeLine{1299                       ubar0(:) = (+spb2\_(ubar0,pmom1)+quarks(4)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{1300 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1301 }
\DoxyCodeLine{1302                    tmpquark(1)\%Mom  => pmom1(:)}
\DoxyCodeLine{1303                    tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{1304                    tmpquark(1)\%Mass => quarks(4)\%Mass}
\DoxyCodeLine{1305                    tmpquark(1)\%Mass2=> quarks(4)\%Mass2}
\DoxyCodeLine{1306                    tmpextref = -\/1}
\DoxyCodeLine{1307                    tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{1308                    tmpquark(1)\%PartType => quarks(4)\%PartType}
\DoxyCodeLine{1309                    counter=1}
\DoxyCodeLine{1310                    rin =1}
\DoxyCodeLine{1311                    rout=n1a}
\DoxyCodeLine{1312                    \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{1313                       \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{1314                       counter=counter+1}
\DoxyCodeLine{1315 \textcolor{keywordflow}{                   enddo}}
\DoxyCodeLine{1316                    rin =numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{1317                    rout=numglu(0)}
\DoxyCodeLine{1318                    \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{1319                       \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{1320                       counter=counter+1}
\DoxyCodeLine{1321 \textcolor{keywordflow}{                   enddo}}
\DoxyCodeLine{1322                    tmp(:) = cur\_f\_2fv(tmpgluons(1:counter-\/1),tmpquark(1:1),-\/tmpquark(1)\%PartType,boson,(/counter-\/1,n1a,n4b/) )}
\DoxyCodeLine{1323                    res(:) = res(:) + tmp(:)}
\DoxyCodeLine{1324 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{1325 }
\DoxyCodeLine{1326 }
\DoxyCodeLine{1327                 \textcolor{keywordflow}{if} (bosonvertex .eq. 2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1328                    rin =numglu(1)+numglu(2)+n3a+1}
\DoxyCodeLine{1329                    rout=numglu(1)+numglu(2)+numglu(3)+n4a}
\DoxyCodeLine{1330                    ubar1(:) = cur\_f\_2f(gluons(rin:rout),quarks(4:4),-\/quarks(4)\%PartType,(/n3b+n4a,n3b,n4a/) )}
\DoxyCodeLine{1331                    \textcolor{keywordflow}{if} ( n3b .ge. 1 .or. n4a .ge. 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1332                       pmom2(:) = quarks(4)\%Mom(:) + summom(gluons,rin,rout)}
\DoxyCodeLine{1333                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2)-\/quarks(4)\%Mass2)}
\DoxyCodeLine{1334 }
\DoxyCodeLine{1335                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2)-\/quarks(4)\%Mass2).lt.propcut ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1336                          propfac2=(0d0,0d0)}
\DoxyCodeLine{1337 \textcolor{keywordflow}{                      endif}}
\DoxyCodeLine{1338 }
\DoxyCodeLine{1339                       \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1340                          ubar1(:) = (-\/spi2\_(pmom2,ubar1)+quarks(4)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{1341                       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1342                          ubar1(:) = (+spb2\_(ubar1,pmom2)+quarks(4)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{1343 \textcolor{keywordflow}{                      endif}}
\DoxyCodeLine{1344 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1345                    \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1346                       ubar0(:) = vgbq(eps2,ubar1)}
\DoxyCodeLine{1347                    \textcolor{keywordflow}{else}}
\DoxyCodeLine{1348                       ubar0(:) = vgq(eps2,ubar1)}
\DoxyCodeLine{1349 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1350                    pmom1 = quarks(2)\%Mom+quarks(3)\%Mom+quarks(4)\%Mom+summom(gluons,n1a+1,numglu(1)+numglu(2)+numglu(3)+n4a)+boson\%Mom}
\DoxyCodeLine{1351                    \textcolor{keywordflow}{if}(n1a.ge.1 .or. n4b.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1352                       propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1)-\/quarks(4)\%Mass2)}
\DoxyCodeLine{1353                       \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)-\/quarks(4)\%Mass2).lt.propcut ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1354                          cycle}
\DoxyCodeLine{1355 \textcolor{keywordflow}{                      endif}}
\DoxyCodeLine{1356                       \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1357                          ubar0(:) = (-\/spi2\_(pmom1,ubar0)+quarks(4)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{1358                       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1359                          ubar0(:) = (+spb2\_(ubar0,pmom1)+quarks(4)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{1360 \textcolor{keywordflow}{                      endif}}
\DoxyCodeLine{1361 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{1362 }
\DoxyCodeLine{1363                    tmpquark(1)\%Mom  => pmom1(:)}
\DoxyCodeLine{1364                    tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{1365                    tmpquark(1)\%Mass => quarks(4)\%Mass}
\DoxyCodeLine{1366                    tmpquark(1)\%Mass2=> quarks(4)\%Mass2}
\DoxyCodeLine{1367                    tmpextref = -\/1}
\DoxyCodeLine{1368                    tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{1369                    tmpquark(1)\%PartType => quarks(4)\%PartType}
\DoxyCodeLine{1370                    counter=1}
\DoxyCodeLine{1371                    rin =1}
\DoxyCodeLine{1372                    rout=n1a}
\DoxyCodeLine{1373                    \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{1374                       \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{1375                       counter=counter+1}
\DoxyCodeLine{1376 \textcolor{keywordflow}{                   enddo}}
\DoxyCodeLine{1377                    rin =numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{1378                    rout=numglu(0)}
\DoxyCodeLine{1379                    \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{1380                       \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{1381                       counter=counter+1}
\DoxyCodeLine{1382 \textcolor{keywordflow}{                   enddo}}
\DoxyCodeLine{1383                    tmp(:) = cur\_f\_2f(tmpgluons(1:counter-\/1),tmpquark(1:1),-\/tmpquark(1)\%PartType,(/counter-\/1,n1a,n4b/) )}
\DoxyCodeLine{1384                    res(:) = res(:) + tmp(:)}
\DoxyCodeLine{1385 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{1386 \textcolor{keywordflow}{             enddo}}
\DoxyCodeLine{1387 \textcolor{keywordflow}{          enddo}}
\DoxyCodeLine{1388 \textcolor{keywordflow}{       enddo}}
\DoxyCodeLine{1389 }
\DoxyCodeLine{1390 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{1391 }
\DoxyCodeLine{1392     \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_ae785e0d6b1486d410b4df20499e9f48f}\label{namespacemodttbhiggs_ae785e0d6b1486d410b4df20499e9f48f}} 
\index{modttbhiggs@{modttbhiggs}!cur\_f\_6f@{cur\_f\_6f}}
\index{cur\_f\_6f@{cur\_f\_6f}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{cur\_f\_6f()}{cur\_f\_6f()}}
{\footnotesize\ttfamily complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}}) modttbhiggs\+::cur\+\_\+f\+\_\+6f (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(1\+:)}]{Gluons,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(2\+:6)}]{Quarks,  }\item[{integer}]{Quark1\+Part\+Type,  }\item[{integer, dimension(0\+:6)}]{Num\+Glu,  }\item[{integer}]{tag\+\_\+f,  }\item[{integer}]{tag\+\_\+Z }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 2654 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2654 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{2655 \textcolor{keywordtype}{integer} :: NumGlu(0:6),Quark1PartType,tag\_f,tag\_Z}
\DoxyCodeLine{2656 \textcolor{keywordtype}{type}(PtrToParticle) :: Gluons(1:),Quarks(2:6)}
\DoxyCodeLine{2657 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{target} :: TmpPartType,TmpExtRef}
\DoxyCodeLine{2658 \textcolor{keywordtype}{complex(8)} :: Res(1:Ds),tmp(1:Ds)}
\DoxyCodeLine{2659 \textcolor{comment}{! complex(8) :: Res1(1:Ds),Res2(1:Ds),Res3(1:Ds),Res4(1:Ds)}}
\DoxyCodeLine{2660 \textcolor{keywordtype}{complex(8)} :: u1(1:Ds),ubar1(1:Ds)}
\DoxyCodeLine{2661 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: ubar0(1:Ds)}
\DoxyCodeLine{2662 \textcolor{keywordtype}{complex(8)} :: eps1(1:Dv)}
\DoxyCodeLine{2663 \textcolor{keywordtype}{complex(8)} :: eps2(1:Dv)}
\DoxyCodeLine{2664 \textcolor{keywordtype}{type}(PtrToParticle) :: TmpGluons(1:NumGlu(1)+NumGlu(6)),TmpQuark(1:1)}
\DoxyCodeLine{2665 \textcolor{keywordtype}{complex(8)} :: PropFac1,PropFac2}
\DoxyCodeLine{2666 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: PMom1(1:Dv)}
\DoxyCodeLine{2667 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: PMom2(1:Dv)}
\DoxyCodeLine{2668 \textcolor{keywordtype}{integer} :: n1a,n1b,n2a,n2b,n3a,n3b,n4a,n4b,n5a,n5b,n6a,n6b}
\DoxyCodeLine{2669 \textcolor{keywordtype}{integer} :: rIn,rOut,i,counter}
\DoxyCodeLine{2670 }
\DoxyCodeLine{2671 }
\DoxyCodeLine{2672 \textcolor{comment}{!DEC\$ IF (\_DebugCheckMyImpl1==1)}}
\DoxyCodeLine{2673     \textcolor{keywordflow}{if}( numglu(0)-\/numglu(1)-\/numglu(2)-\/numglu(3)-\/numglu(4)-\/numglu(5)-\/numglu(6).ne.0 ) print *, \textcolor{stringliteral}{"wrong number of gluons in cur\_f\_6f"}}
\DoxyCodeLine{2674 \textcolor{comment}{!DEC\$ ENDIF}}
\DoxyCodeLine{2675 }
\DoxyCodeLine{2676     res = (0d0,0d0)}
\DoxyCodeLine{2677 \textcolor{comment}{!     Res1=(0d0,0d0); Res2=(0d0,0d0); Res3=(0d0,0d0); Res4=(0d0,0d0);}}
\DoxyCodeLine{2678 }
\DoxyCodeLine{2679 }
\DoxyCodeLine{2680 \textcolor{comment}{!   (A)}}
\DoxyCodeLine{2681     \textcolor{keywordflow}{if}( quark1parttype.eq.-\/quarks(2)\%PartType .AND. (quarks(3)\%PartType.eq.-\/quarks(4)\%PartType .or. quarks(3)\%PartType.eq.-\/quarks(6)\%PartType) \&}
\DoxyCodeLine{2682         .AND. (quarks(2)\%ExtRef.ne.-\/1 .or. tag\_f.ne.1) \&}
\DoxyCodeLine{2683       ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2684 }
\DoxyCodeLine{2685       \textcolor{keywordflow}{do} n2a=0,numglu(2)}
\DoxyCodeLine{2686       \textcolor{keywordflow}{do} n6a=0,numglu(6)}
\DoxyCodeLine{2687          n2b = numglu(2)-\/n2a}
\DoxyCodeLine{2688          n6b = numglu(6)-\/n6a}
\DoxyCodeLine{2689 }
\DoxyCodeLine{2690          rin =numglu(1)+n2a+1}
\DoxyCodeLine{2691          rout=numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{2692          eps2 = cur\_g\_4f(gluons(rin:rout),quarks(3:6),(/1+n2b+numglu(3)+numglu(4)+numglu(5)+n6a,n2b,numglu(3),numglu(4),numglu(5),n6a/))}
\DoxyCodeLine{2693          pmom1(:) = summom(gluons,rin,rout) + quarks(3)\%Mom + quarks(4)\%Mom + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{2694          propfac1 = (0d0,-\/1d0)/sc\_(pmom1,pmom1)}
\DoxyCodeLine{2695          \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)).lt.propcut) cycle}
\DoxyCodeLine{2696          eps2 = eps2*propfac1}
\DoxyCodeLine{2697          \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{2698             n1b = numglu(1)-\/n1a}
\DoxyCodeLine{2699             \textcolor{comment}{! Fer2}}
\DoxyCodeLine{2700             rin =n1a+1}
\DoxyCodeLine{2701             rout=numglu(1)+n2a}
\DoxyCodeLine{2702             ubar1(:) = cur\_f\_2f(gluons(rin:rout),quarks(2:2),-\/quarks(2)\%PartType,(/n1b+n2a,n1b,n2a/) )}
\DoxyCodeLine{2703             \textcolor{keywordflow}{if}(n1b.ge.1 .or. n2a.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2704                pmom2(:) = quarks(2)\%Mom + summom(gluons,rin,rout)}
\DoxyCodeLine{2705                propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{2706                \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2707                \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2708                   ubar1(:) = (-\/spi2\_(pmom2,ubar1)+quarks(2)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{2709                \textcolor{keywordflow}{else}}
\DoxyCodeLine{2710                   ubar1(:) = (+spb2\_(ubar1,pmom2)+quarks(2)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{2711 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{2712 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2713             \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2714                ubar0(:) = vbqg(ubar1,eps2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2715             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2716                ubar0(:) = vqg(ubar1,eps2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2717 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2718 }
\DoxyCodeLine{2719             rin = n1a+1}
\DoxyCodeLine{2720             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{2721             pmom1 = summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom + quarks(4)\%Mom + quarks(5)\%Mom + quarks(6)\%Mom  \textcolor{comment}{! can be simplified with PMom1(:)}}
\DoxyCodeLine{2722             \textcolor{keywordflow}{if}(n1a.ge.1 .or. n6b.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2723                propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{2724                \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)-\/quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2725                \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2726                   ubar0(:) = (-\/spi2\_(pmom1,ubar0)+quarks(2)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{2727                \textcolor{keywordflow}{else}}
\DoxyCodeLine{2728                   ubar0(:) = (+spb2\_(ubar0,pmom1)+quarks(2)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{2729 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{2730 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2731 }
\DoxyCodeLine{2732             tmpquark(1)\%Mom  => pmom1(:)}
\DoxyCodeLine{2733             tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{2734             tmpquark(1)\%Mass => quarks(2)\%Mass}
\DoxyCodeLine{2735             tmpquark(1)\%Mass2=> quarks(2)\%Mass2}
\DoxyCodeLine{2736             tmpextref = -\/1}
\DoxyCodeLine{2737             tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{2738             tmpquark(1)\%PartType => quarks(2)\%PartType}
\DoxyCodeLine{2739             counter=1}
\DoxyCodeLine{2740             rin =1}
\DoxyCodeLine{2741             rout=n1a}
\DoxyCodeLine{2742             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2743               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2744               counter=counter+1}
\DoxyCodeLine{2745 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{2746             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a+1}
\DoxyCodeLine{2747             rout=numglu(0)}
\DoxyCodeLine{2748             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2749               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2750               counter=counter+1}
\DoxyCodeLine{2751 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{2752             tmp(:) = cur\_f\_2f(tmpgluons(1:counter-\/1),tmpquark(1:1),-\/tmpquark(1)\%PartType,(/counter-\/1,n1a,n6b/) )}
\DoxyCodeLine{2753 }
\DoxyCodeLine{2754             res(:) = res(:) + tmp(:)}
\DoxyCodeLine{2755 \textcolor{comment}{!             Res1(:) = Res1(:) + tmp(:)}}
\DoxyCodeLine{2756 \textcolor{comment}{!             print *, "1",tmp(:)}}
\DoxyCodeLine{2757 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{2758 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{2759 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{2760 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{2761 }
\DoxyCodeLine{2762 }
\DoxyCodeLine{2763 }
\DoxyCodeLine{2764 \textcolor{comment}{!   (B)}}
\DoxyCodeLine{2765     \textcolor{keywordflow}{if}( quark1parttype.eq.-\/quarks(6)\%PartType .AND. (quarks(2)\%PartType.eq.-\/quarks(5)\%PartType .or. quarks(2)\%PartType.eq.-\/quarks(3)\%PartType) \&}
\DoxyCodeLine{2766         .AND. (quarks(6)\%ExtRef.ne.-\/1 .or. tag\_f.ne.1) \&}
\DoxyCodeLine{2767       ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2768       \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{2769       \textcolor{keywordflow}{do} n5b=0,numglu(5)}
\DoxyCodeLine{2770          n1b = numglu(1)-\/n1a}
\DoxyCodeLine{2771          n5a = numglu(5)-\/n5b}
\DoxyCodeLine{2772 }
\DoxyCodeLine{2773          rin =n1a+1}
\DoxyCodeLine{2774          rout=numglu(1)+numglu(2)+numglu(3)+numglu(4)+n5a}
\DoxyCodeLine{2775 }
\DoxyCodeLine{2776 \textcolor{comment}{! preventing color issues with Z on the loop, see RR notes 05-\/22-\/2013}}
\DoxyCodeLine{2777 \textcolor{comment}{!note: only tested for zero gluons}}
\DoxyCodeLine{2778          \textcolor{keywordflow}{if} ( tag\_z .eq. 1 .and. (n1b+numglu(2)+numglu(3)+numglu(4)+n5a .eq. numglu(0)) ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2779 \textcolor{comment}{!             print  * , "cycle for tag\_Z=1 in cur\_f\_6f"}}
\DoxyCodeLine{2780             cycle}
\DoxyCodeLine{2781 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{2782 }
\DoxyCodeLine{2783          eps2 = cur\_g\_4f(gluons(rin:rout),quarks(2:5),(/1+n1b+numglu(2)+numglu(3)+numglu(4)+n5a,n1b,numglu(2),numglu(3),numglu(4),n5a/))}
\DoxyCodeLine{2784          pmom1(:) = summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom + quarks(4)\%Mom + quarks(5)\%Mom}
\DoxyCodeLine{2785          propfac1 = (0d0,-\/1d0)/sc\_(pmom1,pmom1)}
\DoxyCodeLine{2786          \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)).lt.propcut ) cycle}
\DoxyCodeLine{2787          eps2 = eps2*propfac1}
\DoxyCodeLine{2788 }
\DoxyCodeLine{2789          \textcolor{keywordflow}{do} n6a=0,numglu(6)}
\DoxyCodeLine{2790             n6b = numglu(6)-\/n6a}
\DoxyCodeLine{2791             \textcolor{comment}{! Fer6}}
\DoxyCodeLine{2792             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+n5a+1}
\DoxyCodeLine{2793             rout=numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{2794             ubar1(:) = cur\_f\_2f(gluons(rin:rout),quarks(6:6),-\/quarks(6)\%PartType,(/n5b+n6a,n5b,n6a/) )}
\DoxyCodeLine{2795             \textcolor{keywordflow}{if}(n5b.ge.1 .or. n6a.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2796                pmom2(:) = summom(gluons,rin,rout) + quarks(6)\%Mom}
\DoxyCodeLine{2797                propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2)-\/quarks(6)\%Mass2)}
\DoxyCodeLine{2798                \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2)-\/quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2799                \textcolor{keywordflow}{if}( quarks(6)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2800                   ubar1(:) = (-\/spi2\_(pmom2,ubar1)+quarks(6)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{2801                \textcolor{keywordflow}{else}}
\DoxyCodeLine{2802                   ubar1(:) = (+spb2\_(ubar1,pmom2)+quarks(6)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{2803 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{2804 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2805             \textcolor{keywordflow}{if}( quarks(6)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2806                ubar0(:) = vgbq(eps2,ubar1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2807             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2808                ubar0(:) = vgq(eps2,ubar1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2809 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2810 }
\DoxyCodeLine{2811             rin = n1a+1}
\DoxyCodeLine{2812             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{2813             pmom1 = summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom + quarks(4)\%Mom + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{2814             \textcolor{keywordflow}{if}(n1a.ge.1 .or. n6b.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2815                propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1)-\/quarks(6)\%Mass2)}
\DoxyCodeLine{2816                \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)-\/quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2817                \textcolor{keywordflow}{if}( quarks(6)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2818                   ubar0(:) = (-\/spi2\_(pmom1,ubar0)+quarks(6)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{2819                \textcolor{keywordflow}{else}}
\DoxyCodeLine{2820                   ubar0(:) = (+spb2\_(ubar0,pmom1)+quarks(6)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{2821 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{2822 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2823             tmpquark(1)\%Mom => pmom1(:)}
\DoxyCodeLine{2824             tmpquark(1)\%Pol => ubar0(:)}
\DoxyCodeLine{2825             tmpquark(1)\%Mass => quarks(6)\%Mass}
\DoxyCodeLine{2826             tmpquark(1)\%Mass2=> quarks(6)\%Mass2}
\DoxyCodeLine{2827             tmpextref = -\/1}
\DoxyCodeLine{2828             tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{2829             tmpquark(1)\%PartType => quarks(6)\%PartType}
\DoxyCodeLine{2830             counter=1}
\DoxyCodeLine{2831             rin =1}
\DoxyCodeLine{2832             rout=n1a}
\DoxyCodeLine{2833             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2834               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2835               counter=counter+1}
\DoxyCodeLine{2836 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{2837             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a+1}
\DoxyCodeLine{2838             rout=numglu(0)}
\DoxyCodeLine{2839             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2840               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2841               counter=counter+1}
\DoxyCodeLine{2842 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{2843             tmp(:) = cur\_f\_2f(tmpgluons(1:counter-\/1),tmpquark(1:1),quark1parttype,(/counter-\/1,n1a,n6b/) )}
\DoxyCodeLine{2844 }
\DoxyCodeLine{2845             res(:) = res(:) + tmp(:)}
\DoxyCodeLine{2846 }
\DoxyCodeLine{2847 \textcolor{comment}{!             Res2(:) = Res2(:) + tmp(:)}}
\DoxyCodeLine{2848 }
\DoxyCodeLine{2849 \textcolor{comment}{!             print *, "2",tmp(:)}}
\DoxyCodeLine{2850 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{2851 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{2852 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{2853 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{2854 }
\DoxyCodeLine{2855 }
\DoxyCodeLine{2856 }
\DoxyCodeLine{2857 }
\DoxyCodeLine{2858 \textcolor{comment}{!   (C)}}
\DoxyCodeLine{2859 \textcolor{comment}{!     if( Quarks(5)\%PartType.eq.-\/Quarks(6)\%PartType .AND. (Quark1PartType.eq.-\/Quarks(2)\%PartType .or. Quark1PartType.eq.-\/Quarks(4)\%PartType) \&}}
\DoxyCodeLine{2860 \textcolor{comment}{!         .AND. .not.(Quarks(6)\%ExtRef.eq.-\/1 .and. tag\_f.eq.1) \&}}
\DoxyCodeLine{2861 \textcolor{comment}{!       ) then}}
\DoxyCodeLine{2862 \textcolor{comment}{!     if( Quark1PartType.eq.-\/Quarks(2)\%PartType .and. Quarks(5)\%PartType.eq.-\/Quarks(6)\%PartType .and..not.(Quarks(2)\%ExtRef.eq.-\/1 .and. tag\_f.eq.1) \&}}
\DoxyCodeLine{2863 \textcolor{comment}{!    .OR. Quark1PartType.eq.-\/Quarks(4)\%PartType .and. Quarks(5)\%PartType.eq.-\/Quarks(6)\%PartType .and..not.(Quarks(4)\%ExtRef.eq.-\/1 .and. tag\_f.eq.1) \&}}
\DoxyCodeLine{2864 \textcolor{comment}{!       ) then}}
\DoxyCodeLine{2865 }
\DoxyCodeLine{2866     \textcolor{keywordflow}{if}( quarks(5)\%PartType.eq.-\/quarks(6)\%PartType .AND. \&}
\DoxyCodeLine{2867         ((quark1parttype.eq.-\/quarks(2)\%PartType .and. (quarks(2)\%ExtRef.ne.-\/1.or.tag\_f.ne.1) ) \&}
\DoxyCodeLine{2868     .OR. (quark1parttype.eq.-\/quarks(4)\%PartType .and. (quarks(4)\%ExtRef.ne.-\/1.or.tag\_f.ne.1) ))\&}
\DoxyCodeLine{2869       ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2870 }
\DoxyCodeLine{2871       \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{2872       \textcolor{keywordflow}{do} n4a=0,numglu(4)}
\DoxyCodeLine{2873       \textcolor{keywordflow}{do} n6a=0,numglu(6)}
\DoxyCodeLine{2874          n1b = numglu(1)-\/n1a}
\DoxyCodeLine{2875          n4b = numglu(4)-\/n4a}
\DoxyCodeLine{2876          n6b = numglu(6)-\/n6a}
\DoxyCodeLine{2877 }
\DoxyCodeLine{2878             rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{2879             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{2880             eps2 = cur\_g\_2f(gluons(rin:rout),quarks(5:6),(/1+n4b+numglu(5)+n6a,n4b,numglu(5),n6a/))}
\DoxyCodeLine{2881             pmom1(:) = summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{2882             propfac1 = (0d0,-\/1d0)/sc\_(pmom1,pmom1)}
\DoxyCodeLine{2883             \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)).lt.propcut ) cycle}
\DoxyCodeLine{2884             eps2 = eps2*propfac1}
\DoxyCodeLine{2885 }
\DoxyCodeLine{2886             rin = n1a+1}
\DoxyCodeLine{2887             rout= numglu(1)+numglu(2)+numglu(3)+n4a}
\DoxyCodeLine{2888             u1 = cur\_f\_4f(gluons(rin:rout),quarks(2:4),quark1parttype,(/n1b+numglu(2)+numglu(3)+n4a,n1b,numglu(2),numglu(3),n4a/),0,0)}
\DoxyCodeLine{2889             pmom2  = summom(gluons,rin,rout)  + quarks(2)\%Mom + quarks(3)\%Mom + quarks(4)\%Mom}
\DoxyCodeLine{2890 }
\DoxyCodeLine{2891             \textcolor{keywordflow}{if}( quark1parttype.eq.-\/quarks(2)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2892                 \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2893                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{2894                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2895                   u1 = (-\/spi2\_(pmom2,u1) + quarks(2)\%Mass*u1 )*propfac2}
\DoxyCodeLine{2896                   ubar0 = vbqg(u1,eps2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2897                   rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{2898                   rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{2899                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom   \textcolor{comment}{! this PMom2 will be re-\/used below}}
\DoxyCodeLine{2900                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2901                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{2902                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2903                       ubar0 = (-\/spi2\_(pmom2,ubar0) + quarks(2)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{2904 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{2905                 \textcolor{keywordflow}{elseif}( quarks(2)\%PartType.gt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2906                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{2907                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2908                   u1 = ( spb2\_(u1,pmom2) + quarks(2)\%Mass*u1 )*propfac2}
\DoxyCodeLine{2909                   ubar0 = vqg(u1,eps2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2910                   rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{2911                   rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{2912                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{2913                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2914                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{2915                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2916                       ubar0 = ( spb2\_(ubar0,pmom2) + quarks(2)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{2917 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{2918 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{2919                 tmpquark(1)\%Mom  => pmom2(:)}
\DoxyCodeLine{2920                 tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{2921                 tmpquark(1)\%Mass => quarks(2)\%Mass}
\DoxyCodeLine{2922                 tmpquark(1)\%Mass2=> quarks(2)\%Mass2}
\DoxyCodeLine{2923             \textcolor{keywordflow}{elseif}( quark1parttype.eq.-\/quarks(4)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2924                 \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2925                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{2926                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2927                   u1 = (-\/spi2\_(pmom2,u1) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{2928                   ubar0 = vbqg(u1,eps2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2929                   rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{2930                   rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{2931                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{2932                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2933                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{2934                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2935                       ubar0 = (-\/spi2\_(pmom2,ubar0) + quarks(4)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{2936 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{2937                 \textcolor{keywordflow}{elseif}( quarks(4)\%PartType.gt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2938                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{2939                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2940                   u1 = ( spb2\_(u1,pmom2) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{2941                   ubar0 = vqg(u1,eps2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2942                   rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{2943                   rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{2944                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{2945                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2946                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{2947                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2948                       ubar0 = ( spb2\_(ubar0,pmom2) + quarks(4)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{2949 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{2950 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{2951                 tmpquark(1)\%Mom  => pmom2(:)}
\DoxyCodeLine{2952                 tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{2953                 tmpquark(1)\%Mass => quarks(4)\%Mass}
\DoxyCodeLine{2954                 tmpquark(1)\%Mass2=> quarks(4)\%Mass2}
\DoxyCodeLine{2955 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2956             tmpextref = -\/1}
\DoxyCodeLine{2957             tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{2958             tmpparttype = -\/quark1parttype}
\DoxyCodeLine{2959             tmpquark(1)\%PartType => tmpparttype}
\DoxyCodeLine{2960             counter=1}
\DoxyCodeLine{2961             rin =1}
\DoxyCodeLine{2962             rout=n1a}
\DoxyCodeLine{2963             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2964               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2965               counter=counter+1}
\DoxyCodeLine{2966 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{2967             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a+1}
\DoxyCodeLine{2968             rout=numglu(0)}
\DoxyCodeLine{2969             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2970               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2971               counter=counter+1}
\DoxyCodeLine{2972 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{2973             tmp(:) = cur\_f\_2f(tmpgluons(1:counter-\/1),tmpquark(1:1),quark1parttype,(/counter-\/1,n1a,n6b/) )}
\DoxyCodeLine{2974 }
\DoxyCodeLine{2975             res(:) = res(:) + tmp(:)}
\DoxyCodeLine{2976 \textcolor{comment}{!             Res3(:) = Res3(:) + tmp(:)}}
\DoxyCodeLine{2977 \textcolor{comment}{!             print *, "3",tmp(:)}}
\DoxyCodeLine{2978 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{2979 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{2980 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{2981 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{2982 }
\DoxyCodeLine{2983 }
\DoxyCodeLine{2984 \textcolor{comment}{!   (D)}}
\DoxyCodeLine{2985     \textcolor{keywordflow}{if}( quarks(2)\%PartType.eq.-\/quarks(3)\%PartType .AND. ( \&}
\DoxyCodeLine{2986         (quark1parttype.eq.-\/quarks(4)\%PartType .and. (quarks(4)\%ExtRef.ne.-\/1.or.tag\_f.ne.1)) \&}
\DoxyCodeLine{2987    .OR. (quark1parttype.eq.-\/quarks(6)\%PartType .and. (quarks(6)\%ExtRef.ne.-\/1.or.tag\_f.ne.1))  )) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2988 \textcolor{comment}{!     if( Quark1PartType.eq.-\/Quarks(4)\%PartType .and. Quarks(2)\%PartType.eq.-\/Quarks(3)\%PartType .and..not.(Quarks(4)\%ExtRef.eq.-\/1 .and. tag\_f.eq.1) \&}}
\DoxyCodeLine{2989 \textcolor{comment}{!     .OR.Quark1PartType.eq.-\/Quarks(6)\%PartType .and. Quarks(2)\%PartType.eq.-\/Quarks(3)\%PartType .and..not.(Quarks(6)\%ExtRef.eq.-\/1 .and. tag\_f.eq.1) \&}}
\DoxyCodeLine{2990 \textcolor{comment}{!       ) then}}
\DoxyCodeLine{2991 }
\DoxyCodeLine{2992       \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{2993       \textcolor{keywordflow}{do} n3a=0,numglu(3)}
\DoxyCodeLine{2994       \textcolor{keywordflow}{do} n6a=0,numglu(6)}
\DoxyCodeLine{2995          n1b = numglu(1)-\/n1a}
\DoxyCodeLine{2996          n3b = numglu(3)-\/n3a}
\DoxyCodeLine{2997          n6b = numglu(6)-\/n6a}
\DoxyCodeLine{2998 }
\DoxyCodeLine{2999             counter=1}
\DoxyCodeLine{3000             rin = n1a+1}
\DoxyCodeLine{3001             rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{3002 }
\DoxyCodeLine{3003 }
\DoxyCodeLine{3004             eps2 = cur\_g\_2f(gluons(rin:rout),quarks(2:3),(/1+n1b+numglu(2)+n3a,n1b,numglu(2),n3a/))}
\DoxyCodeLine{3005             pmom1(:) = summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{3006             propfac1 = (0d0,-\/1d0)/sc\_(pmom1,pmom1)}
\DoxyCodeLine{3007             \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)).lt.propcut ) cycle}
\DoxyCodeLine{3008             eps2 = eps2*propfac1}
\DoxyCodeLine{3009 }
\DoxyCodeLine{3010             rin = numglu(1)+numglu(2)+n3a+1}
\DoxyCodeLine{3011             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{3012             u1 = cur\_f\_4f(gluons(rin:rout),quarks(4:6),quark1parttype,(/n3b+numglu(4)+numglu(5)+n6a,n3b,numglu(4),numglu(5),n6a/),tag\_f,0)}
\DoxyCodeLine{3013             pmom2  = summom(gluons,rin,rout)  + quarks(4)\%Mom + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{3014 }
\DoxyCodeLine{3015             \textcolor{keywordflow}{if}( quark1parttype.eq.-\/quarks(4)\%PartType ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3016                 \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3017                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{3018                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3019                   u1 = (-\/spi2\_(pmom2,u1) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3020                   ubar0 = vgbq(eps2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3021                   rin = n1a+1}
\DoxyCodeLine{3022                   rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{3023                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom   \textcolor{comment}{!this PMom2 will be re-\/used below  ! CAN be written as PMom2=PMom2+PMom1}}
\DoxyCodeLine{3024                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3025                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{3026                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3027                       ubar0 = (-\/spi2\_(pmom2,ubar0) + quarks(4)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{3028 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{3029                 \textcolor{keywordflow}{elseif}( quarks(4)\%PartType.gt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3030                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{3031                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3032                   u1 = ( spb2\_(u1,pmom2) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3033                   ubar0 = vgq(eps2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3034                   rin = n1a+1}
\DoxyCodeLine{3035                   rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{3036                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{3037                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3038                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{3039                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3040                       ubar0 = ( spb2\_(ubar0,pmom2) + quarks(4)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{3041 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{3042 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{3043                 tmpquark(1)\%Mom  => pmom2(:)}
\DoxyCodeLine{3044                 tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{3045                 tmpquark(1)\%Mass => quarks(4)\%Mass}
\DoxyCodeLine{3046                 tmpquark(1)\%Mass2=> quarks(4)\%Mass2}
\DoxyCodeLine{3047             \textcolor{keywordflow}{elseif}(quark1parttype.eq.-\/quarks(6)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3048                 \textcolor{keywordflow}{if}( quarks(6)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3049                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2)}
\DoxyCodeLine{3050                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3051                   u1 = (-\/spi2\_(pmom2,u1) + quarks(6)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3052                   ubar0 = vgbq(eps2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3053                   rin = n1a+1}
\DoxyCodeLine{3054                   rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{3055                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{3056                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3057                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2)}
\DoxyCodeLine{3058                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3059                       ubar0 = (-\/spi2\_(pmom2,ubar0) + quarks(6)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{3060 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{3061                 \textcolor{keywordflow}{elseif}( quarks(6)\%PartType.gt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3062                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2)}
\DoxyCodeLine{3063                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3064                   u1 = ( spb2\_(u1,pmom2) + quarks(6)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3065                   ubar0 = vgq(eps2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3066                   rin = n1a+1}
\DoxyCodeLine{3067                   rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{3068                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{3069                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3070                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2)}
\DoxyCodeLine{3071                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3072                       ubar0 = ( spb2\_(ubar0,pmom2) + quarks(6)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{3073 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{3074 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{3075                 tmpquark(1)\%Mom  => pmom2(:)}
\DoxyCodeLine{3076                 tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{3077                 tmpquark(1)\%Mass => quarks(6)\%Mass}
\DoxyCodeLine{3078                 tmpquark(1)\%Mass2=> quarks(6)\%Mass2}
\DoxyCodeLine{3079 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3080             tmpextref = -\/1}
\DoxyCodeLine{3081             tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{3082             tmpparttype = -\/quark1parttype}
\DoxyCodeLine{3083             tmpquark(1)\%PartType => tmpparttype}
\DoxyCodeLine{3084             counter=1}
\DoxyCodeLine{3085             rin =1}
\DoxyCodeLine{3086             rout=n1a}
\DoxyCodeLine{3087             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3088               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3089               counter=counter+1}
\DoxyCodeLine{3090 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{3091             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a+1}
\DoxyCodeLine{3092             rout=numglu(0)}
\DoxyCodeLine{3093             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3094               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3095               counter=counter+1}
\DoxyCodeLine{3096 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{3097             tmp(:) = cur\_f\_2f(tmpgluons(1:counter-\/1),tmpquark(1:1),quark1parttype,(/counter-\/1,n1a,n6b/))}
\DoxyCodeLine{3098 }
\DoxyCodeLine{3099             res(:)  = res(:) + tmp(:)}
\DoxyCodeLine{3100 \textcolor{comment}{!             Res4(:) = Res4(:) + Tmp(:)}}
\DoxyCodeLine{3101 \textcolor{comment}{!             print *, "4",tmp(:)}}
\DoxyCodeLine{3102 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{3103 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{3104 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{3105 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{3106 \textcolor{comment}{!    print *, 'res', res}}
\DoxyCodeLine{3107 \textcolor{comment}{!    pause}}
\DoxyCodeLine{3108 \textcolor{comment}{!     Res(:) = Res1(:)+Res2(:)+Res3(:)+Res4(:)}}
\DoxyCodeLine{3109 \textcolor{comment}{!     print *, "Res1:",Res1(1:4)}}
\DoxyCodeLine{3110 \textcolor{comment}{!     print *, "Res2:",Res2(1:4)}}
\DoxyCodeLine{3111 \textcolor{comment}{!     print *, "Res3:",Res3(1:4)}}
\DoxyCodeLine{3112 \textcolor{comment}{!     print *, "Res4:",Res4(1:4)}}
\DoxyCodeLine{3113 \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_adf47ca461bff280d07ab94c06f982305}\label{namespacemodttbhiggs_adf47ca461bff280d07ab94c06f982305}} 
\index{modttbhiggs@{modttbhiggs}!cur\_f\_6fv@{cur\_f\_6fv}}
\index{cur\_f\_6fv@{cur\_f\_6fv}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{cur\_f\_6fv()}{cur\_f\_6fv()}}
{\footnotesize\ttfamily complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}}) modttbhiggs\+::cur\+\_\+f\+\_\+6fv (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(1\+:)}]{Gluons,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(2\+:6)}]{Quarks,  }\item[{integer}]{Quark1\+Part\+Type,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}})}]{Boson,  }\item[{integer}]{Boson\+Vertex,  }\item[{integer, dimension(0\+:6)}]{Num\+Glu,  }\item[{integer}]{tag\+\_\+f }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 3974 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{3974 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{3975 \textcolor{keywordtype}{integer} :: NumGlu(0:6),Quark1PartType,tag\_f,BosonVertex,BosonVertex\_mod}
\DoxyCodeLine{3976 \textcolor{keywordtype}{type}(PtrToParticle) :: Gluons(1:),Quarks(2:6),Boson}
\DoxyCodeLine{3977 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{target} :: TmpPartType,TmpExtRef}
\DoxyCodeLine{3978 \textcolor{keywordtype}{complex(8)} :: Res(1:Ds),tmp(1:Ds)}
\DoxyCodeLine{3979 \textcolor{comment}{! complex(8) :: Res1(1:Ds),Res2(1:Ds),Res3(1:Ds),Res4(1:Ds)}}
\DoxyCodeLine{3980 \textcolor{keywordtype}{complex(8)} :: u1(1:Ds),ubar1(1:Ds)}
\DoxyCodeLine{3981 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: ubar0(1:Ds)}
\DoxyCodeLine{3982 \textcolor{keywordtype}{complex(8)} :: eps1(1:Dv)}
\DoxyCodeLine{3983 \textcolor{keywordtype}{complex(8)} :: eps2(1:Dv)}
\DoxyCodeLine{3984 \textcolor{keywordtype}{type}(PtrToParticle) :: TmpGluons(1:NumGlu(1)+NumGlu(6)),TmpQuark(1:1)}
\DoxyCodeLine{3985 \textcolor{keywordtype}{complex(8)} :: PropFac1,PropFac2}
\DoxyCodeLine{3986 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: PMom1(1:Dv)}
\DoxyCodeLine{3987 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: PMom2(1:Dv)}
\DoxyCodeLine{3988 \textcolor{keywordtype}{integer} :: n1a,n1b,n2a,n2b,n3a,n3b,n4a,n4b,n5a,n5b,n6a,n6b}
\DoxyCodeLine{3989 \textcolor{keywordtype}{integer} :: rIn,rOut,i,counter}
\DoxyCodeLine{3990 }
\DoxyCodeLine{3991 }
\DoxyCodeLine{3992 \textcolor{comment}{!DEC\$ IF (\_DebugCheckMyImpl1==1)}}
\DoxyCodeLine{3993     \textcolor{keywordflow}{if}( numglu(0)-\/numglu(1)-\/numglu(2)-\/numglu(3)-\/numglu(4)-\/numglu(5)-\/numglu(6).ne.0 ) print *, \textcolor{stringliteral}{"wrong number of gluons in cur\_f\_6fV"}}
\DoxyCodeLine{3994 \textcolor{comment}{!DEC\$ ENDIF}}
\DoxyCodeLine{3995 }
\DoxyCodeLine{3996     res = (0d0,0d0)}
\DoxyCodeLine{3997 }
\DoxyCodeLine{3998 }
\DoxyCodeLine{3999 \textcolor{comment}{! -\/-\/ not all possible choices of flavors and BosonVertex values are used in ttb+Z calculation. This warns you if you try to use something new and potentially buggy.}}
\DoxyCodeLine{4000     \textcolor{keywordflow}{if} (quark1parttype.eq.-\/quarks(2)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4001        \textcolor{keywordflow}{if} ( ((quarks(3)\%PartType.eq.-\/quarks(4)\%PartType) .AND. (bosonvertex .eq. 2 .OR.bosonvertex .eq. 4 .OR.bosonvertex .eq. 6)) .OR. \&}
\DoxyCodeLine{4002          ((quarks(3)\%PartType.eq.-\/quarks(6)\%PartType) .AND. (bosonvertex .eq. 2 .OR.bosonvertex .eq. 6)) ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4003           print *, \textcolor{stringliteral}{'WARNING :  cur\_f\_6fV with this flavor structure and this choice of BosonVertex is implemented, but not checked!'}}
\DoxyCodeLine{4004           print *, \textcolor{stringliteral}{'Quark flavors: '},quark1parttype, quarks(2)\%PartType,quarks(3)\%PartType,quarks(4)\%PartType,quarks(5)\%PartType,quarks(6)\%PartType}
\DoxyCodeLine{4005           print *, \textcolor{stringliteral}{'BosonVertex ='}, bosonvertex}
\DoxyCodeLine{4006 \textcolor{keywordflow}{       endif}}
\DoxyCodeLine{4007     \textcolor{keywordflow}{elseif} (quark1parttype.eq.-\/quarks(6)\%PartType ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4008        \textcolor{keywordflow}{if} ( ((quark1parttype.eq.-\/quarks(2)\%PartType) .AND. (bosonvertex .eq. 2 .or. bosonvertex .eq. 4 .or. bosonvertex .eq. 6)) .OR. \&}
\DoxyCodeLine{4009             \& ((quark1parttype.eq.-\/quarks(4)\%PartType) .AND. (bosonvertex .eq. 4 .or. bosonvertex .eq. 6)) ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4010           print *, \textcolor{stringliteral}{'WARNING :  cur\_f\_6fV with this flavor structure and this choice of BosonVertex is implemented, but not checked!'}}
\DoxyCodeLine{4011           print *, \textcolor{stringliteral}{'Quark flavors: '},quark1parttype, quarks(2)\%PartType,quarks(3)\%PartType,quarks(4)\%PartType,quarks(5)\%PartType,quarks(6)\%PartType}
\DoxyCodeLine{4012           print *, \textcolor{stringliteral}{'BosonVertex ='}, bosonvertex}
\DoxyCodeLine{4013 \textcolor{keywordflow}{       endif}}
\DoxyCodeLine{4014     \textcolor{keywordflow}{elseif} (quarks(2)\%PartType.eq.-\/quarks(3)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4015        \textcolor{keywordflow}{if} ( ((quark1parttype.eq.-\/quarks(4)\%PartType) .AND.  (bosonvertex .eq. 4 .or. bosonvertex .eq. 6) ) .OR. \&}
\DoxyCodeLine{4016             ((quark1parttype.eq.-\/quarks(6)\%PartType) .AND.  (bosonvertex .eq. 4 .or. bosonvertex .eq. 6) ) ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4017           print *, \textcolor{stringliteral}{'WARNING :  cur\_f\_6fV with this flavor structure and this choice of BosonVertex is implemented, but not checked!'}}
\DoxyCodeLine{4018           print *, \textcolor{stringliteral}{'Quark flavors: '},quark1parttype, quarks(2)\%PartType,quarks(3)\%PartType,quarks(4)\%PartType,quarks(5)\%PartType,quarks(6)\%PartType}
\DoxyCodeLine{4019           print *, \textcolor{stringliteral}{'BosonVertex ='}, bosonvertex}
\DoxyCodeLine{4020 \textcolor{keywordflow}{       endif}}
\DoxyCodeLine{4021 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{4022 }
\DoxyCodeLine{4023 }
\DoxyCodeLine{4024 \textcolor{comment}{! probably some tag\_Z checks are needed here: not yet implemented}}
\DoxyCodeLine{4025 }
\DoxyCodeLine{4026 }
\DoxyCodeLine{4027 \textcolor{comment}{!   (A)}}
\DoxyCodeLine{4028     \textcolor{keywordflow}{if}( quark1parttype.eq.-\/quarks(2)\%PartType .AND. (quarks(3)\%PartType.eq.-\/quarks(4)\%PartType .or. quarks(3)\%PartType.eq.-\/quarks(6)\%PartType) \&}
\DoxyCodeLine{4029          .AND. (quarks(2)\%ExtRef.ne.-\/1 .or. tag\_f.ne.1) \&}
\DoxyCodeLine{4030          .AND. ( bosonvertex.eq.1 .OR. bosonvertex.eq.2) \&}
\DoxyCodeLine{4031          ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4032 \textcolor{comment}{!       print *, 'A-\/1'}}
\DoxyCodeLine{4033       \textcolor{keywordflow}{do} n2a=0,numglu(2)}
\DoxyCodeLine{4034       \textcolor{keywordflow}{do} n6a=0,numglu(6)}
\DoxyCodeLine{4035          n2b = numglu(2)-\/n2a}
\DoxyCodeLine{4036          n6b = numglu(6)-\/n6a}
\DoxyCodeLine{4037 }
\DoxyCodeLine{4038          rin =numglu(1)+n2a+1}
\DoxyCodeLine{4039          rout=numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4040          eps2 = cur\_g\_4f(gluons(rin:rout),quarks(3:6),(/1+n2b+numglu(3)+numglu(4)+numglu(5)+n6a,n2b,numglu(3),numglu(4),numglu(5),n6a/))}
\DoxyCodeLine{4041          pmom1(:) = summom(gluons,rin,rout) + quarks(3)\%Mom + quarks(4)\%Mom + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{4042          propfac1 = (0d0,-\/1d0)/sc\_(pmom1,pmom1)}
\DoxyCodeLine{4043          \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)).lt.propcut) cycle}
\DoxyCodeLine{4044          eps2 = eps2*propfac1}
\DoxyCodeLine{4045          \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{4046             n1b = numglu(1)-\/n1a}
\DoxyCodeLine{4047             \textcolor{comment}{! Fer2 couple V on the top}}
\DoxyCodeLine{4048             rin =n1a+1}
\DoxyCodeLine{4049             rout=numglu(1)+n2a}
\DoxyCodeLine{4050             \textcolor{keywordflow}{if} (bosonvertex .eq. 1 .or. bosonvertex .eq. 2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4051                ubar1(:) = cur\_f\_2fv(gluons(rin:rout),quarks(2:2),-\/quarks(2)\%PartType,boson,(/n1b+n2a,n1b,n2a/) )}
\DoxyCodeLine{4052                pmom2(:) = quarks(2)\%Mom + summom(gluons,rin,rout) + boson\%Mom}
\DoxyCodeLine{4053                propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{4054                \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2).lt.propcut ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4055                   propfac2=(0d0,0d0)}
\DoxyCodeLine{4056 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{4057 }
\DoxyCodeLine{4058                \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4059                   ubar1(:) = (-\/spi2\_(pmom2,ubar1)+quarks(2)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{4060                \textcolor{keywordflow}{else}}
\DoxyCodeLine{4061                   ubar1(:) = (+spb2\_(ubar1,pmom2)+quarks(2)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{4062 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{4063                \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4064                   ubar0(:) = vbqg(ubar1,eps2)}
\DoxyCodeLine{4065                \textcolor{keywordflow}{else}}
\DoxyCodeLine{4066                   ubar0(:) = vqg(ubar1,eps2)}
\DoxyCodeLine{4067 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{4068 }
\DoxyCodeLine{4069                rin = n1a+1}
\DoxyCodeLine{4070                rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4071                pmom1 = summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom + quarks(4)\%Mom + quarks(5)\%Mom + quarks(6)\%Mom + boson\%Mom  \textcolor{comment}{! can be simplified with PMom1(:)}}
\DoxyCodeLine{4072                \textcolor{keywordflow}{if}(n1a.ge.1 .or. n6b.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4073                   propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{4074                   \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)-\/quarks(2)\%Mass2).lt.propcut ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4075                      propfac1=(0d0,0d0)}
\DoxyCodeLine{4076 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4077 }
\DoxyCodeLine{4078                   \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4079                      ubar0(:) = (-\/spi2\_(pmom1,ubar0)+quarks(2)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{4080                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{4081                      ubar0(:) = (+spb2\_(ubar0,pmom1)+quarks(2)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{4082 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4083 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{4084 }
\DoxyCodeLine{4085                tmpquark(1)\%Mom  => pmom1(:)}
\DoxyCodeLine{4086                tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{4087                tmpquark(1)\%Mass => quarks(2)\%Mass}
\DoxyCodeLine{4088                tmpquark(1)\%Mass2=> quarks(2)\%Mass2}
\DoxyCodeLine{4089                tmpextref = -\/1}
\DoxyCodeLine{4090                tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{4091                tmpquark(1)\%PartType => quarks(2)\%PartType}
\DoxyCodeLine{4092                counter=1}
\DoxyCodeLine{4093                rin =1}
\DoxyCodeLine{4094                rout=n1a}
\DoxyCodeLine{4095                \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4096                   \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4097                   counter=counter+1}
\DoxyCodeLine{4098 \textcolor{keywordflow}{               enddo}}
\DoxyCodeLine{4099                rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a+1}
\DoxyCodeLine{4100                rout=numglu(0)}
\DoxyCodeLine{4101                \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4102                   \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4103                   counter=counter+1}
\DoxyCodeLine{4104 \textcolor{keywordflow}{               enddo}}
\DoxyCodeLine{4105                tmp(:) = cur\_f\_2f(tmpgluons(1:counter-\/1),tmpquark(1:1),-\/tmpquark(1)\%PartType,(/counter-\/1,n1a,n6b/) )}
\DoxyCodeLine{4106                res(:) = res(:) + tmp(:)}
\DoxyCodeLine{4107 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{4108             \textcolor{keywordflow}{if} (bosonvertex .eq. 1 .or. bosonvertex .eq. 6) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4109                \textcolor{comment}{! Fer2  couple V on the bottom}}
\DoxyCodeLine{4110                rin =n1a+1}
\DoxyCodeLine{4111                rout=numglu(1)+n2a}
\DoxyCodeLine{4112                ubar1(:) = cur\_f\_2f(gluons(rin:rout),quarks(2:2),-\/quarks(2)\%PartType,(/n1b+n2a,n1b,n2a/) )}
\DoxyCodeLine{4113                \textcolor{keywordflow}{if}(n1b.ge.1 .or. n2a.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4114                   pmom2(:) = quarks(2)\%Mom + summom(gluons,rin,rout)}
\DoxyCodeLine{4115                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{4116                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4117                   \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4118                      ubar1(:) = (-\/spi2\_(pmom2,ubar1)+quarks(2)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{4119                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{4120                      ubar1(:) = (+spb2\_(ubar1,pmom2)+quarks(2)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{4121 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4122 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{4123                \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4124                   ubar0(:) = vbqg(ubar1,eps2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4125                \textcolor{keywordflow}{else}}
\DoxyCodeLine{4126                   ubar0(:) = vqg(ubar1,eps2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4127 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{4128 }
\DoxyCodeLine{4129                rin = n1a+1}
\DoxyCodeLine{4130                rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4131                pmom1 = summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom + quarks(4)\%Mom + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{4132 }
\DoxyCodeLine{4133                propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{4134                \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)-\/quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4135                \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4136                   ubar0(:) = (-\/spi2\_(pmom1,ubar0)+quarks(2)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{4137                \textcolor{keywordflow}{else}}
\DoxyCodeLine{4138                   ubar0(:) = (+spb2\_(ubar0,pmom1)+quarks(2)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{4139 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4140 }
\DoxyCodeLine{4141                   tmpquark(1)\%Mom  => pmom1(:)}
\DoxyCodeLine{4142                   tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{4143                   tmpquark(1)\%Mass => quarks(2)\%Mass}
\DoxyCodeLine{4144                   tmpquark(1)\%Mass2=> quarks(2)\%Mass2}
\DoxyCodeLine{4145                   tmpextref = -\/1}
\DoxyCodeLine{4146                   tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{4147                   tmpquark(1)\%PartType => quarks(2)\%PartType}
\DoxyCodeLine{4148                   counter=1}
\DoxyCodeLine{4149                   rin =1}
\DoxyCodeLine{4150                   rout=n1a}
\DoxyCodeLine{4151                   \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4152                      \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4153                      counter=counter+1}
\DoxyCodeLine{4154 \textcolor{keywordflow}{                  enddo}}
\DoxyCodeLine{4155                   rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a+1}
\DoxyCodeLine{4156                   rout=numglu(0)}
\DoxyCodeLine{4157                   \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4158                      \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4159                      counter=counter+1}
\DoxyCodeLine{4160 \textcolor{keywordflow}{                  enddo}}
\DoxyCodeLine{4161                   tmp(:) = cur\_f\_2fv(tmpgluons(1:counter-\/1),tmpquark(1:1),-\/tmpquark(1)\%PartType,boson,(/counter-\/1,n1a,n6b/) )}
\DoxyCodeLine{4162                   res(:) = res(:) + tmp(:)}
\DoxyCodeLine{4163 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{4164 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{4165 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{4166 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4167 \textcolor{keywordflow}{   endif}}
\DoxyCodeLine{4168 }
\DoxyCodeLine{4169 }
\DoxyCodeLine{4170 }
\DoxyCodeLine{4171 \textcolor{comment}{!   (A)}}
\DoxyCodeLine{4172     \textcolor{keywordflow}{if}( quark1parttype.eq.-\/quarks(2)\%PartType .AND. (quarks(3)\%PartType.eq.-\/quarks(4)\%PartType .or. quarks(3)\%PartType.eq.-\/quarks(6)\%PartType) \&}
\DoxyCodeLine{4173         .AND. (quarks(2)\%ExtRef.ne.-\/1 .or. tag\_f.ne.1) \&}
\DoxyCodeLine{4174         .AND. ( bosonvertex.eq.3 .OR. bosonvertex .eq. 4 .OR. bosonvertex.eq.5 ) \&}
\DoxyCodeLine{4175       ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4176 \textcolor{comment}{!       print *, 'A-\/2'}}
\DoxyCodeLine{4177       \textcolor{keywordflow}{do} n2a=0,numglu(2)}
\DoxyCodeLine{4178       \textcolor{keywordflow}{do} n6a=0,numglu(6)}
\DoxyCodeLine{4179          n2b = numglu(2)-\/n2a}
\DoxyCodeLine{4180          n6b = numglu(6)-\/n6a}
\DoxyCodeLine{4181 }
\DoxyCodeLine{4182          rin =numglu(1)+n2a+1}
\DoxyCodeLine{4183          rout=numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4184          bosonvertex\_mod = bosonvertex -\/ 2}
\DoxyCodeLine{4185          eps2 = cur\_g\_4fv(gluons(rin:rout),quarks(3:6),boson,bosonvertex\_mod,(/1+n2b+numglu(3)+numglu(4)+numglu(5)+n6a,n2b,numglu(3),numglu(4),numglu(5),n6a/))}
\DoxyCodeLine{4186          pmom1(:) = summom(gluons,rin,rout) + quarks(3)\%Mom + quarks(4)\%Mom + quarks(5)\%Mom + quarks(6)\%Mom + boson\%Mom}
\DoxyCodeLine{4187          propfac1 = (0d0,-\/1d0)/sc\_(pmom1,pmom1)}
\DoxyCodeLine{4188          \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)).lt.propcut) cycle}
\DoxyCodeLine{4189          eps2 = eps2*propfac1}
\DoxyCodeLine{4190          \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{4191             n1b = numglu(1)-\/n1a}
\DoxyCodeLine{4192             \textcolor{comment}{! Fer2}}
\DoxyCodeLine{4193             rin =n1a+1}
\DoxyCodeLine{4194             rout=numglu(1)+n2a}
\DoxyCodeLine{4195             ubar1(:) = cur\_f\_2f(gluons(rin:rout),quarks(2:2),-\/quarks(2)\%PartType,(/n1b+n2a,n1b,n2a/) )}
\DoxyCodeLine{4196             \textcolor{keywordflow}{if}(n1b.ge.1 .or. n2a.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4197                pmom2(:) = quarks(2)\%Mom + summom(gluons,rin,rout)}
\DoxyCodeLine{4198                propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{4199                \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4200                \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4201                   ubar1(:) = (-\/spi2\_(pmom2,ubar1)+quarks(2)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{4202                \textcolor{keywordflow}{else}}
\DoxyCodeLine{4203                   ubar1(:) = (+spb2\_(ubar1,pmom2)+quarks(2)\%Mass*ubar1(:))*propfac2}
\DoxyCodeLine{4204 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{4205 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{4206             \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4207                ubar0(:) = vbqg(ubar1,eps2)}
\DoxyCodeLine{4208             \textcolor{keywordflow}{else}}
\DoxyCodeLine{4209                ubar0(:) = vqg(ubar1,eps2)}
\DoxyCodeLine{4210 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{4211 }
\DoxyCodeLine{4212             rin = n1a+1}
\DoxyCodeLine{4213             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4214             pmom1 = summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom + quarks(4)\%Mom + quarks(5)\%Mom + quarks(6)\%Mom + boson\%Mom}
\DoxyCodeLine{4215             \textcolor{keywordflow}{if}(n1a.ge.1 .or. n6b.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4216                propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{4217                \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)-\/quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4218                \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4219                   ubar0(:) = (-\/spi2\_(pmom1,ubar0)+quarks(2)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{4220                \textcolor{keywordflow}{else}}
\DoxyCodeLine{4221                   ubar0(:) = (+spb2\_(ubar0,pmom1)+quarks(2)\%Mass*ubar0(:))*propfac1}
\DoxyCodeLine{4222 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{4223 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{4224 }
\DoxyCodeLine{4225             tmpquark(1)\%Mom  => pmom1(:)}
\DoxyCodeLine{4226             tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{4227             tmpquark(1)\%Mass => quarks(2)\%Mass}
\DoxyCodeLine{4228             tmpquark(1)\%Mass2=> quarks(2)\%Mass2}
\DoxyCodeLine{4229             tmpextref = -\/1}
\DoxyCodeLine{4230             tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{4231             tmpquark(1)\%PartType => quarks(2)\%PartType}
\DoxyCodeLine{4232             counter=1}
\DoxyCodeLine{4233             rin =1}
\DoxyCodeLine{4234             rout=n1a}
\DoxyCodeLine{4235             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4236               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4237               counter=counter+1}
\DoxyCodeLine{4238 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{4239             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a+1}
\DoxyCodeLine{4240             rout=numglu(0)}
\DoxyCodeLine{4241             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4242               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4243               counter=counter+1}
\DoxyCodeLine{4244 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{4245             tmp(:) = cur\_f\_2f(tmpgluons(1:counter-\/1),tmpquark(1:1),-\/tmpquark(1)\%PartType,(/counter-\/1,n1a,n6b/) )}
\DoxyCodeLine{4246             res(:) = res(:) + tmp(:)}
\DoxyCodeLine{4247 }
\DoxyCodeLine{4248 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{4249 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4250 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4251 \textcolor{keywordflow}{   endif}}
\DoxyCodeLine{4252 }
\DoxyCodeLine{4253 }
\DoxyCodeLine{4254 }
\DoxyCodeLine{4255 \textcolor{comment}{!   (B)}}
\DoxyCodeLine{4256 \textcolor{comment}{!! RR -\/-\/ I think that only times this will be called in ttbZ will be color-\/zero in any case (tadpoles), so I'm going to just comment it out.}}
\DoxyCodeLine{4257 \textcolor{comment}{!! I imagine that if implemented correctly, then the it would return zero for ttbZ for kinematic reasons, but there doesn't seem to be any poin in coding it up for now...}}
\DoxyCodeLine{4258 }
\DoxyCodeLine{4259 \textcolor{comment}{!    if( Quark1PartType.eq.-\/Quarks(6)\%PartType .AND. (Quarks(2)\%PartType.eq.-\/Quarks(5)\%PartType .or. Quarks(2)\%PartType.eq.-\/Quarks(3)\%PartType) \&}}
\DoxyCodeLine{4260 \textcolor{comment}{!        .AND. (Quarks(6)\%ExtRef.ne.-\/1 .or. tag\_f.ne.1) \&}}
\DoxyCodeLine{4261 \textcolor{comment}{!      ) then}}
\DoxyCodeLine{4262 \textcolor{comment}{!      call Error("This 6fV(B) current is not yet implemented")}}
\DoxyCodeLine{4263 \textcolor{comment}{!}}
\DoxyCodeLine{4264 \textcolor{comment}{!    endif}}
\DoxyCodeLine{4265 }
\DoxyCodeLine{4266 \textcolor{comment}{!   (C)}}
\DoxyCodeLine{4267     \textcolor{keywordflow}{if}( quarks(5)\%PartType.eq.-\/quarks(6)\%PartType .AND. \&}
\DoxyCodeLine{4268         ((quark1parttype.eq.-\/quarks(2)\%PartType .and. (quarks(2)\%ExtRef.ne.-\/1.or.tag\_f.ne.1) ) \&}
\DoxyCodeLine{4269     .OR. (quark1parttype.eq.-\/quarks(4)\%PartType .and. (quarks(4)\%ExtRef.ne.-\/1.or.tag\_f.ne.1) ))\&}
\DoxyCodeLine{4270     .AND. ( bosonvertex.eq.1 .OR. bosonvertex.eq.6 )  \&}
\DoxyCodeLine{4271       ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4272 \textcolor{comment}{!       print *, 'C-\/1'}}
\DoxyCodeLine{4273       \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{4274       \textcolor{keywordflow}{do} n4a=0,numglu(4)}
\DoxyCodeLine{4275       \textcolor{keywordflow}{do} n6a=0,numglu(6)}
\DoxyCodeLine{4276          n1b = numglu(1)-\/n1a}
\DoxyCodeLine{4277          n4b = numglu(4)-\/n4a}
\DoxyCodeLine{4278          n6b = numglu(6)-\/n6a}
\DoxyCodeLine{4279 }
\DoxyCodeLine{4280             rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{4281             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4282             eps2 = cur\_g\_2f(gluons(rin:rout),quarks(5:6),(/1+n4b+numglu(5)+n6a,n4b,numglu(5),n6a/))}
\DoxyCodeLine{4283             pmom1(:) = summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{4284             propfac1 = (0d0,-\/1d0)/sc\_(pmom1,pmom1)}
\DoxyCodeLine{4285             \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)).lt.propcut ) cycle}
\DoxyCodeLine{4286             eps2 = eps2*propfac1}
\DoxyCodeLine{4287 }
\DoxyCodeLine{4288             rin = n1a+1}
\DoxyCodeLine{4289             rout= numglu(1)+numglu(2)+numglu(3)+n4a}
\DoxyCodeLine{4290             u1 = cur\_f\_4f(gluons(rin:rout),quarks(2:4),quark1parttype,(/n1b+numglu(2)+numglu(3)+n4a,n1b,numglu(2),numglu(3),n4a/),0,0)}
\DoxyCodeLine{4291             pmom2  = summom(gluons,rin,rout)  + quarks(2)\%Mom + quarks(3)\%Mom + quarks(4)\%Mom}
\DoxyCodeLine{4292 }
\DoxyCodeLine{4293             \textcolor{keywordflow}{if}( quark1parttype.eq.-\/quarks(2)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4294                  \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4295                    propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{4296                    \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4297                    u1 = (-\/spi2\_(pmom2,u1) + quarks(2)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4298                    ubar0 = vbqg(u1,eps2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4299                    rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{4300                    rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4301                    pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom   \textcolor{comment}{! this PMom2 will be re-\/used below}}
\DoxyCodeLine{4302 }
\DoxyCodeLine{4303                    \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 .or. bosonvertex.eq.1 .or. bosonvertex.eq.6 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4304                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{4305                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4306                       ubar0 = (-\/spi2\_(pmom2,ubar0) + quarks(2)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4307 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{4308                 \textcolor{keywordflow}{elseif}( quarks(2)\%PartType.gt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4309                    propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{4310                    \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4311                    u1 = ( spb2\_(u1,pmom2) + quarks(2)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4312                    ubar0 = vqg(u1,eps2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4313                    rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{4314                    rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4315                    pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{4316 }
\DoxyCodeLine{4317                    \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 .or. bosonvertex.eq.1 .or. bosonvertex.eq.6 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4318                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{4319                        \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4320                        ubar0 = ( spb2\_(ubar0,pmom2) + quarks(2)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4321 \textcolor{keywordflow}{                    endif}}
\DoxyCodeLine{4322 \textcolor{keywordflow}{                 endif}}
\DoxyCodeLine{4323                  tmpquark(1)\%Mom  => pmom2(:)}
\DoxyCodeLine{4324                  tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{4325                  tmpquark(1)\%Mass => quarks(2)\%Mass}
\DoxyCodeLine{4326                  tmpquark(1)\%Mass2=> quarks(2)\%Mass2}
\DoxyCodeLine{4327             \textcolor{keywordflow}{elseif}( quark1parttype.eq.-\/quarks(4)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4328                 \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4329                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4330                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4331                   u1 = (-\/spi2\_(pmom2,u1) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4332                   ubar0 = vbqg(u1,eps2)}
\DoxyCodeLine{4333                   rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{4334                   rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4335                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{4336                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 .or. bosonvertex.eq.1 .or. bosonvertex.eq.6 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4337                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4338                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4339                       ubar0 = (-\/spi2\_(pmom2,ubar0) + quarks(4)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4340 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4341                 \textcolor{keywordflow}{elseif}( quarks(4)\%PartType.gt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4342                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4343                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4344                   u1 = ( spb2\_(u1,pmom2) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4345                   ubar0 = vqg(u1,eps2)}
\DoxyCodeLine{4346                   rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{4347                   rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4348                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{4349                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 .or. bosonvertex.eq.1 .or. bosonvertex.eq.6 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4350                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4351                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4352                       ubar0 = ( spb2\_(ubar0,pmom2) + quarks(4)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4353 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4354 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{4355                 tmpquark(1)\%Mom  => pmom2(:)}
\DoxyCodeLine{4356                 tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{4357                 tmpquark(1)\%Mass => quarks(4)\%Mass}
\DoxyCodeLine{4358                 tmpquark(1)\%Mass2=> quarks(4)\%Mass2}
\DoxyCodeLine{4359 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{4360             tmpextref = -\/1}
\DoxyCodeLine{4361             tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{4362             tmpparttype = -\/quark1parttype}
\DoxyCodeLine{4363             tmpquark(1)\%PartType => tmpparttype}
\DoxyCodeLine{4364             counter=1}
\DoxyCodeLine{4365             rin =1}
\DoxyCodeLine{4366             rout=n1a}
\DoxyCodeLine{4367             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4368               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4369               counter=counter+1}
\DoxyCodeLine{4370 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{4371             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a+1}
\DoxyCodeLine{4372             rout=numglu(0)}
\DoxyCodeLine{4373             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4374               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4375               counter=counter+1}
\DoxyCodeLine{4376 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{4377             tmp(:) = cur\_f\_2fv(tmpgluons(1:counter-\/1),tmpquark(1:1),quark1parttype,boson,(/counter-\/1,n1a,n6b/) )}
\DoxyCodeLine{4378 }
\DoxyCodeLine{4379             res(:) = res(:) + tmp(:)}
\DoxyCodeLine{4380 }
\DoxyCodeLine{4381 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4382 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4383 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4384 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{4385 }
\DoxyCodeLine{4386 }
\DoxyCodeLine{4387 }
\DoxyCodeLine{4388     \textcolor{keywordflow}{if}( quarks(5)\%PartType.eq.-\/quarks(6)\%PartType .AND. \&}
\DoxyCodeLine{4389         ((quark1parttype.eq.-\/quarks(2)\%PartType .and. (quarks(2)\%ExtRef.ne.-\/1.or.tag\_f.ne.1) ) \&}
\DoxyCodeLine{4390     .OR. (quark1parttype.eq.-\/quarks(4)\%PartType .and. (quarks(4)\%ExtRef.ne.-\/1.or.tag\_f.ne.1) ))\&}
\DoxyCodeLine{4391     .AND. ( bosonvertex.eq.1 .OR. bosonvertex.eq.2 .OR. bosonvertex.eq.3 .OR. bosonvertex.eq.4  )  \&}
\DoxyCodeLine{4392       ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4393 \textcolor{comment}{!       print *, 'C-\/2'}}
\DoxyCodeLine{4394       \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{4395       \textcolor{keywordflow}{do} n4a=0,numglu(4)}
\DoxyCodeLine{4396       \textcolor{keywordflow}{do} n6a=0,numglu(6)}
\DoxyCodeLine{4397          n1b = numglu(1)-\/n1a}
\DoxyCodeLine{4398          n4b = numglu(4)-\/n4a}
\DoxyCodeLine{4399          n6b = numglu(6)-\/n6a}
\DoxyCodeLine{4400 }
\DoxyCodeLine{4401             rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{4402             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4403             eps2 = cur\_g\_2f(gluons(rin:rout),quarks(5:6),(/1+n4b+numglu(5)+n6a,n4b,numglu(5),n6a/))}
\DoxyCodeLine{4404             pmom1(:) = summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{4405             propfac1 = (0d0,-\/1d0)/sc\_(pmom1,pmom1)}
\DoxyCodeLine{4406             \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)).lt.propcut ) cycle}
\DoxyCodeLine{4407             eps2 = eps2*propfac1}
\DoxyCodeLine{4408 }
\DoxyCodeLine{4409             rin = n1a+1}
\DoxyCodeLine{4410             rout= numglu(1)+numglu(2)+numglu(3)+n4a}
\DoxyCodeLine{4411             bosonvertex\_mod = bosonvertex}
\DoxyCodeLine{4412             u1 = cur\_f\_4fv(gluons(rin:rout),quarks(2:4),quark1parttype,boson,bosonvertex\_mod,(/n1b+numglu(2)+numglu(3)+n4a,n1b,numglu(2),numglu(3),n4a/),0,0)}
\DoxyCodeLine{4413             pmom2  = summom(gluons,rin,rout)  + quarks(2)\%Mom + quarks(3)\%Mom + quarks(4)\%Mom + boson\%Mom}
\DoxyCodeLine{4414 }
\DoxyCodeLine{4415             \textcolor{keywordflow}{if}( quark1parttype.eq.-\/quarks(2)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4416                  \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4417                    propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{4418                    \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4419                    u1 = (-\/spi2\_(pmom2,u1) + quarks(2)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4420                    ubar0 = vbqg(u1,eps2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4421                    rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{4422                    rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4423                    pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom   \textcolor{comment}{! this PMom2 will be re-\/used below}}
\DoxyCodeLine{4424                    \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4425                        propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{4426                        \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4427                        ubar0 = (-\/spi2\_(pmom2,ubar0) + quarks(2)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4428 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{4429                  \textcolor{keywordflow}{elseif}( quarks(2)\%PartType.gt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4430                    propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{4431                    \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4432                    u1 = ( spb2\_(u1,pmom2) + quarks(2)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4433                    ubar0 = vqg(u1,eps2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4434                    rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{4435                    rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4436                    pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{4437                    \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4438                        propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{4439                        \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4440                        ubar0 = ( spb2\_(ubar0,pmom2) + quarks(2)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4441 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{4442 \textcolor{keywordflow}{                 endif}}
\DoxyCodeLine{4443                  tmpquark(1)\%Mom  => pmom2(:)}
\DoxyCodeLine{4444                  tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{4445                  tmpquark(1)\%Mass => quarks(2)\%Mass}
\DoxyCodeLine{4446                  tmpquark(1)\%Mass2=> quarks(2)\%Mass2}
\DoxyCodeLine{4447             \textcolor{keywordflow}{elseif}( quark1parttype.eq.-\/quarks(4)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4448                 \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4449                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4450                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4451                   u1 = (-\/spi2\_(pmom2,u1) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4452                   ubar0 = vbqg(u1,eps2)}
\DoxyCodeLine{4453                   rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{4454                   rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4455                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{4456                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4457                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4458                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4459                       ubar0 = (-\/spi2\_(pmom2,ubar0) + quarks(4)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4460 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4461                 \textcolor{keywordflow}{elseif}( quarks(4)\%PartType.gt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4462                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4463                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4464                   u1 = ( spb2\_(u1,pmom2) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4465                   ubar0 = vqg(u1,eps2)}
\DoxyCodeLine{4466                   rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{4467                   rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4468                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{4469                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4470                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4471                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4472                       ubar0 = ( spb2\_(ubar0,pmom2) + quarks(4)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4473 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4474 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{4475                 tmpquark(1)\%Mom  => pmom2(:)}
\DoxyCodeLine{4476                 tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{4477                 tmpquark(1)\%Mass => quarks(4)\%Mass}
\DoxyCodeLine{4478                 tmpquark(1)\%Mass2=> quarks(4)\%Mass2}
\DoxyCodeLine{4479 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{4480             tmpextref = -\/1}
\DoxyCodeLine{4481             tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{4482             tmpparttype = -\/quark1parttype}
\DoxyCodeLine{4483             tmpquark(1)\%PartType => tmpparttype}
\DoxyCodeLine{4484             counter=1}
\DoxyCodeLine{4485             rin =1}
\DoxyCodeLine{4486             rout=n1a}
\DoxyCodeLine{4487             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4488               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4489               counter=counter+1}
\DoxyCodeLine{4490 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{4491             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a+1}
\DoxyCodeLine{4492             rout=numglu(0)}
\DoxyCodeLine{4493             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4494               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4495               counter=counter+1}
\DoxyCodeLine{4496 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{4497             tmp(:) = cur\_f\_2f(tmpgluons(1:counter-\/1),tmpquark(1:1),quark1parttype,(/counter-\/1,n1a,n6b/) )}
\DoxyCodeLine{4498 }
\DoxyCodeLine{4499             res(:) = res(:) + tmp(:)}
\DoxyCodeLine{4500 }
\DoxyCodeLine{4501 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4502 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4503 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4504 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{4505 }
\DoxyCodeLine{4506 }
\DoxyCodeLine{4507 \textcolor{comment}{!   (C)}}
\DoxyCodeLine{4508     \textcolor{keywordflow}{if}( quarks(5)\%PartType.eq.-\/quarks(6)\%PartType .AND. \&}
\DoxyCodeLine{4509         ((quark1parttype.eq.-\/quarks(2)\%PartType .and. (quarks(2)\%ExtRef.ne.-\/1.or.tag\_f.ne.1) ) \&}
\DoxyCodeLine{4510     .OR. (quark1parttype.eq.-\/quarks(4)\%PartType .and. (quarks(4)\%ExtRef.ne.-\/1.or.tag\_f.ne.1) ))\&}
\DoxyCodeLine{4511     .AND. ( bosonvertex.eq.5 )  \&}
\DoxyCodeLine{4512       ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4513 \textcolor{comment}{!       print *, 'C-\/3'}}
\DoxyCodeLine{4514        \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{4515        \textcolor{keywordflow}{do} n4a=0,numglu(4)}
\DoxyCodeLine{4516        \textcolor{keywordflow}{do} n6a=0,numglu(6)}
\DoxyCodeLine{4517          n1b = numglu(1)-\/n1a}
\DoxyCodeLine{4518          n4b = numglu(4)-\/n4a}
\DoxyCodeLine{4519          n6b = numglu(6)-\/n6a}
\DoxyCodeLine{4520 }
\DoxyCodeLine{4521             rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{4522             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4523             eps2 = cur\_g\_2fv(gluons(rin:rout),quarks(5:6),boson,(/1+n4b+numglu(5)+n6a,n4b,numglu(5),n6a/))}
\DoxyCodeLine{4524             pmom1(:) = summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom + boson\%Mom}
\DoxyCodeLine{4525             propfac1 = (0d0,-\/1d0)/sc\_(pmom1,pmom1)}
\DoxyCodeLine{4526             \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)).lt.propcut ) cycle}
\DoxyCodeLine{4527             eps2 = eps2*propfac1}
\DoxyCodeLine{4528 }
\DoxyCodeLine{4529             rin = n1a+1}
\DoxyCodeLine{4530             rout= numglu(1)+numglu(2)+numglu(3)+n4a}
\DoxyCodeLine{4531             u1 = cur\_f\_4f(gluons(rin:rout),quarks(2:4),quark1parttype,(/n1b+numglu(2)+numglu(3)+n4a,n1b,numglu(2),numglu(3),n4a/),0,0)}
\DoxyCodeLine{4532             pmom2  = summom(gluons,rin,rout)  + quarks(2)\%Mom + quarks(3)\%Mom + quarks(4)\%Mom}
\DoxyCodeLine{4533 }
\DoxyCodeLine{4534             \textcolor{keywordflow}{if}( quark1parttype.eq.-\/quarks(2)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4535 }
\DoxyCodeLine{4536                  \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4537                    propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{4538                    \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4539                    u1 = (-\/spi2\_(pmom2,u1) + quarks(2)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4540                    ubar0 = vbqg(u1,eps2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4541                    rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{4542                    rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4543                    pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom   + boson\%Mom\textcolor{comment}{! this PMom2 will be re-\/used below}}
\DoxyCodeLine{4544                    \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4545                        propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{4546                        \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4547                        ubar0 = (-\/spi2\_(pmom2,ubar0) + quarks(2)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4548 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{4549                  \textcolor{keywordflow}{elseif}( quarks(2)\%PartType.gt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4550                     propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{4551                     \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4552                     u1 = ( spb2\_(u1,pmom2) + quarks(2)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4553                     ubar0 = vqg(u1,eps2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4554                    rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{4555                    rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4556                    pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom   + boson\%Mom\textcolor{comment}{! this PMom2 will be re-\/used below}}
\DoxyCodeLine{4557                    \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4558                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{4559                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4560                       u1 = ( spb2\_(u1,pmom2) + quarks(2)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4561 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{4562 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{4563                  tmpquark(1)\%Mom  => pmom2(:)}
\DoxyCodeLine{4564                  tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{4565                  tmpquark(1)\%Mass => quarks(2)\%Mass}
\DoxyCodeLine{4566                  tmpquark(1)\%Mass2=> quarks(2)\%Mass2}
\DoxyCodeLine{4567             \textcolor{keywordflow}{elseif}( quark1parttype.eq.-\/quarks(4)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4568                 \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4569                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4570                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4571                   u1 = (-\/spi2\_(pmom2,u1) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4572                   ubar0 = vbqg(u1,eps2)}
\DoxyCodeLine{4573                   rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{4574                   rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4575                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{4576                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4577                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4578                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4579                       ubar0 = (-\/spi2\_(pmom2,ubar0) + quarks(4)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4580 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4581                 \textcolor{keywordflow}{elseif}( quarks(4)\%PartType.gt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4582                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4583                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4584                   u1 = ( spb2\_(u1,pmom2) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4585                   ubar0 = vqg(u1,eps2)}
\DoxyCodeLine{4586                   rin = numglu(1)+numglu(2)+numglu(3)+n4a+1}
\DoxyCodeLine{4587                   rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4588                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{4589                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4590                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4591                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4592                       ubar0 = ( spb2\_(ubar0,pmom2) + quarks(4)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4593 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4594 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{4595                 tmpquark(1)\%Mom  => pmom2(:)}
\DoxyCodeLine{4596                 tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{4597                 tmpquark(1)\%Mass => quarks(4)\%Mass}
\DoxyCodeLine{4598                 tmpquark(1)\%Mass2=> quarks(4)\%Mass2}
\DoxyCodeLine{4599 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{4600             tmpextref = -\/1}
\DoxyCodeLine{4601             tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{4602             tmpparttype = -\/quark1parttype}
\DoxyCodeLine{4603             tmpquark(1)\%PartType => tmpparttype}
\DoxyCodeLine{4604             counter=1}
\DoxyCodeLine{4605             rin =1}
\DoxyCodeLine{4606             rout=n1a}
\DoxyCodeLine{4607             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4608               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4609               counter=counter+1}
\DoxyCodeLine{4610 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{4611             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a+1}
\DoxyCodeLine{4612             rout=numglu(0)}
\DoxyCodeLine{4613             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4614               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4615               counter=counter+1}
\DoxyCodeLine{4616 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{4617             tmp(:) = cur\_f\_2f(tmpgluons(1:counter-\/1),tmpquark(1:1),quark1parttype,(/counter-\/1,n1a,n6b/) )}
\DoxyCodeLine{4618 }
\DoxyCodeLine{4619             res(:) = res(:) + tmp(:)}
\DoxyCodeLine{4620 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{4621 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4622 \textcolor{keywordflow}{   enddo}}
\DoxyCodeLine{4623 }
\DoxyCodeLine{4624 }
\DoxyCodeLine{4625 \textcolor{keywordflow}{endif}}
\DoxyCodeLine{4626 }
\DoxyCodeLine{4627 }
\DoxyCodeLine{4628 }
\DoxyCodeLine{4629 \textcolor{comment}{!   (D)}}
\DoxyCodeLine{4630     \textcolor{keywordflow}{if}( quarks(2)\%PartType.eq.-\/quarks(3)\%PartType .AND. ( \&}
\DoxyCodeLine{4631         (quark1parttype.eq.-\/quarks(4)\%PartType .and. (quarks(4)\%ExtRef.ne.-\/1.or.tag\_f.ne.1)) \&}
\DoxyCodeLine{4632    .OR. (quark1parttype.eq.-\/quarks(6)\%PartType .and. (quarks(6)\%ExtRef.ne.-\/1.or.tag\_f.ne.1))  )  \&}
\DoxyCodeLine{4633    .AND. ( bosonvertex.eq.1  )  \&}
\DoxyCodeLine{4634      ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4635 \textcolor{comment}{!       print *, 'D-\/1'}}
\DoxyCodeLine{4636       \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{4637       \textcolor{keywordflow}{do} n3a=0,numglu(3)}
\DoxyCodeLine{4638       \textcolor{keywordflow}{do} n6a=0,numglu(6)}
\DoxyCodeLine{4639          n1b = numglu(1)-\/n1a}
\DoxyCodeLine{4640          n3b = numglu(3)-\/n3a}
\DoxyCodeLine{4641          n6b = numglu(6)-\/n6a}
\DoxyCodeLine{4642 }
\DoxyCodeLine{4643             counter=1}
\DoxyCodeLine{4644             rin = n1a+1}
\DoxyCodeLine{4645             rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{4646             eps2 = cur\_g\_2f(gluons(rin:rout),quarks(2:3),(/1+n1b+numglu(2)+n3a,n1b,numglu(2),n3a/))}
\DoxyCodeLine{4647             pmom1(:) = summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{4648             propfac1 = (0d0,-\/1d0)/sc\_(pmom1,pmom1)}
\DoxyCodeLine{4649             \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)).lt.propcut ) cycle}
\DoxyCodeLine{4650             eps2 = eps2*propfac1}
\DoxyCodeLine{4651 }
\DoxyCodeLine{4652             rin = numglu(1)+numglu(2)+n3a+1}
\DoxyCodeLine{4653             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4654             u1 = cur\_f\_4f(gluons(rin:rout),quarks(4:6),quark1parttype,(/n3b+numglu(4)+numglu(5)+n6a,n3b,numglu(4),numglu(5),n6a/),tag\_f,0)}
\DoxyCodeLine{4655             pmom2  = summom(gluons,rin,rout)  + quarks(4)\%Mom + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{4656 }
\DoxyCodeLine{4657             \textcolor{keywordflow}{if}( quark1parttype.eq.-\/quarks(4)\%PartType ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4658                 \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4659                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4660                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4661                   u1 = (-\/spi2\_(pmom2,u1) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4662                   ubar0 = vgbq(eps2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4663                   rin = n1a+1}
\DoxyCodeLine{4664                   rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{4665                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom   \textcolor{comment}{!this PMom2 will be re-\/used below  ! CAN be written as PMom2=PMom2+PMom1}}
\DoxyCodeLine{4666                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 .or. bosonvertex.eq.1 .or. bosonvertex.eq.6 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4667                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4668                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4669                       ubar0 = (-\/spi2\_(pmom2,ubar0) + quarks(4)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4670 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4671                 \textcolor{keywordflow}{elseif}( quarks(4)\%PartType.gt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4672                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4673                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4674                   u1 = ( spb2\_(u1,pmom2) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4675                   ubar0 = vgq(eps2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4676                   rin = n1a+1}
\DoxyCodeLine{4677                   rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{4678                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{4679                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1  .or. bosonvertex.eq.1 .or. bosonvertex.eq.6 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4680                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4681                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4682                       ubar0 = ( spb2\_(ubar0,pmom2) + quarks(4)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4683 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4684 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{4685                 tmpquark(1)\%Mom  => pmom2(:)}
\DoxyCodeLine{4686                 tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{4687                 tmpquark(1)\%Mass => quarks(4)\%Mass}
\DoxyCodeLine{4688                 tmpquark(1)\%Mass2=> quarks(4)\%Mass2}
\DoxyCodeLine{4689             \textcolor{keywordflow}{elseif}(quark1parttype.eq.-\/quarks(6)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4690                \textcolor{keywordflow}{if}( quarks(6)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4691                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2)}
\DoxyCodeLine{4692                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4693                   u1 = (-\/spi2\_(pmom2,u1) + quarks(6)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4694                   ubar0 = vgbq(eps2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4695                   rin = n1a+1}
\DoxyCodeLine{4696                   rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{4697                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{4698                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 .or. bosonvertex.eq.1 .or. bosonvertex.eq.6 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4699                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2)}
\DoxyCodeLine{4700                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4701                       ubar0 = (-\/spi2\_(pmom2,ubar0) + quarks(6)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4702 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4703                 \textcolor{keywordflow}{elseif}( quarks(6)\%PartType.gt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4704                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2)}
\DoxyCodeLine{4705                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4706                   u1 = ( spb2\_(u1,pmom2) + quarks(6)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4707                   ubar0 = vgq(eps2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4708                   rin = n1a+1}
\DoxyCodeLine{4709                   rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{4710                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{4711                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1  .or. bosonvertex.eq.1 .or. bosonvertex.eq.6 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4712                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2)}
\DoxyCodeLine{4713                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4714                       ubar0 = ( spb2\_(ubar0,pmom2) + quarks(6)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4715 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4716 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{4717 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{4718             tmpextref = -\/1}
\DoxyCodeLine{4719             tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{4720             tmpparttype = -\/quark1parttype}
\DoxyCodeLine{4721             tmpquark(1)\%PartType => tmpparttype}
\DoxyCodeLine{4722             counter=1}
\DoxyCodeLine{4723             rin =1}
\DoxyCodeLine{4724             rout=n1a}
\DoxyCodeLine{4725             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4726               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4727               counter=counter+1}
\DoxyCodeLine{4728 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{4729             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a+1}
\DoxyCodeLine{4730             rout=numglu(0)}
\DoxyCodeLine{4731             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4732               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4733               counter=counter+1}
\DoxyCodeLine{4734 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{4735             tmp(:) = cur\_f\_2fv(tmpgluons(1:counter-\/1),tmpquark(1:1),quark1parttype,boson,(/counter-\/1,n1a,n6b/))}
\DoxyCodeLine{4736 }
\DoxyCodeLine{4737             res(:)  = res(:) + tmp(:)}
\DoxyCodeLine{4738 }
\DoxyCodeLine{4739 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4740 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4741 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4742 \textcolor{keywordflow}{   endif}}
\DoxyCodeLine{4743 }
\DoxyCodeLine{4744 }
\DoxyCodeLine{4745 }
\DoxyCodeLine{4746 \textcolor{comment}{!   (D)}}
\DoxyCodeLine{4747     \textcolor{keywordflow}{if}( quarks(2)\%PartType.eq.-\/quarks(3)\%PartType .AND. ( \&}
\DoxyCodeLine{4748         (quark1parttype.eq.-\/quarks(4)\%PartType .and. (quarks(4)\%ExtRef.ne.-\/1.or.tag\_f.ne.1)) \&}
\DoxyCodeLine{4749    .OR. (quark1parttype.eq.-\/quarks(6)\%PartType .and. (quarks(6)\%ExtRef.ne.-\/1.or.tag\_f.ne.1))  ) \&}
\DoxyCodeLine{4750    .AND. ( bosonvertex.eq.2)  \&}
\DoxyCodeLine{4751      ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4752 \textcolor{comment}{!       print *, 'D-\/2'}}
\DoxyCodeLine{4753       \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{4754       \textcolor{keywordflow}{do} n3a=0,numglu(3)}
\DoxyCodeLine{4755       \textcolor{keywordflow}{do} n6a=0,numglu(6)}
\DoxyCodeLine{4756          n1b = numglu(1)-\/n1a}
\DoxyCodeLine{4757          n3b = numglu(3)-\/n3a}
\DoxyCodeLine{4758          n6b = numglu(6)-\/n6a}
\DoxyCodeLine{4759 }
\DoxyCodeLine{4760             counter=1}
\DoxyCodeLine{4761             rin = n1a+1}
\DoxyCodeLine{4762             rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{4763             eps2 = cur\_g\_2fv(gluons(rin:rout),quarks(2:3),boson,(/1+n1b+numglu(2)+n3a,n1b,numglu(2),n3a/))}
\DoxyCodeLine{4764             pmom1(:) = summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom +  boson\%Mom}
\DoxyCodeLine{4765             propfac1 = (0d0,-\/1d0)/sc\_(pmom1,pmom1)}
\DoxyCodeLine{4766             \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)).lt.propcut ) cycle}
\DoxyCodeLine{4767             eps2 = eps2*propfac1}
\DoxyCodeLine{4768 }
\DoxyCodeLine{4769             rin = numglu(1)+numglu(2)+n3a+1}
\DoxyCodeLine{4770             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4771             bosonvertex\_mod = bosonvertex}
\DoxyCodeLine{4772             u1 = cur\_f\_4f(gluons(rin:rout),quarks(4:6),quark1parttype,(/n3b+numglu(4)+numglu(5)+n6a,n3b,numglu(4),numglu(5),n6a/),tag\_f,0)}
\DoxyCodeLine{4773             pmom2  = summom(gluons,rin,rout)  + quarks(4)\%Mom + quarks(5)\%Mom + quarks(6)\%Mom}
\DoxyCodeLine{4774 }
\DoxyCodeLine{4775             \textcolor{keywordflow}{if}( quark1parttype.eq.-\/quarks(4)\%PartType ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4776                 \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4777                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4778                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4779                   u1 = (-\/spi2\_(pmom2,u1) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4780                   ubar0 = vgbq(eps2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4781                   rin = n1a+1}
\DoxyCodeLine{4782                   rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{4783                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom +  boson\%Mom   \textcolor{comment}{!this PMom2 will be re-\/used below  ! CAN be written as PMom2=PMom2+PMom1}}
\DoxyCodeLine{4784                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4785                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4786                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4787                       ubar0 = (-\/spi2\_(pmom2,ubar0) + quarks(4)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4788 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4789                 \textcolor{keywordflow}{elseif}( quarks(4)\%PartType.gt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4790                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4791                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4792                   u1 = ( spb2\_(u1,pmom2) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4793                   ubar0 = vgq(eps2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4794                   rin = n1a+1}
\DoxyCodeLine{4795                   rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{4796                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom + boson\%Mom}
\DoxyCodeLine{4797                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4798                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4799                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4800                       ubar0 = ( spb2\_(ubar0,pmom2) + quarks(4)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4801 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4802 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{4803             \textcolor{keywordflow}{elseif}(quark1parttype.eq.-\/quarks(6)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4804                \textcolor{keywordflow}{if}( quarks(6)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4805                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2)}
\DoxyCodeLine{4806                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4807                   u1 = (-\/spi2\_(pmom2,u1) + quarks(6)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4808                   ubar0 = vgbq(eps2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4809                   rin = n1a+1}
\DoxyCodeLine{4810                   rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{4811                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom+  boson\%Mom}
\DoxyCodeLine{4812                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4813                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2)}
\DoxyCodeLine{4814                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4815                       ubar0 = (-\/spi2\_(pmom2,ubar0) + quarks(6)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4816 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4817                 \textcolor{keywordflow}{elseif}( quarks(6)\%PartType.gt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4818                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2)}
\DoxyCodeLine{4819                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4820                   u1 = ( spb2\_(u1,pmom2) + quarks(6)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4821                   ubar0 = vgq(eps2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4822                   rin = n1a+1}
\DoxyCodeLine{4823                   rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{4824                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom + boson\%Mom}
\DoxyCodeLine{4825                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4826                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2)}
\DoxyCodeLine{4827                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4828                       ubar0 = ( spb2\_(ubar0,pmom2) + quarks(6)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4829 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4830 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{4831 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{4832             tmpquark(1)\%Mom  => pmom2(:)}
\DoxyCodeLine{4833             tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{4834             tmpquark(1)\%Mass => quarks(4)\%Mass}
\DoxyCodeLine{4835             tmpquark(1)\%Mass2=> quarks(4)\%Mass2}
\DoxyCodeLine{4836             tmpextref = -\/1}
\DoxyCodeLine{4837             tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{4838             tmpparttype = -\/quark1parttype}
\DoxyCodeLine{4839             tmpquark(1)\%PartType => tmpparttype}
\DoxyCodeLine{4840             counter=1}
\DoxyCodeLine{4841             rin =1}
\DoxyCodeLine{4842             rout=n1a}
\DoxyCodeLine{4843             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4844               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4845               counter=counter+1}
\DoxyCodeLine{4846 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{4847             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a+1}
\DoxyCodeLine{4848             rout=numglu(0)}
\DoxyCodeLine{4849             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4850               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4851               counter=counter+1}
\DoxyCodeLine{4852 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{4853             tmp(:) = cur\_f\_2f(tmpgluons(1:counter-\/1),tmpquark(1:1),quark1parttype,(/counter-\/1,n1a,n6b/))}
\DoxyCodeLine{4854 }
\DoxyCodeLine{4855             res(:)  = res(:) + tmp(:)}
\DoxyCodeLine{4856 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4857 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4858 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4859 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{4860 }
\DoxyCodeLine{4861 }
\DoxyCodeLine{4862 \textcolor{comment}{!   (D)}}
\DoxyCodeLine{4863     \textcolor{keywordflow}{if}( quarks(2)\%PartType.eq.-\/quarks(3)\%PartType .AND. ( \&}
\DoxyCodeLine{4864         (quark1parttype.eq.-\/quarks(4)\%PartType .and. (quarks(4)\%ExtRef.ne.-\/1.or.tag\_f.ne.1)) \&}
\DoxyCodeLine{4865    .OR. (quark1parttype.eq.-\/quarks(6)\%PartType .and. (quarks(6)\%ExtRef.ne.-\/1.or.tag\_f.ne.1))  ) \&}
\DoxyCodeLine{4866    .AND. ( bosonvertex .ge. 3 .and. bosonvertex .le. 6  )  ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4867 \textcolor{comment}{!       print *, 'D-\/3'}}
\DoxyCodeLine{4868        \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{4869        \textcolor{keywordflow}{do} n3a=0,numglu(3)}
\DoxyCodeLine{4870        \textcolor{keywordflow}{do} n6a=0,numglu(6)}
\DoxyCodeLine{4871          n1b = numglu(1)-\/n1a}
\DoxyCodeLine{4872          n3b = numglu(3)-\/n3a}
\DoxyCodeLine{4873          n6b = numglu(6)-\/n6a}
\DoxyCodeLine{4874 }
\DoxyCodeLine{4875          counter=1}
\DoxyCodeLine{4876          rin = n1a+1}
\DoxyCodeLine{4877          rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{4878          eps2 = cur\_g\_2f(gluons(rin:rout),quarks(2:3),(/1+n1b+numglu(2)+n3a,n1b,numglu(2),n3a/))}
\DoxyCodeLine{4879          pmom1(:) = summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{4880          propfac1 = (0d0,-\/1d0)/sc\_(pmom1,pmom1)}
\DoxyCodeLine{4881          \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)).lt.propcut ) cycle}
\DoxyCodeLine{4882          eps2 = eps2*propfac1}
\DoxyCodeLine{4883 }
\DoxyCodeLine{4884          rin = numglu(1)+numglu(2)+n3a+1}
\DoxyCodeLine{4885          rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a}
\DoxyCodeLine{4886          bosonvertex\_mod=bosonvertex-\/2}
\DoxyCodeLine{4887          u1 = cur\_f\_4fv(gluons(rin:rout),quarks(4:6),quark1parttype,boson,bosonvertex\_mod,(/n3b+numglu(4)+numglu(5)+n6a,n3b,numglu(4),numglu(5),n6a/),tag\_f,0)}
\DoxyCodeLine{4888          pmom2  = summom(gluons,rin,rout)  + quarks(4)\%Mom + quarks(5)\%Mom + quarks(6)\%Mom+boson\%Mom}
\DoxyCodeLine{4889 }
\DoxyCodeLine{4890             \textcolor{keywordflow}{if}( quark1parttype.eq.-\/quarks(4)\%PartType ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4891                 \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4892                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4893                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4894                   u1 = (-\/spi2\_(pmom2,u1) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4895                   ubar0 = vgbq(eps2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4896                   rin = n1a+1}
\DoxyCodeLine{4897                   rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{4898                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom   \textcolor{comment}{!this PMom2 will be re-\/used below  ! CAN be written as PMom2=PMom2+PMom1}}
\DoxyCodeLine{4899                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4900                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4901                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4902                       ubar0 = (-\/spi2\_(pmom2,ubar0) + quarks(4)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4903 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4904                 \textcolor{keywordflow}{elseif}( quarks(4)\%PartType.gt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4905                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4906                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4907                   u1 = ( spb2\_(u1,pmom2) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4908                   ubar0 = vgq(eps2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4909                   rin = n1a+1}
\DoxyCodeLine{4910                   rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{4911                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{4912                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4913                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{4914                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4915                       ubar0 = ( spb2\_(ubar0,pmom2) + quarks(4)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4916 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4917 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{4918                 tmpquark(1)\%Mom  => pmom2(:)}
\DoxyCodeLine{4919                 tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{4920                 tmpquark(1)\%Mass => quarks(4)\%Mass}
\DoxyCodeLine{4921                 tmpquark(1)\%Mass2=> quarks(4)\%Mass2}
\DoxyCodeLine{4922             \textcolor{keywordflow}{elseif}(quark1parttype.eq.-\/quarks(6)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4923                 \textcolor{keywordflow}{if}( quarks(6)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4924                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2)}
\DoxyCodeLine{4925                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4926                   u1 = (-\/spi2\_(pmom2,u1) + quarks(6)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4927                   ubar0 = vgbq(eps2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4928                   rin = n1a+1}
\DoxyCodeLine{4929                   rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{4930                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{4931                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4932                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2)}
\DoxyCodeLine{4933                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4934                       ubar0 = (-\/spi2\_(pmom2,ubar0) + quarks(6)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4935 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4936                 \textcolor{keywordflow}{elseif}( quarks(6)\%PartType.gt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4937                   propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2)}
\DoxyCodeLine{4938                   \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4939                   u1 = ( spb2\_(u1,pmom2) + quarks(6)\%Mass*u1 )*propfac2}
\DoxyCodeLine{4940                   ubar0 = vgq(eps2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{4941                   rin = n1a+1}
\DoxyCodeLine{4942                   rout= numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{4943                   pmom2 = pmom2 + summom(gluons,rin,rout) + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{4944                   \textcolor{keywordflow}{if}( n1a.ge.1 .or. n6b.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4945                       propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2)}
\DoxyCodeLine{4946                       \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(6)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{4947                       ubar0 = ( spb2\_(ubar0,pmom2) + quarks(6)\%Mass*ubar0 )*propfac2}
\DoxyCodeLine{4948 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{4949 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{4950                 tmpquark(1)\%Mom  => pmom2(:)}
\DoxyCodeLine{4951                 tmpquark(1)\%Pol  => ubar0(:)}
\DoxyCodeLine{4952                 tmpquark(1)\%Mass => quarks(6)\%Mass}
\DoxyCodeLine{4953                 tmpquark(1)\%Mass2=> quarks(6)\%Mass2}
\DoxyCodeLine{4954 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{4955             tmpextref = -\/1}
\DoxyCodeLine{4956             tmpquark(1)\%ExtRef => tmpextref}
\DoxyCodeLine{4957             tmpparttype = -\/quark1parttype}
\DoxyCodeLine{4958             tmpquark(1)\%PartType => tmpparttype}
\DoxyCodeLine{4959             counter=1}
\DoxyCodeLine{4960             rin =1}
\DoxyCodeLine{4961             rout=n1a}
\DoxyCodeLine{4962             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4963               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4964               counter=counter+1}
\DoxyCodeLine{4965 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{4966             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+numglu(5)+n6a+1}
\DoxyCodeLine{4967             rout=numglu(0)}
\DoxyCodeLine{4968             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{4969               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{4970               counter=counter+1}
\DoxyCodeLine{4971 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{4972             tmp(:) = cur\_f\_2f(tmpgluons(1:counter-\/1),tmpquark(1:1),quark1parttype,(/counter-\/1,n1a,n6b/))}
\DoxyCodeLine{4973 }
\DoxyCodeLine{4974             res(:)  = res(:) + tmp(:)}
\DoxyCodeLine{4975 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4976 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4977 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{4978 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{4979 }
\DoxyCodeLine{4980 }
\DoxyCodeLine{4981 \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a0dc774774e5e2448b8831066fb707b53}\label{namespacemodttbhiggs_a0dc774774e5e2448b8831066fb707b53}} 
\index{modttbhiggs@{modttbhiggs}!cur\_g@{cur\_g}}
\index{cur\_g@{cur\_g}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{cur\_g()}{cur\_g()}}
{\footnotesize\ttfamily complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}) modttbhiggs\+::cur\+\_\+g (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(1\+:)}]{Gluons,  }\item[{integer}]{Num\+Glu }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1705 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1705 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1706 \textcolor{keywordtype}{type}(PtrToParticle) :: Gluons(1:)}
\DoxyCodeLine{1707 \textcolor{keywordtype}{complex(8)} :: cur\_g(1:Dv)}
\DoxyCodeLine{1708 \textcolor{keywordtype}{integer} :: Ngluons,NumGlu}
\DoxyCodeLine{1709 \textcolor{keywordtype}{complex(8)} :: glu\_subcur(1:Dv,1:36)  \textcolor{comment}{! max. 8 gluons allowed}}
\DoxyCodeLine{1710 \textcolor{keywordtype}{complex(8)} :: mom\_sum(1:Dv,1:36), PropFactor,PropDenom}
\DoxyCodeLine{1711 \textcolor{keywordtype}{integer} :: ind0,ind1,ind2,ind3,j,l,mu}
\DoxyCodeLine{1712 \textcolor{keywordtype}{integer} :: a,b,i1,i2}
\DoxyCodeLine{1713 }
\DoxyCodeLine{1714 \textcolor{comment}{!DEC\$ IF (\_DebugWriteCurrents==1)}}
\DoxyCodeLine{1715 \textcolor{keywordtype}{character} :: parts(20)*4}
\DoxyCodeLine{1716 \textcolor{keywordtype}{integer} :: parti(20)}
\DoxyCodeLine{1717 }
\DoxyCodeLine{1718     \textcolor{keywordflow}{do} i1=1,numglu-\/1}
\DoxyCodeLine{1719        \textcolor{keywordflow}{if}( gluons(i1)\%ExtRef.eq.-\/1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1720           \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1721        \textcolor{keywordflow}{else}}
\DoxyCodeLine{1722           parti(i1)=gluons(i1)\%ExtRef}
\DoxyCodeLine{1723 \textcolor{keywordflow}{       endif}}
\DoxyCodeLine{1724        \textcolor{keywordflow}{if}(i1.eq.numglu-\/1) print *, parti(1:numglu-\/1)}
\DoxyCodeLine{1725 \textcolor{comment}{!       write (parts(1:20), '(I20)') parti(1:NumGlu-\/1)}}
\DoxyCodeLine{1726 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{1727 \textcolor{comment}{!DEC\$ ENDIF}}
\DoxyCodeLine{1728 }
\DoxyCodeLine{1729    ngluons = numglu-\/1}
\DoxyCodeLine{1730 }
\DoxyCodeLine{1731    \textcolor{keywordflow}{do} a=0,ngluons-\/1}
\DoxyCodeLine{1732       \textcolor{keywordflow}{do} b=1,ngluons-\/a}
\DoxyCodeLine{1733 }
\DoxyCodeLine{1734          i1 = b}
\DoxyCodeLine{1735          i2 = a+b}
\DoxyCodeLine{1736          ind0 = linear\_map(i1,i2,ngluons)}
\DoxyCodeLine{1737 }
\DoxyCodeLine{1738          \textcolor{keywordflow}{if} (i1.eq.i2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1739             glu\_subcur(1:dv,ind0) = gluons(i1)\%Pol(1:dv)}
\DoxyCodeLine{1740             mom\_sum(1:dv,ind0)    = gluons(i1)\%Mom(1:dv)}
\DoxyCodeLine{1741          \textcolor{keywordflow}{else}}
\DoxyCodeLine{1742             mom\_sum(1:dv,ind0) = mom\_sum(1:dv,ind0-\/ngluons+i2-\/i1-\/1) + gluons(i2)\%Mom(1:dv)}
\DoxyCodeLine{1743             \textcolor{keywordflow}{if} ( i1 .ne. 1 .or. i2 .ne. ngluons ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1744                propdenom = mom\_sum(1:dv,ind0).ndot.mom\_sum(1:dv,ind0)}
\DoxyCodeLine{1745                \textcolor{keywordflow}{if}( abs(propdenom).lt.propcut ) cycle}
\DoxyCodeLine{1746                propfactor = (0d0,-\/1d0)/propdenom}
\DoxyCodeLine{1747             \textcolor{keywordflow}{else}}
\DoxyCodeLine{1748                propfactor = 1d0}
\DoxyCodeLine{1749 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{1750             \textcolor{keywordflow}{do} mu=1,dv}
\DoxyCodeLine{1751                glu\_subcur(mu,ind0) = 0d0}
\DoxyCodeLine{1752 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{1753             \textcolor{keywordflow}{do} j=i1,i2-\/1}
\DoxyCodeLine{1754                ind1 = linear\_map(i1,j,ngluons)}
\DoxyCodeLine{1755                ind2 = linear\_map(j+1,i2,ngluons)}
\DoxyCodeLine{1756                glu\_subcur(1:dv,ind0) = glu\_subcur(1:dv,ind0) +            \&}
\DoxyCodeLine{1757                    eval\_tripvert( mom\_sum(1:dv,ind1),mom\_sum(1:dv,ind2),  \&}
\DoxyCodeLine{1758                                    glu\_subcur(1:dv,ind1),glu\_subcur(1:dv,ind2)) * propfactor}
\DoxyCodeLine{1759 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{1760             \textcolor{keywordflow}{do} j=i1,i2-\/2}
\DoxyCodeLine{1761                \textcolor{keywordflow}{do} l=j+1,i2-\/1}
\DoxyCodeLine{1762                   ind1 = linear\_map(i1,j,ngluons)}
\DoxyCodeLine{1763                   ind2 = linear\_map(j+1,l,ngluons)}
\DoxyCodeLine{1764                   ind3 = linear\_map(l+1,i2,ngluons)}
\DoxyCodeLine{1765                   glu\_subcur(1:dv,ind0) = glu\_subcur(1:dv,ind0) +  \&}
\DoxyCodeLine{1766                       eval\_quadvert(                                       \&}
\DoxyCodeLine{1767                         glu\_subcur(1:dv,ind1),glu\_subcur(1:dv,ind2),glu\_subcur(1:dv,ind3)) * propfactor}
\DoxyCodeLine{1768 \textcolor{keywordflow}{               enddo}}
\DoxyCodeLine{1769 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{1770 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{1771 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1772 \textcolor{keywordflow}{   enddo}}
\DoxyCodeLine{1773    cur\_g(1:dv) = glu\_subcur(1:dv,ind0)}
\DoxyCodeLine{1774 }
\DoxyCodeLine{1775 \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_ac2974da70d23237fa04bb606cce64e0d}\label{namespacemodttbhiggs_ac2974da70d23237fa04bb606cce64e0d}} 
\index{modttbhiggs@{modttbhiggs}!cur\_g\_2f@{cur\_g\_2f}}
\index{cur\_g\_2f@{cur\_g\_2f}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{cur\_g\_2f()}{cur\_g\_2f()}}
{\footnotesize\ttfamily complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}) modttbhiggs\+::cur\+\_\+g\+\_\+2f (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(1\+:)}]{Gluons,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(1\+:2)}]{Quarks,  }\item[{integer, dimension(0\+:3)}]{Num\+Glu }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 2006 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2006 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{2007 \textcolor{keywordtype}{integer} :: NumGlu(0:3),i,counter}
\DoxyCodeLine{2008 \textcolor{keywordtype}{type}(PtrToParticle) :: Gluons(1:),Quarks(1:2)}
\DoxyCodeLine{2009 \textcolor{keywordtype}{integer} :: rIn,rOut,n1a,n1b,n2a,n2b,n3a,n3b}
\DoxyCodeLine{2010 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{target} :: TmpExtRef}
\DoxyCodeLine{2011 \textcolor{keywordtype}{complex(8)} :: Res(1:Dv)}
\DoxyCodeLine{2012 \textcolor{keywordtype}{complex(8)} :: u1(1:Ds),ubar2(1:Ds)}
\DoxyCodeLine{2013 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: Eps1(1:Dv)}
\DoxyCodeLine{2014 \textcolor{keywordtype}{complex(8)} :: Eps2(1:Dv)}
\DoxyCodeLine{2015 \textcolor{keywordtype}{type}(PtrToParticle) :: TmpGluons(1:NumGlu(1)+NumGlu(3)+1)}
\DoxyCodeLine{2016 \textcolor{keywordtype}{complex(8)} :: PMom1(1:Dv),PMom2(1:Dv),PMom4(1:Dv)}
\DoxyCodeLine{2017 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: PMom3(1:Dv)}
\DoxyCodeLine{2018 \textcolor{keywordtype}{complex(8)} :: PropFac1,PropFac2,PropFac3,PropFac4}
\DoxyCodeLine{2019 \textcolor{keywordtype}{integer} :: PartKey,HelKey,CurrKey,Hel\_Tmp}
\DoxyCodeLine{2020 }
\DoxyCodeLine{2021 }
\DoxyCodeLine{2022 }
\DoxyCodeLine{2023 }
\DoxyCodeLine{2024    res = (0d0,0d0)}
\DoxyCodeLine{2025    \textcolor{keywordflow}{if}( quarks(1)\%PartType .ne. -\/quarks(2)\%PartType ) \textcolor{keywordflow}{return}}
\DoxyCodeLine{2026    \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{2027    \textcolor{keywordflow}{do} n3a=0,numglu(3)}
\DoxyCodeLine{2028    \textcolor{keywordflow}{do} n2a=0,numglu(2)}
\DoxyCodeLine{2029       n1b=numglu(1)-\/n1a}
\DoxyCodeLine{2030       n2b=numglu(2)-\/n2a}
\DoxyCodeLine{2031       n3b=numglu(3)-\/n3a}
\DoxyCodeLine{2032       \textcolor{comment}{! Fer1}}
\DoxyCodeLine{2033       rin=n1a+1}
\DoxyCodeLine{2034       rout=numglu(1)+n2a}
\DoxyCodeLine{2035       pmom1(:) = quarks(1)\%Mom(:)+ summom(gluons,rin,rout)}
\DoxyCodeLine{2036       u1(:) = cur\_f\_2f(gluons(rin:rout),quarks(1:1),-\/quarks(1)\%PartType,(/n1b+n2a,n1b,n2a/))}
\DoxyCodeLine{2037       \textcolor{keywordflow}{if}(n1b.ge.1 .or. n2a.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2038          propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1)-\/quarks(1)\%Mass2)}
\DoxyCodeLine{2039          \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)-\/quarks(1)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2040          \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2041             u1(:) = (-\/spi2\_(pmom1,u1)+quarks(1)\%Mass*u1(:) )*propfac1}
\DoxyCodeLine{2042          \textcolor{keywordflow}{else}}
\DoxyCodeLine{2043             u1(:) = (+spb2\_(u1,pmom1)+quarks(1)\%Mass*u1(:) )*propfac1}
\DoxyCodeLine{2044 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{2045 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{2046 }
\DoxyCodeLine{2047       \textcolor{comment}{! Fer2}}
\DoxyCodeLine{2048       rin=numglu(1)+n2a+1}
\DoxyCodeLine{2049       rout=numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{2050       pmom2(:) = quarks(2)\%Mom(:)+ summom(gluons,rin,rout)}
\DoxyCodeLine{2051       ubar2(:) = cur\_f\_2f(gluons(rin:rout),quarks(2:2),-\/quarks(2)\%PartType,(/n2b+n3a,n2b,n3a/))}
\DoxyCodeLine{2052       \textcolor{keywordflow}{if}(n2b.ge.1 .or. n3a.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2053          propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{2054          \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2055          \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2056             ubar2(:) = (-\/spi2\_(pmom2,ubar2)+quarks(2)\%Mass*ubar2(:) )*propfac2}
\DoxyCodeLine{2057          \textcolor{keywordflow}{else}}
\DoxyCodeLine{2058             ubar2(:) = (+spb2\_(ubar2,pmom2)+quarks(2)\%Mass*ubar2(:) )*propfac2}
\DoxyCodeLine{2059 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{2060 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{2061 }
\DoxyCodeLine{2062       \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2063          eps1(:)= -\/vbqq(dv,ubar2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2064       \textcolor{keywordflow}{else}}
\DoxyCodeLine{2065          eps1(:)= +vbqq(dv,u1,ubar2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2066 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{2067       pmom3(:) = quarks(1)\%Mom(:)+quarks(2)\%Mom(:) + summom(gluons,n1a+1,numglu(1)+numglu(2)+n3a)}
\DoxyCodeLine{2068       counter=1}
\DoxyCodeLine{2069       rin =1}
\DoxyCodeLine{2070       rout=n1a}
\DoxyCodeLine{2071       \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2072          \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2073          counter=counter+1}
\DoxyCodeLine{2074 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{2075       tmpgluons(counter)\%Mom => pmom3(:)}
\DoxyCodeLine{2076       tmpgluons(counter)\%Pol => eps1(:)}
\DoxyCodeLine{2077       tmpextref = -\/1}
\DoxyCodeLine{2078       tmpgluons(counter)\%ExtRef => tmpextref}
\DoxyCodeLine{2079       counter=counter+1}
\DoxyCodeLine{2080       rin =numglu(1)+numglu(2)+n3a+1}
\DoxyCodeLine{2081       rout=numglu(1)+numglu(2)+numglu(3)}
\DoxyCodeLine{2082       \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2083          \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2084          counter=counter+1}
\DoxyCodeLine{2085 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{2086       eps2(:) = cur\_g(tmpgluons(1:counter-\/1),1+n1a+n3b+1)}
\DoxyCodeLine{2087 }
\DoxyCodeLine{2088 }
\DoxyCodeLine{2089       \textcolor{keywordflow}{if}(n1a.ge.1 .or. n3b.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2090          propfac3 = (0d0,-\/1d0)/sc\_(pmom3,pmom3)}
\DoxyCodeLine{2091          \textcolor{keywordflow}{if}( abs(sc\_(pmom3,pmom3)).lt.propcut ) cycle}
\DoxyCodeLine{2092          eps2(:) = eps2(:)*propfac3}
\DoxyCodeLine{2093 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{2094 }
\DoxyCodeLine{2095       res(:) = res(:) + eps2(:)}
\DoxyCodeLine{2096 \textcolor{keywordflow}{   enddo}}
\DoxyCodeLine{2097 \textcolor{keywordflow}{   enddo}}
\DoxyCodeLine{2098 \textcolor{keywordflow}{   enddo}}
\DoxyCodeLine{2099 }
\DoxyCodeLine{2100 }
\DoxyCodeLine{2101 }
\DoxyCodeLine{2102 \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a10392cd5645a49f21e9eedfe34cff22a}\label{namespacemodttbhiggs_a10392cd5645a49f21e9eedfe34cff22a}} 
\index{modttbhiggs@{modttbhiggs}!cur\_g\_2fv@{cur\_g\_2fv}}
\index{cur\_g\_2fv@{cur\_g\_2fv}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{cur\_g\_2fv()}{cur\_g\_2fv()}}
{\footnotesize\ttfamily complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}) modttbhiggs\+::cur\+\_\+g\+\_\+2fv (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(1\+:)}]{Gluons,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(1\+:2)}]{Quarks,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}})}]{Boson,  }\item[{integer, dimension(0\+:3)}]{Num\+Glu }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 2110 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2110 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{2111 \textcolor{keywordtype}{integer} :: NumGlu(0:3),i,counter}
\DoxyCodeLine{2112 \textcolor{keywordtype}{type}(PtrToParticle) :: Gluons(1:),Quarks(1:2),Boson}
\DoxyCodeLine{2113 \textcolor{keywordtype}{integer} :: rIn,rOut,n1a,n1b,n2a,n2b,n3a,n3b}
\DoxyCodeLine{2114 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{target} :: TmpExtRef}
\DoxyCodeLine{2115 \textcolor{keywordtype}{complex(8)} :: Res(1:Dv)}
\DoxyCodeLine{2116 \textcolor{keywordtype}{complex(8)} :: u1(1:Ds),ubar2(1:Ds)}
\DoxyCodeLine{2117 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: Eps1(1:Dv)}
\DoxyCodeLine{2118 \textcolor{keywordtype}{complex(8)} :: Eps2(1:Dv)}
\DoxyCodeLine{2119 \textcolor{keywordtype}{type}(PtrToParticle) :: TmpGluons(1:NumGlu(1)+NumGlu(3)+1)}
\DoxyCodeLine{2120 \textcolor{keywordtype}{complex(8)} :: PMom1(1:Dv),PMom2(1:Dv),PMom4(1:Dv)}
\DoxyCodeLine{2121 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: PMom3(1:Dv)}
\DoxyCodeLine{2122 \textcolor{keywordtype}{complex(8)} :: PropFac1,PropFac2,PropFac3,PropFac4}
\DoxyCodeLine{2123 \textcolor{keywordtype}{integer} :: PartKey,HelKey,CurrKey,Hel\_Tmp}
\DoxyCodeLine{2124 }
\DoxyCodeLine{2125 }
\DoxyCodeLine{2126 }
\DoxyCodeLine{2127 }
\DoxyCodeLine{2128 \textcolor{comment}{!DEC\$ IF (\_DebugCheckMyImpl1==1)}}
\DoxyCodeLine{2129    \textcolor{keywordflow}{if}(quarks(1)\%PartType*quarks(2)\%PartType.ge.0) print *,\textcolor{stringliteral}{"Error in cur\_g\_2f: wrong PartTypes"}}
\DoxyCodeLine{2130 \textcolor{comment}{!DEC\$ ENDIF}}
\DoxyCodeLine{2131 \textcolor{comment}{!DEC\$ IF (\_DebugCheckMyImpl1==1)}}
\DoxyCodeLine{2132     \textcolor{keywordflow}{if}( numglu(0)-\/1-\/numglu(1)-\/numglu(2)-\/numglu(3).ne.0 ) print *, \textcolor{stringliteral}{"wrong number of gluons in cur\_g\_2f"}}
\DoxyCodeLine{2133 \textcolor{comment}{!DEC\$ ENDIF}}
\DoxyCodeLine{2134 }
\DoxyCodeLine{2135    res = (0d0,0d0)}
\DoxyCodeLine{2136    \textcolor{keywordflow}{if}( quarks(1)\%PartType .ne. -\/quarks(2)\%PartType ) \textcolor{keywordflow}{return}}
\DoxyCodeLine{2137    \textcolor{keywordflow}{do} n1a=0,numglu(1)}
\DoxyCodeLine{2138    \textcolor{keywordflow}{do} n3a=0,numglu(3)}
\DoxyCodeLine{2139    \textcolor{keywordflow}{do} n2a=0,numglu(2)}
\DoxyCodeLine{2140       n1b=numglu(1)-\/n1a}
\DoxyCodeLine{2141       n2b=numglu(2)-\/n2a}
\DoxyCodeLine{2142       n3b=numglu(3)-\/n3a}
\DoxyCodeLine{2143 }
\DoxyCodeLine{2144       \textcolor{comment}{! Fer1 and V coupling}}
\DoxyCodeLine{2145       rin=n1a+1}
\DoxyCodeLine{2146       rout=numglu(1)+n2a}
\DoxyCodeLine{2147       pmom1(:) = quarks(1)\%Mom(:) + summom(gluons,rin,rout) + boson\%Mom(:)}
\DoxyCodeLine{2148       u1(:) = cur\_f\_2fv(gluons(rin:rout),quarks(1:1),-\/quarks(1)\%PartType,boson,(/n1b+n2a,n1b,n2a/))}
\DoxyCodeLine{2149       \textcolor{comment}{!if(n1b.ge.1 .or. n2a.ge.1) then}}
\DoxyCodeLine{2150          propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1)-\/quarks(1)\%Mass2)}
\DoxyCodeLine{2151          \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)-\/quarks(1)\%Mass2).lt.propcut ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2152             propfac1=(0d0,0d0)}
\DoxyCodeLine{2153 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{2154          \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2155             u1(:) = (-\/spi2\_(pmom1,u1)+quarks(1)\%Mass*u1(:) )*propfac1}
\DoxyCodeLine{2156          \textcolor{keywordflow}{else}}
\DoxyCodeLine{2157             u1(:) = (+spb2\_(u1,pmom1)+quarks(1)\%Mass*u1(:) )*propfac1}
\DoxyCodeLine{2158 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{2159       \textcolor{comment}{!endif}}
\DoxyCodeLine{2160 }
\DoxyCodeLine{2161       \textcolor{comment}{! Fer2}}
\DoxyCodeLine{2162       rin=numglu(1)+n2a+1}
\DoxyCodeLine{2163       rout=numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{2164       pmom2(:) = quarks(2)\%Mom(:)+ summom(gluons,rin,rout)}
\DoxyCodeLine{2165       ubar2(:) = cur\_f\_2f(gluons(rin:rout),quarks(2:2),-\/quarks(2)\%PartType,(/n2b+n3a,n2b,n3a/))}
\DoxyCodeLine{2166       \textcolor{keywordflow}{if}(n2b.ge.1 .or. n3a.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2167          propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{2168          \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2).lt.propcut ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2169             propfac2=(0d0,0d0)}
\DoxyCodeLine{2170 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{2171          \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2172             ubar2(:) = (-\/spi2\_(pmom2,ubar2)+quarks(2)\%Mass*ubar2(:) )*propfac2}
\DoxyCodeLine{2173          \textcolor{keywordflow}{else}}
\DoxyCodeLine{2174             ubar2(:) = (+spb2\_(ubar2,pmom2)+quarks(2)\%Mass*ubar2(:) )*propfac2}
\DoxyCodeLine{2175 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{2176 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{2177 }
\DoxyCodeLine{2178 }
\DoxyCodeLine{2179       \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2180          eps1(:)= -\/vbqq(dv,ubar2,u1)}
\DoxyCodeLine{2181       \textcolor{keywordflow}{else}}
\DoxyCodeLine{2182          eps1(:)= +vbqq(dv,u1,ubar2)}
\DoxyCodeLine{2183 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{2184 }
\DoxyCodeLine{2185 }
\DoxyCodeLine{2186 }
\DoxyCodeLine{2187 }
\DoxyCodeLine{2188 }
\DoxyCodeLine{2189       \textcolor{comment}{! Fer1}}
\DoxyCodeLine{2190       rin=n1a+1}
\DoxyCodeLine{2191       rout=numglu(1)+n2a}
\DoxyCodeLine{2192       pmom1(:) = quarks(1)\%Mom(:) + summom(gluons,rin,rout)}
\DoxyCodeLine{2193       u1(:) = cur\_f\_2f(gluons(rin:rout),quarks(1:1),-\/quarks(1)\%PartType,(/n1b+n2a,n1b,n2a/))}
\DoxyCodeLine{2194       \textcolor{keywordflow}{if}(n1b.ge.1 .or. n2a.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2195          propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1)-\/quarks(1)\%Mass2)}
\DoxyCodeLine{2196          \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1)-\/quarks(1)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2197          \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2198             u1(:) = (-\/spi2\_(pmom1,u1)+quarks(1)\%Mass*u1(:) )*propfac1}
\DoxyCodeLine{2199          \textcolor{keywordflow}{else}}
\DoxyCodeLine{2200             u1(:) = (+spb2\_(u1,pmom1)+quarks(1)\%Mass*u1(:) )*propfac1}
\DoxyCodeLine{2201 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{2202 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{2203 }
\DoxyCodeLine{2204       \textcolor{comment}{! Fer2 and V coupling}}
\DoxyCodeLine{2205       rin=numglu(1)+n2a+1}
\DoxyCodeLine{2206       rout=numglu(1)+numglu(2)+n3a}
\DoxyCodeLine{2207       pmom2(:) = quarks(2)\%Mom(:)+ summom(gluons,rin,rout) + boson\%Mom(:)}
\DoxyCodeLine{2208       ubar2(:) = cur\_f\_2fv(gluons(rin:rout),quarks(2:2),-\/quarks(2)\%PartType,boson,(/n2b+n3a,n2b,n3a/))}
\DoxyCodeLine{2209       \textcolor{comment}{!if(n2b.ge.1 .or. n3a.ge.1) then}}
\DoxyCodeLine{2210          propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2)}
\DoxyCodeLine{2211          \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2)-\/quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2212          \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2213             ubar2(:) = (-\/spi2\_(pmom2,ubar2)+quarks(2)\%Mass*ubar2(:) )*propfac2}
\DoxyCodeLine{2214          \textcolor{keywordflow}{else}}
\DoxyCodeLine{2215             ubar2(:) = (+spb2\_(ubar2,pmom2)+quarks(2)\%Mass*ubar2(:) )*propfac2}
\DoxyCodeLine{2216 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{2217       \textcolor{comment}{!endif}}
\DoxyCodeLine{2218 }
\DoxyCodeLine{2219       \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2220          eps1(:)= eps1(:) -\/ vbqq(dv,ubar2,u1)}
\DoxyCodeLine{2221       \textcolor{keywordflow}{else}}
\DoxyCodeLine{2222          eps1(:)= eps1(:) + vbqq(dv,u1,ubar2)}
\DoxyCodeLine{2223 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{2224 \textcolor{comment}{!}}
\DoxyCodeLine{2225 }
\DoxyCodeLine{2226       pmom3(:) = quarks(1)\%Mom(:)+quarks(2)\%Mom(:) + summom(gluons,n1a+1,numglu(1)+numglu(2)+n3a) + boson\%Mom(:)}
\DoxyCodeLine{2227       counter=1}
\DoxyCodeLine{2228       rin =1}
\DoxyCodeLine{2229       rout=n1a}
\DoxyCodeLine{2230       \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2231          \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2232          counter=counter+1}
\DoxyCodeLine{2233 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{2234       tmpgluons(counter)\%Mom => pmom3(:)}
\DoxyCodeLine{2235       tmpgluons(counter)\%Pol => eps1(:)}
\DoxyCodeLine{2236       tmpextref = -\/1}
\DoxyCodeLine{2237       tmpgluons(counter)\%ExtRef => tmpextref}
\DoxyCodeLine{2238       counter=counter+1}
\DoxyCodeLine{2239       rin =numglu(1)+numglu(2)+n3a+1}
\DoxyCodeLine{2240       rout=numglu(1)+numglu(2)+numglu(3)}
\DoxyCodeLine{2241       \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2242          \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2243          counter=counter+1}
\DoxyCodeLine{2244 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{2245       eps2(:) = cur\_g(tmpgluons(1:counter-\/1),1+n1a+n3b+1)}
\DoxyCodeLine{2246 }
\DoxyCodeLine{2247 }
\DoxyCodeLine{2248       \textcolor{keywordflow}{if}(n1a.ge.1 .or. n3b.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2249          propfac3 = (0d0,-\/1d0)/sc\_(pmom3,pmom3)}
\DoxyCodeLine{2250          \textcolor{keywordflow}{if}( abs(sc\_(pmom3,pmom3)).lt.propcut ) cycle}
\DoxyCodeLine{2251          eps2(:) = eps2(:)*propfac3}
\DoxyCodeLine{2252 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{2253 }
\DoxyCodeLine{2254       res(:) = res(:) + eps2(:)}
\DoxyCodeLine{2255 }
\DoxyCodeLine{2256 \textcolor{keywordflow}{   enddo}}
\DoxyCodeLine{2257 \textcolor{keywordflow}{   enddo}}
\DoxyCodeLine{2258 \textcolor{keywordflow}{   enddo}}
\DoxyCodeLine{2259 }
\DoxyCodeLine{2260 }
\DoxyCodeLine{2261 }
\DoxyCodeLine{2262 \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a82bea00e16ce7c2b885be798bb71bd76}\label{namespacemodttbhiggs_a82bea00e16ce7c2b885be798bb71bd76}} 
\index{modttbhiggs@{modttbhiggs}!cur\_g\_4f@{cur\_g\_4f}}
\index{cur\_g\_4f@{cur\_g\_4f}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{cur\_g\_4f()}{cur\_g\_4f()}}
{\footnotesize\ttfamily complex(8) function, dimension(\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}) modttbhiggs\+::cur\+\_\+g\+\_\+4f (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(1\+:)}]{Gluons,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(1\+:)}]{Quarks,  }\item[{integer, dimension(0\+:5), intent(in)}]{Num\+Glu }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 2344 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2344 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{2345 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{intent(in)} :: NumGlu(0:5)}
\DoxyCodeLine{2346 \textcolor{keywordtype}{type}(PtrToParticle) :: Gluons(1:),Quarks(1:)}
\DoxyCodeLine{2347 \textcolor{keywordtype}{integer} :: na,nb,nc,nd,ne,nf,ng,nh,ni,nj,nk}
\DoxyCodeLine{2348 \textcolor{keywordtype}{integer} :: rIn,rOut}
\DoxyCodeLine{2349 \textcolor{keywordtype}{integer} :: tag\_f,counter,i}
\DoxyCodeLine{2350 \textcolor{keywordtype}{complex(8)} :: res(Dv)}
\DoxyCodeLine{2351 \textcolor{keywordtype}{type}(PtrToParticle) :: TmpGluons(1:2+NumGlu(1)+NumGlu(3)+NumGlu(5))}
\DoxyCodeLine{2352 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: TmpMom1(1:Dv),TmpMom2(1:Dv)}
\DoxyCodeLine{2353 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{target} :: TmpExtRef1,TmpExtRef2}
\DoxyCodeLine{2354 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: Eps1(1:Dv)}
\DoxyCodeLine{2355 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: Eps2(1:Dv)}
\DoxyCodeLine{2356 \textcolor{keywordtype}{complex(8)} :: Eps3(1:Dv)}
\DoxyCodeLine{2357 \textcolor{keywordtype}{complex(8)} :: u1(1:Ds)}
\DoxyCodeLine{2358 \textcolor{keywordtype}{complex(8)} :: ubar2(1:Ds)}
\DoxyCodeLine{2359 \textcolor{keywordtype}{complex(8)} :: PropFac1,PropFac2,PropFac3,PropFac4}
\DoxyCodeLine{2360 \textcolor{keywordtype}{complex(8)} :: PMom1(1:Dv)}
\DoxyCodeLine{2361 \textcolor{keywordtype}{complex(8)} :: PMom2(1:Dv)}
\DoxyCodeLine{2362 \textcolor{keywordtype}{complex(8)} :: PMom3(1:Dv)}
\DoxyCodeLine{2363 \textcolor{keywordtype}{complex(8)} :: PMom4(1:Dv)}
\DoxyCodeLine{2364 }
\DoxyCodeLine{2365 \textcolor{comment}{!DEC\$ IF (\_DebugCheckMyImpl1==1)}}
\DoxyCodeLine{2366     \textcolor{keywordflow}{if}( numglu(0)-\/1-\/numglu(1)-\/numglu(2)-\/numglu(3)-\/numglu(4)-\/numglu(5).ne.0 ) print *, \textcolor{stringliteral}{"wrong number of gluons in cur\_g\_4f"}}
\DoxyCodeLine{2367 \textcolor{comment}{!DEC\$ ENDIF}}
\DoxyCodeLine{2368 }
\DoxyCodeLine{2369       res = (0d0,0d0)}
\DoxyCodeLine{2370       \textcolor{keywordflow}{if}( (quarks(1)\%PartType.eq.-\/quarks(2)\%PartType .and. quarks(3)\%PartType.eq.-\/quarks(4)\%PartType) \&}
\DoxyCodeLine{2371      .OR. (quarks(1)\%PartType.eq.-\/quarks(4)\%PartType .and. quarks(2)\%PartType.eq.-\/quarks(3)\%PartType) ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2372 \textcolor{comment}{!        type (1)}}
\DoxyCodeLine{2373          \textcolor{keywordflow}{do} na=0,numglu(1)}
\DoxyCodeLine{2374          \textcolor{keywordflow}{do} nc=0,numglu(2)}
\DoxyCodeLine{2375          \textcolor{keywordflow}{do} ne=0,numglu(5)}
\DoxyCodeLine{2376             nb=numglu(1)-\/na}
\DoxyCodeLine{2377             nd=numglu(2)-\/nc}
\DoxyCodeLine{2378             nf=numglu(5)-\/ne}
\DoxyCodeLine{2379             rin = numglu(1)+nc+1}
\DoxyCodeLine{2380             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne}
\DoxyCodeLine{2381             u1 = cur\_f\_4f(gluons(rin:rout),quarks(2:4),quarks(1)\%PartType,(/nd+numglu(3)+numglu(4)+ne,nd,numglu(3),numglu(4),ne/),0,0)}
\DoxyCodeLine{2382             pmom2  = summom(gluons,rin,rout)  + quarks(2)\%Mom + quarks(3)\%Mom + quarks(4)\%Mom}
\DoxyCodeLine{2383             propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(1)\%Mass2)}
\DoxyCodeLine{2384             \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(1)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2385             \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2386                u1 = ( spb2\_(u1,pmom2) + quarks(1)\%Mass*u1 )*propfac2}
\DoxyCodeLine{2387             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2388                u1 = (-\/spi2\_(pmom2,u1) + quarks(1)\%Mass*u1 )*propfac2}
\DoxyCodeLine{2389 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2390 }
\DoxyCodeLine{2391             rin = na+1}
\DoxyCodeLine{2392             rout= numglu(1)+nc}
\DoxyCodeLine{2393             ubar2 = cur\_f\_2f(gluons(rin:rout),quarks(1:1),-\/quarks(1)\%PartType,(/nb+nc,nb,nc/))}
\DoxyCodeLine{2394             pmom3 = summom(gluons,rin,rout) + quarks(1)\%Mom}
\DoxyCodeLine{2395             \textcolor{keywordflow}{if}( nb.ge.1 .or. nc.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2396                propfac3 = (0d0,1d0)/(sc\_(pmom3,pmom3) -\/ quarks(1)\%Mass2)}
\DoxyCodeLine{2397                \textcolor{keywordflow}{if}( abs(sc\_(pmom3,pmom3) -\/ quarks(1)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2398                \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2399                   ubar2 = (-\/spi2\_(pmom3,ubar2) + quarks(1)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{2400                \textcolor{keywordflow}{else}}
\DoxyCodeLine{2401                   ubar2 = (+spb2\_(ubar2,pmom3) + quarks(1)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{2402 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{2403 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2404 }
\DoxyCodeLine{2405             \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2406                 eps1 = -\/vbqq(dv,u1,ubar2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2407             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2408                 eps1 = +vbqq(dv,ubar2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2409 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2410 }
\DoxyCodeLine{2411             counter=1}
\DoxyCodeLine{2412             rin =1}
\DoxyCodeLine{2413             rout=na}
\DoxyCodeLine{2414             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2415               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2416               counter=counter+1}
\DoxyCodeLine{2417 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{2418             tmpmom1(:) = pmom2(:)+pmom3(:)}
\DoxyCodeLine{2419             tmpextref1 = -\/1}
\DoxyCodeLine{2420             tmpgluons(counter)\%Mom => tmpmom1(:)}
\DoxyCodeLine{2421             tmpgluons(counter)\%Pol => eps1(:)}
\DoxyCodeLine{2422             tmpgluons(counter)\%ExtRef => tmpextref1}
\DoxyCodeLine{2423             counter=counter+1}
\DoxyCodeLine{2424             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne+1}
\DoxyCodeLine{2425             rout=numglu(0)-\/1}
\DoxyCodeLine{2426             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2427               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2428               counter=counter+1}
\DoxyCodeLine{2429 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{2430             eps2(:) = cur\_g(tmpgluons(1:counter-\/1),1+na+nf+1)}
\DoxyCodeLine{2431 }
\DoxyCodeLine{2432             \textcolor{keywordflow}{if}( na.ge.1 .or. nf.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2433                propfac1 = (0d0,-\/1d0)/sc\_(tmpmom1,tmpmom1)}
\DoxyCodeLine{2434                \textcolor{keywordflow}{if}( abs(sc\_(tmpmom1,tmpmom1)).lt.propcut ) cycle}
\DoxyCodeLine{2435                eps2 = eps2*propfac1}
\DoxyCodeLine{2436 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2437 }
\DoxyCodeLine{2438             res = res + eps2}
\DoxyCodeLine{2439 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{2440 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{2441 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{2442 }
\DoxyCodeLine{2443 }
\DoxyCodeLine{2444 \textcolor{comment}{!        type (2)}}
\DoxyCodeLine{2445          \textcolor{keywordflow}{do} na=0,numglu(1)}
\DoxyCodeLine{2446          \textcolor{keywordflow}{do} nc=0,numglu(4)}
\DoxyCodeLine{2447          \textcolor{keywordflow}{do} ne=0,numglu(5)        \textcolor{comment}{! can be replaced by above ne-\/loop}}
\DoxyCodeLine{2448             nb=numglu(1)-\/na}
\DoxyCodeLine{2449             nd=numglu(4)-\/nc}
\DoxyCodeLine{2450             nf=numglu(5)-\/ne}
\DoxyCodeLine{2451 }
\DoxyCodeLine{2452             rin = na+1}
\DoxyCodeLine{2453             rout= numglu(1)+numglu(2)+numglu(3)+nc}
\DoxyCodeLine{2454             u1 = cur\_f\_4f(gluons(rin:rout),quarks(1:3),quarks(4)\%PartType,(/nb+numglu(2)+numglu(3)+nc,nb,numglu(2),numglu(3),nc/),0,0)}
\DoxyCodeLine{2455             pmom2 =  summom(gluons,rin,rout) + quarks(1)\%Mom + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{2456             propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{2457             \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2458             \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2459               u1 = (+spb2\_(u1,pmom2) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{2460             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2461               u1 = (-\/spi2\_(pmom2,u1) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{2462 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2463             rin = numglu(1)+numglu(2)+numglu(3)+nc+1}
\DoxyCodeLine{2464             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne}
\DoxyCodeLine{2465             ubar2 = cur\_f\_2f(gluons(rin:rout),quarks(4:4),-\/quarks(4)\%PartType,(/nd+ne,nd,ne/))}
\DoxyCodeLine{2466             pmom3  = summom(gluons,rin,rout) + quarks(4)\%Mom}
\DoxyCodeLine{2467             \textcolor{keywordflow}{if}( nd.ge.1 .or. ne.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2468                propfac3 = (0d0,1d0)/(sc\_(pmom3,pmom3) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{2469                \textcolor{keywordflow}{if}( abs(sc\_(pmom3,pmom3) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2470                \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2471                   ubar2 = (-\/spi2\_(pmom3,ubar2) + quarks(4)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{2472                \textcolor{keywordflow}{else}}
\DoxyCodeLine{2473                   ubar2 = (+spb2\_(ubar2,pmom3) + quarks(4)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{2474 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{2475 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2476 }
\DoxyCodeLine{2477             \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2478               eps1 = +vbqq(dv,u1,ubar2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2479             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2480               eps1 = -\/vbqq(dv,ubar2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2481 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2482 }
\DoxyCodeLine{2483             counter=1}
\DoxyCodeLine{2484             rin =1}
\DoxyCodeLine{2485             rout=na}
\DoxyCodeLine{2486             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2487               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2488               counter=counter+1}
\DoxyCodeLine{2489 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{2490             tmpmom1(:) = pmom2(:)+pmom3(:)}
\DoxyCodeLine{2491             tmpextref1 = -\/1}
\DoxyCodeLine{2492             tmpgluons(counter)\%Mom => tmpmom1(:)}
\DoxyCodeLine{2493             tmpgluons(counter)\%Pol => eps1(:)}
\DoxyCodeLine{2494             tmpgluons(counter)\%ExtRef => tmpextref1}
\DoxyCodeLine{2495             counter=counter+1}
\DoxyCodeLine{2496             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne+1}
\DoxyCodeLine{2497             rout=numglu(0)-\/1}
\DoxyCodeLine{2498             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2499               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2500               counter=counter+1}
\DoxyCodeLine{2501 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{2502             eps2(:) = cur\_g(tmpgluons(1:counter-\/1),1+na+nf+1)}
\DoxyCodeLine{2503 }
\DoxyCodeLine{2504             \textcolor{keywordflow}{if}( na.ge.1 .or. nf.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2505                propfac1 = (0d0,-\/1d0)/sc\_(tmpmom1,tmpmom1)}
\DoxyCodeLine{2506                \textcolor{keywordflow}{if}( abs(sc\_(tmpmom1,tmpmom1)).lt.propcut ) cycle}
\DoxyCodeLine{2507                eps2 = eps2*propfac1}
\DoxyCodeLine{2508 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2509 }
\DoxyCodeLine{2510             res = res + eps2}
\DoxyCodeLine{2511 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{2512 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{2513 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{2514 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{2515 }
\DoxyCodeLine{2516 }
\DoxyCodeLine{2517 }
\DoxyCodeLine{2518       \textcolor{keywordflow}{if}( quarks(1)\%PartType.eq.-\/quarks(2)\%PartType .and. quarks(3)\%PartType.eq.-\/quarks(4)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2519 \textcolor{comment}{!        type(3)}}
\DoxyCodeLine{2520          \textcolor{keywordflow}{do} na=0,numglu(1)}
\DoxyCodeLine{2521          \textcolor{keywordflow}{do} nc=0,numglu(2)}
\DoxyCodeLine{2522          \textcolor{keywordflow}{do} ne=0,numglu(3)}
\DoxyCodeLine{2523          \textcolor{keywordflow}{do} nf=0,numglu(3)-\/ne}
\DoxyCodeLine{2524          \textcolor{keywordflow}{do} nh=0,numglu(4)   \textcolor{comment}{! this loop can be placed after Eps1 has been calculated}}
\DoxyCodeLine{2525          \textcolor{keywordflow}{do} nj=0,numglu(5)}
\DoxyCodeLine{2526             nb=numglu(1)-\/na}
\DoxyCodeLine{2527             nd=numglu(2)-\/nc}
\DoxyCodeLine{2528             ng=numglu(3)-\/ne-\/nf}
\DoxyCodeLine{2529             ni=numglu(4)-\/nh}
\DoxyCodeLine{2530             nk=numglu(5)-\/nj}
\DoxyCodeLine{2531 }
\DoxyCodeLine{2532             rin = na+1}
\DoxyCodeLine{2533             rout= numglu(1)+nc}
\DoxyCodeLine{2534             ubar2 = cur\_f\_2f(gluons(rin:rout),quarks(1:1),-\/quarks(1)\%PartType,(/nb+nc,nb,nc/))}
\DoxyCodeLine{2535             pmom1 = summom(gluons,rin,rout) + quarks(1)\%Mom}
\DoxyCodeLine{2536             \textcolor{keywordflow}{if}( nb.ge.1 .or. nc.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2537                propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1) -\/ quarks(1)\%Mass2)}
\DoxyCodeLine{2538                \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1) -\/ quarks(1)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2539                \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2540                   ubar2 = (-\/spi2\_(pmom1,ubar2) + quarks(1)\%Mass*ubar2 )*propfac1}
\DoxyCodeLine{2541                \textcolor{keywordflow}{else}}
\DoxyCodeLine{2542                   ubar2 = (+spb2\_(ubar2,pmom1) + quarks(1)\%Mass*ubar2 )*propfac1}
\DoxyCodeLine{2543 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{2544 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2545             rin = numglu(1)+nc+1}
\DoxyCodeLine{2546             rout= numglu(1)+numglu(2)+ne}
\DoxyCodeLine{2547             u1 = cur\_f\_2f(gluons(rin:rout),quarks(2:2),-\/quarks(2)\%PartType,(/nd+ne,nd,ne/))}
\DoxyCodeLine{2548             pmom2 = summom(gluons,rin,rout) + quarks(2)\%Mom}
\DoxyCodeLine{2549             \textcolor{keywordflow}{if}( nd.ge.1 .or. ne.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2550                propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{2551                \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2552                \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2553                   u1 = (-\/spi2\_(pmom2,u1) + quarks(2)\%Mass*u1 )*propfac2}
\DoxyCodeLine{2554                \textcolor{keywordflow}{else}}
\DoxyCodeLine{2555                   u1 = (+spb2\_(u1,pmom2) + quarks(2)\%Mass*u1 )*propfac2}
\DoxyCodeLine{2556 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{2557 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2558 }
\DoxyCodeLine{2559             \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2560               eps1 = +vbqq(dv,ubar2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2561             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2562               eps1 = -\/vbqq(dv,u1,ubar2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2563 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2564             tmpmom1 = pmom1 + pmom2}
\DoxyCodeLine{2565             propfac3 = (0d0,-\/1d0)/sc\_(tmpmom1,tmpmom1)}
\DoxyCodeLine{2566             \textcolor{keywordflow}{if}( abs(sc\_(tmpmom1,tmpmom1)).lt.propcut ) cycle}
\DoxyCodeLine{2567             eps1 = eps1*propfac3}
\DoxyCodeLine{2568 }
\DoxyCodeLine{2569 }
\DoxyCodeLine{2570             rin = numglu(1)+numglu(2)+ne+nf+1}
\DoxyCodeLine{2571             rout= numglu(1)+numglu(2)+numglu(3)+nh}
\DoxyCodeLine{2572             u1 = cur\_f\_2f(gluons(rin:rout),quarks(3:3),-\/quarks(3)\%PartType,(/ng+nh,ng,nh/))}
\DoxyCodeLine{2573             pmom3 = summom(gluons,rin,rout) + quarks(3)\%Mom}
\DoxyCodeLine{2574             \textcolor{keywordflow}{if}( ng.ge.1 .or. nh.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2575                propfac3 = (0d0,1d0)/(sc\_(pmom3,pmom3) -\/ quarks(3)\%Mass2)}
\DoxyCodeLine{2576                \textcolor{keywordflow}{if}( abs(sc\_(pmom3,pmom3) -\/ quarks(3)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2577                \textcolor{keywordflow}{if}( quarks(3)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2578                   u1 = (-\/spi2\_(pmom3,u1) + quarks(3)\%Mass*u1 )*propfac3}
\DoxyCodeLine{2579                \textcolor{keywordflow}{else}}
\DoxyCodeLine{2580                   u1 = (+spb2\_(u1,pmom3) + quarks(3)\%Mass*u1 )*propfac3}
\DoxyCodeLine{2581 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{2582 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2583             rin = numglu(1)+numglu(2)+numglu(3)+nh+1}
\DoxyCodeLine{2584             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+nj}
\DoxyCodeLine{2585             ubar2 = cur\_f\_2f(gluons(rin:rout),quarks(4:4),-\/quarks(4)\%PartType,(/ni+nj,ni,nj/))}
\DoxyCodeLine{2586             pmom4 = summom(gluons,rin,rout) + quarks(4)\%Mom}
\DoxyCodeLine{2587             \textcolor{keywordflow}{if}( ni.ge.1 .or. nj.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2588                propfac4 = (0d0,1d0)/(sc\_(pmom4,pmom4) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{2589                \textcolor{keywordflow}{if}( abs(sc\_(pmom4,pmom4) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{2590                \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2591                   ubar2 = (-\/spi2\_(pmom4,ubar2) + quarks(4)\%Mass*ubar2 )*propfac4}
\DoxyCodeLine{2592                \textcolor{keywordflow}{else}}
\DoxyCodeLine{2593                   ubar2 = (+spb2\_(ubar2,pmom4) + quarks(4)\%Mass*ubar2 )*propfac4}
\DoxyCodeLine{2594 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{2595 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2596 }
\DoxyCodeLine{2597             \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2598                eps2 = +vbqq(dv,u1,ubar2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2599             \textcolor{keywordflow}{else}}
\DoxyCodeLine{2600                eps2 = -\/vbqq(dv,ubar2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{2601 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{2602             tmpmom2 = pmom3 + pmom4}
\DoxyCodeLine{2603             propfac1 = (0d0,-\/1d0)/sc\_(tmpmom2,tmpmom2)}
\DoxyCodeLine{2604             \textcolor{keywordflow}{if}( abs(sc\_(tmpmom2,tmpmom2)).lt.propcut ) cycle}
\DoxyCodeLine{2605             eps2 = eps2*propfac1}
\DoxyCodeLine{2606 }
\DoxyCodeLine{2607 }
\DoxyCodeLine{2608             counter=1}
\DoxyCodeLine{2609             rin =1}
\DoxyCodeLine{2610             rout=na}
\DoxyCodeLine{2611             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2612               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2613               counter=counter+1}
\DoxyCodeLine{2614 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{2615             tmpextref1 = -\/1}
\DoxyCodeLine{2616             tmpgluons(counter)\%Mom => tmpmom1(:)}
\DoxyCodeLine{2617             tmpgluons(counter)\%Pol => eps1(:)}
\DoxyCodeLine{2618             tmpgluons(counter)\%ExtRef => tmpextref1}
\DoxyCodeLine{2619             counter=counter+1}
\DoxyCodeLine{2620             rin =numglu(1)+numglu(2)+ne+1}
\DoxyCodeLine{2621             rout=numglu(1)+numglu(2)+ne+nf}
\DoxyCodeLine{2622             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2623               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2624               counter=counter+1}
\DoxyCodeLine{2625 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{2626             tmpgluons(counter)\%Mom => tmpmom2(:)}
\DoxyCodeLine{2627             tmpgluons(counter)\%Pol => eps2(:)}
\DoxyCodeLine{2628             tmpgluons(counter)\%ExtRef => tmpextref1}
\DoxyCodeLine{2629             counter=counter+1}
\DoxyCodeLine{2630             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+nj+1}
\DoxyCodeLine{2631             rout=numglu(0)-\/1}
\DoxyCodeLine{2632             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{2633               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{2634               counter=counter+1}
\DoxyCodeLine{2635 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{2636             eps3(:) = cur\_g(tmpgluons(1:counter-\/1),1+na+nf+nk+2)}
\DoxyCodeLine{2637             res = res + eps3}
\DoxyCodeLine{2638 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{2639 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{2640 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{2641 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{2642 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{2643 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{2644 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{2645 }
\DoxyCodeLine{2646 }
\DoxyCodeLine{2647 \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a94a94906ea77f211ca50b80310f0da1c}\label{namespacemodttbhiggs_a94a94906ea77f211ca50b80310f0da1c}} 
\index{modttbhiggs@{modttbhiggs}!cur\_g\_4fv@{cur\_g\_4fv}}
\index{cur\_g\_4fv@{cur\_g\_4fv}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{cur\_g\_4fv()}{cur\_g\_4fv()}}
{\footnotesize\ttfamily complex(8) function, dimension(\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}) modttbhiggs\+::cur\+\_\+g\+\_\+4fv (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(1\+:)}]{Gluons,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(1\+:)}]{Quarks,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}})}]{Boson,  }\item[{integer, intent(in)}]{Boson\+Vertex,  }\item[{integer, dimension(0\+:5), intent(in)}]{Num\+Glu }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 3124 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{3124 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{3125 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{intent(in)} :: NumGlu(0:5),BosonVertex}
\DoxyCodeLine{3126 \textcolor{keywordtype}{type}(PtrToParticle) :: Gluons(1:),Quarks(1:),Boson}
\DoxyCodeLine{3127 \textcolor{keywordtype}{integer} :: na,nb,nc,nd,ne,nf,ng,nh,ni,nj,nk,BosonVertex\_mod}
\DoxyCodeLine{3128 \textcolor{keywordtype}{integer} :: rIn,rOut}
\DoxyCodeLine{3129 \textcolor{keywordtype}{integer} :: tag\_f,counter,i}
\DoxyCodeLine{3130 \textcolor{keywordtype}{complex(8)} :: res(Dv)}
\DoxyCodeLine{3131 \textcolor{keywordtype}{type}(PtrToParticle) :: TmpGluons(1:2+NumGlu(1)+NumGlu(3)+NumGlu(5))}
\DoxyCodeLine{3132 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: TmpMom1(1:Dv),TmpMom2(1:Dv)}
\DoxyCodeLine{3133 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{target} :: TmpExtRef1,TmpExtRef2}
\DoxyCodeLine{3134 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: Eps1(1:Dv)}
\DoxyCodeLine{3135 \textcolor{keywordtype}{complex(8)},\textcolor{keywordtype}{target} :: Eps2(1:Dv)}
\DoxyCodeLine{3136 \textcolor{keywordtype}{complex(8)} :: Eps3(1:Dv)}
\DoxyCodeLine{3137 \textcolor{keywordtype}{complex(8)} :: u1(1:Ds)}
\DoxyCodeLine{3138 \textcolor{keywordtype}{complex(8)} :: ubar2(1:Ds)}
\DoxyCodeLine{3139 \textcolor{keywordtype}{complex(8)} :: PropFac1,PropFac2,PropFac3,PropFac4}
\DoxyCodeLine{3140 \textcolor{keywordtype}{complex(8)} :: PMom1(1:Dv)}
\DoxyCodeLine{3141 \textcolor{keywordtype}{complex(8)} :: PMom2(1:Dv)}
\DoxyCodeLine{3142 \textcolor{keywordtype}{complex(8)} :: PMom3(1:Dv)}
\DoxyCodeLine{3143 \textcolor{keywordtype}{complex(8)} :: PMom4(1:Dv)}
\DoxyCodeLine{3144 }
\DoxyCodeLine{3145 \textcolor{comment}{!DEC\$ IF (\_DebugCheckMyImpl1==1)}}
\DoxyCodeLine{3146     \textcolor{keywordflow}{if}( numglu(0)-\/1-\/numglu(1)-\/numglu(2)-\/numglu(3)-\/numglu(4)-\/numglu(5).ne.0 ) print *, \textcolor{stringliteral}{"wrong number of gluons in cur\_g\_4f"}}
\DoxyCodeLine{3147 \textcolor{comment}{!DEC\$ ENDIF}}
\DoxyCodeLine{3148 }
\DoxyCodeLine{3149     res = (0d0,0d0)}
\DoxyCodeLine{3150     \textcolor{keywordflow}{if} (quarks(1)\%PartType.eq.-\/quarks(4)\%PartType .and. quarks(2)\%PartType.eq.-\/quarks(3)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3151        \textcolor{comment}{! for this flavor structure, the BosonVertex implies the following:}}
\DoxyCodeLine{3152        \textcolor{comment}{! BV = 1 : Boson on quark 1 only}}
\DoxyCodeLine{3153        \textcolor{comment}{! BV = 2 : Boson on both quarks 2 and 3}}
\DoxyCodeLine{3154        \textcolor{comment}{! BV = 3 : Boson on quark 4 only}}
\DoxyCodeLine{3155        \textcolor{comment}{! See RR notes}}
\DoxyCodeLine{3156 }
\DoxyCodeLine{3157        \textcolor{keywordflow}{if}( bosonvertex.eq.1)  \textcolor{keywordflow}{then}}
\DoxyCodeLine{3158           \textcolor{comment}{!        type (1)}}
\DoxyCodeLine{3159          \textcolor{keywordflow}{do} na=0,numglu(1)}
\DoxyCodeLine{3160          \textcolor{keywordflow}{do} nc=0,numglu(2)}
\DoxyCodeLine{3161          \textcolor{keywordflow}{do} ne=0,numglu(5)}
\DoxyCodeLine{3162             nb=numglu(1)-\/na}
\DoxyCodeLine{3163             nd=numglu(2)-\/nc}
\DoxyCodeLine{3164             nf=numglu(5)-\/ne}
\DoxyCodeLine{3165             rin = numglu(1)+nc+1}
\DoxyCodeLine{3166             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne}
\DoxyCodeLine{3167             u1 = cur\_f\_4f(gluons(rin:rout),quarks(2:4),quarks(1)\%PartType,(/nd+numglu(3)+numglu(4)+ne,nd,numglu(3),numglu(4),ne/),0,0)}
\DoxyCodeLine{3168             pmom2  = summom(gluons,rin,rout)  + quarks(2)\%Mom + quarks(3)\%Mom + quarks(4)\%Mom}
\DoxyCodeLine{3169             propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(1)\%Mass2)}
\DoxyCodeLine{3170             \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(1)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3171             \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3172                u1 = ( spb2\_(u1,pmom2) + quarks(1)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3173             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3174                u1 = (-\/spi2\_(pmom2,u1) + quarks(1)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3175 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3176 }
\DoxyCodeLine{3177             rin = na+1}
\DoxyCodeLine{3178             rout= numglu(1)+nc}
\DoxyCodeLine{3179             ubar2 = cur\_f\_2fv(gluons(rin:rout),quarks(1:1),-\/quarks(1)\%PartType,boson,(/nb+nc,nb,nc/))}
\DoxyCodeLine{3180             pmom3 = summom(gluons,rin,rout) + quarks(1)\%Mom + boson\%Mom}
\DoxyCodeLine{3181             propfac3 = (0d0,1d0)/(sc\_(pmom3,pmom3) -\/ quarks(1)\%Mass2)}
\DoxyCodeLine{3182             \textcolor{keywordflow}{if}( abs(sc\_(pmom3,pmom3) -\/ quarks(1)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3183             \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3184                ubar2 = (-\/spi2\_(pmom3,ubar2) + quarks(1)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{3185             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3186                ubar2 = (+spb2\_(ubar2,pmom3) + quarks(1)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{3187 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3188 }
\DoxyCodeLine{3189             \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3190                 eps1 = -\/vbqq(dv,u1,ubar2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3191             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3192                 eps1 = +vbqq(dv,ubar2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3193 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3194 }
\DoxyCodeLine{3195             counter=1}
\DoxyCodeLine{3196             rin =1}
\DoxyCodeLine{3197             rout=na}
\DoxyCodeLine{3198             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3199               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3200               counter=counter+1}
\DoxyCodeLine{3201 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{3202             tmpmom1(:) = pmom2(:)+pmom3(:)}
\DoxyCodeLine{3203             tmpextref1 = -\/1}
\DoxyCodeLine{3204             tmpgluons(counter)\%Mom => tmpmom1(:)}
\DoxyCodeLine{3205             tmpgluons(counter)\%Pol => eps1(:)}
\DoxyCodeLine{3206             tmpgluons(counter)\%ExtRef => tmpextref1}
\DoxyCodeLine{3207             counter=counter+1}
\DoxyCodeLine{3208             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne+1}
\DoxyCodeLine{3209             rout=numglu(0)-\/1}
\DoxyCodeLine{3210             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3211               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3212               counter=counter+1}
\DoxyCodeLine{3213 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{3214             eps2(:) = cur\_g(tmpgluons(1:counter-\/1),1+na+nf+1)}
\DoxyCodeLine{3215 }
\DoxyCodeLine{3216             \textcolor{keywordflow}{if}( na.ge.1 .or. nf.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3217                propfac1 = (0d0,-\/1d0)/sc\_(tmpmom1,tmpmom1)}
\DoxyCodeLine{3218                \textcolor{keywordflow}{if}( abs(sc\_(tmpmom1,tmpmom1)).lt.propcut ) cycle}
\DoxyCodeLine{3219                eps2 = eps2*propfac1}
\DoxyCodeLine{3220 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3221 }
\DoxyCodeLine{3222             res = res + eps2}
\DoxyCodeLine{3223 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3224 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3225 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3226       endif\textcolor{comment}{! Bosonvertex}}
\DoxyCodeLine{3227 }
\DoxyCodeLine{3228       \textcolor{keywordflow}{if}( bosonvertex.eq.1 .or. bosonvertex.eq.2 .or. bosonvertex .eq. 3)  \textcolor{keywordflow}{then}}
\DoxyCodeLine{3229 \textcolor{comment}{!        type (2)}}
\DoxyCodeLine{3230          \textcolor{keywordflow}{do} na=0,numglu(1)}
\DoxyCodeLine{3231          \textcolor{keywordflow}{do} nc=0,numglu(4)}
\DoxyCodeLine{3232          \textcolor{keywordflow}{do} ne=0,numglu(5)}
\DoxyCodeLine{3233             nb=numglu(1)-\/na}
\DoxyCodeLine{3234             nd=numglu(4)-\/nc}
\DoxyCodeLine{3235             nf=numglu(5)-\/ne}
\DoxyCodeLine{3236 }
\DoxyCodeLine{3237             rin = na+1}
\DoxyCodeLine{3238             rout= numglu(1)+numglu(2)+numglu(3)+nc}
\DoxyCodeLine{3239             bosonvertex\_mod = bosonvertex  + 1}
\DoxyCodeLine{3240 \textcolor{comment}{!            if (BosonVertex .eq. 1) BosonVertex\_mod=BosonVertex}}
\DoxyCodeLine{3241             u1 = cur\_f\_4fv(gluons(rin:rout),quarks(1:3),quarks(4)\%PartType,boson,bosonvertex\_mod,(/nb+numglu(2)+numglu(3)+nc,nb,numglu(2),numglu(3),nc/),0,0)}
\DoxyCodeLine{3242             pmom2 =  summom(gluons,rin,rout) + quarks(1)\%Mom + quarks(2)\%Mom + quarks(3)\%Mom + boson\%Mom}
\DoxyCodeLine{3243             propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{3244             \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3245             \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3246               u1 = (+spb2\_(u1,pmom2) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3247             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3248               u1 = (-\/spi2\_(pmom2,u1) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3249 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3250 }
\DoxyCodeLine{3251             rin = numglu(1)+numglu(2)+numglu(3)+nc+1}
\DoxyCodeLine{3252             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne}
\DoxyCodeLine{3253             ubar2 = cur\_f\_2f(gluons(rin:rout),quarks(4:4),-\/quarks(4)\%PartType,(/nd+ne,nd,ne/))}
\DoxyCodeLine{3254             pmom3  = summom(gluons,rin,rout) + quarks(4)\%Mom}
\DoxyCodeLine{3255             \textcolor{keywordflow}{if}( nd.ge.1 .or. ne.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3256                propfac3 = (0d0,1d0)/(sc\_(pmom3,pmom3) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{3257                \textcolor{keywordflow}{if}( abs(sc\_(pmom3,pmom3) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3258                \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3259                   ubar2 = (-\/spi2\_(pmom3,ubar2) + quarks(4)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{3260                \textcolor{keywordflow}{else}}
\DoxyCodeLine{3261                   ubar2 = (+spb2\_(ubar2,pmom3) + quarks(4)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{3262 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{3263 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3264 }
\DoxyCodeLine{3265             \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3266               eps1 = +vbqq(dv,u1,ubar2)}
\DoxyCodeLine{3267             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3268               eps1 = -\/vbqq(dv,ubar2,u1)}
\DoxyCodeLine{3269 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3270 }
\DoxyCodeLine{3271             counter=1}
\DoxyCodeLine{3272             rin =1}
\DoxyCodeLine{3273             rout=na}
\DoxyCodeLine{3274             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3275               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3276               counter=counter+1}
\DoxyCodeLine{3277 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{3278             tmpmom1(:) = pmom2(:)+pmom3(:)}
\DoxyCodeLine{3279             tmpextref1 = -\/1}
\DoxyCodeLine{3280             tmpgluons(counter)\%Mom => tmpmom1(:)}
\DoxyCodeLine{3281             tmpgluons(counter)\%Pol => eps1(:)}
\DoxyCodeLine{3282             tmpgluons(counter)\%ExtRef => tmpextref1}
\DoxyCodeLine{3283             counter=counter+1}
\DoxyCodeLine{3284             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne+1}
\DoxyCodeLine{3285             rout=numglu(0)-\/1}
\DoxyCodeLine{3286             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3287               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3288               counter=counter+1}
\DoxyCodeLine{3289 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{3290             eps2(:) = cur\_g(tmpgluons(1:counter-\/1),1+na+nf+1)}
\DoxyCodeLine{3291 }
\DoxyCodeLine{3292             \textcolor{keywordflow}{if}( na.ge.1 .or. nf.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3293                propfac1 = (0d0,-\/1d0)/sc\_(tmpmom1,tmpmom1)}
\DoxyCodeLine{3294                \textcolor{keywordflow}{if}( abs(sc\_(tmpmom1,tmpmom1)).lt.propcut ) cycle}
\DoxyCodeLine{3295                eps2 = eps2*propfac1}
\DoxyCodeLine{3296 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3297 }
\DoxyCodeLine{3298             res = res + eps2}
\DoxyCodeLine{3299 }
\DoxyCodeLine{3300 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3301 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3302 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3303 }
\DoxyCodeLine{3304 \textcolor{keywordflow}{      endif} \textcolor{comment}{! BosonVertex}}
\DoxyCodeLine{3305 }
\DoxyCodeLine{3306 }
\DoxyCodeLine{3307       \textcolor{keywordflow}{if} (bosonvertex .eq. 1 .or. bosonvertex .eq. 2 .or. bosonvertex .eq. 3 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3308 }
\DoxyCodeLine{3309          \textcolor{keywordflow}{do} na=0,numglu(1)}
\DoxyCodeLine{3310          \textcolor{keywordflow}{do} nc=0,numglu(2)}
\DoxyCodeLine{3311          \textcolor{keywordflow}{do} ne=0,numglu(5)}
\DoxyCodeLine{3312             nb=numglu(1)-\/na}
\DoxyCodeLine{3313             nd=numglu(2)-\/nc}
\DoxyCodeLine{3314             nf=numglu(5)-\/ne}
\DoxyCodeLine{3315             rin = numglu(1)+nc+1}
\DoxyCodeLine{3316             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne}
\DoxyCodeLine{3317             bosonvertex\_mod=bosonvertex}
\DoxyCodeLine{3318             u1 = cur\_f\_4fv(gluons(rin:rout),quarks(2:4),quarks(1)\%PartType,boson,bosonvertex\_mod,(/nd+numglu(3)+numglu(4)+ne,nd,numglu(3),numglu(4),ne/),0,0)}
\DoxyCodeLine{3319             pmom2  = summom(gluons,rin,rout)  + quarks(2)\%Mom + quarks(3)\%Mom + quarks(4)\%Mom + boson\%Mom}
\DoxyCodeLine{3320             propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(1)\%Mass2)}
\DoxyCodeLine{3321             \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(1)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3322             \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3323                u1 = ( spb2\_(u1,pmom2) + quarks(1)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3324             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3325                u1 = (-\/spi2\_(pmom2,u1) + quarks(1)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3326 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3327 }
\DoxyCodeLine{3328             rin = na+1}
\DoxyCodeLine{3329             rout= numglu(1)+nc}
\DoxyCodeLine{3330             ubar2 = cur\_f\_2f(gluons(rin:rout),quarks(1:1),-\/quarks(1)\%PartType,(/nb+nc,nb,nc/))}
\DoxyCodeLine{3331             pmom3 = summom(gluons,rin,rout) + quarks(1)\%Mom}
\DoxyCodeLine{3332             propfac3 = (0d0,1d0)/(sc\_(pmom3,pmom3) -\/ quarks(1)\%Mass2)}
\DoxyCodeLine{3333             \textcolor{keywordflow}{if} ( nb .ge. 1 .or. nc .ge. 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3334                \textcolor{keywordflow}{if}( abs(sc\_(pmom3,pmom3) -\/ quarks(1)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3335                \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3336                   ubar2 = (-\/spi2\_(pmom3,ubar2) + quarks(1)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{3337                \textcolor{keywordflow}{else}}
\DoxyCodeLine{3338                   ubar2 = (+spb2\_(ubar2,pmom3) + quarks(1)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{3339 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{3340 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3341 }
\DoxyCodeLine{3342             \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3343                 eps1 = -\/vbqq(dv,u1,ubar2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3344             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3345                 eps1 = +vbqq(dv,ubar2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3346 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3347 }
\DoxyCodeLine{3348             counter=1}
\DoxyCodeLine{3349             rin =1}
\DoxyCodeLine{3350             rout=na}
\DoxyCodeLine{3351             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3352               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3353               counter=counter+1}
\DoxyCodeLine{3354 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{3355             tmpmom1(:) = pmom2(:)+pmom3(:)}
\DoxyCodeLine{3356             tmpextref1 = -\/1}
\DoxyCodeLine{3357             tmpgluons(counter)\%Mom => tmpmom1(:)}
\DoxyCodeLine{3358             tmpgluons(counter)\%Pol => eps1(:)}
\DoxyCodeLine{3359             tmpgluons(counter)\%ExtRef => tmpextref1}
\DoxyCodeLine{3360             counter=counter+1}
\DoxyCodeLine{3361             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne+1}
\DoxyCodeLine{3362             rout=numglu(0)-\/1}
\DoxyCodeLine{3363             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3364               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3365               counter=counter+1}
\DoxyCodeLine{3366 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{3367             eps2(:) = cur\_g(tmpgluons(1:counter-\/1),1+na+nf+1)}
\DoxyCodeLine{3368 }
\DoxyCodeLine{3369             \textcolor{keywordflow}{if}( na.ge.1 .or. nf.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3370                propfac1 = (0d0,-\/1d0)/sc\_(tmpmom1,tmpmom1)}
\DoxyCodeLine{3371                \textcolor{keywordflow}{if}( abs(sc\_(tmpmom1,tmpmom1)).lt.propcut ) cycle}
\DoxyCodeLine{3372                eps2 = eps2*propfac1}
\DoxyCodeLine{3373 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3374 }
\DoxyCodeLine{3375             res = res + eps2}
\DoxyCodeLine{3376 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3377 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3378 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3379       endif\textcolor{comment}{! Bosonvertex}}
\DoxyCodeLine{3380 }
\DoxyCodeLine{3381 }
\DoxyCodeLine{3382       \textcolor{keywordflow}{if}( bosonvertex.eq.3)  \textcolor{keywordflow}{then}}
\DoxyCodeLine{3383 \textcolor{comment}{!        type (2)}}
\DoxyCodeLine{3384          \textcolor{keywordflow}{do} na=0,numglu(1)}
\DoxyCodeLine{3385          \textcolor{keywordflow}{do} nc=0,numglu(4)}
\DoxyCodeLine{3386          \textcolor{keywordflow}{do} ne=0,numglu(5)}
\DoxyCodeLine{3387             nb=numglu(1)-\/na}
\DoxyCodeLine{3388             nd=numglu(4)-\/nc}
\DoxyCodeLine{3389             nf=numglu(5)-\/ne}
\DoxyCodeLine{3390 }
\DoxyCodeLine{3391             rin = na+1}
\DoxyCodeLine{3392             rout= numglu(1)+numglu(2)+numglu(3)+nc}
\DoxyCodeLine{3393             u1 = cur\_f\_4f(gluons(rin:rout),quarks(1:3),quarks(4)\%PartType,(/nb+numglu(2)+numglu(3)+nc,nb,numglu(2),numglu(3),nc/),0,0)}
\DoxyCodeLine{3394             pmom2 =  summom(gluons,rin,rout) + quarks(1)\%Mom + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{3395             propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{3396             \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3397             \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3398               u1 = (+spb2\_(u1,pmom2) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3399             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3400               u1 = (-\/spi2\_(pmom2,u1) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3401 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3402 }
\DoxyCodeLine{3403             rin = numglu(1)+numglu(2)+numglu(3)+nc+1}
\DoxyCodeLine{3404             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne}
\DoxyCodeLine{3405             bosonvertex\_mod = bosonvertex -\/ 3}
\DoxyCodeLine{3406             ubar2 = cur\_f\_2fv(gluons(rin:rout),quarks(4:4),-\/quarks(4)\%PartType,boson,(/nd+ne,nd,ne/))}
\DoxyCodeLine{3407             pmom3  = summom(gluons,rin,rout) + quarks(4)\%Mom + boson\%Mom}
\DoxyCodeLine{3408             propfac3 = (0d0,1d0)/(sc\_(pmom3,pmom3) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{3409             \textcolor{keywordflow}{if}( abs(sc\_(pmom3,pmom3) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3410             \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3411                ubar2 = (-\/spi2\_(pmom3,ubar2) + quarks(4)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{3412             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3413                ubar2 = (+spb2\_(ubar2,pmom3) + quarks(4)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{3414 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3415 }
\DoxyCodeLine{3416             \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3417               eps1 = +vbqq(dv,u1,ubar2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3418             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3419               eps1 = -\/vbqq(dv,ubar2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3420 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3421 }
\DoxyCodeLine{3422             counter=1}
\DoxyCodeLine{3423             rin =1}
\DoxyCodeLine{3424             rout=na}
\DoxyCodeLine{3425             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3426               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3427               counter=counter+1}
\DoxyCodeLine{3428 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{3429             tmpmom1(:) = pmom2(:)+pmom3(:)}
\DoxyCodeLine{3430             tmpextref1 = -\/1}
\DoxyCodeLine{3431             tmpgluons(counter)\%Mom => tmpmom1(:)}
\DoxyCodeLine{3432             tmpgluons(counter)\%Pol => eps1(:)}
\DoxyCodeLine{3433             tmpgluons(counter)\%ExtRef => tmpextref1}
\DoxyCodeLine{3434             counter=counter+1}
\DoxyCodeLine{3435             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne+1}
\DoxyCodeLine{3436             rout=numglu(0)-\/1}
\DoxyCodeLine{3437             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3438               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3439               counter=counter+1}
\DoxyCodeLine{3440 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{3441             eps2(:) = cur\_g(tmpgluons(1:counter-\/1),1+na+nf+1)}
\DoxyCodeLine{3442 }
\DoxyCodeLine{3443             \textcolor{keywordflow}{if}( na.ge.1 .or. nf.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3444                propfac1 = (0d0,-\/1d0)/sc\_(tmpmom1,tmpmom1)}
\DoxyCodeLine{3445                \textcolor{keywordflow}{if}( abs(sc\_(tmpmom1,tmpmom1)).lt.propcut ) cycle}
\DoxyCodeLine{3446                eps2 = eps2*propfac1}
\DoxyCodeLine{3447 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3448 }
\DoxyCodeLine{3449             res = res + eps2}
\DoxyCodeLine{3450 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3451 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3452 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3453       endif\textcolor{comment}{! Bosonvertex}}
\DoxyCodeLine{3454 }
\DoxyCodeLine{3455 }
\DoxyCodeLine{3456       \textcolor{keywordflow}{if} (bosonvertex .ne. 1 .and. bosonvertex .ne. 2 .and. bosonvertex .ne. 3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3457          print *, \textcolor{stringliteral}{'cur\_g\_4fV not implemented for this flavor choice and BosonVertex='}, bosonvertex}
\DoxyCodeLine{3458          stop}
\DoxyCodeLine{3459 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{3460 }
\DoxyCodeLine{3461       endif\textcolor{comment}{! Flavor check}}
\DoxyCodeLine{3462 }
\DoxyCodeLine{3463       \textcolor{keywordflow}{if}( quarks(1)\%PartType.eq.-\/quarks(2)\%PartType .and. quarks(3)\%PartType.eq.-\/quarks(4)\%PartType) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3464 }
\DoxyCodeLine{3465          \textcolor{keywordflow}{if} (bosonvertex .eq. 1 .or. bosonvertex .eq. 3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3466              \textcolor{keywordflow}{do} na=0,numglu(1)}
\DoxyCodeLine{3467              \textcolor{keywordflow}{do} nc=0,numglu(2)}
\DoxyCodeLine{3468              \textcolor{keywordflow}{do} ne=0,numglu(5)}
\DoxyCodeLine{3469 }
\DoxyCodeLine{3470                 nb=numglu(1)-\/na}
\DoxyCodeLine{3471                 nd=numglu(2)-\/nc}
\DoxyCodeLine{3472                 nf=numglu(5)-\/ne}
\DoxyCodeLine{3473                 rin = numglu(1)+nc+1}
\DoxyCodeLine{3474                 rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne}
\DoxyCodeLine{3475                 u1 = cur\_f\_4fv(gluons(rin:rout),quarks(2:4),quarks(1)\%PartType,boson, bosonvertex,(/nd+numglu(3)+numglu(4)+ne,nd,numglu(3),numglu(4),ne/),0,0)}
\DoxyCodeLine{3476                 pmom2  = summom(gluons,rin,rout)  + quarks(2)\%Mom + quarks(3)\%Mom + quarks(4)\%Mom + boson\%Mom}
\DoxyCodeLine{3477                 propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(1)\%Mass2)}
\DoxyCodeLine{3478                 \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(1)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3479                 \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3480                    u1 = ( spb2\_(u1,pmom2) + quarks(1)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3481                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{3482                    u1 = (-\/spi2\_(pmom2,u1) + quarks(1)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3483 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{3484 }
\DoxyCodeLine{3485                 rin = na+1}
\DoxyCodeLine{3486                 rout= numglu(1)+nc}
\DoxyCodeLine{3487                 ubar2 = cur\_f\_2f(gluons(rin:rout),quarks(1:1),-\/quarks(1)\%PartType,(/nb+nc,nb,nc/))}
\DoxyCodeLine{3488                 pmom3 = summom(gluons,rin,rout) + quarks(1)\%Mom}
\DoxyCodeLine{3489                 \textcolor{keywordflow}{if}( nb.ge.1 .or. nc.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3490                    propfac3 = (0d0,1d0)/(sc\_(pmom3,pmom3) -\/ quarks(1)\%Mass2)}
\DoxyCodeLine{3491                    \textcolor{keywordflow}{if}( abs(sc\_(pmom3,pmom3) -\/ quarks(1)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3492                    \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3493                       ubar2 = (-\/spi2\_(pmom3,ubar2) + quarks(1)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{3494                    \textcolor{keywordflow}{else}}
\DoxyCodeLine{3495                       ubar2 = (+spb2\_(ubar2,pmom3) + quarks(1)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{3496 \textcolor{keywordflow}{                   endif}}
\DoxyCodeLine{3497 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{3498 }
\DoxyCodeLine{3499                 \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3500                    eps1 = -\/vbqq(dv,u1,ubar2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3501                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{3502                    eps1 = +vbqq(dv,ubar2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3503 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{3504 }
\DoxyCodeLine{3505                 counter=1}
\DoxyCodeLine{3506                 rin =1}
\DoxyCodeLine{3507                 rout=na}
\DoxyCodeLine{3508                 \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3509                    \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3510                    counter=counter+1}
\DoxyCodeLine{3511 \textcolor{keywordflow}{                enddo}}
\DoxyCodeLine{3512                 tmpmom1(:) = pmom2(:)+pmom3(:)}
\DoxyCodeLine{3513                 tmpextref1 = -\/1}
\DoxyCodeLine{3514                 tmpgluons(counter)\%Mom => tmpmom1(:)}
\DoxyCodeLine{3515                 tmpgluons(counter)\%Pol => eps1(:)}
\DoxyCodeLine{3516                 tmpgluons(counter)\%ExtRef => tmpextref1}
\DoxyCodeLine{3517                 counter=counter+1}
\DoxyCodeLine{3518                 rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne+1}
\DoxyCodeLine{3519                 rout=numglu(0)-\/1}
\DoxyCodeLine{3520                 \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3521                    \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3522                    counter=counter+1}
\DoxyCodeLine{3523 \textcolor{keywordflow}{                enddo}}
\DoxyCodeLine{3524                 eps2(:) = cur\_g(tmpgluons(1:counter-\/1),1+na+nf+1)}
\DoxyCodeLine{3525 }
\DoxyCodeLine{3526                 \textcolor{keywordflow}{if}( na.ge.1 .or. nf.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3527                    propfac1 = (0d0,-\/1d0)/sc\_(tmpmom1,tmpmom1)}
\DoxyCodeLine{3528                    \textcolor{keywordflow}{if}( abs(sc\_(tmpmom1,tmpmom1)).lt.propcut ) cycle}
\DoxyCodeLine{3529                    eps2 = eps2*propfac1}
\DoxyCodeLine{3530 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{3531 }
\DoxyCodeLine{3532                 res = res + eps2}
\DoxyCodeLine{3533 \textcolor{keywordflow}{             enddo}}
\DoxyCodeLine{3534 \textcolor{keywordflow}{             enddo}}
\DoxyCodeLine{3535 \textcolor{keywordflow}{          enddo}}
\DoxyCodeLine{3536 \textcolor{keywordflow}{       endif}}
\DoxyCodeLine{3537 }
\DoxyCodeLine{3538        \textcolor{keywordflow}{if} (bosonvertex .eq. 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3539           \textcolor{keywordflow}{do} na=0,numglu(1)}
\DoxyCodeLine{3540           \textcolor{keywordflow}{do} nc=0,numglu(2)}
\DoxyCodeLine{3541           \textcolor{keywordflow}{do} ne=0,numglu(5)}
\DoxyCodeLine{3542              nb=numglu(1)-\/na}
\DoxyCodeLine{3543              nd=numglu(2)-\/nc}
\DoxyCodeLine{3544              nf=numglu(5)-\/ne}
\DoxyCodeLine{3545              rin = numglu(1)+nc+1}
\DoxyCodeLine{3546              rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne}
\DoxyCodeLine{3547              u1 = cur\_f\_4f(gluons(rin:rout),quarks(2:4),quarks(1)\%PartType,(/nd+numglu(3)+numglu(4)+ne,nd,numglu(3),numglu(4),ne/),0,0)}
\DoxyCodeLine{3548              pmom2  = summom(gluons,rin,rout)  + quarks(2)\%Mom + quarks(3)\%Mom + quarks(4)\%Mom}
\DoxyCodeLine{3549              propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(1)\%Mass2)}
\DoxyCodeLine{3550              \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(1)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3551              \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3552                 u1 = ( spb2\_(u1,pmom2) + quarks(1)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3553              \textcolor{keywordflow}{else}}
\DoxyCodeLine{3554                 u1 = (-\/spi2\_(pmom2,u1) + quarks(1)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3555 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{3556 }
\DoxyCodeLine{3557              rin = na+1}
\DoxyCodeLine{3558              rout= numglu(1)+nc}
\DoxyCodeLine{3559              ubar2 = cur\_f\_2fv(gluons(rin:rout),quarks(1:1),-\/quarks(1)\%PartType,boson,(/nb+nc,nb,nc/))}
\DoxyCodeLine{3560              pmom3 = summom(gluons,rin,rout) + quarks(1)\%Mom +  boson\%Mom}
\DoxyCodeLine{3561              propfac3 = (0d0,1d0)/(sc\_(pmom3,pmom3) -\/ quarks(1)\%Mass2)}
\DoxyCodeLine{3562              \textcolor{keywordflow}{if}( abs(sc\_(pmom3,pmom3) -\/ quarks(1)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3563              \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3564                 ubar2 = (-\/spi2\_(pmom3,ubar2) + quarks(1)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{3565              \textcolor{keywordflow}{else}}
\DoxyCodeLine{3566                 ubar2 = (+spb2\_(ubar2,pmom3) + quarks(1)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{3567 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{3568 }
\DoxyCodeLine{3569              \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3570                 eps1 = -\/vbqq(dv,u1,ubar2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3571              \textcolor{keywordflow}{else}}
\DoxyCodeLine{3572                 eps1 = +vbqq(dv,ubar2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3573 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{3574 }
\DoxyCodeLine{3575              counter=1}
\DoxyCodeLine{3576              rin =1}
\DoxyCodeLine{3577              rout=na}
\DoxyCodeLine{3578              \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3579                 \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3580                 counter=counter+1}
\DoxyCodeLine{3581 \textcolor{keywordflow}{             enddo}}
\DoxyCodeLine{3582              tmpmom1(:) = pmom2(:)+pmom3(:)}
\DoxyCodeLine{3583              tmpextref1 = -\/1}
\DoxyCodeLine{3584              tmpgluons(counter)\%Mom => tmpmom1(:)}
\DoxyCodeLine{3585              tmpgluons(counter)\%Pol => eps1(:)}
\DoxyCodeLine{3586              tmpgluons(counter)\%ExtRef => tmpextref1}
\DoxyCodeLine{3587              counter=counter+1}
\DoxyCodeLine{3588              rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne+1}
\DoxyCodeLine{3589              rout=numglu(0)-\/1}
\DoxyCodeLine{3590              \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3591                 \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3592                 counter=counter+1}
\DoxyCodeLine{3593 \textcolor{keywordflow}{             enddo}}
\DoxyCodeLine{3594              eps2(:) = cur\_g(tmpgluons(1:counter-\/1),1+na+nf+1)}
\DoxyCodeLine{3595 }
\DoxyCodeLine{3596              \textcolor{keywordflow}{if}( na.ge.1 .or. nf.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3597                 propfac1 = (0d0,-\/1d0)/sc\_(tmpmom1,tmpmom1)}
\DoxyCodeLine{3598                 \textcolor{keywordflow}{if}( abs(sc\_(tmpmom1,tmpmom1)).lt.propcut ) cycle}
\DoxyCodeLine{3599                 eps2 = eps2*propfac1}
\DoxyCodeLine{3600 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{3601 }
\DoxyCodeLine{3602              res = res + eps2}
\DoxyCodeLine{3603 \textcolor{keywordflow}{          enddo}}
\DoxyCodeLine{3604 \textcolor{keywordflow}{       enddo}}
\DoxyCodeLine{3605 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{3606 \textcolor{keywordflow}{ endif}}
\DoxyCodeLine{3607 }
\DoxyCodeLine{3608 }
\DoxyCodeLine{3609  \textcolor{keywordflow}{if} (bosonvertex .eq. 1 .or. bosonvertex .eq. 3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3610 \textcolor{comment}{!        type (3)}}
\DoxyCodeLine{3611     \textcolor{keywordflow}{do} na=0,numglu(1)}
\DoxyCodeLine{3612     \textcolor{keywordflow}{do} nc=0,numglu(4)}
\DoxyCodeLine{3613     \textcolor{keywordflow}{do} ne=0,numglu(5)        \textcolor{comment}{! can be replaced by above ne-\/loop}}
\DoxyCodeLine{3614        nb=numglu(1)-\/na}
\DoxyCodeLine{3615        nd=numglu(4)-\/nc}
\DoxyCodeLine{3616        nf=numglu(5)-\/ne}
\DoxyCodeLine{3617 }
\DoxyCodeLine{3618        rin = na+1}
\DoxyCodeLine{3619        rout= numglu(1)+numglu(2)+numglu(3)+nc}
\DoxyCodeLine{3620        bosonvertex\_mod=bosonvertex+1}
\DoxyCodeLine{3621        u1 = cur\_f\_4fv(gluons(rin:rout),quarks(1:3),quarks(4)\%PartType,boson,bosonvertex\_mod,(/nb+numglu(2)+numglu(3)+nc,nb,numglu(2),numglu(3),nc/),0,0)}
\DoxyCodeLine{3622        pmom2 =  summom(gluons,rin,rout) + quarks(1)\%Mom + quarks(2)\%Mom + quarks(3)\%Mom + boson\%Mom}
\DoxyCodeLine{3623        propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{3624        \textcolor{keywordflow}{if} ( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3625           cycle}
\DoxyCodeLine{3626 \textcolor{keywordflow}{       endif}}
\DoxyCodeLine{3627        \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3628           u1 = (+spb2\_(u1,pmom2) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3629        \textcolor{keywordflow}{else}}
\DoxyCodeLine{3630           u1 = (-\/spi2\_(pmom2,u1) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3631 \textcolor{keywordflow}{       endif}}
\DoxyCodeLine{3632        rin = numglu(1)+numglu(2)+numglu(3)+nc+1}
\DoxyCodeLine{3633        rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne}
\DoxyCodeLine{3634        ubar2 = cur\_f\_2f(gluons(rin:rout),quarks(4:4),-\/quarks(4)\%PartType,(/nd+ne,nd,ne/))}
\DoxyCodeLine{3635        pmom3  = summom(gluons,rin,rout) + quarks(4)\%Mom}
\DoxyCodeLine{3636        \textcolor{keywordflow}{if}( nd.ge.1 .or. ne.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3637           propfac3 = (0d0,1d0)/(sc\_(pmom3,pmom3) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{3638           \textcolor{keywordflow}{if}( abs(sc\_(pmom3,pmom3) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3639           \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3640              ubar2 = (-\/spi2\_(pmom3,ubar2) + quarks(4)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{3641           \textcolor{keywordflow}{else}}
\DoxyCodeLine{3642              ubar2 = (+spb2\_(ubar2,pmom3) + quarks(4)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{3643 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{3644 \textcolor{keywordflow}{       endif}}
\DoxyCodeLine{3645 }
\DoxyCodeLine{3646        \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3647           eps1 = +vbqq(dv,u1,ubar2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3648        \textcolor{keywordflow}{else}}
\DoxyCodeLine{3649           eps1 = -\/vbqq(dv,ubar2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3650 \textcolor{keywordflow}{       endif}}
\DoxyCodeLine{3651 }
\DoxyCodeLine{3652        counter=1}
\DoxyCodeLine{3653        rin =1}
\DoxyCodeLine{3654        rout=na}
\DoxyCodeLine{3655        \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3656           \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3657           counter=counter+1}
\DoxyCodeLine{3658 \textcolor{keywordflow}{       enddo}}
\DoxyCodeLine{3659        tmpmom1(:) = pmom2(:)+pmom3(:)}
\DoxyCodeLine{3660        tmpextref1 = -\/1}
\DoxyCodeLine{3661        tmpgluons(counter)\%Mom => tmpmom1(:)}
\DoxyCodeLine{3662        tmpgluons(counter)\%Pol => eps1(:)}
\DoxyCodeLine{3663        tmpgluons(counter)\%ExtRef => tmpextref1}
\DoxyCodeLine{3664        counter=counter+1}
\DoxyCodeLine{3665        rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne+1}
\DoxyCodeLine{3666        rout=numglu(0)-\/1}
\DoxyCodeLine{3667        \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3668           \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3669           counter=counter+1}
\DoxyCodeLine{3670 \textcolor{keywordflow}{       enddo}}
\DoxyCodeLine{3671        eps2(:) = cur\_g(tmpgluons(1:counter-\/1),1+na+nf+1)}
\DoxyCodeLine{3672 }
\DoxyCodeLine{3673        \textcolor{keywordflow}{if}( na.ge.1 .or. nf.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3674           propfac1 = (0d0,-\/1d0)/sc\_(tmpmom1,tmpmom1)}
\DoxyCodeLine{3675           \textcolor{keywordflow}{if}( abs(sc\_(tmpmom1,tmpmom1)).lt.propcut ) cycle}
\DoxyCodeLine{3676           eps2 = eps2*propfac1}
\DoxyCodeLine{3677 \textcolor{keywordflow}{       endif}}
\DoxyCodeLine{3678 }
\DoxyCodeLine{3679        res = res + eps2}
\DoxyCodeLine{3680 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{3681 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{3682 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{3683 \textcolor{keywordflow}{   endif}}
\DoxyCodeLine{3684 }
\DoxyCodeLine{3685    \textcolor{keywordflow}{if} (bosonvertex .eq. 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3686 \textcolor{comment}{! type(4)}}
\DoxyCodeLine{3687       \textcolor{keywordflow}{do} na=0,numglu(1)}
\DoxyCodeLine{3688       \textcolor{keywordflow}{do} nc=0,numglu(2)}
\DoxyCodeLine{3689       \textcolor{keywordflow}{do} ne=0,numglu(3)}
\DoxyCodeLine{3690       \textcolor{keywordflow}{do} nf=0,numglu(3)-\/ne}
\DoxyCodeLine{3691       \textcolor{keywordflow}{do} nh=0,numglu(4)   \textcolor{comment}{! this loop can be placed after Eps1 has been calculated}}
\DoxyCodeLine{3692       \textcolor{keywordflow}{do} nj=0,numglu(5)}
\DoxyCodeLine{3693          nb=numglu(1)-\/na}
\DoxyCodeLine{3694          nd=numglu(2)-\/nc}
\DoxyCodeLine{3695          ng=numglu(3)-\/ne-\/nf}
\DoxyCodeLine{3696          ni=numglu(4)-\/nh}
\DoxyCodeLine{3697          nk=numglu(5)-\/nj}
\DoxyCodeLine{3698 }
\DoxyCodeLine{3699          rin = na+1}
\DoxyCodeLine{3700          rout= numglu(1)+numglu(2)+ne}
\DoxyCodeLine{3701          eps1 = cur\_g\_2fv(gluons(rin:rout),quarks(1:2),boson,(/1+nb+nc+nd+ne,nc,nc+nd,ne/) )}
\DoxyCodeLine{3702          tmpmom1 =  summom(gluons,rin,rout) + quarks(1)\%Mom + quarks(2)\%Mom + boson\%Mom}
\DoxyCodeLine{3703          propfac3 = (0d0,-\/1d0)/sc\_(tmpmom1,tmpmom1)}
\DoxyCodeLine{3704          \textcolor{keywordflow}{if}( abs(sc\_(tmpmom1,tmpmom1)).lt.propcut ) cycle}
\DoxyCodeLine{3705          eps1 = eps1*propfac3}
\DoxyCodeLine{3706 }
\DoxyCodeLine{3707          rin = numglu(1)+numglu(2)+ne+nf+1}
\DoxyCodeLine{3708          rout= numglu(1)+numglu(2)+numglu(3)+nh}
\DoxyCodeLine{3709          u1 = cur\_f\_2f(gluons(rin:rout),quarks(3:3),-\/quarks(3)\%PartType,(/ng+nh,ng,nh/))}
\DoxyCodeLine{3710          pmom3 = summom(gluons,rin,rout) + quarks(3)\%Mom}
\DoxyCodeLine{3711          \textcolor{keywordflow}{if}( ng.ge.1 .or. nh.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3712             propfac3 = (0d0,1d0)/(sc\_(pmom3,pmom3) -\/ quarks(3)\%Mass2)}
\DoxyCodeLine{3713             \textcolor{keywordflow}{if}( abs(sc\_(pmom3,pmom3) -\/ quarks(3)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3714             \textcolor{keywordflow}{if}( quarks(3)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3715                u1 = (-\/spi2\_(pmom3,u1) + quarks(3)\%Mass*u1 )*propfac3}
\DoxyCodeLine{3716             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3717                u1 = (+spb2\_(u1,pmom3) + quarks(3)\%Mass*u1 )*propfac3}
\DoxyCodeLine{3718 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3719 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{3720          rin = numglu(1)+numglu(2)+numglu(3)+nh+1}
\DoxyCodeLine{3721          rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+nj}
\DoxyCodeLine{3722          ubar2 = cur\_f\_2f(gluons(rin:rout),quarks(4:4),-\/quarks(4)\%PartType,(/ni+nj,ni,nj/))}
\DoxyCodeLine{3723          pmom4 = summom(gluons,rin,rout) + quarks(4)\%Mom}
\DoxyCodeLine{3724          \textcolor{keywordflow}{if}( ni.ge.1 .or. nj.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3725             propfac4 = (0d0,1d0)/(sc\_(pmom4,pmom4) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{3726             \textcolor{keywordflow}{if}( abs(sc\_(pmom4,pmom4) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3727             \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3728                ubar2 = (-\/spi2\_(pmom4,ubar2) + quarks(4)\%Mass*ubar2 )*propfac4}
\DoxyCodeLine{3729             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3730                ubar2 = (+spb2\_(ubar2,pmom4) + quarks(4)\%Mass*ubar2 )*propfac4}
\DoxyCodeLine{3731 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3732 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{3733 }
\DoxyCodeLine{3734          \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3735             eps2 = +vbqq(dv,u1,ubar2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3736          \textcolor{keywordflow}{else}}
\DoxyCodeLine{3737             eps2 = -\/vbqq(dv,ubar2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3738 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{3739          tmpmom2 = pmom3 + pmom4}
\DoxyCodeLine{3740          propfac1 = (0d0,-\/1d0)/sc\_(tmpmom2,tmpmom2)}
\DoxyCodeLine{3741          \textcolor{keywordflow}{if}( abs(sc\_(tmpmom2,tmpmom2)).lt.propcut ) cycle}
\DoxyCodeLine{3742          eps2 = eps2*propfac1}
\DoxyCodeLine{3743 }
\DoxyCodeLine{3744 }
\DoxyCodeLine{3745          counter=1}
\DoxyCodeLine{3746          rin =1}
\DoxyCodeLine{3747          rout=na}
\DoxyCodeLine{3748          \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3749             \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3750             counter=counter+1}
\DoxyCodeLine{3751 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3752          tmpextref1 = -\/1}
\DoxyCodeLine{3753          tmpgluons(counter)\%Mom => tmpmom1(:)}
\DoxyCodeLine{3754          tmpgluons(counter)\%Pol => eps1(:)}
\DoxyCodeLine{3755          tmpgluons(counter)\%ExtRef => tmpextref1}
\DoxyCodeLine{3756          counter=counter+1}
\DoxyCodeLine{3757          rin =numglu(1)+numglu(2)+ne+1}
\DoxyCodeLine{3758          rout=numglu(1)+numglu(2)+ne+nf}
\DoxyCodeLine{3759          \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3760             \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3761             counter=counter+1}
\DoxyCodeLine{3762 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3763          tmpgluons(counter)\%Mom => tmpmom2(:)}
\DoxyCodeLine{3764          tmpgluons(counter)\%Pol => eps2(:)}
\DoxyCodeLine{3765          tmpgluons(counter)\%ExtRef => tmpextref1}
\DoxyCodeLine{3766          counter=counter+1}
\DoxyCodeLine{3767          rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+nj+1}
\DoxyCodeLine{3768          rout=numglu(0)-\/1}
\DoxyCodeLine{3769          \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3770             \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3771             counter=counter+1}
\DoxyCodeLine{3772 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3773          eps3(:) = cur\_g(tmpgluons(1:counter-\/1),1+na+nf+nk+2)}
\DoxyCodeLine{3774          res = res + eps3}
\DoxyCodeLine{3775 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3776 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3777 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3778 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3779 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3780 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3781 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{3782 }
\DoxyCodeLine{3783       \textcolor{keywordflow}{if} (bosonvertex .eq. 3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3784 }
\DoxyCodeLine{3785          \textcolor{keywordflow}{do} na=0,numglu(1)}
\DoxyCodeLine{3786          \textcolor{keywordflow}{do} nc=0,numglu(4)}
\DoxyCodeLine{3787          \textcolor{keywordflow}{do} ne=0,numglu(5)        \textcolor{comment}{! can be replaced by above ne-\/loop}}
\DoxyCodeLine{3788             nb=numglu(1)-\/na}
\DoxyCodeLine{3789             nd=numglu(4)-\/nc}
\DoxyCodeLine{3790             nf=numglu(5)-\/ne}
\DoxyCodeLine{3791 }
\DoxyCodeLine{3792             rin = na+1}
\DoxyCodeLine{3793             rout= numglu(1)+numglu(2)+numglu(3)+nc}
\DoxyCodeLine{3794             u1 = cur\_f\_4f(gluons(rin:rout),quarks(1:3),quarks(4)\%PartType,(/nb+numglu(2)+numglu(3)+nc,nb,numglu(2),numglu(3),nc/),0,0)}
\DoxyCodeLine{3795             pmom2 =  summom(gluons,rin,rout) + quarks(1)\%Mom + quarks(2)\%Mom + quarks(3)\%Mom}
\DoxyCodeLine{3796             propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{3797             \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3798             \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3799               u1 = (+spb2\_(u1,pmom2) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3800             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3801               u1 = (-\/spi2\_(pmom2,u1) + quarks(4)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3802 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3803             rin = numglu(1)+numglu(2)+numglu(3)+nc+1}
\DoxyCodeLine{3804             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne}
\DoxyCodeLine{3805             ubar2 = cur\_f\_2fv(gluons(rin:rout),quarks(4:4),-\/quarks(4)\%PartType,boson,(/nd+ne,nd,ne/))}
\DoxyCodeLine{3806             pmom3  = summom(gluons,rin,rout) + quarks(4)\%Mom + boson\%Mom}
\DoxyCodeLine{3807             propfac3 = (0d0,1d0)/(sc\_(pmom3,pmom3) -\/ quarks(4)\%Mass2)}
\DoxyCodeLine{3808             \textcolor{keywordflow}{if}( abs(sc\_(pmom3,pmom3) -\/ quarks(4)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3809             \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3810                ubar2 = (-\/spi2\_(pmom3,ubar2) + quarks(4)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{3811             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3812                ubar2 = (+spb2\_(ubar2,pmom3) + quarks(4)\%Mass*ubar2 )*propfac3}
\DoxyCodeLine{3813 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3814 }
\DoxyCodeLine{3815             \textcolor{keywordflow}{if}( quarks(4)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3816               eps1 = +vbqq(dv,u1,ubar2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3817             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3818               eps1 = -\/vbqq(dv,ubar2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3819 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3820 }
\DoxyCodeLine{3821             counter=1}
\DoxyCodeLine{3822             rin =1}
\DoxyCodeLine{3823             rout=na}
\DoxyCodeLine{3824             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3825               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3826               counter=counter+1}
\DoxyCodeLine{3827 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{3828             tmpmom1(:) = pmom2(:)+pmom3(:)}
\DoxyCodeLine{3829             tmpextref1 = -\/1}
\DoxyCodeLine{3830             tmpgluons(counter)\%Mom => tmpmom1(:)}
\DoxyCodeLine{3831             tmpgluons(counter)\%Pol => eps1(:)}
\DoxyCodeLine{3832             tmpgluons(counter)\%ExtRef => tmpextref1}
\DoxyCodeLine{3833             counter=counter+1}
\DoxyCodeLine{3834             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+ne+1}
\DoxyCodeLine{3835             rout=numglu(0)-\/1}
\DoxyCodeLine{3836             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3837               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3838               counter=counter+1}
\DoxyCodeLine{3839 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{3840             eps2(:) = cur\_g(tmpgluons(1:counter-\/1),1+na+nf+1)}
\DoxyCodeLine{3841 }
\DoxyCodeLine{3842             \textcolor{keywordflow}{if}( na.ge.1 .or. nf.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3843                propfac1 = (0d0,-\/1d0)/sc\_(tmpmom1,tmpmom1)}
\DoxyCodeLine{3844                \textcolor{keywordflow}{if}( abs(sc\_(tmpmom1,tmpmom1)).lt.propcut ) cycle}
\DoxyCodeLine{3845                eps2 = eps2*propfac1}
\DoxyCodeLine{3846 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3847 }
\DoxyCodeLine{3848             res = res + eps2}
\DoxyCodeLine{3849 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3850 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3851 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3852 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{3853 }
\DoxyCodeLine{3854       \textcolor{keywordflow}{if} (bosonvertex .eq. 3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3855 }
\DoxyCodeLine{3856          \textcolor{keywordflow}{do} na=0,numglu(1)}
\DoxyCodeLine{3857          \textcolor{keywordflow}{do} nc=0,numglu(2)}
\DoxyCodeLine{3858          \textcolor{keywordflow}{do} ne=0,numglu(3)}
\DoxyCodeLine{3859          \textcolor{keywordflow}{do} nf=0,numglu(3)-\/ne}
\DoxyCodeLine{3860          \textcolor{keywordflow}{do} nh=0,numglu(4)   \textcolor{comment}{! this loop can be placed after Eps1 has been calculated}}
\DoxyCodeLine{3861          \textcolor{keywordflow}{do} nj=0,numglu(5)}
\DoxyCodeLine{3862             nb=numglu(1)-\/na}
\DoxyCodeLine{3863             nd=numglu(2)-\/nc}
\DoxyCodeLine{3864             ng=numglu(3)-\/ne-\/nf}
\DoxyCodeLine{3865             ni=numglu(4)-\/nh}
\DoxyCodeLine{3866             nk=numglu(5)-\/nj}
\DoxyCodeLine{3867 }
\DoxyCodeLine{3868             rin = na+1}
\DoxyCodeLine{3869             rout= numglu(1)+nc}
\DoxyCodeLine{3870             ubar2 = cur\_f\_2f(gluons(rin:rout),quarks(1:1),-\/quarks(1)\%PartType,(/nb+nc,nb,nc/))}
\DoxyCodeLine{3871             pmom1 = summom(gluons,rin,rout) + quarks(1)\%Mom}
\DoxyCodeLine{3872             \textcolor{keywordflow}{if}( nb.ge.1 .or. nc.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3873                propfac1 = (0d0,1d0)/(sc\_(pmom1,pmom1) -\/ quarks(1)\%Mass2)}
\DoxyCodeLine{3874                \textcolor{keywordflow}{if}( abs(sc\_(pmom1,pmom1) -\/ quarks(1)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3875                \textcolor{keywordflow}{if}( quarks(1)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3876                   ubar2 = (-\/spi2\_(pmom1,ubar2) + quarks(1)\%Mass*ubar2 )*propfac1}
\DoxyCodeLine{3877                \textcolor{keywordflow}{else}}
\DoxyCodeLine{3878                   ubar2 = (+spb2\_(ubar2,pmom1) + quarks(1)\%Mass*ubar2 )*propfac1}
\DoxyCodeLine{3879 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{3880 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3881             rin = numglu(1)+nc+1}
\DoxyCodeLine{3882             rout= numglu(1)+numglu(2)+ne}
\DoxyCodeLine{3883             u1 = cur\_f\_2f(gluons(rin:rout),quarks(2:2),-\/quarks(2)\%PartType,(/nd+ne,nd,ne/))}
\DoxyCodeLine{3884             pmom2 = summom(gluons,rin,rout) + quarks(2)\%Mom}
\DoxyCodeLine{3885             \textcolor{keywordflow}{if}( nd.ge.1 .or. ne.ge.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3886                propfac2 = (0d0,1d0)/(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2)}
\DoxyCodeLine{3887                \textcolor{keywordflow}{if}( abs(sc\_(pmom2,pmom2) -\/ quarks(2)\%Mass2).lt.propcut ) cycle}
\DoxyCodeLine{3888                \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3889                   u1 = (-\/spi2\_(pmom2,u1) + quarks(2)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3890                \textcolor{keywordflow}{else}}
\DoxyCodeLine{3891                   u1 = (+spb2\_(u1,pmom2) + quarks(2)\%Mass*u1 )*propfac2}
\DoxyCodeLine{3892 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{3893 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3894 }
\DoxyCodeLine{3895             \textcolor{keywordflow}{if}( quarks(2)\%PartType.lt.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3896               eps1 = +vbqq(dv,ubar2,u1)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3897             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3898               eps1 = -\/vbqq(dv,u1,ubar2)       \textcolor{comment}{! re-\/checked}}
\DoxyCodeLine{3899 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{3900             tmpmom1 = pmom1 + pmom2}
\DoxyCodeLine{3901             propfac3 = (0d0,-\/1d0)/sc\_(tmpmom1,tmpmom1)}
\DoxyCodeLine{3902             \textcolor{keywordflow}{if}( abs(sc\_(tmpmom1,tmpmom1)).lt.propcut ) cycle}
\DoxyCodeLine{3903             eps1 = eps1*propfac3}
\DoxyCodeLine{3904 }
\DoxyCodeLine{3905             rin = numglu(1)+numglu(2)+ne+nf+1}
\DoxyCodeLine{3906             rout= numglu(1)+numglu(2)+numglu(3)+numglu(4)+nj}
\DoxyCodeLine{3907             eps2=cur\_g\_2fv(gluons(rin:rout),quarks(3:4),boson,(/1+ng+nh+ni+nj,ng,nh,ni,nj /) )}
\DoxyCodeLine{3908             tmpmom2 = summom(gluons,rin,rout) +quarks(3)\%Mom + quarks(4)\%Mom + boson\%Mom}
\DoxyCodeLine{3909             propfac1 = (0d0,-\/1d0)/sc\_(tmpmom2,tmpmom2)}
\DoxyCodeLine{3910             \textcolor{keywordflow}{if}( abs(sc\_(tmpmom2,tmpmom2)).lt.propcut ) cycle}
\DoxyCodeLine{3911             eps2 = eps2*propfac1}
\DoxyCodeLine{3912 }
\DoxyCodeLine{3913             counter=1}
\DoxyCodeLine{3914             rin =1}
\DoxyCodeLine{3915             rout=na}
\DoxyCodeLine{3916             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3917               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3918               counter=counter+1}
\DoxyCodeLine{3919 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{3920             tmpextref1 = -\/1}
\DoxyCodeLine{3921             tmpgluons(counter)\%Mom => tmpmom1(:)}
\DoxyCodeLine{3922             tmpgluons(counter)\%Pol => eps1(:)}
\DoxyCodeLine{3923             tmpgluons(counter)\%ExtRef => tmpextref1}
\DoxyCodeLine{3924             counter=counter+1}
\DoxyCodeLine{3925             rin =numglu(1)+numglu(2)+ne+1}
\DoxyCodeLine{3926             rout=numglu(1)+numglu(2)+ne+nf}
\DoxyCodeLine{3927             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3928               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3929               counter=counter+1}
\DoxyCodeLine{3930 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{3931             tmpgluons(counter)\%Mom => tmpmom2(:)}
\DoxyCodeLine{3932             tmpgluons(counter)\%Pol => eps2(:)}
\DoxyCodeLine{3933             tmpgluons(counter)\%ExtRef => tmpextref1}
\DoxyCodeLine{3934             counter=counter+1}
\DoxyCodeLine{3935             rin =numglu(1)+numglu(2)+numglu(3)+numglu(4)+nj+1}
\DoxyCodeLine{3936             rout=numglu(0)-\/1}
\DoxyCodeLine{3937             \textcolor{keywordflow}{do} i=rin,rout}
\DoxyCodeLine{3938               \textcolor{keyword}{call }copyparticleptr(gluons(i),tmpgluons(counter))}
\DoxyCodeLine{3939               counter=counter+1}
\DoxyCodeLine{3940 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{3941             eps3(:) = cur\_g(tmpgluons(1:counter-\/1),1+na+nf+nk+2)}
\DoxyCodeLine{3942             res = res + eps3}
\DoxyCodeLine{3943 }
\DoxyCodeLine{3944 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{3945 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{3946 \textcolor{keywordflow}{   enddo}}
\DoxyCodeLine{3947 \textcolor{keywordflow}{enddo}}
\DoxyCodeLine{3948 \textcolor{keywordflow}{enddo}}
\DoxyCodeLine{3949 \textcolor{keywordflow}{enddo}}
\DoxyCodeLine{3950 }
\DoxyCodeLine{3951 \textcolor{keywordflow}{endif}   \textcolor{comment}{! BosonVertex}}
\DoxyCodeLine{3952 }
\DoxyCodeLine{3953 }
\DoxyCodeLine{3954 \textcolor{keywordflow}{if} (bosonvertex .ne. 1 .and. bosonvertex .ne. 3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3955    print *, \textcolor{stringliteral}{'Not implemented for for cur\_g\_4fV for this flavor structure and BosonVertex='}, bosonvertex}
\DoxyCodeLine{3956    stop}
\DoxyCodeLine{3957 \textcolor{keywordflow}{endif}}
\DoxyCodeLine{3958 \textcolor{keywordflow}{endif}}
\DoxyCodeLine{3959 }
\DoxyCodeLine{3960 \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_afca1d82cc226d765fdffe455835ca6d5}\label{namespacemodttbhiggs_afca1d82cc226d765fdffe455835ca6d5}} 
\index{modttbhiggs@{modttbhiggs}!eval\_quadvert@{eval\_quadvert}}
\index{eval\_quadvert@{eval\_quadvert}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{eval\_quadvert()}{eval\_quadvert()}}
{\footnotesize\ttfamily complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}) modttbhiggs\+::eval\+\_\+quadvert (\begin{DoxyParamCaption}\item[{complex(8), dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}})}]{k1,  }\item[{complex(8), dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}})}]{k2,  }\item[{complex(8), dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}})}]{k3 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5035 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5035 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5036 \textcolor{keywordtype}{complex(8)} :: eval\_QuadVert(1:Dv)}
\DoxyCodeLine{5037 \textcolor{keywordtype}{complex(8)} :: k1(1:Dv),k2(1:Dv),k3(1:Dv)}
\DoxyCodeLine{5038 \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{parameter} :: I=(0d0,1d0)}
\DoxyCodeLine{5039 }
\DoxyCodeLine{5040    eval\_quadvert(1:dv) = i * (-\/k1(1:dv)*(k2.ndot.k3)*0.5d0  \&}
\DoxyCodeLine{5041                            + k2(1:dv)*(k1.ndot.k3)  \&}
\DoxyCodeLine{5042                            -\/ k3(1:dv)*(k1.ndot.k2)*0.5d0 )}
\DoxyCodeLine{5043 \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a288ffcd69e7511bab4de892ff5b4972c}\label{namespacemodttbhiggs_a288ffcd69e7511bab4de892ff5b4972c}} 
\index{modttbhiggs@{modttbhiggs}!eval\_tripvert@{eval\_tripvert}}
\index{eval\_tripvert@{eval\_tripvert}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{eval\_tripvert()}{eval\_tripvert()}}
{\footnotesize\ttfamily complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}) modttbhiggs\+::eval\+\_\+tripvert (\begin{DoxyParamCaption}\item[{complex(8), dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}})}]{k1,  }\item[{complex(8), dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}})}]{k2,  }\item[{complex(8), dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}})}]{v1,  }\item[{complex(8), dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}})}]{v2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5023 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5023 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5024 \textcolor{keywordtype}{complex(8)} :: eval\_TripVert(1:Dv)}
\DoxyCodeLine{5025 \textcolor{keywordtype}{complex(8)} :: k1(1:Dv),k2(1:Dv),v1(1:Dv),v2(1:Dv)}
\DoxyCodeLine{5026 \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{parameter} :: IOverSqrt2=(0d0,1d0)/dsqrt(2d0)}
\DoxyCodeLine{5027 }
\DoxyCodeLine{5028    eval\_tripvert(1:dv) = ioversqrt2 * ( (k1(1:dv)-\/k2(1:dv))*(v1.ndot.v2)  \&}
\DoxyCodeLine{5029                            -\/ 2d0*v1(1:dv)*(k1.ndot.v2)  \&}
\DoxyCodeLine{5030                            + 2d0*v2(1:dv)*(k2.ndot.v1) )}
\DoxyCodeLine{5031 \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_aa7190026459c187d5653d724aac7ffe4}\label{namespacemodttbhiggs_aa7190026459c187d5653d724aac7ffe4}} 
\index{modttbhiggs@{modttbhiggs}!evalamp\_gg\_ttbh@{evalamp\_gg\_ttbh}}
\index{evalamp\_gg\_ttbh@{evalamp\_gg\_ttbh}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{evalamp\_gg\_ttbh()}{evalamp\_gg\_ttbh()}}
{\footnotesize\ttfamily subroutine, public modttbhiggs\+::evalamp\+\_\+gg\+\_\+ttbh (\begin{DoxyParamCaption}\item[{real(8), dimension(1\+:4,1\+:13)}]{Mom,  }\item[{real(8)}]{Sq\+Amp }\end{DoxyParamCaption})}



Definition at line 292 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{292 \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacemodtopdecay}{modtopdecay}}}
\DoxyCodeLine{293 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{294 \textcolor{keywordtype}{real}(8) :: Mom(1:4,1:13),SqAmp}
\DoxyCodeLine{295 \textcolor{keywordtype}{complex(8)} :: ResOffSh(1:4,1:2),Res(1:2,1:2)}
\DoxyCodeLine{296 \textcolor{keywordtype}{complex(8)} :: GluPol(1:4,1:2,1:2)}
\DoxyCodeLine{297 \textcolor{keywordtype}{integer} :: hel4,TopHel1,TopHel2,nhel}
\DoxyCodeLine{298 \textcolor{keywordtype}{real}(8),\textcolor{keywordtype}{parameter} :: c\_aa=64.d0/3.d0, c\_ab=-\/8.d0/3.d0}
\DoxyCodeLine{299 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: inLeft=1,inright=2,hbos=3,tbar=4,t=5,  bbar=6,wm=7,lepm=8,nubar=9,  b=10,wp=11,lepp=12,nu=13}
\DoxyCodeLine{300 sqamp = 0d0}
\DoxyCodeLine{301 }
\DoxyCodeLine{302 }
\DoxyCodeLine{303      extparticles(1)\%Mom(1:4) = mom(1:4,tbar)}
\DoxyCodeLine{304      extparticles(2)\%Mom(1:4) = mom(1:4,t)}
\DoxyCodeLine{305      extparticles(3)\%Mom(1:4) =-\/mom(1:4,inleft)}
\DoxyCodeLine{306      extparticles(4)\%Mom(1:4) =-\/mom(1:4,inright)}
\DoxyCodeLine{307      extparticles(7)\%Mom(1:4) = mom(1:4,hbos)}
\DoxyCodeLine{308 }
\DoxyCodeLine{309      \textcolor{keywordflow}{if}( topdecays.ne.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{310         \textcolor{keyword}{call }\mbox{\hyperlink{namespacemodtopdecay_ac0e741197b0c87c87664b5b9cc978796}{topdecay}}(atop\_,(/mom(1:4,bbar),mom(1:4,lepm),mom(1:4,nubar)/),extparticles(1)\%Pol(1:4))}
\DoxyCodeLine{311         \textcolor{keyword}{call }\mbox{\hyperlink{namespacemodtopdecay_ac0e741197b0c87c87664b5b9cc978796}{topdecay}}(top\_,(/mom(1:4,b),mom(1:4,lepp),mom(1:4,nu)/),extparticles(2)\%Pol(1:4))}
\DoxyCodeLine{312 \textcolor{keywordflow}{     endif}}
\DoxyCodeLine{313      extparticles(7)\%Pol(1:4) = 1d0}
\DoxyCodeLine{314 \textcolor{comment}{!    call HDecay(ExtParticles(7),DK\_LO,MomExt(1:4,12:13))}}
\DoxyCodeLine{315      glupol(1:4,1,1) = pol\_mless(extparticles(3)\%Mom(1:4),+1,outgoing=.true.)}
\DoxyCodeLine{316      glupol(1:4,1,2) = pol\_mless(extparticles(3)\%Mom(1:4),-\/1,outgoing=.true.)}
\DoxyCodeLine{317      glupol(1:4,2,1) = pol\_mless(extparticles(4)\%Mom(1:4),+1,outgoing=.true.)}
\DoxyCodeLine{318      glupol(1:4,2,2) = pol\_mless(extparticles(4)\%Mom(1:4),-\/1,outgoing=.true.)}
\DoxyCodeLine{319 \textcolor{comment}{!      GluPol(1:4,1,1) = ExtParticles(3)\%Mom(1:4);  GluPol(1:4,1,2) = ExtParticles(3)\%Mom(1:4); print *, "checking gauge invariance"}}
\DoxyCodeLine{320 }
\DoxyCodeLine{321 }
\DoxyCodeLine{322      nhel=-\/1}
\DoxyCodeLine{323      \textcolor{keywordflow}{if}( topdecays.EQ.0 ) nhel=+1}
\DoxyCodeLine{324      \textcolor{keywordflow}{do} tophel1=-\/1,nhel,2}
\DoxyCodeLine{325      \textcolor{keywordflow}{do} tophel2=-\/1,nhel,2}
\DoxyCodeLine{326      \textcolor{keywordflow}{if}( topdecays.eq.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{327              \textcolor{keyword}{call }\mbox{\hyperlink{namespacemodtopdecay_abbe65bbce11527ccccf0de21f7842442}{ubarspi\_dirac}}(extparticles(2)\%Mom(1:4),m\_top,tophel1,extparticles(2)\%Pol(1:4))}
\DoxyCodeLine{328              \textcolor{keyword}{call    }\mbox{\hyperlink{namespacemodtopdecay_a04294c1d5d5668e0dab676f448ea392c}{vspi\_dirac}}(extparticles(1)\%Mom(1:4),m\_top,tophel2,extparticles(1)\%Pol(1:4))}
\DoxyCodeLine{329 \textcolor{keywordflow}{     endif}}
\DoxyCodeLine{330      \textcolor{keywordflow}{do} hel4=1,2}
\DoxyCodeLine{331 }
\DoxyCodeLine{332         extparticles(4)\%Pol(1:4) = glupol(1:4,2,hel4)}
\DoxyCodeLine{333 \textcolor{comment}{!         ExtParticles(4)\%Pol(1:4) = ExtParticles(4)\%Mom(1:4); print *, "checking gauge invariance"}}
\DoxyCodeLine{334         \textcolor{keyword}{call }new\_calc\_ampl(0,0,thetreeamps\_gg\_ttbh(1),resoffsh(1:4,1))}
\DoxyCodeLine{335         \textcolor{keyword}{call }new\_calc\_ampl(0,0,thetreeamps\_gg\_ttbh(2),resoffsh(1:4,2))}
\DoxyCodeLine{336 }
\DoxyCodeLine{337         res(1,1) = (resoffsh(1:4,1).ndot.glupol(1:4,1,1))\textcolor{comment}{! col1 hel+}}
\DoxyCodeLine{338         res(2,1) = (resoffsh(1:4,2).ndot.glupol(1:4,1,1))\textcolor{comment}{! col2 hel+}}
\DoxyCodeLine{339         res(1,2) = (resoffsh(1:4,1).ndot.glupol(1:4,1,2))\textcolor{comment}{! col1 hel-\/}}
\DoxyCodeLine{340         res(2,2) = (resoffsh(1:4,2).ndot.glupol(1:4,1,2))\textcolor{comment}{! col2 hel-\/}}
\DoxyCodeLine{341 }
\DoxyCodeLine{342         sqamp = sqamp   \&}
\DoxyCodeLine{343               + c\_aa * dreal( res(1,1)*dconjg(res(1,1)) + res(1,2)*dconjg(res(1,2)) )  \&}
\DoxyCodeLine{344               + c\_ab * dreal( res(1,1)*dconjg(res(2,1)) + res(1,2)*dconjg(res(2,2)) )  \&}
\DoxyCodeLine{345               + c\_ab * dreal( res(2,1)*dconjg(res(1,1)) + res(2,2)*dconjg(res(1,2)) )  \&}
\DoxyCodeLine{346               + c\_aa * dreal( res(2,1)*dconjg(res(2,1)) + res(2,2)*dconjg(res(2,2)) )}
\DoxyCodeLine{347 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{348 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{349 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{350 }
\DoxyCodeLine{351     sqamp = sqamp * \mbox{\hyperlink{namespacemodparameters_ac6743073e1521129570782d75d3478b9}{spinavg}} * \mbox{\hyperlink{namespacemodparameters_a880269515978a3688072959c3d1c06e2}{gluoncolavg}}**2 * (4d0*pi*alphas)**2  \textcolor{comment}{!* (4d0*pi*alpha\_QED) * (m\_top/(2d0*sitW*M\_W))**2}}
\DoxyCodeLine{352 }
\DoxyCodeLine{353 }
\DoxyCodeLine{354 \textcolor{keywordflow}{RETURN}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_addb2d779063d5155da736dd7ed41d091}\label{namespacemodttbhiggs_addb2d779063d5155da736dd7ed41d091}} 
\index{modttbhiggs@{modttbhiggs}!evalamp\_qqb\_ttbh@{evalamp\_qqb\_ttbh}}
\index{evalamp\_qqb\_ttbh@{evalamp\_qqb\_ttbh}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{evalamp\_qqb\_ttbh()}{evalamp\_qqb\_ttbh()}}
{\footnotesize\ttfamily subroutine, public modttbhiggs\+::evalamp\+\_\+qqb\+\_\+ttbh (\begin{DoxyParamCaption}\item[{real(8), dimension(1\+:4,1\+:13)}]{Mom,  }\item[{real(8)}]{Sq\+Amp }\end{DoxyParamCaption})}



Definition at line 364 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{364 \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacemodtopdecay}{modtopdecay}}}
\DoxyCodeLine{365 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{366 \textcolor{keywordtype}{real}(8) :: Mom(1:4,1:13),SqAmp}
\DoxyCodeLine{367 \textcolor{keywordtype}{complex(8)} :: ResOffSh(1:4),Res(1:2)}
\DoxyCodeLine{368 \textcolor{keywordtype}{complex(8)} :: QuaPol(1:4,1:2,1:2)}
\DoxyCodeLine{369 \textcolor{keywordtype}{integer} :: hel4,TopHel1,TopHel2,nhel}
\DoxyCodeLine{370 \textcolor{keywordtype}{real}(8),\textcolor{keywordtype}{parameter} :: c\_aa=8.0d0}
\DoxyCodeLine{371 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: inLeft=1,inright=2,hbos=3,tbar=4,t=5,  bbar=6,wm=7,lepm=8,nubar=9,  b=10,wp=11,lepp=12,nu=13}
\DoxyCodeLine{372 sqamp = 0d0}
\DoxyCodeLine{373 }
\DoxyCodeLine{374      extparticles(1)\%Mom(1:4) = mom(1:4,tbar)}
\DoxyCodeLine{375      extparticles(2)\%Mom(1:4) = mom(1:4,t)}
\DoxyCodeLine{376      extparticles(5)\%Mom(1:4) =-\/mom(1:4,inleft)}
\DoxyCodeLine{377      extparticles(6)\%Mom(1:4) =-\/mom(1:4,inright)}
\DoxyCodeLine{378      extparticles(7)\%Mom(1:4) = mom(1:4,hbos)}
\DoxyCodeLine{379 }
\DoxyCodeLine{380      \textcolor{keywordflow}{if}( topdecays.ne.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{381         \textcolor{keyword}{call }\mbox{\hyperlink{namespacemodtopdecay_ac0e741197b0c87c87664b5b9cc978796}{topdecay}}(atop\_,(/mom(1:4,bbar),mom(1:4,lepm),mom(1:4,nubar)/),extparticles(1)\%Pol(1:4))}
\DoxyCodeLine{382         \textcolor{keyword}{call }\mbox{\hyperlink{namespacemodtopdecay_ac0e741197b0c87c87664b5b9cc978796}{topdecay}}(top\_,(/mom(1:4,b),mom(1:4,lepp),mom(1:4,nu)/),extparticles(2)\%Pol(1:4))}
\DoxyCodeLine{383 \textcolor{keywordflow}{     endif}}
\DoxyCodeLine{384      extparticles(7)\%Pol(1:4) = 1d0}
\DoxyCodeLine{385 \textcolor{comment}{!    call HDecay(ExtParticles(7),DK\_LO,MomExt(1:4,12:13))}}
\DoxyCodeLine{386      \textcolor{keyword}{call }\mbox{\hyperlink{namespacemodtopdecay_abbe65bbce11527ccccf0de21f7842442}{ubarspi\_dirac}}(extparticles(6)\%Mom(1:4),0d0,-\/1,quapol(1:4,1,1))}
\DoxyCodeLine{387      \textcolor{keyword}{call }\mbox{\hyperlink{namespacemodtopdecay_abbe65bbce11527ccccf0de21f7842442}{ubarspi\_dirac}}(extparticles(6)\%Mom(1:4),0d0,+1,quapol(1:4,1,2))}
\DoxyCodeLine{388      \textcolor{keyword}{call    }\mbox{\hyperlink{namespacemodtopdecay_a04294c1d5d5668e0dab676f448ea392c}{vspi\_dirac}}(extparticles(5)\%Mom(1:4),0d0,-\/1,quapol(1:4,2,1))}
\DoxyCodeLine{389      \textcolor{keyword}{call    }\mbox{\hyperlink{namespacemodtopdecay_a04294c1d5d5668e0dab676f448ea392c}{vspi\_dirac}}(extparticles(5)\%Mom(1:4),0d0,+1,quapol(1:4,2,2))}
\DoxyCodeLine{390 }
\DoxyCodeLine{391 }
\DoxyCodeLine{392 }
\DoxyCodeLine{393      nhel=-\/1}
\DoxyCodeLine{394      \textcolor{keywordflow}{if}( topdecays.EQ.0 ) nhel=+1}
\DoxyCodeLine{395      \textcolor{keywordflow}{do} tophel1=-\/1,nhel,2}
\DoxyCodeLine{396      \textcolor{keywordflow}{do} tophel2=-\/1,nhel,2}
\DoxyCodeLine{397      \textcolor{keywordflow}{if}( topdecays.eq.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{398              \textcolor{keyword}{call }\mbox{\hyperlink{namespacemodtopdecay_abbe65bbce11527ccccf0de21f7842442}{ubarspi\_dirac}}(extparticles(2)\%Mom(1:4),m\_top,tophel1,extparticles(2)\%Pol(1:4))}
\DoxyCodeLine{399              \textcolor{keyword}{call    }\mbox{\hyperlink{namespacemodtopdecay_a04294c1d5d5668e0dab676f448ea392c}{vspi\_dirac}}(extparticles(1)\%Mom(1:4),m\_top,tophel2,extparticles(1)\%Pol(1:4))}
\DoxyCodeLine{400 \textcolor{keywordflow}{     endif}}
\DoxyCodeLine{401      \textcolor{keywordflow}{do} hel4=1,2}
\DoxyCodeLine{402 }
\DoxyCodeLine{403         extparticles(6)\%Pol(1:4) = quapol(1:4,2,hel4)}
\DoxyCodeLine{404 \textcolor{comment}{!         ExtParticles(4)\%Pol(1:4) = ExtParticles(4)\%Mom(1:4); print *, "checking gauge invariance"}}
\DoxyCodeLine{405         \textcolor{keyword}{call }new\_calc\_ampl(0,0,thetreeamps\_qqb\_ttbh(1),resoffsh(1:4))}
\DoxyCodeLine{406 }
\DoxyCodeLine{407         res(1) = \mbox{\hyperlink{namespacemodtopdecay_aac3bf6eedcfd98426e9db80b1e91897c}{psp1\_}}(resoffsh(1:4),quapol(1:4,1,1))\textcolor{comment}{! hel+}}
\DoxyCodeLine{408         res(2) = \mbox{\hyperlink{namespacemodtopdecay_aac3bf6eedcfd98426e9db80b1e91897c}{psp1\_}}(resoffsh(1:4),quapol(1:4,1,2))\textcolor{comment}{! hel-\/}}
\DoxyCodeLine{409 }
\DoxyCodeLine{410         sqamp = sqamp   \&}
\DoxyCodeLine{411               + c\_aa * dreal( res(1)*dconjg(res(1)) + res(2)*dconjg(res(2)) )}
\DoxyCodeLine{412 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{413 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{414 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{415     sqamp = sqamp * \mbox{\hyperlink{namespacemodparameters_ac6743073e1521129570782d75d3478b9}{spinavg}} * \mbox{\hyperlink{namespacemodparameters_afff94211cb0c2055888573c849fbc7b1}{quarkcolavg}}**2 * (4d0*pi*alphas)**2  \textcolor{comment}{!* (4d0*pi*alpha\_QED) * (m\_top/(2d0*sitW*M\_W))**2}}
\DoxyCodeLine{416 }
\DoxyCodeLine{417 \textcolor{keywordflow}{RETURN}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a65e3275546f4df87be8563957d0d2907}\label{namespacemodttbhiggs_a65e3275546f4df87be8563957d0d2907}} 
\index{modttbhiggs@{modttbhiggs}!evalxsec\_pp\_bbbh@{evalxsec\_pp\_bbbh}}
\index{evalxsec\_pp\_bbbh@{evalxsec\_pp\_bbbh}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{evalxsec\_pp\_bbbh()}{evalxsec\_pp\_bbbh()}}
{\footnotesize\ttfamily subroutine, public modttbhiggs\+::evalxsec\+\_\+pp\+\_\+bbbh (\begin{DoxyParamCaption}\item[{real(8), dimension(1\+:4,1\+:13), intent(in)}]{Mom,  }\item[{integer, intent(in)}]{Select\+Process,  }\item[{real(8), dimension(-\/5\+:5,-\/5\+:5), intent(out)}]{Res }\end{DoxyParamCaption})}



Definition at line 111 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{111 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{112 \textcolor{keywordtype}{real}(8), \textcolor{keywordtype}{intent(in)} :: Mom(1:4,1:13)}
\DoxyCodeLine{113 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{intent(in)} :: SelectProcess\textcolor{comment}{! 0=gg, 1=qqb, 2=all}}
\DoxyCodeLine{114 \textcolor{keywordtype}{real}(8), \textcolor{keywordtype}{intent(out)} :: Res(-\/5:5,-\/5:5)}
\DoxyCodeLine{115 \textcolor{keywordtype}{real}(8) :: tmptopmass}
\DoxyCodeLine{116 \textcolor{keywordtype}{integer} :: tmptopdec}
\DoxyCodeLine{117    tmptopmass = m\_top}
\DoxyCodeLine{118    tmptopdec = topdecays}
\DoxyCodeLine{119 }
\DoxyCodeLine{120    m\_top = m\_bot}
\DoxyCodeLine{121    topdecays=0}
\DoxyCodeLine{122    \textcolor{keyword}{call }evalxsec\_pp\_ttbh(mom,selectprocess,res)}
\DoxyCodeLine{123 }
\DoxyCodeLine{124    m\_top = tmptopmass}
\DoxyCodeLine{125    topdecays = tmptopdec}
\DoxyCodeLine{126    \textcolor{keywordflow}{RETURN}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a02a58de06c7a82420c58721567c36927}\label{namespacemodttbhiggs_a02a58de06c7a82420c58721567c36927}} 
\index{modttbhiggs@{modttbhiggs}!evalxsec\_pp\_ttbh@{evalxsec\_pp\_ttbh}}
\index{evalxsec\_pp\_ttbh@{evalxsec\_pp\_ttbh}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{evalxsec\_pp\_ttbh()}{evalxsec\_pp\_ttbh()}}
{\footnotesize\ttfamily subroutine, public modttbhiggs\+::evalxsec\+\_\+pp\+\_\+ttbh (\begin{DoxyParamCaption}\item[{real(8), dimension(1\+:4,1\+:13), intent(in)}]{Mom,  }\item[{integer, intent(in)}]{Select\+Process,  }\item[{real(8), dimension(-\/5\+:5,-\/5\+:5), intent(out)}]{Res }\end{DoxyParamCaption})}



Definition at line 75 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{75 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{76 \textcolor{keywordtype}{real}(8), \textcolor{keywordtype}{intent(in)} :: Mom(1:4,1:13)}
\DoxyCodeLine{77 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{intent(in)} :: SelectProcess\textcolor{comment}{! 0=gg, 1=qqb, 2=all}}
\DoxyCodeLine{78 \textcolor{keywordtype}{real}(8), \textcolor{keywordtype}{intent(out)} :: Res(-\/5:5,-\/5:5)}
\DoxyCodeLine{79 \textcolor{keywordtype}{real}(8) :: MatElSq\_GG,MatElSq\_QQB,MatElSq\_QBQ}
\DoxyCodeLine{80 \textcolor{keywordtype}{integer} :: iq}
\DoxyCodeLine{81 }
\DoxyCodeLine{82    \textcolor{keyword}{call }initprocess\_ttbh()}
\DoxyCodeLine{83 }
\DoxyCodeLine{84    matelsq\_qqb = 0d0}
\DoxyCodeLine{85    matelsq\_qbq = 0d0}
\DoxyCodeLine{86    matelsq\_gg  = 0d0}
\DoxyCodeLine{87    \textcolor{keywordflow}{if}( selectprocess.eq.0 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{88       \textcolor{keyword}{call }evalamp\_gg\_ttbh(mom(1:4,1:13),matelsq\_gg)}
\DoxyCodeLine{89    \textcolor{keywordflow}{elseif}( selectprocess.eq.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{90       \textcolor{keyword}{call }evalamp\_qqb\_ttbh(mom(1:4,1:13),matelsq\_qqb)}
\DoxyCodeLine{91       matelsq\_qbq = matelsq\_qqb}
\DoxyCodeLine{92    \textcolor{keywordflow}{else}}
\DoxyCodeLine{93       \textcolor{keyword}{call }evalamp\_gg\_ttbh(mom(1:4,1:13),matelsq\_gg)}
\DoxyCodeLine{94       \textcolor{keyword}{call }evalamp\_qqb\_ttbh(mom(1:4,1:13),matelsq\_qqb)}
\DoxyCodeLine{95       matelsq\_qbq = matelsq\_qqb}
\DoxyCodeLine{96 \textcolor{keywordflow}{   endif}}
\DoxyCodeLine{97    \textcolor{keywordflow}{do} iq=0,5}
\DoxyCodeLine{98       \textcolor{keywordflow}{if}(iq.eq.pdfglu\_) \textcolor{keywordflow}{then}}
\DoxyCodeLine{99          res(iq,iq) = matelsq\_gg}
\DoxyCodeLine{100       \textcolor{keywordflow}{else}}
\DoxyCodeLine{101          res(iq,-\/iq) = matelsq\_qqb}
\DoxyCodeLine{102          res(-\/iq,iq) = matelsq\_qbq}
\DoxyCodeLine{103 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{104 \textcolor{keywordflow}{   enddo}}
\DoxyCodeLine{105 }
\DoxyCodeLine{106    \textcolor{keyword}{call }exitprocess\_ttbh()}
\DoxyCodeLine{107    \textcolor{keywordflow}{RETURN}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a40d35869f3706c38d358332860891b9c}\label{namespacemodttbhiggs_a40d35869f3706c38d358332860891b9c}} 
\index{modttbhiggs@{modttbhiggs}!exitprocess\_ttbh@{exitprocess\_ttbh}}
\index{exitprocess\_ttbh@{exitprocess\_ttbh}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{exitprocess\_ttbh()}{exitprocess\_ttbh()}}
{\footnotesize\ttfamily subroutine, public modttbhiggs\+::exitprocess\+\_\+ttbh}



Definition at line 232 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{232 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{233 \textcolor{keywordtype}{integer} :: NumTrees, iTree}
\DoxyCodeLine{234 }
\DoxyCodeLine{235 }
\DoxyCodeLine{236 \textcolor{comment}{! gg-\/>ttbar+H}}
\DoxyCodeLine{237   numtrees=2}
\DoxyCodeLine{238   \textcolor{keywordflow}{do} itree=1,numtrees}
\DoxyCodeLine{239       \textcolor{comment}{!call UnLinkTreeParticles(TheTreeAmps\_GG\_TTBH(iTree))}}
\DoxyCodeLine{240 }
\DoxyCodeLine{241       \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}( thetreeamps\_gg\_ttbh(itree)\%NumGlu )) \textcolor{keywordflow}{then}}
\DoxyCodeLine{242          \textcolor{keyword}{deallocate}( thetreeamps\_gg\_ttbh(itree)\%NumGlu )}
\DoxyCodeLine{243 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{244       \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}( thetreeamps\_gg\_ttbh(itree)\%PartRef )) \textcolor{keywordflow}{then}}
\DoxyCodeLine{245          \textcolor{keyword}{deallocate}( thetreeamps\_gg\_ttbh(itree)\%PartRef )}
\DoxyCodeLine{246 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{247       \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}( thetreeamps\_gg\_ttbh(itree)\%PartType )) \textcolor{keywordflow}{then}}
\DoxyCodeLine{248          \textcolor{keyword}{deallocate}( thetreeamps\_gg\_ttbh(itree)\%PartType )}
\DoxyCodeLine{249 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{250       \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}( thetreeamps\_gg\_ttbh(itree)\%Quarks )) \textcolor{keywordflow}{then}}
\DoxyCodeLine{251          \textcolor{keyword}{deallocate}( thetreeamps\_gg\_ttbh(itree)\%Quarks )}
\DoxyCodeLine{252 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{253       \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}( thetreeamps\_gg\_ttbh(itree)\%Gluons )) \textcolor{keywordflow}{then}}
\DoxyCodeLine{254          \textcolor{keyword}{deallocate}( thetreeamps\_gg\_ttbh(itree)\%Gluons )}
\DoxyCodeLine{255 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{256       \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}( thetreeamps\_gg\_ttbh(itree)\%Scalars )) \textcolor{keywordflow}{then}}
\DoxyCodeLine{257          \textcolor{keyword}{deallocate}( thetreeamps\_gg\_ttbh(itree)\%Scalars )}
\DoxyCodeLine{258 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{259 \textcolor{keywordflow}{  enddo}}
\DoxyCodeLine{260 }
\DoxyCodeLine{261   numtrees=1}
\DoxyCodeLine{262   \textcolor{keywordflow}{do} itree=1,numtrees}
\DoxyCodeLine{263       \textcolor{comment}{!call UnLinkTreeParticles(TheTreeAmps\_QQB\_TTBH(iTree))}}
\DoxyCodeLine{264 }
\DoxyCodeLine{265       \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}( thetreeamps\_qqb\_ttbh(itree)\%NumGlu )) \textcolor{keywordflow}{then}}
\DoxyCodeLine{266          \textcolor{keyword}{deallocate}( thetreeamps\_qqb\_ttbh(itree)\%NumGlu )}
\DoxyCodeLine{267 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{268       \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}( thetreeamps\_qqb\_ttbh(itree)\%PartRef )) \textcolor{keywordflow}{then}}
\DoxyCodeLine{269          \textcolor{keyword}{deallocate}( thetreeamps\_qqb\_ttbh(itree)\%PartRef )}
\DoxyCodeLine{270 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{271       \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}( thetreeamps\_qqb\_ttbh(itree)\%PartType )) \textcolor{keywordflow}{then}}
\DoxyCodeLine{272          \textcolor{keyword}{deallocate}( thetreeamps\_qqb\_ttbh(itree)\%PartType )}
\DoxyCodeLine{273 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{274       \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}( thetreeamps\_qqb\_ttbh(itree)\%Quarks )) \textcolor{keywordflow}{then}}
\DoxyCodeLine{275          \textcolor{keyword}{deallocate}( thetreeamps\_qqb\_ttbh(itree)\%Quarks )}
\DoxyCodeLine{276 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{277       \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}( thetreeamps\_qqb\_ttbh(itree)\%Gluons )) \textcolor{keywordflow}{then}}
\DoxyCodeLine{278          \textcolor{keyword}{deallocate}( thetreeamps\_qqb\_ttbh(itree)\%Gluons )}
\DoxyCodeLine{279 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{280       \textcolor{keywordflow}{if}(\textcolor{keyword}{allocated}( thetreeamps\_qqb\_ttbh(itree)\%Scalars )) \textcolor{keywordflow}{then}}
\DoxyCodeLine{281          \textcolor{keyword}{deallocate}( thetreeamps\_qqb\_ttbh(itree)\%Scalars )}
\DoxyCodeLine{282 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{283 \textcolor{keywordflow}{  enddo}}
\DoxyCodeLine{284 }
\DoxyCodeLine{285 }
\DoxyCodeLine{286 \textcolor{keywordflow}{RETURN}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_adad982f9354a9487600f7cc5dbc4123c}\label{namespacemodttbhiggs_adad982f9354a9487600f7cc5dbc4123c}} 
\index{modttbhiggs@{modttbhiggs}!f@{f}}
\index{f@{f}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{f()}{f()}}
{\footnotesize\ttfamily recursive complex(8) function, dimension(size(sp)) modttbhiggs\+::f (\begin{DoxyParamCaption}\item[{complex(8), dimension(\+:,\+:), intent(in)}]{e,  }\item[{complex(8), dimension(\+:,\+:), intent(in)}]{k,  }\item[{complex(8), dimension(\+:), intent(in)}]{sp,  }\item[{complex(8), dimension(\+:), intent(in)}]{p,  }\item[{real(8)}]{mass,  }\item[{character, intent(in)}]{flout,  }\item[{character, intent(in)}]{flin,  }\item[{integer, intent(in)}]{ms }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1783 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1783       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1784       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: e(:,:), k(:,:)}
\DoxyCodeLine{1785       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: sp(:), p(:)}
\DoxyCodeLine{1786       \textcolor{keywordtype}{character},  \textcolor{keywordtype}{intent(in)} :: flin*3  \textcolor{comment}{! flavor of off-\/shell f-\/line}}
\DoxyCodeLine{1787       \textcolor{keywordtype}{character},  \textcolor{keywordtype}{intent(in)}  :: flout*3 \textcolor{comment}{! flavor of on-\/shell f-\/line}}
\DoxyCodeLine{1788       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} ::  ms}
\DoxyCodeLine{1789       \textcolor{keywordtype}{integer}             :: ms1,m,ng1, ng2}
\DoxyCodeLine{1790       \textcolor{keywordtype}{integer} :: ngluon}
\DoxyCodeLine{1791       \textcolor{keywordtype}{complex(8)}             :: res(size(sp))}
\DoxyCodeLine{1792       \textcolor{keywordtype}{complex(8)}             :: tmp(size(sp))}
\DoxyCodeLine{1793       \textcolor{keywordtype}{complex(8)}             :: k1(size(p))}
\DoxyCodeLine{1794       \textcolor{keywordtype}{complex(8)}             :: k2(size(p))}
\DoxyCodeLine{1795       \textcolor{keywordtype}{complex(8)}             :: sp2(size(sp))}
\DoxyCodeLine{1796       \textcolor{keywordtype}{complex(8)}             :: sp3(size(sp))}
\DoxyCodeLine{1797       \textcolor{keywordtype}{complex(8)}             :: e1(size(e,dim=1))}
\DoxyCodeLine{1798       \textcolor{keywordtype}{complex(8)}             :: e2(size(e,dim=1))}
\DoxyCodeLine{1799       \textcolor{keywordtype}{complex(8)}  :: k1sq,k2sq,k3sq}
\DoxyCodeLine{1800 \textcolor{keywordtype}{      real}(8) :: mass}
\DoxyCodeLine{1801 }
\DoxyCodeLine{1802       ngluon = \textcolor{keyword}{size}(e,dim=2)}
\DoxyCodeLine{1803       ng1 = ms   \textcolor{comment}{!\#gluons to the left of a f-\/line}}
\DoxyCodeLine{1804       ng2 = ngluon -\/ ms  \textcolor{comment}{!\#gluons to the right of the f-\/line}}
\DoxyCodeLine{1805 }
\DoxyCodeLine{1806       \textcolor{keywordflow}{if} (flout.ne.flin) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1807          res = (0d0,0d0)}
\DoxyCodeLine{1808       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1809 }
\DoxyCodeLine{1810       \textcolor{keywordflow}{if} (ng2 < 0) \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'WRONG DEFINITION OF CURRENT A'}}
\DoxyCodeLine{1811 }
\DoxyCodeLine{1812       \textcolor{keywordflow}{if} (ngluon == 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1813          res = sp}
\DoxyCodeLine{1814 }
\DoxyCodeLine{1815       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1816 }
\DoxyCodeLine{1817        res = (0d0,0d0)}
\DoxyCodeLine{1818        \textcolor{keywordflow}{do} m=0,ng2-\/1}
\DoxyCodeLine{1819            k1 = sum(k(:,ng1+1+m:ngluon),dim=2)}
\DoxyCodeLine{1820            e1=g(e(:,ng1+1+m:ngluon),k(:,ng1+1+m:ngluon))}
\DoxyCodeLine{1821            k1sq=sc\_(k1,k1)}
\DoxyCodeLine{1822 }
\DoxyCodeLine{1823            k2 = sum(k(:,1:ng1+m),dim=2)}
\DoxyCodeLine{1824            k2 = k2 + p}
\DoxyCodeLine{1825            k2sq = sc\_(k2,k2)-\/mass**2}
\DoxyCodeLine{1826            sp2 = f(e(:,1:ng1+m),k(:,1:ng1+m),sp,p,mass,flout,flin,ng1)}
\DoxyCodeLine{1827            \textcolor{keywordflow}{if} (ng1 >0.or.m>0) sp2 = spb2\_(sp2,k2)+mass*sp2}
\DoxyCodeLine{1828            tmp = vqg(sp2,e1)}
\DoxyCodeLine{1829 }
\DoxyCodeLine{1830 \textcolor{comment}{! print *, m,e1}}
\DoxyCodeLine{1831 \textcolor{comment}{! pause}}
\DoxyCodeLine{1832            \textcolor{keywordflow}{if} (m < ng2-\/1)  \textcolor{keywordflow}{then}}
\DoxyCodeLine{1833               \textcolor{keywordflow}{if}(abs(k1sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1834                   tmp = -\/(0d0,1d0)/k1sq*tmp}
\DoxyCodeLine{1835               \textcolor{keywordflow}{else}}
\DoxyCodeLine{1836                   tmp = (0d0,0d0)}
\DoxyCodeLine{1837 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{1838 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{1839 }
\DoxyCodeLine{1840            \textcolor{keywordflow}{if} (ng1>0.or.m>0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1841               \textcolor{keywordflow}{if} (abs(k2sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1842                   tmp =  (0d0,1d0)/k2sq*tmp}
\DoxyCodeLine{1843               \textcolor{keywordflow}{else}}
\DoxyCodeLine{1844                   tmp = (0d0,0d0)}
\DoxyCodeLine{1845 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{1846 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{1847            res = res + tmp}
\DoxyCodeLine{1848 }
\DoxyCodeLine{1849 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{1850 }
\DoxyCodeLine{1851         \textcolor{keywordflow}{do} m=1,ng1}
\DoxyCodeLine{1852 }
\DoxyCodeLine{1853            k1 = sum(k(:,1:m),dim=2)}
\DoxyCodeLine{1854            e1=g(e(:,1:m),k(:,1:m))}
\DoxyCodeLine{1855            k1sq = sc\_(k1,k1)}
\DoxyCodeLine{1856 }
\DoxyCodeLine{1857            k2 = sum(k(:,m+1:ngluon),dim=2)}
\DoxyCodeLine{1858            k2 = k2 + p}
\DoxyCodeLine{1859            k2sq = sc\_(k2,k2) -\/ mass**2}
\DoxyCodeLine{1860            ms1 = ng1 -\/ m}
\DoxyCodeLine{1861            sp2=f(e(:,m+1:ngluon),k(:,m+1:ngluon),sp,p,mass,flout,flin,ms1\textcolor{comment}{)}}
\DoxyCodeLine{1862 \textcolor{comment}{}}
\DoxyCodeLine{1863            \textcolor{keywordflow}{if} (ng2 > 0.or.m < ng1) sp2 = spb2\_(sp2,k2)+mass*sp2}
\DoxyCodeLine{1864            tmp = vgq(e1,sp2)}
\DoxyCodeLine{1865            \textcolor{keywordflow}{if} (m > 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1866               \textcolor{keywordflow}{if} (abs(k1sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1867                   tmp=-\/(0d0,1d0)/k1sq*tmp}
\DoxyCodeLine{1868               \textcolor{keywordflow}{else}}
\DoxyCodeLine{1869                   tmp = (0d0,0d0)}
\DoxyCodeLine{1870 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{1871 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{1872 }
\DoxyCodeLine{1873            \textcolor{keywordflow}{if} (ng2 > 0.or. m < ng1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1874             \textcolor{keywordflow}{if} (abs(k2sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1875               tmp=(0d0,1d0)/k2sq*tmp}
\DoxyCodeLine{1876             \textcolor{keywordflow}{else}}
\DoxyCodeLine{1877               tmp = (0d0,0d0)}
\DoxyCodeLine{1878 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{1879 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{1880 }
\DoxyCodeLine{1881            res = res + tmp}
\DoxyCodeLine{1882 \textcolor{keywordflow}{           enddo}}
\DoxyCodeLine{1883 }
\DoxyCodeLine{1884 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{1885 \textcolor{keywordflow}{         endif} \textcolor{comment}{! endif for flavor consistency condition}}
\DoxyCodeLine{1886 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_aaa7b206d44682122266c543abc74fd1f}\label{namespacemodttbhiggs_aaa7b206d44682122266c543abc74fd1f}} 
\index{modttbhiggs@{modttbhiggs}!fourvecdot@{fourvecdot}}
\index{fourvecdot@{fourvecdot}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{fourvecdot()}{fourvecdot()}}
{\footnotesize\ttfamily complex(8) function modttbhiggs\+::fourvecdot (\begin{DoxyParamCaption}\item[{complex(8), dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}), intent(in)}]{p1,  }\item[{complex(8), dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}), intent(in)}]{p2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5009 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5009 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5010 \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: p1(1:Dv),p2(1:Dv)}
\DoxyCodeLine{5011 \textcolor{keywordtype}{complex(8)}  :: FourVecDot}
\DoxyCodeLine{5012 \textcolor{keywordtype}{integer} :: mu}
\DoxyCodeLine{5013 }
\DoxyCodeLine{5014    fourvecdot = p1(1)*p2(1)}
\DoxyCodeLine{5015 \textcolor{comment}{!DEC\$ UNROLL}}
\DoxyCodeLine{5016    \textcolor{keywordflow}{do} mu=2,dv}
\DoxyCodeLine{5017       fourvecdot = fourvecdot -\/ p1(mu)*p2(mu)}
\DoxyCodeLine{5018 \textcolor{keywordflow}{   enddo}}
\DoxyCodeLine{5019 \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a34ef86c930ffb557abd146d64486e7ae}\label{namespacemodttbhiggs_a34ef86c930ffb557abd146d64486e7ae}} 
\index{modttbhiggs@{modttbhiggs}!fv@{fv}}
\index{fv@{fv}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{fv()}{fv()}}
{\footnotesize\ttfamily recursive complex(8) function, dimension(size(sp)) modttbhiggs\+::fv (\begin{DoxyParamCaption}\item[{complex(8), dimension(\+:,\+:), intent(in)}]{e,  }\item[{complex(8), dimension(\+:,\+:), intent(in)}]{k,  }\item[{complex(8), dimension(\+:), intent(in)}]{sp,  }\item[{complex(8), dimension(\+:), intent(in)}]{p,  }\item[{real(8)}]{mass,  }\item[{integer, intent(in)}]{Quark\+Flavor,  }\item[{complex(8), dimension(\+:), intent(in)}]{eV,  }\item[{complex(8), dimension(\+:), intent(in)}]{kV,  }\item[{integer, intent(in)}]{ms }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 687 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{687       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{688       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: e(:,:), k(:,:)}
\DoxyCodeLine{689       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: sp(:), p(:)}
\DoxyCodeLine{690       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: eV(:), kV(:)}
\DoxyCodeLine{691       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} ::  ms,QuarkFlavor}
\DoxyCodeLine{692       \textcolor{keywordtype}{integer}             :: ms1,m,ng1, ng2}
\DoxyCodeLine{693       \textcolor{keywordtype}{integer} :: ngluon}
\DoxyCodeLine{694       \textcolor{keywordtype}{complex(8)}             :: res(size(sp))}
\DoxyCodeLine{695       \textcolor{keywordtype}{complex(8)}             :: tmp(size(sp))}
\DoxyCodeLine{696       \textcolor{keywordtype}{complex(8)}             :: k1(size(p))}
\DoxyCodeLine{697       \textcolor{keywordtype}{complex(8)}             :: k2(size(p))}
\DoxyCodeLine{698       \textcolor{keywordtype}{complex(8)}             :: sp2(size(sp))}
\DoxyCodeLine{699       \textcolor{keywordtype}{complex(8)}             :: sp3(size(sp))}
\DoxyCodeLine{700       \textcolor{keywordtype}{complex(8)}             :: e1(size(e,dim=1))}
\DoxyCodeLine{701       \textcolor{keywordtype}{complex(8)}             :: e2(size(e,dim=1))}
\DoxyCodeLine{702       \textcolor{keywordtype}{complex(8)}  :: k1sq,k2sq,k3sq}
\DoxyCodeLine{703 \textcolor{keywordtype}{      real}(8) :: mass}
\DoxyCodeLine{704       \textcolor{keywordtype}{complex(8)} :: couplVQQ\_left,couplVQQ\_right,couplVQQ\_left2,couplVQQ\_right2}
\DoxyCodeLine{705       \textcolor{keywordtype}{character},\textcolor{keywordtype}{parameter} :: FerFla*3=\textcolor{stringliteral}{"dum"} \textcolor{comment}{! dummy, only used for check of flavor consistency inside the functions f,bf}}
\DoxyCodeLine{706 }
\DoxyCodeLine{707 }
\DoxyCodeLine{708       ngluon = \textcolor{keyword}{size}(e,dim=2)}
\DoxyCodeLine{709       ng1 = ms   \textcolor{comment}{!\#gluons to the left of a f-\/line}}
\DoxyCodeLine{710       ng2 = ngluon -\/ ms  \textcolor{comment}{!\#gluons to the right of the f-\/line}}
\DoxyCodeLine{711       \textcolor{keywordflow}{if} (ng2 < 0) \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'WRONG DEFINITION OF CURRENT fV'}}
\DoxyCodeLine{712 }
\DoxyCodeLine{713       \textcolor{keywordflow}{if}( abs(quarkflavor).eq.top\_ .or. abs(quarkflavor).eq.bot\_ ) then\textcolor{comment}{!   note that Bot\_ is treated as top quark in TOPAZ!}}
\DoxyCodeLine{714          couplvqq\_left  = couplhtt\_left\_dyn}
\DoxyCodeLine{715          couplvqq\_right = couplhtt\_right\_dyn}
\DoxyCodeLine{716       \textcolor{keywordflow}{else}}
\DoxyCodeLine{717          couplvqq\_left=0d0}
\DoxyCodeLine{718          couplvqq\_right=0d0}
\DoxyCodeLine{719          print *, \textcolor{stringliteral}{"this should not happen for the Higgs"},quarkflavor,top\_}
\DoxyCodeLine{720 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{721 }
\DoxyCodeLine{722 }
\DoxyCodeLine{723 }
\DoxyCodeLine{724 \textcolor{keywordflow}{if} (ngluon == 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{725          res = vbqv(sp,ev,couplvqq\_left,couplvqq\_right)}
\DoxyCodeLine{726 \textcolor{keywordflow}{else}}
\DoxyCodeLine{727 }
\DoxyCodeLine{728        res = (0d0,0d0)}
\DoxyCodeLine{729        \textcolor{keywordflow}{do} m=0,ng2-\/1}
\DoxyCodeLine{730            k1 = sum(k(:,ng1+1+m:ngluon),dim=2)}
\DoxyCodeLine{731            e1=g(e(:,ng1+1+m:ngluon),k(:,ng1+1+m:ngluon))}
\DoxyCodeLine{732            k1sq=sc\_(k1,k1)}
\DoxyCodeLine{733 }
\DoxyCodeLine{734            k2 = sum(k(:,1:ng1+m),dim=2)}
\DoxyCodeLine{735            k2 = k2 + p + kv}
\DoxyCodeLine{736            k2sq = sc\_(k2,k2)-\/mass**2}
\DoxyCodeLine{737            sp2 = fv(e(:,1:ng1+m),k(:,1:ng1+m),sp,p,mass,quarkflavor,ev,kv\textcolor{comment}{,ng1)}}
\DoxyCodeLine{738 \textcolor{comment}{}           sp2 = spb2\_(sp2,k2)+mass*sp2}
\DoxyCodeLine{739 }
\DoxyCodeLine{740            tmp = vqg(sp2,e1)}
\DoxyCodeLine{741            \textcolor{keywordflow}{if} (m < ng2-\/1)  \textcolor{keywordflow}{then}}
\DoxyCodeLine{742               \textcolor{keywordflow}{if}(abs(k1sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{743                   tmp = -\/(0d0,1d0)/k1sq*tmp}
\DoxyCodeLine{744               \textcolor{keywordflow}{else}}
\DoxyCodeLine{745                   tmp = (0d0,0d0)}
\DoxyCodeLine{746 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{747 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{748 }
\DoxyCodeLine{749            \textcolor{keywordflow}{if} (abs(k2sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{750                   tmp =  (0d0,1d0)/k2sq*tmp}
\DoxyCodeLine{751            \textcolor{keywordflow}{else}}
\DoxyCodeLine{752                   tmp = (0d0,0d0)}
\DoxyCodeLine{753 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{754            res = res + tmp}
\DoxyCodeLine{755 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{756 }
\DoxyCodeLine{757 }
\DoxyCodeLine{758 }
\DoxyCodeLine{759 }
\DoxyCodeLine{760         \textcolor{keywordflow}{do} m=1,ng1}
\DoxyCodeLine{761            k1 = sum(k(:,1:m),dim=2)}
\DoxyCodeLine{762            e1=g(e(:,1:m),k(:,1:m))}
\DoxyCodeLine{763            k1sq = sc\_(k1,k1)}
\DoxyCodeLine{764 }
\DoxyCodeLine{765            k2 = sum(k(:,m+1:ngluon),dim=2)}
\DoxyCodeLine{766            k2 = k2 + p + kv}
\DoxyCodeLine{767            k2sq = sc\_(k2,k2) -\/ mass**2}
\DoxyCodeLine{768            ms1 = ng1 -\/ m}
\DoxyCodeLine{769            sp2=fv(e(:,m+1:ngluon),k(:,m+1:ngluon),sp,p,mass,quarkflavor,ev\textcolor{comment}{,kv,ms1)}}
\DoxyCodeLine{770 \textcolor{comment}{}}
\DoxyCodeLine{771            sp2 = spb2\_(sp2,k2)+mass*sp2}
\DoxyCodeLine{772 }
\DoxyCodeLine{773            tmp = vgq(e1,sp2)}
\DoxyCodeLine{774            \textcolor{keywordflow}{if} (m > 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{775               \textcolor{keywordflow}{if} (abs(k1sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{776                   tmp=-\/(0d0,1d0)/k1sq*tmp}
\DoxyCodeLine{777               \textcolor{keywordflow}{else}}
\DoxyCodeLine{778                   tmp = (0d0,0d0)}
\DoxyCodeLine{779 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{780 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{781 }
\DoxyCodeLine{782            \textcolor{keywordflow}{if} (abs(k2sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{783               tmp=(0d0,1d0)/k2sq*tmp}
\DoxyCodeLine{784            \textcolor{keywordflow}{else}}
\DoxyCodeLine{785               tmp = (0d0,0d0)}
\DoxyCodeLine{786 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{787 }
\DoxyCodeLine{788            res = res + tmp}
\DoxyCodeLine{789 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{790 }
\DoxyCodeLine{791 }
\DoxyCodeLine{792         sp2 = f(e,k,sp,p,mass,ferfla,ferfla,ms)}
\DoxyCodeLine{793         k2 = sum(k(:,1:ngluon),dim=2)}
\DoxyCodeLine{794         k2 = k2 + p}
\DoxyCodeLine{795         k2sq = sc\_(k2,k2)  -\/ mass**2}
\DoxyCodeLine{796 }
\DoxyCodeLine{797         sp2 = spb2\_(sp2,k2)+ mass*sp2}
\DoxyCodeLine{798 }
\DoxyCodeLine{799         tmp = vbqv(sp2,ev,couplvqq\_left,couplvqq\_right)}
\DoxyCodeLine{800         \textcolor{keywordflow}{if} (abs(k2sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{801                tmp = (0d0,1d0)/k2sq*tmp}
\DoxyCodeLine{802         \textcolor{keywordflow}{else}}
\DoxyCodeLine{803                 tmp = (0d0,0d0)}
\DoxyCodeLine{804 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{805         res = res + tmp}
\DoxyCodeLine{806 }
\DoxyCodeLine{807 \textcolor{keywordflow}{endif}}
\DoxyCodeLine{808 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a235b60cc7641638d472db6f260b76d34}\label{namespacemodttbhiggs_a235b60cc7641638d472db6f260b76d34}} 
\index{modttbhiggs@{modttbhiggs}!g@{g}}
\index{g@{g}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{g()}{g()}}
{\footnotesize\ttfamily recursive complex(8) function, dimension(size(e,dim=1)) modttbhiggs\+::g (\begin{DoxyParamCaption}\item[{complex(8), dimension(\+:,\+:), intent(in)}]{e,  }\item[{complex(8), dimension(\+:,\+:), intent(in)}]{k }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1605 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1605       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1606       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: e(:,:),k(:,:)}
\DoxyCodeLine{1607       \textcolor{keywordtype}{complex(8)}             :: e1(size(e,dim=1))}
\DoxyCodeLine{1608       \textcolor{keywordtype}{complex(8)}             :: res(size(e,dim=1))}
\DoxyCodeLine{1609       \textcolor{keywordtype}{complex(8)} :: k1(size(e,dim=1))}
\DoxyCodeLine{1610       \textcolor{keywordtype}{complex(8)} :: k2(size(e,dim=1))}
\DoxyCodeLine{1611       \textcolor{keywordtype}{complex(8)} :: k3(size(e,dim=1))}
\DoxyCodeLine{1612       \textcolor{keywordtype}{complex(8)} :: e2(size(e,dim=1))}
\DoxyCodeLine{1613       \textcolor{keywordtype}{complex(8)} :: e3(size(e,dim=1))}
\DoxyCodeLine{1614       \textcolor{keywordtype}{complex(8)} :: tmp(size(e,dim=1))}
\DoxyCodeLine{1615       \textcolor{keywordtype}{complex(8)} :: k1sq, k2sq, k3sq}
\DoxyCodeLine{1616       \textcolor{keywordtype}{integer} :: npart, m, m1}
\DoxyCodeLine{1617 }
\DoxyCodeLine{1618       npart = \textcolor{keyword}{size}(e,dim=2)}
\DoxyCodeLine{1619 }
\DoxyCodeLine{1620       \textcolor{keywordflow}{if} (npart == 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1621          res = e(:,1)}
\DoxyCodeLine{1622 }
\DoxyCodeLine{1623       \textcolor{keywordflow}{elseif} (npart == 2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1624          res = vggg(e(:,1),k(:,1),e(:,2),k(:,2))}
\DoxyCodeLine{1625         \textcolor{keywordflow}{else}}
\DoxyCodeLine{1626 }
\DoxyCodeLine{1627            res = (0d0,0d0)}
\DoxyCodeLine{1628 }
\DoxyCodeLine{1629            \textcolor{keywordflow}{do} m=1,npart-\/1}
\DoxyCodeLine{1630               k1=sum(k(:,1:m),dim=2)}
\DoxyCodeLine{1631               k2=sum(k(:,m+1:npart),dim=2)}
\DoxyCodeLine{1632 }
\DoxyCodeLine{1633               e1 = g(e(:,1:m),k(:,1:m))}
\DoxyCodeLine{1634               e2 = g(e(:,m+1:npart),k(:,m+1:npart))}
\DoxyCodeLine{1635 }
\DoxyCodeLine{1636               tmp = vggg(e1,k1,e2,k2)}
\DoxyCodeLine{1637 }
\DoxyCodeLine{1638               \textcolor{keywordflow}{if} (m > 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1639               k1sq = sc\_(k1,k1)}
\DoxyCodeLine{1640                \textcolor{keywordflow}{if} (abs(k1sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1641               tmp = -\/(0d0,1d0)*tmp/k1sq}
\DoxyCodeLine{1642                \textcolor{keywordflow}{else}}
\DoxyCodeLine{1643                   tmp = (0d0,0d0)}
\DoxyCodeLine{1644 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{1645 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{1646 }
\DoxyCodeLine{1647               \textcolor{keywordflow}{if} (m + 1 < npart) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1648               k2sq = sc\_(k2,k2)}
\DoxyCodeLine{1649                 \textcolor{keywordflow}{if} (abs(k2sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1650               tmp = -\/(0d0,1d0)*tmp/k2sq}
\DoxyCodeLine{1651                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{1652               tmp = (0d0,0d0)}
\DoxyCodeLine{1653 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{1654 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{1655 }
\DoxyCodeLine{1656               res = res + tmp}
\DoxyCodeLine{1657 }
\DoxyCodeLine{1658       \textcolor{keywordflow}{if} (m <= npart-\/2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1659 }
\DoxyCodeLine{1660         \textcolor{keywordflow}{do} m1=m+1,npart-\/1}
\DoxyCodeLine{1661 \textcolor{comment}{!        e1 = g(e(:,1:m),k(:,1:m))  ! e1 is already computed}}
\DoxyCodeLine{1662         e2=g(e(:,m+1:m1),k(:,m+1:m1))}
\DoxyCodeLine{1663         e3=g(e(:,m1+1:npart),k(:,m1+1:npart))}
\DoxyCodeLine{1664         k2 = sum(k(:,m+1:m1),dim=2)}
\DoxyCodeLine{1665         k3 = sum(k(:,m1+1:npart),dim=2)}
\DoxyCodeLine{1666         tmp = vgggg(e1,e2,e3)}
\DoxyCodeLine{1667         \textcolor{keywordflow}{if} (m > 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1668         k1sq = sc\_(k1,k1)}
\DoxyCodeLine{1669           \textcolor{keywordflow}{if}(abs(k1sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1670         tmp = -\/(0d0,1d0)*tmp/k1sq}
\DoxyCodeLine{1671          \textcolor{keywordflow}{else}}
\DoxyCodeLine{1672             tmp = (0d0,0d0)}
\DoxyCodeLine{1673 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{1674 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{1675         \textcolor{keywordflow}{if} (m+1 < m1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1676          k2sq = sc\_(k2,k2)}
\DoxyCodeLine{1677            \textcolor{keywordflow}{if}(abs(k2sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1678            tmp = -\/(0d0,1d0)*tmp/k2sq}
\DoxyCodeLine{1679            \textcolor{keywordflow}{else}}
\DoxyCodeLine{1680             tmp = (0d0,0d0)}
\DoxyCodeLine{1681 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{1682 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{1683         \textcolor{keywordflow}{if} (m1+1 < npart) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1684            k3sq = sc\_(k3,k3)}
\DoxyCodeLine{1685            \textcolor{keywordflow}{if}(abs(k3sq) > propcut) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1686            tmp = -\/(0d0,1d0)*tmp/k3sq}
\DoxyCodeLine{1687            \textcolor{keywordflow}{else}}
\DoxyCodeLine{1688            tmp = (0d0,0d0)}
\DoxyCodeLine{1689 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{1690 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{1691         res = res + tmp}
\DoxyCodeLine{1692 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{1693 }
\DoxyCodeLine{1694 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{1695 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{1696 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{1697 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a691b8daf9b0359f845579cedad904110}\label{namespacemodttbhiggs_a691b8daf9b0359f845579cedad904110}} 
\index{modttbhiggs@{modttbhiggs}!ichir@{ichir}}
\index{ichir@{ichir}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{ichir()}{ichir()}}
{\footnotesize\ttfamily recursive double complex function, dimension(size(sp)) modttbhiggs\+::ichir (\begin{DoxyParamCaption}\item[{logical}]{sign,  }\item[{double complex, dimension(\+:)}]{sp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5433 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5433 \textcolor{comment}{! RR -\/-\/ this function is needed for the electric and dipole moment like couplings,}}
\DoxyCodeLine{5434 \textcolor{comment}{!!      which have a 1 +\(\backslash\)-\/ i*gamma5 (see 0811.3842)}}
\DoxyCodeLine{5435                \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5436                \textcolor{keywordtype}{logical} :: sign}
\DoxyCodeLine{5437                \textcolor{keywordtype}{double complex} :: sp(:)}
\DoxyCodeLine{5438                \textcolor{keywordtype}{double complex} :: res(size(sp))}
\DoxyCodeLine{5439                \textcolor{keywordtype}{double complex} :: ci}
\DoxyCodeLine{5440                \textcolor{keywordtype}{integer}        :: D}
\DoxyCodeLine{5441 }
\DoxyCodeLine{5442                ci=(0d0,1d0)}
\DoxyCodeLine{5443                d = \textcolor{keyword}{size}(sp)}
\DoxyCodeLine{5444                \textcolor{keywordflow}{if} ( d .eq. 4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5445                   \textcolor{keywordflow}{if}(sign) \textcolor{keywordflow}{then} \textcolor{comment}{!omega\_+}}
\DoxyCodeLine{5446                      res(1) = 0.5d0*(sp(1)+ci*sp(3))}
\DoxyCodeLine{5447                      res(2) = 0.5d0*(sp(2)+ci*sp(4))}
\DoxyCodeLine{5448                      res(3) = 0.5d0*(ci*sp(1)+sp(3))}
\DoxyCodeLine{5449                      res(4) = 0.5d0*(ci*sp(2)+sp(4))}
\DoxyCodeLine{5450                   \textcolor{keywordflow}{else} \textcolor{comment}{!omega\_-\/}}
\DoxyCodeLine{5451                      res(1) = 0.5d0*(sp(1)-\/ci*sp(3))}
\DoxyCodeLine{5452                      res(2) = 0.5d0*(sp(2)-\/ci*sp(4))}
\DoxyCodeLine{5453                      res(3) = 0.5d0*(-\/ci*sp(1)+sp(3))}
\DoxyCodeLine{5454                      res(4) = 0.5d0*(-\/ci*sp(2)+sp(4))}
\DoxyCodeLine{5455 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{5456                \textcolor{keywordflow}{else}}
\DoxyCodeLine{5457                   res(1:d/2)     =  ichir(sign,sp(1:d/2))}
\DoxyCodeLine{5458                   res((d/2+1):d) =  ichir(sign,sp( (d/2+1):d ))}
\DoxyCodeLine{5459 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{5460 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a5c94ac5f8e9e04d9c6b3950545a44d48}\label{namespacemodttbhiggs_a5c94ac5f8e9e04d9c6b3950545a44d48}} 
\index{modttbhiggs@{modttbhiggs}!initprocess\_ttbh@{initprocess\_ttbh}}
\index{initprocess\_ttbh@{initprocess\_ttbh}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{initprocess\_ttbh()}{initprocess\_ttbh()}}
{\footnotesize\ttfamily subroutine, public modttbhiggs\+::initprocess\+\_\+ttbh}



Definition at line 132 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{132 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{133 \textcolor{keywordtype}{integer} :: NumQuarks,NumGluons,NumBoson}
\DoxyCodeLine{134 \textcolor{keywordtype}{integer} :: NumTrees}
\DoxyCodeLine{135 \textcolor{keywordtype}{integer} :: iTree,NumParticles}
\DoxyCodeLine{136 }
\DoxyCodeLine{137 }
\DoxyCodeLine{138 \textcolor{comment}{! gg-\/>ttbar+H}}
\DoxyCodeLine{139   numquarks=2; numgluons=2; numboson=1;}
\DoxyCodeLine{140   numparticles=numquarks+numgluons+numboson}
\DoxyCodeLine{141   numtrees=2}
\DoxyCodeLine{142   \textcolor{keywordflow}{do} itree=1,numtrees}
\DoxyCodeLine{143       thetreeamps\_gg\_ttbh(itree)\%NumPart=numparticles}
\DoxyCodeLine{144       thetreeamps\_gg\_ttbh(itree)\%NumQua=numquarks}
\DoxyCodeLine{145       \textcolor{keyword}{allocate}( thetreeamps\_gg\_ttbh(itree)\%NumGlu(0:numquarks+1) )}
\DoxyCodeLine{146       \textcolor{keyword}{allocate}( thetreeamps\_gg\_ttbh(itree)\%PartRef(1:numparticles) )}
\DoxyCodeLine{147       \textcolor{keyword}{allocate}( thetreeamps\_gg\_ttbh(itree)\%PartType(1:numparticles) )}
\DoxyCodeLine{148       \textcolor{keyword}{allocate}( thetreeamps\_gg\_ttbh(itree)\%Quarks(1:numquarks) )}
\DoxyCodeLine{149       \textcolor{keyword}{allocate}( thetreeamps\_gg\_ttbh(itree)\%Gluons(1:numgluons) )}
\DoxyCodeLine{150       thetreeamps\_gg\_ttbh(itree)\%NumGlu(0) = numgluons}
\DoxyCodeLine{151       thetreeamps\_gg\_ttbh(itree)\%NumSca = 0}
\DoxyCodeLine{152 \textcolor{keywordflow}{  enddo}}
\DoxyCodeLine{153 }
\DoxyCodeLine{154 \textcolor{comment}{! qqbar-\/>ttbar+H}}
\DoxyCodeLine{155   numquarks=4; numgluons=0; numboson=1;}
\DoxyCodeLine{156   numparticles=numquarks+numgluons+numboson}
\DoxyCodeLine{157   numtrees=1}
\DoxyCodeLine{158   \textcolor{keywordflow}{do} itree=1,numtrees}
\DoxyCodeLine{159       thetreeamps\_qqb\_ttbh(itree)\%NumPart=numparticles}
\DoxyCodeLine{160       thetreeamps\_qqb\_ttbh(itree)\%NumQua=numquarks}
\DoxyCodeLine{161       \textcolor{keyword}{allocate}( thetreeamps\_qqb\_ttbh(itree)\%NumGlu(0:numquarks+1) )}
\DoxyCodeLine{162       \textcolor{keyword}{allocate}( thetreeamps\_qqb\_ttbh(itree)\%PartRef(1:numparticles) )}
\DoxyCodeLine{163       \textcolor{keyword}{allocate}( thetreeamps\_qqb\_ttbh(itree)\%PartType(1:numparticles) )}
\DoxyCodeLine{164       \textcolor{keyword}{allocate}( thetreeamps\_qqb\_ttbh(itree)\%Quarks(1:numquarks) )}
\DoxyCodeLine{165       \textcolor{keyword}{allocate}( thetreeamps\_qqb\_ttbh(itree)\%Gluons(1:numgluons) )}
\DoxyCodeLine{166       thetreeamps\_qqb\_ttbh(itree)\%NumGlu(0) = numgluons}
\DoxyCodeLine{167       thetreeamps\_qqb\_ttbh(itree)\%NumSca = 0}
\DoxyCodeLine{168 \textcolor{keywordflow}{  enddo}}
\DoxyCodeLine{169 }
\DoxyCodeLine{170   extparticles(1)\%PartType = atop\_}
\DoxyCodeLine{171   extparticles(1)\%ExtRef   = 1}
\DoxyCodeLine{172   extparticles(1)\%Mass = m\_top}
\DoxyCodeLine{173   extparticles(1)\%Mass2= extparticles(1)\%Mass**2}
\DoxyCodeLine{174   extparticles(1)\%Helicity = 0}
\DoxyCodeLine{175 }
\DoxyCodeLine{176   extparticles(2)\%PartType = top\_}
\DoxyCodeLine{177   extparticles(2)\%ExtRef   = 2}
\DoxyCodeLine{178   extparticles(2)\%Mass = m\_top}
\DoxyCodeLine{179   extparticles(2)\%Mass2= extparticles(2)\%Mass**2}
\DoxyCodeLine{180   extparticles(2)\%Helicity = 0}
\DoxyCodeLine{181 }
\DoxyCodeLine{182   extparticles(3)\%PartType = glu\_}
\DoxyCodeLine{183   extparticles(3)\%ExtRef   = 3}
\DoxyCodeLine{184   extparticles(3)\%Mass = 0d0}
\DoxyCodeLine{185   extparticles(3)\%Mass2= 0d0}
\DoxyCodeLine{186   extparticles(3)\%Helicity = 0}
\DoxyCodeLine{187 }
\DoxyCodeLine{188   extparticles(4)\%PartType = glu\_}
\DoxyCodeLine{189   extparticles(4)\%ExtRef   = 4}
\DoxyCodeLine{190   extparticles(4)\%Mass = 0d0}
\DoxyCodeLine{191   extparticles(4)\%Mass2= 0d0}
\DoxyCodeLine{192   extparticles(4)\%Helicity = 0}
\DoxyCodeLine{193 }
\DoxyCodeLine{194   extparticles(5)\%PartType = astr\_}
\DoxyCodeLine{195   extparticles(5)\%ExtRef   = 5}
\DoxyCodeLine{196   extparticles(5)\%Mass = 0d0}
\DoxyCodeLine{197   extparticles(5)\%Mass2= 0d0}
\DoxyCodeLine{198   extparticles(5)\%Helicity = 0}
\DoxyCodeLine{199 }
\DoxyCodeLine{200   extparticles(6)\%PartType = str\_}
\DoxyCodeLine{201   extparticles(6)\%ExtRef   = 6}
\DoxyCodeLine{202   extparticles(6)\%Mass = 0d0}
\DoxyCodeLine{203   extparticles(6)\%Mass2= 0d0}
\DoxyCodeLine{204   extparticles(6)\%Helicity = 0}
\DoxyCodeLine{205 }
\DoxyCodeLine{206   extparticles(7)\%PartType = hig\_}
\DoxyCodeLine{207   extparticles(7)\%ExtRef   = 7}
\DoxyCodeLine{208   extparticles(7)\%Mass = m\_reso}
\DoxyCodeLine{209   extparticles(7)\%Mass2= extparticles(5)\%Mass**2}
\DoxyCodeLine{210   extparticles(7)\%Helicity = 0}
\DoxyCodeLine{211 }
\DoxyCodeLine{212 }
\DoxyCodeLine{213   thetreeamps\_gg\_ttbh(1)\%PartRef(1:5) = (/3,4,1,7,2/)\textcolor{comment}{! (/1,7,2,3,4/)}}
\DoxyCodeLine{214   thetreeamps\_gg\_ttbh(2)\%PartRef(1:5) = (/3,1,7,2,4/)\textcolor{comment}{! (/1,7,2,4,3/)}}
\DoxyCodeLine{215   \textcolor{keywordflow}{do} itree=1,2}
\DoxyCodeLine{216       \textcolor{keyword}{call }linktreeparticles(thetreeamps\_gg\_ttbh(itree),extparticles(1:7))}
\DoxyCodeLine{217 \textcolor{keywordflow}{  enddo}}
\DoxyCodeLine{218 }
\DoxyCodeLine{219   thetreeamps\_qqb\_ttbh(1)\%PartRef(1:5) = (/5,6,1,7,2/)\textcolor{comment}{! (/1,7,2,5,6/)}}
\DoxyCodeLine{220   \textcolor{keyword}{call }linktreeparticles(thetreeamps\_qqb\_ttbh(1),extparticles(1:7))}
\DoxyCodeLine{221 }
\DoxyCodeLine{222 }
\DoxyCodeLine{223   couplhtt\_right\_dyn = m\_top/vev/2d0 * ( kappa + (0d0,1d0)*kappa\_tilde )}
\DoxyCodeLine{224   couplhtt\_left\_dyn  = m\_top/vev/2d0 * ( kappa -\/ (0d0,1d0)*kappa\_tilde )}
\DoxyCodeLine{225 }
\DoxyCodeLine{226 }
\DoxyCodeLine{227 \textcolor{keywordflow}{RETURN}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a16ddc269abb6f66df5607491a89ecc65}\label{namespacemodttbhiggs_a16ddc269abb6f66df5607491a89ecc65}} 
\index{modttbhiggs@{modttbhiggs}!linear\_map@{linear\_map}}
\index{linear\_map@{linear\_map}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{linear\_map()}{linear\_map()}}
{\footnotesize\ttfamily integer function modttbhiggs\+::linear\+\_\+map (\begin{DoxyParamCaption}\item[{integer}]{i1,  }\item[{integer}]{i2,  }\item[{integer}]{Ngluons }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5051 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5051 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5052 \textcolor{keywordtype}{integer} :: linear\_map,i1,i2,Ngluons}
\DoxyCodeLine{5053 }
\DoxyCodeLine{5054    linear\_map = i2+ngluons*(i2-\/i1)-\/((i2-\/i1)*(i2-\/i1+1))/2}
\DoxyCodeLine{5055 \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a593e2b56b0306035b7527938b164e4ee}\label{namespacemodttbhiggs_a593e2b56b0306035b7527938b164e4ee}} 
\index{modttbhiggs@{modttbhiggs}!linktreeparticles@{linktreeparticles}}
\index{linktreeparticles@{linktreeparticles}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{linktreeparticles()}{linktreeparticles()}}
{\footnotesize\ttfamily subroutine modttbhiggs\+::linktreeparticles (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1treeprocess}{treeprocess}})}]{The\+Tree\+Amp,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1particle}{particle}}), dimension(\+:), target}]{The\+Particles }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 472 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{472 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{473 \textcolor{keywordtype}{type}(TreeProcess) :: TheTreeAmp}
\DoxyCodeLine{474 \textcolor{keywordtype}{type}(Particle),\textcolor{keywordtype}{target} :: TheParticles(:)}
\DoxyCodeLine{475 \textcolor{keywordtype}{integer} :: iPart,PartRef,PartType,ig,iq,ib,NPart,counterQ,counterG,LastQuark,QuarkPos(1:6)}
\DoxyCodeLine{476 }
\DoxyCodeLine{477 }
\DoxyCodeLine{478             thetreeamp\%NumW = 0}
\DoxyCodeLine{479             thetreeamp\%NumV = 0}
\DoxyCodeLine{480             counterq = 0}
\DoxyCodeLine{481             counterg = 0}
\DoxyCodeLine{482 }
\DoxyCodeLine{483             \textcolor{keywordflow}{do} npart=1,thetreeamp\%NumPart}
\DoxyCodeLine{484                   thetreeamp\%PartType(npart) = theparticles( thetreeamp\%PartRef(npart) )\%PartType}
\DoxyCodeLine{485                   \textcolor{keywordflow}{if}( isaquark(thetreeamp\%PartType(npart)) ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{486                      \textcolor{comment}{!TheTreeAmp\%NumQua = TheTreeAmp\%NumQua + 1   ! this is suppoed to be done outside this subroutine}}
\DoxyCodeLine{487                      counterq = counterq + 1}
\DoxyCodeLine{488                      quarkpos(counterq) = counterq + counterg}
\DoxyCodeLine{489                      lastquark = counterq\textcolor{comment}{! only required for BosonVertex below}}
\DoxyCodeLine{490 \textcolor{comment}{!                   elseif( IsAScalar(TheTreeAmp\%PartType(NPart)) ) then}}
\DoxyCodeLine{491 \textcolor{comment}{! !                      TheTreeAmp\%NumSca = TheTreeAmp\%NumSca + 1   ! this is suppoed to be done outside this subroutine}}
\DoxyCodeLine{492 \textcolor{comment}{!                      counterQ = counterQ + 1!     treat the scalar like a quark here because this is only to determine NumGlu}}
\DoxyCodeLine{493 \textcolor{comment}{!                      QuarkPos(counterQ) = counterQ + counterG}}
\DoxyCodeLine{494                   \textcolor{keywordflow}{elseif}( thetreeamp\%PartType(npart).eq.glu\_ ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{495                      counterg = counterg + 1}
\DoxyCodeLine{496                   \textcolor{keywordflow}{elseif}( isaboson(thetreeamp\%PartType(npart)) ) then\textcolor{comment}{! careful: bosons should only be places *between* same flavor quark lines}}
\DoxyCodeLine{497                      \textcolor{keywordflow}{if}( npart.eq.1 ) print *, \textcolor{stringliteral}{"Vector boson should not be the first particle."}}
\DoxyCodeLine{498                      \textcolor{keywordflow}{if}( abs(thetreeamp\%PartType(npart)).eq.abs(wp\_) ) thetreeamp\%NumW = thetreeamp\%NumW + 1}
\DoxyCodeLine{499                      \textcolor{keywordflow}{if}( abs(thetreeamp\%PartType(npart)).eq.abs(z0\_) ) thetreeamp\%NumV = thetreeamp\%NumV + 1}
\DoxyCodeLine{500                      \textcolor{keywordflow}{if}( abs(thetreeamp\%PartType(npart)).eq.abs(pho\_)) thetreeamp\%NumV = thetreeamp\%NumV + 1}
\DoxyCodeLine{501 \textcolor{comment}{!                      TheTreeAmp\%BosonVertex = TheTreeAmp\%PartType(LastQuark)! this variable specifies the position of the boson wrt. to the quark lines}}
\DoxyCodeLine{502                      thetreeamp\%BosonVertex = lastquark}
\DoxyCodeLine{503 \textcolor{keywordflow}{                  endif}}
\DoxyCodeLine{504 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{505 }
\DoxyCodeLine{506 }
\DoxyCodeLine{507 \textcolor{comment}{!           set number of gluons between quark lines}}
\DoxyCodeLine{508 \textcolor{comment}{!            if( IsAQuark( TheTreeAmp\%PartType(1) ) .or. IsAScalar(TheTreeAmp\%PartType(1)) ) then ! not a gluon and not a boson}}
\DoxyCodeLine{509            \textcolor{keywordflow}{if}( isaquark( thetreeamp\%PartType(1) ) ) \textcolor{keywordflow}{then} \textcolor{comment}{! not a gluon and not a boson}}
\DoxyCodeLine{510              \textcolor{keywordflow}{if}( thetreeamp\%NumQua+thetreeamp\%NumSca .eq. 2 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{511                    thetreeamp\%NumGlu(1) = quarkpos(2) -\/ quarkpos(1) -\/ 1}
\DoxyCodeLine{512                    thetreeamp\%NumGlu(2) = thetreeamp\%NumSca+thetreeamp\%NumQua+thetreeamp\%NumGlu(0) -\/ quarkpos(2)}
\DoxyCodeLine{513 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{514              \textcolor{keywordflow}{if}( thetreeamp\%NumQua .eq. 4 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{515                    thetreeamp\%NumGlu(1) = quarkpos(2) -\/ quarkpos(1) -\/ 1}
\DoxyCodeLine{516                    thetreeamp\%NumGlu(2) = quarkpos(3) -\/ quarkpos(2) -\/ 1}
\DoxyCodeLine{517                    thetreeamp\%NumGlu(3) = quarkpos(4) -\/ quarkpos(3) -\/ 1}
\DoxyCodeLine{518                    thetreeamp\%NumGlu(4) = thetreeamp\%NumSca+thetreeamp\%NumQua+thetreeamp\%NumGlu(0) -\/ quarkpos(4)}
\DoxyCodeLine{519 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{520              \textcolor{keywordflow}{if}( thetreeamp\%NumQua .eq. 6 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{521                    thetreeamp\%NumGlu(1) = quarkpos(2) -\/ quarkpos(1) -\/ 1}
\DoxyCodeLine{522                    thetreeamp\%NumGlu(2) = quarkpos(3) -\/ quarkpos(2) -\/ 1}
\DoxyCodeLine{523                    thetreeamp\%NumGlu(3) = quarkpos(4) -\/ quarkpos(3) -\/ 1}
\DoxyCodeLine{524                    thetreeamp\%NumGlu(4) = quarkpos(5) -\/ quarkpos(4) -\/ 1}
\DoxyCodeLine{525                    thetreeamp\%NumGlu(5) = quarkpos(6) -\/ quarkpos(5) -\/ 1}
\DoxyCodeLine{526                    thetreeamp\%NumGlu(6) = thetreeamp\%NumSca+thetreeamp\%NumQua+thetreeamp\%NumGlu(0) -\/ quarkpos(6)}
\DoxyCodeLine{527 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{528 }
\DoxyCodeLine{529            \textcolor{keywordflow}{elseif}( thetreeamp\%PartType(1).eq.10 ) \textcolor{keywordflow}{then} \textcolor{comment}{! is a gluon}}
\DoxyCodeLine{530              \textcolor{keywordflow}{if}( thetreeamp\%NumQua .eq. 2 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{531                    thetreeamp\%NumGlu(1) = quarkpos(1) -\/ 2}
\DoxyCodeLine{532                    thetreeamp\%NumGlu(2) = quarkpos(2) -\/ quarkpos(1) -\/ 1}
\DoxyCodeLine{533                    thetreeamp\%NumGlu(3) = thetreeamp\%NumSca+thetreeamp\%NumQua+thetreeamp\%NumGlu(0) -\/ quarkpos(2)}
\DoxyCodeLine{534 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{535              \textcolor{keywordflow}{if}( thetreeamp\%NumQua .eq. 4 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{536                    thetreeamp\%NumGlu(1) = quarkpos(1) -\/ 2}
\DoxyCodeLine{537                    thetreeamp\%NumGlu(2) = quarkpos(2) -\/ quarkpos(1) -\/ 1}
\DoxyCodeLine{538                    thetreeamp\%NumGlu(3) = quarkpos(3) -\/ quarkpos(2) -\/ 1}
\DoxyCodeLine{539                    thetreeamp\%NumGlu(4) = quarkpos(4) -\/ quarkpos(3) -\/ 1}
\DoxyCodeLine{540                    thetreeamp\%NumGlu(5) = thetreeamp\%NumSca+thetreeamp\%NumQua+thetreeamp\%NumGlu(0) -\/ quarkpos(4)}
\DoxyCodeLine{541 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{542              \textcolor{keywordflow}{if}( thetreeamp\%NumQua .eq. 6 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{543                    thetreeamp\%NumGlu(1) = quarkpos(1) -\/ 2}
\DoxyCodeLine{544                    thetreeamp\%NumGlu(2) = quarkpos(2) -\/ quarkpos(1) -\/ 1}
\DoxyCodeLine{545                    thetreeamp\%NumGlu(3) = quarkpos(3) -\/ quarkpos(2) -\/ 1}
\DoxyCodeLine{546                    thetreeamp\%NumGlu(4) = quarkpos(4) -\/ quarkpos(3) -\/ 1}
\DoxyCodeLine{547                    thetreeamp\%NumGlu(5) = quarkpos(5) -\/ quarkpos(4) -\/ 1}
\DoxyCodeLine{548                    thetreeamp\%NumGlu(6) = quarkpos(6) -\/ quarkpos(5) -\/ 1}
\DoxyCodeLine{549                    thetreeamp\%NumGlu(7) = thetreeamp\%NumSca+thetreeamp\%NumQua+thetreeamp\%NumGlu(0) -\/ quarkpos(6)}
\DoxyCodeLine{550 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{551 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{552 }
\DoxyCodeLine{553 }
\DoxyCodeLine{554   ig=0; iq=0; ib=0;}
\DoxyCodeLine{555   \textcolor{keywordflow}{do} ipart=1,thetreeamp\%NumPart}
\DoxyCodeLine{556      partref = thetreeamp\%PartRef(ipart)}
\DoxyCodeLine{557      parttype= theparticles(partref)\%PartType}
\DoxyCodeLine{558      \textcolor{keywordflow}{if}( parttype.eq.glu\_ ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{559            ig=ig+1}
\DoxyCodeLine{560            thetreeamp\%Gluons(ig)\%PartType => theparticles(partref)\%PartType}
\DoxyCodeLine{561            thetreeamp\%Gluons(ig)\%ExtRef   => theparticles(partref)\%ExtRef}
\DoxyCodeLine{562            thetreeamp\%Gluons(ig)\%Mass     => theparticles(partref)\%Mass}
\DoxyCodeLine{563            thetreeamp\%Gluons(ig)\%Mass2    => theparticles(partref)\%Mass2}
\DoxyCodeLine{564            thetreeamp\%Gluons(ig)\%Helicity => theparticles(partref)\%Helicity}
\DoxyCodeLine{565            thetreeamp\%Gluons(ig)\%Mom      => theparticles(partref)\%Mom}
\DoxyCodeLine{566            thetreeamp\%Gluons(ig)\%Pol      => theparticles(partref)\%Pol}
\DoxyCodeLine{567            \textcolor{keywordflow}{if}( parttype.ne.theparticles(partref)\%PartType ) print *,\textcolor{stringliteral}{"Error1 in LinkTreeParticles"}}
\DoxyCodeLine{568      \textcolor{keywordflow}{elseif}( isaquark(parttype) ) \textcolor{keywordflow}{then} \textcolor{comment}{! PartType==Quark}}
\DoxyCodeLine{569            iq=iq+1}
\DoxyCodeLine{570            thetreeamp\%Quarks(iq)\%PartType => theparticles(partref)\%PartType}
\DoxyCodeLine{571            thetreeamp\%Quarks(iq)\%ExtRef   => theparticles(partref)\%ExtRef}
\DoxyCodeLine{572            thetreeamp\%Quarks(iq)\%Mass     => theparticles(partref)\%Mass}
\DoxyCodeLine{573            thetreeamp\%Quarks(iq)\%Mass2    => theparticles(partref)\%Mass2}
\DoxyCodeLine{574            thetreeamp\%Quarks(iq)\%Helicity => theparticles(partref)\%Helicity}
\DoxyCodeLine{575            thetreeamp\%Quarks(iq)\%Mom      => theparticles(partref)\%Mom}
\DoxyCodeLine{576            thetreeamp\%Quarks(iq)\%Pol      => theparticles(partref)\%Pol}
\DoxyCodeLine{577            \textcolor{keywordflow}{if}( parttype.ne.theparticles(partref)\%PartType ) print *,\textcolor{stringliteral}{"Error2 in LinkTreeParticles"}}
\DoxyCodeLine{578      \textcolor{keywordflow}{elseif}( isaboson(parttype) ) \textcolor{keywordflow}{then}  \textcolor{comment}{! PartType==Boson}}
\DoxyCodeLine{579            ib=ib+1}
\DoxyCodeLine{580            \textcolor{keywordflow}{if}( ib.ge.2 ) print *, \textcolor{stringliteral}{"Too many bosons in LinkTreeParticles"}}
\DoxyCodeLine{581            thetreeamp\%Boson\%PartType => theparticles(partref)\%PartType}
\DoxyCodeLine{582            thetreeamp\%Boson\%ExtRef   => theparticles(partref)\%ExtRef}
\DoxyCodeLine{583            thetreeamp\%Boson\%Mass     => theparticles(partref)\%Mass}
\DoxyCodeLine{584            thetreeamp\%Boson\%Mass2    => theparticles(partref)\%Mass2}
\DoxyCodeLine{585            thetreeamp\%Boson\%Helicity => theparticles(partref)\%Helicity}
\DoxyCodeLine{586            thetreeamp\%Boson\%Mom      => theparticles(partref)\%Mom}
\DoxyCodeLine{587            thetreeamp\%Boson\%Pol      => theparticles(partref)\%Pol}
\DoxyCodeLine{588            \textcolor{keywordflow}{if}( parttype.ne.theparticles(partref)\%PartType ) print *,\textcolor{stringliteral}{"Error2 in LinkTreeParticles"}}
\DoxyCodeLine{589 \textcolor{keywordflow}{     endif}}
\DoxyCodeLine{590 \textcolor{keywordflow}{  enddo}}
\DoxyCodeLine{591   \textcolor{keywordflow}{if}( ig.ne.thetreeamp\%NumGlu(0) .OR. iq.ne.thetreeamp\%NumQua+thetreeamp\%NumSca .OR. ib.ne.thetreeamp\%NumPart-\/thetreeamp\%NumGlu(0)-\/thetreeamp\%NumQua-\/thetreeamp\%NumSca) print *,\textcolor{stringliteral}{"Error3 in LinkTreeParticles"}}
\DoxyCodeLine{592 }
\DoxyCodeLine{593 }
\DoxyCodeLine{594 \textcolor{keywordflow}{RETURN}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a982192d11209498ce988df66d10a8c0e}\label{namespacemodttbhiggs_a982192d11209498ce988df66d10a8c0e}} 
\index{modttbhiggs@{modttbhiggs}!new\_calc\_ampl@{new\_calc\_ampl}}
\index{new\_calc\_ampl@{new\_calc\_ampl}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{new\_calc\_ampl()}{new\_calc\_ampl()}}
{\footnotesize\ttfamily subroutine modttbhiggs\+::new\+\_\+calc\+\_\+ampl (\begin{DoxyParamCaption}\item[{integer}]{tag\+\_\+f,  }\item[{integer}]{tag\+\_\+Z,  }\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1treeprocess}{treeprocess}})}]{Tree\+Proc,  }\item[{complex(8), dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}})}]{Res }\end{DoxyParamCaption})}



Definition at line 428 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{428 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{429 \textcolor{keywordtype}{integer} :: tag\_f,tag\_Z,n}
\DoxyCodeLine{430 \textcolor{keywordtype}{complex(8)} :: Res(1:Ds)}
\DoxyCodeLine{431 \textcolor{keywordtype}{type}(TreeProcess) :: TreeProc}
\DoxyCodeLine{432 \textcolor{keywordtype}{logical},\textcolor{keywordtype}{parameter} :: Boson=.true.}
\DoxyCodeLine{433 \textcolor{keywordtype}{integer} :: i,j,Order(1:6)}
\DoxyCodeLine{434 }
\DoxyCodeLine{435 }
\DoxyCodeLine{436       \textcolor{keywordflow}{if}( treeproc\%NumQua.eq.2 .and. treeproc\%NumSca.eq.0 ) then\textcolor{comment}{!  2 quarks and no scalars}}
\DoxyCodeLine{437           \textcolor{keywordflow}{if} ( treeproc\%PartType(1).eq.glu\_ .and. boson ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{438              res(1:dv) = cur\_g\_2fv( treeproc\%Gluons(2:treeproc\%NumGlu(0)),treeproc\%Quarks(1:treeproc\%NumQua),treeproc\%Boson,treeproc\%NumGlu(0:3) )}
\DoxyCodeLine{439           \textcolor{keywordflow}{elseif}( isaquark(treeproc\%PartType(1)) .and. boson ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{440              \textcolor{keywordflow}{if}( treeproc\%NumV.eq.1 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{441                 res(1:ds) = cur\_f\_2fv(treeproc\%Gluons(1:treeproc\%NumGlu(0)),treeproc\%Quarks(2:2),treeproc\%Quarks(1)\%PartType,treeproc\%Boson,treeproc\%NumGlu(0:2))}
\DoxyCodeLine{442              \textcolor{keywordflow}{else}}
\DoxyCodeLine{443                 print *, \textcolor{stringliteral}{"requested current with a boson is not available"}}
\DoxyCodeLine{444                 stop}
\DoxyCodeLine{445 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{446           \textcolor{keywordflow}{else}}
\DoxyCodeLine{447              print *, \textcolor{stringliteral}{"requested current is not available 2q"}}
\DoxyCodeLine{448              stop}
\DoxyCodeLine{449 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{450 }
\DoxyCodeLine{451       \textcolor{keywordflow}{elseif}( treeproc\%NumQua.eq.4  .and. treeproc\%NumSca.eq.0) then\textcolor{comment}{!  4 quarks, no scalars}}
\DoxyCodeLine{452           \textcolor{keywordflow}{if}( treeproc\%PartType(1).eq.glu\_ ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{453                  res(1:dv) = cur\_g\_4fv( treeproc\%Gluons(2:treeproc\%NumGlu(0)),treeproc\%Quarks(1:treeproc\%NumQua),treeproc\%Boson,treeproc\%BosonVertex,treeproc\%NumGlu(0:5) )}
\DoxyCodeLine{454           \textcolor{keywordflow}{elseif}( isaquark(treeproc\%PartType(1)) ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{455                  res(1:ds) = cur\_f\_4fv( treeproc\%Gluons(1:treeproc\%NumGlu(0)),treeproc\%Quarks(2:4),treeproc\%Quarks(1)\%PartType,treeproc\%Boson,treeproc\%BosonVertex,treeproc\%NumGlu(0:4),tag\_f,tag\_z )}
\DoxyCodeLine{456           \textcolor{keywordflow}{else}}
\DoxyCodeLine{457              print *, \textcolor{stringliteral}{"requested current is not available 4q"}}
\DoxyCodeLine{458              stop}
\DoxyCodeLine{459 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{460       \textcolor{keywordflow}{else}}
\DoxyCodeLine{461            print *, \textcolor{stringliteral}{"requested current is not available xx"}}
\DoxyCodeLine{462            stop}
\DoxyCodeLine{463 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{464 }
\DoxyCodeLine{465 \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a7b29e228d381ca9e221522f8c42bbb98}\label{namespacemodttbhiggs_a7b29e228d381ca9e221522f8c42bbb98}} 
\index{modttbhiggs@{modttbhiggs}!psp1\_@{psp1\_}}
\index{psp1\_@{psp1\_}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{psp1\_()}{psp1\_()}}
{\footnotesize\ttfamily complex(8) function modttbhiggs\+::psp1\+\_\+ (\begin{DoxyParamCaption}\item[{complex(8), dimension(\+:), intent(in)}]{sp1,  }\item[{complex(8), dimension(\+:), intent(in)}]{sp2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5389 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5389           \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5390           \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: sp1(:)}
\DoxyCodeLine{5391           \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: sp2(:)}
\DoxyCodeLine{5392           \textcolor{keywordtype}{complex(8)} :: res}
\DoxyCodeLine{5393 }
\DoxyCodeLine{5394             res = sum(sp1(1:)*sp2(1:))}
\DoxyCodeLine{5395 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a99dfd6ee0756556121a9b1c6afc52438}\label{namespacemodttbhiggs_a99dfd6ee0756556121a9b1c6afc52438}} 
\index{modttbhiggs@{modttbhiggs}!rsc\_@{rsc\_}}
\index{rsc\_@{rsc\_}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{rsc\_()}{rsc\_()}}
{\footnotesize\ttfamily subroutine modttbhiggs\+::rsc\+\_\+ (\begin{DoxyParamCaption}\item[{integer}]{n,  }\item[{complex(8), dimension($\ast$)}]{x,  }\item[{complex(8), dimension($\ast$)}]{y,  }\item[{complex(8)}]{r }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5513 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5513          \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5514          \textcolor{keywordtype}{integer} i,n}
\DoxyCodeLine{5515          \textcolor{keywordtype}{complex(8)} x(*),y(*)}
\DoxyCodeLine{5516          \textcolor{keywordtype}{complex(8)} r}
\DoxyCodeLine{5517 }
\DoxyCodeLine{5518             r = x(1)*y(1)}
\DoxyCodeLine{5519             \textcolor{keywordflow}{do} i=2, n}
\DoxyCodeLine{5520               r = r -\/ x(i)*y(i)}
\DoxyCodeLine{5521 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{5522 }
\DoxyCodeLine{5523          \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_acd313348e371d4b4ce20b49e13bd8150}\label{namespacemodttbhiggs_acd313348e371d4b4ce20b49e13bd8150}} 
\index{modttbhiggs@{modttbhiggs}!sc\_@{sc\_}}
\index{sc\_@{sc\_}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{sc\_()}{sc\_()}}
{\footnotesize\ttfamily complex(8) function modttbhiggs\+::sc\+\_\+ (\begin{DoxyParamCaption}\item[{complex(8), dimension(\+:)}]{p1,  }\item[{complex(8), dimension(\+:)}]{p2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5499 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5499           \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5500           \textcolor{keywordtype}{complex(8)} :: p1(:),p2(:)}
\DoxyCodeLine{5501           \textcolor{keywordtype}{complex(8)} :: sc\_}
\DoxyCodeLine{5502           \textcolor{keywordtype}{integer} :: sizemin}
\DoxyCodeLine{5503 }
\DoxyCodeLine{5504               sizemin=min(\textcolor{keyword}{size}(p1),\textcolor{keyword}{size}(p2))}
\DoxyCodeLine{5505               \textcolor{keyword}{call }rsc\_(sizemin,p1,p2,sc\_)}
\DoxyCodeLine{5506 }
\DoxyCodeLine{5507           \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a299bd2c18d43760781811270fe270da4}\label{namespacemodttbhiggs_a299bd2c18d43760781811270fe270da4}} 
\index{modttbhiggs@{modttbhiggs}!spb2@{spb2}}
\index{spb2@{spb2}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{spb2()}{spb2()}}
{\footnotesize\ttfamily subroutine modttbhiggs\+::spb2 (\begin{DoxyParamCaption}\item[{integer}]{Dv,  }\item[{integer}]{Ds,  }\item[{double complex, dimension(\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}})}]{sp,  }\item[{double complex, dimension(\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}})}]{v,  }\item[{double complex, dimension(\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}})}]{f }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5250 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5250          \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5251          \textcolor{keywordtype}{integer} i,i1,i2,i3,Dv,Ds,imax}
\DoxyCodeLine{5252          \textcolor{keywordtype}{double complex} sp(Ds),v(Dv),f(Ds)}
\DoxyCodeLine{5253          \textcolor{keywordtype}{double complex} x0(4,4),xx(4,4),xy(4,4)}
\DoxyCodeLine{5254          \textcolor{keywordtype}{double complex} xz(4,4),x5(4,4)}
\DoxyCodeLine{5255          \textcolor{keywordtype}{double complex} y1,y2,y3,y4,bp,bm,cp,cm}
\DoxyCodeLine{5256          \textcolor{keywordtype}{double complex} test(Ds)}
\DoxyCodeLine{5257 }
\DoxyCodeLine{5258            imax = ds/4}
\DoxyCodeLine{5259 }
\DoxyCodeLine{5260            \textcolor{keywordflow}{do} i=1,imax}
\DoxyCodeLine{5261            i1= 1+4*(i-\/1)}
\DoxyCodeLine{5262            i2=i1+3}
\DoxyCodeLine{5263 }
\DoxyCodeLine{5264            y1=sp(i1)}
\DoxyCodeLine{5265            y2=sp(i1+1)}
\DoxyCodeLine{5266            y3=sp(i1+2)}
\DoxyCodeLine{5267            y4=sp(i1+3)}
\DoxyCodeLine{5268 }
\DoxyCodeLine{5269            x0(1,i)=y1}
\DoxyCodeLine{5270            x0(2,i)=y2}
\DoxyCodeLine{5271            x0(3,i)=-\/y3}
\DoxyCodeLine{5272            x0(4,i)=-\/y4}
\DoxyCodeLine{5273 }
\DoxyCodeLine{5274            xx(1,i) = -\/y4}
\DoxyCodeLine{5275            xx(2,i) = -\/y3}
\DoxyCodeLine{5276            xx(3,i) = y2}
\DoxyCodeLine{5277            xx(4,i) = y1}
\DoxyCodeLine{5278 }
\DoxyCodeLine{5279            xy(1,i)=dcmplx(0d0,-\/1d0)*y4}
\DoxyCodeLine{5280            xy(2,i)=dcmplx(0d0,1d0)*y3}
\DoxyCodeLine{5281            xy(3,i)=dcmplx(0d0,1d0)*y2}
\DoxyCodeLine{5282            xy(4,i)=dcmplx(0d0,-\/1d0)*y1}
\DoxyCodeLine{5283 }
\DoxyCodeLine{5284            xz(1,i)=-\/y3}
\DoxyCodeLine{5285            xz(2,i)=y4}
\DoxyCodeLine{5286            xz(3,i)=y1}
\DoxyCodeLine{5287            xz(4,i)=-\/y2}
\DoxyCodeLine{5288 }
\DoxyCodeLine{5289            x5(1,i)=y3}
\DoxyCodeLine{5290            x5(2,i)=y4}
\DoxyCodeLine{5291            x5(3,i)=y1}
\DoxyCodeLine{5292            x5(4,i)=y2}
\DoxyCodeLine{5293 }
\DoxyCodeLine{5294 \textcolor{keywordflow}{           enddo}}
\DoxyCodeLine{5295 }
\DoxyCodeLine{5296            \textcolor{keywordflow}{if} (dv.eq.4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5297 }
\DoxyCodeLine{5298            \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{5299 }
\DoxyCodeLine{5300            f(i)=v(1)*x0(i,1)-\/v(2)*xx(i,1)-\/v(3)*xy(i,1)-\/v(4)*xz(i,1)}
\DoxyCodeLine{5301 }
\DoxyCodeLine{5302 \textcolor{keywordflow}{           enddo}}
\DoxyCodeLine{5303 }
\DoxyCodeLine{5304 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{5305 }
\DoxyCodeLine{5306            \textcolor{keywordflow}{if} (dv.eq.6) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5307            bp = (v(5)+dcmplx(0d0,1d0)*v(6))}
\DoxyCodeLine{5308            bm=(v(5)-\/dcmplx(0d0,1d0)*v(6))}
\DoxyCodeLine{5309 }
\DoxyCodeLine{5310            \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{5311 }
\DoxyCodeLine{5312            f(i)=v(1)*x0(i,1)-\/v(2)*xx(i,1)-\/v(3)*xy(i,1)-\/v(4)*xz(i,1)+bm*x5(i,2)}
\DoxyCodeLine{5313 }
\DoxyCodeLine{5314             i1 = i+4}
\DoxyCodeLine{5315 }
\DoxyCodeLine{5316             f(i1)= v(1)*x0(i,2)-\/v(2)*xx(i,2)-\/v(3)*xy(i,2)-\/v(4)*xz(i,2)-\/bp*x5(i,1)}
\DoxyCodeLine{5317 }
\DoxyCodeLine{5318 }
\DoxyCodeLine{5319 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{5320 }
\DoxyCodeLine{5321 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{5322 }
\DoxyCodeLine{5323            \textcolor{keywordflow}{if} (dv.eq.8) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5324            bp=(v(5)+dcmplx(0d0,1d0)*v(6))}
\DoxyCodeLine{5325            bm=(v(5)-\/dcmplx(0d0,1d0)*v(6))}
\DoxyCodeLine{5326            cp=(v(7)+dcmplx(0d0,1d0)*v(8))}
\DoxyCodeLine{5327            cm=(v(7)-\/dcmplx(0d0,1d0)*v(8))}
\DoxyCodeLine{5328 }
\DoxyCodeLine{5329            \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{5330 }
\DoxyCodeLine{5331            f(i)=v(1)*x0(i,1)-\/v(2)*xx(i,1)-\/v(3)*xy(i,1)-\/v(4)*xz(i,1)+bm*x5(i,2)-\/cm*x5(i,3)}
\DoxyCodeLine{5332 }
\DoxyCodeLine{5333             i1 = i+4}
\DoxyCodeLine{5334 }
\DoxyCodeLine{5335             f(i1)= v(1)*x0(i,2)-\/v(2)*xx(i,2)-\/v(3)*xy(i,2)-\/v(4)*xz(i,2)-\/bp*x5(i,1)+cm*x5(i,4)}
\DoxyCodeLine{5336 }
\DoxyCodeLine{5337              i2 = i1+4}
\DoxyCodeLine{5338 }
\DoxyCodeLine{5339              f(i2)=v(1)*x0(i,3)-\/v(2)*xx(i,3)-\/v(3)*xy(i,3)-\/v(4)*xz(i,3)+bm*x5(i,4)+cp*x5(i,1)}
\DoxyCodeLine{5340 }
\DoxyCodeLine{5341               i3=i2+4}
\DoxyCodeLine{5342 }
\DoxyCodeLine{5343               f(i3)=v(1)*x0(i,4)-\/v(2)*xx(i,4)-\/v(3)*xy(i,4)-\/v(4)*xz(i,4)-\/bp*x5(i,3)-\/cp*x5(i,2)}
\DoxyCodeLine{5344 }
\DoxyCodeLine{5345 \textcolor{keywordflow}{              enddo}}
\DoxyCodeLine{5346 }
\DoxyCodeLine{5347 \textcolor{keywordflow}{              endif}}
\DoxyCodeLine{5348 }
\DoxyCodeLine{5349 }
\DoxyCodeLine{5350 }
\DoxyCodeLine{5351 \textcolor{comment}{! if(Ds.eq.16) then}}
\DoxyCodeLine{5352 \textcolor{comment}{!   test(:) = SpiVL(sp,v)}}
\DoxyCodeLine{5353 \textcolor{comment}{!   print *, ""}}
\DoxyCodeLine{5354 \textcolor{comment}{!   print *, "spb2",f(1:Ds)}}
\DoxyCodeLine{5355 \textcolor{comment}{!   print *, "test",test(1:Ds)}}
\DoxyCodeLine{5356 \textcolor{comment}{!   print *, "diff",test(1:Ds)-\/f(1:Ds)}}
\DoxyCodeLine{5357 \textcolor{comment}{!   if( any( abs(test(1:Ds)-\/f(1:Ds) ).gt.1d-\/10  ) ) pause}}
\DoxyCodeLine{5358 \textcolor{comment}{! endif}}
\DoxyCodeLine{5359 }
\DoxyCodeLine{5360 }
\DoxyCodeLine{5361 }
\DoxyCodeLine{5362 }
\DoxyCodeLine{5363                \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a9a1c65c401f7769cf3b25ee32dd38947}\label{namespacemodttbhiggs_a9a1c65c401f7769cf3b25ee32dd38947}} 
\index{modttbhiggs@{modttbhiggs}!spb2\_@{spb2\_}}
\index{spb2\_@{spb2\_}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{spb2\_()}{spb2\_()}}
{\footnotesize\ttfamily double complex function, dimension(size(sp)) modttbhiggs\+::spb2\+\_\+ (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:), intent(in)}]{sp,  }\item[{double complex, dimension(\+:), intent(in)}]{v }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5368 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5368         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5369         \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: sp(:),v(:)}
\DoxyCodeLine{5370         \textcolor{keywordtype}{double complex} :: spb2\_(size(sp)) ,tmp(size(sp))}
\DoxyCodeLine{5371         \textcolor{keywordtype}{integer} :: Dv,Ds}
\DoxyCodeLine{5372 }
\DoxyCodeLine{5373           ds = \textcolor{keyword}{size}(sp)}
\DoxyCodeLine{5374           \textcolor{keywordflow}{if} (ds == 4) dv = 4}
\DoxyCodeLine{5375           \textcolor{keywordflow}{if} (ds == 8) dv = 6}
\DoxyCodeLine{5376           \textcolor{keywordflow}{if} (ds == 16) dv = 8}
\DoxyCodeLine{5377           \textcolor{keyword}{call }spb2(dv,ds,sp,v,spb2\_)}
\DoxyCodeLine{5378 }
\DoxyCodeLine{5379 \textcolor{comment}{!  tmp = SpiVL(sp(1:Ds),v(1:Dv))}}
\DoxyCodeLine{5380 \textcolor{comment}{!  print *, "diff2",tmp-\/spb2\_}}
\DoxyCodeLine{5381 \textcolor{comment}{!  pause}}
\DoxyCodeLine{5382         \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_aabd6b0430e2766e11b744504ae344a72}\label{namespacemodttbhiggs_aabd6b0430e2766e11b744504ae344a72}} 
\index{modttbhiggs@{modttbhiggs}!spi2@{spi2}}
\index{spi2@{spi2}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{spi2()}{spi2()}}
{\footnotesize\ttfamily subroutine modttbhiggs\+::spi2 (\begin{DoxyParamCaption}\item[{integer}]{Dv,  }\item[{integer}]{Ds,  }\item[{double complex, dimension(\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}})}]{v,  }\item[{double complex, dimension(\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}})}]{sp,  }\item[{double complex, dimension(\mbox{\hyperlink{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}{ds}})}]{f }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5093 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5093          \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5094          \textcolor{keywordtype}{integer} i,i1,i2,i3,imax,Dv,Ds}
\DoxyCodeLine{5095          \textcolor{keywordtype}{double complex} sp(Ds),v(Dv),f(Ds)}
\DoxyCodeLine{5096          \textcolor{keywordtype}{double complex} x0(4,4),xx(4,4),xy(4,4)}
\DoxyCodeLine{5097          \textcolor{keywordtype}{double complex} xz(4,4),x5(4,4)}
\DoxyCodeLine{5098          \textcolor{keywordtype}{double complex} y1,y2,y3,y4,bp,bm,cp,cm}
\DoxyCodeLine{5099          \textcolor{keywordtype}{double complex} test(Ds)}
\DoxyCodeLine{5100 }
\DoxyCodeLine{5101 }
\DoxyCodeLine{5102          imax = ds/4}
\DoxyCodeLine{5103 }
\DoxyCodeLine{5104            \textcolor{keywordflow}{do} i=1,imax}
\DoxyCodeLine{5105            i1= 1+4*(i-\/1)}
\DoxyCodeLine{5106            i2=i1+3}
\DoxyCodeLine{5107 }
\DoxyCodeLine{5108            y1=sp(i1)}
\DoxyCodeLine{5109            y2=sp(i1+1)}
\DoxyCodeLine{5110            y3=sp(i1+2)}
\DoxyCodeLine{5111            y4=sp(i1+3)}
\DoxyCodeLine{5112 }
\DoxyCodeLine{5113            x0(1,i)=y1}
\DoxyCodeLine{5114            x0(2,i)=y2}
\DoxyCodeLine{5115            x0(3,i)=-\/y3}
\DoxyCodeLine{5116            x0(4,i)=-\/y4}
\DoxyCodeLine{5117 }
\DoxyCodeLine{5118 }
\DoxyCodeLine{5119            xx(1,i) = y4}
\DoxyCodeLine{5120            xx(2,i) = y3}
\DoxyCodeLine{5121            xx(3,i) = -\/y2}
\DoxyCodeLine{5122            xx(4,i) = -\/y1}
\DoxyCodeLine{5123 }
\DoxyCodeLine{5124 }
\DoxyCodeLine{5125            xy(1,i)=dcmplx(0d0,-\/1d0)*y4}
\DoxyCodeLine{5126            xy(2,i)=dcmplx(0d0,1d0)*y3}
\DoxyCodeLine{5127            xy(3,i)=dcmplx(0d0,1d0)*y2}
\DoxyCodeLine{5128            xy(4,i)=dcmplx(0d0,-\/1d0)*y1}
\DoxyCodeLine{5129 }
\DoxyCodeLine{5130            xz(1,i)=y3}
\DoxyCodeLine{5131            xz(2,i)=-\/y4}
\DoxyCodeLine{5132            xz(3,i)=-\/y1}
\DoxyCodeLine{5133            xz(4,i)=y2}
\DoxyCodeLine{5134 }
\DoxyCodeLine{5135            x5(1,i)=y3}
\DoxyCodeLine{5136            x5(2,i)=y4}
\DoxyCodeLine{5137            x5(3,i)=y1}
\DoxyCodeLine{5138            x5(4,i)=y2}
\DoxyCodeLine{5139 }
\DoxyCodeLine{5140 \textcolor{keywordflow}{           enddo}}
\DoxyCodeLine{5141 }
\DoxyCodeLine{5142            \textcolor{keywordflow}{if}(dv.eq.4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5143 }
\DoxyCodeLine{5144            \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{5145 }
\DoxyCodeLine{5146            f(i)=v(1)*x0(i,1)-\/v(2)*xx(i,1)-\/v(3)*xy(i,1)-\/v(4)*xz(i,1)}
\DoxyCodeLine{5147 \textcolor{keywordflow}{           enddo}}
\DoxyCodeLine{5148 }
\DoxyCodeLine{5149 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{5150 }
\DoxyCodeLine{5151 }
\DoxyCodeLine{5152           \textcolor{keywordflow}{if} (dv.eq.6) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5153            bp = (v(5)+dcmplx(0d0,1d0)*v(6))}
\DoxyCodeLine{5154            bm=(v(5)-\/dcmplx(0d0,1d0)*v(6))}
\DoxyCodeLine{5155 }
\DoxyCodeLine{5156 }
\DoxyCodeLine{5157            \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{5158 }
\DoxyCodeLine{5159            f(i)=v(1)*x0(i,1)-\/v(2)*xx(i,1)-\/v(3)*xy(i,1)-\/v(4)*xz(i,1)-\/bp*x5(i,2)}
\DoxyCodeLine{5160 }
\DoxyCodeLine{5161             i1=i+4}
\DoxyCodeLine{5162 }
\DoxyCodeLine{5163             f(i1)=v(1)*x0(i,2)-\/v(2)*xx(i,2)-\/v(3)*xy(i,2)-\/v(4)*xz(i,2)+bm*x5(i,1)}
\DoxyCodeLine{5164 }
\DoxyCodeLine{5165 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{5166 }
\DoxyCodeLine{5167 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{5168 }
\DoxyCodeLine{5169           \textcolor{keywordflow}{if} (dv.eq.8) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5170 }
\DoxyCodeLine{5171            bp = (v(5)+dcmplx(0d0,1d0)*v(6))}
\DoxyCodeLine{5172            bm=(v(5)-\/dcmplx(0d0,1d0)*v(6))}
\DoxyCodeLine{5173            cp=(v(7)+dcmplx(0d0,1d0)*v(8))}
\DoxyCodeLine{5174            cm=(v(7)-\/dcmplx(0d0,1d0)*v(8))}
\DoxyCodeLine{5175 }
\DoxyCodeLine{5176 }
\DoxyCodeLine{5177 }
\DoxyCodeLine{5178            \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{5179 }
\DoxyCodeLine{5180            f(i)=v(1)*x0(i,1)-\/v(2)*xx(i,1)-\/v(3)*xy(i,1)-\/v(4)*xz(i,1)-\/bp*x5(i,2)+ cp*x5(i,3)}
\DoxyCodeLine{5181 }
\DoxyCodeLine{5182             i1=i+4}
\DoxyCodeLine{5183 }
\DoxyCodeLine{5184             f(i1)=v(1)*x0(i,2)-\/v(2)*xx(i,2)-\/v(3)*xy(i,2)-\/v(4)*xz(i,2)+bm*x5(i,1)-\/cp*x5(i,4)}
\DoxyCodeLine{5185 }
\DoxyCodeLine{5186              i2=i1+4}
\DoxyCodeLine{5187 }
\DoxyCodeLine{5188             f(i2)=v(1)*x0(i,3)-\/v(2)*xx(i,3)-\/v(3)*xy(i,3)-\/v(4)*xz(i,3)-\/bp*x5(i,4)-\/cm*x5(i,1)}
\DoxyCodeLine{5189 }
\DoxyCodeLine{5190              i3=i2+4}
\DoxyCodeLine{5191 }
\DoxyCodeLine{5192              f(i3)=v(1)*x0(i,4)-\/v(2)*xx(i,4)-\/v(3)*xy(i,4)-\/v(4)*xz(i,4)+bm*x5(i,3)+cm*x5(i,2)}
\DoxyCodeLine{5193 }
\DoxyCodeLine{5194 }
\DoxyCodeLine{5195 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{5196 }
\DoxyCodeLine{5197 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{5198 }
\DoxyCodeLine{5199 \textcolor{comment}{! if(Ds.eq.16) then}}
\DoxyCodeLine{5200 \textcolor{comment}{!   test(:) = VSpiL(v,sp)}}
\DoxyCodeLine{5201 \textcolor{comment}{!   print *, ""}}
\DoxyCodeLine{5202 \textcolor{comment}{!   print *, "spi2",f(1:Ds)}}
\DoxyCodeLine{5203 \textcolor{comment}{!   print *, "test",test(1:Ds)}}
\DoxyCodeLine{5204 \textcolor{comment}{!   print *, "diff",test(1:Ds)-\/f(1:Ds)}}
\DoxyCodeLine{5205 \textcolor{comment}{!   if( any( abs(test(1:Ds)-\/f(1:Ds) ).gt.1d-\/10  ) ) pause}}
\DoxyCodeLine{5206 \textcolor{comment}{! endif}}
\DoxyCodeLine{5207 }
\DoxyCodeLine{5208            \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a5ad23d4a036af583552482ced325bf9b}\label{namespacemodttbhiggs_a5ad23d4a036af583552482ced325bf9b}} 
\index{modttbhiggs@{modttbhiggs}!spi2\_@{spi2\_}}
\index{spi2\_@{spi2\_}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{spi2\_()}{spi2\_()}}
{\footnotesize\ttfamily double complex function, dimension(size(sp)) modttbhiggs\+::spi2\+\_\+ (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:), intent(in)}]{v,  }\item[{double complex, dimension(\+:), intent(in)}]{sp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5214 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5214          \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5215          \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: sp(:),v(:)}
\DoxyCodeLine{5216          \textcolor{keywordtype}{double complex} :: spi2\_(size(sp)) ,tmp(size(sp))}
\DoxyCodeLine{5217          \textcolor{keywordtype}{integer} :: Dv,Ds}
\DoxyCodeLine{5218 }
\DoxyCodeLine{5219           ds = \textcolor{keyword}{size}(sp)}
\DoxyCodeLine{5220           \textcolor{keywordflow}{if} (ds == 4) dv = 4}
\DoxyCodeLine{5221           \textcolor{keywordflow}{if} (ds == 8) dv = 6}
\DoxyCodeLine{5222           \textcolor{keywordflow}{if} (ds == 16) dv = 8}
\DoxyCodeLine{5223           \textcolor{keyword}{call }spi2(dv,ds,v,sp,spi2\_)}
\DoxyCodeLine{5224 }
\DoxyCodeLine{5225 \textcolor{comment}{!  tmp = VSpiL(v,sp)}}
\DoxyCodeLine{5226 \textcolor{comment}{!  print *, "diff1",tmp-\/spi2\_}}
\DoxyCodeLine{5227 \textcolor{comment}{! pause}}
\DoxyCodeLine{5228 }
\DoxyCodeLine{5229         \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_ad5dba1690a2142af045213493a451f7a}\label{namespacemodttbhiggs_ad5dba1690a2142af045213493a451f7a}} 
\index{modttbhiggs@{modttbhiggs}!spivl@{spivl}}
\index{spivl@{spivl}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{spivl()}{spivl()}}
{\footnotesize\ttfamily double complex function, dimension(size(sp)) modttbhiggs\+::spivl (\begin{DoxyParamCaption}\item[{double complex, dimension(\+:)}]{sp,  }\item[{double complex, dimension(\+:)}]{v }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5235 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5235       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5236       \textcolor{keywordtype}{double complex} :: sp(:),v(:)}
\DoxyCodeLine{5237       \textcolor{keywordtype}{double complex} :: SpiVL(size(sp))}
\DoxyCodeLine{5238 }
\DoxyCodeLine{5239             spivl(1) = sp(1)*v(1) + sp(4)*(v(2) + (0d0,1d0)*v(3)) + sp(3\textcolor{comment}{)*v(4)}}
\DoxyCodeLine{5240 \textcolor{comment}{}            spivl(2) = sp(2)*v(1) + sp(3)*(v(2) -\/ (0d0,1d0)*v(3)) -\/ sp(4\textcolor{comment}{)*v(4)}}
\DoxyCodeLine{5241 \textcolor{comment}{}            spivl(3) =-\/sp(3)*v(1) -\/ sp(2)*(v(2) + (0d0,1d0)*v(3)) -\/ sp(1\textcolor{comment}{)*v(4)}}
\DoxyCodeLine{5242 \textcolor{comment}{}            spivl(4) =-\/sp(4)*v(1) -\/ sp(1)*(v(2) -\/ (0d0,1d0)*v(3)) + sp(2\textcolor{comment}{)*v(4)}}
\DoxyCodeLine{5243 \textcolor{comment}{}}
\DoxyCodeLine{5244       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a0b1723a80e27200260bd362a8ac62788}\label{namespacemodttbhiggs_a0b1723a80e27200260bd362a8ac62788}} 
\index{modttbhiggs@{modttbhiggs}!summom@{summom}}
\index{summom@{summom}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{summom()}{summom()}}
{\footnotesize\ttfamily complex(8) function, dimension(1\+:\mbox{\hyperlink{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}{dv}}) modttbhiggs\+::summom (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structmodttbhiggs_1_1ptrtoparticle}{ptrtoparticle}}), dimension(\+:)}]{Particles,  }\item[{integer}]{i1,  }\item[{integer}]{i2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 4993 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{4993 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{4994 \textcolor{keywordtype}{complex(8)} :: SumMom(1:Dv)}
\DoxyCodeLine{4995 \textcolor{keywordtype}{type}(PtrToParticle) :: Particles(:)}
\DoxyCodeLine{4996 \textcolor{keywordtype}{integer} :: i1,i2,j}
\DoxyCodeLine{4997 }
\DoxyCodeLine{4998    summom(1:dv)= (0d0,0d0)}
\DoxyCodeLine{4999    \textcolor{keywordflow}{if} (i2.ge.i1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5000       \textcolor{keywordflow}{do} j=i1,i2}
\DoxyCodeLine{5001          summom(1:dv) = summom(1:dv) + particles(j)\%Mom(1:dv)}
\DoxyCodeLine{5002 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{5003 \textcolor{keywordflow}{   endif}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a0b9541da43e68bf247f4df1f5815eb3b}\label{namespacemodttbhiggs_a0b9541da43e68bf247f4df1f5815eb3b}} 
\index{modttbhiggs@{modttbhiggs}!vbqg@{vbqg}}
\index{vbqg@{vbqg}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{vbqg()}{vbqg()}}
{\footnotesize\ttfamily complex(8) function, dimension(size(sp)) modttbhiggs\+::vbqg (\begin{DoxyParamCaption}\item[{complex(8), dimension(\+:), intent(in)}]{sp,  }\item[{complex(8), dimension(\+:), intent(in)}]{e1 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5593 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5593       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5594       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: e1(:)}
\DoxyCodeLine{5595       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: sp(:)}
\DoxyCodeLine{5596       \textcolor{keywordtype}{complex(8)} :: vbqg(size(sp))}
\DoxyCodeLine{5597 \textcolor{keywordtype}{      real}(8), \textcolor{keywordtype}{parameter} :: sqrt2 = 1.4142135623730950488016887242096980\textcolor{comment}{786d0}}
\DoxyCodeLine{5598 \textcolor{comment}{}}
\DoxyCodeLine{5599           vbqg = (0d0,-\/1d0)/sqrt2*spi2\_(e1,sp)}
\DoxyCodeLine{5600 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_ac3051975f148046a7367290dcdb74ca0}\label{namespacemodttbhiggs_ac3051975f148046a7367290dcdb74ca0}} 
\index{modttbhiggs@{modttbhiggs}!vbqq@{vbqq}}
\index{vbqq@{vbqq}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{vbqq()}{vbqq()}}
{\footnotesize\ttfamily complex(8) function, dimension(4) modttbhiggs\+::vbqq (\begin{DoxyParamCaption}\item[{integer}]{Dummy,  }\item[{complex(8), dimension(1\+:4), intent(in)}]{sp1,  }\item[{complex(8), dimension(1\+:4), intent(in)}]{sp2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5654 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5654       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5655       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: sp1(1:4), sp2(1:4)}
\DoxyCodeLine{5656       \textcolor{keywordtype}{integer} :: i,Dummy}
\DoxyCodeLine{5657       \textcolor{keywordtype}{complex(8)} :: vbqq(4)}
\DoxyCodeLine{5658       \textcolor{keywordtype}{complex(8)} :: sp1a(4)}
\DoxyCodeLine{5659 \textcolor{keywordtype}{      real}(8) :: va(1:4,1:4)}
\DoxyCodeLine{5660 \textcolor{keywordtype}{      real}(8), \textcolor{keywordtype}{parameter} :: sqrt2 = 1.4142135623730950488016887242096980\textcolor{comment}{786d0}}
\DoxyCodeLine{5661 \textcolor{comment}{}}
\DoxyCodeLine{5662          va(1,1:4)=(/+1d0,0d0,0d0,0d0/)}
\DoxyCodeLine{5663          va(2,1:4)=(/0d0,-\/1d0,0d0,0d0/)}
\DoxyCodeLine{5664          va(3,1:4)=(/0d0,0d0,-\/1d0,0d0/)}
\DoxyCodeLine{5665          va(4,1:4)=(/0d0,0d0,0d0,-\/1d0/)}
\DoxyCodeLine{5666 }
\DoxyCodeLine{5667           \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{5668              sp1a=spivl(sp1,dcmplx(va(i,1:4)))}
\DoxyCodeLine{5669              vbqq(i) = (sp1a(1)*sp2(1)+sp1a(2)*sp2(2)+sp1a(3)*sp2(3)+sp1a\textcolor{comment}{(4)*sp2(4)) * (0d0,-\/1d0)/sqrt2}}
\DoxyCodeLine{5670 \textcolor{comment}{}\textcolor{keywordflow}{          enddo}}
\DoxyCodeLine{5671 }
\DoxyCodeLine{5672 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_ae1b6e6df57b28d1e2182621e940e0844}\label{namespacemodttbhiggs_ae1b6e6df57b28d1e2182621e940e0844}} 
\index{modttbhiggs@{modttbhiggs}!vbqv@{vbqv}}
\index{vbqv@{vbqv}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{vbqv()}{vbqv()}}
{\footnotesize\ttfamily complex(8) function, dimension(size(sp)) modttbhiggs\+::vbqv (\begin{DoxyParamCaption}\item[{complex(8), dimension(\+:), intent(in)}]{sp,  }\item[{complex(8), dimension(\+:), intent(in)}]{e1,  }\item[{complex(8), intent(in)}]{coupl\+\_\+left,  }\item[{complex(8), intent(in)}]{coupl\+\_\+right }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5467 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5467       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5468       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: e1(:)}
\DoxyCodeLine{5469       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: sp(:)}
\DoxyCodeLine{5470       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: coupl\_left,coupl\_right}
\DoxyCodeLine{5471       \textcolor{keywordtype}{complex(8)} :: vbqV(size(sp))}
\DoxyCodeLine{5472 }
\DoxyCodeLine{5473 \textcolor{comment}{!            vbqV = -\/(0d0,1d0)*( coupl\_left*Chir(.false.,spb2\_(sp,e1)) + coupl\_right*Chir(.true.,spb2\_(sp,e1)) )}}
\DoxyCodeLine{5474            vbqv = -\/(0d0,1d0)*( coupl\_left*chir(.false.,sp) + coupl\_right\textcolor{comment}{*chir(.true.,sp) )}}
\DoxyCodeLine{5475 \textcolor{comment}{}}
\DoxyCodeLine{5476       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_aeca72a3609fdd110519e863051ae0f41}\label{namespacemodttbhiggs_aeca72a3609fdd110519e863051ae0f41}} 
\index{modttbhiggs@{modttbhiggs}!vgbq@{vgbq}}
\index{vgbq@{vgbq}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{vgbq()}{vgbq()}}
{\footnotesize\ttfamily complex(8) function, dimension(size(sp)) modttbhiggs\+::vgbq (\begin{DoxyParamCaption}\item[{complex(8), dimension(\+:), intent(in)}]{e1,  }\item[{complex(8), dimension(\+:), intent(in)}]{sp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5606 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5606       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5607       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: e1(:)}
\DoxyCodeLine{5608       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: sp(:)}
\DoxyCodeLine{5609       \textcolor{keywordtype}{complex(8)} :: vgbq(size(sp))}
\DoxyCodeLine{5610 \textcolor{keywordtype}{      real}(8), \textcolor{keywordtype}{parameter} :: sqrt2 = 1.4142135623730950488016887242096980\textcolor{comment}{786d0}}
\DoxyCodeLine{5611 \textcolor{comment}{}}
\DoxyCodeLine{5612           vgbq = (0d0,1d0)/sqrt2*spi2\_(e1,sp)}
\DoxyCodeLine{5613 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a48cd166d20e787937992441341647c89}\label{namespacemodttbhiggs_a48cd166d20e787937992441341647c89}} 
\index{modttbhiggs@{modttbhiggs}!vggg@{vggg}}
\index{vggg@{vggg}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{vggg()}{vggg()}}
{\footnotesize\ttfamily complex(8) function, dimension(size(e1)) modttbhiggs\+::vggg (\begin{DoxyParamCaption}\item[{complex(8), dimension(\+:), intent(in)}]{e1,  }\item[{complex(8), dimension(\+:), intent(in)}]{k1,  }\item[{complex(8), dimension(\+:), intent(in)}]{e2,  }\item[{complex(8), dimension(\+:), intent(in)}]{k2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5532 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5532       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5533       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: e1(:), e2(:)}
\DoxyCodeLine{5534       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: k1(:), k2(:)}
\DoxyCodeLine{5535       \textcolor{keywordtype}{complex(8)}             :: vggg(size(e1))}
\DoxyCodeLine{5536       \textcolor{keywordtype}{complex(8)}:: sk1e2,se1e2,sk2e1,xx}
\DoxyCodeLine{5537 \textcolor{keywordtype}{      real}(8), \textcolor{keywordtype}{parameter} :: sqrt2 = 1.4142135623730950488016887242096980\textcolor{comment}{786d0}}
\DoxyCodeLine{5538 \textcolor{comment}{}}
\DoxyCodeLine{5539 }
\DoxyCodeLine{5540           sk1e2=sc\_(k1,e2)}
\DoxyCodeLine{5541           sk2e1=sc\_(k2,e1)}
\DoxyCodeLine{5542           se1e2=sc\_(e1,e2)}
\DoxyCodeLine{5543           xx=(0.0d0,1.0d0)*sqrt2}
\DoxyCodeLine{5544           vggg = xx*(-\/sk1e2*e1+sk2e1*e2+se1e2/2d0*(k1-\/k2))}
\DoxyCodeLine{5545 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a2ce118a94d782b404e2b1a2ea351c712}\label{namespacemodttbhiggs_a2ce118a94d782b404e2b1a2ea351c712}} 
\index{modttbhiggs@{modttbhiggs}!vgggg@{vgggg}}
\index{vgggg@{vgggg}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{vgggg()}{vgggg()}}
{\footnotesize\ttfamily complex(8) function, dimension(size(e1)) modttbhiggs\+::vgggg (\begin{DoxyParamCaption}\item[{complex(8), dimension(\+:), intent(in)}]{e1,  }\item[{complex(8), dimension(\+:), intent(in)}]{e2,  }\item[{complex(8), dimension(\+:), intent(in)}]{e3 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5550 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5550        \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5551        \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: e1(:),e2(:),e3(:)}
\DoxyCodeLine{5552        \textcolor{keywordtype}{complex(8)}             :: vgggg(size(e1))}
\DoxyCodeLine{5553        \textcolor{keywordtype}{complex(8)}:: se1e3,se2e3,se1e2}
\DoxyCodeLine{5554 }
\DoxyCodeLine{5555           se1e3=sc\_(e1,e3)}
\DoxyCodeLine{5556           se2e3=sc\_(e2,e3)}
\DoxyCodeLine{5557           se1e2=sc\_(e1,e2)}
\DoxyCodeLine{5558           vgggg = (0.0d0,1.0d0)*(e2*se1e3-\/0.5d0*(e1*se2e3+ e3*se1e2))}
\DoxyCodeLine{5559 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_ac4f079809619d88cb2e1b6baeb3f7a6b}\label{namespacemodttbhiggs_ac4f079809619d88cb2e1b6baeb3f7a6b}} 
\index{modttbhiggs@{modttbhiggs}!vgq@{vgq}}
\index{vgq@{vgq}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{vgq()}{vgq()}}
{\footnotesize\ttfamily complex(8) function, dimension(size(sp)) modttbhiggs\+::vgq (\begin{DoxyParamCaption}\item[{complex(8), dimension(\+:), intent(in)}]{e1,  }\item[{complex(8), dimension(\+:), intent(in)}]{sp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5578 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5578       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5579       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: e1(:)}
\DoxyCodeLine{5580       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: sp(:)}
\DoxyCodeLine{5581       \textcolor{keywordtype}{complex(8)} :: vgq(size(sp))}
\DoxyCodeLine{5582 \textcolor{keywordtype}{      real}(8), \textcolor{keywordtype}{parameter} :: sqrt2 = 1.4142135623730950488016887242096980\textcolor{comment}{786d0}}
\DoxyCodeLine{5583 \textcolor{comment}{}}
\DoxyCodeLine{5584           vgq = (0d0,-\/1d0)/sqrt2*spb2\_(sp,e1)}
\DoxyCodeLine{5585 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_ac3c1479d53b579f46ac4c03fb2ecd0d2}\label{namespacemodttbhiggs_ac3c1479d53b579f46ac4c03fb2ecd0d2}} 
\index{modttbhiggs@{modttbhiggs}!vqg@{vqg}}
\index{vqg@{vqg}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{vqg()}{vqg()}}
{\footnotesize\ttfamily complex(8) function, dimension(size(sp)) modttbhiggs\+::vqg (\begin{DoxyParamCaption}\item[{complex(8), dimension(\+:), intent(in)}]{sp,  }\item[{complex(8), dimension(\+:), intent(in)}]{e1 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5564 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5564       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5565       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: e1(:)}
\DoxyCodeLine{5566       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: sp(:)}
\DoxyCodeLine{5567       \textcolor{keywordtype}{complex(8)} :: vqg(size(sp))}
\DoxyCodeLine{5568 \textcolor{keywordtype}{      real}(8), \textcolor{keywordtype}{parameter} :: sqrt2 = 1.4142135623730950488016887242096980\textcolor{comment}{786d0}}
\DoxyCodeLine{5569 \textcolor{comment}{}}
\DoxyCodeLine{5570           vqg = (0d0,1d0)/sqrt2*spb2\_(sp,e1)}
\DoxyCodeLine{5571 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a5b104066b13a69934a51cabea496a60d}\label{namespacemodttbhiggs_a5b104066b13a69934a51cabea496a60d}} 
\index{modttbhiggs@{modttbhiggs}!vvbqq@{vvbqq}}
\index{vvbqq@{vvbqq}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{vvbqq()}{vvbqq()}}
{\footnotesize\ttfamily complex(8) function, dimension(4,4) modttbhiggs\+::vvbqq (\begin{DoxyParamCaption}\item[{complex(8), dimension(\+:), intent(in)}]{sp1,  }\item[{complex(8), dimension(\+:), intent(in)}]{sp2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5679 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5679       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5680       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: sp1(:), sp2(:)}
\DoxyCodeLine{5681       \textcolor{keywordtype}{integer} :: i,j}
\DoxyCodeLine{5682       \textcolor{keywordtype}{complex(8)} :: vvbqq(4,4)}
\DoxyCodeLine{5683       \textcolor{keywordtype}{complex(8)} :: sp1a(4)}
\DoxyCodeLine{5684 \textcolor{keywordtype}{      real}(8) :: va(1:4,1:4)}
\DoxyCodeLine{5685 }
\DoxyCodeLine{5686          va(1,1:4)=(/+1d0,0d0,0d0,0d0/)}
\DoxyCodeLine{5687          va(2,1:4)=(/0d0,-\/1d0,0d0,0d0/)}
\DoxyCodeLine{5688          va(3,1:4)=(/0d0,0d0,-\/1d0,0d0/)}
\DoxyCodeLine{5689          va(4,1:4)=(/0d0,0d0,0d0,-\/1d0/)}
\DoxyCodeLine{5690 }
\DoxyCodeLine{5691          \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{5692           \textcolor{keywordflow}{do} j=1,4}
\DoxyCodeLine{5693              sp1a=spb2\_(sp1, dcmplx(va(i,1:4)))}
\DoxyCodeLine{5694              sp1a=spb2\_(sp1a,dcmplx(va(j,1:4)))}
\DoxyCodeLine{5695              vvbqq(i,j) = \mbox{\hyperlink{namespacemodtopdecay_aac3bf6eedcfd98426e9db80b1e91897c}{psp1\_}}(sp1a,sp2)}
\DoxyCodeLine{5696 \textcolor{keywordflow}{          enddo}}
\DoxyCodeLine{5697 \textcolor{keywordflow}{         enddo}}
\DoxyCodeLine{5698 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a3d24c4cb137f694c79a6b2bf661197ed}\label{namespacemodttbhiggs_a3d24c4cb137f694c79a6b2bf661197ed}} 
\index{modttbhiggs@{modttbhiggs}!vvq@{vvq}}
\index{vvq@{vvq}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{vvq()}{vvq()}}
{\footnotesize\ttfamily complex(8) function, dimension(size(sp)) modttbhiggs\+::vvq (\begin{DoxyParamCaption}\item[{complex(8), dimension(\+:), intent(in)}]{e1,  }\item[{complex(8), dimension(\+:), intent(in)}]{sp,  }\item[{complex(8), intent(in)}]{coupl\+\_\+left,  }\item[{complex(8), intent(in)}]{coupl\+\_\+right }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 5482 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5482       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{5483       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: e1(:)}
\DoxyCodeLine{5484       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: sp(:)}
\DoxyCodeLine{5485       \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(in)} :: coupl\_left,coupl\_right}
\DoxyCodeLine{5486       \textcolor{keywordtype}{complex(8)} :: vVq(size(sp))}
\DoxyCodeLine{5487 }
\DoxyCodeLine{5488 \textcolor{comment}{!            vVq = -\/(0d0,1d0)*( coupl\_left*Chir(.true., spi2\_(e1,sp)) + coupl\_right*Chir(.false., spi2\_(e1,sp)) )}}
\DoxyCodeLine{5489            vvq = -\/(0d0,1d0)*( coupl\_left*chir(.false.,sp) + coupl\_right*chir\textcolor{comment}{(.true.,sp) )}}
\DoxyCodeLine{5490 \textcolor{comment}{}}
\DoxyCodeLine{5491 }
\DoxyCodeLine{5492       \textcolor{keywordflow}{return}}

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacemodttbhiggs_ac443a0bbcc3995d84eb7cebb785ded23}\label{namespacemodttbhiggs_ac443a0bbcc3995d84eb7cebb785ded23}} 
\index{modttbhiggs@{modttbhiggs}!colorlesstag@{colorlesstag}}
\index{colorlesstag@{colorlesstag}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{colorlesstag}{colorlesstag}}
{\footnotesize\ttfamily integer, parameter modttbhiggs\+::colorlesstag = 1\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 11 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{11 \textcolor{keywordtype}{integer},\textcolor{keywordtype}{parameter} :: ColorlessTag = 1}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a52094e1c2f161117f051ce4438845fc3}\label{namespacemodttbhiggs_a52094e1c2f161117f051ce4438845fc3}} 
\index{modttbhiggs@{modttbhiggs}!couplhtt\_left\_dyn@{couplhtt\_left\_dyn}}
\index{couplhtt\_left\_dyn@{couplhtt\_left\_dyn}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{couplhtt\_left\_dyn}{couplhtt\_left\_dyn}}
{\footnotesize\ttfamily complex(8) modttbhiggs\+::couplhtt\+\_\+left\+\_\+dyn\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 66 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.

\mbox{\Hypertarget{namespacemodttbhiggs_a2f0eff3b1324eeeaf015ebcbd94e111b}\label{namespacemodttbhiggs_a2f0eff3b1324eeeaf015ebcbd94e111b}} 
\index{modttbhiggs@{modttbhiggs}!couplhtt\_right\_dyn@{couplhtt\_right\_dyn}}
\index{couplhtt\_right\_dyn@{couplhtt\_right\_dyn}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{couplhtt\_right\_dyn}{couplhtt\_right\_dyn}}
{\footnotesize\ttfamily complex(8) modttbhiggs\+::couplhtt\+\_\+right\+\_\+dyn\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 66 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{66 \textcolor{comment}{complex(8) :: couplHTT\_right\_dyn,couplHTT\_left\_dyn}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}\label{namespacemodttbhiggs_a01abea4828bc903646d14cdaf7a4c5b3}} 
\index{modttbhiggs@{modttbhiggs}!ds@{ds}}
\index{ds@{ds}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{ds}{ds}}
{\footnotesize\ttfamily integer, parameter modttbhiggs\+::ds =4\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 59 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.

\mbox{\Hypertarget{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}\label{namespacemodttbhiggs_a7f6622afac664a5817946dd4ae8037df}} 
\index{modttbhiggs@{modttbhiggs}!dv@{dv}}
\index{dv@{dv}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{dv}{dv}}
{\footnotesize\ttfamily integer, parameter modttbhiggs\+::dv =4\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 59 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{59 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: Dv=4,ds=4}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_ab922587e9b30199ee7eab7c5f37af3f0}\label{namespacemodttbhiggs_ab922587e9b30199ee7eab7c5f37af3f0}} 
\index{modttbhiggs@{modttbhiggs}!extparticles@{extparticles}}
\index{extparticles@{extparticles}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{extparticles}{extparticles}}
{\footnotesize\ttfamily type(\mbox{\hyperlink{structmodttbhiggs_1_1particle}{particle}}), dimension(1\+:7), save modttbhiggs\+::extparticles\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 61 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{61 \textcolor{keywordtype}{type}(Particle),\textcolor{keywordtype}{save}    :: ExtParticles(1:7)}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_abbd7324dda04127446e49c1c30e969c2}\label{namespacemodttbhiggs_abbd7324dda04127446e49c1c30e969c2}} 
\index{modttbhiggs@{modttbhiggs}!propcut@{propcut}}
\index{propcut@{propcut}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{propcut}{propcut}}
{\footnotesize\ttfamily real(8), parameter modttbhiggs\+::propcut = 1.\+0d-\/8\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 58 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{58 \textcolor{keywordtype}{real}(8), \textcolor{keywordtype}{parameter} :: PropCut = 1.0d-\/8}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_abca7fa4f7a865911adc4c444a6926295}\label{namespacemodttbhiggs_abca7fa4f7a865911adc4c444a6926295}} 
\index{modttbhiggs@{modttbhiggs}!thetreeamps\_gg\_ttbh@{thetreeamps\_gg\_ttbh}}
\index{thetreeamps\_gg\_ttbh@{thetreeamps\_gg\_ttbh}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{thetreeamps\_gg\_ttbh}{thetreeamps\_gg\_ttbh}}
{\footnotesize\ttfamily type(\mbox{\hyperlink{structmodttbhiggs_1_1treeprocess}{treeprocess}}), dimension(1\+:2), save modttbhiggs\+::thetreeamps\+\_\+gg\+\_\+ttbh\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 62 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{62 \textcolor{keywordtype}{type}(TreeProcess),\textcolor{keywordtype}{save} :: TheTreeAmps\_GG\_TTBH(1:2)}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodttbhiggs_a1f8089d51466581a31c1b6b62e861282}\label{namespacemodttbhiggs_a1f8089d51466581a31c1b6b62e861282}} 
\index{modttbhiggs@{modttbhiggs}!thetreeamps\_qqb\_ttbh@{thetreeamps\_qqb\_ttbh}}
\index{thetreeamps\_qqb\_ttbh@{thetreeamps\_qqb\_ttbh}!modttbhiggs@{modttbhiggs}}
\doxysubsubsection{\texorpdfstring{thetreeamps\_qqb\_ttbh}{thetreeamps\_qqb\_ttbh}}
{\footnotesize\ttfamily type(\mbox{\hyperlink{structmodttbhiggs_1_1treeprocess}{treeprocess}}), dimension(1\+:1), save modttbhiggs\+::thetreeamps\+\_\+qqb\+\_\+ttbh\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 63 of file mod\+\_\+\+T\+T\+B\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{63 \textcolor{keywordtype}{type}(TreeProcess),\textcolor{keywordtype}{save} :: TheTreeAmps\_QQB\_TTBH(1:1)}

\end{DoxyCode}
