\hypertarget{BuildTensors_8F90}{}\doxysection{M\+E\+L\+A/\+C\+O\+L\+L\+I\+E\+R/colliertmp/\+C\+O\+L\+L\+I\+E\+R-\/1.2/src/tensors/\+Build\+Tensors.F90 File Reference}
\label{BuildTensors_8F90}\index{MELA/COLLIER/colliertmp/COLLIER-\/1.2/src/tensors/BuildTensors.F90@{MELA/COLLIER/colliertmp/COLLIER-\/1.2/src/tensors/BuildTensors.F90}}
\doxysubsection*{Modules}
\begin{DoxyCompactItemize}
\item 
module \mbox{\hyperlink{namespacebuildtensors}{buildtensors}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_a97c7a9c15e9607157ea0e30c7cea7bde}{buildtensors\+::calctensora\+\_\+list}} (TA, T\+Auv, T\+Aerr, CoefsA, Coefs\+Auv, Coefs\+Aerr, rmax)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_a04f53a09d400f09a383c753ec6bd4728}{buildtensors\+::calctensora}} (TA, T\+Auv, T\+Aerr, CoefsA, Coefs\+Auv, Coefs\+Aerr, rmax)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_aee7c1c86d8ac8e91a60ad33637065c5c}{buildtensors\+::calctensorb\+\_\+list}} (TB, T\+Buv, T\+Berr, CoefsB, Coefs\+Buv, Coefs\+Berr, mom, rmax)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_a20e29352ba11d5b26c6801d18321ec69}{buildtensors\+::calctensorb}} (TB, T\+Buv, T\+Berr, CoefsB, Coefs\+Buv, Coefs\+Berr, mom, rmax)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_af8accf70e84867282dc6dadc394b2bbd}{buildtensors\+::calctensorc\+\_\+list}} (TC, T\+Cuv, T\+Cerr, CoefsC, Coefs\+Cuv, Coefs\+Cerr, Mom\+Vec, rmax)
\item 
recursive subroutine \mbox{\hyperlink{BuildTensors_8F90_a7c4c0b781caefd650fc108cba1410881}{addtotensorc}} (r, Mom\+Ten\+Rec, Inds\+Coef)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_aadb87aa847c62fe0d2cfbaab5449a483}{buildtensors\+::calctensorc}} (TC, T\+Cuv, T\+Cerr, CoefsC, Coefs\+Cuv, Coefs\+Cerr, Mom\+Vec, rmax)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_aae01380ddec96c9269985609ea07a5be}{buildtensors\+::calctensord\+\_\+list}} (TD, T\+Duv, T\+Derr, CoefsD, Coefs\+Duv, Coefs\+Derr, Mom\+Vec, rmax)
\item 
recursive subroutine \mbox{\hyperlink{BuildTensors_8F90_ae4a18d2e6831435301ba0904bba91ca1}{addtotensord}} (Mom\+Ten\+Rec, Inds\+Coef, r)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_a51a1633784664f84db15c863aee8a364}{buildtensors\+::calctensord}} (TD, T\+Duv, T\+Derr, CoefsD, Coefs\+Duv, Coefs\+Derr, Mom\+Vec, rmax)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_ae494340edd37dc2aae70ac4092799240}{buildtensors\+::calctensore\+\_\+list}} (TE, T\+Euv, T\+Eerr, CoefsE, Coefs\+Euv, Coefs\+Eerr, Mom\+Vec, rmax)
\item 
recursive subroutine \mbox{\hyperlink{BuildTensors_8F90_a0217108bc9dab87941563778a2daf95a}{addtotensore}} (Mom\+Ten\+Rec, Inds\+Coef, r)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_a90bab531e5c7293311bc95f3d72cbca5}{buildtensors\+::calctensore}} (TE, T\+Euv, T\+Eerr, CoefsE, Coefs\+Euv, Coefs\+Eerr, Mom\+Vec, rmax)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_a552266b900a0499d1be36c05cb89959c}{buildtensors\+::calctensorf\+\_\+list}} (TF, T\+Fuv, T\+Ferr, CoefsF, Coefs\+Fuv, Coefs\+Ferr, Mom\+Vec, rmax)
\item 
recursive subroutine \mbox{\hyperlink{BuildTensors_8F90_abb975fc3ee69b3d13c424f2a93b2b6e4}{addtotensorf}} (Mom\+Ten\+Rec, Inds\+Coef, r)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_a8dcef7bd432d2e5cae2043e462003677}{buildtensors\+::calctensorf}} (TF, T\+Fuv, T\+Ferr, CoefsF, Coefs\+Fuv, Coefs\+Ferr, Mom\+Vec, rmax)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_a8ac5912ff6933d6897226360cdc8023b}{buildtensors\+::calctensorfuv\+\_\+list}} (T\+Fuv, Coefs\+Fuv, Mom\+Vec, rmax)
\item 
recursive subroutine \mbox{\hyperlink{BuildTensors_8F90_a475fe133131af7fd9e18f7024369b7c0}{addtotensorfuv}} (Mom\+Ten\+Rec, Inds\+Coef, r)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_a6b3aedf5473a517d4c60408202a28f56}{buildtensors\+::calctensorfuv}} (T\+Fuv, Coefs\+Fuv, Mom\+Vec, rmax)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_ae2ca3fbc69a23ec27c309e8c6562ef1d}{buildtensors\+::calctensorg\+\_\+list}} (TG, T\+Guv, T\+Gerr, CoefsG, Coefs\+Guv, Coefs\+Gerr, Mom\+Vec, rmax)
\item 
recursive subroutine \mbox{\hyperlink{BuildTensors_8F90_a89dcfe8371c893086d1e25ae13bc0f35}{addtotensorg}} (Mom\+Ten\+Rec, Inds\+Coef, r)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_ab80eef54b52d17086ce3dccfd9d73fed}{buildtensors\+::calctensorg}} (TG, T\+Guv, T\+Gerr, CoefsG, Coefs\+Guv, Coefs\+Gerr, Mom\+Vec, rmax)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_ab4692b0ec7e4d4449e9be5581d03730f}{buildtensors\+::calctensortn\+\_\+list}} (TN, T\+Nuv, T\+Nerr, CoefsN, Coefs\+Nuv, Coefs\+Nerr, Mom\+Vec, N, rmax)
\item 
recursive subroutine \mbox{\hyperlink{BuildTensors_8F90_a2043de598d9c295da0e8aaa4b2140ccd}{addtotensortn}} (Mom\+Ten\+Rec, ind, r)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_a45b96b15b3bed8d368476c3dc02f0742}{buildtensors\+::calctensortn}} (TN, T\+Nuv, T\+Nerr, CoefsN, Coefs\+Nuv, Coefs\+Nerr, Mom\+Vec, N, rmax)
\item 
subroutine \mbox{\hyperlink{namespacebuildtensors_ab1394e89c4c4c530deb2f7a194ee2c76}{buildtensors\+::calctensortnuv\+\_\+list}} (T\+Nuv, Coefs\+Nuv, Mom\+Vec, N, rmax)
\item 
recursive subroutine \mbox{\hyperlink{BuildTensors_8F90_a92d726665618c51b5f6048d00d741458}{addtotensortnuv}} (Mom\+Ten\+Rec, ind, r)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{BuildTensors_8F90_a7c4c0b781caefd650fc108cba1410881}\label{BuildTensors_8F90_a7c4c0b781caefd650fc108cba1410881}} 
\index{BuildTensors.F90@{BuildTensors.F90}!addtotensorc@{addtotensorc}}
\index{addtotensorc@{addtotensorc}!BuildTensors.F90@{BuildTensors.F90}}
\doxysubsubsection{\texorpdfstring{addtotensorc()}{addtotensorc()}}
{\footnotesize\ttfamily recursive subroutine calctensorc\+\_\+list\+::addtotensorc (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{r,  }\item[{double complex, dimension(rts(\mbox{\hyperlink{TMCFM_8hh_a5cdce5291514a56d7755cff3fc4750c1}{r}})), intent(in)}]{Mom\+Ten\+Rec,  }\item[{integer, dimension(2), intent(inout)}]{Inds\+Coef }\end{DoxyParamCaption})}



Definition at line 334 of file Build\+Tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{334 }
\DoxyCodeLine{335       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: r}
\DoxyCodeLine{336       \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomTenRec(RtS(r))}
\DoxyCodeLine{337       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(inout)} :: IndsCoef(2)}
\DoxyCodeLine{338       \textcolor{keywordtype}{double complex} :: MomTen(RtS(r+1)), CC, Pmu}
\DoxyCodeLine{339       \textcolor{keywordtype}{integer} :: mu1,mu2,nsum,mu,nu,i,a,cnt}
\DoxyCodeLine{340 }
\DoxyCodeLine{341       cc = coefsc(0,indscoef(1),indscoef(2))}
\DoxyCodeLine{342 }
\DoxyCodeLine{343       mu1 = rts(r-\/1)+1}
\DoxyCodeLine{344       mu2 = rts(r)}
\DoxyCodeLine{345 }
\DoxyCodeLine{346       tc(mu1:mu2) = tc(mu1:mu2) + cc*momtenrec(mu1:mu2)}
\DoxyCodeLine{347 }
\DoxyCodeLine{348       \textcolor{keywordflow}{do} nsum=1,(rmax-\/r)/2}
\DoxyCodeLine{349         cc = coefsc(nsum,indscoef(1),indscoef(2))}
\DoxyCodeLine{350       }
\DoxyCodeLine{351         \textcolor{keywordflow}{do} nu=rts(nsum-\/1)+1,rts(nsum)}
\DoxyCodeLine{352           \textcolor{keywordflow}{do} mu=mu1,mu2}
\DoxyCodeLine{353             tc(addgtab(mu,nu)) = tc(addgtab(mu,nu)) + cc*momtenrec(mu)*cftab\textcolor{comment}{(mu,nu)}}
\DoxyCodeLine{354 \textcolor{comment}{}\textcolor{keywordflow}{          end do}}
\DoxyCodeLine{355 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{356 }
\DoxyCodeLine{357 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{358 }
\DoxyCodeLine{359       \textcolor{keywordflow}{if} (calcuv\_ten) \textcolor{keywordflow}{then}}
\DoxyCodeLine{360 \textcolor{comment}{!        CC = CoefsCuv(0,IndsCoef(1),IndsCoef(2))}}
\DoxyCodeLine{361 }
\DoxyCodeLine{362 \textcolor{comment}{!        TCuv(mu1:mu2) = TCuv(mu1:mu2) + CC*MomTenRec(mu1:mu2)}}
\DoxyCodeLine{363 }
\DoxyCodeLine{364         \textcolor{keywordflow}{do} nsum=1,(rmax-\/r)/2}
\DoxyCodeLine{365           cc = coefscuv(nsum,indscoef(1),indscoef(2))}
\DoxyCodeLine{366       }
\DoxyCodeLine{367           \textcolor{keywordflow}{do} nu=rts(nsum-\/1)+1,rts(nsum)}
\DoxyCodeLine{368             \textcolor{keywordflow}{do} mu=mu1,mu2}
\DoxyCodeLine{369               tcuv(addgtab(mu,nu)) = tcuv(addgtab(mu,nu)) + cc*momtenrec\textcolor{comment}{(mu)*cftab(mu,nu)}}
\DoxyCodeLine{370 \textcolor{comment}{}\textcolor{keywordflow}{            end do}}
\DoxyCodeLine{371 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{372 }
\DoxyCodeLine{373 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{374 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{375 }
\DoxyCodeLine{376         }
\DoxyCodeLine{377       \textcolor{keywordflow}{if} (r.lt.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{378 }
\DoxyCodeLine{379         \textcolor{keywordflow}{do} i=1,2}
\DoxyCodeLine{380           indscoef(i) = indscoef(i)+1}
\DoxyCodeLine{381 }
\DoxyCodeLine{382           cnt = mu2+1}
\DoxyCodeLine{383           \textcolor{keywordflow}{do} mu=0,3}
\DoxyCodeLine{384             pmu = momvec(mu,i)}
\DoxyCodeLine{385             \textcolor{keywordflow}{do} a = mu2-\/binomtable(r,r+3-\/mu)+1,mu2}
\DoxyCodeLine{386               momten(cnt)=momtenrec(a)*pmu}
\DoxyCodeLine{387               cnt = cnt+1}
\DoxyCodeLine{388 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{389 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{390 }
\DoxyCodeLine{391           \textcolor{keyword}{call }\mbox{\hyperlink{BuildTensors_8F90_a7c4c0b781caefd650fc108cba1410881}{addtotensorc}}(r+1,momten,indscoef)}
\DoxyCodeLine{392 }
\DoxyCodeLine{393           indscoef(i) = indscoef(i)-\/1}
\DoxyCodeLine{394 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{395 }
\DoxyCodeLine{396 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{397 }

\end{DoxyCode}
\mbox{\Hypertarget{BuildTensors_8F90_ae4a18d2e6831435301ba0904bba91ca1}\label{BuildTensors_8F90_ae4a18d2e6831435301ba0904bba91ca1}} 
\index{BuildTensors.F90@{BuildTensors.F90}!addtotensord@{addtotensord}}
\index{addtotensord@{addtotensord}!BuildTensors.F90@{BuildTensors.F90}}
\doxysubsubsection{\texorpdfstring{addtotensord()}{addtotensord()}}
{\footnotesize\ttfamily recursive subroutine calctensord\+\_\+list\+::addtotensord (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(\mbox{\hyperlink{TMCFM_8hh_a5cdce5291514a56d7755cff3fc4750c1}{r}})), intent(in)}]{Mom\+Ten\+Rec,  }\item[{integer, dimension(3), intent(inout)}]{Inds\+Coef,  }\item[{integer, intent(in)}]{r }\end{DoxyParamCaption})}



Definition at line 525 of file Build\+Tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{525 }
\DoxyCodeLine{526       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: r}
\DoxyCodeLine{527       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(inout)} :: IndsCoef(3)}
\DoxyCodeLine{528       \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomTenRec(RtS(r))}
\DoxyCodeLine{529       \textcolor{keywordtype}{double complex} :: MomTen(RtS(r+1)), CD, Pmu}
\DoxyCodeLine{530       \textcolor{keywordtype}{integer} :: mu1,mu2,nsum,mu,nu,i,a,cnt}
\DoxyCodeLine{531 }
\DoxyCodeLine{532       cd = coefsd(0,indscoef(1),indscoef(2),indscoef(3))}
\DoxyCodeLine{533 }
\DoxyCodeLine{534       mu1 = rts(r-\/1)+1}
\DoxyCodeLine{535       mu2 = rts(r)}
\DoxyCodeLine{536 }
\DoxyCodeLine{537       td(mu1:mu2) = td(mu1:mu2) + cd*momtenrec(mu1:mu2)}
\DoxyCodeLine{538 }
\DoxyCodeLine{539       \textcolor{keywordflow}{do} nsum=1,(rmax-\/r)/2}
\DoxyCodeLine{540         cd = coefsd(nsum,indscoef(1),indscoef(2),indscoef(3))}
\DoxyCodeLine{541       }
\DoxyCodeLine{542         \textcolor{keywordflow}{do} nu=rts(nsum-\/1)+1,rts(nsum)}
\DoxyCodeLine{543           \textcolor{keywordflow}{do} mu=mu1,mu2}
\DoxyCodeLine{544             td(addgtab(mu,nu)) = td(addgtab(mu,nu)) + cd*momtenrec(mu)*cftab\textcolor{comment}{(mu,nu)}}
\DoxyCodeLine{545 \textcolor{comment}{}\textcolor{keywordflow}{          end do}}
\DoxyCodeLine{546 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{547 }
\DoxyCodeLine{548 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{549 }
\DoxyCodeLine{550       \textcolor{keywordflow}{if} (calcuv\_ten) \textcolor{keywordflow}{then}}
\DoxyCodeLine{551 \textcolor{comment}{!        CD = CoefsDuv(0,IndsCoef(1),IndsCoef(2),IndsCoef(3))}}
\DoxyCodeLine{552 }
\DoxyCodeLine{553 \textcolor{comment}{!        TDuv(mu1:mu2) = TDuv(mu1:mu2) + CD*MomTenRec(mu1:mu2)}}
\DoxyCodeLine{554 }
\DoxyCodeLine{555 \textcolor{comment}{!        do nsum=1,(rmax-\/r)/2}}
\DoxyCodeLine{556         \textcolor{keywordflow}{do} nsum=2,(rmax-\/r)/2}
\DoxyCodeLine{557           cd = coefsduv(nsum,indscoef(1),indscoef(2),indscoef(3))}
\DoxyCodeLine{558       }
\DoxyCodeLine{559           \textcolor{keywordflow}{do} nu=rts(nsum-\/1)+1,rts(nsum)}
\DoxyCodeLine{560             \textcolor{keywordflow}{do} mu=mu1,mu2}
\DoxyCodeLine{561               tduv(addgtab(mu,nu)) = tduv(addgtab(mu,nu))  \&}
\DoxyCodeLine{562                                    + cd*momtenrec(mu)*cftab(mu,nu)}
\DoxyCodeLine{563 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{564 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{565 }
\DoxyCodeLine{566 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{567 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{568 }
\DoxyCodeLine{569         }
\DoxyCodeLine{570       \textcolor{keywordflow}{if} (r.lt.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{571 }
\DoxyCodeLine{572         \textcolor{keywordflow}{do} i=1,3}
\DoxyCodeLine{573           indscoef(i) = indscoef(i)+1}
\DoxyCodeLine{574 }
\DoxyCodeLine{575           cnt = mu2+1}
\DoxyCodeLine{576           \textcolor{keywordflow}{do} mu=0,3}
\DoxyCodeLine{577             pmu = momvec(mu,i)}
\DoxyCodeLine{578             \textcolor{keywordflow}{do} a = mu2-\/binomtable(r,r+3-\/mu)+1,mu2}
\DoxyCodeLine{579               momten(cnt)=momtenrec(a)*pmu}
\DoxyCodeLine{580               cnt = cnt+1}
\DoxyCodeLine{581 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{582 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{583 }
\DoxyCodeLine{584           \textcolor{keyword}{call }\mbox{\hyperlink{BuildTensors_8F90_ae4a18d2e6831435301ba0904bba91ca1}{addtotensord}}(momten,indscoef,r+1)}
\DoxyCodeLine{585 }
\DoxyCodeLine{586           indscoef(i) = indscoef(i)-\/1}
\DoxyCodeLine{587 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{588 }
\DoxyCodeLine{589 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{590 }

\end{DoxyCode}
\mbox{\Hypertarget{BuildTensors_8F90_a0217108bc9dab87941563778a2daf95a}\label{BuildTensors_8F90_a0217108bc9dab87941563778a2daf95a}} 
\index{BuildTensors.F90@{BuildTensors.F90}!addtotensore@{addtotensore}}
\index{addtotensore@{addtotensore}!BuildTensors.F90@{BuildTensors.F90}}
\doxysubsubsection{\texorpdfstring{addtotensore()}{addtotensore()}}
{\footnotesize\ttfamily recursive subroutine calctensore\+\_\+list\+::addtotensore (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(\mbox{\hyperlink{TMCFM_8hh_a5cdce5291514a56d7755cff3fc4750c1}{r}})), intent(in)}]{Mom\+Ten\+Rec,  }\item[{integer, dimension(4), intent(inout)}]{Inds\+Coef,  }\item[{integer, intent(in)}]{r }\end{DoxyParamCaption})}



Definition at line 722 of file Build\+Tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{722 }
\DoxyCodeLine{723       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: r}
\DoxyCodeLine{724       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(inout)} :: IndsCoef(4)}
\DoxyCodeLine{725       \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomTenRec(RtS(r))}
\DoxyCodeLine{726       \textcolor{keywordtype}{double complex} :: MomTen(RtS(r+1)), CE, Pmu}
\DoxyCodeLine{727       \textcolor{keywordtype}{double precision} :: CEmax}
\DoxyCodeLine{728       \textcolor{keywordtype}{integer} :: mu1,mu2,nsum,mu,nu,i,a,cnt}
\DoxyCodeLine{729 }
\DoxyCodeLine{730       ce = coefse(0,indscoef(1),indscoef(2),indscoef(3),indscoef(4))}
\DoxyCodeLine{731       cemax = abs(ce)    \textcolor{comment}{! abs(CoefsE(0,0,0,0,0))}}
\DoxyCodeLine{732       }
\DoxyCodeLine{733       mu1 = rts(r-\/1)+1}
\DoxyCodeLine{734       mu2 = rts(r)}
\DoxyCodeLine{735 }
\DoxyCodeLine{736       te(mu1:mu2) = te(mu1:mu2) + ce*momtenrec(mu1:mu2)}
\DoxyCodeLine{737 }
\DoxyCodeLine{738       \textcolor{keywordflow}{do} nsum=1,(rmax-\/r)/2}
\DoxyCodeLine{739         ce = coefse(nsum,indscoef(1),indscoef(2),indscoef(3),indscoef(4)\textcolor{comment}{)}}
\DoxyCodeLine{740 \textcolor{comment}{}      }
\DoxyCodeLine{741         \textcolor{keywordflow}{do} nu=rts(nsum-\/1)+1,rts(nsum)}
\DoxyCodeLine{742           \textcolor{keywordflow}{do} mu=mu1,mu2}
\DoxyCodeLine{743             te(addgtab(mu,nu)) = te(addgtab(mu,nu)) + ce*momtenrec(mu)*cftab\textcolor{comment}{(mu,nu)}}
\DoxyCodeLine{744 \textcolor{comment}{}\textcolor{keywordflow}{          end do}}
\DoxyCodeLine{745 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{746 }
\DoxyCodeLine{747 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{748 }
\DoxyCodeLine{749       \textcolor{keywordflow}{if} (calcuv\_ten) \textcolor{keywordflow}{then}}
\DoxyCodeLine{750 \textcolor{comment}{!        CE = CoefsEuv(0,IndsCoef(1),IndsCoef(2),IndsCoef(3),IndsCoef(4))}}
\DoxyCodeLine{751 }
\DoxyCodeLine{752 \textcolor{comment}{!        TEuv(mu1:mu2) = TEuv(mu1:mu2) + CE*MomTenRec(mu1:mu2)}}
\DoxyCodeLine{753 }
\DoxyCodeLine{754 \textcolor{comment}{!        do nsum=1,(rmax-\/r)/2}}
\DoxyCodeLine{755         \textcolor{keywordflow}{do} nsum=1,(rmax-\/r)/2}
\DoxyCodeLine{756           ce = coefseuv(nsum,indscoef(1),indscoef(2),indscoef(3),indscoef\textcolor{comment}{(4))}}
\DoxyCodeLine{757 \textcolor{comment}{}      }
\DoxyCodeLine{758           \textcolor{keywordflow}{do} nu=rts(nsum-\/1)+1,rts(nsum)}
\DoxyCodeLine{759             \textcolor{keywordflow}{do} mu=mu1,mu2}
\DoxyCodeLine{760               teuv(addgtab(mu,nu)) = teuv(addgtab(mu,nu))  \&}
\DoxyCodeLine{761                                    + ce*momtenrec(mu)*cftab(mu,nu)}
\DoxyCodeLine{762 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{763 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{764 }
\DoxyCodeLine{765 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{766 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{767 }
\DoxyCodeLine{768         }
\DoxyCodeLine{769       \textcolor{keywordflow}{if} (r.lt.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{770 }
\DoxyCodeLine{771         \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{772           indscoef(i) = indscoef(i)+1}
\DoxyCodeLine{773 }
\DoxyCodeLine{774           cnt = mu2+1}
\DoxyCodeLine{775           \textcolor{keywordflow}{do} mu=0,3}
\DoxyCodeLine{776             pmu = momvec(mu,i)}
\DoxyCodeLine{777             \textcolor{keywordflow}{do} a = mu2-\/binomtable(r,r+3-\/mu)+1,mu2}
\DoxyCodeLine{778               momten(cnt)=momtenrec(a)*pmu}
\DoxyCodeLine{779               cnt = cnt+1}
\DoxyCodeLine{780 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{781 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{782 }
\DoxyCodeLine{783           \textcolor{keyword}{call }\mbox{\hyperlink{BuildTensors_8F90_a0217108bc9dab87941563778a2daf95a}{addtotensore}}(momten,indscoef,r+1)}
\DoxyCodeLine{784 }
\DoxyCodeLine{785           indscoef(i) = indscoef(i)-\/1}
\DoxyCodeLine{786 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{787 }
\DoxyCodeLine{788 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{789 }

\end{DoxyCode}
\mbox{\Hypertarget{BuildTensors_8F90_abb975fc3ee69b3d13c424f2a93b2b6e4}\label{BuildTensors_8F90_abb975fc3ee69b3d13c424f2a93b2b6e4}} 
\index{BuildTensors.F90@{BuildTensors.F90}!addtotensorf@{addtotensorf}}
\index{addtotensorf@{addtotensorf}!BuildTensors.F90@{BuildTensors.F90}}
\doxysubsubsection{\texorpdfstring{addtotensorf()}{addtotensorf()}}
{\footnotesize\ttfamily recursive subroutine calctensorf\+\_\+list\+::addtotensorf (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(\mbox{\hyperlink{TMCFM_8hh_a5cdce5291514a56d7755cff3fc4750c1}{r}})), intent(in)}]{Mom\+Ten\+Rec,  }\item[{integer, dimension(5), intent(inout)}]{Inds\+Coef,  }\item[{integer, intent(in)}]{r }\end{DoxyParamCaption})}



Definition at line 924 of file Build\+Tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{924 }
\DoxyCodeLine{925       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: r}
\DoxyCodeLine{926       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(inout)} :: IndsCoef(5)}
\DoxyCodeLine{927       \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomTenRec(RtS(r))}
\DoxyCodeLine{928       \textcolor{keywordtype}{double complex} :: MomTen(RtS(r+1)), CF, Pmu}
\DoxyCodeLine{929       \textcolor{keywordtype}{integer} :: mu1,mu2,nsum,mu,nu,i,a,cnt}
\DoxyCodeLine{930 }
\DoxyCodeLine{931       cf = coefsf(0,indscoef(1),indscoef(2),indscoef(3),indscoef(4),indscoef\textcolor{comment}{(5))}}
\DoxyCodeLine{932 \textcolor{comment}{}}
\DoxyCodeLine{933       mu1 = rts(r-\/1)+1}
\DoxyCodeLine{934       mu2 = rts(r)}
\DoxyCodeLine{935 }
\DoxyCodeLine{936       tf(mu1:mu2) = tf(mu1:mu2) + cf*momtenrec(mu1:mu2) }
\DoxyCodeLine{937 }
\DoxyCodeLine{938       \textcolor{keywordflow}{do} nsum=1,(rmax-\/r)/2}
\DoxyCodeLine{939         cf = coefsf(nsum,indscoef(1),indscoef(2),indscoef(3),indscoef(4)\textcolor{comment}{,indscoef(5))}}
\DoxyCodeLine{940 \textcolor{comment}{}      }
\DoxyCodeLine{941         \textcolor{keywordflow}{do} nu=rts(nsum-\/1)+1,rts(nsum)}
\DoxyCodeLine{942           \textcolor{keywordflow}{do} mu=mu1,mu2}
\DoxyCodeLine{943             tf(addgtab(mu,nu)) = tf(addgtab(mu,nu)) + cf*momtenrec(mu)*cftab\textcolor{comment}{(mu,nu)}}
\DoxyCodeLine{944 \textcolor{comment}{}\textcolor{keywordflow}{          end do}}
\DoxyCodeLine{945 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{946 }
\DoxyCodeLine{947 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{948 }
\DoxyCodeLine{949       \textcolor{keywordflow}{if} (calcuv\_ten) \textcolor{keywordflow}{then}}
\DoxyCodeLine{950 \textcolor{comment}{!        CF = CoefsFuv(0,IndsCoef(1),IndsCoef(2),IndsCoef(3),IndsCoef(4),IndsCoef(5))}}
\DoxyCodeLine{951 }
\DoxyCodeLine{952 \textcolor{comment}{!        TFuv(mu1:mu2) = TFuv(mu1:mu2) + CF*MomTenRec(mu1:mu2)}}
\DoxyCodeLine{953 }
\DoxyCodeLine{954 \textcolor{comment}{!        do nsum=1,(rmax-\/r)/2}}
\DoxyCodeLine{955         \textcolor{keywordflow}{do} nsum=4,(rmax-\/r)/2}
\DoxyCodeLine{956           cf = coefsfuv(nsum,indscoef(1),indscoef(2),indscoef(3),indscoef\textcolor{comment}{(4),indscoef(5))}}
\DoxyCodeLine{957 \textcolor{comment}{}      }
\DoxyCodeLine{958           \textcolor{keywordflow}{do} nu=rts(nsum-\/1)+1,rts(nsum)}
\DoxyCodeLine{959             \textcolor{keywordflow}{do} mu=mu1,mu2}
\DoxyCodeLine{960               tfuv(addgtab(mu,nu)) = tfuv(addgtab(mu,nu))  \&}
\DoxyCodeLine{961                                    + cf*momtenrec(mu)*cftab(mu,nu)}
\DoxyCodeLine{962 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{963 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{964 }
\DoxyCodeLine{965 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{966 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{967 }
\DoxyCodeLine{968         }
\DoxyCodeLine{969       \textcolor{keywordflow}{if} (r.lt.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{970 }
\DoxyCodeLine{971         \textcolor{keywordflow}{do} i=1,5}
\DoxyCodeLine{972           indscoef(i) = indscoef(i)+1}
\DoxyCodeLine{973 }
\DoxyCodeLine{974           cnt = mu2+1}
\DoxyCodeLine{975           \textcolor{keywordflow}{do} mu=0,3}
\DoxyCodeLine{976             pmu = momvec(mu,i)}
\DoxyCodeLine{977             \textcolor{keywordflow}{do} a = mu2-\/binomtable(r,r+3-\/mu)+1,mu2}
\DoxyCodeLine{978               momten(cnt)=momtenrec(a)*pmu}
\DoxyCodeLine{979               cnt = cnt+1}
\DoxyCodeLine{980 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{981 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{982 }
\DoxyCodeLine{983           \textcolor{keyword}{call }\mbox{\hyperlink{BuildTensors_8F90_abb975fc3ee69b3d13c424f2a93b2b6e4}{addtotensorf}}(momten,indscoef,r+1)}
\DoxyCodeLine{984 }
\DoxyCodeLine{985           indscoef(i) = indscoef(i)-\/1}
\DoxyCodeLine{986 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{987 }
\DoxyCodeLine{988 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{989 }

\end{DoxyCode}
\mbox{\Hypertarget{BuildTensors_8F90_a475fe133131af7fd9e18f7024369b7c0}\label{BuildTensors_8F90_a475fe133131af7fd9e18f7024369b7c0}} 
\index{BuildTensors.F90@{BuildTensors.F90}!addtotensorfuv@{addtotensorfuv}}
\index{addtotensorfuv@{addtotensorfuv}!BuildTensors.F90@{BuildTensors.F90}}
\doxysubsubsection{\texorpdfstring{addtotensorfuv()}{addtotensorfuv()}}
{\footnotesize\ttfamily recursive subroutine calctensorfuv\+\_\+list\+::addtotensorfuv (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(\mbox{\hyperlink{TMCFM_8hh_a5cdce5291514a56d7755cff3fc4750c1}{r}})), intent(in)}]{Mom\+Ten\+Rec,  }\item[{integer, dimension(5), intent(inout)}]{Inds\+Coef,  }\item[{integer, intent(in)}]{r }\end{DoxyParamCaption})}



Definition at line 1095 of file Build\+Tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1095 }
\DoxyCodeLine{1096       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: r}
\DoxyCodeLine{1097       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(inout)} :: IndsCoef(5)}
\DoxyCodeLine{1098       \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomTenRec(RtS(r))}
\DoxyCodeLine{1099       \textcolor{keywordtype}{double complex} :: MomTen(RtS(r+1)), CF, Pmu}
\DoxyCodeLine{1100       \textcolor{keywordtype}{integer} :: mu1,mu2,nsum,mu,nu,i,a,cnt}
\DoxyCodeLine{1101 }
\DoxyCodeLine{1102       mu1 = rts(r-\/1)+1}
\DoxyCodeLine{1103       mu2 = rts(r)}
\DoxyCodeLine{1104 }
\DoxyCodeLine{1105       \textcolor{keywordflow}{do} nsum=4,(rmax-\/r)/2}
\DoxyCodeLine{1106         cf = coefsfuv(nsum,indscoef(1),indscoef(2),indscoef(3),indscoef(\textcolor{comment}{4),indscoef(5))}}
\DoxyCodeLine{1107 \textcolor{comment}{}      }
\DoxyCodeLine{1108         \textcolor{keywordflow}{do} nu=rts(nsum-\/1)+1,rts(nsum)}
\DoxyCodeLine{1109           \textcolor{keywordflow}{do} mu=mu1,mu2}
\DoxyCodeLine{1110             tfuv(addgtab(mu,nu)) = tfuv(addgtab(mu,nu))  \&}
\DoxyCodeLine{1111                                  + cf*momtenrec(mu)*cftab(mu,nu)}
\DoxyCodeLine{1112 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{1113 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1114 }
\DoxyCodeLine{1115 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{1116 }
\DoxyCodeLine{1117         }
\DoxyCodeLine{1118       \textcolor{keywordflow}{if} (r.lt.rmax-\/8) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1119 }
\DoxyCodeLine{1120         \textcolor{keywordflow}{do} i=1,5}
\DoxyCodeLine{1121           indscoef(i) = indscoef(i)+1}
\DoxyCodeLine{1122 }
\DoxyCodeLine{1123           cnt = mu2+1}
\DoxyCodeLine{1124           \textcolor{keywordflow}{do} mu=0,3}
\DoxyCodeLine{1125             pmu = momvec(mu,i)}
\DoxyCodeLine{1126             \textcolor{keywordflow}{do} a = mu2-\/binomtable(r,r+3-\/mu)+1,mu2}
\DoxyCodeLine{1127               momten(cnt)=momtenrec(a)*pmu}
\DoxyCodeLine{1128               cnt = cnt+1}
\DoxyCodeLine{1129 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{1130 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{1131 }
\DoxyCodeLine{1132           \textcolor{keyword}{call }\mbox{\hyperlink{BuildTensors_8F90_a475fe133131af7fd9e18f7024369b7c0}{addtotensorfuv}}(momten,indscoef,r+1)}
\DoxyCodeLine{1133 }
\DoxyCodeLine{1134           indscoef(i) = indscoef(i)-\/1}
\DoxyCodeLine{1135 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1136 }
\DoxyCodeLine{1137 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1138 }

\end{DoxyCode}
\mbox{\Hypertarget{BuildTensors_8F90_a89dcfe8371c893086d1e25ae13bc0f35}\label{BuildTensors_8F90_a89dcfe8371c893086d1e25ae13bc0f35}} 
\index{BuildTensors.F90@{BuildTensors.F90}!addtotensorg@{addtotensorg}}
\index{addtotensorg@{addtotensorg}!BuildTensors.F90@{BuildTensors.F90}}
\doxysubsubsection{\texorpdfstring{addtotensorg()}{addtotensorg()}}
{\footnotesize\ttfamily recursive subroutine calctensorg\+\_\+list\+::addtotensorg (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(\mbox{\hyperlink{TMCFM_8hh_a5cdce5291514a56d7755cff3fc4750c1}{r}})), intent(in)}]{Mom\+Ten\+Rec,  }\item[{integer, dimension(6), intent(inout)}]{Inds\+Coef,  }\item[{integer}]{r }\end{DoxyParamCaption})}



Definition at line 1264 of file Build\+Tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1264 }
\DoxyCodeLine{1265       \textcolor{keywordtype}{integer} :: r}
\DoxyCodeLine{1266       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(inout)} :: IndsCoef(6)}
\DoxyCodeLine{1267       \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomTenRec(RtS(r))}
\DoxyCodeLine{1268       \textcolor{keywordtype}{double complex} :: MomTen(RtS(r+1)), CG, Pmu}
\DoxyCodeLine{1269       \textcolor{keywordtype}{integer} :: mu1,mu2,nsum,mu,nu,i,a,cnt}
\DoxyCodeLine{1270 }
\DoxyCodeLine{1271       cg = coefsg(0,indscoef(1),indscoef(2),indscoef(3),indscoef(4),indscoef\textcolor{comment}{(5),indscoef(6))}}
\DoxyCodeLine{1272 \textcolor{comment}{}}
\DoxyCodeLine{1273       mu1 = rts(r-\/1)+1}
\DoxyCodeLine{1274       mu2 = rts(r)}
\DoxyCodeLine{1275 }
\DoxyCodeLine{1276       tg(mu1:mu2) = tg(mu1:mu2) + cg*momtenrec(mu1:mu2)}
\DoxyCodeLine{1277 }
\DoxyCodeLine{1278       \textcolor{keywordflow}{do} nsum=1,(rmax-\/r)/2}
\DoxyCodeLine{1279         cg = coefsg(nsum,indscoef(1),indscoef(2),indscoef(3),indscoef(4)\textcolor{comment}{,indscoef(5),indscoef(6))}}
\DoxyCodeLine{1280 \textcolor{comment}{}      }
\DoxyCodeLine{1281         \textcolor{keywordflow}{do} nu=rts(nsum-\/1)+1,rts(nsum)}
\DoxyCodeLine{1282           \textcolor{keywordflow}{do} mu=mu1,mu2}
\DoxyCodeLine{1283             tg(addgtab(mu,nu)) = tg(addgtab(mu,nu)) + cg*momtenrec(mu)*cftab\textcolor{comment}{(mu,nu)}}
\DoxyCodeLine{1284 \textcolor{comment}{}\textcolor{keywordflow}{          end do}}
\DoxyCodeLine{1285 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1286 }
\DoxyCodeLine{1287 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{1288 }
\DoxyCodeLine{1289       \textcolor{keywordflow}{if} (calcuv\_ten) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1290 \textcolor{comment}{!        CG = CoefsGuv(0,IndsCoef(1),IndsCoef(2),IndsCoef(3),IndsCoef(4),IndsCoef(5),IndsCoef(6))}}
\DoxyCodeLine{1291 }
\DoxyCodeLine{1292 \textcolor{comment}{!        TGuv(mu1:mu2) = TGuv(mu1:mu2) + CG*MomTenRec(mu1:mu2)}}
\DoxyCodeLine{1293 }
\DoxyCodeLine{1294 \textcolor{comment}{!        do nsum=1,(rmax-\/r)/2}}
\DoxyCodeLine{1295         \textcolor{keywordflow}{do} nsum=5,(rmax-\/r)/2}
\DoxyCodeLine{1296           cg = coefsguv(nsum,indscoef(1),indscoef(2),indscoef(3),indscoef\textcolor{comment}{(4),indscoef(5),indscoef(6))}}
\DoxyCodeLine{1297 \textcolor{comment}{}      }
\DoxyCodeLine{1298           \textcolor{keywordflow}{do} nu=rts(nsum-\/1)+1,rts(nsum)}
\DoxyCodeLine{1299             \textcolor{keywordflow}{do} mu=mu1,mu2}
\DoxyCodeLine{1300               tguv(addgtab(mu,nu)) = tguv(addgtab(mu,nu))  \&}
\DoxyCodeLine{1301                                    + cg*momtenrec(mu)*cftab(mu,nu)}
\DoxyCodeLine{1302 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{1303 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{1304 }
\DoxyCodeLine{1305 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1306 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1307 }
\DoxyCodeLine{1308         }
\DoxyCodeLine{1309       \textcolor{keywordflow}{if} (r.lt.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1310 }
\DoxyCodeLine{1311         \textcolor{keywordflow}{do} i=1,6}
\DoxyCodeLine{1312           indscoef(i) = indscoef(i)+1}
\DoxyCodeLine{1313 }
\DoxyCodeLine{1314           cnt = mu2+1}
\DoxyCodeLine{1315           \textcolor{keywordflow}{do} mu=0,3}
\DoxyCodeLine{1316             pmu = momvec(mu,i)}
\DoxyCodeLine{1317             \textcolor{keywordflow}{do} a = mu2-\/binomtable(r,r+3-\/mu)+1,mu2}
\DoxyCodeLine{1318               momten(cnt)=momtenrec(a)*pmu}
\DoxyCodeLine{1319               cnt = cnt+1}
\DoxyCodeLine{1320 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{1321 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{1322 }
\DoxyCodeLine{1323           \textcolor{keyword}{call }\mbox{\hyperlink{BuildTensors_8F90_a89dcfe8371c893086d1e25ae13bc0f35}{addtotensorg}}(momten,indscoef,r+1)}
\DoxyCodeLine{1324 }
\DoxyCodeLine{1325           indscoef(i) = indscoef(i)-\/1}
\DoxyCodeLine{1326 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1327 }
\DoxyCodeLine{1328 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1329 }

\end{DoxyCode}
\mbox{\Hypertarget{BuildTensors_8F90_a2043de598d9c295da0e8aaa4b2140ccd}\label{BuildTensors_8F90_a2043de598d9c295da0e8aaa4b2140ccd}} 
\index{BuildTensors.F90@{BuildTensors.F90}!addtotensortn@{addtotensortn}}
\index{addtotensortn@{addtotensortn}!BuildTensors.F90@{BuildTensors.F90}}
\doxysubsubsection{\texorpdfstring{addtotensortn()}{addtotensortn()}}
{\footnotesize\ttfamily recursive subroutine calctensortn\+\_\+list\+::addtotensortn (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(\mbox{\hyperlink{TMCFM_8hh_a5cdce5291514a56d7755cff3fc4750c1}{r}})), intent(in)}]{Mom\+Ten\+Rec,  }\item[{integer, intent(in)}]{ind,  }\item[{integer, intent(in)}]{r }\end{DoxyParamCaption})}



Definition at line 1463 of file Build\+Tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1463 }
\DoxyCodeLine{1464       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: r,ind}
\DoxyCodeLine{1465       \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomTenRec(RtS(r))}
\DoxyCodeLine{1466       \textcolor{keywordtype}{double complex} :: CN, Pmu}
\DoxyCodeLine{1467       \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: MomTenIt(:)}
\DoxyCodeLine{1468       \textcolor{keywordtype}{integer} :: mu1,mu2,nsum,mu,nu,i,a,cnt,nind}
\DoxyCodeLine{1469       \textcolor{keywordtype}{double precision} :: CNmax }
\DoxyCodeLine{1470 }
\DoxyCodeLine{1471       cn = coefsn\_aux(ind,0,r)}
\DoxyCodeLine{1472 }
\DoxyCodeLine{1473       mu1 = rts(r-\/1)+1}
\DoxyCodeLine{1474       mu2 = rts(r)}
\DoxyCodeLine{1475 }
\DoxyCodeLine{1476       tn(mu1:mu2) = tn(mu1:mu2) + cn*momtenrec(mu1:mu2)}
\DoxyCodeLine{1477 }
\DoxyCodeLine{1478       \textcolor{keywordflow}{do} nsum=1,(rmax-\/r)/2}
\DoxyCodeLine{1479         cn = coefsn\_aux(ind,nsum,r+2*nsum)}
\DoxyCodeLine{1480       }
\DoxyCodeLine{1481         \textcolor{keywordflow}{do} nu=rts(nsum-\/1)+1,rts(nsum)}
\DoxyCodeLine{1482           \textcolor{keywordflow}{do} mu=mu1,mu2}
\DoxyCodeLine{1483             tn(addgtab(mu,nu)) = tn(addgtab(mu,nu)) + cn*momtenrec(mu)*cftab\textcolor{comment}{(mu,nu)}}
\DoxyCodeLine{1484 \textcolor{comment}{}\textcolor{keywordflow}{          end do}}
\DoxyCodeLine{1485 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1486 }
\DoxyCodeLine{1487 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{1488    }
\DoxyCodeLine{1489       \textcolor{keywordflow}{if} (calcuv\_ten) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1490 }
\DoxyCodeLine{1491         \textcolor{keywordflow}{if} (n.le.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1492           cn = coefsnuv\_aux(ind,0,r)}
\DoxyCodeLine{1493           tnuv(mu1:mu2) = tnuv(mu1:mu2) + cn*momtenrec(mu1:mu2)}
\DoxyCodeLine{1494 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1495 }
\DoxyCodeLine{1496 \textcolor{comment}{!        do nsum=1,(rmax-\/r)/2}}
\DoxyCodeLine{1497         \textcolor{keywordflow}{do} nsum=max(n-\/2,1),(rmax-\/r)/2}
\DoxyCodeLine{1498           cn = coefsnuv\_aux(ind,nsum,r+2*nsum)}
\DoxyCodeLine{1499       }
\DoxyCodeLine{1500           \textcolor{keywordflow}{do} nu=rts(nsum-\/1)+1,rts(nsum)}
\DoxyCodeLine{1501             \textcolor{keywordflow}{do} mu=mu1,mu2}
\DoxyCodeLine{1502               tnuv(addgtab(mu,nu)) = tnuv(addgtab(mu,nu))  \&}
\DoxyCodeLine{1503                                    + cn*momtenrec(mu)*cftab(mu,nu)}
\DoxyCodeLine{1504 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{1505 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{1506 }
\DoxyCodeLine{1507 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1508 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1509 }
\DoxyCodeLine{1510         }
\DoxyCodeLine{1511       \textcolor{keywordflow}{if} (r.lt.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1512 }
\DoxyCodeLine{1513         \textcolor{keyword}{allocate}(momtenit(rts(r+1)))}
\DoxyCodeLine{1514         \textcolor{keywordflow}{do} i=1,n-\/1}
\DoxyCodeLine{1515           nind = indspiprod(0,i,ind,n-\/1)}
\DoxyCodeLine{1516 }
\DoxyCodeLine{1517           cnt = mu2+1}
\DoxyCodeLine{1518           \textcolor{keywordflow}{do} mu=0,3}
\DoxyCodeLine{1519             pmu = momvec(mu,i)}
\DoxyCodeLine{1520             \textcolor{keywordflow}{do} a = mu2-\/binomtable(r,r+3-\/mu)+1,mu2}
\DoxyCodeLine{1521               momtenit(cnt)=momtenrec(a)*pmu}
\DoxyCodeLine{1522               cnt = cnt+1}
\DoxyCodeLine{1523 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{1524 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{1525 }
\DoxyCodeLine{1526           \textcolor{keyword}{call }\mbox{\hyperlink{BuildTensors_8F90_a2043de598d9c295da0e8aaa4b2140ccd}{addtotensortn}}(momtenit,nind,r+1)}
\DoxyCodeLine{1527 }
\DoxyCodeLine{1528 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1529 }
\DoxyCodeLine{1530 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1531 }

\end{DoxyCode}
\mbox{\Hypertarget{BuildTensors_8F90_a92d726665618c51b5f6048d00d741458}\label{BuildTensors_8F90_a92d726665618c51b5f6048d00d741458}} 
\index{BuildTensors.F90@{BuildTensors.F90}!addtotensortnuv@{addtotensortnuv}}
\index{addtotensortnuv@{addtotensortnuv}!BuildTensors.F90@{BuildTensors.F90}}
\doxysubsubsection{\texorpdfstring{addtotensortnuv()}{addtotensortnuv()}}
{\footnotesize\ttfamily recursive subroutine calctensortnuv\+\_\+list\+::addtotensortnuv (\begin{DoxyParamCaption}\item[{double complex, dimension(rts(\mbox{\hyperlink{TMCFM_8hh_a5cdce5291514a56d7755cff3fc4750c1}{r}})), intent(in)}]{Mom\+Ten\+Rec,  }\item[{integer, intent(in)}]{ind,  }\item[{integer, intent(in)}]{r }\end{DoxyParamCaption})}



Definition at line 1626 of file Build\+Tensors.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1626 }
\DoxyCodeLine{1627       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: r,ind}
\DoxyCodeLine{1628       \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomTenRec(RtS(r))}
\DoxyCodeLine{1629       \textcolor{keywordtype}{double complex} :: MomTen(RtS(r+1)), CN, Pmu}
\DoxyCodeLine{1630       \textcolor{keywordtype}{integer} :: mu1,mu2,nsum,mu,nu,i,a,cnt,nind}
\DoxyCodeLine{1631       \textcolor{keywordtype}{double precision} :: CNmax }
\DoxyCodeLine{1632 }
\DoxyCodeLine{1633       mu1 = rts(r-\/1)+1}
\DoxyCodeLine{1634       mu2 = rts(r)}
\DoxyCodeLine{1635 }
\DoxyCodeLine{1636       \textcolor{keywordflow}{if} (n.le.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1637         cn = coefsnuv(ind,0,r)}
\DoxyCodeLine{1638         tnuv(mu1:mu2) = tnuv(mu1:mu2) + cn*momtenrec(mu1:mu2)}
\DoxyCodeLine{1639 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1640 }
\DoxyCodeLine{1641       \textcolor{keywordflow}{do} nsum=max(n-\/2,1),(rmax-\/r)/2}
\DoxyCodeLine{1642         cn = coefsnuv(ind,nsum,r+2*nsum)}
\DoxyCodeLine{1643       }
\DoxyCodeLine{1644         \textcolor{keywordflow}{do} nu=rts(nsum-\/1)+1,rts(nsum)}
\DoxyCodeLine{1645           \textcolor{keywordflow}{do} mu=mu1,mu2}
\DoxyCodeLine{1646             tnuv(addgtab(mu,nu)) = tnuv(addgtab(mu,nu))  \&}
\DoxyCodeLine{1647                                  + cn*momtenrec(mu)*cftab(mu,nu)}
\DoxyCodeLine{1648 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{1649 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1650 }
\DoxyCodeLine{1651 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{1652 }
\DoxyCodeLine{1653         }
\DoxyCodeLine{1654       \textcolor{keywordflow}{if} (r.lt.rmax-\/2*n+4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1655 }
\DoxyCodeLine{1656         \textcolor{keywordflow}{do} i=1,n-\/1}
\DoxyCodeLine{1657           nind = indspiprod(0,i,ind,n-\/1)}
\DoxyCodeLine{1658 }
\DoxyCodeLine{1659           cnt = mu2+1}
\DoxyCodeLine{1660           \textcolor{keywordflow}{do} mu=0,3}
\DoxyCodeLine{1661             pmu = momvec(mu,i)}
\DoxyCodeLine{1662             \textcolor{keywordflow}{do} a = mu2-\/binomtable(r,r+3-\/mu)+1,mu2}
\DoxyCodeLine{1663               momten(cnt)=momtenrec(a)*pmu}
\DoxyCodeLine{1664               cnt = cnt+1}
\DoxyCodeLine{1665 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{1666 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{1667 }
\DoxyCodeLine{1668           \textcolor{keyword}{call }\mbox{\hyperlink{BuildTensors_8F90_a92d726665618c51b5f6048d00d741458}{addtotensortnuv}}(momten,nind,r+1)}
\DoxyCodeLine{1669 }
\DoxyCodeLine{1670 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1671 }
\DoxyCodeLine{1672 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1673 }

\end{DoxyCode}
