\hypertarget{namespacemodvhiggs}{}\doxysection{modvhiggs Module Reference}
\label{namespacemodvhiggs}\index{modvhiggs@{modvhiggs}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public \mbox{\hyperlink{namespacemodvhiggs_ad5981806a980a6f6ec353eb149d06b09}{evalamp\+\_\+vhiggs}} (id, helicity, Mom\+Ext, me2)
\item 
complex(8) function \mbox{\hyperlink{namespacemodvhiggs_a2b92d6c943a6d350bfe0dbe805ec8ef7}{matrixelement0}} (Mom\+Ext, mass, helicity, id, useA)
\item 
complex(8) function \mbox{\hyperlink{namespacemodvhiggs_a455f025fd2a80c7ee87143c4195d8d62}{getvpffcoupling\+\_\+vh}} (pdgid, hel, use\+Wp)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_a3a2d2d92f3e50a6986c2cd0072c63021}{angles}} (sincos, vector)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_a3f4c7b48161d9ed9e3dbde1c017703ed}{antisymmetric2}} (p1, p2, epp)
\item 
real(8) function \mbox{\hyperlink{namespacemodvhiggs_a10f5fbedf5de387430e47856ae167498}{antisymmetric}} (i, j, k, l)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_a1e291456c906c6619f56b2b26cad4c5c}{contra\+\_\+field\+\_\+tensor}} (P\+OL, T\+\_\+mu\+\_\+nu)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_a7d8c5991e9b0cac311e7cf968581debf}{contra\+\_\+outer}} (p1, p2, pp)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_a51e0b136558e34dccbae5ec36ea1140c}{covariant\+\_\+field\+\_\+tensor}} (P\+OL, T\+\_\+mu\+\_\+nu)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_a0e4610e7a4140b08e2388d36a6d43c6f}{covariant\+\_\+outer}} (p1, p2, pp)
\item 
complex(8) function \mbox{\hyperlink{namespacemodvhiggs_acf832fa8105832683c32e4f04c239bea}{covariant\+\_\+vector}} (p, mu)
\item 
complex(8) function \mbox{\hyperlink{namespacemodvhiggs_a926f6f83bda8f4e2da0d80d7486dc931}{ffp}} (pdg\+\_\+code1, p1, h1, pdg\+\_\+code2, p2, h2)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_ab77e0f61beddafc3883d595c8847746c}{ffa}} (pdg\+\_\+code1, p1, h1, pdg\+\_\+code2, p2, h2, Acurrent)
\item 
complex(8) function \mbox{\hyperlink{namespacemodvhiggs_a64ea6caa1e8747bbec05f63d21bcf9c0}{ffs}} (pdg\+\_\+code1, p1, h1, pdg\+\_\+code2, p2, h2)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_a30a6069406e7d45001e9c54034b76fe0}{ffv}} (pdg\+\_\+code1, p1, h1, pdg\+\_\+code2, p2, h2, Vcurrent)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_a143ff485ec2f65c44b09d914dcdfa9c3}{inv\+\_\+lorentz}} (vector, boost)
\item 
real(8) function \mbox{\hyperlink{namespacemodvhiggs_a0311b7e52431406b8109f386ecd490c7}{kronecker\+\_\+delta}} (i, j)
\item 
real(8) function \mbox{\hyperlink{namespacemodvhiggs_ad33930c2407829c003597466ab672caa}{metric}} (mu, nu)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_a094016f0d9a7c3c3caa1e791e01b315f}{polarization}} (p, P\+OL)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_a2f6a4cbd41e56a39543313fc5dfdf37b}{polarization\+\_\+single}} (p, lambda, P\+OL)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_a5a0812bc27cac2bd9798b50bea21b7e6}{polarizationa}} (p, P\+OL)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_ab37be81cf8a6f8fff05c4db9a1741536}{polarizationx}} (p, P\+OL)
\item 
complex(8) function \mbox{\hyperlink{namespacemodvhiggs_aad4645be763f9042bf4bc2ea215a5846}{propagator}} (inv\+\_\+mass, mass, width)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_a935c67a26fa748df19e205b4be7ccd5f}{vvp}} (p1, p2, epp)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_acfb08edf61825ee639b9ac0d28b8524d}{vvs1}} (g\+\_\+mu\+\_\+nu)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_a79e78df82578c43bb28cea9ee96251bc}{vvs2}} (p1, p2, pp)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_a728feac63aa7cfbfe30b08c7ed244389}{spinoru2}} (n, p, za, zb, s)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_a436a26fa7bd00a57c5a2e4aeb1dccd22}{matrixelement1}} (p, Ferm\+Flav, Un\+Pol\+Sq\+Amp)
\item 
subroutine \mbox{\hyperlink{namespacemodvhiggs_a77464875921dc44d24203e95b67706a6}{getsme}} (p, Ferm\+Flav, S\+ME)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacemodvhiggs_a3a2d2d92f3e50a6986c2cd0072c63021}\label{namespacemodvhiggs_a3a2d2d92f3e50a6986c2cd0072c63021}} 
\index{modvhiggs@{modvhiggs}!angles@{angles}}
\index{angles@{angles}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{angles()}{angles()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::angles (\begin{DoxyParamCaption}\item[{real(8), dimension(4)}]{sincos,  }\item[{real(8), dimension(4)}]{vector }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 681 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{681       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{682 \textcolor{comment}{!     real(8) Pi}}
\DoxyCodeLine{683 \textcolor{keywordtype}{      real}(8) Twopi, Fourpi, epsilon}
\DoxyCodeLine{684 \textcolor{comment}{!     parameter( Pi = 3.14159265358979323846d0 )}}
\DoxyCodeLine{685       parameter( twopi = 2d0 * pi )}
\DoxyCodeLine{686       parameter( fourpi = 4d0 * pi )}
\DoxyCodeLine{687       parameter( epsilon = 1d-\/13 ) \textcolor{comment}{!a small quantity slightly above machine precision}}
\DoxyCodeLine{688 \textcolor{keywordtype}{      real}(8) sincos(4), vector(4), abs3p, phi}
\DoxyCodeLine{689 \textcolor{comment}{!sincos(1)=cos(theta)}}
\DoxyCodeLine{690 \textcolor{comment}{!sincos(2)=sin(theta)}}
\DoxyCodeLine{691 \textcolor{comment}{!sincos(3)=cos(phi)}}
\DoxyCodeLine{692 \textcolor{comment}{!sincos(4)=sin(phi)}}
\DoxyCodeLine{693 }
\DoxyCodeLine{694 \textcolor{comment}{!|3-\/momentum|}}
\DoxyCodeLine{695       abs3p = dsqrt(vector(2)**2+vector(3)**2+vector(4)**2)}
\DoxyCodeLine{696 }
\DoxyCodeLine{697 \textcolor{comment}{!if |3-\/momentum|=0}}
\DoxyCodeLine{698       \textcolor{keywordflow}{if}(abs3p.lt.epsilon)\textcolor{keywordflow}{then}}
\DoxyCodeLine{699         sincos(1)=1d0}
\DoxyCodeLine{700         sincos(2)=0d0}
\DoxyCodeLine{701       \textcolor{keywordflow}{else}}
\DoxyCodeLine{702         sincos(1)=vector(4)/abs3p}
\DoxyCodeLine{703         sincos(2)=dsqrt((1d0+sincos(1))*(1d0-\/sincos(1)))}
\DoxyCodeLine{704 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{705 }
\DoxyCodeLine{706 \textcolor{comment}{!if colinear}}
\DoxyCodeLine{707       \textcolor{keywordflow}{if}(dabs(vector(3)).lt.epsilon)\textcolor{keywordflow}{then}}
\DoxyCodeLine{708         phi=0d0}
\DoxyCodeLine{709       \textcolor{keywordflow}{else}}
\DoxyCodeLine{710         \textcolor{keywordflow}{if}(dabs(vector(2)).lt.epsilon)\textcolor{keywordflow}{then}}
\DoxyCodeLine{711            phi=(twopi/2d0)/2d0 * dsign(1d0,vector(3))}
\DoxyCodeLine{712         \textcolor{keywordflow}{else}}
\DoxyCodeLine{713            phi=datan(vector(3)/vector(2))}
\DoxyCodeLine{714 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{715 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{716 \textcolor{comment}{!shift phi so that 0 < phi < 2Pi}}
\DoxyCodeLine{717       \textcolor{keywordflow}{if}(vector(2).lt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{718          phi=phi+pi}
\DoxyCodeLine{719 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{720       \textcolor{keywordflow}{if}(phi.lt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{721          phi=phi+twopi}
\DoxyCodeLine{722 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{723 \textcolor{comment}{!     print *,phi}}
\DoxyCodeLine{724       sincos(3)=dcos(phi)}
\DoxyCodeLine{725       sincos(4)=dsin(phi)}
\DoxyCodeLine{726 }
\DoxyCodeLine{727       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a10f5fbedf5de387430e47856ae167498}\label{namespacemodvhiggs_a10f5fbedf5de387430e47856ae167498}} 
\index{modvhiggs@{modvhiggs}!antisymmetric@{antisymmetric}}
\index{antisymmetric@{antisymmetric}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{antisymmetric()}{antisymmetric()}}
{\footnotesize\ttfamily real(8) function modvhiggs\+::antisymmetric (\begin{DoxyParamCaption}\item[{integer}]{i,  }\item[{integer}]{j,  }\item[{integer}]{k,  }\item[{integer}]{l }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 775 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{775 }
\DoxyCodeLine{776       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{777 \textcolor{comment}{!     include '../COMMON.INI'}}
\DoxyCodeLine{778 }
\DoxyCodeLine{779       \textcolor{keywordtype}{integer} i,j,k,l}
\DoxyCodeLine{780 }
\DoxyCodeLine{781       antisymmetric=dble((i-\/j)*(i-\/k)*(i-\/l)*(j-\/k)*(j-\/l)*(k-\/l))/12d0}
\DoxyCodeLine{782 }
\DoxyCodeLine{783       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a3f4c7b48161d9ed9e3dbde1c017703ed}\label{namespacemodvhiggs_a3f4c7b48161d9ed9e3dbde1c017703ed}} 
\index{modvhiggs@{modvhiggs}!antisymmetric2@{antisymmetric2}}
\index{antisymmetric2@{antisymmetric2}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{antisymmetric2()}{antisymmetric2()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::antisymmetric2 (\begin{DoxyParamCaption}\item[{complex(8), dimension(4)}]{p1,  }\item[{complex(8), dimension(4)}]{p2,  }\item[{complex(8), dimension(4,4)}]{epp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 733 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{733 }
\DoxyCodeLine{734       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{735 \textcolor{comment}{!     real(8) Pi}}
\DoxyCodeLine{736 \textcolor{keywordtype}{      real}(8) Twopi, Fourpi, epsilon}
\DoxyCodeLine{737 \textcolor{comment}{!     parameter( Pi = 3.14159265358979323846d0 )}}
\DoxyCodeLine{738       parameter( twopi = 2d0 * pi )}
\DoxyCodeLine{739       parameter( fourpi = 4d0 * pi )}
\DoxyCodeLine{740       parameter( epsilon = 1d-\/13 ) \textcolor{comment}{!a small quantity slightly above machine precision}}
\DoxyCodeLine{741 }
\DoxyCodeLine{742       \textcolor{keywordtype}{complex(8)} p1(4), p2(4)}
\DoxyCodeLine{743       \textcolor{keywordtype}{complex(8)} epp(4,4)}
\DoxyCodeLine{744 \textcolor{comment}{!      real(8) ANTISYMMETRIC}}
\DoxyCodeLine{745       \textcolor{keywordtype}{integer} i,j,k,l}
\DoxyCodeLine{746 }
\DoxyCodeLine{747 \textcolor{comment}{!      external ANTISYMMETRIC}}
\DoxyCodeLine{748 }
\DoxyCodeLine{749 \textcolor{comment}{!     do i=1,4}}
\DoxyCodeLine{750 \textcolor{comment}{!     do j=1,4}}
\DoxyCodeLine{751       epp(i,j)=0d0}
\DoxyCodeLine{752 \textcolor{comment}{!     enddo}}
\DoxyCodeLine{753 \textcolor{comment}{!     enddo}}
\DoxyCodeLine{754 }
\DoxyCodeLine{755       \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{756       \textcolor{keywordflow}{do} j=1,4}
\DoxyCodeLine{757       \textcolor{keywordflow}{do} k=1,4}
\DoxyCodeLine{758       \textcolor{keywordflow}{do} l=1,4}
\DoxyCodeLine{759           epp(i,j)=epp(i,j)+antisymmetric(i,j,k,l)*p1(k)*p2(l)}
\DoxyCodeLine{760 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{761 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{762 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{763 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{764 }
\DoxyCodeLine{765       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a1e291456c906c6619f56b2b26cad4c5c}\label{namespacemodvhiggs_a1e291456c906c6619f56b2b26cad4c5c}} 
\index{modvhiggs@{modvhiggs}!contra\_field\_tensor@{contra\_field\_tensor}}
\index{contra\_field\_tensor@{contra\_field\_tensor}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{contra\_field\_tensor()}{contra\_field\_tensor()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::contra\+\_\+field\+\_\+tensor (\begin{DoxyParamCaption}\item[{complex(8), dimension(3,4)}]{P\+OL,  }\item[{complex(8), dimension(5,4,4)}]{T\+\_\+mu\+\_\+nu }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 792 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{792 }
\DoxyCodeLine{793       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{794 \textcolor{comment}{!     real(8) Pi}}
\DoxyCodeLine{795 \textcolor{keywordtype}{      real}(8) Twopi, Fourpi, epsilon}
\DoxyCodeLine{796 \textcolor{comment}{!     parameter( Pi = 3.14159265358979323846d0 )}}
\DoxyCodeLine{797       parameter( twopi = 2d0 * pi )}
\DoxyCodeLine{798       parameter( fourpi = 4d0 * pi )}
\DoxyCodeLine{799       parameter( epsilon = 1d-\/13 ) \textcolor{comment}{!a small quantity slightly above machine precision}}
\DoxyCodeLine{800       \textcolor{keywordtype}{complex(8)} epep(4,4),emem(4,4),epe0(4,4),eme0(4,4),e0e0(4,4)}
\DoxyCodeLine{801       \textcolor{keywordtype}{complex(8)} epem(4,4),e0ep(4,4),e0em(4,4),emep(4,4)}
\DoxyCodeLine{802       \textcolor{keywordtype}{complex(8)} POL(3,4), T\_mu\_nu(5,4,4)}
\DoxyCodeLine{803 }
\DoxyCodeLine{804       \textcolor{keyword}{call }contra\_outer(pol(1,:), pol(1,:), epep)}
\DoxyCodeLine{805       \textcolor{keyword}{call }contra\_outer(pol(2,:), pol(2,:), emem)}
\DoxyCodeLine{806       \textcolor{keyword}{call }contra\_outer(pol(1,:), pol(3,:), epe0)}
\DoxyCodeLine{807       \textcolor{keyword}{call }contra\_outer(pol(3,:), pol(1,:), e0ep)}
\DoxyCodeLine{808       \textcolor{keyword}{call }contra\_outer(pol(2,:), pol(3,:), eme0)}
\DoxyCodeLine{809       \textcolor{keyword}{call }contra\_outer(pol(3,:), pol(2,:), e0em)}
\DoxyCodeLine{810       \textcolor{keyword}{call }contra\_outer(pol(3,:), pol(3,:), e0e0)}
\DoxyCodeLine{811       \textcolor{keyword}{call }contra\_outer(pol(1,:), pol(2,:), epem)}
\DoxyCodeLine{812       \textcolor{keyword}{call }contra\_outer(pol(2,:), pol(1,:), emep)}
\DoxyCodeLine{813 }
\DoxyCodeLine{814 \textcolor{comment}{!lambda = +2}}
\DoxyCodeLine{815       t\_mu\_nu(1,:,:)=epep}
\DoxyCodeLine{816 \textcolor{comment}{!lambda = -\/2}}
\DoxyCodeLine{817       t\_mu\_nu(2,:,:)=emem}
\DoxyCodeLine{818 \textcolor{comment}{!lambda = +3}}
\DoxyCodeLine{819       t\_mu\_nu(3,:,:)=(epe0+e0ep)/dsqrt(2d0)}
\DoxyCodeLine{820 \textcolor{comment}{!lambda = -\/3}}
\DoxyCodeLine{821       t\_mu\_nu(4,:,:)=(eme0+e0em)/dsqrt(2d0)}
\DoxyCodeLine{822 \textcolor{comment}{!lambda = 0}}
\DoxyCodeLine{823       t\_mu\_nu(5,:,:)=(epem+emep)/dsqrt(6d0) + e0e0/dsqrt(1.5d0)}
\DoxyCodeLine{824 }
\DoxyCodeLine{825 }
\DoxyCodeLine{826       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a7d8c5991e9b0cac311e7cf968581debf}\label{namespacemodvhiggs_a7d8c5991e9b0cac311e7cf968581debf}} 
\index{modvhiggs@{modvhiggs}!contra\_outer@{contra\_outer}}
\index{contra\_outer@{contra\_outer}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{contra\_outer()}{contra\_outer()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::contra\+\_\+outer (\begin{DoxyParamCaption}\item[{complex(8), dimension(4)}]{p1,  }\item[{complex(8), dimension(4)}]{p2,  }\item[{complex(8), dimension(4,4)}]{pp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 835 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{835 }
\DoxyCodeLine{836       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{837 \textcolor{comment}{!     include '../COMMON.INI'}}
\DoxyCodeLine{838       \textcolor{keywordtype}{complex(8)} p1(4), p2(4)}
\DoxyCodeLine{839       \textcolor{keywordtype}{complex(8)} pp(4,4)}
\DoxyCodeLine{840       \textcolor{keywordtype}{integer} mu, nu}
\DoxyCodeLine{841 }
\DoxyCodeLine{842       \textcolor{keywordflow}{do} mu=1,4}
\DoxyCodeLine{843         \textcolor{keywordflow}{do} nu=1,4}
\DoxyCodeLine{844           pp(mu,nu)=p1(mu)*p2(nu)}
\DoxyCodeLine{845 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{846 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{847 }
\DoxyCodeLine{848       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a51e0b136558e34dccbae5ec36ea1140c}\label{namespacemodvhiggs_a51e0b136558e34dccbae5ec36ea1140c}} 
\index{modvhiggs@{modvhiggs}!covariant\_field\_tensor@{covariant\_field\_tensor}}
\index{covariant\_field\_tensor@{covariant\_field\_tensor}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{covariant\_field\_tensor()}{covariant\_field\_tensor()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::covariant\+\_\+field\+\_\+tensor (\begin{DoxyParamCaption}\item[{complex(8), dimension(3,4)}]{P\+OL,  }\item[{complex(8), dimension(5,4,4)}]{T\+\_\+mu\+\_\+nu }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 857 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{857 }
\DoxyCodeLine{858       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{859 \textcolor{comment}{!     real(8) Pi}}
\DoxyCodeLine{860 \textcolor{keywordtype}{      real}(8) Twopi, Fourpi, epsilon}
\DoxyCodeLine{861 \textcolor{comment}{!     parameter( Pi = 3.14159265358979323846d0 )}}
\DoxyCodeLine{862       parameter( twopi = 2d0 * pi )}
\DoxyCodeLine{863       parameter( fourpi = 4d0 * pi )}
\DoxyCodeLine{864       parameter( epsilon = 1d-\/13 ) \textcolor{comment}{!a small quantity slightly above machine precision}}
\DoxyCodeLine{865       \textcolor{keywordtype}{complex(8)} epep(4,4),emem(4,4),epe0(4,4),eme0(4,4),e0e0(4,4)}
\DoxyCodeLine{866       \textcolor{keywordtype}{complex(8)} epem(4,4),e0ep(4,4),e0em(4,4),emep(4,4)}
\DoxyCodeLine{867       \textcolor{keywordtype}{complex(8)} POL(3,4), T\_mu\_nu(5,4,4)}
\DoxyCodeLine{868 }
\DoxyCodeLine{869       \textcolor{keyword}{call }covariant\_outer(pol(1,:), pol(1,:), epep)}
\DoxyCodeLine{870       \textcolor{keyword}{call }covariant\_outer(pol(2,:), pol(2,:), emem)}
\DoxyCodeLine{871       \textcolor{keyword}{call }covariant\_outer(pol(1,:), pol(3,:), epe0)}
\DoxyCodeLine{872       \textcolor{keyword}{call }covariant\_outer(pol(3,:), pol(1,:), e0ep)}
\DoxyCodeLine{873       \textcolor{keyword}{call }covariant\_outer(pol(2,:), pol(3,:), eme0)}
\DoxyCodeLine{874       \textcolor{keyword}{call }covariant\_outer(pol(3,:), pol(2,:), e0em)}
\DoxyCodeLine{875       \textcolor{keyword}{call }covariant\_outer(pol(3,:), pol(3,:), e0e0)}
\DoxyCodeLine{876       \textcolor{keyword}{call }covariant\_outer(pol(1,:), pol(2,:), epem)}
\DoxyCodeLine{877       \textcolor{keyword}{call }covariant\_outer(pol(2,:), pol(1,:), emep)}
\DoxyCodeLine{878 }
\DoxyCodeLine{879 \textcolor{comment}{!lambda = +2}}
\DoxyCodeLine{880       t\_mu\_nu(1,:,:)=epep}
\DoxyCodeLine{881 \textcolor{comment}{!lambda = -\/2}}
\DoxyCodeLine{882       t\_mu\_nu(2,:,:)=emem}
\DoxyCodeLine{883 \textcolor{comment}{!lambda = +3}}
\DoxyCodeLine{884       t\_mu\_nu(3,:,:)=(epe0+e0ep)/dsqrt(2d0)}
\DoxyCodeLine{885 \textcolor{comment}{!lambda = -\/3}}
\DoxyCodeLine{886       t\_mu\_nu(4,:,:)=(eme0+e0em)/dsqrt(2d0)}
\DoxyCodeLine{887 \textcolor{comment}{!lambda = 0}}
\DoxyCodeLine{888       t\_mu\_nu(5,:,:)=(epem+emep)/dsqrt(6d0) + e0e0/dsqrt(1.5d0)}
\DoxyCodeLine{889 }
\DoxyCodeLine{890       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a0e4610e7a4140b08e2388d36a6d43c6f}\label{namespacemodvhiggs_a0e4610e7a4140b08e2388d36a6d43c6f}} 
\index{modvhiggs@{modvhiggs}!covariant\_outer@{covariant\_outer}}
\index{covariant\_outer@{covariant\_outer}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{covariant\_outer()}{covariant\_outer()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::covariant\+\_\+outer (\begin{DoxyParamCaption}\item[{complex(8), dimension(4)}]{p1,  }\item[{complex(8), dimension(4)}]{p2,  }\item[{complex(8), dimension(4,4)}]{pp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 899 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{899 }
\DoxyCodeLine{900       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{901 \textcolor{comment}{!     include '../COMMON.INI'}}
\DoxyCodeLine{902       \textcolor{keywordtype}{complex(8)} p1(4), p2(4)}
\DoxyCodeLine{903       \textcolor{keywordtype}{complex(8)} pp(4,4)}
\DoxyCodeLine{904       \textcolor{keywordtype}{integer} mu, nu}
\DoxyCodeLine{905 }
\DoxyCodeLine{906       \textcolor{keywordflow}{do} mu=1,4}
\DoxyCodeLine{907         \textcolor{keywordflow}{do} nu=1,4}
\DoxyCodeLine{908           pp(mu,nu)=p1(mu)*p2(nu)}
\DoxyCodeLine{909           \textcolor{keywordflow}{if}( ( (mu.ne.1).and.(nu.eq.1) ).or. \&}
\DoxyCodeLine{910               ( (mu.eq.1).and.(nu.ne.1) ) )\textcolor{keywordflow}{then}}
\DoxyCodeLine{911             pp(mu,nu)=-\/pp(mu,nu)}
\DoxyCodeLine{912 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{913 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{914 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{915 }
\DoxyCodeLine{916       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_acf832fa8105832683c32e4f04c239bea}\label{namespacemodvhiggs_acf832fa8105832683c32e4f04c239bea}} 
\index{modvhiggs@{modvhiggs}!covariant\_vector@{covariant\_vector}}
\index{covariant\_vector@{covariant\_vector}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{covariant\_vector()}{covariant\_vector()}}
{\footnotesize\ttfamily complex(8) function modvhiggs\+::covariant\+\_\+vector (\begin{DoxyParamCaption}\item[{complex(8), dimension(4)}]{p,  }\item[{integer}]{mu }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 925 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{925 }
\DoxyCodeLine{926       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{927 }
\DoxyCodeLine{928       \textcolor{keywordtype}{complex(8)} p(4)}
\DoxyCodeLine{929       \textcolor{keywordtype}{integer} mu}
\DoxyCodeLine{930 }
\DoxyCodeLine{931       \textcolor{keywordflow}{if}(mu.ne.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{932         covariant\_vector = -\/p(mu)}
\DoxyCodeLine{933       \textcolor{keywordflow}{else}}
\DoxyCodeLine{934         covariant\_vector = p(mu)}
\DoxyCodeLine{935 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{936 }
\DoxyCodeLine{937       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_ad5981806a980a6f6ec353eb149d06b09}\label{namespacemodvhiggs_ad5981806a980a6f6ec353eb149d06b09}} 
\index{modvhiggs@{modvhiggs}!evalamp\_vhiggs@{evalamp\_vhiggs}}
\index{evalamp\_vhiggs@{evalamp\_vhiggs}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{evalamp\_vhiggs()}{evalamp\_vhiggs()}}
{\footnotesize\ttfamily subroutine, public modvhiggs\+::evalamp\+\_\+vhiggs (\begin{DoxyParamCaption}\item[{integer, dimension(9), intent(in)}]{id,  }\item[{real(8), dimension(9), intent(in)}]{helicity,  }\item[{real(8), dimension(1\+:4,1\+:9), intent(in)}]{Mom\+Ext,  }\item[{real(8), intent(out)}]{me2 }\end{DoxyParamCaption})}



Definition at line 15 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{15       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: id(9)}
\DoxyCodeLine{16 \textcolor{keywordtype}{      real}(8), \textcolor{keywordtype}{intent(in)} :: helicity(9)}
\DoxyCodeLine{17 \textcolor{keywordtype}{      real}(8), \textcolor{keywordtype}{intent(in)} :: MomExt(1:4,1:9)}
\DoxyCodeLine{18 \textcolor{keywordtype}{      real}(8), \textcolor{keywordtype}{intent(out)} :: me2}
\DoxyCodeLine{19 \textcolor{keywordtype}{      real}(8) :: mass(3:5,1:2)}
\DoxyCodeLine{20       \textcolor{keywordtype}{integer} :: i}
\DoxyCodeLine{21       \textcolor{keywordtype}{complex(8)} amplitude, A\_VV(1:4), amptest}
\DoxyCodeLine{22       \textcolor{keywordtype}{integer} :: idin(9)}
\DoxyCodeLine{23 \textcolor{keywordtype}{      real}(8) :: helin(9)}
\DoxyCodeLine{24 \textcolor{keywordtype}{      real}(8) :: pin(1:4,1:9)}
\DoxyCodeLine{25 }
\DoxyCodeLine{26       idin(:)=id(:)}
\DoxyCodeLine{27       helin(:)=helicity(:)}
\DoxyCodeLine{28       pin(:,:)=momext(:,:)}
\DoxyCodeLine{29       \textcolor{keywordflow}{if}(id(2).eq.convertlhe(pho\_)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{30          \textcolor{keyword}{call }\mbox{\hyperlink{interfacemodmisc_1_1swap}{swap}}(idin(1),idin(2))}
\DoxyCodeLine{31          \textcolor{keyword}{call }\mbox{\hyperlink{interfacemodmisc_1_1swap}{swap}}(helin(1),helin(2))}
\DoxyCodeLine{32          \textcolor{keyword}{call }\mbox{\hyperlink{interfacemodmisc_1_1swap}{swap}}(pin(:,1),pin(:,2))}
\DoxyCodeLine{33 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{34       \textcolor{keywordflow}{if}(id(7).eq.convertlhe(pho\_)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{35          \textcolor{keyword}{call }\mbox{\hyperlink{interfacemodmisc_1_1swap}{swap}}(idin(6),idin(7))}
\DoxyCodeLine{36          \textcolor{keyword}{call }\mbox{\hyperlink{interfacemodmisc_1_1swap}{swap}}(helin(6),helin(7))}
\DoxyCodeLine{37          \textcolor{keyword}{call }\mbox{\hyperlink{interfacemodmisc_1_1swap}{swap}}(pin(:,6),pin(:,7))}
\DoxyCodeLine{38 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{39 }
\DoxyCodeLine{40       \textcolor{keywordflow}{do} i=3,5}
\DoxyCodeLine{41         mass(i,1) = getmass(convertlhereverse(idin(i)))}
\DoxyCodeLine{42         mass(i,2) = getdecaywidth(convertlhereverse(idin(i)))}
\DoxyCodeLine{43 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{44 }
\DoxyCodeLine{45       a\_vv(:)=czero}
\DoxyCodeLine{46       \textcolor{keywordflow}{if}(idin(1).ne.convertlhe(pho\_) .and. idin(6).ne.convertlhe(pho\_)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{47          \textcolor{comment}{!print *,"Case1:"}}
\DoxyCodeLine{48          a\_vv(1)=matrixelement0(pin,mass,helin,idin,(/.false., .false./)\textcolor{comment}{)}}
\DoxyCodeLine{49 \textcolor{comment}{}         \textcolor{keywordflow}{if}(includegammastar) \textcolor{keywordflow}{then}}
\DoxyCodeLine{50             \textcolor{comment}{!print *,"Case2:"}}
\DoxyCodeLine{51             a\_vv(2) = matrixelement0(pin,mass,helin,idin,(/.false., .true\textcolor{comment}{./))}}
\DoxyCodeLine{52 \textcolor{comment}{}            \textcolor{comment}{!print *,"Case3:"}}
\DoxyCodeLine{53             a\_vv(3) = matrixelement0(pin,mass,helin,idin,(/.true., .false\textcolor{comment}{./))}}
\DoxyCodeLine{54 \textcolor{comment}{}            \textcolor{comment}{!print *,"Case4:"}}
\DoxyCodeLine{55             a\_vv(4) = matrixelement0(pin,mass,helin,idin,(/.true., .true\textcolor{comment}{./))}}
\DoxyCodeLine{56 \textcolor{comment}{}\textcolor{keywordflow}{         endif}}
\DoxyCodeLine{57       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(idin(1).eq.convertlhe(pho\_) .and. idin(6).eq.convertlhe(pho\_\textcolor{comment}{)) }\textcolor{keywordflow}{then}}
\DoxyCodeLine{58          \textcolor{comment}{!print *,"Case5:"}}
\DoxyCodeLine{59          a\_vv(1)=matrixelement0(pin,mass,helin,idin,(/.true., .true./))}
\DoxyCodeLine{60       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(idin(1).eq.convertlhe(pho\_)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{61          \textcolor{comment}{!print *,"Case6:"}}
\DoxyCodeLine{62          a\_vv(1)=matrixelement0(pin,mass,helin,idin,(/.true., .false./))}
\DoxyCodeLine{63          \textcolor{keywordflow}{if}(includegammastar) \textcolor{keywordflow}{then}}
\DoxyCodeLine{64             \textcolor{comment}{!print *,"Case7:"}}
\DoxyCodeLine{65             a\_vv(2) = matrixelement0(pin,mass,helin,idin,(/.true., .true\textcolor{comment}{./))}}
\DoxyCodeLine{66 \textcolor{comment}{}\textcolor{keywordflow}{         endif}}
\DoxyCodeLine{67       \textcolor{keywordflow}{else} \textcolor{comment}{!if(idin(6).eq.convertLHE(Pho\_)) then}}
\DoxyCodeLine{68          \textcolor{comment}{!print *,"Case8:"}}
\DoxyCodeLine{69          a\_vv(1)=matrixelement0(pin,mass,helin,idin,(/.false., .true./))}
\DoxyCodeLine{70          \textcolor{keywordflow}{if}(includegammastar) \textcolor{keywordflow}{then}}
\DoxyCodeLine{71             \textcolor{comment}{!print *,"Case9:"}}
\DoxyCodeLine{72             a\_vv(2) = matrixelement0(pin,mass,helin,idin,(/.true., .true\textcolor{comment}{./))}}
\DoxyCodeLine{73 \textcolor{comment}{}\textcolor{keywordflow}{         endif}}
\DoxyCodeLine{74 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{75       amplitude = a\_vv(1)+a\_vv(2)+a\_vv(3)+a\_vv(4)}
\DoxyCodeLine{76 }
\DoxyCodeLine{77       \textcolor{comment}{! XCHECK FROM DECAY ME}}
\DoxyCodeLine{78       \textcolor{comment}{!print *,pin(:,1)}}
\DoxyCodeLine{79       \textcolor{comment}{!print *,pin(:,2)}}
\DoxyCodeLine{80       \textcolor{comment}{!print *,pin(:,6)}}
\DoxyCodeLine{81       \textcolor{comment}{!print *,pin(:,7)}}
\DoxyCodeLine{82       \textcolor{comment}{!print *,idin(1)}}
\DoxyCodeLine{83       \textcolor{comment}{!print *,idin(2)}}
\DoxyCodeLine{84       \textcolor{comment}{!print *,idin(3)}}
\DoxyCodeLine{85       \textcolor{comment}{!print *,idin(4)}}
\DoxyCodeLine{86       \textcolor{comment}{!print *,idin(6)}}
\DoxyCodeLine{87       \textcolor{comment}{!print *,idin(7)}}
\DoxyCodeLine{88       \textcolor{comment}{!print *,helin(1)}}
\DoxyCodeLine{89       \textcolor{comment}{!print *,helin(2)}}
\DoxyCodeLine{90       \textcolor{comment}{!print *,helin(6)}}
\DoxyCodeLine{91       \textcolor{comment}{!print *,helin(7)}}
\DoxyCodeLine{92       \textcolor{comment}{!print *,amplitude}}
\DoxyCodeLine{93       \textcolor{comment}{!amptest = MATRIXELEMENT02(pin,mass,helin,idin)}}
\DoxyCodeLine{94       \textcolor{comment}{!print *,amptest}}
\DoxyCodeLine{95       \textcolor{comment}{!pause}}
\DoxyCodeLine{96 }
\DoxyCodeLine{97       me2=dble(amplitude*dconjg(amplitude))}
\DoxyCodeLine{98       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_ab77e0f61beddafc3883d595c8847746c}\label{namespacemodvhiggs_ab77e0f61beddafc3883d595c8847746c}} 
\index{modvhiggs@{modvhiggs}!ffa@{ffa}}
\index{ffa@{ffa}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{ffa()}{ffa()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::ffa (\begin{DoxyParamCaption}\item[{integer}]{pdg\+\_\+code1,  }\item[{real(8), dimension(4)}]{p1,  }\item[{real(8)}]{h1,  }\item[{integer}]{pdg\+\_\+code2,  }\item[{real(8), dimension(4)}]{p2,  }\item[{real(8)}]{h2,  }\item[{complex(8), dimension(4)}]{Acurrent }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 983 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{983 }
\DoxyCodeLine{984       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{985 \textcolor{keywordtype}{      real}(8), \textcolor{keywordtype}{parameter} :: epsilon = 1d-\/13 \textcolor{comment}{!a small quantity slightly above machine precision}}
\DoxyCodeLine{986 }
\DoxyCodeLine{987 \textcolor{keywordtype}{      real}(8) p1(4), p2(4), h1, h2}
\DoxyCodeLine{988       \textcolor{keywordtype}{integer} pdg\_code1, pdg\_code2}
\DoxyCodeLine{989 \textcolor{keywordtype}{      real}(8) sqrt\_pp1Dpp2, sqrt\_pp1Xpp2}
\DoxyCodeLine{990       \textcolor{keywordtype}{complex(8)} Acurrent(4)}
\DoxyCodeLine{991       \textcolor{keywordtype}{integer} mu}
\DoxyCodeLine{992 }
\DoxyCodeLine{993       acurrent = (0d0,0d0)}
\DoxyCodeLine{994 }
\DoxyCodeLine{995       \textcolor{keywordflow}{if}( ( dble(pdg\_code1) *h1* dble(pdg\_code2) *h2 ).lt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{996         \textcolor{keywordflow}{do} mu=1,4}
\DoxyCodeLine{997           acurrent(mu)=0d0}
\DoxyCodeLine{998 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{999 }
\DoxyCodeLine{1000       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( ( dabs( p1(1)+p1(4) ).lt.epsilon ).and. \&}
\DoxyCodeLine{1001                ( dabs( p2(1)+p2(4) ).lt.epsilon ) )\textcolor{keywordflow}{then}}
\DoxyCodeLine{1002 }
\DoxyCodeLine{1003         acurrent(1)= 2d0*dsqrt(p1(1)*p2(1))}
\DoxyCodeLine{1004         acurrent(2)= 0d0}
\DoxyCodeLine{1005         acurrent(3)= 0d0}
\DoxyCodeLine{1006         acurrent(4)=-\/acurrent(1)}
\DoxyCodeLine{1007 }
\DoxyCodeLine{1008       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(   dabs( p1(1)+p1(4) ).lt.epsilon )\textcolor{keywordflow}{then}}
\DoxyCodeLine{1009 }
\DoxyCodeLine{1010         acurrent(1)= dsqrt( 2d0*p1(1) / ( p2(1)+p2(4) ) ) \&}
\DoxyCodeLine{1011                     *( p2(2) + (0d0,1d0)*p2(3) )}
\DoxyCodeLine{1012         acurrent(2)= dsqrt( 2d0*p1(1) * ( p2(1)+p2(4) ) )}
\DoxyCodeLine{1013         acurrent(3)= (0d0,1d0)*acurrent(2)}
\DoxyCodeLine{1014         acurrent(4)=-\/acurrent(1)}
\DoxyCodeLine{1015 }
\DoxyCodeLine{1016       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(   dabs( p2(1)+p2(4) ).lt.epsilon )\textcolor{keywordflow}{then}}
\DoxyCodeLine{1017 }
\DoxyCodeLine{1018         acurrent(1)= dsqrt( 2d0*p2(1) / ( p1(1)+p1(4) ) ) \&}
\DoxyCodeLine{1019                     *( p1(2) -\/ (0d0,1d0)*p1(3) )}
\DoxyCodeLine{1020         acurrent(2)= dsqrt( 2d0*p2(1) * ( p1(1)+p1(4) ) )}
\DoxyCodeLine{1021         acurrent(3)=-\/(0d0,1d0)*acurrent(2)}
\DoxyCodeLine{1022         acurrent(4)=-\/acurrent(1)}
\DoxyCodeLine{1023 }
\DoxyCodeLine{1024       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1025 }
\DoxyCodeLine{1026         sqrt\_pp1dpp2= dsqrt( (p1(1)+p1(4)) / (p2(1)+p2(4)) )}
\DoxyCodeLine{1027         sqrt\_pp1xpp2= dsqrt( (p1(1)+p1(4)) * (p2(1)+p2(4)) )}
\DoxyCodeLine{1028         acurrent(1)= sqrt\_pp1xpp2         \&}
\DoxyCodeLine{1029                     +( p1(2) -\/ (0d0,1d0)*p1(3) )     \&}
\DoxyCodeLine{1030                     *( p2(2) + (0d0,1d0)*p2(3) )/sqrt\_pp1xpp2}
\DoxyCodeLine{1031         acurrent(2)= ( p1(2) -\/ (0d0,1d0)*p1(3) )/sqrt\_pp1dpp2   \&}
\DoxyCodeLine{1032                     +( p2(2) + (0d0,1d0)*p2(3) )*sqrt\_pp1dpp2}
\DoxyCodeLine{1033         acurrent(3)= ( (0d0,1d0)*p1(2) + p1(3) )/sqrt\_pp1dpp2   \&}
\DoxyCodeLine{1034                     -\/( (0d0,1d0)*p2(2) -\/ p2(3) )*sqrt\_pp1dpp2}
\DoxyCodeLine{1035         acurrent(4)=sqrt\_pp1xpp2          \&}
\DoxyCodeLine{1036                     -\/( p1(2) -\/ (0d0,1d0)*p1(3) )                \&}
\DoxyCodeLine{1037                     *( p2(2) + (0d0,1d0)*p2(3) )/sqrt\_pp1xpp2}
\DoxyCodeLine{1038 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{1039 }
\DoxyCodeLine{1040 \textcolor{comment}{!     print *, pdg\_code1,h1,dble(pdg\_code1)*h1,'!'}}
\DoxyCodeLine{1041       \textcolor{keywordflow}{if}( (dble(pdg\_code1)*h1) .lt. 0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{1042 \textcolor{comment}{!       print *, Acurrent}}
\DoxyCodeLine{1043         \textcolor{keywordflow}{do} mu=1,4}
\DoxyCodeLine{1044           acurrent(mu)=-\/dconjg(acurrent(mu))}
\DoxyCodeLine{1045 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{1046 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{1047 }
\DoxyCodeLine{1048       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a926f6f83bda8f4e2da0d80d7486dc931}\label{namespacemodvhiggs_a926f6f83bda8f4e2da0d80d7486dc931}} 
\index{modvhiggs@{modvhiggs}!ffp@{ffp}}
\index{ffp@{ffp}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{ffp()}{ffp()}}
{\footnotesize\ttfamily complex(8) function modvhiggs\+::ffp (\begin{DoxyParamCaption}\item[{integer}]{pdg\+\_\+code1,  }\item[{real(8), dimension(4)}]{p1,  }\item[{real(8)}]{h1,  }\item[{integer}]{pdg\+\_\+code2,  }\item[{real(8), dimension(4)}]{p2,  }\item[{real(8)}]{h2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 945 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{945 }
\DoxyCodeLine{946       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{947 \textcolor{keywordtype}{      real}(8), \textcolor{keywordtype}{parameter} :: epsilon = 1d-\/13 \textcolor{comment}{!a small quantity slightly above machine precision}}
\DoxyCodeLine{948 }
\DoxyCodeLine{949 \textcolor{keywordtype}{      real}(8) p1(4), p2(4), h1, h2}
\DoxyCodeLine{950       \textcolor{keywordtype}{integer} pdg\_code1, pdg\_code2}
\DoxyCodeLine{951 \textcolor{keywordtype}{      real}(8) sqrt\_pp1Dpp2}
\DoxyCodeLine{952 }
\DoxyCodeLine{953       \textcolor{keywordflow}{if}( ( dble(pdg\_code1) *h1* dble(pdg\_code2) *h2 ).gt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{954         ffp=0d0}
\DoxyCodeLine{955 }
\DoxyCodeLine{956       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( ( dabs( p1(1)+p1(4) ).lt.epsilon ).and. (   dabs( p2(1)+p2\textcolor{comment}{(4) ).lt.epsilon ) )}\textcolor{keywordflow}{then}}
\DoxyCodeLine{957         ffp=0d0}
\DoxyCodeLine{958       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(   dabs( p1(1)+p1(4) ).lt.epsilon )\textcolor{keywordflow}{then}}
\DoxyCodeLine{959         ffp=-\/dsqrt(2d0*p1(1)*(p2(1)+p2(4)))}
\DoxyCodeLine{960       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(   dabs( p2(1)+p2(4) ).lt.epsilon )\textcolor{keywordflow}{then}}
\DoxyCodeLine{961         ffp= dsqrt(2d0*p2(1)*(p1(1)+p1(4)))}
\DoxyCodeLine{962       \textcolor{keywordflow}{else}}
\DoxyCodeLine{963         sqrt\_pp1dpp2 = dsqrt((p1(1)+p1(4))/(p2(1)+p2(4)))}
\DoxyCodeLine{964         ffp=(p2(2)-\/(0d0,1d0)*p2(3))*sqrt\_pp1dpp2-\/ (p1(2)-\/(0d0,1d0)*p1(3)\textcolor{comment}{)/sqrt\_pp1dpp2}}
\DoxyCodeLine{965 \textcolor{comment}{}\textcolor{keywordflow}{      endif}}
\DoxyCodeLine{966 }
\DoxyCodeLine{967       ffp=ffp*(0d0,-\/1d0)}
\DoxyCodeLine{968 }
\DoxyCodeLine{969       \textcolor{keywordflow}{if}( (dble(pdg\_code1)*h1) .lt. 0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{970         ffp=-\/dconjg(ffp)}
\DoxyCodeLine{971 }
\DoxyCodeLine{972 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{973 }
\DoxyCodeLine{974       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a64ea6caa1e8747bbec05f63d21bcf9c0}\label{namespacemodvhiggs_a64ea6caa1e8747bbec05f63d21bcf9c0}} 
\index{modvhiggs@{modvhiggs}!ffs@{ffs}}
\index{ffs@{ffs}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{ffs()}{ffs()}}
{\footnotesize\ttfamily complex(8) function modvhiggs\+::ffs (\begin{DoxyParamCaption}\item[{integer}]{pdg\+\_\+code1,  }\item[{real(8), dimension(4)}]{p1,  }\item[{real(8)}]{h1,  }\item[{integer}]{pdg\+\_\+code2,  }\item[{real(8), dimension(4)}]{p2,  }\item[{real(8)}]{h2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1056 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1056 }
\DoxyCodeLine{1057       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1058 \textcolor{keywordtype}{      real}(8), \textcolor{keywordtype}{parameter} :: epsilon = 1d-\/13 \textcolor{comment}{!a small quantity slightly above machine precision}}
\DoxyCodeLine{1059 }
\DoxyCodeLine{1060 \textcolor{keywordtype}{      real}(8) p1(4), p2(4), h1, h2}
\DoxyCodeLine{1061       \textcolor{keywordtype}{integer} pdg\_code1, pdg\_code2}
\DoxyCodeLine{1062 \textcolor{keywordtype}{      real}(8) sqrt\_pp1Dpp2}
\DoxyCodeLine{1063 }
\DoxyCodeLine{1064       ffs = (0d0,0d0)}
\DoxyCodeLine{1065 }
\DoxyCodeLine{1066       \textcolor{keywordflow}{if}( ( dble(pdg\_code1) *h1* dble(pdg\_code2) *h2 ).gt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{1067         ffs=0d0}
\DoxyCodeLine{1068 }
\DoxyCodeLine{1069       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( ( dabs( p1(1)+p1(4) ).lt.epsilon ).and. (   dabs( p2(1)+p2\textcolor{comment}{(4) ).lt.epsilon ) )}\textcolor{keywordflow}{then}}
\DoxyCodeLine{1070         ffs=0d0}
\DoxyCodeLine{1071       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(   dabs( p1(1)+p1(4) ).lt.epsilon )\textcolor{keywordflow}{then}}
\DoxyCodeLine{1072         ffs=-\/dsqrt(2d0*p1(1)*(p2(1)+p2(4)))}
\DoxyCodeLine{1073       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(   dabs( p2(1)+p2(4) ).lt.epsilon )\textcolor{keywordflow}{then}}
\DoxyCodeLine{1074         ffs= dsqrt(2d0*p2(1)*(p1(1)+p1(4)))}
\DoxyCodeLine{1075       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1076         sqrt\_pp1dpp2 = dsqrt((p1(1)+p1(4))/(p2(1)+p2(4)))}
\DoxyCodeLine{1077         ffs=(p2(2)-\/(0d0,1d0)*p2(3))*sqrt\_pp1dpp2-\/ (p1(2)-\/(0d0,1d0)*p1(3)\textcolor{comment}{)/sqrt\_pp1dpp2}}
\DoxyCodeLine{1078 \textcolor{comment}{}\textcolor{keywordflow}{      endif}}
\DoxyCodeLine{1079 }
\DoxyCodeLine{1080       \textcolor{keywordflow}{if}( (dble(pdg\_code1)*h1) .lt. 0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{1081         ffs=-\/dconjg(ffs)}
\DoxyCodeLine{1082 }
\DoxyCodeLine{1083 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{1084 }
\DoxyCodeLine{1085       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a30a6069406e7d45001e9c54034b76fe0}\label{namespacemodvhiggs_a30a6069406e7d45001e9c54034b76fe0}} 
\index{modvhiggs@{modvhiggs}!ffv@{ffv}}
\index{ffv@{ffv}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{ffv()}{ffv()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::ffv (\begin{DoxyParamCaption}\item[{integer}]{pdg\+\_\+code1,  }\item[{real(8), dimension(4)}]{p1,  }\item[{real(8)}]{h1,  }\item[{integer}]{pdg\+\_\+code2,  }\item[{real(8), dimension(4)}]{p2,  }\item[{real(8)}]{h2,  }\item[{complex(8), dimension(4)}]{Vcurrent }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1094 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1094 }
\DoxyCodeLine{1095       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1096 \textcolor{keywordtype}{      real}(8), \textcolor{keywordtype}{parameter} :: epsilon = 1d-\/13 \textcolor{comment}{!a small quantity slightly above machine precision}}
\DoxyCodeLine{1097 }
\DoxyCodeLine{1098 \textcolor{keywordtype}{      real}(8) p1(4), p2(4), h1, h2}
\DoxyCodeLine{1099       \textcolor{keywordtype}{integer} pdg\_code1, pdg\_code2}
\DoxyCodeLine{1100 \textcolor{keywordtype}{      real}(8) sqrt\_pp1Dpp2, sqrt\_pp1Xpp2}
\DoxyCodeLine{1101       \textcolor{keywordtype}{complex(8)} Vcurrent(4)}
\DoxyCodeLine{1102       \textcolor{keywordtype}{integer} mu}
\DoxyCodeLine{1103 }
\DoxyCodeLine{1104       vcurrent = (0d0,0d0)}
\DoxyCodeLine{1105 }
\DoxyCodeLine{1106       \textcolor{keywordflow}{if}( ( dble(pdg\_code1) *h1* dble(pdg\_code2) *h2 ).lt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{1107         \textcolor{keywordflow}{do} mu=1,4}
\DoxyCodeLine{1108           vcurrent(mu)=0d0}
\DoxyCodeLine{1109 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{1110 }
\DoxyCodeLine{1111       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( ( dabs( p1(1)+p1(4) ).lt.epsilon ).and. ( dabs( p2(1)+p2(\textcolor{comment}{4) ).lt.epsilon ) )}\textcolor{keywordflow}{then}}
\DoxyCodeLine{1112 }
\DoxyCodeLine{1113         vcurrent(1)= 2d0*dsqrt(p1(1)*p2(1))}
\DoxyCodeLine{1114         vcurrent(2)= 0d0}
\DoxyCodeLine{1115         vcurrent(3)= 0d0}
\DoxyCodeLine{1116         vcurrent(4)=-\/vcurrent(1)}
\DoxyCodeLine{1117 }
\DoxyCodeLine{1118       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(   dabs( p1(1)+p1(4) ).lt.epsilon )\textcolor{keywordflow}{then}}
\DoxyCodeLine{1119 }
\DoxyCodeLine{1120         vcurrent(1)= dsqrt( 2d0*p1(1) / ( p2(1)+p2(4) ) ) *( p2(2) + (0d0\textcolor{comment}{,1d0)*p2(3) )}}
\DoxyCodeLine{1121 \textcolor{comment}{}        vcurrent(2)= dsqrt( 2d0*p1(1) * ( p2(1)+p2(4) ) )}
\DoxyCodeLine{1122         vcurrent(3)= (0d0,1d0)*vcurrent(2)}
\DoxyCodeLine{1123         vcurrent(4)=-\/vcurrent(1)}
\DoxyCodeLine{1124 }
\DoxyCodeLine{1125       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(   dabs( p2(1)+p2(4) ).lt.epsilon )\textcolor{keywordflow}{then}}
\DoxyCodeLine{1126 }
\DoxyCodeLine{1127         vcurrent(1)= dsqrt( 2d0*p2(1) / ( p1(1)+p1(4) ) ) *( p1(2) -\/ (0d0\textcolor{comment}{,1d0)*p1(3) )}}
\DoxyCodeLine{1128 \textcolor{comment}{}        vcurrent(2)= dsqrt( 2d0*p2(1) * ( p1(1)+p1(4) ) )}
\DoxyCodeLine{1129         vcurrent(3)=-\/(0d0,1d0)*vcurrent(2)}
\DoxyCodeLine{1130         vcurrent(4)=-\/vcurrent(1)}
\DoxyCodeLine{1131 }
\DoxyCodeLine{1132       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1133 }
\DoxyCodeLine{1134         sqrt\_pp1dpp2= dsqrt( (p1(1)+p1(4)) / (p2(1)+p2(4)) )}
\DoxyCodeLine{1135         sqrt\_pp1xpp2= dsqrt( (p1(1)+p1(4)) * (p2(1)+p2(4)) )}
\DoxyCodeLine{1136         vcurrent(1)= sqrt\_pp1xpp2  \&}
\DoxyCodeLine{1137                     +( p1(2) -\/ (0d0,1d0)*p1(3) )   \&}
\DoxyCodeLine{1138                     *( p2(2) + (0d0,1d0)*p2(3) )/sqrt\_pp1xpp2}
\DoxyCodeLine{1139         vcurrent(2)= ( p1(2) -\/ (0d0,1d0)*p1(3) )/sqrt\_pp1dpp2  \&}
\DoxyCodeLine{1140                     +( p2(2) + (0d0,1d0)*p2(3) )*sqrt\_pp1dpp2}
\DoxyCodeLine{1141         vcurrent(3)= ( (0d0,1d0)*p1(2) + p1(3) )/sqrt\_pp1dpp2  \&}
\DoxyCodeLine{1142                     -\/( (0d0,1d0)*p2(2) -\/ p2(3) )*sqrt\_pp1dpp2}
\DoxyCodeLine{1143         vcurrent(4)=sqrt\_pp1xpp2  \&}
\DoxyCodeLine{1144                     -\/( p1(2) -\/ (0d0,1d0)*p1(3) )   \&}
\DoxyCodeLine{1145                     *( p2(2) + (0d0,1d0)*p2(3) )/sqrt\_pp1xpp2}
\DoxyCodeLine{1146 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{1147 }
\DoxyCodeLine{1148       \textcolor{keywordflow}{if}( (dble(pdg\_code1)*h1) .lt. 0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{1149         \textcolor{keywordflow}{do} mu=1,4}
\DoxyCodeLine{1150           vcurrent(mu)=dconjg(vcurrent(mu))}
\DoxyCodeLine{1151 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{1152 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{1153 }
\DoxyCodeLine{1154       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a77464875921dc44d24203e95b67706a6}\label{namespacemodvhiggs_a77464875921dc44d24203e95b67706a6}} 
\index{modvhiggs@{modvhiggs}!getsme@{getsme}}
\index{getsme@{getsme}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{getsme()}{getsme()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::getsme (\begin{DoxyParamCaption}\item[{real(8), dimension(1\+:4,1\+:9)}]{p,  }\item[{integer, dimension(1\+:6)}]{Ferm\+Flav,  }\item[{complex(8), dimension(1\+:3,-\/1\+:+1,-\/1\+:+1)}]{S\+ME }\end{DoxyParamCaption})}



Definition at line 1682 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1682 \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacemodparameters}{modparameters}}}
\DoxyCodeLine{1683 \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacemodmisc}{modmisc}}}
\DoxyCodeLine{1684 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1685 \textcolor{keywordtype}{complex(8)} :: SME(1:3,-\/1:+1,-\/1:+1)}
\DoxyCodeLine{1686 \textcolor{keywordtype}{real}(8) :: sprod(9,9),p(1:4,1:9),IZfs(-\/1:+1)}
\DoxyCodeLine{1687 \textcolor{keywordtype}{complex(8)} :: za(9,9), zb(9,9),Prop}
\DoxyCodeLine{1688 \textcolor{keywordtype}{integer} :: FermFlav(1:6)}
\DoxyCodeLine{1689 }
\DoxyCodeLine{1690     \textcolor{keyword}{call }spinoru2(9,(/-\/p(1:4,1),-\/p(1:4,2),-\/p(1:4,1)-\/p(1:4,2),p(1:4,6)+p(1:4,7),p(1:4,8)+p(1:4,9),p(1:4,6),p(1:4,7),p(1:4,8),p(1:4,9)/),za,zb,sprod)}
\DoxyCodeLine{1691 }
\DoxyCodeLine{1692 }
\DoxyCodeLine{1693     \textcolor{comment}{! Z-\/final state couplings}}
\DoxyCodeLine{1694     \textcolor{keywordflow}{if}( isawdecay(decaymode1) ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1695         izfs(+1) = br   *ckm(fermflav(3),fermflav(4))}
\DoxyCodeLine{1696         izfs(-\/1) = bl   *ckm(fermflav(3),fermflav(4))}
\DoxyCodeLine{1697     \textcolor{keywordflow}{elseif}( abs(fermflav(3)).eq.11 .or. abs(fermflav(3)).eq.13 .or. abs(fermflav(3)).eq.15) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1698          izfs(-\/1)=al\_lep    * dsqrt(scale\_alpha\_z\_ll)}
\DoxyCodeLine{1699          izfs(+1)=ar\_lep    * dsqrt(scale\_alpha\_z\_ll)}
\DoxyCodeLine{1700     \textcolor{keywordflow}{elseif}( abs(fermflav(3)).eq.12 .or. abs(fermflav(3)).eq.14 .or. abs(fermflav(3)).eq.16 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1701          izfs(-\/1)=al\_neu    * dsqrt(scale\_alpha\_z\_nn)}
\DoxyCodeLine{1702          izfs(+1)=ar\_neu    * dsqrt(scale\_alpha\_z\_nn)}
\DoxyCodeLine{1703     \textcolor{keywordflow}{elseif}( abs(fermflav(3)).eq.2 .or. abs(fermflav(3)).eq.4 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1704          izfs(-\/1)=al\_qup    * dsqrt(scale\_alpha\_z\_uu)}
\DoxyCodeLine{1705          izfs(+1)=ar\_qup    * dsqrt(scale\_alpha\_z\_uu)}
\DoxyCodeLine{1706     \textcolor{keywordflow}{elseif}( abs(fermflav(3)).eq.1 .or. abs(fermflav(3)).eq.3 .or. abs(fermflav(3)).eq.5 ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1707          izfs(-\/1)=al\_qdn    * dsqrt(scale\_alpha\_z\_dd)}
\DoxyCodeLine{1708          izfs(+1)=ar\_qdn    * dsqrt(scale\_alpha\_z\_dd)}
\DoxyCodeLine{1709     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1710          \textcolor{keyword}{call }\mbox{\hyperlink{namespacemodmisc_a67da31b838636e613886adf687dd9040}{error}}(\textcolor{stringliteral}{"Wrong flavor in getSME"},fermflav(3))}
\DoxyCodeLine{1711 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{1712 }
\DoxyCodeLine{1713     sme(1,+1,+1) =  -\/2*izfs(1)*za(1,7)*zb(2,6)}
\DoxyCodeLine{1714     sme(2,+1,+1) =  izfs(1)*(za(1,6)*zb(2,6) + za(1,7)*zb(2,7))*(za(7,8)*zb(6,8) + za(7,9)*zb(6,9))}
\DoxyCodeLine{1715     sme(3,+1,+1) = ci*izfs(1)*(za(1,7)*(za(7,8)*zb(2,8) + za(7,9)*zb(2,9))*zb(6,7) + za(6,7)*zb(2,6)*(za(1,8)*zb(6,8) + za(1,9)*zb(6,9)))}
\DoxyCodeLine{1716     sme(1,+1,-\/1) =  -\/2*izfs(-\/1)*za(1,6)*zb(2,7)}
\DoxyCodeLine{1717     sme(2,+1,-\/1) =  izfs(-\/1)*(za(1,6)*zb(2,6) + za(1,7)*zb(2,7))*(za(6,8)*zb(7,8) + za(6,9)*zb(7,9))}
\DoxyCodeLine{1718     sme(3,+1,-\/1) = ci*izfs(-\/1)*(-\/(za(1,7)*zb(2,7)*(za(6,8)*zb(7,8) + za(6,9)*zb(7,9))) + za(1,6)*(za(6,8)*(-\/(zb(2,7)*zb(6,8)) + zb(2,6)*zb(7,8)) + zb(2,7)*(za(7,8)*zb(7,8) + za(7,9)*zb(7,9)) + za(6,9)*(-\/(zb(2,7)*zb(6,9)) + zb(2,6)*zb(7,9))))}
\DoxyCodeLine{1719     sme(1,-\/1,+1) = -\/2*izfs(1)*za(2,7)*zb(1,6)}
\DoxyCodeLine{1720     sme(2,-\/1,+1) = izfs(1)*(za(2,6)*zb(1,6) + za(2,7)*zb(1,7))*(za(7,8)*zb(6,8) + za(7,9)*zb(6,9))}
\DoxyCodeLine{1721     sme(3,-\/1,+1) = ci*izfs(1)*(za(2,7)*(za(7,8)*zb(1,8) + za(7,9)*zb(1,9))*zb(6,7) + za(6,7)*zb(1,6)*(za(2,8)*zb(6,8) + za(2,9)*zb(6,9)))}
\DoxyCodeLine{1722     sme(1,-\/1,-\/1) = -\/2*izfs(-\/1)*za(2,6)*zb(1,7)}
\DoxyCodeLine{1723     sme(2,-\/1,-\/1) =  izfs(-\/1)*(za(2,6)*zb(1,6) + za(2,7)*zb(1,7))*(za(6,8)*zb(7,8) + za(6,9)*zb(7,9))}
\DoxyCodeLine{1724     sme(3,-\/1,-\/1) =   -\/(ci*izfs(-\/1)*(za(2,6)*(za(6,8)*zb(1,8) + za(6,9)*zb(1,9))*zb(6,7) + za(6,7)*zb(1,7)*(za(2,8)*zb(7,8) + za(2,9)*zb(7,9))))}
\DoxyCodeLine{1725 }
\DoxyCodeLine{1726     prop = (0d0,1d0)/(2*(p(1:4,6).dot.p(1:4,7)) -\/ m\_v**2 + (0d0,1d0)*m\_v*ga\_v )}
\DoxyCodeLine{1727     sme(:,:,:) = sme(:,:,:) * prop}
\DoxyCodeLine{1728 }
\DoxyCodeLine{1729 \textcolor{keywordflow}{RETURN}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a455f025fd2a80c7ee87143c4195d8d62}\label{namespacemodvhiggs_a455f025fd2a80c7ee87143c4195d8d62}} 
\index{modvhiggs@{modvhiggs}!getvpffcoupling\_vh@{getvpffcoupling\_vh}}
\index{getvpffcoupling\_vh@{getvpffcoupling\_vh}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{getvpffcoupling\_vh()}{getvpffcoupling\_vh()}}
{\footnotesize\ttfamily complex(8) function modvhiggs\+::getvpffcoupling\+\_\+vh (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{pdgid,  }\item[{integer, intent(in)}]{hel,  }\item[{logical, intent(in)}]{use\+Wp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 661 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{661 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: pdgid}
\DoxyCodeLine{662 \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: hel}
\DoxyCodeLine{663 \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)} :: useWp}
\DoxyCodeLine{664 \textcolor{keywordtype}{complex(8)} :: GetVpffCoupling\_VH}
\DoxyCodeLine{665    getvpffcoupling\_vh=vpffcoupling\_pdg(pdgid,hel,usewp)}
\DoxyCodeLine{666    \textcolor{keywordflow}{if}(usewp) \textcolor{keywordflow}{then}}
\DoxyCodeLine{667      getvpffcoupling\_vh = getvpffcoupling\_vh / bl \textcolor{comment}{! Bc of the couplings formalism from decay}}
\DoxyCodeLine{668    \textcolor{keywordflow}{else}}
\DoxyCodeLine{669      getvpffcoupling\_vh = getvpffcoupling\_vh / 2.0\_dp}
\DoxyCodeLine{670 \textcolor{keywordflow}{   endif}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a143ff485ec2f65c44b09d914dcdfa9c3}\label{namespacemodvhiggs_a143ff485ec2f65c44b09d914dcdfa9c3}} 
\index{modvhiggs@{modvhiggs}!inv\_lorentz@{inv\_lorentz}}
\index{inv\_lorentz@{inv\_lorentz}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{inv\_lorentz()}{inv\_lorentz()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::inv\+\_\+lorentz (\begin{DoxyParamCaption}\item[{real(8), dimension(4)}]{vector,  }\item[{real(8), dimension(4)}]{boost }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1166 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1166 }
\DoxyCodeLine{1167       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1168 }
\DoxyCodeLine{1169 \textcolor{keywordtype}{      real}(8) vector(4), boost(4)}
\DoxyCodeLine{1170 \textcolor{keywordtype}{      real}(8) lambda(4,4), vector\_copy(4)}
\DoxyCodeLine{1171 \textcolor{keywordtype}{      real}(8) beta(2:4), beta\_sq, gamma}
\DoxyCodeLine{1172       \textcolor{keywordtype}{integer} i,j}
\DoxyCodeLine{1173 }
\DoxyCodeLine{1174       \textcolor{keywordflow}{do} i=2,4}
\DoxyCodeLine{1175         beta(i) = -\/boost(i)/boost(1)}
\DoxyCodeLine{1176 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1177 }
\DoxyCodeLine{1178       beta\_sq = beta(2)**2+beta(3)**2+beta(4)**2}
\DoxyCodeLine{1179 }
\DoxyCodeLine{1180       gamma = 1d0/dsqrt(1d0-\/beta\_sq)}
\DoxyCodeLine{1181 }
\DoxyCodeLine{1182       lambda(1,1) = gamma}
\DoxyCodeLine{1183 }
\DoxyCodeLine{1184       \textcolor{keywordflow}{do} i=2,4}
\DoxyCodeLine{1185         lambda(1,i) = gamma*beta(i)}
\DoxyCodeLine{1186         lambda(i,1) = lambda(1,i)}
\DoxyCodeLine{1187 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1188 }
\DoxyCodeLine{1189       \textcolor{keywordflow}{do} i=2,4}
\DoxyCodeLine{1190       \textcolor{keywordflow}{do} j=2,4}
\DoxyCodeLine{1191         lambda(i,j) = (gamma-\/1d0)*beta(i)*beta(j)/beta\_sq + \mbox{\hyperlink{namespacemodkinematics_a094ac37cdd50d55addcf65cbb41929c2}{kronecker\_delta}}\textcolor{comment}{(i,j)}}
\DoxyCodeLine{1192 \textcolor{comment}{}\textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1193 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1194 }
\DoxyCodeLine{1195 \textcolor{comment}{!apply boost to vector1}}
\DoxyCodeLine{1196       vector\_copy = vector}
\DoxyCodeLine{1197       vector = 0d0}
\DoxyCodeLine{1198       \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{1199       \textcolor{keywordflow}{do} j=1,4}
\DoxyCodeLine{1200         vector(i) = vector(i) + lambda(i,j)*vector\_copy(j)}
\DoxyCodeLine{1201 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1202 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1203 }
\DoxyCodeLine{1204       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a0311b7e52431406b8109f386ecd490c7}\label{namespacemodvhiggs_a0311b7e52431406b8109f386ecd490c7}} 
\index{modvhiggs@{modvhiggs}!kronecker\_delta@{kronecker\_delta}}
\index{kronecker\_delta@{kronecker\_delta}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{kronecker\_delta()}{kronecker\_delta()}}
{\footnotesize\ttfamily real(8) function modvhiggs\+::kronecker\+\_\+delta (\begin{DoxyParamCaption}\item[{integer}]{i,  }\item[{integer}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1212 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1212       \textcolor{keywordtype}{integer} i,j}
\DoxyCodeLine{1213       \textcolor{keywordflow}{if}(i.eq.j)\textcolor{keywordflow}{then}}
\DoxyCodeLine{1214         \mbox{\hyperlink{namespacemodkinematics_a094ac37cdd50d55addcf65cbb41929c2}{kronecker\_delta}} = 1d0}
\DoxyCodeLine{1215       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1216         \mbox{\hyperlink{namespacemodkinematics_a094ac37cdd50d55addcf65cbb41929c2}{kronecker\_delta}} = 0d0}
\DoxyCodeLine{1217 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{1218 }
\DoxyCodeLine{1219       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a2b92d6c943a6d350bfe0dbe805ec8ef7}\label{namespacemodvhiggs_a2b92d6c943a6d350bfe0dbe805ec8ef7}} 
\index{modvhiggs@{modvhiggs}!matrixelement0@{matrixelement0}}
\index{matrixelement0@{matrixelement0}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{matrixelement0()}{matrixelement0()}}
{\footnotesize\ttfamily complex(8) function modvhiggs\+::matrixelement0 (\begin{DoxyParamCaption}\item[{real(8), dimension(1\+:4,1\+:9), intent(in)}]{Mom\+Ext,  }\item[{real(8), dimension(3\+:5,1\+:2), intent(in)}]{mass,  }\item[{real(8), dimension(9), intent(in)}]{helicity,  }\item[{integer, dimension(9), intent(in)}]{id,  }\item[{logical, dimension(2), intent(in)}]{useA }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 104 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{104       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{105 \textcolor{keywordtype}{      real}(8), \textcolor{keywordtype}{intent(in)} :: MomExt(1:4,1:9)}
\DoxyCodeLine{106 \textcolor{keywordtype}{      real}(8), \textcolor{keywordtype}{intent(in)} :: mass(3:5,1:2)}
\DoxyCodeLine{107 \textcolor{keywordtype}{      real}(8), \textcolor{keywordtype}{intent(in)} :: helicity(9)}
\DoxyCodeLine{108       \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: id(9)}
\DoxyCodeLine{109       \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(in)} :: useA(2)}
\DoxyCodeLine{110 }
\DoxyCodeLine{111       \textcolor{keywordtype}{integer} mu3,mu4}
\DoxyCodeLine{112 \textcolor{keywordtype}{      real}(8) qq,q3\_q3,q4\_q4,q5\_q5}
\DoxyCodeLine{113       \textcolor{keywordtype}{complex(8)} PVVX0P}
\DoxyCodeLine{114       \textcolor{keywordtype}{complex(8)} Vcurrent1(4), Acurrent1(4), current1(4), currentVp1(4)}
\DoxyCodeLine{115       \textcolor{keywordtype}{complex(8)} Vcurrent2(4), Acurrent2(4), current2(4), currentVp2(4)}
\DoxyCodeLine{116       \textcolor{keywordtype}{complex(8)} Vpffcoupl(2,2)}
\DoxyCodeLine{117       \textcolor{keywordtype}{complex(8)} POL1(3,4), POL2(3,4)}
\DoxyCodeLine{118       \textcolor{keywordtype}{complex(8)} g\_mu\_nu(4,4), pp(4,4), epp(4,4)}
\DoxyCodeLine{119       \textcolor{keywordtype}{complex(8)} PROP1, PROP2, PROP3}
\DoxyCodeLine{120       \textcolor{keywordtype}{complex(8)} PROP\_Vp1, PROP\_Vp2}
\DoxyCodeLine{121       \textcolor{keywordtype}{complex(8)} gFFZ, gFFA, gFFW}
\DoxyCodeLine{122       \textcolor{keywordtype}{complex(8)} gVVP, gVVS1, gVVS2}
\DoxyCodeLine{123       \textcolor{keywordtype}{complex(8)} ghz1\_dyn,ghz2\_dyn,ghz3\_dyn,ghz4\_dyn}
\DoxyCodeLine{124       \textcolor{keywordtype}{complex(8)} gVVpP, gVVpS1, gVVpS2}
\DoxyCodeLine{125       \textcolor{keywordtype}{complex(8)} ghzzp1\_dyn,ghzzp2\_dyn,ghzzp3\_dyn,ghzzp4\_dyn}
\DoxyCodeLine{126       \textcolor{keywordtype}{complex(8)} gVpVP, gVpVS1, gVpVS2}
\DoxyCodeLine{127       \textcolor{keywordtype}{complex(8)} ghzpz1\_dyn,ghzpz2\_dyn,ghzpz3\_dyn,ghzpz4\_dyn}
\DoxyCodeLine{128       \textcolor{keywordtype}{complex(8)} gVpVpP, gVpVpS1, gVpVpS2}
\DoxyCodeLine{129       \textcolor{keywordtype}{complex(8)} ghzpzp1\_dyn,ghzpzp2\_dyn,ghzpzp3\_dyn,ghzpzp4\_dyn}
\DoxyCodeLine{130 }
\DoxyCodeLine{131       matrixelement0=czero}
\DoxyCodeLine{132       \textcolor{keywordflow}{if}( \&}
\DoxyCodeLine{133          (id(1).ne.convertlhe(pho\_) .and. usea(1) .and. .not.includegammastar\textcolor{comment}{) .or. \&}}
\DoxyCodeLine{134 \textcolor{comment}{}         (id(6).ne.convertlhe(pho\_) .and. usea(2) .and. .not.includegammastar\textcolor{comment}{) .or. \&}}
\DoxyCodeLine{135 \textcolor{comment}{}         ((id(1)+id(2)).ne.0 .and. id(1).ne.convertlhe(pho\_) .and. usea(\textcolor{comment}{1)) .or. \&}}
\DoxyCodeLine{136 \textcolor{comment}{}         ((id(6)+id(7)).ne.0 .and. id(6).ne.convertlhe(pho\_) .and. usea(\textcolor{comment}{2))      \&}}
\DoxyCodeLine{137 \textcolor{comment}{}        ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{138          \textcolor{keywordflow}{return}}
\DoxyCodeLine{139 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{140 }
\DoxyCodeLine{141       vcurrent1 = czero}
\DoxyCodeLine{142       acurrent1 = czero}
\DoxyCodeLine{143       vcurrent2 = czero}
\DoxyCodeLine{144       acurrent2 = czero}
\DoxyCodeLine{145       vpffcoupl=czero}
\DoxyCodeLine{146       currentvp1=czero}
\DoxyCodeLine{147       currentvp2=czero}
\DoxyCodeLine{148       prop\_vp1=czero}
\DoxyCodeLine{149       prop\_vp2=czero}
\DoxyCodeLine{150       ghzzp1\_dyn = czero}
\DoxyCodeLine{151       ghzzp2\_dyn = czero}
\DoxyCodeLine{152       ghzzp3\_dyn = czero}
\DoxyCodeLine{153       ghzzp4\_dyn = czero}
\DoxyCodeLine{154       ghzpz1\_dyn = czero}
\DoxyCodeLine{155       ghzpz2\_dyn = czero}
\DoxyCodeLine{156       ghzpz3\_dyn = czero}
\DoxyCodeLine{157       ghzpz4\_dyn = czero}
\DoxyCodeLine{158       ghzpzp1\_dyn = czero}
\DoxyCodeLine{159       ghzpzp2\_dyn = czero}
\DoxyCodeLine{160       ghzpzp3\_dyn = czero}
\DoxyCodeLine{161       ghzpzp4\_dyn = czero}
\DoxyCodeLine{162       gvvpp = czero}
\DoxyCodeLine{163       gvvps1 = czero}
\DoxyCodeLine{164       gvvps2 = czero}
\DoxyCodeLine{165       gvpvp = czero}
\DoxyCodeLine{166       gvpvs1 = czero}
\DoxyCodeLine{167       gvpvs2 = czero}
\DoxyCodeLine{168       gvpvpp = czero}
\DoxyCodeLine{169       gvpvps1 = czero}
\DoxyCodeLine{170       gvpvps2 = czero}
\DoxyCodeLine{171 }
\DoxyCodeLine{172       gffz = ci*2d0*dsqrt(couplzffsq) \textcolor{comment}{! = sqrt(gwsq/(1.0\_dp-\/xw))}}
\DoxyCodeLine{173       gffa = -\/ci*dsqrt(couplaffsq) \textcolor{comment}{! = sqrt(gwsq*xw)}}
\DoxyCodeLine{174       gffw = ci*dsqrt(couplwffsq) \textcolor{comment}{! = sqrt(gwsq/2.0\_dp)}}
\DoxyCodeLine{175 }
\DoxyCodeLine{176       qq = -\/\mbox{\hyperlink{namespacemodmisc_a3f09f85d546e0284b955a11b37ef1310}{scr}}(momext(:,3),momext(:,4))}
\DoxyCodeLine{177       \textcolor{keywordflow}{if} (id(1).eq.convertlhe(pho\_) .and. usea(1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{178          q3\_q3 = 0d0}
\DoxyCodeLine{179       \textcolor{keywordflow}{else}}
\DoxyCodeLine{180          q3\_q3 = \mbox{\hyperlink{namespacemodmisc_a3f09f85d546e0284b955a11b37ef1310}{scr}}(momext(:,3),momext(:,3))}
\DoxyCodeLine{181 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{182       \textcolor{keywordflow}{if} (id(6).eq.convertlhe(pho\_) .and. usea(2)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{183          q4\_q4 = 0d0}
\DoxyCodeLine{184       \textcolor{keywordflow}{else}}
\DoxyCodeLine{185          q4\_q4 = \mbox{\hyperlink{namespacemodmisc_a3f09f85d546e0284b955a11b37ef1310}{scr}}(momext(:,4),momext(:,4))}
\DoxyCodeLine{186 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{187       q5\_q5 = \mbox{\hyperlink{namespacemodmisc_a3f09f85d546e0284b955a11b37ef1310}{scr}}(momext(:,5),momext(:,5))}
\DoxyCodeLine{188       prop3 = propagator(dsqrt(q5\_q5),mass(5,1),mass(5,2))}
\DoxyCodeLine{189 }
\DoxyCodeLine{190       \textcolor{keywordflow}{if} (includevprime) \textcolor{keywordflow}{then}}
\DoxyCodeLine{191          \textcolor{keywordflow}{if}(.not.usea(1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{192             vpffcoupl(1,1)=getvpffcoupling\_vh(id(1), -\/1, ((id(1)+id(2)).ne.\textcolor{comment}{0))}}
\DoxyCodeLine{193 \textcolor{comment}{}            vpffcoupl(1,2)=getvpffcoupling\_vh(id(1), +1, ((id(1)+id(2)).ne.\textcolor{comment}{0))}}
\DoxyCodeLine{194 \textcolor{comment}{}\textcolor{keywordflow}{         endif}}
\DoxyCodeLine{195          \textcolor{keywordflow}{if}(.not.usea(2)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{196             vpffcoupl(2,1)=getvpffcoupling\_vh(id(6), -\/1, ((id(6)+id(7)).ne.\textcolor{comment}{0))}}
\DoxyCodeLine{197 \textcolor{comment}{}            vpffcoupl(2,2)=getvpffcoupling\_vh(id(6), +1, ((id(6)+id(7)).ne.\textcolor{comment}{0))}}
\DoxyCodeLine{198 \textcolor{comment}{}\textcolor{keywordflow}{         endif}}
\DoxyCodeLine{199 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{200 }
\DoxyCodeLine{201 }
\DoxyCodeLine{202       \textcolor{keywordflow}{if}(.not.usea(1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{203          prop1 = propagator(dsqrt(q3\_q3),mass(3,1),mass(3,2))}
\DoxyCodeLine{204          \textcolor{keywordflow}{if}(id(1).gt.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{205             \textcolor{keyword}{call }ffv(id(2), momext(:,2), helicity(2), id(1), momext(:,1)\textcolor{comment}{, helicity(1), vcurrent1)}}
\DoxyCodeLine{206 \textcolor{comment}{}            \textcolor{keyword}{call }ffa(id(2), momext(:,2), helicity(2), id(1), momext(:,1)\textcolor{comment}{, helicity(1), acurrent1)}}
\DoxyCodeLine{207 \textcolor{comment}{}         \textcolor{keywordflow}{else}}
\DoxyCodeLine{208             \textcolor{keyword}{call }ffv(id(1), momext(:,1), helicity(1), id(2), momext(:,2)\textcolor{comment}{, helicity(2), vcurrent1)}}
\DoxyCodeLine{209 \textcolor{comment}{}            \textcolor{keyword}{call }ffa(id(1), momext(:,1), helicity(1), id(2), momext(:,2)\textcolor{comment}{, helicity(2), acurrent1)}}
\DoxyCodeLine{210 \textcolor{comment}{}\textcolor{keywordflow}{         endif}}
\DoxyCodeLine{211 }
\DoxyCodeLine{212          \textcolor{comment}{! Vpff current without the prefactor}}
\DoxyCodeLine{213          \textcolor{keywordflow}{if} (includevprime) \textcolor{keywordflow}{then}}
\DoxyCodeLine{214             \textcolor{keywordflow}{if}((id(1)*helicity(1)).le.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{215                currentvp1=( \&}
\DoxyCodeLine{216                   vcurrent1*(vpffcoupl(1,1)+vpffcoupl(1,2))*0.5 -\/ \&}
\DoxyCodeLine{217                   acurrent1*(vpffcoupl(1,1)-\/vpffcoupl(1,2))*0.5   \&}
\DoxyCodeLine{218                   )}
\DoxyCodeLine{219             \textcolor{keywordflow}{else}}
\DoxyCodeLine{220                currentvp1=( \&}
\DoxyCodeLine{221                   vcurrent1*vpffcoupl(1,2)                        \&}
\DoxyCodeLine{222                   )}
\DoxyCodeLine{223 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{224 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{225 }
\DoxyCodeLine{226          \textcolor{comment}{!WH}}
\DoxyCodeLine{227          \textcolor{keywordflow}{if}((id(1)+id(2)).ne.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{228             \textcolor{keywordflow}{if} (includevprime) \textcolor{keywordflow}{then}}
\DoxyCodeLine{229                \textcolor{keywordflow}{if} (getmass(wppr\_).ge.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{230                   \textcolor{comment}{!print *,"Compute prop for Wppr"}}
\DoxyCodeLine{231                   prop\_vp1 = propagator(dsqrt(q3\_q3),getmass(wppr\_),getdecaywidth\textcolor{comment}{(wppr\_))}}
\DoxyCodeLine{232 \textcolor{comment}{}               \textcolor{keywordflow}{else}}
\DoxyCodeLine{233                   prop\_vp1 = propagator(m\_w,0d0,0d0)}
\DoxyCodeLine{234 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{235                currentvp1 = currentvp1*gffw*ckmbare(id(1),id(2))}
\DoxyCodeLine{236 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{237             \textcolor{keywordflow}{if}((id(1)*helicity(1)).le.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{238                current1=(vcurrent1-\/acurrent1)/2d0*gffw*ckmbare(id(1),id(\textcolor{comment}{2))}}
\DoxyCodeLine{239 \textcolor{comment}{}            \textcolor{keywordflow}{else}}
\DoxyCodeLine{240                current1=0d0}
\DoxyCodeLine{241 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{242          \textcolor{comment}{!ZH}}
\DoxyCodeLine{243          \textcolor{keywordflow}{else}}
\DoxyCodeLine{244             \textcolor{keywordflow}{if} (includevprime) \textcolor{keywordflow}{then}}
\DoxyCodeLine{245                \textcolor{keywordflow}{if} (getmass(zpr\_).ge.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{246                   \textcolor{comment}{!print *,"Compute prop for Zpr"}}
\DoxyCodeLine{247                   prop\_vp1 = propagator(dsqrt(q3\_q3),getmass(zpr\_),getdecaywidth\textcolor{comment}{(zpr\_))}}
\DoxyCodeLine{248 \textcolor{comment}{}               \textcolor{keywordflow}{else}}
\DoxyCodeLine{249                   prop\_vp1 = propagator(m\_z,0d0,0d0)}
\DoxyCodeLine{250 \textcolor{keywordflow}{               endif}}
\DoxyCodeLine{251                currentvp1 = currentvp1*gffz}
\DoxyCodeLine{252 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{253             \textcolor{comment}{!e+ e-\/ Z vertex for incoming states}}
\DoxyCodeLine{254             \textcolor{keywordflow}{if}((abs(id(1)).eq.11).or.(abs(id(1)).eq.13).or.(abs(id(1)).eq.\textcolor{comment}{15))}\textcolor{keywordflow}{then}}
\DoxyCodeLine{255               \textcolor{keywordflow}{if}((id(1)*helicity(1)).gt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{256                 current1=(0.5d0*t3lr -\/ qlr*sitw**2) *vcurrent1 -\/(0.5d0*t3lr\textcolor{comment}{)*acurrent1}}
\DoxyCodeLine{257 \textcolor{comment}{}              \textcolor{keywordflow}{else}}
\DoxyCodeLine{258                 current1=(0.5d0*t3ll -\/ qll*sitw**2) *vcurrent1 -\/(0.5d0*t3ll\textcolor{comment}{)*acurrent1}}
\DoxyCodeLine{259 \textcolor{comment}{}\textcolor{keywordflow}{              endif}}
\DoxyCodeLine{260               current1=current1*gffz}
\DoxyCodeLine{261             \textcolor{comment}{!u u\string~ Z vertex for incoming states}}
\DoxyCodeLine{262             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((abs(id(1)).eq.2).or.(abs(id(1)).eq.4))\textcolor{keywordflow}{then}}
\DoxyCodeLine{263               \textcolor{keywordflow}{if}((id(1)*helicity(1)).gt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{264                 current1=(0.5d0*t3ur -\/ qur*sitw**2) *vcurrent1 -\/(0.5d0*t3ur\textcolor{comment}{)*acurrent1}}
\DoxyCodeLine{265 \textcolor{comment}{}              \textcolor{keywordflow}{else}}
\DoxyCodeLine{266                 current1=(0.5d0*t3ul -\/ qul*sitw**2) *vcurrent1 -\/(0.5d0*t3ul\textcolor{comment}{)*acurrent1}}
\DoxyCodeLine{267 \textcolor{comment}{}\textcolor{keywordflow}{              endif}}
\DoxyCodeLine{268               current1=current1*gffz}
\DoxyCodeLine{269             \textcolor{comment}{!d d\string~ Z vertex for incoming states}}
\DoxyCodeLine{270             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((abs(id(1)).eq.1).or.(abs(id(1)).eq.3).or.(abs(id(1)\textcolor{comment}{).eq.5))}\textcolor{keywordflow}{then}}
\DoxyCodeLine{271               \textcolor{keywordflow}{if}((id(1)*helicity(1)).gt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{272                 current1=(0.5d0*t3dr -\/ qdr*sitw**2) *vcurrent1 -\/(0.5d0*t3dr\textcolor{comment}{)*acurrent1}}
\DoxyCodeLine{273 \textcolor{comment}{}              \textcolor{keywordflow}{else}}
\DoxyCodeLine{274                 current1=(0.5d0*t3dl -\/ qdl*sitw**2) *vcurrent1 -\/(0.5d0*t3dl\textcolor{comment}{)*acurrent1}}
\DoxyCodeLine{275 \textcolor{comment}{}\textcolor{keywordflow}{              endif}}
\DoxyCodeLine{276               current1=current1*gffz}
\DoxyCodeLine{277             \textcolor{keywordflow}{else}}
\DoxyCodeLine{278               current1=0d0}
\DoxyCodeLine{279               currentvp1=0d0}
\DoxyCodeLine{280               print *, \textcolor{stringliteral}{"invalid incoming state"}}
\DoxyCodeLine{281 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{282 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{283       \textcolor{keywordflow}{else}}
\DoxyCodeLine{284          \textcolor{keywordflow}{if}(abs(id(1)).eq.convertlhe(pho\_)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{285            prop1=cone}
\DoxyCodeLine{286            \textcolor{keywordflow}{if}((id(1)*helicity(1)).gt.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{287              \textcolor{keyword}{call }polarization\_single(momext(:,3),+1,vcurrent1)}
\DoxyCodeLine{288            \textcolor{keywordflow}{else}}
\DoxyCodeLine{289              \textcolor{keyword}{call }polarization\_single(momext(:,3),-\/1,vcurrent1)}
\DoxyCodeLine{290 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{291          \textcolor{keywordflow}{else}}
\DoxyCodeLine{292            prop1 = propagator(dsqrt(q3\_q3),0d0,0d0)}
\DoxyCodeLine{293            \textcolor{keywordflow}{if}(id(1).gt.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{294              \textcolor{keyword}{call }ffv(id(2), momext(:,2), helicity(2), id(1), momext(:,1\textcolor{comment}{), helicity(1), vcurrent1)}}
\DoxyCodeLine{295 \textcolor{comment}{}           \textcolor{keywordflow}{else}}
\DoxyCodeLine{296              \textcolor{keyword}{call }ffv(id(1), momext(:,1), helicity(1), id(2), momext(:,2\textcolor{comment}{), helicity(2), vcurrent1)}}
\DoxyCodeLine{297 \textcolor{comment}{}\textcolor{keywordflow}{           endif}}
\DoxyCodeLine{298 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{299 }
\DoxyCodeLine{300          \textcolor{comment}{!ZH}}
\DoxyCodeLine{301          \textcolor{keywordflow}{if}(abs(id(1)).eq.convertlhe(pho\_))\textcolor{keywordflow}{then}}
\DoxyCodeLine{302            current1=vcurrent1}
\DoxyCodeLine{303          \textcolor{comment}{!e+ e-\/ Z vertex for incoming states}}
\DoxyCodeLine{304          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((abs(id(1)).eq.11).or.(abs(id(1)).eq.13).or.(abs(id(1)).eq.\textcolor{comment}{15))}\textcolor{keywordflow}{then}}
\DoxyCodeLine{305            \textcolor{keywordflow}{if}((id(1)*helicity(1)).gt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{306              current1 = qlr*vcurrent1}
\DoxyCodeLine{307            \textcolor{keywordflow}{else}}
\DoxyCodeLine{308              current1 = qll*vcurrent1}
\DoxyCodeLine{309 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{310            current1=current1*gffa}
\DoxyCodeLine{311          \textcolor{comment}{!u u\string~ Z vertex for incoming states}}
\DoxyCodeLine{312          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((abs(id(1)).eq.2).or.(abs(id(1)).eq.4))\textcolor{keywordflow}{then}}
\DoxyCodeLine{313            \textcolor{keywordflow}{if}((id(1)*helicity(1)).gt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{314              current1 = qur*vcurrent1}
\DoxyCodeLine{315            \textcolor{keywordflow}{else}}
\DoxyCodeLine{316              current1 = qul*vcurrent1}
\DoxyCodeLine{317 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{318            current1=current1*gffa}
\DoxyCodeLine{319          \textcolor{comment}{!d d\string~ Z vertex for incoming states}}
\DoxyCodeLine{320          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((abs(id(1)).eq.1).or.(abs(id(1)).eq.3).or.(abs(id(1)).eq.\textcolor{comment}{5))}\textcolor{keywordflow}{then}}
\DoxyCodeLine{321            \textcolor{keywordflow}{if}((id(1)*helicity(1)).gt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{322              current1 = qdr*vcurrent1}
\DoxyCodeLine{323            \textcolor{keywordflow}{else}}
\DoxyCodeLine{324              current1 = qdl*vcurrent1}
\DoxyCodeLine{325 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{326            current1=current1*gffa}
\DoxyCodeLine{327          \textcolor{keywordflow}{else}}
\DoxyCodeLine{328            current1=0d0}
\DoxyCodeLine{329            print *, \textcolor{stringliteral}{"invalid incoming state"}}
\DoxyCodeLine{330 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{331 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{332 }
\DoxyCodeLine{333       \textcolor{keywordflow}{if}(.not.usea(2)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{334          prop2 = propagator(dsqrt(q4\_q4),mass(4,1),mass(4,2))}
\DoxyCodeLine{335 }
\DoxyCodeLine{336          \textcolor{keywordflow}{if}(id(6).gt.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{337            \textcolor{keyword}{call }ffv(id(6), momext(:,6), helicity(6), id(7), momext(:,7),\textcolor{comment}{ helicity(7), vcurrent2)}}
\DoxyCodeLine{338 \textcolor{comment}{}           \textcolor{keyword}{call }ffa(id(6), momext(:,6), helicity(6), id(7), momext(:,7),\textcolor{comment}{ helicity(7), acurrent2)}}
\DoxyCodeLine{339 \textcolor{comment}{}         \textcolor{keywordflow}{else}}
\DoxyCodeLine{340            \textcolor{keyword}{call }ffv(id(7), momext(:,7), helicity(7), id(6), momext(:,6),\textcolor{comment}{ helicity(6), vcurrent2)}}
\DoxyCodeLine{341 \textcolor{comment}{}           \textcolor{keyword}{call }ffa(id(7), momext(:,7), helicity(7), id(6), momext(:,6),\textcolor{comment}{ helicity(6), acurrent2)}}
\DoxyCodeLine{342 \textcolor{comment}{}\textcolor{keywordflow}{         endif}}
\DoxyCodeLine{343 }
\DoxyCodeLine{344          \textcolor{comment}{! Vpff current without the prefactor}}
\DoxyCodeLine{345          \textcolor{keywordflow}{if} (includevprime) \textcolor{keywordflow}{then}}
\DoxyCodeLine{346             \textcolor{keywordflow}{if}((id(6)*helicity(6)).le.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{347                currentvp2=( \&}
\DoxyCodeLine{348                   vcurrent2*(vpffcoupl(2,1)+vpffcoupl(2,2))*0.5 -\/ \&}
\DoxyCodeLine{349                   acurrent2*(vpffcoupl(2,1)-\/vpffcoupl(2,2))*0.5   \&}
\DoxyCodeLine{350                   )}
\DoxyCodeLine{351             \textcolor{keywordflow}{else}}
\DoxyCodeLine{352                currentvp2=( \&}
\DoxyCodeLine{353                   vcurrent2*vpffcoupl(2,2)                        \&}
\DoxyCodeLine{354                   )}
\DoxyCodeLine{355 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{356 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{357 }
\DoxyCodeLine{358          \textcolor{comment}{!WH}}
\DoxyCodeLine{359          \textcolor{keywordflow}{if}((id(6)+id(7)).ne.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{360            \textcolor{keywordflow}{if} (includevprime) \textcolor{keywordflow}{then}}
\DoxyCodeLine{361              \textcolor{keywordflow}{if} (getmass(wppr\_).ge.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{362                prop\_vp2 = propagator(dsqrt(q4\_q4),getmass(wppr\_),getdecaywidth\textcolor{comment}{(wppr\_))}}
\DoxyCodeLine{363 \textcolor{comment}{}             \textcolor{keywordflow}{else}}
\DoxyCodeLine{364                prop\_vp2 = propagator(m\_w,0d0,0d0)}
\DoxyCodeLine{365 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{366              currentvp2 = currentvp2*gffw*ckmbare(id(6),id(7))}
\DoxyCodeLine{367 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{368            \textcolor{keywordflow}{if}((id(6)*helicity(6)).le.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{369              current2=(vcurrent2-\/acurrent2)/2d0*gffw*ckm(id(6),id(7))}
\DoxyCodeLine{370            \textcolor{keywordflow}{else}}
\DoxyCodeLine{371              current2=0d0}
\DoxyCodeLine{372 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{373          \textcolor{comment}{!ZH}}
\DoxyCodeLine{374          \textcolor{keywordflow}{else}}
\DoxyCodeLine{375            \textcolor{keywordflow}{if} (includevprime) \textcolor{keywordflow}{then}}
\DoxyCodeLine{376              \textcolor{keywordflow}{if} (getmass(zpr\_).ge.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{377                prop\_vp2 = propagator(dsqrt(q4\_q4),getmass(zpr\_),getdecaywidth\textcolor{comment}{(zpr\_))}}
\DoxyCodeLine{378 \textcolor{comment}{}             \textcolor{keywordflow}{else}}
\DoxyCodeLine{379                prop\_vp2 = propagator(m\_z,0d0,0d0)}
\DoxyCodeLine{380 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{381              currentvp2 = currentvp2*gffz}
\DoxyCodeLine{382 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{383            \textcolor{comment}{!l+ l-\/ Z vertex for final state}}
\DoxyCodeLine{384            \textcolor{keywordflow}{if}((abs(id(6)).eq.11).or.(abs(id(6)).eq.13))\textcolor{keywordflow}{then}}
\DoxyCodeLine{385              \textcolor{keywordflow}{if}((id(6)*helicity(6)).gt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{386                current2=(0.5d0*t3lr -\/ qlr*sitw**2) *vcurrent2 -\/(0.5d0*t3lr\textcolor{comment}{)*acurrent2}}
\DoxyCodeLine{387 \textcolor{comment}{}             \textcolor{keywordflow}{else}}
\DoxyCodeLine{388                current2=(0.5d0*t3ll -\/ qll*sitw**2) *vcurrent2 -\/(0.5d0*t3ll\textcolor{comment}{)*acurrent2}}
\DoxyCodeLine{389 \textcolor{comment}{}\textcolor{keywordflow}{             endif}}
\DoxyCodeLine{390              current2=current2*gffz*dsqrt(scale\_alpha\_z\_ll)}
\DoxyCodeLine{391            \textcolor{comment}{!tau+ tau-\/ Z vertex for final state}}
\DoxyCodeLine{392            \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((abs(id(6)).eq.15))\textcolor{keywordflow}{then}}
\DoxyCodeLine{393              \textcolor{keywordflow}{if}((id(6)*helicity(6)).gt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{394                current2=(0.5d0*t3lr -\/ qlr*sitw**2) *vcurrent2 -\/(0.5d0*t3lr\textcolor{comment}{)*acurrent2}}
\DoxyCodeLine{395 \textcolor{comment}{}             \textcolor{keywordflow}{else}}
\DoxyCodeLine{396                current2=(0.5d0*t3ll -\/ qll*sitw**2) *vcurrent2 -\/(0.5d0*t3ll\textcolor{comment}{)*acurrent2}}
\DoxyCodeLine{397 \textcolor{comment}{}\textcolor{keywordflow}{             endif}}
\DoxyCodeLine{398              current2=current2*gffz*dsqrt(scale\_alpha\_z\_tt)}
\DoxyCodeLine{399            \textcolor{comment}{!u u\string~ Z vertex for final state}}
\DoxyCodeLine{400            \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((abs(id(6)).eq.2).or.(abs(id(6)).eq.4))\textcolor{keywordflow}{then}}
\DoxyCodeLine{401              \textcolor{keywordflow}{if}((id(6)*helicity(6)).gt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{402                current2=(0.5d0*t3ur -\/ qur*sitw**2) *vcurrent2 -\/(0.5d0*t3ur\textcolor{comment}{)*acurrent2}}
\DoxyCodeLine{403 \textcolor{comment}{}             \textcolor{keywordflow}{else}}
\DoxyCodeLine{404                current2=(0.5d0*t3ul -\/ qul*sitw**2) *vcurrent2 -\/(0.5d0*t3ul\textcolor{comment}{)*acurrent2}}
\DoxyCodeLine{405 \textcolor{comment}{}\textcolor{keywordflow}{             endif}}
\DoxyCodeLine{406              current2=current2*gffz*dsqrt(scale\_alpha\_z\_uu)}
\DoxyCodeLine{407            \textcolor{comment}{!d d\string~ Z vertex for final state}}
\DoxyCodeLine{408            \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((abs(id(6)).eq.1).or.(abs(id(6)).eq.3).or.(abs(id(6)).eq.\textcolor{comment}{5))}\textcolor{keywordflow}{then}}
\DoxyCodeLine{409              \textcolor{keywordflow}{if}((id(6)*helicity(6)).gt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{410                current2=(0.5d0*t3dr -\/ qdr*sitw**2) *vcurrent2 -\/(0.5d0*t3dr\textcolor{comment}{)*acurrent2}}
\DoxyCodeLine{411 \textcolor{comment}{}             \textcolor{keywordflow}{else}}
\DoxyCodeLine{412                current2=(0.5d0*t3dl -\/ qdl*sitw**2) *vcurrent2 -\/(0.5d0*t3dl\textcolor{comment}{)*acurrent2}}
\DoxyCodeLine{413 \textcolor{comment}{}\textcolor{keywordflow}{             endif}}
\DoxyCodeLine{414              current2=current2*gffz*dsqrt(scale\_alpha\_z\_dd)}
\DoxyCodeLine{415            \textcolor{comment}{!nu nu\string~ Z vertex for final state}}
\DoxyCodeLine{416            \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((abs(id(6)).eq.12).or.(abs(id(6)).eq.14).or.(abs(id(6\textcolor{comment}{)).eq.16))}\textcolor{keywordflow}{then}}
\DoxyCodeLine{417              current2=(0.5d0*t3nl -\/ qnl*sitw**2) *vcurrent2 -\/(0.5d0*t3nl\textcolor{comment}{)*acurrent2}}
\DoxyCodeLine{418 \textcolor{comment}{}             current2=current2*gffz*dsqrt(scale\_alpha\_z\_nn)}
\DoxyCodeLine{419            \textcolor{keywordflow}{else}}
\DoxyCodeLine{420              current2=0d0}
\DoxyCodeLine{421              currentvp2 = 0d0}
\DoxyCodeLine{422              print *, \textcolor{stringliteral}{"invalid final state"}, id(6:7), helicity(6:7)}
\DoxyCodeLine{423              stop}
\DoxyCodeLine{424 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{425 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{426       \textcolor{keywordflow}{else}}
\DoxyCodeLine{427          \textcolor{keywordflow}{if}(abs(id(6)).eq.convertlhe(pho\_)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{428            prop2=cone}
\DoxyCodeLine{429            \textcolor{keywordflow}{if}((id(6)*helicity(6)).gt.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{430              \textcolor{keyword}{call }polarization\_single(momext(:,4),+1,vcurrent2)}
\DoxyCodeLine{431            \textcolor{keywordflow}{else}}
\DoxyCodeLine{432              \textcolor{keyword}{call }polarization\_single(momext(:,4),-\/1,vcurrent2)}
\DoxyCodeLine{433 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{434            vcurrent2 = dconjg(vcurrent2)}
\DoxyCodeLine{435          \textcolor{keywordflow}{else}}
\DoxyCodeLine{436            prop2 = propagator(dsqrt(q4\_q4),0d0,0d0)}
\DoxyCodeLine{437            \textcolor{keywordflow}{if}(id(6).gt.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{438              \textcolor{keyword}{call }ffv(id(6), momext(:,6), helicity(6), id(7), momext(:,7\textcolor{comment}{), helicity(7), vcurrent2)}}
\DoxyCodeLine{439 \textcolor{comment}{}           \textcolor{keywordflow}{else}}
\DoxyCodeLine{440              \textcolor{keyword}{call }ffv(id(7), momext(:,7), helicity(7), id(6), momext(:,6\textcolor{comment}{), helicity(6), vcurrent2)}}
\DoxyCodeLine{441 \textcolor{comment}{}\textcolor{keywordflow}{           endif}}
\DoxyCodeLine{442 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{443 }
\DoxyCodeLine{444          \textcolor{comment}{!ZH}}
\DoxyCodeLine{445          \textcolor{keywordflow}{if}(abs(id(6)).eq.convertlhe(pho\_)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{446            current2=vcurrent2}
\DoxyCodeLine{447          \textcolor{comment}{!l+ l-\/ Z vertex for final state}}
\DoxyCodeLine{448          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((abs(id(6)).eq.11).or.(abs(id(6)).eq.13))\textcolor{keywordflow}{then}}
\DoxyCodeLine{449            \textcolor{keywordflow}{if}((id(6)*helicity(6)).gt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{450              current2=qlr*vcurrent2}
\DoxyCodeLine{451            \textcolor{keywordflow}{else}}
\DoxyCodeLine{452              current2=qll*vcurrent2}
\DoxyCodeLine{453 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{454            current2=current2*gffa*dsqrt(scale\_alpha\_z\_ll)}
\DoxyCodeLine{455          \textcolor{comment}{!tau+ tau-\/ Z vertex for final state}}
\DoxyCodeLine{456          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((abs(id(6)).eq.15))\textcolor{keywordflow}{then}}
\DoxyCodeLine{457            \textcolor{keywordflow}{if}((id(6)*helicity(6)).gt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{458              current2=qlr*vcurrent2}
\DoxyCodeLine{459            \textcolor{keywordflow}{else}}
\DoxyCodeLine{460              current2=qll*vcurrent2}
\DoxyCodeLine{461 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{462            current2=current2*gffa*dsqrt(scale\_alpha\_z\_tt)}
\DoxyCodeLine{463          \textcolor{comment}{!u u\string~ Z vertex for final state}}
\DoxyCodeLine{464          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((abs(id(6)).eq.2).or.(abs(id(6)).eq.4))\textcolor{keywordflow}{then}}
\DoxyCodeLine{465            \textcolor{keywordflow}{if}((id(6)*helicity(6)).gt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{466              current2=qur*vcurrent2}
\DoxyCodeLine{467            \textcolor{keywordflow}{else}}
\DoxyCodeLine{468              current2=qul*vcurrent2}
\DoxyCodeLine{469 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{470            current2=current2*gffa*dsqrt(scale\_alpha\_z\_uu)}
\DoxyCodeLine{471          \textcolor{comment}{!d d\string~ Z vertex for final state}}
\DoxyCodeLine{472          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((abs(id(6)).eq.1).or.(abs(id(6)).eq.3).or.(abs(id(6)).eq.\textcolor{comment}{5))}\textcolor{keywordflow}{then}}
\DoxyCodeLine{473            \textcolor{keywordflow}{if}((id(6)*helicity(6)).gt.0d0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{474              current2=qdr*vcurrent2}
\DoxyCodeLine{475            \textcolor{keywordflow}{else}}
\DoxyCodeLine{476              current2=qdl*vcurrent2}
\DoxyCodeLine{477 \textcolor{keywordflow}{           endif}}
\DoxyCodeLine{478            current2=current2*gffa*dsqrt(scale\_alpha\_z\_dd)}
\DoxyCodeLine{479          \textcolor{comment}{!nu nu\string~ Z vertex for final state}}
\DoxyCodeLine{480          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((abs(id(6)).eq.12).or.(abs(id(6)).eq.14).or.(abs(id(6)).eq.\textcolor{comment}{16))}\textcolor{keywordflow}{then}}
\DoxyCodeLine{481            current2=qnl*vcurrent2}
\DoxyCodeLine{482            current2=current2*gffa*dsqrt(scale\_alpha\_z\_nn)}
\DoxyCodeLine{483          \textcolor{keywordflow}{else}}
\DoxyCodeLine{484            current2=0d0}
\DoxyCodeLine{485            print *, \textcolor{stringliteral}{"invalid final state"}, id(6:7), helicity(6:7)}
\DoxyCodeLine{486            stop}
\DoxyCodeLine{487 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{488 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{489 }
\DoxyCodeLine{490       \textcolor{keywordflow}{if}(.not.(usea(1) .and. abs(id(1)).eq.convertlhe(pho\_))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{491          current1 = -\/current1 + \mbox{\hyperlink{namespacemodmisc_a656b78f23188708e38caa4b28bb1e5fb}{scrc}}(momext(:,3),current1)/q3\_q3}
\DoxyCodeLine{492          currentvp1 = -\/currentvp1 + \mbox{\hyperlink{namespacemodmisc_a656b78f23188708e38caa4b28bb1e5fb}{scrc}}(momext(:,3),currentvp1)/q3\_q3}
\DoxyCodeLine{493 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{494       \textcolor{keywordflow}{if}(.not.(usea(2) .and. abs(id(6)).eq.convertlhe(pho\_))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{495          current2 = -\/current2 + \mbox{\hyperlink{namespacemodmisc_a656b78f23188708e38caa4b28bb1e5fb}{scrc}}(momext(:,4),current2)/q4\_q4}
\DoxyCodeLine{496          currentvp2 = -\/currentvp2 + \mbox{\hyperlink{namespacemodmisc_a656b78f23188708e38caa4b28bb1e5fb}{scrc}}(momext(:,4),currentvp2)/q4\_q4}
\DoxyCodeLine{497 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{498 }
\DoxyCodeLine{499       \textcolor{comment}{!print *,"current1=",current1}}
\DoxyCodeLine{500       \textcolor{comment}{!print *,"currentVp1=",currentVp1}}
\DoxyCodeLine{501       \textcolor{comment}{!print *,"PROP1=",PROP1}}
\DoxyCodeLine{502       \textcolor{comment}{!print *,"PROP\_Vp1=",PROP\_Vp1}}
\DoxyCodeLine{503       \textcolor{comment}{!print *,"current2=",current2}}
\DoxyCodeLine{504       \textcolor{comment}{!print *,"currentVp2=",currentVp2}}
\DoxyCodeLine{505       \textcolor{comment}{!print *,"PROP2=",PROP2}}
\DoxyCodeLine{506       \textcolor{comment}{!print *,"PROP\_Vp2=",PROP\_Vp2}}
\DoxyCodeLine{507 }
\DoxyCodeLine{508       current1 = current1*prop1}
\DoxyCodeLine{509       current2 = current2*prop2}
\DoxyCodeLine{510       currentvp1 = currentvp1*prop\_vp1}
\DoxyCodeLine{511       currentvp2 = currentvp2*prop\_vp2}
\DoxyCodeLine{512 }
\DoxyCodeLine{513 \textcolor{comment}{!XVV vertex}}
\DoxyCodeLine{514       \textcolor{keywordflow}{if}(id(3).eq.convertlhe(wp\_))\textcolor{keywordflow}{then}}
\DoxyCodeLine{515          \textcolor{keyword}{call }\mbox{\hyperlink{interfacemodmisc_1_1swap}{swap}}(q3\_q3,q4\_q4)}
\DoxyCodeLine{516          \textcolor{keyword}{call }\mbox{\hyperlink{interfacemodmisc_1_1swap}{swap}}(current1,current2)}
\DoxyCodeLine{517          \textcolor{keyword}{call }\mbox{\hyperlink{interfacemodmisc_1_1swap}{swap}}(currentvp1,currentvp2)}
\DoxyCodeLine{518 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{519 }
\DoxyCodeLine{520       \textcolor{keywordflow}{if}(.not.usea(1) .and. .not.usea(2)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{521          ghz1\_dyn = hvvspinzerodynamiccoupling(1,q3\_q3,q4\_q4,q5\_q5)}
\DoxyCodeLine{522          ghz2\_dyn = hvvspinzerodynamiccoupling(2,q3\_q3,q4\_q4,q5\_q5)}
\DoxyCodeLine{523          ghz3\_dyn = hvvspinzerodynamiccoupling(3,q3\_q3,q4\_q4,q5\_q5)}
\DoxyCodeLine{524          ghz4\_dyn = hvvspinzerodynamiccoupling(4,q3\_q3,q4\_q4,q5\_q5)}
\DoxyCodeLine{525 }
\DoxyCodeLine{526          \textcolor{keywordflow}{if} (includevprime) \textcolor{keywordflow}{then}}
\DoxyCodeLine{527             ghzzp1\_dyn = hvvspinzerodynamiccoupling(12,q3\_q3,q4\_q4,q5\_q5\textcolor{comment}{)}}
\DoxyCodeLine{528 \textcolor{comment}{}            ghzzp2\_dyn = hvvspinzerodynamiccoupling(13,q3\_q3,q4\_q4,q5\_q5\textcolor{comment}{)}}
\DoxyCodeLine{529 \textcolor{comment}{}            ghzzp3\_dyn = hvvspinzerodynamiccoupling(14,q3\_q3,q4\_q4,q5\_q5\textcolor{comment}{)}}
\DoxyCodeLine{530 \textcolor{comment}{}            ghzzp4\_dyn = hvvspinzerodynamiccoupling(15,q3\_q3,q4\_q4,q5\_q5\textcolor{comment}{)}}
\DoxyCodeLine{531 \textcolor{comment}{}}
\DoxyCodeLine{532             ghzpz1\_dyn = hvvspinzerodynamiccoupling(12,q4\_q4,q3\_q3,q5\_q5\textcolor{comment}{)}}
\DoxyCodeLine{533 \textcolor{comment}{}            ghzpz2\_dyn = hvvspinzerodynamiccoupling(13,q4\_q4,q3\_q3,q5\_q5\textcolor{comment}{)}}
\DoxyCodeLine{534 \textcolor{comment}{}            ghzpz3\_dyn = hvvspinzerodynamiccoupling(14,q4\_q4,q3\_q3,q5\_q5\textcolor{comment}{)}}
\DoxyCodeLine{535 \textcolor{comment}{}            ghzpz4\_dyn = hvvspinzerodynamiccoupling(15,q4\_q4,q3\_q3,q5\_q5\textcolor{comment}{)}}
\DoxyCodeLine{536 \textcolor{comment}{}}
\DoxyCodeLine{537             ghzpzp1\_dyn = hvvspinzerodynamiccoupling(16,q3\_q3,q4\_q4,q5\_q5\textcolor{comment}{)}}
\DoxyCodeLine{538 \textcolor{comment}{}            ghzpzp2\_dyn = hvvspinzerodynamiccoupling(17,q3\_q3,q4\_q4,q5\_q5\textcolor{comment}{)}}
\DoxyCodeLine{539 \textcolor{comment}{}            ghzpzp3\_dyn = hvvspinzerodynamiccoupling(18,q3\_q3,q4\_q4,q5\_q5\textcolor{comment}{)}}
\DoxyCodeLine{540 \textcolor{comment}{}            ghzpzp4\_dyn = hvvspinzerodynamiccoupling(19,q3\_q3,q4\_q4,q5\_q5\textcolor{comment}{)}}
\DoxyCodeLine{541 \textcolor{comment}{}\textcolor{keywordflow}{         endif}}
\DoxyCodeLine{542       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(usea(1) .and. usea(2)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{543          ghz1\_dyn = czero}
\DoxyCodeLine{544          ghz2\_dyn = hvvspinzerodynamiccoupling(9,q3\_q3,q4\_q4,q5\_q5)}
\DoxyCodeLine{545          ghz3\_dyn = hvvspinzerodynamiccoupling(10,q3\_q3,q4\_q4,q5\_q5)}
\DoxyCodeLine{546          ghz4\_dyn = hvvspinzerodynamiccoupling(11,q3\_q3,q4\_q4,q5\_q5)}
\DoxyCodeLine{547       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(usea(1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{548          ghz1\_dyn = hvvspinzerodynamiccoupling(5,0d0,q3\_q3,q5\_q5)}
\DoxyCodeLine{549          ghz2\_dyn = hvvspinzerodynamiccoupling(6,0d0,q3\_q3,q5\_q5)}
\DoxyCodeLine{550          ghz3\_dyn = hvvspinzerodynamiccoupling(7,0d0,q3\_q3,q5\_q5)}
\DoxyCodeLine{551          ghz4\_dyn = hvvspinzerodynamiccoupling(8,0d0,q3\_q3,q5\_q5)}
\DoxyCodeLine{552 }
\DoxyCodeLine{553          \textcolor{keywordflow}{if} (includevprime) \textcolor{keywordflow}{then}}
\DoxyCodeLine{554             ghzzp1\_dyn = hvvspinzerodynamiccoupling(20,0d0,q3\_q3,q5\_q5)}
\DoxyCodeLine{555             ghzzp2\_dyn = hvvspinzerodynamiccoupling(21,0d0,q3\_q3,q5\_q5)}
\DoxyCodeLine{556             ghzzp3\_dyn = hvvspinzerodynamiccoupling(22,0d0,q3\_q3,q5\_q5)}
\DoxyCodeLine{557             ghzzp4\_dyn = hvvspinzerodynamiccoupling(23,0d0,q3\_q3,q5\_q5)}
\DoxyCodeLine{558 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{559       \textcolor{keywordflow}{else} \textcolor{comment}{!if(useA(2)) then}}
\DoxyCodeLine{560          ghz1\_dyn = hvvspinzerodynamiccoupling(5,0d0,q4\_q4,q5\_q5)}
\DoxyCodeLine{561          ghz2\_dyn = hvvspinzerodynamiccoupling(6,0d0,q4\_q4,q5\_q5)}
\DoxyCodeLine{562          ghz3\_dyn = hvvspinzerodynamiccoupling(7,0d0,q4\_q4,q5\_q5)}
\DoxyCodeLine{563          ghz4\_dyn = hvvspinzerodynamiccoupling(8,0d0,q4\_q4,q5\_q5)}
\DoxyCodeLine{564 }
\DoxyCodeLine{565          \textcolor{keywordflow}{if} (includevprime) \textcolor{keywordflow}{then}}
\DoxyCodeLine{566             ghzpz1\_dyn = hvvspinzerodynamiccoupling(20,0d0,q4\_q4,q5\_q5)}
\DoxyCodeLine{567             ghzpz2\_dyn = hvvspinzerodynamiccoupling(21,0d0,q4\_q4,q5\_q5)}
\DoxyCodeLine{568             ghzpz3\_dyn = hvvspinzerodynamiccoupling(22,0d0,q4\_q4,q5\_q5)}
\DoxyCodeLine{569             ghzpz4\_dyn = hvvspinzerodynamiccoupling(23,0d0,q4\_q4,q5\_q5)}
\DoxyCodeLine{570 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{571 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{572 }
\DoxyCodeLine{573       gvvs1 = ghz1\_dyn*(mass(3,1)**2) + qq * ( 2d0*ghz2\_dyn + ghz3\_dyn*qq\textcolor{comment}{/lambda**2 )}}
\DoxyCodeLine{574 \textcolor{comment}{}      gvvs2 = -\/( 2d0*ghz2\_dyn + ghz3\_dyn*qq/lambda**2 )}
\DoxyCodeLine{575       gvvp = -\/2d0*ghz4\_dyn}
\DoxyCodeLine{576 }
\DoxyCodeLine{577       \textcolor{keywordflow}{if} (includevprime) \textcolor{keywordflow}{then}}
\DoxyCodeLine{578          \textcolor{keywordflow}{if}(.not.usea(1) .and. .not.usea(2)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{579             gvvps1 = ghzzp1\_dyn*(mass(3,1)**2) + qq * ( 2d0*ghzzp2\_dyn +\textcolor{comment}{ ghzzp3\_dyn*qq/lambda**2 )}}
\DoxyCodeLine{580 \textcolor{comment}{}            gvvps2 = -\/( 2d0*ghzzp2\_dyn + ghzzp3\_dyn*qq/lambda**2 )}
\DoxyCodeLine{581             gvvpp = -\/2d0*ghzzp4\_dyn}
\DoxyCodeLine{582 }
\DoxyCodeLine{583             gvpvs1 = ghzpz1\_dyn*(mass(3,1)**2) + qq * ( 2d0*ghzpz2\_dyn +\textcolor{comment}{ ghzpz3\_dyn*qq/lambda**2 )}}
\DoxyCodeLine{584 \textcolor{comment}{}            gvpvs2 = -\/( 2d0*ghzpz2\_dyn + ghzpz3\_dyn*qq/lambda**2 )}
\DoxyCodeLine{585             gvpvp = -\/2d0*ghzpz4\_dyn}
\DoxyCodeLine{586 }
\DoxyCodeLine{587             gvpvps1 = ghzpzp1\_dyn*(mass(3,1)**2) + qq * ( 2d0*ghzpzp2\_dyn\textcolor{comment}{ + ghzpzp3\_dyn*qq/lambda**2 )}}
\DoxyCodeLine{588 \textcolor{comment}{}            gvpvps2 = -\/( 2d0*ghzpzp2\_dyn + ghzpzp3\_dyn*qq/lambda**2 )}
\DoxyCodeLine{589             gvpvpp = -\/2d0*ghzpzp4\_dyn}
\DoxyCodeLine{590          \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (usea(1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{591             gvvps1 = ghzzp1\_dyn*(mass(3,1)**2) + qq * ( 2d0*ghzzp2\_dyn +\textcolor{comment}{ ghzzp3\_dyn*qq/lambda**2 )}}
\DoxyCodeLine{592 \textcolor{comment}{}            gvvps2 = -\/( 2d0*ghzzp2\_dyn + ghzzp3\_dyn*qq/lambda**2 )}
\DoxyCodeLine{593             gvvpp = -\/2d0*ghzzp4\_dyn}
\DoxyCodeLine{594          else\textcolor{comment}{! if (useA(2)) then}}
\DoxyCodeLine{595             gvpvs1 = ghzpz1\_dyn*(mass(3,1)**2) + qq * ( 2d0*ghzpz2\_dyn +\textcolor{comment}{ ghzpz3\_dyn*qq/lambda**2 )}}
\DoxyCodeLine{596 \textcolor{comment}{}            gvpvs2 = -\/( 2d0*ghzpz2\_dyn + ghzpz3\_dyn*qq/lambda**2 )}
\DoxyCodeLine{597             gvpvp = -\/2d0*ghzpz4\_dyn}
\DoxyCodeLine{598 \textcolor{keywordflow}{         endif}}
\DoxyCodeLine{599 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{600 }
\DoxyCodeLine{601 }
\DoxyCodeLine{602       \textcolor{keyword}{call }vvs1(g\_mu\_nu)}
\DoxyCodeLine{603       \textcolor{keyword}{call }vvs2(momext(:,5),momext(:,5),pp)}
\DoxyCodeLine{604       \textcolor{keywordflow}{if}(id(3).eq.convertlhe(wp\_))\textcolor{keywordflow}{then}}
\DoxyCodeLine{605          \textcolor{keyword}{call }vvp(momext(:,4),-\/momext(:,3),epp)}
\DoxyCodeLine{606       \textcolor{keywordflow}{else}}
\DoxyCodeLine{607          \textcolor{keyword}{call }vvp(-\/momext(:,3),momext(:,4),epp)}
\DoxyCodeLine{608 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{609 }
\DoxyCodeLine{610 \textcolor{comment}{! assemble everything and get iM}}
\DoxyCodeLine{611       matrixelement0=(0d0,0d0)}
\DoxyCodeLine{612       \textcolor{keywordflow}{do} mu3=1,4}
\DoxyCodeLine{613       \textcolor{keywordflow}{do} mu4=1,4}
\DoxyCodeLine{614          matrixelement0 = matrixelement0 +      \&}
\DoxyCodeLine{615             current1(mu3)*current2(mu4)*(       \&}
\DoxyCodeLine{616                gvvs1*g\_mu\_nu(mu3,mu4)         + \&}
\DoxyCodeLine{617                gvvs2*pp(mu3,mu4)         + \&}
\DoxyCodeLine{618                gvvp *epp(mu3,mu4)           \&}
\DoxyCodeLine{619             )                                   \&}
\DoxyCodeLine{620             +                                   \&}
\DoxyCodeLine{621             current1(mu3)*currentvp2(mu4)*(    \&}
\DoxyCodeLine{622                gvvps1*g\_mu\_nu(mu3,mu4)        + \&}
\DoxyCodeLine{623                gvvps2*pp(mu3,mu4)        + \&}
\DoxyCodeLine{624                gvvpp *epp(mu3,mu4)          \&}
\DoxyCodeLine{625             )                                   \&}
\DoxyCodeLine{626             +                                   \&}
\DoxyCodeLine{627             currentvp1(mu3)*current2(mu4)*(    \&}
\DoxyCodeLine{628                gvpvs1*g\_mu\_nu(mu3,mu4)        + \&}
\DoxyCodeLine{629                gvpvs2*pp(mu3,mu4)        + \&}
\DoxyCodeLine{630                gvpvp *epp(mu3,mu4)          \&}
\DoxyCodeLine{631             )                                   \&}
\DoxyCodeLine{632             +                                   \&}
\DoxyCodeLine{633             currentvp1(mu3)*currentvp2(mu4)*( \&}
\DoxyCodeLine{634                gvpvps1*g\_mu\_nu(mu3,mu4)       + \&}
\DoxyCodeLine{635                gvpvps2*pp(mu3,mu4)       + \&}
\DoxyCodeLine{636                gvpvpp *epp(mu3,mu4)         \&}
\DoxyCodeLine{637             )}
\DoxyCodeLine{638 \textcolor{keywordflow}{      enddo} \textcolor{comment}{!mu4}}
\DoxyCodeLine{639 \textcolor{keywordflow}{      enddo} \textcolor{comment}{!mu3}}
\DoxyCodeLine{640       matrixelement0 = matrixelement0*ci/vev}
\DoxyCodeLine{641 }
\DoxyCodeLine{642       \textcolor{keywordflow}{if}(h\_dk.eqv..false.)\textcolor{keywordflow}{then}}
\DoxyCodeLine{643         matrixelement0=matrixelement0 *prop3}
\DoxyCodeLine{644       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(id(8).ne.not\_a\_particle\_) \textcolor{keywordflow}{then}}
\DoxyCodeLine{645         matrixelement0=matrixelement0 *prop3 \&}
\DoxyCodeLine{646         *(kappa*ffs(id(8), momext(:,8), helicity(8), id(9), momext(:,9),\textcolor{comment}{ helicity(9)) \&}}
\DoxyCodeLine{647 \textcolor{comment}{}         +kappa\_tilde*ffp(id(8), momext(:,8), helicity(8), id(9), momext\textcolor{comment}{(:,9), helicity(9)))\&}}
\DoxyCodeLine{648 \textcolor{comment}{}        *(-\/ci/vev*getmass(convertlhereverse(id(8))))}
\DoxyCodeLine{649       \textcolor{keywordflow}{else}}
\DoxyCodeLine{650         matrixelement0=czero}
\DoxyCodeLine{651 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{652 }
\DoxyCodeLine{653       \textcolor{comment}{!print *,"MATRIXELEMENT0=",MATRIXELEMENT0}}
\DoxyCodeLine{654 }
\DoxyCodeLine{655       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a436a26fa7bd00a57c5a2e4aeb1dccd22}\label{namespacemodvhiggs_a436a26fa7bd00a57c5a2e4aeb1dccd22}} 
\index{modvhiggs@{modvhiggs}!matrixelement1@{matrixelement1}}
\index{matrixelement1@{matrixelement1}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{matrixelement1()}{matrixelement1()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::matrixelement1 (\begin{DoxyParamCaption}\item[{real(8), dimension(1\+:4,1\+:9)}]{p,  }\item[{integer, dimension(1\+:6)}]{Ferm\+Flav,  }\item[{real(8)}]{Un\+Pol\+Sq\+Amp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1621 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1621 \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacemodparameters}{modparameters}}}
\DoxyCodeLine{1622 \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacemodmisc}{modmisc}}}
\DoxyCodeLine{1623 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1624 \textcolor{keywordtype}{complex(8)} :: SME(1:3,-\/1:+1,-\/1:+1),HelAmp}
\DoxyCodeLine{1625 \textcolor{keywordtype}{real}(8) :: p(1:4,1:9),UnpolSqAmp,PreFac,IZis(-\/1:+1)}
\DoxyCodeLine{1626 \textcolor{keywordtype}{real}(8) :: qsq\_V1,qsq\_V2,qsq\_V1V2,qsq\_H}
\DoxyCodeLine{1627 \textcolor{keywordtype}{complex(8)} ghz1\_dyn,ghz2\_dyn,ghz3\_dyn,ghz4\_dyn}
\DoxyCodeLine{1628 \textcolor{keywordtype}{complex(8)} :: a1HVV,a2HVV,a3HVV,Prop}
\DoxyCodeLine{1629 \textcolor{keywordtype}{integer} :: ishel,fshel,FermFlav(1:6)\textcolor{comment}{! 12:IS, 34:ZDK, 56:HDK}}
\DoxyCodeLine{1630 }
\DoxyCodeLine{1631     \textcolor{comment}{! q1 qbar2 -\/-\/> 3 -\/-\/> 45 -\/-\/> Z4-\/-\/>f6 fbar7 + H5-\/-\/>89}}
\DoxyCodeLine{1632     \textcolor{keyword}{call }getsme(p,fermflav,sme)}
\DoxyCodeLine{1633     \textcolor{keywordflow}{if}( h\_dk ) \textcolor{keyword}{call }\mbox{\hyperlink{namespacemodmisc_a67da31b838636e613886adf687dd9040}{error}}(\textcolor{stringliteral}{"Higgs decay not implemented"})}
\DoxyCodeLine{1634 }
\DoxyCodeLine{1635     prop = (0d0,1d0)/(((p(1:4,4)+p(1:4,5)).dot.(p(1:4,4)+p(1:4,5))) -\/m\_v**2 + (0d0,1d0)*m\_v*ga\_v )}
\DoxyCodeLine{1636     prefac = 4d0*pi*alpha\_qed/4d0/sitw**2/(1d0-\/sitw**2)      \textcolor{comment}{! gets squared below}}
\DoxyCodeLine{1637 }
\DoxyCodeLine{1638     \textcolor{comment}{! initial state couplings}}
\DoxyCodeLine{1639     \textcolor{keywordflow}{if}( isawdecay(decaymode1) ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1640         izis(+1) = br   *ckm(fermflav(1),fermflav(2))}
\DoxyCodeLine{1641         izis(-\/1) = bl   *ckm(fermflav(1),fermflav(2))}
\DoxyCodeLine{1642     \textcolor{keywordflow}{elseif}( isazdecay(decaymode1) .and. (abs(fermflav(1)).eq.2 .or. abs(fermflav(1)).eq.4) ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1643         izis(+1) = ar\_qup}
\DoxyCodeLine{1644         izis(-\/1) = al\_qup}
\DoxyCodeLine{1645     \textcolor{keywordflow}{elseif}( isazdecay(decaymode1) .and. (abs(fermflav(1)).eq.1 .or. abs(fermflav(1)).eq.3 .or. abs(fermflav(1)).eq.5) ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1646         izis(+1) = ar\_qdn}
\DoxyCodeLine{1647         izis(-\/1) = al\_qdn}
\DoxyCodeLine{1648 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{1649 }
\DoxyCodeLine{1650 }
\DoxyCodeLine{1651     \textcolor{comment}{! anomalous HVV couplings}}
\DoxyCodeLine{1652     qsq\_v1  =  p(1:4,3).dot.p(1:4,3)}
\DoxyCodeLine{1653     qsq\_v2  =  p(1:4,4).dot.p(1:4,4)}
\DoxyCodeLine{1654     qsq\_v1v2=-\/(p(1:4,3).dot.p(1:4,4))}
\DoxyCodeLine{1655     qsq\_h   =  p(1:4,5).dot.p(1:4,5)}
\DoxyCodeLine{1656 }
\DoxyCodeLine{1657     ghz1\_dyn = hvvspinzerodynamiccoupling(1,qsq\_v1,qsq\_v2,qsq\_h)}
\DoxyCodeLine{1658     ghz2\_dyn = hvvspinzerodynamiccoupling(2,qsq\_v1,qsq\_v2,qsq\_h)}
\DoxyCodeLine{1659     ghz3\_dyn = hvvspinzerodynamiccoupling(3,qsq\_v1,qsq\_v2,qsq\_h)}
\DoxyCodeLine{1660     ghz4\_dyn = hvvspinzerodynamiccoupling(4,qsq\_v1,qsq\_v2,qsq\_h)}
\DoxyCodeLine{1661 }
\DoxyCodeLine{1662     a1hvv = ghz1\_dyn*m\_v**2 + qsq\_v1v2*( 2d0*ghz2\_dyn + ghz3\_dyn*qsq\_v1v2/lambda**2 )}
\DoxyCodeLine{1663     a2hvv =-\/2d0*ghz2\_dyn -\/ ghz3\_dyn*qsq\_v1v2/lambda**2}
\DoxyCodeLine{1664     a3hvv =-\/2d0*ghz4\_dyn}
\DoxyCodeLine{1665 }
\DoxyCodeLine{1666     unpolsqamp = 0d0}
\DoxyCodeLine{1667     \textcolor{keywordflow}{do} ishel=-\/1,+1,2}
\DoxyCodeLine{1668     \textcolor{keywordflow}{do} fshel=-\/1,+1,2}
\DoxyCodeLine{1669           helamp =  a3hvv * (  -\/ izis(ishel)*sme(3,ishel,fshel)  )          \&}
\DoxyCodeLine{1670                   + a2hvv * (  -\/ izis(ishel)*sme(2,ishel,fshel)  )          \&}
\DoxyCodeLine{1671                   + a1hvv * (  + izis(ishel)*sme(1,ishel,fshel)  )}
\DoxyCodeLine{1672           helamp = helamp * prefac/vev * prop}
\DoxyCodeLine{1673           unpolsqamp = unpolsqamp + dreal( helamp*dconjg(helamp) )}
\DoxyCodeLine{1674 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{1675 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{1676     unpolsqamp = unpolsqamp * cf}
\DoxyCodeLine{1677 }
\DoxyCodeLine{1678 \textcolor{keywordflow}{RETURN}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_ad33930c2407829c003597466ab672caa}\label{namespacemodvhiggs_ad33930c2407829c003597466ab672caa}} 
\index{modvhiggs@{modvhiggs}!metric@{metric}}
\index{metric@{metric}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{metric()}{metric()}}
{\footnotesize\ttfamily real(8) function modvhiggs\+::metric (\begin{DoxyParamCaption}\item[{integer}]{mu,  }\item[{integer}]{nu }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1228 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1228 }
\DoxyCodeLine{1229       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1230       \textcolor{keywordtype}{integer} mu, nu}
\DoxyCodeLine{1231 }
\DoxyCodeLine{1232       \textcolor{keywordflow}{if}(mu.ne.nu)\textcolor{keywordflow}{then}}
\DoxyCodeLine{1233         metric=0d0}
\DoxyCodeLine{1234       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(mu.eq.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{1235         metric=1d0}
\DoxyCodeLine{1236       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1237         metric=-\/1d0}
\DoxyCodeLine{1238 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{1239 }
\DoxyCodeLine{1240       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a094016f0d9a7c3c3caa1e791e01b315f}\label{namespacemodvhiggs_a094016f0d9a7c3c3caa1e791e01b315f}} 
\index{modvhiggs@{modvhiggs}!polarization@{polarization}}
\index{polarization@{polarization}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{polarization()}{polarization()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::polarization (\begin{DoxyParamCaption}\item[{real(8), dimension(4)}]{p,  }\item[{complex(8), dimension(3,4)}]{P\+OL }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1249 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1249 }
\DoxyCodeLine{1250       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1251 \textcolor{keywordtype}{      real}(8) p(4)}
\DoxyCodeLine{1252       \textcolor{keywordtype}{complex(8)} POL(3,4)}
\DoxyCodeLine{1253 }
\DoxyCodeLine{1254       \textcolor{keyword}{call }polarization\_single(p,+1,pol(1,:))}
\DoxyCodeLine{1255       \textcolor{keyword}{call }polarization\_single(p,-\/1,pol(2,:))}
\DoxyCodeLine{1256       \textcolor{keyword}{call }polarization\_single(p, 0,pol(3,:))}
\DoxyCodeLine{1257 }
\DoxyCodeLine{1258       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a2f6a4cbd41e56a39543313fc5dfdf37b}\label{namespacemodvhiggs_a2f6a4cbd41e56a39543313fc5dfdf37b}} 
\index{modvhiggs@{modvhiggs}!polarization\_single@{polarization\_single}}
\index{polarization\_single@{polarization\_single}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{polarization\_single()}{polarization\_single()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::polarization\+\_\+single (\begin{DoxyParamCaption}\item[{real(8), dimension(4)}]{p,  }\item[{integer}]{lambda,  }\item[{complex(8), dimension(4)}]{P\+OL }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1262 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1262 }
\DoxyCodeLine{1263       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1264 \textcolor{keywordtype}{      real}(8) p(4), sincos(4), inv\_mass, abs3p}
\DoxyCodeLine{1265       \textcolor{keywordtype}{complex(8)} POL(4)}
\DoxyCodeLine{1266       \textcolor{keywordtype}{integer} lambda}
\DoxyCodeLine{1267 }
\DoxyCodeLine{1268       pol(:)=czero}
\DoxyCodeLine{1269 }
\DoxyCodeLine{1270       \textcolor{keyword}{call }angles(sincos, p)}
\DoxyCodeLine{1271       \textcolor{comment}{!sincos(1)=cos(theta)}}
\DoxyCodeLine{1272       \textcolor{comment}{!sincos(2)=sin(theta)}}
\DoxyCodeLine{1273       \textcolor{comment}{!sincos(3)=cos(phi)}}
\DoxyCodeLine{1274       \textcolor{comment}{!sincos(4)=sin(phi)}}
\DoxyCodeLine{1275 }
\DoxyCodeLine{1276 \textcolor{comment}{!lambda = +1}}
\DoxyCodeLine{1277       \textcolor{keywordflow}{if}(lambda.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1278          pol(1)= 0d0}
\DoxyCodeLine{1279          pol(2)= (sincos(3)*sincos(1)-\/(0d0,1d0)*sincos(4))/dsqrt(2d0)}
\DoxyCodeLine{1280          pol(3)= (sincos(4)*sincos(1)+(0d0,1d0)*sincos(3))/dsqrt(2d0)}
\DoxyCodeLine{1281          pol(4)= -\/sincos(2)/dsqrt(2d0)}
\DoxyCodeLine{1282 \textcolor{comment}{!lambda = -\/1}}
\DoxyCodeLine{1283       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(lambda.eq.-\/1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1284          pol(1)= 0d0}
\DoxyCodeLine{1285          pol(2)= (sincos(3)*sincos(1)+(0d0,1d0)*sincos(4))/dsqrt(2d0)}
\DoxyCodeLine{1286          pol(3)= (sincos(4)*sincos(1)-\/(0d0,1d0)*sincos(3))/dsqrt(2d0)}
\DoxyCodeLine{1287          pol(4)= -\/sincos(2)/dsqrt(2d0)}
\DoxyCodeLine{1288 \textcolor{comment}{!lambda = 0 (z)}}
\DoxyCodeLine{1289       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(lambda.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1290 \textcolor{comment}{!|3-\/momentum|}}
\DoxyCodeLine{1291          abs3p = dsqrt(p(2)**2+p(3)**2+p(4)**2)}
\DoxyCodeLine{1292 \textcolor{comment}{!invariant mass}}
\DoxyCodeLine{1293          inv\_mass= dsqrt(p(1)**2-\/abs3p**2)}
\DoxyCodeLine{1294          pol(1)= abs3p/inv\_mass}
\DoxyCodeLine{1295          pol(2)= sincos(3)*sincos(2)*p(1)/inv\_mass}
\DoxyCodeLine{1296          pol(3)= sincos(4)*sincos(2)*p(1)/inv\_mass}
\DoxyCodeLine{1297          pol(4)= sincos(1)*p(1)/inv\_mass}
\DoxyCodeLine{1298 \textcolor{comment}{!lambda = 2 (vec\{p-\/hat\})}}
\DoxyCodeLine{1299       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(lambda.eq.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1300          pol(1)= 0d0}
\DoxyCodeLine{1301          pol(2)= sincos(3)*sincos(2)}
\DoxyCodeLine{1302          pol(3)= sincos(4)*sincos(2)}
\DoxyCodeLine{1303          pol(4)= sincos(1)}
\DoxyCodeLine{1304 \textcolor{comment}{!lambda = -\/2 (-\/vec\{p-\/hat\})}}
\DoxyCodeLine{1305       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(lambda.eq.-\/2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1306          pol(1)= 0d0}
\DoxyCodeLine{1307          pol(2)= -\/sincos(3)*sincos(2)}
\DoxyCodeLine{1308          pol(3)= -\/sincos(4)*sincos(2)}
\DoxyCodeLine{1309          pol(4)= -\/sincos(1)}
\DoxyCodeLine{1310 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{1311 }
\DoxyCodeLine{1312       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a5a0812bc27cac2bd9798b50bea21b7e6}\label{namespacemodvhiggs_a5a0812bc27cac2bd9798b50bea21b7e6}} 
\index{modvhiggs@{modvhiggs}!polarizationa@{polarizationa}}
\index{polarizationa@{polarizationa}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{polarizationa()}{polarizationa()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::polarizationa (\begin{DoxyParamCaption}\item[{real(8), dimension(4)}]{p,  }\item[{complex(8), dimension(2,4)}]{P\+OL }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1321 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1321 }
\DoxyCodeLine{1322       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1323 \textcolor{keywordtype}{      real}(8) p(4)}
\DoxyCodeLine{1324       \textcolor{keywordtype}{complex(8)} POL(2,4)}
\DoxyCodeLine{1325 }
\DoxyCodeLine{1326       \textcolor{keyword}{call }polarization\_single(p,+1,pol(1,:))}
\DoxyCodeLine{1327       \textcolor{keyword}{call }polarization\_single(p,-\/1,pol(2,:))}
\DoxyCodeLine{1328 }
\DoxyCodeLine{1329       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_ab37be81cf8a6f8fff05c4db9a1741536}\label{namespacemodvhiggs_ab37be81cf8a6f8fff05c4db9a1741536}} 
\index{modvhiggs@{modvhiggs}!polarizationx@{polarizationx}}
\index{polarizationx@{polarizationx}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{polarizationx()}{polarizationx()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::polarizationx (\begin{DoxyParamCaption}\item[{real(8), dimension(4)}]{p,  }\item[{complex(8), dimension(3,4)}]{P\+OL }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1339 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1339 }
\DoxyCodeLine{1340       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1341 \textcolor{keywordtype}{      real}(8) p(4)}
\DoxyCodeLine{1342       \textcolor{keywordtype}{complex(8)} POL(3,4)}
\DoxyCodeLine{1343 }
\DoxyCodeLine{1344       \textcolor{keyword}{call }polarization\_single(p,+1,pol(1,:))}
\DoxyCodeLine{1345       \textcolor{keyword}{call }polarization\_single(p,-\/1,pol(2,:))}
\DoxyCodeLine{1346       \textcolor{keyword}{call }polarization\_single(p,+2,pol(3,:))}
\DoxyCodeLine{1347 }
\DoxyCodeLine{1348       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_aad4645be763f9042bf4bc2ea215a5846}\label{namespacemodvhiggs_aad4645be763f9042bf4bc2ea215a5846}} 
\index{modvhiggs@{modvhiggs}!propagator@{propagator}}
\index{propagator@{propagator}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{propagator()}{propagator()}}
{\footnotesize\ttfamily complex(8) function modvhiggs\+::propagator (\begin{DoxyParamCaption}\item[{real(8)}]{inv\+\_\+mass,  }\item[{real(8)}]{mass,  }\item[{real(8)}]{width }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1357 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1357       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1358 }
\DoxyCodeLine{1359 \textcolor{keywordtype}{      real}(8) inv\_mass, mass, width}
\DoxyCodeLine{1360 }
\DoxyCodeLine{1361 \textcolor{comment}{!not assuming auto-\/conversion}}
\DoxyCodeLine{1362 \textcolor{comment}{!     PROPAGATOR = (0d0,1d0)/(dcmplx(inv\_mass**2,0d0)}}
\DoxyCodeLine{1363 \textcolor{comment}{!    \&            -\/dcmplx(mass**2,0d0)+}}
\DoxyCodeLine{1364 \textcolor{comment}{!    \&             (0d0,1d0)*dcmplx(mass,0d0)*dcmplx(width,0d0))}}
\DoxyCodeLine{1365 }
\DoxyCodeLine{1366 \textcolor{comment}{!assuming auto-\/conversion. works with gfortran}}
\DoxyCodeLine{1367       \textcolor{comment}{!print *,"Called propagator with",inv\_mass,mass,width}}
\DoxyCodeLine{1368       \textcolor{keywordflow}{if} (mass.ge.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1369          propagator = ci / ( inv\_mass**2 -\/ mass**2 + ci*mass*width )}
\DoxyCodeLine{1370       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1371          propagator = ci / ( inv\_mass**2 )}
\DoxyCodeLine{1372 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{1373 \textcolor{comment}{!     print *, PROPAGATOR}}
\DoxyCodeLine{1374 }
\DoxyCodeLine{1375       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a728feac63aa7cfbfe30b08c7ed244389}\label{namespacemodvhiggs_a728feac63aa7cfbfe30b08c7ed244389}} 
\index{modvhiggs@{modvhiggs}!spinoru2@{spinoru2}}
\index{spinoru2@{spinoru2}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{spinoru2()}{spinoru2()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::spinoru2 (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{n,  }\item[{real(8), dimension(4,n), intent(in)}]{p,  }\item[{complex(8), dimension(n,n), intent(out)}]{za,  }\item[{complex(8), dimension(n,n), intent(out)}]{zb,  }\item[{real(8), dimension(n,n), intent(out)}]{s }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1457 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1457        \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1458        \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: n}
\DoxyCodeLine{1459 \textcolor{keywordtype}{       real}(8), \textcolor{keywordtype}{intent(in)} :: p(4,n)}
\DoxyCodeLine{1460        \textcolor{keywordtype}{complex(8)}, \textcolor{keywordtype}{intent(out)} :: za(n,n), zb(n,n)}
\DoxyCodeLine{1461 \textcolor{keywordtype}{       real}(8), \textcolor{keywordtype}{intent(out)} :: s(n,n)}
\DoxyCodeLine{1462        \textcolor{keywordtype}{integer} :: i,j}
\DoxyCodeLine{1463        \textcolor{keywordtype}{complex(8)} :: c23(n), f(n)}
\DoxyCodeLine{1464 \textcolor{keywordtype}{       real}(8) :: rt(n)}
\DoxyCodeLine{1465 }
\DoxyCodeLine{1466        \textcolor{comment}{!-\/-\/-\/if one of the vectors happens to be zero this routine fails.}}
\DoxyCodeLine{1467        \textcolor{keywordflow}{do} j=1,n}
\DoxyCodeLine{1468           za(j,j)=czero}
\DoxyCodeLine{1469           zb(j,j)=za(j,j)}
\DoxyCodeLine{1470 }
\DoxyCodeLine{1471           \textcolor{comment}{!-\/-\/-\/-\/-\/positive energy case}}
\DoxyCodeLine{1472           \textcolor{keywordflow}{if} (p(1,j) .gt. zero) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1473              rt(j)=sqrt(abs(p(2,j)+p(1,j)))}
\DoxyCodeLine{1474              c23(j)=dcmplx(p(4,j),-\/p(3,j))}
\DoxyCodeLine{1475              f(j)=(one,zero)}
\DoxyCodeLine{1476           \textcolor{keywordflow}{else}}
\DoxyCodeLine{1477           \textcolor{comment}{!-\/-\/-\/-\/-\/negative energy case}}
\DoxyCodeLine{1478              rt(j)=sqrt(abs(-\/p(1,j)-\/p(2,j)))}
\DoxyCodeLine{1479              c23(j)=dcmplx(-\/p(4,j),p(3,j))}
\DoxyCodeLine{1480              f(j)=ci}
\DoxyCodeLine{1481 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{1482 \textcolor{keywordflow}{       enddo}}
\DoxyCodeLine{1483 }
\DoxyCodeLine{1484        \textcolor{keywordflow}{do} i=2,n}
\DoxyCodeLine{1485 }
\DoxyCodeLine{1486         \textcolor{keywordflow}{do} j=1,i-\/1}
\DoxyCodeLine{1487              s(i,j)=two*\mbox{\hyperlink{namespacemodmisc_a3f09f85d546e0284b955a11b37ef1310}{scr}}(p(:,i),p(:,j))}
\DoxyCodeLine{1488              za(i,j)=f(i)*f(j)  * ( c23(i)*dcmplx(rt(j)/(rt(i)+1d-\/16))-\/c23(j)*dcmplx(rt(i)/(rt(j)+1d-\/16)) )}
\DoxyCodeLine{1489 }
\DoxyCodeLine{1490              \textcolor{keywordflow}{if} (abs(s(i,j)).lt.1d-\/5) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1491                 zb(i,j)=-\/(f(i)*f(j))**2*conjg(za(i,j))}
\DoxyCodeLine{1492              \textcolor{keywordflow}{else}}
\DoxyCodeLine{1493                 zb(i,j)=-\/dcmplx(s(i,j))/(za(i,j)+1d-\/16)}
\DoxyCodeLine{1494 \textcolor{keywordflow}{             endif}}
\DoxyCodeLine{1495 }
\DoxyCodeLine{1496              za(j,i)=-\/za(i,j)}
\DoxyCodeLine{1497              zb(j,i)=-\/zb(i,j)}
\DoxyCodeLine{1498              s(j,i)=s(i,j)}
\DoxyCodeLine{1499 }
\DoxyCodeLine{1500 \textcolor{keywordflow}{          enddo}}
\DoxyCodeLine{1501 }
\DoxyCodeLine{1502 \textcolor{keywordflow}{       enddo}}
\DoxyCodeLine{1503 }
\DoxyCodeLine{1504        \textcolor{keywordflow}{return}}
\DoxyCodeLine{1505 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a935c67a26fa748df19e205b4be7ccd5f}\label{namespacemodvhiggs_a935c67a26fa748df19e205b4be7ccd5f}} 
\index{modvhiggs@{modvhiggs}!vvp@{vvp}}
\index{vvp@{vvp}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{vvp()}{vvp()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::vvp (\begin{DoxyParamCaption}\item[{real(8), dimension(4)}]{p1,  }\item[{real(8), dimension(4)}]{p2,  }\item[{complex(8), dimension(4,4)}]{epp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1383 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1383 }
\DoxyCodeLine{1384       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1385 \textcolor{keywordtype}{      real}(8) p1(4), p2(4)}
\DoxyCodeLine{1386       \textcolor{keywordtype}{complex(8)} epp(4,4)}
\DoxyCodeLine{1387 \textcolor{comment}{!      real(8) ANTISYMMETRIC}}
\DoxyCodeLine{1388       \textcolor{keywordtype}{integer} i,j,k,l}
\DoxyCodeLine{1389 }
\DoxyCodeLine{1390 \textcolor{comment}{!      external ANTISYMMETRIC}}
\DoxyCodeLine{1391 }
\DoxyCodeLine{1392       \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{1393       \textcolor{keywordflow}{do} j=1,4}
\DoxyCodeLine{1394         epp(i,j)=0d0}
\DoxyCodeLine{1395 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1396 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1397 }
\DoxyCodeLine{1398       \textcolor{keywordflow}{do} i=1,4}
\DoxyCodeLine{1399       \textcolor{keywordflow}{do} j=1,4}
\DoxyCodeLine{1400       \textcolor{keywordflow}{do} k=1,4}
\DoxyCodeLine{1401       \textcolor{keywordflow}{do} l=1,4}
\DoxyCodeLine{1402           epp(i,j)=epp(i,j)+antisymmetric(i,j,k,l)*p1(k)*p2(l)}
\DoxyCodeLine{1403 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1404 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1405 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1406 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1407 }
\DoxyCodeLine{1408       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_acfb08edf61825ee639b9ac0d28b8524d}\label{namespacemodvhiggs_acfb08edf61825ee639b9ac0d28b8524d}} 
\index{modvhiggs@{modvhiggs}!vvs1@{vvs1}}
\index{vvs1@{vvs1}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{vvs1()}{vvs1()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::vvs1 (\begin{DoxyParamCaption}\item[{complex(8), dimension(4,4)}]{g\+\_\+mu\+\_\+nu }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1416 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1416 }
\DoxyCodeLine{1417       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1418       \textcolor{keywordtype}{complex(8)} g\_mu\_nu(4,4)}
\DoxyCodeLine{1419 }
\DoxyCodeLine{1420       g\_mu\_nu = 0d0}
\DoxyCodeLine{1421 }
\DoxyCodeLine{1422       g\_mu\_nu(1,1) =  1d0}
\DoxyCodeLine{1423       g\_mu\_nu(2,2) = -\/1d0}
\DoxyCodeLine{1424       g\_mu\_nu(3,3) = -\/1d0}
\DoxyCodeLine{1425       g\_mu\_nu(4,4) = -\/1d0}
\DoxyCodeLine{1426 }
\DoxyCodeLine{1427       \textcolor{keywordflow}{return}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacemodvhiggs_a79e78df82578c43bb28cea9ee96251bc}\label{namespacemodvhiggs_a79e78df82578c43bb28cea9ee96251bc}} 
\index{modvhiggs@{modvhiggs}!vvs2@{vvs2}}
\index{vvs2@{vvs2}!modvhiggs@{modvhiggs}}
\doxysubsubsection{\texorpdfstring{vvs2()}{vvs2()}}
{\footnotesize\ttfamily subroutine modvhiggs\+::vvs2 (\begin{DoxyParamCaption}\item[{real(8), dimension(4)}]{p1,  }\item[{real(8), dimension(4)}]{p2,  }\item[{complex(8), dimension(4,4)}]{pp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 1435 of file mod\+\_\+\+V\+Higgs.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{1435 }
\DoxyCodeLine{1436       \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{1437 \textcolor{keywordtype}{      real}(8) p1(4), p2(4)}
\DoxyCodeLine{1438       \textcolor{keywordtype}{complex(8)} pp(4,4)}
\DoxyCodeLine{1439       \textcolor{keywordtype}{integer} mu, nu}
\DoxyCodeLine{1440 }
\DoxyCodeLine{1441       \textcolor{keywordflow}{do} mu=1,4}
\DoxyCodeLine{1442         \textcolor{keywordflow}{do} nu=1,4}
\DoxyCodeLine{1443           pp(mu,nu)=p1(mu)*p2(nu)}
\DoxyCodeLine{1444           \textcolor{keywordflow}{if}( ( (mu.ne.1).and.(nu.eq.1) ).or. \&}
\DoxyCodeLine{1445               ( (mu.eq.1).and.(nu.ne.1) ) )\textcolor{keywordflow}{then}}
\DoxyCodeLine{1446             pp(mu,nu)=-\/pp(mu,nu)}
\DoxyCodeLine{1447 \textcolor{keywordflow}{          endif}}
\DoxyCodeLine{1448 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{1449 \textcolor{keywordflow}{      enddo}}
\DoxyCodeLine{1450 }
\DoxyCodeLine{1451       \textcolor{keywordflow}{return}}

\end{DoxyCode}
