\hypertarget{namespacereductiontn}{}\doxysection{reductiontn Module Reference}
\label{namespacereductiontn}\index{reductiontn@{reductiontn}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacereductiontn_a191a7a2e9bb8ce17eefa7199fdb9784c}{calctn}} (TN, T\+Nuv, Mom\+Inv, masses2, N, rmax, id, T\+Nerr, T\+Nerr2)
\item 
recursive subroutine \mbox{\hyperlink{namespacereductiontn_acb67be82a95a3de101b9185b2ab242f7}{calctnint}} (TN, T\+Nuv, Mom\+Inv, masses2, N, rmax, id, T\+Nerr, T\+Nerr2)
\item 
recursive subroutine \mbox{\hyperlink{namespacereductiontn_afa244bb809a8306382714b178a3c0a07}{calctnred}} (TN, T\+Nuv, Mom\+Inv, masses2, N, rmax, id, T\+Nerr, T\+Nerr2)
\item 
double complex function, dimension(0\+:n-\/2) \mbox{\hyperlink{namespacereductiontn_a68bc77ca3318efc863017381616b8c14}{submasses}} (N, k, masses)
\item 
double complex function, dimension(0\+:3, n-\/2) \mbox{\hyperlink{namespacereductiontn_a593735106f0802a1c97f7f237fd571e7}{submomvec}} (N, k, Mom\+Vec)
\item 
double complex function, dimension(binomtable(2, n-\/1)) \mbox{\hyperlink{namespacereductiontn_a187402bab9bf2fa98c503fcf77ed4233}{submominv}} (N, k, Mom\+Inv)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacereductiontn_a191a7a2e9bb8ce17eefa7199fdb9784c}\label{namespacereductiontn_a191a7a2e9bb8ce17eefa7199fdb9784c}} 
\index{reductiontn@{reductiontn}!calctn@{calctn}}
\index{calctn@{calctn}!reductiontn@{reductiontn}}
\doxysubsubsection{\texorpdfstring{calctn()}{calctn()}}
{\footnotesize\ttfamily subroutine reductiontn\+::calctn (\begin{DoxyParamCaption}\item[{double complex, dimension(ncoefs(rmax,n)), intent(inout)}]{TN,  }\item[{double complex, dimension(ncoefs(rmax,n)), intent(inout)}]{T\+Nuv,  }\item[{double complex, dimension(binomtable(2,n)), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:n-\/1), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{N,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{T\+Nerr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{T\+Nerr2 }\end{DoxyParamCaption})}



Definition at line 45 of file reduction\+T\+N.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{45 }
\DoxyCodeLine{46     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: N,rmax,id}
\DoxyCodeLine{47     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomInv(BinomTable(2,N)), masses2(0:N-\/1)}
\DoxyCodeLine{48     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(inout)} :: TN(NCoefs(rmax,N))}
\DoxyCodeLine{49     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(inout)} :: TNuv(NCoefs(rmax,N))}
\DoxyCodeLine{50     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: TNerr(0:rmax),TNerr2(0:rmax)}
\DoxyCodeLine{51     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: TNaux(:,:,:),TNuvaux(:,:,:) }
\DoxyCodeLine{52     \textcolor{keywordtype}{double complex} :: B(0:rmax,0:rmax), Buv(0:rmax,0:rmax)}
\DoxyCodeLine{53     \textcolor{keywordtype}{double complex} :: C(0:rmax,0:rmax,0:rmax), Cuv(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{54     \textcolor{keywordtype}{double complex} :: D(0:rmax,0:rmax,0:rmax,0:rmax), Duv(0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{55     \textcolor{keywordtype}{double complex} :: E(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{56     \textcolor{keywordtype}{double complex} :: Euv(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{57     \textcolor{keywordtype}{double complex} :: x(BinomTable(2,N)+N)}
\DoxyCodeLine{58     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: fct(:)}
\DoxyCodeLine{59     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3,n4,i,rank,bino,bino\_m2,cnt}
\DoxyCodeLine{60     \textcolor{keywordtype}{logical} :: nocalc,wrica}
\DoxyCodeLine{61 }
\DoxyCodeLine{62 }
\DoxyCodeLine{63     \textcolor{keywordflow}{select case} (n)}
\DoxyCodeLine{64 }
\DoxyCodeLine{65       \textcolor{keywordflow}{case}(1)}
\DoxyCodeLine{66         \textcolor{keyword}{call }calca(tn,tnuv,masses2(0),rmax,tnerr)}
\DoxyCodeLine{67         tnerr2=tnerr}
\DoxyCodeLine{68         \textcolor{keywordflow}{return}}
\DoxyCodeLine{69 }
\DoxyCodeLine{70       \textcolor{keywordflow}{case}(2)}
\DoxyCodeLine{71         \textcolor{keyword}{call }calcb(b,buv,mominv(1),masses2(0),masses2(1),rmax,id,tnerr)}
\DoxyCodeLine{72 }
\DoxyCodeLine{73         cnt = 1}
\DoxyCodeLine{74         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{75           \textcolor{keywordflow}{do} n0=r/2,0,-\/1}
\DoxyCodeLine{76             n1 = r-\/2*n0}
\DoxyCodeLine{77             tn(cnt) = b(n0,n1)}
\DoxyCodeLine{78             cnt = cnt+1}
\DoxyCodeLine{79 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{80 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{81         cnt = 1}
\DoxyCodeLine{82         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{83           \textcolor{keywordflow}{do} n0=r/2,0,-\/1}
\DoxyCodeLine{84             n1 = r-\/2*n0}
\DoxyCodeLine{85             tnuv(cnt) = buv(n0,n1)}
\DoxyCodeLine{86             cnt = cnt+1}
\DoxyCodeLine{87 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{88 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{89         tnerr2=tnerr}
\DoxyCodeLine{90         \textcolor{keywordflow}{return}}
\DoxyCodeLine{91 }
\DoxyCodeLine{92       \textcolor{keywordflow}{case}(3)}
\DoxyCodeLine{93         \textcolor{keyword}{call }calcc(c,cuv,mominv(1),mominv(2),mominv(3),  \&}
\DoxyCodeLine{94                          masses2(0),masses2(1),masses2(2),rmax,id,tnerr,tnerr2)}
\DoxyCodeLine{95 }
\DoxyCodeLine{96         cnt = 1}
\DoxyCodeLine{97         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{98           \textcolor{keywordflow}{do} n0=r/2,0,-\/1}
\DoxyCodeLine{99             \textcolor{keywordflow}{do} n1=r-\/2*n0,0,-\/1}
\DoxyCodeLine{100               n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{101               tn(cnt) = c(n0,n1,n2)}
\DoxyCodeLine{102               cnt = cnt+1}
\DoxyCodeLine{103 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{104 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{105 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{106         tnuv = 0d0}
\DoxyCodeLine{107         \textcolor{keywordflow}{do} r=2,rmax}
\DoxyCodeLine{108           cnt = ncoefs(r-\/1,3)+1}
\DoxyCodeLine{109           \textcolor{keywordflow}{do} n0=r/2,1,-\/1}
\DoxyCodeLine{110             \textcolor{keywordflow}{do} n1=r-\/2*n0,0,-\/1}
\DoxyCodeLine{111               n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{112               tnuv(cnt) = cuv(n0,n1,n2)}
\DoxyCodeLine{113               cnt = cnt+1}
\DoxyCodeLine{114 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{115 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{116 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{117 }
\DoxyCodeLine{118 \textcolor{comment}{!        write(*,*) 'CalcTN 3 TNerr ',TNerr}}
\DoxyCodeLine{119 \textcolor{comment}{!        write(*,*) 'CalcTN 3 TNerr2',TNerr2}}
\DoxyCodeLine{120 }
\DoxyCodeLine{121         \textcolor{keywordflow}{return}}
\DoxyCodeLine{122 }
\DoxyCodeLine{123      }
\DoxyCodeLine{124 }
\DoxyCodeLine{125       \textcolor{keywordflow}{case}(4)}
\DoxyCodeLine{126         \textcolor{keyword}{call }calcd(d,duv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),mominv(6),  \&}
\DoxyCodeLine{127             masses2(0),masses2(1),masses2(2),masses2(3),rmax,id,tnerr,tnerr2)}
\DoxyCodeLine{128 }
\DoxyCodeLine{129         cnt = 1}
\DoxyCodeLine{130         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{131           \textcolor{keywordflow}{do} n0=r/2,0,-\/1}
\DoxyCodeLine{132             \textcolor{keywordflow}{do} n1=r-\/2*n0,0,-\/1}
\DoxyCodeLine{133               \textcolor{keywordflow}{do} n2=r-\/2*n0-\/n1,0,-\/1}
\DoxyCodeLine{134                 n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{135                 tn(cnt) = d(n0,n1,n2,n3)}
\DoxyCodeLine{136                 cnt = cnt+1}
\DoxyCodeLine{137 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{138 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{139 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{140 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{141         tnuv = 0d0}
\DoxyCodeLine{142         \textcolor{keywordflow}{do} r=4,rmax}
\DoxyCodeLine{143           cnt = ncoefs(r-\/1,4)+1}
\DoxyCodeLine{144           \textcolor{keywordflow}{do} n0=r/2,2,-\/1}
\DoxyCodeLine{145             \textcolor{keywordflow}{do} n1=r-\/2*n0,0,-\/1}
\DoxyCodeLine{146               \textcolor{keywordflow}{do} n2=r-\/2*n0-\/n1,0,-\/1}
\DoxyCodeLine{147                 n3 = r-\/2*n0-\/n1-\/n2}
\DoxyCodeLine{148                 tnuv(cnt) = duv(n0,n1,n2,n3)}
\DoxyCodeLine{149                 cnt = cnt+1}
\DoxyCodeLine{150 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{151 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{152 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{153 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{154 }
\DoxyCodeLine{155 \textcolor{comment}{!        write(*,*) 'CalcTN 4 TNerr ',TNerr}}
\DoxyCodeLine{156 \textcolor{comment}{!        write(*,*) 'CalcTN 4 TNerr2',TNerr2}}
\DoxyCodeLine{157 }
\DoxyCodeLine{158         \textcolor{keywordflow}{return}}
\DoxyCodeLine{159 }
\DoxyCodeLine{160       \textcolor{keywordflow}{case}(5)}
\DoxyCodeLine{161         \textcolor{keyword}{call }calce(e,euv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),  \&}
\DoxyCodeLine{162             mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),  \&}
\DoxyCodeLine{163             masses2(0),masses2(1),masses2(2),masses2(3),masses2(4)  \&}
\DoxyCodeLine{164             ,rmax,id,tnerr,tnerr2)}
\DoxyCodeLine{165 }
\DoxyCodeLine{166         cnt = 1}
\DoxyCodeLine{167         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{168           \textcolor{keywordflow}{do} n0=r/2,0,-\/1}
\DoxyCodeLine{169             \textcolor{keywordflow}{do} n1=r-\/2*n0,0,-\/1}
\DoxyCodeLine{170               \textcolor{keywordflow}{do} n2=r-\/2*n0-\/n1,0,-\/1}
\DoxyCodeLine{171                 \textcolor{keywordflow}{do} n3=r-\/2*n0-\/n1-\/n2,0,-\/1}
\DoxyCodeLine{172                   n4 = r-\/2*n0-\/n1-\/n2-\/n3}
\DoxyCodeLine{173                   tn(cnt) = e(n0,n1,n2,n3,n4)}
\DoxyCodeLine{174                   cnt = cnt+1}
\DoxyCodeLine{175 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{176 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{177 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{178 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{179 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{180         tnuv = 0d0}
\DoxyCodeLine{181         \textcolor{keywordflow}{do} r=6,rmax}
\DoxyCodeLine{182           cnt = ncoefs(r-\/1,5)+1}
\DoxyCodeLine{183           \textcolor{keywordflow}{do} n0=r/2,3,-\/1}
\DoxyCodeLine{184             \textcolor{keywordflow}{do} n1=r-\/2*n0,0,-\/1}
\DoxyCodeLine{185               \textcolor{keywordflow}{do} n2=r-\/2*n0-\/n1,0,-\/1}
\DoxyCodeLine{186                 \textcolor{keywordflow}{do} n3=r-\/2*n0-\/n1-\/n2,0,-\/1}
\DoxyCodeLine{187                   n4 = r-\/2*n0-\/n1-\/n2-\/n3}
\DoxyCodeLine{188                   tnuv(cnt) = euv(n0,n1,n2,n3,n4)}
\DoxyCodeLine{189                   cnt = cnt+1}
\DoxyCodeLine{190 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{191 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{192 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{193 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{194 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{195         \textcolor{keywordflow}{return}}
\DoxyCodeLine{196 }
\DoxyCodeLine{197 \textcolor{keywordflow}{      case default}}
\DoxyCodeLine{198         \textcolor{keyword}{allocate}(tnaux(binomtable(rmax,n+rmax-\/2),0:rmax/2,0:rmax)) }
\DoxyCodeLine{199         \textcolor{keyword}{allocate}(tnuvaux(binomtable(rmax,n+rmax-\/2),0:rmax/2,0:rmax))}
\DoxyCodeLine{200         \textcolor{keyword}{call }calctnint(tnaux,tnuvaux,mominv,masses2,n,rmax,id,tnerr,tnerr2)}
\DoxyCodeLine{201        }
\DoxyCodeLine{202         cnt = 1}
\DoxyCodeLine{203         \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{204           \textcolor{keywordflow}{do} n0=r/2,0,-\/1}
\DoxyCodeLine{205             \textcolor{keywordflow}{do} i=1,binomtable(r-\/2*n0,n+r-\/2*n0-\/2)}
\DoxyCodeLine{206               tn(cnt) = tnaux(i,n0,r)}
\DoxyCodeLine{207               cnt = cnt+1}
\DoxyCodeLine{208 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{209 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{210 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{211         tnuv = 0d0}
\DoxyCodeLine{212         \textcolor{keywordflow}{do} r=2*n-\/4,rmax}
\DoxyCodeLine{213           cnt = ncoefs(r-\/1,n)+1}
\DoxyCodeLine{214           \textcolor{keywordflow}{do} n0=r/2,n-\/2,-\/1}
\DoxyCodeLine{215             \textcolor{keywordflow}{do} i=1,binomtable(r-\/2*n0,n+r-\/2*n0-\/2)}
\DoxyCodeLine{216               tnuv(cnt) = tnuvaux(i,n0,r)}
\DoxyCodeLine{217               cnt = cnt+1}
\DoxyCodeLine{218 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{219 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{220 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{221         \textcolor{keywordflow}{return}}
\DoxyCodeLine{222                         }
\DoxyCodeLine{223 \textcolor{keywordflow}{    end select}}
\DoxyCodeLine{224 }
\DoxyCodeLine{225 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiontn_acb67be82a95a3de101b9185b2ab242f7}\label{namespacereductiontn_acb67be82a95a3de101b9185b2ab242f7}} 
\index{reductiontn@{reductiontn}!calctnint@{calctnint}}
\index{calctnint@{calctnint}!reductiontn@{reductiontn}}
\doxysubsubsection{\texorpdfstring{calctnint()}{calctnint()}}
{\footnotesize\ttfamily recursive subroutine reductiontn\+::calctnint (\begin{DoxyParamCaption}\item[{double complex, dimension(binomtable(rmax,n+rmax-\/2),0\+:rmax/2,0\+:rmax), intent(inout)}]{TN,  }\item[{double complex, dimension(binomtable(rmax,n+rmax-\/2),0\+:rmax/2,0\+:rmax), intent(inout)}]{T\+Nuv,  }\item[{double complex, dimension(binomtable(2,n)), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:n-\/1), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{N,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{T\+Nerr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{T\+Nerr2 }\end{DoxyParamCaption})}



Definition at line 238 of file reduction\+T\+N.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{238 }
\DoxyCodeLine{239     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: N,rmax,id}
\DoxyCodeLine{240     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomInv(BinomTable(2,N)), masses2(0:N-\/1)}
\DoxyCodeLine{241     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(inout)} :: TN(BinomTable(rmax,N+rmax-\/2),0:rmax/2,0:rmax) }
\DoxyCodeLine{242     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(inout)} :: TNuv(BinomTable(rmax,N+rmax-\/2),0:rmax/2,0:rmax)}
\DoxyCodeLine{243     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: TNerr(0:rmax),TNerr2(0:rmax)}
\DoxyCodeLine{244     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: TNaux(:,:,:), TNuvaux(:,:,:)}
\DoxyCodeLine{245     \textcolor{keywordtype}{double complex} :: E(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{246     \textcolor{keywordtype}{double complex} :: Euv(0:rmax/2,0:rmax,0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{247     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: TNerraux(:),TNerr2aux(:)}
\DoxyCodeLine{248     \textcolor{keywordtype}{double complex} :: x(BinomTable(2,N)+N)}
\DoxyCodeLine{249     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: fct(:)}
\DoxyCodeLine{250     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3,n4,i,rank,bino,bino\_m2,cnt}
\DoxyCodeLine{251     \textcolor{keywordtype}{logical} :: nocalc,wrica,noten}
\DoxyCodeLine{252 }
\DoxyCodeLine{253 }
\DoxyCodeLine{254 }
\DoxyCodeLine{255     \textcolor{keywordflow}{if} (n.eq.5) \textcolor{keywordflow}{then}}
\DoxyCodeLine{256       \textcolor{keyword}{call }calce(e,euv,mominv(1),mominv(2),mominv(3),mominv(4),mominv(5),  \&}
\DoxyCodeLine{257                        mominv(6),mominv(7),mominv(8),mominv(9),mominv(10),  \&}
\DoxyCodeLine{258                        masses2(0),masses2(1),masses2(2),masses2(3),masses2(4),rmax,id,tnerr,tnerr2)}
\DoxyCodeLine{259 }
\DoxyCodeLine{260       \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{261         \textcolor{keywordflow}{do} n0=r/2,0,-\/1}
\DoxyCodeLine{262           cnt = 1}
\DoxyCodeLine{263           \textcolor{keywordflow}{do} n1=r-\/2*n0,0,-\/1}
\DoxyCodeLine{264             \textcolor{keywordflow}{do} n2=r-\/2*n0-\/n1,0,-\/1}
\DoxyCodeLine{265               \textcolor{keywordflow}{do} n3=r-\/2*n0-\/n1-\/n2,0,-\/1}
\DoxyCodeLine{266                 n4 = r-\/2*n0-\/n1-\/n2-\/n3}
\DoxyCodeLine{267                 tn(cnt,n0,r) = e(n0,n1,n2,n3,n4)}
\DoxyCodeLine{268                 cnt = cnt+1}
\DoxyCodeLine{269 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{270 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{271 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{272 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{273 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{274       \textcolor{keywordflow}{do} r=6,rmax}
\DoxyCodeLine{275         \textcolor{keywordflow}{do} n0=r/2,3,-\/1}
\DoxyCodeLine{276           cnt = 1}
\DoxyCodeLine{277           \textcolor{keywordflow}{do} n1=r-\/2*n0,0,-\/1}
\DoxyCodeLine{278             \textcolor{keywordflow}{do} n2=r-\/2*n0-\/n1,0,-\/1}
\DoxyCodeLine{279               \textcolor{keywordflow}{do} n3=r-\/2*n0-\/n1-\/n2,0,-\/1}
\DoxyCodeLine{280                 n4 = r-\/2*n0-\/n1-\/n2-\/n3}
\DoxyCodeLine{281                 tnuv(cnt,n0,r) = euv(n0,n1,n2,n3,n4)}
\DoxyCodeLine{282                 cnt = cnt+1}
\DoxyCodeLine{283 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{284 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{285 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{286 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{287 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{288       \textcolor{keywordflow}{return}}
\DoxyCodeLine{289 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{290 }
\DoxyCodeLine{291     \textcolor{keywordflow}{if} ((use\_cache\_system).and.(tencache.gt.n)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{292       \textcolor{keywordflow}{if} ((ncache.gt.0).and.(ncache.le.ncache\_max)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{293         bino = binomtable(2,n)}
\DoxyCodeLine{294         x(1:bino) = mominv}
\DoxyCodeLine{295         x(bino+1:bino+n) = masses2   }
\DoxyCodeLine{296         rank = rmax}
\DoxyCodeLine{297 }
\DoxyCodeLine{298         \textcolor{keywordflow}{if}(rmax.ge.2*n-\/4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{299           \textcolor{keyword}{allocate}(fct(ncoefs(rmax,n)+ncoefs(rmax-\/2*n+4,n)+2*(rmax+1)))}
\DoxyCodeLine{300           \textcolor{keyword}{call }readcache(fct,ncoefs(rmax,n)+ncoefs(rmax-\/2*n+4,n)+2*(rmax+1),x,bino+n,1,id,n,rank,nocalc,wrica)}
\DoxyCodeLine{301         \textcolor{keywordflow}{else}}
\DoxyCodeLine{302           \textcolor{keyword}{allocate}(fct(ncoefs(rmax,n)+2*(rmax+1)))}
\DoxyCodeLine{303           \textcolor{keyword}{call }readcache(fct,ncoefs(rmax,n)+2*(rmax+1),x,bino+n,1,id,n,rank,nocalc,wrica)}
\DoxyCodeLine{304 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{305     }
\DoxyCodeLine{306         \textcolor{keywordflow}{if}(nocalc)\textcolor{keywordflow}{then}}
\DoxyCodeLine{307           cnt = 0}
\DoxyCodeLine{308           \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{309             \textcolor{keywordflow}{do} n0=r/2,0,-\/1}
\DoxyCodeLine{310               \textcolor{keywordflow}{do} i=1,binomtable(r-\/2*n0,n+r-\/2*n0-\/2)}
\DoxyCodeLine{311                 cnt = cnt+1}
\DoxyCodeLine{312                 tn(i,n0,r) = fct(cnt)}
\DoxyCodeLine{313 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{314 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{315             \textcolor{keywordflow}{do} n0=r/2,n-\/2,-\/1}
\DoxyCodeLine{316               \textcolor{keywordflow}{do} i=1,binomtable(r-\/2*n0,n+r-\/2*n0-\/2)}
\DoxyCodeLine{317                 cnt = cnt+1}
\DoxyCodeLine{318                 tnuv(i,n0,r) = fct(cnt)}
\DoxyCodeLine{319 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{320 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{321             cnt = cnt+1}
\DoxyCodeLine{322             tnerr(r) = real(fct(cnt))}
\DoxyCodeLine{323             cnt = cnt+1}
\DoxyCodeLine{324             tnerr2(r) = real(fct(cnt))}
\DoxyCodeLine{325 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{326           \textcolor{keywordflow}{return}}
\DoxyCodeLine{327 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{328 }
\DoxyCodeLine{329 }
\DoxyCodeLine{330         \textcolor{keywordflow}{if}(rank.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{331 }
\DoxyCodeLine{332           \textcolor{keyword}{call }calctnred(tn,tnuv,mominv,masses2,n,rank,id,tnerr,tnerr2)}
\DoxyCodeLine{333           }
\DoxyCodeLine{334           \textcolor{keywordflow}{if} (wrica) \textcolor{keywordflow}{then}}
\DoxyCodeLine{335             cnt = 0}
\DoxyCodeLine{336             \textcolor{keywordflow}{do} r=0,rank}
\DoxyCodeLine{337               \textcolor{keywordflow}{do} n0=r/2,0,-\/1}
\DoxyCodeLine{338                 \textcolor{keywordflow}{do} i=1,binomtable(r-\/2*n0,n+r-\/2*n0-\/2)}
\DoxyCodeLine{339  }
\DoxyCodeLine{340                   cnt = cnt+1}
\DoxyCodeLine{341                   fct(cnt) = tn(i,n0,r)}
\DoxyCodeLine{342 }
\DoxyCodeLine{343 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{344 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{345               \textcolor{keywordflow}{do} n0=r/2,n-\/2,-\/1}
\DoxyCodeLine{346                 \textcolor{keywordflow}{do} i=1,binomtable(r-\/2*n0,n+r-\/2*n0-\/2)}
\DoxyCodeLine{347  }
\DoxyCodeLine{348                   cnt = cnt+1}
\DoxyCodeLine{349                   fct(cnt) = tnuv(i,n0,r)}
\DoxyCodeLine{350 }
\DoxyCodeLine{351 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{352 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{353               cnt = cnt+1}
\DoxyCodeLine{354               fct(cnt) = tnerr(r)}
\DoxyCodeLine{355               cnt = cnt+1}
\DoxyCodeLine{356               fct(cnt) = tnerr2(r)}
\DoxyCodeLine{357 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{358    }
\DoxyCodeLine{359             \textcolor{keywordflow}{if}(rank.ge.2*n-\/4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{360               \textcolor{keyword}{call }writecache(fct,ncoefs(rank,n)+ncoefs(rank-\/2*n+4,n)+2*(rank+1),id,n,rank)}
\DoxyCodeLine{361             \textcolor{keywordflow}{else}}
\DoxyCodeLine{362               \textcolor{keyword}{call }writecache(fct,ncoefs(rank,n)+2*(rank+1),id,n,rank)}
\DoxyCodeLine{363 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{364 }
\DoxyCodeLine{365 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{366 }
\DoxyCodeLine{367           \textcolor{keywordflow}{return}}
\DoxyCodeLine{368 }
\DoxyCodeLine{369         }
\DoxyCodeLine{370         \textcolor{keywordflow}{else}}
\DoxyCodeLine{371           \textcolor{keyword}{allocate}(tnaux(binomtable(rank,n+rank-\/2),0:rank/2,0:rank))}
\DoxyCodeLine{372           \textcolor{keyword}{allocate}(tnuvaux(binomtable(rank,n+rank-\/2),0:rank/2,0:rank))}
\DoxyCodeLine{373           \textcolor{keyword}{allocate}(tnerraux(0:rank))}
\DoxyCodeLine{374           \textcolor{keyword}{allocate}(tnerr2aux(0:rank))}
\DoxyCodeLine{375 }
\DoxyCodeLine{376           \textcolor{keyword}{call }calctnred(tnaux,tnuvaux,mominv,masses2,n,rank,id,tnerraux,tnerr2aux)}
\DoxyCodeLine{377           }
\DoxyCodeLine{378           \textcolor{keywordflow}{if} (wrica) \textcolor{keywordflow}{then}}
\DoxyCodeLine{379             cnt = 0}
\DoxyCodeLine{380             \textcolor{keyword}{deallocate}(fct)}
\DoxyCodeLine{381             \textcolor{keywordflow}{if}(rank.ge.2*n-\/4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{382               \textcolor{keyword}{allocate}(fct(ncoefs(rank,n)+ncoefs(rank-\/2*n+4,n)+2*(rank+1)))}
\DoxyCodeLine{383             \textcolor{keywordflow}{else}}
\DoxyCodeLine{384               \textcolor{keyword}{allocate}(fct(ncoefs(rank,n)+2*(rank+1)))}
\DoxyCodeLine{385 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{386             \textcolor{keywordflow}{do} r=0,rank}
\DoxyCodeLine{387               \textcolor{keywordflow}{do} n0=r/2,0,-\/1}
\DoxyCodeLine{388                 \textcolor{keywordflow}{do} i=1,binomtable(r-\/2*n0,n+r-\/2*n0-\/2)}
\DoxyCodeLine{389  }
\DoxyCodeLine{390                   cnt = cnt+1}
\DoxyCodeLine{391                   fct(cnt) = tnaux(i,n0,r)}
\DoxyCodeLine{392 }
\DoxyCodeLine{393 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{394 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{395               \textcolor{keywordflow}{do} n0=r/2,n-\/2,-\/1}
\DoxyCodeLine{396                 \textcolor{keywordflow}{do} i=1,binomtable(r-\/2*n0,n+r-\/2*n0-\/2)}
\DoxyCodeLine{397  }
\DoxyCodeLine{398                   cnt = cnt+1}
\DoxyCodeLine{399                   fct(cnt) = tnuvaux(i,n0,r)}
\DoxyCodeLine{400 }
\DoxyCodeLine{401 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{402 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{403               cnt = cnt+1}
\DoxyCodeLine{404               fct(cnt) = tnerraux(r)}
\DoxyCodeLine{405               cnt = cnt+1}
\DoxyCodeLine{406               fct(cnt) = tnerr2aux(r)}
\DoxyCodeLine{407 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{408    }
\DoxyCodeLine{409             \textcolor{keywordflow}{if}(rank.ge.2*n-\/4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{410               \textcolor{keyword}{call }writecache(fct,ncoefs(rank,n)+ncoefs(rank-\/2*n+4,n)+2*(rank+1),id,n,rank)}
\DoxyCodeLine{411             \textcolor{keywordflow}{else}}
\DoxyCodeLine{412               \textcolor{keyword}{call }writecache(fct,ncoefs(rank,n)+2*(rank+1),id,n,rank)}
\DoxyCodeLine{413 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{414 }
\DoxyCodeLine{415 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{416 }
\DoxyCodeLine{417           tn = tnaux(1:binomtable(rmax,n+rmax-\/2),0:rmax/2,0:rmax)}
\DoxyCodeLine{418           tnuv = tnuvaux(1:binomtable(rmax,n+rmax-\/2),0:rmax/2,0:rmax)}
\DoxyCodeLine{419           tnerr = tnerraux(0:rmax)}
\DoxyCodeLine{420           tnerr2 = tnerr2aux(0:rmax)}
\DoxyCodeLine{421           \textcolor{keywordflow}{return}}
\DoxyCodeLine{422 }
\DoxyCodeLine{423 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{424 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{425 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{426 }
\DoxyCodeLine{427     \textcolor{keyword}{call }calctnred(tn,tnuv,mominv,masses2,n,rmax,id,tnerr,tnerr2)}
\DoxyCodeLine{428 }
\DoxyCodeLine{429 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiontn_afa244bb809a8306382714b178a3c0a07}\label{namespacereductiontn_afa244bb809a8306382714b178a3c0a07}} 
\index{reductiontn@{reductiontn}!calctnred@{calctnred}}
\index{calctnred@{calctnred}!reductiontn@{reductiontn}}
\doxysubsubsection{\texorpdfstring{calctnred()}{calctnred()}}
{\footnotesize\ttfamily recursive subroutine reductiontn\+::calctnred (\begin{DoxyParamCaption}\item[{double complex, dimension(binomtable(rmax,n+rmax-\/2),0\+:rmax/2,0\+:rmax), intent(inout)}]{TN,  }\item[{double complex, dimension(binomtable(rmax,n+rmax-\/2),0\+:rmax/2,0\+:rmax), intent(inout)}]{T\+Nuv,  }\item[{double complex, dimension(binomtable(2,n)), intent(in)}]{Mom\+Inv,  }\item[{double complex, dimension(0\+:n-\/1), intent(in)}]{masses2,  }\item[{integer, intent(in)}]{N,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{T\+Nerr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{T\+Nerr2 }\end{DoxyParamCaption})}



Definition at line 442 of file reduction\+T\+N.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{442 }
\DoxyCodeLine{443     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: N,rmax,id}
\DoxyCodeLine{444     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: MomInv(BinomTable(2,N)), masses2(0:N-\/1)}
\DoxyCodeLine{445     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: TNerr(0:rmax),TNerr2(0:rmax)}
\DoxyCodeLine{446     \textcolor{keywordtype}{double complex} :: q10,q21,q32,q43,q54,q20,q31,q42,q53,q50,q30,q41,q52,q40,q51}
\DoxyCodeLine{447     \textcolor{keywordtype}{double complex} :: mm02,mm12,mm22,mm32,mm42,mm52}
\DoxyCodeLine{448     \textcolor{keywordtype}{double complex} :: mx(0:5,0:5), mxinv(0:5,0:5),mx0k(5,5),mx0kinv(5,5),ff(N-\/1)}
\DoxyCodeLine{449     \textcolor{keywordtype}{double complex} :: det,newdet,TNaux,mxinvs,mx0kinvs(5)}
\DoxyCodeLine{450     \textcolor{keywordtype}{double complex} :: zmx0kinv(5,5),Z(5,5),zmx0kinvs(5)}
\DoxyCodeLine{451     \textcolor{keywordtype}{double precision} :: maxZ,maxzmx0kinv(5),maxzmx0kinvs}
\DoxyCodeLine{452     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(inout)} :: TN(BinomTable(rmax,N+rmax-\/2),0:rmax/2,0:rmax)}
\DoxyCodeLine{453     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(inout)} :: TNuv(BinomTable(rmax,N+rmax-\/2),0:rmax/2,0:rmax)}
\DoxyCodeLine{454     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: TNm1\_0(:,:,:), TNm1UV\_0(:,:,:), TNm1\_i(:,:,:,:)}
\DoxyCodeLine{455     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: TNm1\_0aux(:,:,:), TNm1UV\_0aux(:,:,:), TNm1UV\_i(:,:,:,:)}
\DoxyCodeLine{456     \textcolor{keywordtype}{double complex} :: S(5), elimminf2\_coli,chdet,gram(1:5,1:5),gramdet}
\DoxyCodeLine{457     \textcolor{keywordtype}{double precision} :: TNm1err(0:5,0:rmax),TNm1err2(0:5,0:rmax)}
\DoxyCodeLine{458     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,n3,n4,n5,n6,k,i,j,m,nid(0:5),r0,bin,kbest,Nm1,inds(N-\/1)}
\DoxyCodeLine{459     \textcolor{keywordtype}{integer} :: bino,bino\_0,bino\_i,bino\_m1,bino\_m2,cnt,iaux,rmax\_m1,shift,cind,rBCD}
\DoxyCodeLine{460     \textcolor{keywordtype}{integer} :: mia1,mia2,mia3}
\DoxyCodeLine{461     \textcolor{keywordtype}{logical} :: errorwriteflag}
\DoxyCodeLine{462     \textcolor{keywordtype}{character(len=*)},\textcolor{keywordtype}{parameter} :: fmt10 = \textcolor{stringliteral}{"(A18,'(',d25.18,' , ',d25.18,' )')"}}
\DoxyCodeLine{463 }
\DoxyCodeLine{464 \textcolor{preprocessor}{\#ifdef TNtest}}
\DoxyCodeLine{465 \textcolor{preprocessor}{}    \textcolor{keywordtype}{character(len=*)},\textcolor{keywordtype}{parameter} :: fmt999 = \textcolor{stringliteral}{"(' gm(',i1,',',i1,') =  ',d23.16,' , ',d23.16)"}}
\DoxyCodeLine{466 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{467 \textcolor{preprocessor}{}}
\DoxyCodeLine{468 \textcolor{comment}{!    write(*,*) 'CalcTNred in N',N,rmax}}
\DoxyCodeLine{469 \textcolor{comment}{!    write(*,*) 'CalcTNred in s',MomInv}}
\DoxyCodeLine{470 \textcolor{comment}{!    write(*,*) 'CalcTNred in m',masses2}}
\DoxyCodeLine{471 }
\DoxyCodeLine{472     \textcolor{comment}{! allocation of TN functions}}
\DoxyCodeLine{473     nm1 = n-\/1}
\DoxyCodeLine{474     rmax\_m1 = max(rmax-\/1,0)}
\DoxyCodeLine{475     bino\_0 = binomtable(rmax\_m1,n+rmax\_m1-\/2)}
\DoxyCodeLine{476     bino\_i = binomtable(rmax\_m1,nm1+rmax\_m1-\/2)}
\DoxyCodeLine{477     \textcolor{keyword}{allocate}(tnm1\_0(bino\_0,0:rmax\_m1/2,0:rmax\_m1))}
\DoxyCodeLine{478     \textcolor{keyword}{allocate}(tnm1\_0aux(bino\_i,0:rmax\_m1/2,0:rmax\_m1))}
\DoxyCodeLine{479     \textcolor{keyword}{allocate}(tnm1\_i(bino\_i,0:rmax\_m1/2,0:rmax\_m1,5))}
\DoxyCodeLine{480     \textcolor{keyword}{allocate}(tnm1uv\_0(bino\_0,0:rmax\_m1/2,0:rmax\_m1))}
\DoxyCodeLine{481     \textcolor{keyword}{allocate}(tnm1uv\_0aux(bino\_i,0:rmax\_m1/2,0:rmax\_m1))}
\DoxyCodeLine{482     \textcolor{keyword}{allocate}(tnm1uv\_i(bino\_i,0:rmax\_m1/2,0:rmax\_m1,5))}
\DoxyCodeLine{483 }
\DoxyCodeLine{484     \textcolor{comment}{! determine binaries for TN-\/coefficients}}
\DoxyCodeLine{485     k=0}
\DoxyCodeLine{486     bin = 1}
\DoxyCodeLine{487     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.5)}
\DoxyCodeLine{488       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{489         nid(k) = id+bin}
\DoxyCodeLine{490         k = k+1}
\DoxyCodeLine{491 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{492       bin = 2*bin}
\DoxyCodeLine{493 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{494 }
\DoxyCodeLine{495     \textcolor{keyword}{call }calctnint(tnm1\_0aux,tnm1uv\_0aux,\mbox{\hyperlink{democache_8f90_a2b90f126f45301f6852c77bc8cb10842}{submominv}}(n,0,mominv),\mbox{\hyperlink{democache_8f90_aa08ec99fbe2eba620c66f7b0eff1b488}{submasses}}(n,0,masses2),  \&}
\DoxyCodeLine{496         nm1,rmax\_m1,nid(0),tnerr=tnm1err(0,0:rmax\_m1),     \&}
\DoxyCodeLine{497         tnerr2=tnm1err2(0,0:rmax\_m1))}
\DoxyCodeLine{498     \textcolor{keywordflow}{do} k=1,5}
\DoxyCodeLine{499       \textcolor{keyword}{call }calctnint(tnm1\_i(:,:,:,k),tnm1uv\_i(:,:,:,k),\mbox{\hyperlink{democache_8f90_a2b90f126f45301f6852c77bc8cb10842}{submominv}}(n,k,mominv),  \&}
\DoxyCodeLine{500           \mbox{\hyperlink{democache_8f90_aa08ec99fbe2eba620c66f7b0eff1b488}{submasses}}(n,k,masses2),nm1,rmax\_m1,nid(k),        \&}
\DoxyCodeLine{501           tnerr=tnm1err(k,0:rmax\_m1),tnerr2=tnm1err2(k,0:rmax\_m1))}
\DoxyCodeLine{502 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{503 }
\DoxyCodeLine{504     \textcolor{comment}{! shift of integration momentum in TN\(\backslash\)\{0\}}}
\DoxyCodeLine{505     \textcolor{keywordflow}{do} n0=0,rmax\_m1/2}
\DoxyCodeLine{506       tnm1\_0(1,n0,2*n0) = tnm1\_0aux(1,n0,2*n0)}
\DoxyCodeLine{507       \textcolor{keywordflow}{do} r=1,rmax\_m1-\/2*n0}
\DoxyCodeLine{508         mia1 = binomtable(r-\/1,n+r-\/3)+1}
\DoxyCodeLine{509         mia2 = binomtable(r,n+r-\/3)}
\DoxyCodeLine{510         mia3 = binomtable(r,n+r-\/2) }
\DoxyCodeLine{511         tnm1\_0(mia1:mia3,n0,r+2*n0) = tnm1\_0aux(1:mia2,n0,r+2*n0)}
\DoxyCodeLine{512 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{513 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{514     \textcolor{keywordflow}{do} r=1,rmax\_m1}
\DoxyCodeLine{515       \textcolor{keywordflow}{do} n0=0,(r-\/1)/2}
\DoxyCodeLine{516         \textcolor{keywordflow}{do} i=binomtable(r-\/2*n0-\/1,n+r-\/2*n0-\/3),1,-\/1}
\DoxyCodeLine{517           tnm1\_0(i,n0,r) = -\/tnm1\_0(i,n0,r-\/1)}
\DoxyCodeLine{518           \textcolor{keywordflow}{do} j=2,n-\/1 }
\DoxyCodeLine{519             tnm1\_0(i,n0,r) = tnm1\_0(i,n0,r)  \&}
\DoxyCodeLine{520                            -\/ tnm1\_0(addtocind(j,i,r-\/2*n0-\/1,n-\/1),n0,r)}
\DoxyCodeLine{521 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{522 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{523 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{524 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{525     \textcolor{keywordflow}{do} n0=n-\/3,rmax\_m1/2}
\DoxyCodeLine{526       tnm1uv\_0(1,n0,2*n0) = tnm1uv\_0aux(1,n0,2*n0)}
\DoxyCodeLine{527       \textcolor{keywordflow}{do} r=1,rmax\_m1-\/2*n0}
\DoxyCodeLine{528         mia1 = binomtable(r-\/1,n+r-\/3)+1}
\DoxyCodeLine{529         mia2 = binomtable(r,n+r-\/3)}
\DoxyCodeLine{530         mia3 = binomtable(r,n+r-\/2) }
\DoxyCodeLine{531         tnm1uv\_0(mia1:mia3,n0,r+2*n0) = tnm1uv\_0aux(1:mia2,n0,r+2*n0)}
\DoxyCodeLine{532 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{533 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{534     \textcolor{keywordflow}{do} r=2*n-\/6,rmax\_m1}
\DoxyCodeLine{535       \textcolor{keywordflow}{do} n0=n-\/3,(r-\/1)/2}
\DoxyCodeLine{536         \textcolor{keywordflow}{do} i=binomtable(r-\/2*n0-\/1,n+r-\/2*n0-\/3),1,-\/1}
\DoxyCodeLine{537           tnm1uv\_0(i,n0,r) = -\/tnm1uv\_0(i,n0,r-\/1)}
\DoxyCodeLine{538           \textcolor{keywordflow}{do} j=2,n-\/1}
\DoxyCodeLine{539             tnm1uv\_0(i,n0,r) = tnm1uv\_0(i,n0,r)  \&}
\DoxyCodeLine{540                              -\/ tnm1uv\_0(addtocind(j,i,r-\/2*n0-\/1,n-\/1),n0,r) }
\DoxyCodeLine{541 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{542 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{543 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{544 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{545     }
\DoxyCodeLine{546 }
\DoxyCodeLine{547     \textcolor{comment}{! determine inverse modified Caley matrix}}
\DoxyCodeLine{548     mm02 = elimminf2\_coli(masses2(0))}
\DoxyCodeLine{549     mm12 = elimminf2\_coli(masses2(1))}
\DoxyCodeLine{550     mm22 = elimminf2\_coli(masses2(2))}
\DoxyCodeLine{551     mm32 = elimminf2\_coli(masses2(3))}
\DoxyCodeLine{552     mm42 = elimminf2\_coli(masses2(4))}
\DoxyCodeLine{553     mm52 = elimminf2\_coli(masses2(5))}
\DoxyCodeLine{554     q10  = elimminf2\_coli(mominv(1))}
\DoxyCodeLine{555     q21  = elimminf2\_coli(mominv(2))}
\DoxyCodeLine{556     q32  = elimminf2\_coli(mominv(3))}
\DoxyCodeLine{557     q43  = elimminf2\_coli(mominv(4))}
\DoxyCodeLine{558     q54  = elimminf2\_coli(mominv(5))}
\DoxyCodeLine{559     \textcolor{keywordflow}{if} (n.le.9) \textcolor{keywordflow}{then}}
\DoxyCodeLine{560       q50  = elimminf2\_coli(mominv((n-\/6)*n+6))}
\DoxyCodeLine{561     \textcolor{keywordflow}{else}}
\DoxyCodeLine{562       q50 = elimminf2\_coli(mominv(4*n+1))}
\DoxyCodeLine{563 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{564     q20  = elimminf2\_coli(mominv(n+1))}
\DoxyCodeLine{565     q31  = elimminf2\_coli(mominv(n+2))}
\DoxyCodeLine{566     q42  = elimminf2\_coli(mominv(n+3))}
\DoxyCodeLine{567     q53  = elimminf2\_coli(mominv(n+4))}
\DoxyCodeLine{568     \textcolor{keywordflow}{if} (n.le.7) \textcolor{keywordflow}{then}}
\DoxyCodeLine{569       q40 = elimminf2\_coli(mominv((n-\/5)*n+5))}
\DoxyCodeLine{570       q51 = elimminf2\_coli(mominv((n-\/5)*n+6))}
\DoxyCodeLine{571     \textcolor{keywordflow}{else}}
\DoxyCodeLine{572       q40 = elimminf2\_coli(mominv(3*n+1))}
\DoxyCodeLine{573       q51 = elimminf2\_coli(mominv(3*n+2))}
\DoxyCodeLine{574 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{575     q30  = elimminf2\_coli(mominv(2*n+1))}
\DoxyCodeLine{576     q41  = elimminf2\_coli(mominv(2*n+2))}
\DoxyCodeLine{577     q52  = elimminf2\_coli(mominv(2*n+3))}
\DoxyCodeLine{578     \textcolor{comment}{! write(*,*) 'q50', q50}}
\DoxyCodeLine{579     \textcolor{comment}{! write(*,*) 'q20', q20}}
\DoxyCodeLine{580     \textcolor{comment}{! write(*,*) 'q31', q31}}
\DoxyCodeLine{581     \textcolor{comment}{! write(*,*) 'q42', q42}}
\DoxyCodeLine{582     \textcolor{comment}{! write(*,*) 'q53', q53}}
\DoxyCodeLine{583     \textcolor{comment}{! write(*,*) 'q40', q40}}
\DoxyCodeLine{584     \textcolor{comment}{! write(*,*) 'q51', q51}}
\DoxyCodeLine{585     \textcolor{comment}{! write(*,*) 'q30', q30}}
\DoxyCodeLine{586     \textcolor{comment}{! write(*,*) 'q41', q41}}
\DoxyCodeLine{587     \textcolor{comment}{! write(*,*) 'q52', q52}}
\DoxyCodeLine{588     }
\DoxyCodeLine{589     cnt = 1}
\DoxyCodeLine{590     \textcolor{keywordflow}{do} i=1,n-\/1}
\DoxyCodeLine{591       ff(i) = elimminf2\_coli(mominv(cnt)) + mm02  \&}
\DoxyCodeLine{592             -\/ elimminf2\_coli(masses2(i))}
\DoxyCodeLine{593       cnt = cnt+n-\/i}
\DoxyCodeLine{594 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{595  }
\DoxyCodeLine{596     mx(0,0) = 2d0*mm02}
\DoxyCodeLine{597     mx(1,0) = q10 -\/ mm12 + mm02}
\DoxyCodeLine{598     mx(2,0) = q20 -\/ mm22 + mm02}
\DoxyCodeLine{599     mx(3,0) = q30 -\/ mm32 + mm02}
\DoxyCodeLine{600     mx(4,0) = q40 -\/ mm42 + mm02}
\DoxyCodeLine{601     mx(5,0) = q50 -\/ mm52 + mm02}
\DoxyCodeLine{602     mx(0,1) = mx(1,0)}
\DoxyCodeLine{603     mx(1,1) = 2d0*q10}
\DoxyCodeLine{604     mx(2,1) = q10+q20-\/q21}
\DoxyCodeLine{605     mx(3,1) = q10+q30-\/q31}
\DoxyCodeLine{606     mx(4,1) = q10+q40-\/q41}
\DoxyCodeLine{607     mx(5,1) = q10+q50-\/q51}
\DoxyCodeLine{608     mx(0,2) = mx(2,0)}
\DoxyCodeLine{609     mx(1,2) = mx(2,1)}
\DoxyCodeLine{610     mx(2,2) = 2d0*q20}
\DoxyCodeLine{611     mx(3,2) = q20+q30-\/q32}
\DoxyCodeLine{612     mx(4,2) = q20+q40-\/q42}
\DoxyCodeLine{613     mx(5,2) = q20+q50-\/q52}
\DoxyCodeLine{614     mx(0,3) = mx(3,0)}
\DoxyCodeLine{615     mx(1,3) = mx(3,1)}
\DoxyCodeLine{616     mx(2,3) = mx(3,2)}
\DoxyCodeLine{617     mx(3,3) = 2d0*q30}
\DoxyCodeLine{618     mx(4,3) = q30+q40-\/q43}
\DoxyCodeLine{619     mx(5,3) = q30+q50-\/q53}
\DoxyCodeLine{620     mx(0,4) = mx(4,0)}
\DoxyCodeLine{621     mx(1,4) = mx(4,1)}
\DoxyCodeLine{622     mx(2,4) = mx(4,2)}
\DoxyCodeLine{623     mx(3,4) = mx(4,3)}
\DoxyCodeLine{624     mx(4,4) = 2d0*q40}
\DoxyCodeLine{625     mx(5,4) = q40+q50-\/q54}
\DoxyCodeLine{626     mx(0,5) = mx(5,0)}
\DoxyCodeLine{627     mx(1,5) = mx(5,1)}
\DoxyCodeLine{628     mx(2,5) = mx(5,2)}
\DoxyCodeLine{629     mx(3,5) = mx(5,3)}
\DoxyCodeLine{630     mx(4,5) = mx(5,4)}
\DoxyCodeLine{631     mx(5,5) = 2d0*q50}
\DoxyCodeLine{632 }
\DoxyCodeLine{633     \textcolor{keyword}{call }chinv(6,mx,mxinv)}
\DoxyCodeLine{634 }
\DoxyCodeLine{635     \textcolor{comment}{! determine X\_(0,5)}}
\DoxyCodeLine{636     \textcolor{keywordflow}{do} j=1,5}
\DoxyCodeLine{637       \textcolor{keywordflow}{do} i=1,5}
\DoxyCodeLine{638         mx0k(i,j) = mx(i,j-\/1)}
\DoxyCodeLine{639 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{640 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{641 }
\DoxyCodeLine{642     det = chdet(5,mx0k)}
\DoxyCodeLine{643     kbest = 5}
\DoxyCodeLine{644 }
\DoxyCodeLine{645 \textcolor{preprocessor}{\#ifdef TNtest    }}
\DoxyCodeLine{646 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'det'},5,det}
\DoxyCodeLine{647 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{648 \textcolor{preprocessor}{}}
\DoxyCodeLine{649     \textcolor{keywordflow}{do} j=5,2,-\/1}
\DoxyCodeLine{650       \textcolor{keywordflow}{do} i=1,5}
\DoxyCodeLine{651         mx0k(i,j) = mx(i,j)}
\DoxyCodeLine{652 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{653 }
\DoxyCodeLine{654       newdet =  chdet(5,mx0k)}
\DoxyCodeLine{655       \textcolor{keywordflow}{if} (abs(newdet).gt.abs(det)) \textcolor{keywordflow}{then}          }
\DoxyCodeLine{656         kbest = j-\/1}
\DoxyCodeLine{657 \textcolor{preprocessor}{\#ifdef TNtest    }}
\DoxyCodeLine{658 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'det'},j-\/1,newdet}
\DoxyCodeLine{659 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{660 \textcolor{preprocessor}{}        det = newdet}
\DoxyCodeLine{661 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{662     }
\DoxyCodeLine{663 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{664 }
\DoxyCodeLine{665 \textcolor{preprocessor}{\#ifdef TNtest    }}
\DoxyCodeLine{666 \textcolor{preprocessor}{}\textcolor{comment}{!    kbest=5}}
\DoxyCodeLine{667     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'kbest'},kbest}
\DoxyCodeLine{668 \textcolor{preprocessor}{\#endif    }}
\DoxyCodeLine{669 \textcolor{preprocessor}{}}
\DoxyCodeLine{670     }
\DoxyCodeLine{671 }
\DoxyCodeLine{672     }
\DoxyCodeLine{673     \textcolor{keywordflow}{do} i=1,5}
\DoxyCodeLine{674       mx0k(i,1) = mx(i,1)}
\DoxyCodeLine{675       mx0k(i,kbest) = mx(i,0)}
\DoxyCodeLine{676 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{677 }
\DoxyCodeLine{678     \textcolor{keyword}{call }chinv(5,mx0k,mx0kinv)}
\DoxyCodeLine{679     \textcolor{keywordflow}{do} i=1,5}
\DoxyCodeLine{680       mx0kinv(kbest,i) = 0d0}
\DoxyCodeLine{681 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{682 }
\DoxyCodeLine{683     mxinvs = sum(mxinv(0:5,0))}
\DoxyCodeLine{684     \textcolor{keywordflow}{do} i=1,5}
\DoxyCodeLine{685       mx0kinvs(i) = sum(mx0kinv(i,1:5))}
\DoxyCodeLine{686 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{687 }
\DoxyCodeLine{688     \textcolor{comment}{! for alternative error estimate}}
\DoxyCodeLine{689     z(1:5,1:5) = mx(1:5,1:5)}
\DoxyCodeLine{690 }
\DoxyCodeLine{691     zmx0kinv = matmul(z,mx0kinv)}
\DoxyCodeLine{692 }
\DoxyCodeLine{693     \textcolor{keywordflow}{do} i=1,5}
\DoxyCodeLine{694       maxzmx0kinv(i) = maxval(abs(zmx0kinv(1:5,i)))}
\DoxyCodeLine{695       zmx0kinvs(i) = sum(zmx0kinv(i,1:5))}
\DoxyCodeLine{696 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{697 }
\DoxyCodeLine{698     maxzmx0kinvs = maxval(abs(zmx0kinvs(1:5)))}
\DoxyCodeLine{699 }
\DoxyCodeLine{700     maxz = maxval(abs(z))}
\DoxyCodeLine{701 }
\DoxyCodeLine{702     \textcolor{comment}{! calculation of UV-\/divergent parts      }}
\DoxyCodeLine{703     \textcolor{comment}{! TN UV-\/finite for n0<N-\/2}}
\DoxyCodeLine{704     \textcolor{comment}{! TNuv(:,0:min(rmax/2,N-\/3),:) = 0d0}}
\DoxyCodeLine{705     }
\DoxyCodeLine{706     \textcolor{comment}{! PV reduction (5.10)}}
\DoxyCodeLine{707     \textcolor{keywordflow}{do} r=2*n-\/4,rmax}
\DoxyCodeLine{708       \textcolor{keywordflow}{do} n0=n-\/2,r/2}
\DoxyCodeLine{709         \textcolor{keywordflow}{do} cind=1,binomtable(r-\/2*n0,n+r-\/2*n0-\/2)}
\DoxyCodeLine{710         }
\DoxyCodeLine{711           tnuv(cind,n0,r) = tnm1uv\_0(cind,n0-\/1,r-\/2) + 2*mm02*tnuv(cind,n0-\/1,r-\/2)}
\DoxyCodeLine{712           \textcolor{keywordflow}{do} i=1,nm1}
\DoxyCodeLine{713             tnuv(cind,n0,r) = tnuv(cind,n0,r)  \&}
\DoxyCodeLine{714                             + ff(i)*tnuv(addtocind(i,cind,r-\/2*n0,n-\/1),n0-\/1,r-\/1)}
\DoxyCodeLine{715 \textcolor{keywordflow}{          end do} }
\DoxyCodeLine{716           tnuv(cind,n0,r) = tnuv(cind,n0,r)/(2*(r+3-\/n))}
\DoxyCodeLine{717     }
\DoxyCodeLine{718 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{719 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{720 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{721 }
\DoxyCodeLine{722     \textcolor{comment}{! scalar coefficient}}
\DoxyCodeLine{723     tn = 0d0}
\DoxyCodeLine{724     tn(1,0,0) = -\/mxinv(0,0)*tnm1\_0(1,0,0)}
\DoxyCodeLine{725     \textcolor{keywordflow}{do} k=1,5}
\DoxyCodeLine{726       tn(1,0,0) = tn(1,0,0) \&}
\DoxyCodeLine{727            + mxinv(k,0)*(tnm1\_i(1,0,0,k)-\/tnm1\_0(1,0,0))}
\DoxyCodeLine{728 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{729 }
\DoxyCodeLine{730 \textcolor{comment}{!   TNerr(0) = max( maxval(abs(mxinv(0:4,0)))*TNm1err(0,0), \&}}
\DoxyCodeLine{731     tnerr(0) = max(abs(mxinvs)*tnm1err(0,0), \&}
\DoxyCodeLine{732                    abs(mxinv(1,0))*tnm1err(1,0) , \&}
\DoxyCodeLine{733                    abs(mxinv(2,0))*tnm1err(2,0) , \&}
\DoxyCodeLine{734                    abs(mxinv(3,0))*tnm1err(3,0) , \&}
\DoxyCodeLine{735                    abs(mxinv(4,0))*tnm1err(4,0) , \& }
\DoxyCodeLine{736                    abs(mxinv(5,0))*tnm1err(5,0) )}
\DoxyCodeLine{737 }
\DoxyCodeLine{738     tnerr2(0) = max(abs(mxinvs)*tnm1err2(0,0), \&}
\DoxyCodeLine{739                    abs(mxinv(1,0))*tnm1err2(1,0) , \&}
\DoxyCodeLine{740                    abs(mxinv(2,0))*tnm1err2(2,0) , \&}
\DoxyCodeLine{741                    abs(mxinv(3,0))*tnm1err2(3,0) , \&}
\DoxyCodeLine{742                    abs(mxinv(4,0))*tnm1err2(4,0) , \& }
\DoxyCodeLine{743                    abs(mxinv(5,0))*tnm1err2(5,0) )}
\DoxyCodeLine{744 }
\DoxyCodeLine{745     \textcolor{keywordflow}{if} (rmax.eq.0) \textcolor{keywordflow}{return}}
\DoxyCodeLine{746 }
\DoxyCodeLine{747 }
\DoxyCodeLine{748     \textcolor{comment}{! formula (7.13) extended to arbitrary N}}
\DoxyCodeLine{749     \textcolor{keywordflow}{do} r=0,rmax\_m1}
\DoxyCodeLine{750       \textcolor{keywordflow}{do} n0=0,max((r-\/n+6)/2,0)}
\DoxyCodeLine{751         bino\_m1 = binomtable(r-\/2*n0,n+r-\/2*n0-\/2)}
\DoxyCodeLine{752         \textcolor{keywordflow}{do} i=1,bino\_m1}
\DoxyCodeLine{753           inds = calccindarr(nm1,r-\/2*n0,i)}
\DoxyCodeLine{754             }
\DoxyCodeLine{755           \textcolor{keywordflow}{do} m=1,5}
\DoxyCodeLine{756             s(m) = -\/tnm1\_0(i,n0,r)}
\DoxyCodeLine{757 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{758 }
\DoxyCodeLine{759 \textcolor{preprocessor}{\#ifdef TNtest}}
\DoxyCodeLine{760 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Tnred s(m)'},s}
\DoxyCodeLine{761 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{762 \textcolor{preprocessor}{}}
\DoxyCodeLine{763           \textcolor{keywordflow}{if} (inds(1).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{764             s(1) = s(1) + tnm1\_i(dropcind(1,i,r-\/2*n0,nm1),n0,r,1)}
\DoxyCodeLine{765 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{766           \textcolor{keywordflow}{if} (inds(2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{767             s(2) = s(2) + tnm1\_i(dropcind(2,i,r-\/2*n0,nm1),n0,r,2)}
\DoxyCodeLine{768 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{769           \textcolor{keywordflow}{if} (inds(3).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{770             s(3) = s(3) + tnm1\_i(dropcind(3,i,r-\/2*n0,nm1),n0,r,3)}
\DoxyCodeLine{771 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{772           \textcolor{keywordflow}{if} (inds(4).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{773             s(4) = s(4) + tnm1\_i(dropcind(4,i,r-\/2*n0,nm1),n0,r,4)}
\DoxyCodeLine{774 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{775           \textcolor{keywordflow}{if} (inds(5).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{776             s(5) = s(5) + tnm1\_i(dropcind(5,i,r-\/2*n0,nm1),n0,r,5)}
\DoxyCodeLine{777 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{778 }
\DoxyCodeLine{779 \textcolor{preprocessor}{\#ifdef TNtest}}
\DoxyCodeLine{780 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Tnred s(m)'},s}
\DoxyCodeLine{781 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{782 \textcolor{preprocessor}{}}
\DoxyCodeLine{783           \textcolor{keywordflow}{do} k=1,5}
\DoxyCodeLine{784             tnaux = mx0kinv(k,1)*s(1)+mx0kinv(k,2)*s(2) \&}
\DoxyCodeLine{785                   + mx0kinv(k,3)*s(3)+mx0kinv(k,4)*s(4)+mx0kinv(k,5)*s(5)}
\DoxyCodeLine{786             iaux = addtocind(k,i,r,n-\/1)}
\DoxyCodeLine{787             tn(iaux,n0,r+1) = tn(iaux,n0,r+1) + (inds(k)+1)*tnaux/(r+1)           }
\DoxyCodeLine{788 \textcolor{preprocessor}{\#ifdef TNtest}}
\DoxyCodeLine{789 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Tnred comb'},k,mx0kinv(k,1)*s(1),mx0kinv(k,2)*s(2) \&}
\DoxyCodeLine{790                   , mx0kinv(k,3)*s(3),mx0kinv(k,4)*s(4),mx0kinv(k,5)*s(5), tnaux}
\DoxyCodeLine{791 }
\DoxyCodeLine{792             \textcolor{keywordflow}{if}(abs(tnaux).ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{793               \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Tnred cancel'}, k, max(abs(mx0kinv(k,1)*s(1)),abs(mx0kinv(k,2)*s(2)) \&}
\DoxyCodeLine{794                   , abs(mx0kinv(k,3)*s(3)),abs(mx0kinv(k,4)*s(4)),abs(mx0kinv(k,5)*s(5))) \&}
\DoxyCodeLine{795                   /abs(tnaux)}
\DoxyCodeLine{796 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{797 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{798 \textcolor{preprocessor}{}            }
\DoxyCodeLine{799 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{800 }
\DoxyCodeLine{801 }
\DoxyCodeLine{802 }
\DoxyCodeLine{803 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{804 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{805 }
\DoxyCodeLine{806       \textcolor{keywordflow}{if} (r.le.rmax-\/1) \textcolor{keywordflow}{then}  }
\DoxyCodeLine{807 }
\DoxyCodeLine{808         tnerr(r+1) = max( maxval(abs(mx0kinvs(1:5)))*tnm1err(0,r), \&}
\DoxyCodeLine{809                    maxval(abs(mx0kinv(1:5,1)))*tnm1err(1,r) , \&}
\DoxyCodeLine{810                    maxval(abs(mx0kinv(1:5,2)))*tnm1err(2,r) , \&}
\DoxyCodeLine{811                    maxval(abs(mx0kinv(1:5,3)))*tnm1err(3,r) , \&}
\DoxyCodeLine{812                    maxval(abs(mx0kinv(1:5,4)))*tnm1err(4,r) , \&}
\DoxyCodeLine{813                    maxval(abs(mx0kinv(1:5,5)))*tnm1err(5,r) )}
\DoxyCodeLine{814 }
\DoxyCodeLine{815         tnerr2(r+1) = max( abs(maxzmx0kinvs)*tnm1err2(0,r), \&}
\DoxyCodeLine{816                    abs(maxzmx0kinv(1))*tnm1err2(1,r) , \&}
\DoxyCodeLine{817                    abs(maxzmx0kinv(2))*tnm1err2(2,r) , \&}
\DoxyCodeLine{818                    abs(maxzmx0kinv(3))*tnm1err2(3,r) , \&}
\DoxyCodeLine{819                    abs(maxzmx0kinv(4))*tnm1err2(4,r) , \&}
\DoxyCodeLine{820                    abs(maxzmx0kinv(5))*tnm1err2(5,r) )/maxz}
\DoxyCodeLine{821 }
\DoxyCodeLine{822 }
\DoxyCodeLine{823         \textcolor{keywordflow}{if} (mode\_coli.lt.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{824           gram= mx(1:5,1:5)}
\DoxyCodeLine{825 }
\DoxyCodeLine{826           gramdet = chdet(5,gram)}
\DoxyCodeLine{827 }
\DoxyCodeLine{828 \textcolor{preprocessor}{\#ifdef TNtest}}
\DoxyCodeLine{829 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*)}
\DoxyCodeLine{830           \textcolor{keywordflow}{do} i = 1,5}
\DoxyCodeLine{831             \textcolor{keywordflow}{do} j = 1,5}
\DoxyCodeLine{832               \textcolor{keyword}{write}(*,fmt999)  i,j,gram(i,j)}
\DoxyCodeLine{833 \textcolor{keywordflow}{            enddo}}
\DoxyCodeLine{834 \textcolor{keywordflow}{          enddo}}
\DoxyCodeLine{835           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'TNred relGramdet='},gramdet/det}
\DoxyCodeLine{836 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{837 \textcolor{preprocessor}{}}
\DoxyCodeLine{838           \textcolor{keywordflow}{if} (max(abs(tn(1,0,0)),maxval(abs(tn(1:6,0,1))))*abs(gramdet/det).gt. \&}
\DoxyCodeLine{839               tnerr(r+1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{840 }
\DoxyCodeLine{841             tnerr(r+1)= max(tnerr(r+1),   \&}
\DoxyCodeLine{842                 max(abs(tn(1,0,0)),maxval(abs(tn(1:6,0,1))))*abs(gramdet/det) )}
\DoxyCodeLine{843             tnerr2(r+1)= max(tnerr2(r+1),   \&}
\DoxyCodeLine{844                 max(abs(tn(1,0,0)),maxval(abs(tn(1:6,0,1))))*abs(gramdet/det) )}
\DoxyCodeLine{845 }
\DoxyCodeLine{846             \textcolor{keywordflow}{if} (abs(gramdet/det).gt.reqacc\_coli) \textcolor{keywordflow}{then}}
\DoxyCodeLine{847               \textcolor{keyword}{call }seterrflag\_coli(-\/6)}
\DoxyCodeLine{848               \textcolor{keyword}{call }errout\_coli(\textcolor{stringliteral}{'CalcTNred'},  \&}
\DoxyCodeLine{849                   \textcolor{stringliteral}{'input momenta inconsistent! (not 4-\/dimensional)'},  \&}
\DoxyCodeLine{850                   errorwriteflag)}
\DoxyCodeLine{851               \textcolor{keywordflow}{if} (errorwriteflag) \textcolor{keywordflow}{then}}
\DoxyCodeLine{852                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: q10 = '},q10}
\DoxyCodeLine{853                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: q21 = '},q21}
\DoxyCodeLine{854                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: q32 = '},q32}
\DoxyCodeLine{855                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: q43 = '},q43}
\DoxyCodeLine{856                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: q54 = '},q54}
\DoxyCodeLine{857                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: q50 = '},q50}
\DoxyCodeLine{858                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: q20 = '},q10}
\DoxyCodeLine{859                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: q31 = '},q31}
\DoxyCodeLine{860                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: q42 = '},q42}
\DoxyCodeLine{861                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: q53 = '},q53}
\DoxyCodeLine{862                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: q40 = '},q40}
\DoxyCodeLine{863                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: q51 = '},q51}
\DoxyCodeLine{864                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: q30 = '},q30}
\DoxyCodeLine{865                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: q41 = '},q41}
\DoxyCodeLine{866                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: q52 = '},q52}
\DoxyCodeLine{867                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: mm02 = '},mm02}
\DoxyCodeLine{868                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: mm12 = '},mm12}
\DoxyCodeLine{869                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: mm22 = '},mm22   }
\DoxyCodeLine{870                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: mm32 = '},mm32   }
\DoxyCodeLine{871                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: mm42 = '},mm42   }
\DoxyCodeLine{872                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: mm52 = '},mm52   }
\DoxyCodeLine{873                 \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcTNred: gram = '},gramdet/det  }
\DoxyCodeLine{874 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{875 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{876 }
\DoxyCodeLine{877 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{878 }
\DoxyCodeLine{879 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{880 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{881 }
\DoxyCodeLine{882 }
\DoxyCodeLine{883 \textcolor{preprocessor}{\#ifdef TNtest}}
\DoxyCodeLine{884 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Tnred mn err'},tnm1err(1:5,r)}
\DoxyCodeLine{885             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Tnred coef err'}, (maxval(abs(mx0kinv(1:5,k))),k=1,5)}
\DoxyCodeLine{886             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Tnred err'},tnerr(r+1)}
\DoxyCodeLine{887 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{888 \textcolor{preprocessor}{}}
\DoxyCodeLine{889 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{890                        }
\DoxyCodeLine{891 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiontn_a68bc77ca3318efc863017381616b8c14}\label{namespacereductiontn_a68bc77ca3318efc863017381616b8c14}} 
\index{reductiontn@{reductiontn}!submasses@{submasses}}
\index{submasses@{submasses}!reductiontn@{reductiontn}}
\doxysubsubsection{\texorpdfstring{submasses()}{submasses()}}
{\footnotesize\ttfamily double complex function, dimension(0\+:n-\/2) reductiontn\+::submasses (\begin{DoxyParamCaption}\item[{integer}]{N,  }\item[{integer}]{k,  }\item[{double complex, dimension(0\+:n-\/1)}]{masses }\end{DoxyParamCaption})}



Definition at line 904 of file reduction\+T\+N.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{904 }
\DoxyCodeLine{905     \textcolor{keywordtype}{integer} :: N,k,i}
\DoxyCodeLine{906     \textcolor{keywordtype}{double complex} :: masses(0:N-\/1), SubMasses(0:N-\/2)}
\DoxyCodeLine{907 }
\DoxyCodeLine{908     \textcolor{keywordflow}{if} ((k.gt.n-\/1).or.(k.lt.0)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{909       \textcolor{keyword}{write}(nerrout\_coli,*) \textcolor{stringliteral}{'SubMasses:'}}
\DoxyCodeLine{910       \textcolor{keyword}{write}(nerrout\_coli,*) \textcolor{stringliteral}{'inkonsistent argument k'}, k}
\DoxyCodeLine{911       \textcolor{keyword}{write}(nerrout\_coli,*) 0, \textcolor{stringliteral}{'<= k <='}, n-\/1, \textcolor{stringliteral}{'required!'}}
\DoxyCodeLine{912       stop}
\DoxyCodeLine{913 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{914 }
\DoxyCodeLine{915     \textcolor{keywordflow}{do} i=0,n-\/2}
\DoxyCodeLine{916       \textcolor{keywordflow}{if} (i.lt.k) \textcolor{keywordflow}{then}}
\DoxyCodeLine{917         submasses(i) = masses(i)}
\DoxyCodeLine{918       \textcolor{keywordflow}{else}}
\DoxyCodeLine{919         submasses(i) = masses(i+1)}
\DoxyCodeLine{920 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{921 \textcolor{keywordflow}{    end do}    }
\DoxyCodeLine{922 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiontn_a187402bab9bf2fa98c503fcf77ed4233}\label{namespacereductiontn_a187402bab9bf2fa98c503fcf77ed4233}} 
\index{reductiontn@{reductiontn}!submominv@{submominv}}
\index{submominv@{submominv}!reductiontn@{reductiontn}}
\doxysubsubsection{\texorpdfstring{submominv()}{submominv()}}
{\footnotesize\ttfamily double complex function, dimension(binomtable(2,n-\/1)) reductiontn\+::submominv (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{N,  }\item[{integer, intent(in)}]{k,  }\item[{double complex, dimension(binomtable(2,n))}]{Mom\+Inv }\end{DoxyParamCaption})}



Definition at line 977 of file reduction\+T\+N.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{977 }
\DoxyCodeLine{978     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: N,k}
\DoxyCodeLine{979     \textcolor{keywordtype}{integer} :: i,cnt,moms,limit}
\DoxyCodeLine{980     \textcolor{keywordtype}{double complex} :: MomInv(BinomTable(2,N)), SubMomInv(BinomTable(2,N-\/1))}
\DoxyCodeLine{981 }
\DoxyCodeLine{982     \textcolor{comment}{! write(*,*) 'SubMomIv', N,k}}
\DoxyCodeLine{983     \textcolor{keywordflow}{if} ((k.gt.n-\/1).or.(k.lt.0)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{984       \textcolor{keyword}{write}(nerrout\_coli,*) \textcolor{stringliteral}{'SubMomInv:'}}
\DoxyCodeLine{985       \textcolor{keyword}{write}(nerrout\_coli,*) \textcolor{stringliteral}{'inkonsistent argument k'}, k}
\DoxyCodeLine{986       \textcolor{keyword}{write}(nerrout\_coli,*) 0, \textcolor{stringliteral}{'<= k <='}, n-\/1, \textcolor{stringliteral}{'required!'}}
\DoxyCodeLine{987       stop}
\DoxyCodeLine{988 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{989 }
\DoxyCodeLine{990     \textcolor{keywordflow}{if} (n.eq.2) \textcolor{keywordflow}{return}}
\DoxyCodeLine{991 }
\DoxyCodeLine{992     cnt = 1}
\DoxyCodeLine{993     \textcolor{keywordflow}{do} moms=1,(n-\/3)/2}
\DoxyCodeLine{994       \textcolor{keywordflow}{do} i=1,n}
\DoxyCodeLine{995         \textcolor{keywordflow}{if} (i.ne.k+1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{996           \textcolor{keywordflow}{if} ((k.ge.i).and.(i.ge.k-\/moms+1).or.(n+k.ge.i).and.(i.ge.n+k-\/moms+1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{997             submominv(cnt) = mominv(n*moms+i)}
\DoxyCodeLine{998           \textcolor{keywordflow}{else}}
\DoxyCodeLine{999             submominv(cnt) = mominv(n*(moms-\/1)+i)}
\DoxyCodeLine{1000 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1001 }
\DoxyCodeLine{1002           cnt = cnt+1}
\DoxyCodeLine{1003 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1004 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{1005 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{1006 }
\DoxyCodeLine{1007     \textcolor{keywordflow}{if} (mod(n,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1008       moms = (n-\/1)/2}
\DoxyCodeLine{1009       \textcolor{keywordflow}{if}(k.le.(n-\/1)/2) \textcolor{keywordflow}{then} }
\DoxyCodeLine{1010         limit = (n+1)/2}
\DoxyCodeLine{1011       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1012         limit = (n-\/1)/2}
\DoxyCodeLine{1013 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1014       \textcolor{keywordflow}{do} i=1,limit}
\DoxyCodeLine{1015         \textcolor{keywordflow}{if} (i.ne.k+1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1016           \textcolor{keywordflow}{if} ((k.ge.i).and.(i.ge.k-\/moms+1).or.(n+k.ge.i).and.(i.ge.n+k-\/moms+1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1017             submominv(cnt) = mominv(n*moms+i-\/(n-\/1)/2)}
\DoxyCodeLine{1018           \textcolor{keywordflow}{else}}
\DoxyCodeLine{1019             submominv(cnt) = mominv(n*(moms-\/1)+i)}
\DoxyCodeLine{1020 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1021 }
\DoxyCodeLine{1022           cnt = cnt+1}
\DoxyCodeLine{1023 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1024 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{1025 }
\DoxyCodeLine{1026     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1027       \textcolor{keywordflow}{do} i=1,n}
\DoxyCodeLine{1028         \textcolor{keywordflow}{if} (i.ne.k+1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1029           moms = (n/2-\/1)}
\DoxyCodeLine{1030           \textcolor{keywordflow}{if} ((k.ge.i).and.(i.ge.k-\/moms+1).or.(n+k.ge.i).and.(i.ge.n+k-\/moms+1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1031             \textcolor{keywordflow}{if} (i.gt.n/2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1032               submominv(cnt) = mominv(n*moms-\/n/2+i)}
\DoxyCodeLine{1033             \textcolor{keywordflow}{else}}
\DoxyCodeLine{1034               submominv(cnt) = mominv(n*moms+i)}
\DoxyCodeLine{1035 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{1036           \textcolor{keywordflow}{else}}
\DoxyCodeLine{1037             submominv(cnt) = mominv(n*(moms-\/1)+i)}
\DoxyCodeLine{1038 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1039 }
\DoxyCodeLine{1040           cnt = cnt+1}
\DoxyCodeLine{1041 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1042 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{1043 }
\DoxyCodeLine{1044 \textcolor{keywordflow}{    end if}  }
\DoxyCodeLine{1045 }
\DoxyCodeLine{1046 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductiontn_a593735106f0802a1c97f7f237fd571e7}\label{namespacereductiontn_a593735106f0802a1c97f7f237fd571e7}} 
\index{reductiontn@{reductiontn}!submomvec@{submomvec}}
\index{submomvec@{submomvec}!reductiontn@{reductiontn}}
\doxysubsubsection{\texorpdfstring{submomvec()}{submomvec()}}
{\footnotesize\ttfamily double complex function, dimension(0\+:3,n-\/2) reductiontn\+::submomvec (\begin{DoxyParamCaption}\item[{integer}]{N,  }\item[{integer}]{k,  }\item[{double complex, dimension(0\+:3,n-\/1)}]{Mom\+Vec }\end{DoxyParamCaption})}



Definition at line 935 of file reduction\+T\+N.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{935 }
\DoxyCodeLine{936     \textcolor{keywordtype}{integer} :: N,k,i}
\DoxyCodeLine{937     \textcolor{keywordtype}{double complex} :: MomVec(0:3,N-\/1), SubMomVec(0:3,N-\/2)}
\DoxyCodeLine{938 }
\DoxyCodeLine{939     \textcolor{keywordflow}{if} ((k.gt.n-\/1).or.(k.lt.0)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{940       \textcolor{keyword}{write}(nerrout\_coli,*) \textcolor{stringliteral}{'SubMomVec:'}}
\DoxyCodeLine{941       \textcolor{keyword}{write}(nerrout\_coli,*) \textcolor{stringliteral}{'inkonsistent argument k'}, k}
\DoxyCodeLine{942       \textcolor{keyword}{write}(nerrout\_coli,*) 0, \textcolor{stringliteral}{'<= k <='}, n-\/1, \textcolor{stringliteral}{'required!'}}
\DoxyCodeLine{943       stop}
\DoxyCodeLine{944 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{945 }
\DoxyCodeLine{946     \textcolor{keywordflow}{if} (k.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{947       \textcolor{keywordflow}{do} i=1,n-\/2}
\DoxyCodeLine{948         submomvec(0:3,i) = momvec(0:3,i+1)-\/momvec(0:3,1)}
\DoxyCodeLine{949 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{950 }
\DoxyCodeLine{951     \textcolor{keywordflow}{else}}
\DoxyCodeLine{952       \textcolor{keywordflow}{do} i=1,n-\/2}
\DoxyCodeLine{953         \textcolor{keywordflow}{if} (i.lt.k) \textcolor{keywordflow}{then}}
\DoxyCodeLine{954           submomvec(0:3,i) = momvec(0:3,i)}
\DoxyCodeLine{955         \textcolor{keywordflow}{else}}
\DoxyCodeLine{956           submomvec(0:3,i) = momvec(0:3,i+1)}
\DoxyCodeLine{957 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{958 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{959 }
\DoxyCodeLine{960 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{961 }

\end{DoxyCode}
