\hypertarget{namespacereductionc}{}\doxysection{reductionc Module Reference}
\label{namespacereductionc}\index{reductionc@{reductionc}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacereductionc_a704ca1c979866623c152f76fefc882f8}{calcc}} (C, Cuv, p10, p21, p20, m02, m12, m22, rmax, id, Cerr1, Cerr2, rbasic, acc\+\_\+req\+\_\+\+Cextra)
\item 
subroutine \mbox{\hyperlink{namespacereductionc_a825edc5ee13bd3456e398fb3a3e642c9}{calccred}} (C, Cuv, p10, p21, p20, m02, m12, m22, rmax, id, Cerr1, Cerr2, rbasic, acc\+\_\+req\+\_\+\+Cextra)
\item 
subroutine \mbox{\hyperlink{namespacereductionc_a2e20ea986747112f4fd11824edd0b104}{calccuv}} (Cuv, Buv\+\_\+0, m02, f, rmax, id)
\item 
subroutine \mbox{\hyperlink{namespacereductionc_a0c9c9737ac7e2bc0981b3641d6114dae}{calccpv1}} (C, Cuv, p10, p21, p20, m02, m12, m22, rmax, id, Cerr, Cerr2)
\item 
subroutine \mbox{\hyperlink{namespacereductionc_ab619d7b52494c18fd799e600ec0820a3}{calccpv1o}} (C, Cuv, p10, p21, p20, m02, m12, m22, rmax, id, Cerr, Cerr2)
\item 
subroutine \mbox{\hyperlink{namespacereductionc_a1e457556ed977295844fa971024ff95c}{calccpv}} (C, Cuv, p10, p21, p20, m02, m12, m22, rmax, id, Cerr, Cerr2)
\item 
subroutine \mbox{\hyperlink{namespacereductionc_a19fdc0454a218ea4ba1dc122fe85b68c}{calccpv2}} (C, Cuv, p10, p21, p20, m02, m12, m22, rmax, id, Cerr, Cerr2)
\item 
subroutine \mbox{\hyperlink{namespacereductionc_a4834491397b1d3bcd391418091d68d31}{calccpvshift}} (Cshift, Cuvshift, p10shift, p21shift, p20shift, m02shift, m12shift, m22shift, rmax, id, Cerr, Cerr2)
\item 
subroutine \mbox{\hyperlink{namespacereductionc_a3aabc53424377d93d71454fc18d1eaed}{calccgn}} (C, Cuv, p10, p21, p20, m02, m12, m22, rmax, ordg\+\_\+min, ordg\+\_\+max, id, Cerr, acc\+\_\+req\+\_\+\+Cr, Cerr2)
\item 
subroutine \mbox{\hyperlink{namespacereductionc_a7f71e9787e92395ba2325d71562acda4}{calccg}} (C, Cuv, p10, p21, p20, m02, m12, m22, rmax, ordg\+\_\+min, ordg\+\_\+max, id, Cerr, acc\+\_\+req\+\_\+\+Cr, Cerr2)
\item 
subroutine \mbox{\hyperlink{namespacereductionc_ad484f0b8dbe4261806df80cd75010944}{calccgr}} (C, Cuv, p10, p21, p20, m02, m12, m22, rmax, ordgr\+\_\+min, ordgr\+\_\+max, id, Cerr, acc\+\_\+req\+\_\+\+Cr, Cerr2)
\item 
subroutine \mbox{\hyperlink{namespacereductionc_afd9cf6480f6a7a06c66ba147e1554d30}{calccgy}} (C, Cuv, p10, p21, p20, m02, m12, m22, rmax, ordgy\+\_\+min, ordgy\+\_\+max, id, Cerr, acc\+\_\+req\+\_\+\+Cr, Cerr2)
\item 
subroutine \mbox{\hyperlink{namespacereductionc_a02b30603b2e8f40a4f0ca04ac28e25c5}{calccgyo}} (C, Cuv, p10, p21, p20, m02, m12, m22, rmax, ordgy\+\_\+min, ordgy\+\_\+max, id, Cerr, acc\+\_\+req\+\_\+\+Cr, Cerr2)
\item 
subroutine \mbox{\hyperlink{namespacereductionc_ae0f83cbcfecb7a8d633d6b45c6686f29}{calccgp}} (C, Cuv, p10, p21, p20, m02, m12, m22, rmax, ordgp\+\_\+min, ordgp\+\_\+max, id, Cerr, acc\+\_\+req\+\_\+\+Cr, Cerr2)
\item 
subroutine \mbox{\hyperlink{namespacereductionc_a538f357262f51f0c6e2521677fd14586}{calccgpf}} (C, Cuv, p10, p21, p20, m02, m12, m22, rmax, ordgpf\+\_\+min, ordgpf\+\_\+max, id, Cerr, acc\+\_\+req\+\_\+\+Cr, Cerr2)
\item 
subroutine \mbox{\hyperlink{namespacereductionc_adf734eec39325cfe8542e6050a2e12b5}{copycimp3}} (C, C\+\_\+alt, Cerr, Cerr\+\_\+alt, Cerr1, Cerr1\+\_\+alt, Cerr2, Cerr2\+\_\+alt, Crmethod, Crmethod\+\_\+alt, rmax, r\+\_\+alt)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
double precision, parameter \mbox{\hyperlink{namespacereductionc_a19db4465a44ccdcd73f8e4db70749b94}{truncfacc}} = 1d2
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacereductionc_a704ca1c979866623c152f76fefc882f8}\label{namespacereductionc_a704ca1c979866623c152f76fefc882f8}} 
\index{reductionc@{reductionc}!calcc@{calcc}}
\index{calcc@{calcc}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{calcc()}{calcc()}}
{\footnotesize\ttfamily subroutine reductionc\+::calcc (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{C,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Cuv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr1,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr2,  }\item[{integer, intent(in), optional}]{rbasic,  }\item[{double precision, dimension(0\+:rmax), intent(in), optional}]{acc\+\_\+req\+\_\+\+Cextra }\end{DoxyParamCaption})}



Definition at line 95 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{95   }
\DoxyCodeLine{96     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax, id}
\DoxyCodeLine{97     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{optional}, \textcolor{keywordtype}{intent(in)} :: rbasic}
\DoxyCodeLine{98     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{optional}, \textcolor{keywordtype}{intent(in)} :: acc\_req\_Cextra(0:rmax)}
\DoxyCodeLine{99     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{100     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Cuv(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{101     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: C(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{102     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Cerr1(0:rmax),Cerr2(0:rmax)}
\DoxyCodeLine{103     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Caux(:,:,:), Cuvaux(:,:,:), fct(:)}
\DoxyCodeLine{104     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: Cerr1aux(:),Cerr2aux(:)}
\DoxyCodeLine{105     \textcolor{keywordtype}{double complex} :: x(6)}
\DoxyCodeLine{106     \textcolor{keywordtype}{integer} :: rank,switch,cnt,n0,n1,n2,r,rb}
\DoxyCodeLine{107     \textcolor{keywordtype}{logical} :: nocalc,wrica}
\DoxyCodeLine{108 }
\DoxyCodeLine{109 \textcolor{preprocessor}{\#ifdef TRACECin}}
\DoxyCodeLine{110 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcC in '},rmax,id}
\DoxyCodeLine{111 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{112 \textcolor{preprocessor}{}}
\DoxyCodeLine{113     \textcolor{keywordflow}{if} (use\_cache\_system) \textcolor{keywordflow}{then}}
\DoxyCodeLine{114       \textcolor{keywordflow}{if} ((ncache.gt.0).and.(ncache.le.ncache\_max)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{115 \textcolor{comment}{!        if (use\_cache(ncache).ge.3) then}}
\DoxyCodeLine{116           x(1)=p10}
\DoxyCodeLine{117           x(2)=p21}
\DoxyCodeLine{118           x(3)=p20}
\DoxyCodeLine{119           x(4)=m02}
\DoxyCodeLine{120           x(5)=m12}
\DoxyCodeLine{121           x(6)=m22}
\DoxyCodeLine{122           rank = rmax}
\DoxyCodeLine{123           switch = 0}
\DoxyCodeLine{124 }
\DoxyCodeLine{125           \textcolor{keywordflow}{if}(rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{126             \textcolor{keyword}{allocate}(fct(ncoefsg(rmax,3)+ncoefsg(rmax-\/1,3)+2*(rmax+2)))}
\DoxyCodeLine{127             \textcolor{keyword}{call }readcache(fct,ncoefsg(rmax,3)+ncoefsg(rmax-\/1,3)+2*(rmax+2),x,6,1,id,3,rank,nocalc,wrica)}
\DoxyCodeLine{128           \textcolor{keywordflow}{else} }
\DoxyCodeLine{129             \textcolor{keyword}{allocate}(fct(ncoefsg(rmax,3)+2*(rmax+2)))}
\DoxyCodeLine{130             \textcolor{keyword}{call }readcache(fct,ncoefsg(rmax,3)+2*(rmax+2),x,6,1,id,3,rank,nocalc,wrica)}
\DoxyCodeLine{131 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{132     }
\DoxyCodeLine{133           \textcolor{keywordflow}{if}(nocalc)\textcolor{keywordflow}{then}}
\DoxyCodeLine{134 }
\DoxyCodeLine{135             \textcolor{keywordflow}{if}(\textcolor{keyword}{present}(rbasic)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{136               rb =rbasic}
\DoxyCodeLine{137             \textcolor{keywordflow}{else}}
\DoxyCodeLine{138               rb = rmax}
\DoxyCodeLine{139 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{140             \textcolor{keywordflow}{if}(int(fct(1)).lt.rb) \textcolor{keywordflow}{then}}
\DoxyCodeLine{141 \textcolor{comment}{! if cached results are for smaller rbasic recalculate and write to cache }}
\DoxyCodeLine{142 \textcolor{comment}{! NOTE: coefficients shifted in cache by one slot}}
\DoxyCodeLine{143               wrica = .true.}
\DoxyCodeLine{144             \textcolor{keywordflow}{else}}
\DoxyCodeLine{145               cnt = 1}
\DoxyCodeLine{146               \textcolor{keywordflow}{do} r=0,rmax}
\DoxyCodeLine{147                 \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{148                   \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{149                     n2 = r-\/n0-\/n1}
\DoxyCodeLine{150  }
\DoxyCodeLine{151                     cnt = cnt+1}
\DoxyCodeLine{152                     c(n0,n1,n2) = fct(cnt)}
\DoxyCodeLine{153 }
\DoxyCodeLine{154 \textcolor{keywordflow}{                  end do}}
\DoxyCodeLine{155 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{156                 \textcolor{keywordflow}{do} n0=1,r}
\DoxyCodeLine{157                   \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{158                     n2 = r-\/n0-\/n1}
\DoxyCodeLine{159  }
\DoxyCodeLine{160                     cnt = cnt+1}
\DoxyCodeLine{161                     cuv(n0,n1,n2) = fct(cnt)}
\DoxyCodeLine{162 }
\DoxyCodeLine{163 \textcolor{keywordflow}{                  end do}}
\DoxyCodeLine{164 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{165                 cnt = cnt+1}
\DoxyCodeLine{166                 cerr1(r) = real(fct(cnt))}
\DoxyCodeLine{167                 cnt = cnt+1}
\DoxyCodeLine{168                 cerr2(r) = real(fct(cnt))}
\DoxyCodeLine{169 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{170 }
\DoxyCodeLine{171               \textcolor{keywordflow}{return}}
\DoxyCodeLine{172 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{173 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{174 }
\DoxyCodeLine{175           }
\DoxyCodeLine{176           \textcolor{keywordflow}{if}(rank.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{177 }
\DoxyCodeLine{178             \textcolor{keywordflow}{if}(\textcolor{keyword}{present}(rbasic)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{179               \textcolor{keyword}{call }calccred(c,cuv,p10,p21,p20,m02,m12,m22,rank,id,cerr1,cerr2,rbasic+rank-\/rmax,acc\_req\_cextra)}
\DoxyCodeLine{180             \textcolor{keywordflow}{else}}
\DoxyCodeLine{181               \textcolor{keyword}{call }calccred(c,cuv,p10,p21,p20,m02,m12,m22,rank,id,cerr1,cerr2)}
\DoxyCodeLine{182 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{183 }
\DoxyCodeLine{184             \textcolor{keywordflow}{if} (wrica) \textcolor{keywordflow}{then}}
\DoxyCodeLine{185               cnt = 1}
\DoxyCodeLine{186               \textcolor{keywordflow}{if}(\textcolor{keyword}{present}(rbasic)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{187                 fct(cnt) = rbasic}
\DoxyCodeLine{188               \textcolor{keywordflow}{else}}
\DoxyCodeLine{189                 fct(cnt) = rank}
\DoxyCodeLine{190 \textcolor{keywordflow}{              end if} }
\DoxyCodeLine{191               \textcolor{keywordflow}{do} r=0,rank}
\DoxyCodeLine{192                 \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{193                   \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{194                     n2 = r-\/n0-\/n1}
\DoxyCodeLine{195  }
\DoxyCodeLine{196                     cnt = cnt+1}
\DoxyCodeLine{197                     fct(cnt) = c(n0,n1,n2)}
\DoxyCodeLine{198 \textcolor{keywordflow}{                  end do}}
\DoxyCodeLine{199 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{200                 \textcolor{keywordflow}{do} n0=1,r}
\DoxyCodeLine{201                   \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{202                     n2 = r-\/n0-\/n1}
\DoxyCodeLine{203  }
\DoxyCodeLine{204                     cnt = cnt+1}
\DoxyCodeLine{205                     fct(cnt) = cuv(n0,n1,n2)}
\DoxyCodeLine{206 \textcolor{keywordflow}{                  end do}}
\DoxyCodeLine{207 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{208                 cnt = cnt+1}
\DoxyCodeLine{209                 fct(cnt) = cerr1(r)}
\DoxyCodeLine{210                 cnt = cnt+1}
\DoxyCodeLine{211                 fct(cnt) = cerr2(r)}
\DoxyCodeLine{212 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{213 }
\DoxyCodeLine{214               \textcolor{keywordflow}{if}(rank.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{215                 \textcolor{keyword}{call }writecache(fct,ncoefsg(rank,3)+ncoefsg(rank-\/1,3)+2*(rank+2),id,3,rank)}
\DoxyCodeLine{216               \textcolor{keywordflow}{else} }
\DoxyCodeLine{217                 \textcolor{keyword}{call }writecache(fct,ncoefsg(rank,3)+2*(rank+2),id,3,rank)}
\DoxyCodeLine{218 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{219 }
\DoxyCodeLine{220 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{221 }
\DoxyCodeLine{222             \textcolor{keywordflow}{return}}
\DoxyCodeLine{223           }
\DoxyCodeLine{224           }
\DoxyCodeLine{225           \textcolor{keywordflow}{else}}
\DoxyCodeLine{226             \textcolor{keyword}{allocate}(caux(0:rank,0:rank,0:rank))}
\DoxyCodeLine{227             \textcolor{keyword}{allocate}(cuvaux(0:rank,0:rank,0:rank))}
\DoxyCodeLine{228             \textcolor{keyword}{allocate}(cerr1aux(0:rank))}
\DoxyCodeLine{229             \textcolor{keyword}{allocate}(cerr2aux(0:rank))}
\DoxyCodeLine{230 }
\DoxyCodeLine{231             \textcolor{keywordflow}{if}(\textcolor{keyword}{present}(rbasic)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{232               \textcolor{keyword}{call }calccred(caux,cuvaux,p10,p21,p20,m02,m12,m22,rank,id,cerr1aux,cerr2aux,rbasic+rank-\/rmax,acc\_req\_cextra)}
\DoxyCodeLine{233             \textcolor{keywordflow}{else}}
\DoxyCodeLine{234               \textcolor{keyword}{call }calccred(caux,cuvaux,p10,p21,p20,m02,m12,m22,rank,id,cerr1aux,cerr2aux)}
\DoxyCodeLine{235 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{236 }
\DoxyCodeLine{237             \textcolor{keywordflow}{if} (wrica) \textcolor{keywordflow}{then}}
\DoxyCodeLine{238               cnt = 1}
\DoxyCodeLine{239               \textcolor{keyword}{deallocate}(fct)}
\DoxyCodeLine{240               \textcolor{keywordflow}{if}(rank.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{241                 \textcolor{keyword}{allocate}(fct(ncoefsg(rank,3)+ncoefsg(rank-\/1,3)+2*(rank+2)))}
\DoxyCodeLine{242               \textcolor{keywordflow}{else} }
\DoxyCodeLine{243                 \textcolor{keyword}{allocate}(fct(ncoefsg(rank,3)+2*(rank+2)))}
\DoxyCodeLine{244 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{245               \textcolor{keywordflow}{if}(\textcolor{keyword}{present}(rbasic)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{246                 fct(cnt) = rbasic+rank-\/rmax}
\DoxyCodeLine{247               \textcolor{keywordflow}{else}}
\DoxyCodeLine{248                 fct(cnt) = rank}
\DoxyCodeLine{249 \textcolor{keywordflow}{              end if} }
\DoxyCodeLine{250               \textcolor{keywordflow}{do} r=0,rank}
\DoxyCodeLine{251                 \textcolor{keywordflow}{do} n0=0,r}
\DoxyCodeLine{252                   \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{253                     n2 = r-\/n0-\/n1}
\DoxyCodeLine{254  }
\DoxyCodeLine{255                     cnt = cnt+1}
\DoxyCodeLine{256                     fct(cnt) = caux(n0,n1,n2)}
\DoxyCodeLine{257 \textcolor{keywordflow}{                  end do}}
\DoxyCodeLine{258 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{259                 \textcolor{keywordflow}{do} n0=1,r}
\DoxyCodeLine{260                   \textcolor{keywordflow}{do} n1=0,r-\/n0}
\DoxyCodeLine{261                     n2 = r-\/n0-\/n1}
\DoxyCodeLine{262  }
\DoxyCodeLine{263                     cnt = cnt+1}
\DoxyCodeLine{264                     fct(cnt) = cuvaux(n0,n1,n2)}
\DoxyCodeLine{265 \textcolor{keywordflow}{                  end do}}
\DoxyCodeLine{266 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{267                 cnt = cnt+1}
\DoxyCodeLine{268                 fct(cnt) = cerr1aux(r)}
\DoxyCodeLine{269                 cnt = cnt+1}
\DoxyCodeLine{270                 fct(cnt) = cerr2aux(r)}
\DoxyCodeLine{271 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{272 }
\DoxyCodeLine{273               \textcolor{keywordflow}{if}(rank.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{274                 \textcolor{keyword}{call }writecache(fct,ncoefsg(rank,3)+ncoefsg(rank-\/1,3)+2*(rank+2),id,3,rank)}
\DoxyCodeLine{275               \textcolor{keywordflow}{else} }
\DoxyCodeLine{276                 \textcolor{keyword}{call }writecache(fct,ncoefsg(rank,3)+2*(rank+2),id,3,rank)}
\DoxyCodeLine{277 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{278 }
\DoxyCodeLine{279 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{280 }
\DoxyCodeLine{281             c = caux(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{282             cuv = cuvaux(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{283             cerr1 = cerr1aux(0:rmax)}
\DoxyCodeLine{284             cerr2 = cerr2aux(0:rmax)}
\DoxyCodeLine{285 }
\DoxyCodeLine{286             \textcolor{keyword}{deallocate}(caux)}
\DoxyCodeLine{287             \textcolor{keyword}{deallocate}(cuvaux)}
\DoxyCodeLine{288             \textcolor{keyword}{deallocate}(cerr1aux)}
\DoxyCodeLine{289             \textcolor{keyword}{deallocate}(cerr2aux)}
\DoxyCodeLine{290 }
\DoxyCodeLine{291 \textcolor{comment}{!           write(*,*) 'Cred Cerr1',Cerr1}}
\DoxyCodeLine{292 \textcolor{comment}{!           write(*,*) 'Cred Cerr2',Cerr2}}
\DoxyCodeLine{293 }
\DoxyCodeLine{294             \textcolor{keywordflow}{return}}
\DoxyCodeLine{295 }
\DoxyCodeLine{296 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{297 \textcolor{comment}{!        end if}}
\DoxyCodeLine{298 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{299 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{300 }
\DoxyCodeLine{301     \textcolor{keywordflow}{if}(\textcolor{keyword}{present}(rbasic))\textcolor{keywordflow}{then}}
\DoxyCodeLine{302       \textcolor{keyword}{call }calccred(c,cuv,p10,p21,p20,m02,m12,m22,rmax,id,cerr1,cerr2,rbasic,acc\_req\_cextra)}
\DoxyCodeLine{303     \textcolor{keywordflow}{else}}
\DoxyCodeLine{304       \textcolor{keyword}{call }calccred(c,cuv,p10,p21,p20,m02,m12,m22,rmax,id,cerr1,cerr2)}
\DoxyCodeLine{305 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{306 }
\DoxyCodeLine{307 \textcolor{comment}{!         write(*,*) 'Cred nc Cerr1',Cerr1}}
\DoxyCodeLine{308 \textcolor{comment}{!         write(*,*) 'Cred nc Cerr2',Cerr2}}
\DoxyCodeLine{309 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductionc_a7f71e9787e92395ba2325d71562acda4}\label{namespacereductionc_a7f71e9787e92395ba2325d71562acda4}} 
\index{reductionc@{reductionc}!calccg@{calccg}}
\index{calccg@{calccg}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{calccg()}{calccg()}}
{\footnotesize\ttfamily subroutine reductionc\+::calccg (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{C,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Cuv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{ordg\+\_\+min,  }\item[{integer, intent(in)}]{ordg\+\_\+max,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr,  }\item[{double precision, dimension(0\+:rmax), intent(in)}]{acc\+\_\+req\+\_\+\+Cr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr2 }\end{DoxyParamCaption})}



Definition at line 4717 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{4717   }
\DoxyCodeLine{4718     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobalc}{globalc}}}
\DoxyCodeLine{4719   }
\DoxyCodeLine{4720     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,ordg\_min,ordg\_max,id}
\DoxyCodeLine{4721     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{4722     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: C(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4723     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Cuv(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4724     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Cerr(0:rmax),Cerr2(0:rmax)}
\DoxyCodeLine{4725     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(in)} :: acc\_req\_Cr(0:rmax)}
\DoxyCodeLine{4726     \textcolor{keywordtype}{double complex} :: Xtilde,Zkl,Zadjfj}
\DoxyCodeLine{4727     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Cexpg(:,:,:,:), CuvExpg(:,:,:)}
\DoxyCodeLine{4728     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: B\_0(:,:,:), B\_i(:,:,:), Shat(:,:,:,:)}
\DoxyCodeLine{4729     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Buv\_0(:,:,:), Buv\_i(:,:,:)}
\DoxyCodeLine{4730     \textcolor{keywordtype}{double complex} :: Smod(2), Skl}
\DoxyCodeLine{4731     \textcolor{keywordtype}{double complex} :: C0\_coli, elimminf2\_coli}
\DoxyCodeLine{4732     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err(:),Cij\_err(:)}
\DoxyCodeLine{4733     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{4734     \textcolor{keywordtype}{double precision} :: B\_err,B\_max}
\DoxyCodeLine{4735     \textcolor{keywordtype}{double precision} :: maxCexpg(0:1,0:rmax+ordg\_min+1,0:ordg\_max),truncfacexp}
\DoxyCodeLine{4736     \textcolor{keywordtype}{integer} :: rmaxB,rmaxExp,gtrunc,r,n0,n1,n2,k,l,j,sgn,g,rg,mr}
\DoxyCodeLine{4737     \textcolor{keywordtype}{integer} :: inds0(2), inds(2), ktlt(2)}
\DoxyCodeLine{4738     \textcolor{keywordtype}{integer} :: bin,nid(0:2)}
\DoxyCodeLine{4739 }
\DoxyCodeLine{4740 \textcolor{preprocessor}{\#ifdef Cgtest}}
\DoxyCodeLine{4741 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg in '},rmax,ordg\_min,ordg\_max,id}
\DoxyCodeLine{4742 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4743 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifdef TRACECin}}
\DoxyCodeLine{4744 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg in '},rmax,ordg\_min,ordg\_max,id}
\DoxyCodeLine{4745 \textcolor{comment}{!   write(*,*) 'CalcCg in acc',acc\_req\_Cr}}
\DoxyCodeLine{4746 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4747 \textcolor{preprocessor}{}}
\DoxyCodeLine{4748     \textcolor{comment}{! write(*,*) 'LH: CalcCg, ord', ordg\_min }}
\DoxyCodeLine{4749     \textcolor{comment}{! calculation B-\/coefficients}}
\DoxyCodeLine{4750     rmaxb = rmax + ordg\_min}
\DoxyCodeLine{4751     \textcolor{keyword}{allocate}(b\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{4752     \textcolor{keyword}{allocate}(buv\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{4753     \textcolor{keyword}{allocate}(b\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{4754     \textcolor{keyword}{allocate}(buv\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{4755 }
\DoxyCodeLine{4756     \textcolor{comment}{! determine binaries for B-\/coefficients}}
\DoxyCodeLine{4757     k=0}
\DoxyCodeLine{4758     bin = 1}
\DoxyCodeLine{4759     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.2)}
\DoxyCodeLine{4760       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4761         nid(k) = id+bin}
\DoxyCodeLine{4762         k = k+1}
\DoxyCodeLine{4763 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{4764       bin = 2*bin}
\DoxyCodeLine{4765 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{4766 }
\DoxyCodeLine{4767     \textcolor{keyword}{call }calcb(b\_0(:,0,:),buv\_0(:,0,:),p21,m12,m22,rmaxb,nid(0))}
\DoxyCodeLine{4768     \textcolor{keyword}{call }calcb(b\_i(:,:,1),buv\_i(:,:,1),p20,m02,m22,rmaxb,nid(1))}
\DoxyCodeLine{4769     \textcolor{keyword}{call }calcb(b\_i(:,:,2),buv\_i(:,:,2),p10,m02,m12,rmaxb,nid(2))}
\DoxyCodeLine{4770 }
\DoxyCodeLine{4771     \textcolor{comment}{! shift of integration momentum in B\_0}}
\DoxyCodeLine{4772     b\_max=0d0}
\DoxyCodeLine{4773     \textcolor{keywordflow}{do} n1=1,rmaxb}
\DoxyCodeLine{4774       \textcolor{keywordflow}{do} n2=0,rmaxb-\/n1}
\DoxyCodeLine{4775         n0 = (rmaxb-\/n1-\/n2)}
\DoxyCodeLine{4776         b\_0(0:n0,n1,n2) = -\/b\_0(0:n0,n1-\/1,n2)-\/b\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{4777         buv\_0(0:n0,n1,n2) = -\/buv\_0(0:n0,n1-\/1,n2)-\/buv\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{4778         b\_max = max(b\_max,abs(b\_0(0,n1,n2)))}
\DoxyCodeLine{4779 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4780 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{4781     \textcolor{comment}{! error estimate for B's}}
\DoxyCodeLine{4782     b\_max = max(b\_max,maxval(abs(b\_i(0,0:rmaxb,1:2))))}
\DoxyCodeLine{4783     b\_err = acc\_def\_b*b\_max}
\DoxyCodeLine{4784     }
\DoxyCodeLine{4785     \textcolor{comment}{! determine (adjugated) Gram matrix}}
\DoxyCodeLine{4786 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{4787 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{4788 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{4789 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{4790 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{4791 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{4792 \textcolor{comment}{!}}
\DoxyCodeLine{4793 \textcolor{comment}{!    q1q2 = (q10+q20-\/q21)}}
\DoxyCodeLine{4794 \textcolor{comment}{!    detZ = 4d0*q10*q20-\/q1q2*q1q2}}
\DoxyCodeLine{4795 }
\DoxyCodeLine{4796 \textcolor{comment}{!    if (abs(detZ/( 4d0*q10*q20 + q1q2*q1q2)).lt.1d-\/4) then}}
\DoxyCodeLine{4797 \textcolor{comment}{!      if (abs(q10-\/q20).lt.abs(q10-\/q21).and.  \&}}
\DoxyCodeLine{4798 \textcolor{comment}{!          abs(q10-\/q20).lt.abs(q20-\/q21)) then}}
\DoxyCodeLine{4799 \textcolor{comment}{!        detZ  =  4d0*q10*q21 -\/ (q10-\/q20+q21)*(q10-\/q20+q21)}}
\DoxyCodeLine{4800 \textcolor{comment}{!      end if}}
\DoxyCodeLine{4801 \textcolor{comment}{!    end if}}
\DoxyCodeLine{4802 }
\DoxyCodeLine{4803 \textcolor{comment}{!   write(*,*) 'Z = ',Z}}
\DoxyCodeLine{4804 }
\DoxyCodeLine{4805 \textcolor{comment}{!    Zadj(1,1) = 2d0*q20}}
\DoxyCodeLine{4806 \textcolor{comment}{!    Zadj(2,1) = -\/q1q2}}
\DoxyCodeLine{4807 \textcolor{comment}{!    Zadj(1,2) = -\/q1q2}}
\DoxyCodeLine{4808 \textcolor{comment}{!    Zadj(2,2) = 2d0*q10}}
\DoxyCodeLine{4809 \textcolor{comment}{!    f(1) = q10+mm02-\/mm12}}
\DoxyCodeLine{4810 \textcolor{comment}{!    f(2) = q20+mm02-\/mm22}}
\DoxyCodeLine{4811 }
\DoxyCodeLine{4812 \textcolor{comment}{!    Zadjf(1) = Zadj(1,1)*f(1)+Zadj(2,1)*f(2)}}
\DoxyCodeLine{4813 \textcolor{comment}{!    Zadjf(2) = Zadj(1,2)*f(1)+Zadj(2,2)*f(2)}}
\DoxyCodeLine{4814 }
\DoxyCodeLine{4815 \textcolor{comment}{!    commented out 2.9.2017}}
\DoxyCodeLine{4816 \textcolor{comment}{!    maxZadj=maxval(abs(Zadj))}}
\DoxyCodeLine{4817 \textcolor{comment}{!    fmax   =maxval(abs(f))}}
\DoxyCodeLine{4818 }
\DoxyCodeLine{4819     \textcolor{comment}{! coefficients Shat defined in (5.13)}}
\DoxyCodeLine{4820     \textcolor{keyword}{allocate}(shat(0:rmaxb,0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{4821 }
\DoxyCodeLine{4822     \textcolor{keywordflow}{do} r=0,rmaxb}
\DoxyCodeLine{4823       \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{4824 }
\DoxyCodeLine{4825         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{4826           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{4827           shat(n0,n1,n2,:) = -\/b\_0(n0,n1,n2)}
\DoxyCodeLine{4828 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4829 }
\DoxyCodeLine{4830         k = r-\/2*n0}
\DoxyCodeLine{4831         shat(n0,0,k,1) = shat(n0,0,k,1) + b\_i(n0,k,1)}
\DoxyCodeLine{4832         shat(n0,k,0,2) = shat(n0,k,0,2) + b\_i(n0,k,2)}
\DoxyCodeLine{4833 }
\DoxyCodeLine{4834 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4835 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{4836 }
\DoxyCodeLine{4837 }
\DoxyCodeLine{4838     \textcolor{comment}{! choose reduction formulas with biggest denominators}}
\DoxyCodeLine{4839     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)).ge.abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4840       j = 1}
\DoxyCodeLine{4841     \textcolor{keywordflow}{else} }
\DoxyCodeLine{4842       j = 2}
\DoxyCodeLine{4843 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4844 }
\DoxyCodeLine{4845     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)).ge.abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4846       \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)).ge.abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4847         k = 1}
\DoxyCodeLine{4848         l = 1}
\DoxyCodeLine{4849         sgn = 1}
\DoxyCodeLine{4850         ktlt = (/ 0,2 /)}
\DoxyCodeLine{4851       \textcolor{keywordflow}{else}}
\DoxyCodeLine{4852         k = 1}
\DoxyCodeLine{4853         l = 2}
\DoxyCodeLine{4854         sgn = -\/1}
\DoxyCodeLine{4855         ktlt = (/ 1,1 /)}
\DoxyCodeLine{4856 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{4857     \textcolor{keywordflow}{else}        }
\DoxyCodeLine{4858       \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)).ge.abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4859         k = 2}
\DoxyCodeLine{4860         l = 2}
\DoxyCodeLine{4861         sgn = 1}
\DoxyCodeLine{4862         ktlt = (/ 2,0 /)}
\DoxyCodeLine{4863       \textcolor{keywordflow}{else} }
\DoxyCodeLine{4864         k = 1}
\DoxyCodeLine{4865         l = 2}
\DoxyCodeLine{4866         sgn = -\/1}
\DoxyCodeLine{4867         ktlt = (/ 1,1 /)}
\DoxyCodeLine{4868 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{4869 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4870 }
\DoxyCodeLine{4871     zadjfj = \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j)}
\DoxyCodeLine{4872     zkl = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(k,l)}
\DoxyCodeLine{4873     \textcolor{keywordflow}{if}(k.eq.l) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4874       xtilde = \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(3-\/k,3-\/l)      \textcolor{comment}{! subroutine uses Z instead of Zadj}}
\DoxyCodeLine{4875     \textcolor{keywordflow}{else}                          \textcolor{comment}{! -\/> exchange indices 1 and 2}}
\DoxyCodeLine{4876       xtilde = -\/\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(3-\/k,3-\/l)     \textcolor{comment}{! -\/> minus sign for k \(\backslash\)ne l}}
\DoxyCodeLine{4877 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4878 }
\DoxyCodeLine{4879 \textcolor{comment}{!   write(*,*) 'CalcCg Xtilde n',Xtilde,Xadj(1,1),Xadj(1,2),Xadj(2,2)}}
\DoxyCodeLine{4880 }
\DoxyCodeLine{4881 \textcolor{comment}{!   write(*,*) 'Xtilde =',Xtilde,k,l}}
\DoxyCodeLine{4882 }
\DoxyCodeLine{4883     \textcolor{comment}{! allocation of array for det(Z)-\/expanded C-\/coefficients}}
\DoxyCodeLine{4884     rmaxexp = rmaxb+1}
\DoxyCodeLine{4885     \textcolor{keyword}{allocate}(cexpg(0:rmaxexp/2,0:rmaxexp-\/1,0:rmaxexp-\/1,0:ordg\_max))}
\DoxyCodeLine{4886    }
\DoxyCodeLine{4887 }
\DoxyCodeLine{4888     \textcolor{comment}{! calculate Cuv}}
\DoxyCodeLine{4889     \textcolor{keyword}{allocate}(cuvexpg(0:rmaxexp,0:rmaxexp,0:rmaxexp))}
\DoxyCodeLine{4890     \textcolor{keyword}{call }calccuv(cuvexpg,buv\_0,mm02,\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}},rmaxexp,id)}
\DoxyCodeLine{4891     cuv(0:rmax,0:rmax,0:rmax) = cuvexpg(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4892 }
\DoxyCodeLine{4893     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{4894     \textcolor{keyword}{allocate}(c00\_err(0:rmaxexp))}
\DoxyCodeLine{4895     \textcolor{keyword}{allocate}(cij\_err(0:rmaxexp))}
\DoxyCodeLine{4896     \textcolor{keyword}{allocate}(c00\_err2(0:rmaxexp))}
\DoxyCodeLine{4897     \textcolor{keyword}{allocate}(cij\_err2(0:rmaxexp))}
\DoxyCodeLine{4898     }
\DoxyCodeLine{4899     \textcolor{comment}{! initialize accuracy estimates}}
\DoxyCodeLine{4900     cerr = acc\_inf}
\DoxyCodeLine{4901     cij\_err = 0d0}
\DoxyCodeLine{4902     c00\_err = 0d0}
\DoxyCodeLine{4903 }
\DoxyCodeLine{4904     cerr2 = acc\_inf}
\DoxyCodeLine{4905     cij\_err2 = 0d0}
\DoxyCodeLine{4906     c00\_err2 = 0d0}
\DoxyCodeLine{4907 }
\DoxyCodeLine{4908     \textcolor{comment}{! truncation of expansion if calculated term larger than truncfacexp * previous term}}
\DoxyCodeLine{4909     \textcolor{comment}{! crucial for expansion parameters between 0.1 and 1 !!!}}
\DoxyCodeLine{4910 \textcolor{comment}{!    truncfacexp = sqrt(abs(detZ/Zadjfj)) * truncfacC}}
\DoxyCodeLine{4911     truncfacexp = sqrt(\mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}}) * truncfacc}
\DoxyCodeLine{4912     gtrunc = ordg\_max }
\DoxyCodeLine{4913 }
\DoxyCodeLine{4914 \textcolor{comment}{! calculate C(n0,n1,n2) up to rank r for n0>0 and up to rank r-\/1 for n0=0}}
\DoxyCodeLine{4915     rloop: \textcolor{keywordflow}{do} r=1,rmaxexp}
\DoxyCodeLine{4916 }
\DoxyCodeLine{4917       \textcolor{keywordflow}{if} (r.gt.rmax+gtrunc+1) \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{4918 }
\DoxyCodeLine{4919 \textcolor{comment}{!     write(*,*) 'CalcCg rloop',r,rmaxExp,gtrunc}}
\DoxyCodeLine{4920 }
\DoxyCodeLine{4921       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{4922       \textcolor{comment}{! 0th-\/order coefficients}}
\DoxyCodeLine{4923       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{4924 }
\DoxyCodeLine{4925       \textcolor{comment}{! calculating}}
\DoxyCodeLine{4926       \textcolor{comment}{! C\_00(a)0000..00 -\/-\/> C\_00(a)ij00..00 -\/-\/> C\_00(a)ijkl00..00 -\/-\/> ... -\/-\/> C\_00(a)ijklmn..}}
\DoxyCodeLine{4927       \textcolor{comment}{! exploiting eq. (5.40)}}
\DoxyCodeLine{4928       maxcexpg(1,r,0)=0d0}
\DoxyCodeLine{4929       \textcolor{keywordflow}{do} n0=r/2,1,-\/1}
\DoxyCodeLine{4930         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{4931           n2=r-\/2*n0-\/n1}
\DoxyCodeLine{4932 }
\DoxyCodeLine{4933           inds0(1) = n1}
\DoxyCodeLine{4934           inds0(2) = n2}
\DoxyCodeLine{4935           skl = 0d0}
\DoxyCodeLine{4936           inds = inds0}
\DoxyCodeLine{4937           \textcolor{keywordflow}{if} (inds(k).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4938             inds(k) = inds(k)-\/1}
\DoxyCodeLine{4939             skl = skl -\/ 2d0*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(l)*inds0(k)*cexpg(n0,inds(1),inds(2),0)}
\DoxyCodeLine{4940             \textcolor{keywordflow}{if} (inds(l).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4941               inds(l) = inds(l)-\/1}
\DoxyCodeLine{4942               skl = skl -\/ 4d0*inds0(k)*(inds(l)+1)*cexpg(n0+1,inds(1),inds(2),0)}
\DoxyCodeLine{4943 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4944 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4945           inds = inds0}
\DoxyCodeLine{4946           \textcolor{keywordflow}{if} (inds(l).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4947             inds(l) = inds(l)-\/1}
\DoxyCodeLine{4948             skl = skl + 2d0*inds0(l)*shat(n0,inds(1),inds(2),k)  \&}
\DoxyCodeLine{4949                       -\/ 2d0*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(k)*inds0(l)*cexpg(n0,inds(1),inds(2),0)}
\DoxyCodeLine{4950 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4951 }
\DoxyCodeLine{4952           cexpg(n0,n1,n2,0) = (2d0*zkl*b\_0(n0-\/1,n1,n2) + xtilde*cexpg(n0-\/1,n1,n2,0)  \&}
\DoxyCodeLine{4953                                  -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,k)*shat(n0-\/1,n1+1,n2,l) -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,k)*shat(n0-\/1,n1,n2+1,l)  \&}
\DoxyCodeLine{4954                                  + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(l)*shat(n0-\/1,n1,n2,k) + 4d0*zkl*cuvexpg(n0,n1,n2) + skl)  \&}
\DoxyCodeLine{4955                                  /(2d0*zkl)/(2d0*(r-\/n0)+1d0)}
\DoxyCodeLine{4956 }
\DoxyCodeLine{4957           \textcolor{keywordflow}{if} (n0.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4958             maxcexpg(1,r,0) =  maxcexpg(1,r,0) + abs(cexpg(n0,n1,n2,0))}
\DoxyCodeLine{4959 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4960 }
\DoxyCodeLine{4961           \textcolor{keywordflow}{if} (r-\/n0.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4962             c(n0,n1,n2) = cexpg(n0,n1,n2,0)}
\DoxyCodeLine{4963 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4964 }
\DoxyCodeLine{4965 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4966 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4967 }
\DoxyCodeLine{4968       \textcolor{comment}{! calculate}}
\DoxyCodeLine{4969       \textcolor{comment}{! C\_00ijkl.. -\/-\/> C\_aijkl..}}
\DoxyCodeLine{4970       \textcolor{comment}{! exploiting eq. (5.38)}}
\DoxyCodeLine{4971       maxcexpg(0,r-\/1,0)=0d0}
\DoxyCodeLine{4972       \textcolor{keywordflow}{do} n1=0,r-\/1}
\DoxyCodeLine{4973         n2 = r-\/1-\/n1}
\DoxyCodeLine{4974 }
\DoxyCodeLine{4975         smod = shat(0,n1,n2,:)}
\DoxyCodeLine{4976         \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4977           smod(1) = smod(1) -\/ 2d0*n1*cexpg(1,n1-\/1,n2,0)}
\DoxyCodeLine{4978 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{4979         \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4980           smod(2) = smod(2) -\/ 2d0*n2*cexpg(1,n1,n2-\/1,0)}
\DoxyCodeLine{4981 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{4982 }
\DoxyCodeLine{4983         cexpg(0,n1,n2,0) = (\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1) +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2))/zadjfj}
\DoxyCodeLine{4984         }
\DoxyCodeLine{4985         maxcexpg(0,r-\/1,0) =  maxcexpg(0,r-\/1,0) + abs(cexpg(0,n1,n2,0))}
\DoxyCodeLine{4986         \textcolor{keywordflow}{if} (r-\/n0.le.rmax+1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4987           c(0,n1,n2) = cexpg(0,n1,n2,0)}
\DoxyCodeLine{4988 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{4989 }
\DoxyCodeLine{4990 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4991 }
\DoxyCodeLine{4992       \textcolor{keywordflow}{if}(r.le.rmax+1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4993 \textcolor{comment}{!       Cerr(r-\/1) =  abs(detZ/Zadjfj)*maxCexpg(0,r-\/1,0)}}
\DoxyCodeLine{4994         cerr(r-\/1) =  \mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}}*maxcexpg(0,r-\/1,0)}
\DoxyCodeLine{4995 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{4996 }
\DoxyCodeLine{4997       \textcolor{comment}{! error propagation from B's}}
\DoxyCodeLine{4998       c00\_err(r) = max(max(\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*b\_err,\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}*b\_err)/abs(zkl),b\_err)  \&}
\DoxyCodeLine{4999                    /(2*(2*r-\/1))        }
\DoxyCodeLine{5000       cij\_err(r-\/1)=\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(b\_err,2*c00\_err(r))/abs(zadjfj)}
\DoxyCodeLine{5001 }
\DoxyCodeLine{5002       c00\_err2(r) = max(max(\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*b\_err,\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}*b\_err)/abs(zkl),b\_err)  \&}
\DoxyCodeLine{5003                    /(2*(2*r-\/1))        }
\DoxyCodeLine{5004       cij\_err2(r-\/1)=\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(b\_err,2*c00\_err2(r))/abs(zadjfj)}
\DoxyCodeLine{5005 }
\DoxyCodeLine{5006 \textcolor{comment}{!      write(*,*) 'CalcCg after 0: ',maxZadj/abs(Zadjfj),C00\_err(r),B\_err}}
\DoxyCodeLine{5007 \textcolor{comment}{!      write(*,*) 'CalcCg after 0: Cij\_err=',r-\/1,Cij\_err(r-\/1)}}
\DoxyCodeLine{5008 }
\DoxyCodeLine{5009 }
\DoxyCodeLine{5010       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{5011       \textcolor{comment}{! higher order coefficients}}
\DoxyCodeLine{5012       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{5013 }
\DoxyCodeLine{5014       rg = r}
\DoxyCodeLine{5015       gloop: \textcolor{keywordflow}{do} g=1,min(gtrunc,r-\/1)}
\DoxyCodeLine{5016         rg = rg-\/1}
\DoxyCodeLine{5017 \textcolor{comment}{!       write(*,*) 'CalcCg gloop',g,rg}}
\DoxyCodeLine{5018 }
\DoxyCodeLine{5019         \textcolor{comment}{! calculating for rank=rmaxB+1}}
\DoxyCodeLine{5020         \textcolor{comment}{! C\_00(a)0000..00 -\/-\/> C\_00(a)ij00..00 -\/-\/> C\_00(a)ijkl00..00 -\/-\/> ... -\/-\/> C\_00(a)ijklmn..}}
\DoxyCodeLine{5021         \textcolor{comment}{! exploiting eq. (5.40)}}
\DoxyCodeLine{5022         maxcexpg(1,rg,g) = 0d0}
\DoxyCodeLine{5023         \textcolor{keywordflow}{do} n0=rg/2,1,-\/1}
\DoxyCodeLine{5024           \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{5025             n2=rg-\/2*n0-\/n1}
\DoxyCodeLine{5026 }
\DoxyCodeLine{5027             inds0(1) = n1}
\DoxyCodeLine{5028             inds0(2) = n2}
\DoxyCodeLine{5029             skl = 0d0}
\DoxyCodeLine{5030             inds = inds0}
\DoxyCodeLine{5031             \textcolor{keywordflow}{if} (inds(k).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5032               inds(k) = inds(k)-\/1}
\DoxyCodeLine{5033               skl = skl -\/ 2d0*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(l)*inds0(k)*cexpg(n0,inds(1),inds(2),g)}
\DoxyCodeLine{5034               \textcolor{keywordflow}{if} (inds(l).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5035                 inds(l) = inds(l)-\/1}
\DoxyCodeLine{5036                 skl = skl -\/ 4d0*inds0(k)*(inds(l)+1)*cexpg(n0+1,inds(1),inds(2),g)}
\DoxyCodeLine{5037 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{5038               inds = inds0}
\DoxyCodeLine{5039 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{5040             \textcolor{keywordflow}{if} (inds(l).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5041               inds(l) = inds(l)-\/1}
\DoxyCodeLine{5042               skl = skl -\/ 2d0*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(k)*inds0(l)*cexpg(n0,inds(1),inds(2),g)}
\DoxyCodeLine{5043 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{5044          }
\DoxyCodeLine{5045             inds = inds0 + ktlt}
\DoxyCodeLine{5046             cexpg(n0,n1,n2,g) = (xtilde*cexpg(n0-\/1,n1,n2,g) + skl  \&}
\DoxyCodeLine{5047                                    -\/ \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*sgn*cexpg(n0-\/1,inds(1),inds(2),g-\/1))  \&}
\DoxyCodeLine{5048                                      /(2d0*zkl)/(2d0*(rg-\/n0)+1d0)           }
\DoxyCodeLine{5049             \textcolor{keywordflow}{if}(n0.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5050               maxcexpg(1,rg,g) =  maxcexpg(1,rg,g) + abs(cexpg(n0,n1,n2,g))}
\DoxyCodeLine{5051               }
\DoxyCodeLine{5052               \textcolor{keywordflow}{if} (g.eq.1.and.abs(cexpg(n0,n1,n2,g)).gt.        \&}
\DoxyCodeLine{5053                   truncfacexp*max(1d0,maxcexpg(1,rg,g-\/1)).or.  \&}
\DoxyCodeLine{5054                   g.ge.2.and.abs(cexpg(n0,n1,n2,g)).gt.        \&  }
\DoxyCodeLine{5055                   truncfacexp*maxcexpg(1,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5056 }
\DoxyCodeLine{5057 \textcolor{preprocessor}{\#ifdef Cgtest}}
\DoxyCodeLine{5058 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg exit gloop'},n0,n1,n2,g,abs(cexpg(n0,n1,n2,g)),maxcexpg(1,rg,g-\/1)}
\DoxyCodeLine{5059 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5060 \textcolor{preprocessor}{}\textcolor{comment}{!               write(*,*) 'CalcCg exit gloop',n0,n1,n2,g,abs(Cexpg(n0,n1,n2,g)),maxCexpg(1,rg,g-\/1)}}
\DoxyCodeLine{5061 }
\DoxyCodeLine{5062                 gtrunc = g-\/1}
\DoxyCodeLine{5063                 \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{5064 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{5065 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{5066 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{5067 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{5068 }
\DoxyCodeLine{5069 \textcolor{comment}{!        write(*,*) 'Calcg: rg,g,acc',rg,g,acc}}
\DoxyCodeLine{5070 }
\DoxyCodeLine{5071 \textcolor{preprocessor}{\#ifndef PPEXP00}}
\DoxyCodeLine{5072 \textcolor{preprocessor}{}        \textcolor{keywordflow}{do} n0=rg/2,1,-\/1}
\DoxyCodeLine{5073           \textcolor{keywordflow}{if} (rg-\/n0.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5074             \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{5075               n2=rg-\/2*n0-\/n1}
\DoxyCodeLine{5076               c(n0,n1,n2) = c(n0,n1,n2) + cexpg(n0,n1,n2,g)}
\DoxyCodeLine{5077 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{5078 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{5079 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{5080 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5081 \textcolor{preprocessor}{}}
\DoxyCodeLine{5082         \textcolor{comment}{! calculate}}
\DoxyCodeLine{5083         \textcolor{comment}{! C\_000000..00 -\/-\/> C\_i0000..00 -\/-\/> C\_ij00..00 -\/-\/> ... -\/-\/> C\_ijk..}}
\DoxyCodeLine{5084         \textcolor{comment}{! exploiting eq. (5.38)}}
\DoxyCodeLine{5085         maxcexpg(0,rg-\/1,g) = 0d0}
\DoxyCodeLine{5086         \textcolor{keywordflow}{do} n1=0,rg-\/1}
\DoxyCodeLine{5087           n2 = rg-\/1-\/n1}
\DoxyCodeLine{5088           }
\DoxyCodeLine{5089           smod = 0d0}
\DoxyCodeLine{5090           \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5091             smod(1) = smod(1) -\/ 2d0*n1*cexpg(1,n1-\/1,n2,g)}
\DoxyCodeLine{5092 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{5093           \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5094             smod(2) = smod(2) -\/ 2d0*n2*cexpg(1,n1,n2-\/1,g)}
\DoxyCodeLine{5095 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{5096           }
\DoxyCodeLine{5097           inds(1) = n1}
\DoxyCodeLine{5098           inds(2) = n2}
\DoxyCodeLine{5099           inds(j) = inds(j)+1}
\DoxyCodeLine{5100           }
\DoxyCodeLine{5101           cexpg(0,n1,n2,g) = (\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1) +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2)  \&}
\DoxyCodeLine{5102               -\/ \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*cexpg(0,inds(1),inds(2),g-\/1))/zadjfj}
\DoxyCodeLine{5103           }
\DoxyCodeLine{5104           maxcexpg(0,rg-\/1,g) =  maxcexpg(0,rg-\/1,g) + abs(cexpg(0,n1,n2,g))}
\DoxyCodeLine{5105 }
\DoxyCodeLine{5106           \textcolor{keywordflow}{if} (g.eq.1.and.abs(cexpg(0,n1,n2,g)).gt.                     \&}
\DoxyCodeLine{5107               truncfacexp*max(1/\mbox{\hyperlink{namespaceglobalc_a45c0f5c169a73fb12286352743b5a557}{m2max}},maxcexpg(0,rg-\/1,g-\/1))    .or.    \&}
\DoxyCodeLine{5108               g.ge.2.and.abs(cexpg(0,n1,n2,g)).gt.                     \&}
\DoxyCodeLine{5109               truncfacexp*maxcexpg(0,rg-\/1,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5110 }
\DoxyCodeLine{5111 \textcolor{preprocessor}{\#ifdef Cgtest}}
\DoxyCodeLine{5112 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg exit gloop'},0,n1,n2,g,abs(cexpg(0,n1,n2,g)),maxcexpg(0,rg-\/1,g-\/1)}
\DoxyCodeLine{5113             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg exit gloop'},abs(cexpg(0,n1,n2,g)).gt.truncfacexp*maxcexpg(0,rg-\/1,g-\/1),truncfacexp}
\DoxyCodeLine{5114             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg exit gloop'},\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1)/zadjfj ,  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2)/zadjfj,  \&}
\DoxyCodeLine{5115                 -\/ \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*cexpg(0,inds(1),inds(2),g-\/1)/zadjfj}
\DoxyCodeLine{5116 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5117 \textcolor{preprocessor}{}            }
\DoxyCodeLine{5118             gtrunc = g-\/1}
\DoxyCodeLine{5119 }
\DoxyCodeLine{5120 \textcolor{preprocessor}{\#ifdef Cgtest}}
\DoxyCodeLine{5121 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg exit gloop'},rmax,g,rmaxexp}
\DoxyCodeLine{5122 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5123 \textcolor{preprocessor}{}\textcolor{comment}{!           write(*,*) 'CalcCg exit gloop',rmax,g,rmaxExp}}
\DoxyCodeLine{5124 }
\DoxyCodeLine{5125             \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{5126 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{5127 }
\DoxyCodeLine{5128 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{5129 }
\DoxyCodeLine{5130         \textcolor{comment}{! error propagation from B's}}
\DoxyCodeLine{5131         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{5132 \textcolor{comment}{!          C00\_err(rg) = max(C00\_err(rg),                    \&}}
\DoxyCodeLine{5133 \textcolor{comment}{!              max( abs(m02)*Cij\_err(rg-\/2),             \&     }}
\DoxyCodeLine{5134 \textcolor{comment}{!              max(adetZ*Cij\_err(rg),fmax**2*Cij\_err(rg-\/2),fmax*C00\_err(rg-\/1))/abs(Zkl) ) \&}}
\DoxyCodeLine{5135 \textcolor{comment}{!                   /(2*(2*rg-\/1))     )   }}
\DoxyCodeLine{5136 \textcolor{comment}{!24.04.15 -\/>}}
\DoxyCodeLine{5137 \textcolor{comment}{!          C00\_err(rg) = max(C00\_err(rg),                    \&}}
\DoxyCodeLine{5138 \textcolor{comment}{!              max( abs(m02)*Cij\_err(rg-\/2),             \&     }}
\DoxyCodeLine{5139 \textcolor{comment}{!              max(adetZ*Cij\_err(rg),abs(Xtilde)*Cij\_err(rg-\/2),fmax*C00\_err(rg-\/1))/abs(Zkl) ) \&}}
\DoxyCodeLine{5140 \textcolor{comment}{!                   /(2*(2*rg-\/1))     )   }}
\DoxyCodeLine{5141 \textcolor{comment}{!06.05.15 -\/> }}
\DoxyCodeLine{5142           c00\_err(rg) = max(c00\_err(rg),                    \&}
\DoxyCodeLine{5143               max(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*cij\_err(rg),abs(xtilde)*cij\_err(rg-\/2),\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}*c00\_err(rg-\/1))/abs(zkl)  \&}
\DoxyCodeLine{5144                    /(2*(2*rg-\/1))     )   }
\DoxyCodeLine{5145 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{5146         cij\_err(rg-\/1) = max(cij\_err(rg-\/1),max(2*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*c00\_err(rg),\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*cij\_err(rg))/abs(zadjfj) ) }
\DoxyCodeLine{5147 }
\DoxyCodeLine{5148         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{5149           c00\_err2(rg) = max(c00\_err2(rg),                    \&}
\DoxyCodeLine{5150               max(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*cij\_err2(rg),abs(xtilde)*cij\_err2(rg-\/2),\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}*c00\_err2(rg-\/1))/abs(zkl)  \&}
\DoxyCodeLine{5151                    /(2*(2*rg-\/1))     )   }
\DoxyCodeLine{5152 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{5153         cij\_err2(rg-\/1) = max(cij\_err2(rg-\/1),max(2*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*c00\_err2(rg),\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*cij\_err2(rg))/abs(zadjfj) ) }
\DoxyCodeLine{5154 }
\DoxyCodeLine{5155 \textcolor{comment}{!      write(*,*) 'CalcCg g: ',r,adetZ/abs(Zadjfj),C00\_err(rg),B\_err}}
\DoxyCodeLine{5156 \textcolor{comment}{!      write(*,*) 'CalcCg g: Cij\_err=',rg-\/1,Cij\_err(rg-\/1)}}
\DoxyCodeLine{5157 }
\DoxyCodeLine{5158 }
\DoxyCodeLine{5159 \textcolor{preprocessor}{\#ifdef PPEXP00}}
\DoxyCodeLine{5160 \textcolor{preprocessor}{}        \textcolor{keywordflow}{do} n0=rg/2,1,-\/1}
\DoxyCodeLine{5161           \textcolor{keywordflow}{if} (rg-\/n0.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5162             \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{5163               n2=rg-\/2*n0-\/n1}
\DoxyCodeLine{5164               c(n0,n1,n2) = c(n0,n1,n2) + cexpg(n0,n1,n2,g)}
\DoxyCodeLine{5165 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{5166 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{5167 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{5168 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5169 \textcolor{preprocessor}{}}
\DoxyCodeLine{5170         \textcolor{keywordflow}{if} ((rg.le.rmax+1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5171           cerr(rg-\/1) = 0d0}
\DoxyCodeLine{5172           \textcolor{keywordflow}{do} n1=0,rg-\/1}
\DoxyCodeLine{5173             n2 = rg-\/1-\/n1}
\DoxyCodeLine{5174             c(0,n1,n2) = c(0,n1,n2) + cexpg(0,n1,n2,g)}
\DoxyCodeLine{5175             \textcolor{keywordflow}{if}(abs(cexpg(0,n1,n2,g-\/1)).ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5176 \textcolor{comment}{!             Cerr(rg-\/1)=max(Cerr(rg-\/1),abs(Cexpg(0,n1,n2,g))**2/abs(Cexpg(0,n1,n2,g-\/1)))}}
\DoxyCodeLine{5177               cerr(rg-\/1)=max(cerr(rg-\/1),abs(cexpg(0,n1,n2,g))*min(1d0,abs(cexpg(0,n1,n2,g))/abs(cexpg(0,n1,n2,g-\/1))))}
\DoxyCodeLine{5178             \textcolor{keywordflow}{else}}
\DoxyCodeLine{5179               cerr(rg-\/1)=max(cerr(rg-\/1),abs(cexpg(0,n1,n2,g)))}
\DoxyCodeLine{5180 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{5181 }
\DoxyCodeLine{5182 \textcolor{comment}{!            write(*,*) 'CalcCg err',r,rg,n1,n2,Cerr(rg-\/1),abs(Cexpg(0,n1,n2,g))**2/abs(Cexpg(0,n1,n2,g-\/1)) \&}}
\DoxyCodeLine{5183 \textcolor{comment}{!                     ,abs(Cexpg(0,n1,n2,g)),abs(Cexpg(0,n1,n2,g-\/1))}}
\DoxyCodeLine{5184 }
\DoxyCodeLine{5185 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{5186 }
\DoxyCodeLine{5187           \textcolor{comment}{! if error from B's larger than error from expansion stop expansion}}
\DoxyCodeLine{5188           \textcolor{keywordflow}{if}(cij\_err(rg-\/1).gt.cerr(rg-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5189              gtrunc = min(g,gtrunc)}
\DoxyCodeLine{5190              }
\DoxyCodeLine{5191 \textcolor{preprocessor}{\#ifdef Cgtest}}
\DoxyCodeLine{5192 \textcolor{preprocessor}{}             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg exit err'},r,g,gtrunc}
\DoxyCodeLine{5193 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5194 \textcolor{preprocessor}{}\textcolor{comment}{!            write(*,*) 'CalcCg exit err',r,g,gtrunc}}
\DoxyCodeLine{5195 }
\DoxyCodeLine{5196 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{5197 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{5198 }
\DoxyCodeLine{5199 \textcolor{keywordflow}{      end do} gloop}
\DoxyCodeLine{5200 }
\DoxyCodeLine{5201 \textcolor{preprocessor}{\#ifdef Cgtest}}
\DoxyCodeLine{5202 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg C(0,0,0) = '},r,c(0,0,0)}
\DoxyCodeLine{5203       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg C(2,0,0) = '},r,c(1,0,0)}
\DoxyCodeLine{5204       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg C(0,1,0) = '},r,c(0,1,0)}
\DoxyCodeLine{5205       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg C(0,0,1) = '},r,c(0,0,1)}
\DoxyCodeLine{5206       \textcolor{keywordflow}{if}(r.ge.5.and.rmax.ge.5) \textcolor{keywordflow}{then} }
\DoxyCodeLine{5207       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg C(2,1,0) = '},r,c(2,1,0)}
\DoxyCodeLine{5208 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{5209 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5210 \textcolor{preprocessor}{}}
\DoxyCodeLine{5211 \textcolor{preprocessor}{\#ifdef Cgtest}}
\DoxyCodeLine{5212 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg Cerr r ='},r,cerr}
\DoxyCodeLine{5213       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg Cij\_err ='},r,cij\_err}
\DoxyCodeLine{5214 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5215 \textcolor{preprocessor}{}}
\DoxyCodeLine{5216       cerr2 = max(cerr,cij\_err2(0:rmax))}
\DoxyCodeLine{5217       cerr = max(cerr,cij\_err(0:rmax))}
\DoxyCodeLine{5218 }
\DoxyCodeLine{5219 \textcolor{preprocessor}{\#ifdef Cgtest}}
\DoxyCodeLine{5220 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg Cerr ='},r,cerr,maxval(cerr)}
\DoxyCodeLine{5221 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5222 \textcolor{preprocessor}{}\textcolor{comment}{!     write(*,*) 'CalcCg Cerr =',r,Cerr,maxval(Cerr)}}
\DoxyCodeLine{5223 \textcolor{comment}{!     write(*,*) 'CalcCg areq =',acc\_req\_Cr*abs(C(0,0,0))}}
\DoxyCodeLine{5224 \textcolor{comment}{!     write(*,*) 'CalcCg Cex  =',maxval(Cerr-\/acc\_req\_Cr*abs(C(0,0,0)))}}
\DoxyCodeLine{5225 }
\DoxyCodeLine{5226 \textcolor{comment}{!       do mr = 15,min(r,rmax)}}
\DoxyCodeLine{5227 \textcolor{comment}{!         do n0=mr/2,1,-\/1}}
\DoxyCodeLine{5228 \textcolor{comment}{!           do n1=0,mr-\/2*n0}}
\DoxyCodeLine{5229 \textcolor{comment}{!             n2=mr-\/2*n0-\/n1}}
\DoxyCodeLine{5230 \textcolor{comment}{!               write(*,*) 'CalcCg n5 order  ',r,rg,mr,n0,n1,n2}}
\DoxyCodeLine{5231 \textcolor{comment}{!               write(*,*) 'CalcCg n5 order C',C(n0,n1,n2)}}
\DoxyCodeLine{5232 \textcolor{comment}{!           end do}}
\DoxyCodeLine{5233 \textcolor{comment}{!         end do }}
\DoxyCodeLine{5234 \textcolor{comment}{!       end do}}
\DoxyCodeLine{5235 \textcolor{comment}{!       do mr = 15,min(r-\/1,rmax)}}
\DoxyCodeLine{5236 \textcolor{comment}{!         n0=0}}
\DoxyCodeLine{5237 \textcolor{comment}{!           do n1=0,mr}}
\DoxyCodeLine{5238 \textcolor{comment}{!             n2=mr-\/n1}}
\DoxyCodeLine{5239 \textcolor{comment}{!               write(*,*) 'CalcCg n5 order  ',r,rg,mr,n0,n1,n2}}
\DoxyCodeLine{5240 \textcolor{comment}{!               write(*,*) 'CalcCg n5 order C',C(n0,n1,n2)}}
\DoxyCodeLine{5241 \textcolor{comment}{!           end do}}
\DoxyCodeLine{5242 \textcolor{comment}{!       end do}}
\DoxyCodeLine{5243 }
\DoxyCodeLine{5244       \textcolor{comment}{! check if target precision already reached}}
\DoxyCodeLine{5245 \textcolor{comment}{!      if(maxval(Cerr-\/acc\_req\_Cr*abs(C(0,0,0))).le.0d0) exit         ! changed 28.01.15}}
\DoxyCodeLine{5246 \textcolor{preprocessor}{\#ifdef Cutrloop}}
\DoxyCodeLine{5247 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(cerr-\/acc\_req\_cr*abs(c(0,0,0))).le.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5248         \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{5249 }
\DoxyCodeLine{5250 \textcolor{comment}{!          write(*,*) 'CalcCg exit rloop  =',rg,r,rmax}}
\DoxyCodeLine{5251 }
\DoxyCodeLine{5252           \textcolor{keywordflow}{do} n0=0,rg/2}
\DoxyCodeLine{5253             \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{5254               c(n0,n1,rg-\/2*n0-\/n1)=0d0}
\DoxyCodeLine{5255 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{5256 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{5257 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{5258         \textcolor{keywordflow}{if}(r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5259           \textcolor{keywordflow}{do} n1=0,r}
\DoxyCodeLine{5260             c(0,n1,r-\/n1)=0d0}
\DoxyCodeLine{5261 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{5262 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{5263 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{5264 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(cerr-\/acc\_req\_cr*abs(c(0,0,0))).le.0d0.and.r.gt.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5265 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5266 \textcolor{preprocessor}{}\textcolor{comment}{!       write(*,*) 'CalcCg exit rloop  =',r,rmax,rg}}
\DoxyCodeLine{5267 }
\DoxyCodeLine{5268         \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{5269 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{5270 }
\DoxyCodeLine{5271 \textcolor{keywordflow}{    end do} rloop}
\DoxyCodeLine{5272 }
\DoxyCodeLine{5273       \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2=r, n0>0 }}
\DoxyCodeLine{5274     \textcolor{keywordflow}{do} r=rmax+1,2*rmax}
\DoxyCodeLine{5275       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{5276         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{5277           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{5278           c(n0,n1,n2) = (b\_0(n0-\/1,n1,n2) + 2*mm02*c(n0-\/1,n1,n2) + 4*cuv(n0,n1,n2) \&}
\DoxyCodeLine{5279                         + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)*c(n0-\/1,n1+1,n2) + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)*c(n0-\/1,n1,n2+1)) / (2*r)}
\DoxyCodeLine{5280 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{5281 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{5282 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{5283 }
\DoxyCodeLine{5284 \textcolor{comment}{!       do mr = 15,rmax}}
\DoxyCodeLine{5285 \textcolor{comment}{!         do n0=mr/2,1,-\/1}}
\DoxyCodeLine{5286 \textcolor{comment}{!           do n1=0,mr-\/2*n0}}
\DoxyCodeLine{5287 \textcolor{comment}{!             n2=mr-\/2*n0-\/n1}}
\DoxyCodeLine{5288 \textcolor{comment}{!               write(*,*) 'CalcCg n6 order  ',r,rg,mr,n0,n1,n2}}
\DoxyCodeLine{5289 \textcolor{comment}{!               write(*,*) 'CalcCg n6 order C',C(n0,n1,n2)}}
\DoxyCodeLine{5290 \textcolor{comment}{!           end do}}
\DoxyCodeLine{5291 \textcolor{comment}{!         end do }}
\DoxyCodeLine{5292 \textcolor{comment}{!       end do}}
\DoxyCodeLine{5293 \textcolor{comment}{!       do mr = 15,rmax}}
\DoxyCodeLine{5294 \textcolor{comment}{!         n0=0}}
\DoxyCodeLine{5295 \textcolor{comment}{!           do n1=0,mr}}
\DoxyCodeLine{5296 \textcolor{comment}{!             n2=mr-\/n1}}
\DoxyCodeLine{5297 \textcolor{comment}{!               write(*,*) 'CalcCg n6 order  ',r,rg,mr,n0,n1,n2}}
\DoxyCodeLine{5298 \textcolor{comment}{!               write(*,*) 'CalcCg n6 order C',C(n0,n1,n2)}}
\DoxyCodeLine{5299 \textcolor{comment}{!           end do}}
\DoxyCodeLine{5300 \textcolor{comment}{!       end do}}
\DoxyCodeLine{5301 }
\DoxyCodeLine{5302 \textcolor{preprocessor}{\#ifdef Cgtest}}
\DoxyCodeLine{5303 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg final err'},cerr}
\DoxyCodeLine{5304     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg final acc'},cerr/abs(c(0,0,0))}
\DoxyCodeLine{5305 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5306 \textcolor{preprocessor}{}                 }
\DoxyCodeLine{5307 \textcolor{preprocessor}{\#ifdef TRACECout}}
\DoxyCodeLine{5308 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg rmax'},rmax}
\DoxyCodeLine{5309     \textcolor{keywordflow}{do} r=15,rmax}
\DoxyCodeLine{5310     \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{5311     \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{5312     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg out  '},r,n0,n1,r-\/2*n0-\/n1}
\DoxyCodeLine{5313     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg out C'},c(n0,n1,r-\/2*n0-\/n1)}
\DoxyCodeLine{5314 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{5315 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{5316 \textcolor{keywordflow}{    end do}   }
\DoxyCodeLine{5317 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5318 \textcolor{preprocessor}{}}
\DoxyCodeLine{5319 \textcolor{comment}{!    write(*,*) 'CalcCg Cerr ',Cerr}}
\DoxyCodeLine{5320 \textcolor{comment}{!    write(*,*) 'CalcCg Cerr2',Cerr2}}
\DoxyCodeLine{5321 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductionc_a3aabc53424377d93d71454fc18d1eaed}\label{namespacereductionc_a3aabc53424377d93d71454fc18d1eaed}} 
\index{reductionc@{reductionc}!calccgn@{calccgn}}
\index{calccgn@{calccgn}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{calccgn()}{calccgn()}}
{\footnotesize\ttfamily subroutine reductionc\+::calccgn (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{C,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Cuv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{ordg\+\_\+min,  }\item[{integer, intent(in)}]{ordg\+\_\+max,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr,  }\item[{double precision, dimension(0\+:rmax), intent(in)}]{acc\+\_\+req\+\_\+\+Cr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr2 }\end{DoxyParamCaption})}



Definition at line 4089 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{4089   }
\DoxyCodeLine{4090     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobalc}{globalc}}}
\DoxyCodeLine{4091 }
\DoxyCodeLine{4092     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,ordg\_min,ordg\_max,id}
\DoxyCodeLine{4093     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} ::  p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{4094     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: C(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4095     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Cuv(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4096     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Cerr(0:rmax),Cerr2(0:rmax)}
\DoxyCodeLine{4097     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(in)} :: acc\_req\_Cr(0:rmax)}
\DoxyCodeLine{4098     \textcolor{keywordtype}{double complex} :: Xtilde,Zkl,Zadjfj,Zadj2,Zadjkl}
\DoxyCodeLine{4099     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Cexpg(:,:,:,:), CuvExpg(:,:,:)}
\DoxyCodeLine{4100     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: B\_0(:,:,:), B\_i(:,:,:), Shat(:,:,:,:)}
\DoxyCodeLine{4101     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Buv\_0(:,:,:), Buv\_i(:,:,:)}
\DoxyCodeLine{4102     \textcolor{keywordtype}{double complex} :: Smod(2), Skl, CexpgAux}
\DoxyCodeLine{4103     \textcolor{keywordtype}{double complex} :: C0\_coli, elimminf2\_coli}
\DoxyCodeLine{4104     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err(:),Cij\_err(:)}
\DoxyCodeLine{4105     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{4106     \textcolor{keywordtype}{double precision} :: B\_err,B\_max}
\DoxyCodeLine{4107     \textcolor{keywordtype}{double precision} :: maxCexpg(0:1,0:rmax+ordg\_min+1,0:ordg\_max),truncfacexp}
\DoxyCodeLine{4108     \textcolor{keywordtype}{integer} :: rmaxB,rmaxExp,gtrunc,r,n0,n1,n2,k,l,i,j,m,n,sgn,g,rg}
\DoxyCodeLine{4109     \textcolor{keywordtype}{integer} :: inds0(2), inds(2), inds2(2), ktlt(2)}
\DoxyCodeLine{4110     \textcolor{keywordtype}{integer} :: bin,nid(0:2)}
\DoxyCodeLine{4111 }
\DoxyCodeLine{4112     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: D\_alt(:,:,:,:)}
\DoxyCodeLine{4113 }
\DoxyCodeLine{4114 \textcolor{preprocessor}{\#ifdef Cgntest}}
\DoxyCodeLine{4115 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn in '},rmax,ordg\_min,ordg\_max}
\DoxyCodeLine{4116 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4117 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifdef TRACECin}}
\DoxyCodeLine{4118 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn in '},rmax,ordg\_min,ordg\_max}
\DoxyCodeLine{4119 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4120 \textcolor{preprocessor}{}}
\DoxyCodeLine{4121     \textcolor{comment}{! allocation of B functions}}
\DoxyCodeLine{4122     rmaxb = rmax + ordg\_min}
\DoxyCodeLine{4123     \textcolor{keyword}{allocate}(b\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{4124     \textcolor{keyword}{allocate}(buv\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{4125     \textcolor{keyword}{allocate}(b\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{4126     \textcolor{keyword}{allocate}(buv\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{4127     }
\DoxyCodeLine{4128 }
\DoxyCodeLine{4129     \textcolor{comment}{! determine binaries for B-\/coefficients}}
\DoxyCodeLine{4130     k=0}
\DoxyCodeLine{4131     bin = 1}
\DoxyCodeLine{4132     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.2)}
\DoxyCodeLine{4133       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4134         nid(k) = id+bin}
\DoxyCodeLine{4135         k = k+1}
\DoxyCodeLine{4136 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{4137       bin = 2*bin}
\DoxyCodeLine{4138 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{4139 }
\DoxyCodeLine{4140     \textcolor{keyword}{call }calcb(b\_0(:,0,:),buv\_0(:,0,:),p21,m12,m22,rmaxb,nid(0))}
\DoxyCodeLine{4141     \textcolor{keyword}{call }calcb(b\_i(:,:,1),buv\_i(:,:,1),p20,m02,m22,rmaxb,nid(1))}
\DoxyCodeLine{4142     \textcolor{keyword}{call }calcb(b\_i(:,:,2),buv\_i(:,:,2),p10,m02,m12,rmaxb,nid(2))}
\DoxyCodeLine{4143 }
\DoxyCodeLine{4144     \textcolor{comment}{! shift of integration momentum in B\_0}}
\DoxyCodeLine{4145     b\_max=0d0}
\DoxyCodeLine{4146     \textcolor{keywordflow}{do} n1=1,rmaxb}
\DoxyCodeLine{4147       \textcolor{keywordflow}{do} n2=0,rmaxb-\/n1}
\DoxyCodeLine{4148         n0 = (rmaxb-\/n1-\/n2)}
\DoxyCodeLine{4149         b\_0(0:n0,n1,n2) = -\/b\_0(0:n0,n1-\/1,n2)-\/b\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{4150         buv\_0(0:n0,n1,n2) = -\/buv\_0(0:n0,n1-\/1,n2)-\/buv\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{4151         b\_max = max(b\_max,abs(b\_0(0,n1,n2)))}
\DoxyCodeLine{4152 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4153 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{4154     \textcolor{comment}{! error estimate for B's}}
\DoxyCodeLine{4155     b\_max = max(b\_max,maxval(abs(b\_i(0,0:rmaxb,1:2))))}
\DoxyCodeLine{4156     b\_err = acc\_def\_b*b\_max}
\DoxyCodeLine{4157 }
\DoxyCodeLine{4158 }
\DoxyCodeLine{4159     \textcolor{comment}{! determine (adjugated) Gram matrix}}
\DoxyCodeLine{4160 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{4161 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{4162 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{4163 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{4164 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{4165 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{4166 \textcolor{comment}{!}}
\DoxyCodeLine{4167 \textcolor{comment}{!    q1q2 = (q10+q20-\/q21)}}
\DoxyCodeLine{4168 \textcolor{comment}{!    detZ = 4d0*q10*q20-\/q1q2*q1q2}}
\DoxyCodeLine{4169 }
\DoxyCodeLine{4170 \textcolor{comment}{!    if (abs(detZ/( 4d0*q10*q20 + q1q2*q1q2)).lt.1d-\/4) then}}
\DoxyCodeLine{4171 \textcolor{comment}{!      if (abs(q10-\/q20).lt.abs(q10-\/q21).and.  \&}}
\DoxyCodeLine{4172 \textcolor{comment}{!          abs(q10-\/q20).lt.abs(q20-\/q21)) then}}
\DoxyCodeLine{4173 \textcolor{comment}{!        detZ  =  4d0*q10*q21 -\/ (q10-\/q20+q21)*(q10-\/q20+q21)}}
\DoxyCodeLine{4174 \textcolor{comment}{!      end if}}
\DoxyCodeLine{4175 \textcolor{comment}{!    end if}}
\DoxyCodeLine{4176 }
\DoxyCodeLine{4177 \textcolor{comment}{!   write(*,*) 'Z = ',Z}}
\DoxyCodeLine{4178 }
\DoxyCodeLine{4179 \textcolor{comment}{!    Zadj(1,1) = 2d0*q20}}
\DoxyCodeLine{4180 \textcolor{comment}{!    Zadj(2,1) = -\/q1q2}}
\DoxyCodeLine{4181 \textcolor{comment}{!    Zadj(1,2) = -\/q1q2}}
\DoxyCodeLine{4182 \textcolor{comment}{!    Zadj(2,2) = 2d0*q10}}
\DoxyCodeLine{4183 \textcolor{comment}{!    f(1) = q10+mm02-\/mm12}}
\DoxyCodeLine{4184 \textcolor{comment}{!    f(2) = q20+mm02-\/mm22}}
\DoxyCodeLine{4185 }
\DoxyCodeLine{4186 \textcolor{comment}{!    Zadjf(1) = Zadj(1,1)*f(1)+Zadj(2,1)*f(2)}}
\DoxyCodeLine{4187 \textcolor{comment}{!    Zadjf(2) = Zadj(1,2)*f(1)+Zadj(2,2)*f(2)}}
\DoxyCodeLine{4188 }
\DoxyCodeLine{4189 \textcolor{comment}{!    maxZadj=maxval(abs(Zadj))}}
\DoxyCodeLine{4190 \textcolor{comment}{!    fmax   =maxval(abs(f))}}
\DoxyCodeLine{4191 }
\DoxyCodeLine{4192     \textcolor{comment}{! coefficients Shat defined in (5.13)}}
\DoxyCodeLine{4193     \textcolor{keyword}{allocate}(shat(0:rmaxb,0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{4194 }
\DoxyCodeLine{4195     \textcolor{keywordflow}{do} r=0,rmaxb}
\DoxyCodeLine{4196       \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{4197 }
\DoxyCodeLine{4198         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{4199           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{4200           shat(n0,n1,n2,:) = -\/b\_0(n0,n1,n2)}
\DoxyCodeLine{4201 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4202 }
\DoxyCodeLine{4203         k = r-\/2*n0}
\DoxyCodeLine{4204         shat(n0,0,k,1) = shat(n0,0,k,1) + b\_i(n0,k,1)}
\DoxyCodeLine{4205         shat(n0,k,0,2) = shat(n0,k,0,2) + b\_i(n0,k,2)}
\DoxyCodeLine{4206 }
\DoxyCodeLine{4207 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4208 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{4209 }
\DoxyCodeLine{4210     \textcolor{comment}{! choose reduction formulas with biggest denominators}}
\DoxyCodeLine{4211     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)).ge.abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4212       j = 1}
\DoxyCodeLine{4213     \textcolor{keywordflow}{else} }
\DoxyCodeLine{4214       j = 2}
\DoxyCodeLine{4215 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4216 }
\DoxyCodeLine{4217     \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = 0d0                 \textcolor{comment}{! Zadj2f(k,n,l) = Zadf2(k,n,l,m)*f(m)}}
\DoxyCodeLine{4218                                   \textcolor{comment}{! Zadj2(n,m) ==  Zadf2(k,n,l,m)}}
\DoxyCodeLine{4219     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1)).gt.\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4220       \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1))}
\DoxyCodeLine{4221       k = 1}
\DoxyCodeLine{4222       l = 1}
\DoxyCodeLine{4223       inds2 = (/2,2/)}
\DoxyCodeLine{4224       zadj2 = -\/1d0}
\DoxyCodeLine{4225 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4226     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2)).gt.\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4227       \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2))}
\DoxyCodeLine{4228       k = 1}
\DoxyCodeLine{4229       l = 2}
\DoxyCodeLine{4230       inds2 = (/2,1/)}
\DoxyCodeLine{4231       zadj2 =  1d0}
\DoxyCodeLine{4232 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4233 }
\DoxyCodeLine{4234     zadjfj = \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j)}
\DoxyCodeLine{4235     zadjkl = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)}
\DoxyCodeLine{4236     xtilde = \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(k,l)}
\DoxyCodeLine{4237 }
\DoxyCodeLine{4238 \textcolor{comment}{!    write(*,*) 'CalcCgn Xtilde n',Xtilde,Xadj(1,1),Xadj(1,2),Xadj(2,2)}}
\DoxyCodeLine{4239 }
\DoxyCodeLine{4240 }
\DoxyCodeLine{4241     \textcolor{comment}{! allocation of array for det(Z)-\/expanded C-\/coefficients}}
\DoxyCodeLine{4242     rmaxexp = rmaxb+1}
\DoxyCodeLine{4243     \textcolor{keyword}{allocate}(cexpg(0:rmaxexp/2,0:rmaxexp-\/1,0:rmaxexp-\/1,0:ordg\_max))}
\DoxyCodeLine{4244 }
\DoxyCodeLine{4245     \textcolor{comment}{! calculate Cuv}}
\DoxyCodeLine{4246     \textcolor{keyword}{allocate}(cuvexpg(0:rmaxexp,0:rmaxexp,0:rmaxexp))}
\DoxyCodeLine{4247     \textcolor{keyword}{call }calccuv(cuvexpg,buv\_0,mm02,\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}},rmaxexp,id)}
\DoxyCodeLine{4248     cuv(0:rmax,0:rmax,0:rmax) = cuvexpg(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{4249 }
\DoxyCodeLine{4250     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{4251     \textcolor{keyword}{allocate}(c00\_err(0:rmaxexp))}
\DoxyCodeLine{4252     \textcolor{keyword}{allocate}(cij\_err(0:rmaxexp))}
\DoxyCodeLine{4253     \textcolor{keyword}{allocate}(c00\_err2(0:rmaxexp))}
\DoxyCodeLine{4254     \textcolor{keyword}{allocate}(cij\_err2(0:rmaxexp))}
\DoxyCodeLine{4255      }
\DoxyCodeLine{4256     \textcolor{comment}{! initialize accuracy estimates}}
\DoxyCodeLine{4257     cerr = acc\_inf}
\DoxyCodeLine{4258     cij\_err =0d0}
\DoxyCodeLine{4259     c00\_err =0d0}
\DoxyCodeLine{4260 }
\DoxyCodeLine{4261     cerr2 = acc\_inf}
\DoxyCodeLine{4262     cij\_err2 =0d0}
\DoxyCodeLine{4263     c00\_err2 =0d0}
\DoxyCodeLine{4264 }
\DoxyCodeLine{4265 \textcolor{preprocessor}{\#ifdef Cgntest}}
\DoxyCodeLine{4266 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn rmax = '},rmax,rmaxexp}
\DoxyCodeLine{4267     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn Cij\_err = '},cij\_err }
\DoxyCodeLine{4268     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn B0 = '}, b\_0(0,0,0),b\_i(0,0,1),b\_i(0,0,2)}
\DoxyCodeLine{4269 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4270 \textcolor{preprocessor}{}}
\DoxyCodeLine{4271 \textcolor{comment}{!    maxZadj = maxval(abs(Zadj))}}
\DoxyCodeLine{4272 \textcolor{comment}{!    maxZadj2f = maxval(abs(f(inds2(1,:))*Zadj2(:)))}}
\DoxyCodeLine{4273 }
\DoxyCodeLine{4274     \textcolor{comment}{! truncation of expansion if calculated term larger than truncfacexp * previous term}}
\DoxyCodeLine{4275     \textcolor{comment}{! crucial for expansion parameters between 0.1 and 1 !!!}}
\DoxyCodeLine{4276     truncfacexp = sqrt(\mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}}) * truncfacc}
\DoxyCodeLine{4277     gtrunc = ordg\_max }
\DoxyCodeLine{4278 }
\DoxyCodeLine{4279 \textcolor{comment}{! calculate C(n0,n1,n2) up to rank r for n0>0 and up to rank r-\/1 for n0=0}}
\DoxyCodeLine{4280     rloop: \textcolor{keywordflow}{do} r=1,rmaxexp}
\DoxyCodeLine{4281 }
\DoxyCodeLine{4282 \textcolor{preprocessor}{\#ifdef Cgntest}}
\DoxyCodeLine{4283 \textcolor{preprocessor}{}\textcolor{comment}{!      write(*,*) 'CalcCgn rloop',r,rmax,gtrunc}}
\DoxyCodeLine{4284 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4285 \textcolor{preprocessor}{}}
\DoxyCodeLine{4286       \textcolor{keywordflow}{if} (r.gt.rmax+gtrunc+1) \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{4287 }
\DoxyCodeLine{4288 \textcolor{preprocessor}{\#ifdef Cgntest}}
\DoxyCodeLine{4289 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn rloop'},r}
\DoxyCodeLine{4290 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4291 \textcolor{preprocessor}{}}
\DoxyCodeLine{4292       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{4293       \textcolor{comment}{! 0th-\/order coefficients}}
\DoxyCodeLine{4294       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{4295 }
\DoxyCodeLine{4296       \textcolor{comment}{! calculating}}
\DoxyCodeLine{4297       \textcolor{comment}{! C\_00(a)0000..00 -\/-\/> C\_00(a)ij00..00 -\/-\/> C\_00(a)ijkl00..00 -\/-\/> ... -\/-\/> C\_00(a)ijklmn..}}
\DoxyCodeLine{4298       \textcolor{comment}{! exploiting eq. (5.40)}}
\DoxyCodeLine{4299       maxcexpg(1,r,0)=0d0}
\DoxyCodeLine{4300       \textcolor{keywordflow}{do} n0=r/2,1,-\/1}
\DoxyCodeLine{4301         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{4302           n2=r-\/2*n0-\/n1}
\DoxyCodeLine{4303 }
\DoxyCodeLine{4304           inds0(1) = n1}
\DoxyCodeLine{4305           inds0(2) = n2}
\DoxyCodeLine{4306           }
\DoxyCodeLine{4307           cexpgaux = 2d0*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)*b\_0(n0-\/1,n1,n2)  \& }
\DoxyCodeLine{4308               + xtilde*cexpg(n0-\/1,n1,n2,0)  \&}
\DoxyCodeLine{4309               + 4d0*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)*cuvexpg(n0,n1,n2)}
\DoxyCodeLine{4310           }
\DoxyCodeLine{4311           inds = inds0}
\DoxyCodeLine{4312           inds(k) = inds(k)+1}
\DoxyCodeLine{4313           \textcolor{keywordflow}{do} i=1,2}
\DoxyCodeLine{4314             cexpgaux = cexpgaux + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,l)*shat(n0-\/1,inds(1),inds(2),i)}
\DoxyCodeLine{4315 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4316           }
\DoxyCodeLine{4317           \textcolor{keywordflow}{do} i=1,2}
\DoxyCodeLine{4318             inds = inds0}
\DoxyCodeLine{4319             inds(i) = inds(i)+1}
\DoxyCodeLine{4320             cexpgaux = cexpgaux -\/ \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)*shat(n0-\/1,inds(1),inds(2),i)}
\DoxyCodeLine{4321 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4322           }
\DoxyCodeLine{4323           n = inds2(1)}
\DoxyCodeLine{4324           m = inds2(2)}
\DoxyCodeLine{4325           }
\DoxyCodeLine{4326           skl = \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(n)*shat(n0-\/1,inds0(1),inds0(2),m)}
\DoxyCodeLine{4327           }
\DoxyCodeLine{4328           inds = inds0}
\DoxyCodeLine{4329           \textcolor{keywordflow}{if} (inds(m).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4330             inds(m) = inds(m)-\/1}
\DoxyCodeLine{4331             skl = skl -\/ 2d0*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(n)*inds0(m)*cexpg(n0,inds(1),inds(2),0)}
\DoxyCodeLine{4332             \textcolor{keywordflow}{if} (inds(n).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4333               inds(n) = inds(n)-\/1}
\DoxyCodeLine{4334               skl = skl -\/ 4d0*inds0(m)*(inds(n)+1)*cexpg(n0+1,inds(1),inds(2),0)}
\DoxyCodeLine{4335 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4336 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4337           inds = inds0}
\DoxyCodeLine{4338           \textcolor{keywordflow}{if} (inds(n).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4339             inds(n) = inds(n)-\/1}
\DoxyCodeLine{4340             skl = skl + 2d0*inds0(n)*shat(n0,inds(1),inds(2),m)  \&}
\DoxyCodeLine{4341                 -\/ 2d0*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(m)*inds0(n)*cexpg(n0,inds(1),inds(2),0)}
\DoxyCodeLine{4342 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4343           }
\DoxyCodeLine{4344           cexpgaux = cexpgaux -\/ zadj2*skl}
\DoxyCodeLine{4345           }
\DoxyCodeLine{4346           cexpg(n0,n1,n2,0) = cexpgaux/(2d0*zadjkl)/(2d0*(r-\/n0)+1)}
\DoxyCodeLine{4347           }
\DoxyCodeLine{4348           \textcolor{keywordflow}{if} (n0.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4349             maxcexpg(1,r,0) =  maxcexpg(1,r,0) + abs(cexpg(n0,n1,n2,0) )}
\DoxyCodeLine{4350 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4351           }
\DoxyCodeLine{4352           \textcolor{keywordflow}{if} (r-\/n0.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4353             c(n0,n1,n2) = cexpg(n0,n1,n2,0)}
\DoxyCodeLine{4354 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4355 }
\DoxyCodeLine{4356 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4357 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4358 }
\DoxyCodeLine{4359       \textcolor{comment}{! calculate}}
\DoxyCodeLine{4360       \textcolor{comment}{! C\_00ijkl.. -\/-\/> C\_aijkl..}}
\DoxyCodeLine{4361       \textcolor{comment}{! exploiting eq. (5.38)}}
\DoxyCodeLine{4362       maxcexpg(0,r-\/1,0)=0d0}
\DoxyCodeLine{4363       \textcolor{keywordflow}{do} n1=0,r-\/1}
\DoxyCodeLine{4364         n2=r-\/1-\/n1}
\DoxyCodeLine{4365 }
\DoxyCodeLine{4366           smod = shat(0,n1,n2,:)}
\DoxyCodeLine{4367           \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4368             smod(1) = smod(1) -\/ 2d0*n1*cexpg(1,n1-\/1,n2,0)}
\DoxyCodeLine{4369 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4370           \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4371             smod(2) = smod(2) -\/ 2d0*n2*cexpg(1,n1,n2-\/1,0)}
\DoxyCodeLine{4372 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4373 }
\DoxyCodeLine{4374           cexpg(0,n1,n2,0) = (\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1) +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2))/zadjfj}
\DoxyCodeLine{4375           maxcexpg(0,r-\/1,0) =  maxcexpg(0,r-\/1,0) + abs(cexpg(0,n1,n2,0))}
\DoxyCodeLine{4376           \textcolor{keywordflow}{if} (r-\/n0.le.rmax+1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4377             c(0,n1,n2) = cexpg(0,n1,n2,0)}
\DoxyCodeLine{4378 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4379 }
\DoxyCodeLine{4380 \textcolor{preprocessor}{\#ifdef Cgntest}}
\DoxyCodeLine{4381 \textcolor{preprocessor}{}\textcolor{comment}{!          if(n0.eq.0.and.n1.eq.0.and.n2.eq.3) then }}
\DoxyCodeLine{4382 \textcolor{comment}{!            write(*,*) 'C2(0,0,3,0)= ',0,C(n0,n1,n2)}}
\DoxyCodeLine{4383 \textcolor{comment}{!          end if}}
\DoxyCodeLine{4384 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4385 \textcolor{preprocessor}{}}
\DoxyCodeLine{4386 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4387 }
\DoxyCodeLine{4388 \textcolor{preprocessor}{\#ifdef Cgntest}}
\DoxyCodeLine{4389 \textcolor{preprocessor}{}\textcolor{comment}{!      write(*,*) 'CalcCgn maxCexpg 0',r-\/1, maxCexpg(0,r-\/1,0)}}
\DoxyCodeLine{4390 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4391 \textcolor{preprocessor}{}}
\DoxyCodeLine{4392       \textcolor{keywordflow}{if}(r.le.rmax+1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4393 \textcolor{comment}{!       Cerr(r-\/1) =  abs(detZ/Zadjfj)*maxCexpg(0,r-\/1,0)}}
\DoxyCodeLine{4394         cerr(r-\/1) =  \mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}}*maxcexpg(0,r-\/1,0)}
\DoxyCodeLine{4395 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{4396 }
\DoxyCodeLine{4397       \textcolor{comment}{! error propagation from B's}}
\DoxyCodeLine{4398       c00\_err(r) = max(max(\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*b\_err,\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}*b\_err)/abs(zadjkl),b\_err)  \&}
\DoxyCodeLine{4399                    /(2*(2*r-\/1))        }
\DoxyCodeLine{4400       cij\_err(r-\/1)=\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(b\_err,2*c00\_err(r))/abs(zadjfj)}
\DoxyCodeLine{4401 }
\DoxyCodeLine{4402       c00\_err2(r) = max(max(\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*b\_err,\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}*b\_err)/abs(zadjkl),b\_err)  \&}
\DoxyCodeLine{4403                    /(2*(2*r-\/1))        }
\DoxyCodeLine{4404       cij\_err2(r-\/1)=\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(b\_err,2*c00\_err2(r))/abs(zadjfj)}
\DoxyCodeLine{4405 }
\DoxyCodeLine{4406 \textcolor{preprocessor}{\#ifdef Cgntest}}
\DoxyCodeLine{4407 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn C00\_err'},r,  \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}},\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}},abs(zadjkl),b\_err,abs(zadjfj)}
\DoxyCodeLine{4408       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn C00\_err'},r,  c00\_err(r), cij\_err(r-\/1)}
\DoxyCodeLine{4409 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4410 \textcolor{preprocessor}{}}
\DoxyCodeLine{4411       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{4412       \textcolor{comment}{! higher order coefficients}}
\DoxyCodeLine{4413       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{4414 }
\DoxyCodeLine{4415       rg = r}
\DoxyCodeLine{4416       gloop: \textcolor{keywordflow}{do} g=1,min(gtrunc,r-\/1)}
\DoxyCodeLine{4417         rg = rg-\/1}
\DoxyCodeLine{4418 }
\DoxyCodeLine{4419 \textcolor{comment}{!        write(*,*) 'gloop ',g,rg}}
\DoxyCodeLine{4420 }
\DoxyCodeLine{4421         \textcolor{comment}{! calculating}}
\DoxyCodeLine{4422         \textcolor{comment}{! C\_00(a)0000..00 -\/-\/> C\_00(a)ij00..00 -\/-\/> C\_00(a)ijkl00..00 -\/-\/> ... -\/-\/> C\_00(a)ijklmn..}}
\DoxyCodeLine{4423         \textcolor{comment}{! exploiting eq. (5.40)}}
\DoxyCodeLine{4424         maxcexpg(1,rg,g) = 0d0}
\DoxyCodeLine{4425         \textcolor{keywordflow}{do} n0=rg/2,1,-\/1}
\DoxyCodeLine{4426           \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{4427             n2=rg-\/2*n0-\/n1}
\DoxyCodeLine{4428 }
\DoxyCodeLine{4429             inds0(1) = n1}
\DoxyCodeLine{4430             inds0(2) = n2}
\DoxyCodeLine{4431             }
\DoxyCodeLine{4432             inds = inds0}
\DoxyCodeLine{4433             inds(k) = inds(k)+1}
\DoxyCodeLine{4434             inds(l) = inds(l)+1}
\DoxyCodeLine{4435             cexpgaux = xtilde*cexpg(n0-\/1,n1,n2,g)  \&}
\DoxyCodeLine{4436                 -\/ \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*cexpg(n0-\/1,inds(1),inds(2),g-\/1)}
\DoxyCodeLine{4437             }
\DoxyCodeLine{4438             }
\DoxyCodeLine{4439             n = inds2(1)}
\DoxyCodeLine{4440             m = inds2(2)}
\DoxyCodeLine{4441             }
\DoxyCodeLine{4442             skl = 0d0}
\DoxyCodeLine{4443             }
\DoxyCodeLine{4444             inds = inds0}
\DoxyCodeLine{4445             \textcolor{keywordflow}{if} (inds(m).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4446               inds(m) = inds(m)-\/1}
\DoxyCodeLine{4447               skl = skl -\/ 2d0*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(n)*inds0(m)*cexpg(n0,inds(1),inds(2),g)}
\DoxyCodeLine{4448               \textcolor{keywordflow}{if} (inds(n).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4449                 inds(n) = inds(n)-\/1}
\DoxyCodeLine{4450                 skl = skl -\/ 4d0*inds0(m)*(inds(n)+1)*cexpg(n0+1,inds(1),inds(2),g)}
\DoxyCodeLine{4451 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{4452 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4453             inds = inds0}
\DoxyCodeLine{4454             \textcolor{keywordflow}{if} (inds(n).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4455               inds(n) = inds(n)-\/1}
\DoxyCodeLine{4456               skl = skl -\/ 2d0*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(m)*inds0(n)*cexpg(n0,inds(1),inds(2),g)}
\DoxyCodeLine{4457 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4458             }
\DoxyCodeLine{4459             cexpgaux = cexpgaux -\/ zadj2*skl}
\DoxyCodeLine{4460             }
\DoxyCodeLine{4461             cexpg(n0,n1,n2,g) = cexpgaux/(2d0*zadjkl)/(2d0*(rg-\/n0)+1)}
\DoxyCodeLine{4462             }
\DoxyCodeLine{4463             }
\DoxyCodeLine{4464             \textcolor{keywordflow}{if}(n0.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4465               maxcexpg(1,rg,g) =  maxcexpg(1,rg,g) + abs(cexpg(n0,n1,n2,g))}
\DoxyCodeLine{4466               }
\DoxyCodeLine{4467               \textcolor{keywordflow}{if} (g.eq.1.and.abs(cexpg(n0,n1,n2,g)).gt.          \& }
\DoxyCodeLine{4468                   truncfacexp*max(1d0,maxcexpg(1,rg,g-\/1)) .or.   \&}
\DoxyCodeLine{4469                   g.ge.2.and.abs(cexpg(n0,n1,n2,g)).gt.          \&}
\DoxyCodeLine{4470                   truncfacexp*maxcexpg(1,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4471 }
\DoxyCodeLine{4472 \textcolor{preprocessor}{\#ifdef Cgntest}}
\DoxyCodeLine{4473 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn exit gloop'},n0,n1,n2,g,abs(cexpg(n0,n1,n2,g)),maxcexpg(1,rg,g-\/1),truncfacexp}
\DoxyCodeLine{4474 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{4475 \textcolor{preprocessor}{}                }
\DoxyCodeLine{4476                 gtrunc = g-\/1}
\DoxyCodeLine{4477                 \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{4478 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{4479 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4480             }
\DoxyCodeLine{4481 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4482 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4483 }
\DoxyCodeLine{4484 \textcolor{preprocessor}{\#ifndef PPEXP00}}
\DoxyCodeLine{4485 \textcolor{preprocessor}{}        \textcolor{keywordflow}{do} n0=rg/2,1,-\/1}
\DoxyCodeLine{4486           \textcolor{keywordflow}{if} (rg-\/n0.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4487             \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{4488               n2=rg-\/2*n0-\/n1}
\DoxyCodeLine{4489               c(n0,n1,n2) = c(n0,n1,n2) + cexpg(n0,n1,n2,g)}
\DoxyCodeLine{4490 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{4491 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4492 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4493 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4494 \textcolor{preprocessor}{}\textcolor{comment}{!        write(*,*) 'CalcCgn after it1 ',rg}}
\DoxyCodeLine{4495 }
\DoxyCodeLine{4496         \textcolor{comment}{! calculate}}
\DoxyCodeLine{4497         \textcolor{comment}{! C\_00ijkl.. -\/-\/> C\_aijkl..}}
\DoxyCodeLine{4498         \textcolor{comment}{! exploiting eq. (5.38)}}
\DoxyCodeLine{4499 }
\DoxyCodeLine{4500 \textcolor{comment}{!        write(*,*) 'CalcCgn maxCexp',rg-\/1,g-\/1,maxCexpg(0,rg-\/1,g-\/1)}}
\DoxyCodeLine{4501 }
\DoxyCodeLine{4502         maxcexpg(0,rg-\/1,g) = 0d0}
\DoxyCodeLine{4503         \textcolor{keywordflow}{do} n1=0,rg-\/1}
\DoxyCodeLine{4504           n2=rg-\/1-\/n1}
\DoxyCodeLine{4505 }
\DoxyCodeLine{4506           smod = 0d0}
\DoxyCodeLine{4507           \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4508             smod(1) = smod(1) -\/ 2d0*n1*cexpg(1,n1-\/1,n2,g)}
\DoxyCodeLine{4509 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4510           \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4511             smod(2) = smod(2) -\/ 2d0*n2*cexpg(1,n1,n2-\/1,g)}
\DoxyCodeLine{4512 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4513           }
\DoxyCodeLine{4514           inds(1) = n1}
\DoxyCodeLine{4515           inds(2) = n2}
\DoxyCodeLine{4516           inds(j) = inds(j)+1}
\DoxyCodeLine{4517           cexpg(0,n1,n2,g) = (\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1) +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2)  \&}
\DoxyCodeLine{4518               -\/ \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*cexpg(0,inds(1),inds(2),g-\/1))/zadjfj}
\DoxyCodeLine{4519           }
\DoxyCodeLine{4520           maxcexpg(0,rg-\/1,g) =  maxcexpg(0,rg-\/1,g) + abs(cexpg(0,n1,n2,g))}
\DoxyCodeLine{4521           }
\DoxyCodeLine{4522 \textcolor{comment}{!              if(n1.eq.0.and.n2.eq.1) then }}
\DoxyCodeLine{4523 \textcolor{comment}{!                write(*,*) 'C2(2,3)= ',g,Cexpg(0,n1,n2,g)}}
\DoxyCodeLine{4524 \textcolor{comment}{!                write(*,*) 'C2(2,3)= ',Zadj(1,j)*Smod(1)/Zadjfj,  Zadj(2,j)*Smod(2)/Zadjfj,  \&}}
\DoxyCodeLine{4525 \textcolor{comment}{!                                -\/ detZ*Cexpg(0,inds(1),inds(2),inds(3),g-\/1)/Zadjfj}}
\DoxyCodeLine{4526 \textcolor{comment}{!                write(*,*) 'C2(2,3)= ',inds(1),inds(2),         \&}}
\DoxyCodeLine{4527 \textcolor{comment}{!                                -\/ detZ/Zadjfj,Cexpg(0,inds(1),inds(2),g-\/1)}}
\DoxyCodeLine{4528 \textcolor{comment}{!              end if}}
\DoxyCodeLine{4529           }
\DoxyCodeLine{4530           \textcolor{keywordflow}{if} (g.eq.1.and.abs(cexpg(0,n1,n2,g)).gt.                     \&}
\DoxyCodeLine{4531               truncfacexp*max(1/\mbox{\hyperlink{namespaceglobalc_a45c0f5c169a73fb12286352743b5a557}{m2max}},maxcexpg(0,rg-\/1,g-\/1))    .or.    \&}
\DoxyCodeLine{4532               g.ge.2.and.abs(cexpg(0,n1,n2,g)).gt.                     \&}
\DoxyCodeLine{4533               truncfacexp*maxcexpg(0,rg-\/1,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4534             }
\DoxyCodeLine{4535 \textcolor{preprocessor}{\#ifdef Cgntest}}
\DoxyCodeLine{4536 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn exit gloop'},0,n1,n2,g,abs(cexpg(0,n1,n2,g)),maxcexpg(0,rg-\/1,g-\/1),truncfacexp}
\DoxyCodeLine{4537 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{4538 \textcolor{preprocessor}{}            gtrunc = g-\/1}
\DoxyCodeLine{4539             \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{4540 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4541 }
\DoxyCodeLine{4542 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4543 }
\DoxyCodeLine{4544         \textcolor{comment}{! error propagation from B's}}
\DoxyCodeLine{4545         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{4546           c00\_err(rg) = max(c00\_err(rg),                    \&}
\DoxyCodeLine{4547               max( abs(m02)*cij\_err(rg-\/2),                             \&}
\DoxyCodeLine{4548               max(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*cij\_err(rg),\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}**2*cij\_err(rg-\/2),\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}*c00\_err(rg-\/1))/abs(zadjkl) ) \&}
\DoxyCodeLine{4549                    /(2*(2*rg-\/1))     )   }
\DoxyCodeLine{4550 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{4551         cij\_err(rg-\/1) = max(cij\_err(rg-\/1),max(2*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*c00\_err(rg),\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*cij\_err(rg))/abs(zadjfj) ) }
\DoxyCodeLine{4552 }
\DoxyCodeLine{4553         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{4554           c00\_err2(rg) = max(c00\_err2(rg),                    \&}
\DoxyCodeLine{4555               max( abs(m02)*cij\_err2(rg-\/2),                             \&}
\DoxyCodeLine{4556               max(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*cij\_err2(rg),\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}**2*cij\_err2(rg-\/2),\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}*c00\_err2(rg-\/1))/abs(zadjkl) ) \&}
\DoxyCodeLine{4557                    /(2*(2*rg-\/1))     )   }
\DoxyCodeLine{4558 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{4559         cij\_err2(rg-\/1) = max(cij\_err2(rg-\/1),max(2*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*c00\_err2(rg),\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*cij\_err2(rg))/abs(zadjfj) ) }
\DoxyCodeLine{4560 }
\DoxyCodeLine{4561 \textcolor{comment}{!      write(*,*) 'CalcCg g: ',r,adetZ/abs(Zadjfj),C00\_err(rg),B\_err}}
\DoxyCodeLine{4562 \textcolor{comment}{!      write(*,*) 'CalcCg g: Cij\_err=',rg-\/1,Cij\_err(rg-\/1)}}
\DoxyCodeLine{4563 }
\DoxyCodeLine{4564 \textcolor{preprocessor}{\#ifdef PPEXP00}}
\DoxyCodeLine{4565 \textcolor{preprocessor}{}        \textcolor{keywordflow}{do} n0=rg/2,1,-\/1}
\DoxyCodeLine{4566           \textcolor{keywordflow}{if} (rg-\/n0.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4567             \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{4568               n2=rg-\/2*n0-\/n1}
\DoxyCodeLine{4569               c(n0,n1,n2) = c(n0,n1,n2) + cexpg(n0,n1,n2,g)}
\DoxyCodeLine{4570 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{4571 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4572 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4573 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4574 \textcolor{preprocessor}{}}
\DoxyCodeLine{4575 \textcolor{comment}{!        write(*,*) 'CalcCgn after it1 ',rg}}
\DoxyCodeLine{4576         \textcolor{keywordflow}{if} ((rg.le.rmax+1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4577           cerr(rg-\/1) = 0d0}
\DoxyCodeLine{4578           \textcolor{keywordflow}{do} n1=0,rg-\/1}
\DoxyCodeLine{4579             n2 = rg-\/1-\/n1}
\DoxyCodeLine{4580             c(0,n1,n2) = c(0,n1,n2) + cexpg(0,n1,n2,g)}
\DoxyCodeLine{4581             \textcolor{keywordflow}{if}(abs(cexpg(0,n1,n2,g-\/1)).ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4582 \textcolor{comment}{!             Cerr(rg-\/1)=max(Cerr(rg-\/1),abs(Cexpg(0,n1,n2,g))**2/abs(Cexpg(0,n1,n2,g-\/1)))}}
\DoxyCodeLine{4583               cerr(rg-\/1)=max(cerr(rg-\/1),abs(cexpg(0,n1,n2,g))*min(1d0,abs(cexpg(0,n1,n2,g))/abs(cexpg(0,n1,n2,g-\/1))))}
\DoxyCodeLine{4584             \textcolor{keywordflow}{else}}
\DoxyCodeLine{4585               cerr(rg-\/1)=max(cerr(rg-\/1),abs(cexpg(0,n1,n2,g)))}
\DoxyCodeLine{4586 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{4587 }
\DoxyCodeLine{4588 \textcolor{comment}{!             write(*,*) 'CalcCg err',r,rg,n1,n2,Cerr(rg-\/1),abs(Cexpg(0,n1,n2,g))**2/abs(Cexpg(0,n1,n2,g-\/1)) \&}}
\DoxyCodeLine{4589 \textcolor{comment}{!                     ,abs(Cexpg(0,n1,n2,g)),abs(Cexpg(0,n1,n2,g-\/1))}}
\DoxyCodeLine{4590 }
\DoxyCodeLine{4591 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4592 }
\DoxyCodeLine{4593           \textcolor{comment}{! if error from B's larger than error from expansion stop expansion}}
\DoxyCodeLine{4594           \textcolor{keywordflow}{if}(cij\_err(rg-\/1).gt.cerr(rg-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4595              gtrunc = min(g,gtrunc)}
\DoxyCodeLine{4596              }
\DoxyCodeLine{4597 \textcolor{preprocessor}{\#ifdef Cgtest}}
\DoxyCodeLine{4598 \textcolor{preprocessor}{}             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn exit err'},r,g,gtrunc  \&}
\DoxyCodeLine{4599              ,cij\_err(rg-\/1),cerr(rg-\/1)}
\DoxyCodeLine{4600 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4601 \textcolor{preprocessor}{}}
\DoxyCodeLine{4602 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{4603 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{4604 }
\DoxyCodeLine{4605 \textcolor{keywordflow}{      end do} gloop}
\DoxyCodeLine{4606 }
\DoxyCodeLine{4607 \textcolor{preprocessor}{\#ifdef Cgntest}}
\DoxyCodeLine{4608 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn C(0,0,0) = '},r,c(0,0,0)}
\DoxyCodeLine{4609     \textcolor{keywordflow}{if}(r.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{4610       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn C(1,0,0) = '},r,c(1,0,0)}
\DoxyCodeLine{4611       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn C(0,1,0) = '},r,c(0,1,0)}
\DoxyCodeLine{4612       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn C(0,0,1) = '},r,c(0,0,1)}
\DoxyCodeLine{4613 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4614     \textcolor{keywordflow}{if}(r.gt.2.and.rmax.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{4615       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn C(0,2,0) = '},r,c(0,2,0)}
\DoxyCodeLine{4616 \textcolor{comment}{!      write(*,*) 'CalcCgn C(0,1,1) = ',r,C(0,1,1)}}
\DoxyCodeLine{4617       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn C(0,0,2) = '},r,c(0,0,2)}
\DoxyCodeLine{4618 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4619     \textcolor{keywordflow}{if}(r.gt.3.and.rmax.ge.3)\textcolor{keywordflow}{then}}
\DoxyCodeLine{4620       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn C(1,0,1) = '},r,c(1,0,1)}
\DoxyCodeLine{4621       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn C(1,1,0) = '},r,c(1,1,0)}
\DoxyCodeLine{4622       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn C(1,0,1) = '},r,c(1,0,1)}
\DoxyCodeLine{4623 \textcolor{comment}{!      write(*,*) 'CalcCgn C(1,2,0) = ',r,C(1,2,0)}}
\DoxyCodeLine{4624       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn C(0,3,0) = '},r,c(0,3,0)}
\DoxyCodeLine{4625       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn C(0,2,1) = '},r,c(0,2,1)}
\DoxyCodeLine{4626       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn C(0,0,3) = '},r,c(0,0,3)}
\DoxyCodeLine{4627 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{4628       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn Cij\_err'},r,cij\_err}
\DoxyCodeLine{4629       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn Cij\_acc'},r,cij\_err/abs(c(0,0,0))}
\DoxyCodeLine{4630 }
\DoxyCodeLine{4631       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn err'},r,cerr}
\DoxyCodeLine{4632       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn acc'},r,cerr/abs(c(0,0,0))}
\DoxyCodeLine{4633 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4634 \textcolor{preprocessor}{}}
\DoxyCodeLine{4635       cerr2 = max(cerr,cij\_err2(0:rmax))}
\DoxyCodeLine{4636       cerr = max(cerr,cij\_err(0:rmax))}
\DoxyCodeLine{4637 }
\DoxyCodeLine{4638 \textcolor{preprocessor}{\#ifdef Cgntest}}
\DoxyCodeLine{4639 \textcolor{preprocessor}{}\textcolor{comment}{!      write(*,*) 'CalcCgn exit r',r,maxval(Cerr),acc\_req\_C*abs(C(0,0,0))}}
\DoxyCodeLine{4640 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4641 \textcolor{preprocessor}{}}
\DoxyCodeLine{4642 \textcolor{comment}{!      if(maxval(Cerr).le.acc\_req\_C*abs(C(0,0,0))) exit       ! changed 28.01.15}}
\DoxyCodeLine{4643       \textcolor{comment}{! check if target precision already reached}}
\DoxyCodeLine{4644 \textcolor{preprocessor}{\#ifdef Cutrloop}}
\DoxyCodeLine{4645 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(cerr-\/acc\_req\_cr*abs(c(0,0,0))).le.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4646         \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{4647 }
\DoxyCodeLine{4648 \textcolor{comment}{!          write(*,*) 'CalcCgn exit rloop  =',rg,r,rmax}}
\DoxyCodeLine{4649 }
\DoxyCodeLine{4650           \textcolor{keywordflow}{do} n0=0,rg/2}
\DoxyCodeLine{4651             \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{4652               c(n0,n1,rg-\/2*n0-\/n1)=0d0}
\DoxyCodeLine{4653 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{4654 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4655 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4656         \textcolor{keywordflow}{if}(r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4657           \textcolor{keywordflow}{do} n1=0,r}
\DoxyCodeLine{4658             c(0,n1,r-\/n1)=0d0}
\DoxyCodeLine{4659 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{4660 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{4661 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{4662 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(cerr-\/acc\_req\_cr*abs(c(0,0,0))).le.0d0.and.r.gt.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{4663 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4664 \textcolor{preprocessor}{}       \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{4665 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{4666 }
\DoxyCodeLine{4667 \textcolor{keywordflow}{    end do} rloop}
\DoxyCodeLine{4668 }
\DoxyCodeLine{4669       \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2=r, n0>0 }}
\DoxyCodeLine{4670     \textcolor{keywordflow}{do} r=rmax+1,2*rmax}
\DoxyCodeLine{4671       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{4672         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{4673           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{4674           c(n0,n1,n2) = (b\_0(n0-\/1,n1,n2) + 2*mm02*c(n0-\/1,n1,n2) + 4*cuv(n0,n1,n2) \&}
\DoxyCodeLine{4675                         + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)*c(n0-\/1,n1+1,n2) + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)*c(n0-\/1,n1,n2+1)) / (2*r)}
\DoxyCodeLine{4676 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4677 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4678 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{4679 }
\DoxyCodeLine{4680 }
\DoxyCodeLine{4681 \textcolor{preprocessor}{\#ifdef Cgntest}}
\DoxyCodeLine{4682 \textcolor{preprocessor}{}\textcolor{comment}{!    write(*,*) 'CalcCgn C(0,0,0,0) = ',C(0,0,0)}}
\DoxyCodeLine{4683 \textcolor{comment}{!    if(rmax.ge.3)then}}
\DoxyCodeLine{4684 \textcolor{comment}{!      write(*,*) 'CalcCgn C(0,1,1,1) = ',C(0,1,1)}}
\DoxyCodeLine{4685 \textcolor{comment}{!    end if}}
\DoxyCodeLine{4686 }
\DoxyCodeLine{4687     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn final err'},cerr}
\DoxyCodeLine{4688     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn final acc'},cerr/abs(c(0,0,0))}
\DoxyCodeLine{4689 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{4690 \textcolor{preprocessor}{}                           }
\DoxyCodeLine{4691 \textcolor{comment}{!   write(*,*) 'CalcCgn out',(((C((r-\/n1-\/n2)/2,n1,n2),n2=0,r-\/n1),n1=0,r),r=0,rmax)}}
\DoxyCodeLine{4692 \textcolor{preprocessor}{\#ifdef TRACECout}}
\DoxyCodeLine{4693 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn rmax'},rmax}
\DoxyCodeLine{4694     \textcolor{keywordflow}{do} r=14,rmax}
\DoxyCodeLine{4695     \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{4696     \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{4697     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgn out'},r,n0,n1,r-\/2*n0-\/n1,c(n0,n1,r-\/2*n0-\/n1)}
\DoxyCodeLine{4698 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{4699 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{4700 \textcolor{keywordflow}{    end do}   }
\DoxyCodeLine{4701 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4702 \textcolor{preprocessor}{}}
\DoxyCodeLine{4703 \textcolor{comment}{!    write(*,*) 'CalcCgn Cerr ',Cerr}}
\DoxyCodeLine{4704 \textcolor{comment}{!    write(*,*) 'CalcCgn Cerr2',Cerr2}}
\DoxyCodeLine{4705 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductionc_ae0f83cbcfecb7a8d633d6b45c6686f29}\label{namespacereductionc_ae0f83cbcfecb7a8d633d6b45c6686f29}} 
\index{reductionc@{reductionc}!calccgp@{calccgp}}
\index{calccgp@{calccgp}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{calccgp()}{calccgp()}}
{\footnotesize\ttfamily subroutine reductionc\+::calccgp (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{C,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Cuv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{ordgp\+\_\+min,  }\item[{integer, intent(in)}]{ordgp\+\_\+max,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr,  }\item[{double precision, dimension(0\+:rmax), intent(in)}]{acc\+\_\+req\+\_\+\+Cr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr2 }\end{DoxyParamCaption})}



Definition at line 7274 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{7274   }
\DoxyCodeLine{7275     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobalc}{globalc}}}
\DoxyCodeLine{7276   }
\DoxyCodeLine{7277     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,ordgp\_min,ordgp\_max,id}
\DoxyCodeLine{7278     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{7279     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: C(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{7280     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Cuv(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{7281     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Cerr(0:rmax),Cerr2(0:rmax)}
\DoxyCodeLine{7282     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(in)} :: acc\_req\_Cr(0:rmax)}
\DoxyCodeLine{7283     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Cexpgp(:,:,:,:), CuvExpgp(:,:,:)}
\DoxyCodeLine{7284     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: B\_0(:,:,:), B\_k(:,:), Shat(:,:,:)}
\DoxyCodeLine{7285     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Buv\_0(:,:,:), Buv\_k(:,:)}
\DoxyCodeLine{7286     \textcolor{keywordtype}{double complex} :: Smod, fk, elimminf2\_coli}
\DoxyCodeLine{7287     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err(:),Cij\_err(:)}
\DoxyCodeLine{7288     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{7289     \textcolor{keywordtype}{double precision} :: B\_err,B\_max}
\DoxyCodeLine{7290     \textcolor{keywordtype}{double precision} :: maxCexpgp(0:1,0:rmax+ordgp\_min+1,0:ordgp\_max),truncfacexp}
\DoxyCodeLine{7291     \textcolor{keywordtype}{integer} :: rmaxB,rmaxExp,gtrunc,r,n0,n1,n2,k,l,g,rg}
\DoxyCodeLine{7292     \textcolor{keywordtype}{integer} :: bin,nid(0:2),i}
\DoxyCodeLine{7293  }
\DoxyCodeLine{7294 \textcolor{preprocessor}{\#ifdef Cgptest}}
\DoxyCodeLine{7295 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp in '},rmax,ordgp\_min,ordgp\_max,id}
\DoxyCodeLine{7296 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7297 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifdef TRACECin}}
\DoxyCodeLine{7298 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp in '},rmax,ordgp\_min,ordgp\_max,id}
\DoxyCodeLine{7299 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7300 \textcolor{preprocessor}{}}
\DoxyCodeLine{7301     \textcolor{comment}{! determine Gram matrix}}
\DoxyCodeLine{7302 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{7303 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{7304 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{7305 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{7306 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{7307 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{7308 \textcolor{comment}{!}}
\DoxyCodeLine{7309 \textcolor{comment}{!    q1q2 = (q10+q20-\/q21)}}
\DoxyCodeLine{7310 \textcolor{comment}{! commented out 2.9.17}}
\DoxyCodeLine{7311 \textcolor{comment}{!    Z(1,1) = 2d0*q10}}
\DoxyCodeLine{7312 \textcolor{comment}{!    Z(2,1) = q1q2}}
\DoxyCodeLine{7313 \textcolor{comment}{!    Z(1,2) = q1q2}}
\DoxyCodeLine{7314 \textcolor{comment}{!    Z(2,2) = 2d0*q20}}
\DoxyCodeLine{7315 \textcolor{comment}{!    f(1) = q10+mm02-\/mm12}}
\DoxyCodeLine{7316 \textcolor{comment}{!    f(2) = q20+mm02-\/mm22}}
\DoxyCodeLine{7317 }
\DoxyCodeLine{7318 }
\DoxyCodeLine{7319     \textcolor{comment}{! choose reduction formulas with biggest denominators}}
\DoxyCodeLine{7320     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)).ge.abs(\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7321       k = 1}
\DoxyCodeLine{7322     \textcolor{keywordflow}{else} }
\DoxyCodeLine{7323       k = 2}
\DoxyCodeLine{7324 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7325     fk = \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(k)}
\DoxyCodeLine{7326 }
\DoxyCodeLine{7327 }
\DoxyCodeLine{7328     \textcolor{comment}{! calculations of B-\/coefficients}}
\DoxyCodeLine{7329     rmaxb = rmax + ordgp\_min}
\DoxyCodeLine{7330     \textcolor{keyword}{allocate}(b\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{7331     \textcolor{keyword}{allocate}(buv\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{7332     \textcolor{keyword}{allocate}(b\_k(0:rmaxb,0:rmaxb))}
\DoxyCodeLine{7333     \textcolor{keyword}{allocate}(buv\_k(0:rmaxb,0:rmaxb))}
\DoxyCodeLine{7334 }
\DoxyCodeLine{7335     \textcolor{comment}{! determine binaries for B-\/coefficients}}
\DoxyCodeLine{7336     i=0}
\DoxyCodeLine{7337     bin = 1}
\DoxyCodeLine{7338     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (i.le.2)}
\DoxyCodeLine{7339       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7340         nid(i) = id+bin}
\DoxyCodeLine{7341         i = i+1}
\DoxyCodeLine{7342 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{7343       bin = 2*bin}
\DoxyCodeLine{7344 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7345 }
\DoxyCodeLine{7346     \textcolor{keyword}{call }calcb(b\_0(:,0,:),buv\_0(:,0,:),p21,m12,m22,rmaxb,nid(0))}
\DoxyCodeLine{7347     \textcolor{keywordflow}{if} (k.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7348       \textcolor{keyword}{call }calcb(b\_k(:,:),buv\_k(:,:),p20,m02,m22,rmaxb,nid(1))}
\DoxyCodeLine{7349     \textcolor{keywordflow}{else}}
\DoxyCodeLine{7350       \textcolor{keyword}{call }calcb(b\_k(:,:),buv\_k(:,:),p10,m02,m12,rmaxb,nid(2))}
\DoxyCodeLine{7351 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7352 }
\DoxyCodeLine{7353     \textcolor{comment}{! shift of integration momentum in B\_0}}
\DoxyCodeLine{7354     b\_max=0d0}
\DoxyCodeLine{7355     \textcolor{keywordflow}{do} n1=1,rmaxb}
\DoxyCodeLine{7356       \textcolor{keywordflow}{do} n2=0,rmaxb-\/n1}
\DoxyCodeLine{7357         n0 = (rmaxb-\/n1-\/n2)}
\DoxyCodeLine{7358         b\_0(0:n0,n1,n2) = -\/b\_0(0:n0,n1-\/1,n2)-\/b\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{7359         buv\_0(0:n0,n1,n2) = -\/buv\_0(0:n0,n1-\/1,n2)-\/buv\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{7360         b\_max = max(b\_max,abs(b\_0(0,n1,n2)))}
\DoxyCodeLine{7361 \textcolor{keywordflow}{     end do}}
\DoxyCodeLine{7362 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7363     b\_max = max(b\_max,maxval(abs(b\_k(0,0:rmaxb))))}
\DoxyCodeLine{7364     b\_err = acc\_def\_b*b\_max}
\DoxyCodeLine{7365 }
\DoxyCodeLine{7366 \textcolor{preprocessor}{\#ifdef Cgptest}}
\DoxyCodeLine{7367 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp B\_max '}, b\_max}
\DoxyCodeLine{7368 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7369 \textcolor{preprocessor}{}}
\DoxyCodeLine{7370     \textcolor{comment}{! coefficients Shat defined in (5.13)}}
\DoxyCodeLine{7371     \textcolor{keyword}{allocate}(shat(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{7372 }
\DoxyCodeLine{7373     \textcolor{keywordflow}{do} r=0,rmaxb}
\DoxyCodeLine{7374       \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{7375 }
\DoxyCodeLine{7376         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{7377           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{7378           shat(n0,n1,n2) = -\/b\_0(n0,n1,n2)}
\DoxyCodeLine{7379 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7380 }
\DoxyCodeLine{7381         l = r-\/2*n0}
\DoxyCodeLine{7382         \textcolor{keywordflow}{if} (k.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7383           shat(n0,0,l) = shat(n0,0,l) + b\_k(n0,l)}
\DoxyCodeLine{7384         \textcolor{keywordflow}{else}}
\DoxyCodeLine{7385           shat(n0,l,0) = shat(n0,l,0) + b\_k(n0,l)}
\DoxyCodeLine{7386 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7387 }
\DoxyCodeLine{7388 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7389 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7390 }
\DoxyCodeLine{7391         }
\DoxyCodeLine{7392     \textcolor{comment}{! allocation of array for det(Z)-\/expanded C-\/coefficients}}
\DoxyCodeLine{7393     rmaxexp = rmaxb+1}
\DoxyCodeLine{7394     \textcolor{keyword}{allocate}(cexpgp(0:rmaxexp/2,0:rmaxexp-\/1,0:rmaxexp-\/1,0:ordgp\_max))}
\DoxyCodeLine{7395    }
\DoxyCodeLine{7396 }
\DoxyCodeLine{7397     \textcolor{comment}{! calculate Cuv}}
\DoxyCodeLine{7398     \textcolor{keyword}{allocate}(cuvexpgp(0:rmaxexp,0:rmaxexp,0:rmaxexp))}
\DoxyCodeLine{7399     \textcolor{keyword}{call }calccuv(cuvexpgp,buv\_0,mm02,\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}},rmaxexp,id)}
\DoxyCodeLine{7400     cuv(0:rmax,0:rmax,0:rmax) = cuvexpgp(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{7401 }
\DoxyCodeLine{7402     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{7403     \textcolor{keyword}{allocate}(c00\_err(0:rmaxexp))}
\DoxyCodeLine{7404     \textcolor{keyword}{allocate}(cij\_err(0:rmaxexp))}
\DoxyCodeLine{7405     \textcolor{keyword}{allocate}(c00\_err2(0:rmaxexp))}
\DoxyCodeLine{7406     \textcolor{keyword}{allocate}(cij\_err2(0:rmaxexp))}
\DoxyCodeLine{7407 }
\DoxyCodeLine{7408     \textcolor{comment}{! initialize accuracy estimates}}
\DoxyCodeLine{7409     cerr = acc\_inf}
\DoxyCodeLine{7410     cij\_err =0d0}
\DoxyCodeLine{7411     c00\_err =0d0}
\DoxyCodeLine{7412 }
\DoxyCodeLine{7413     cerr2 = acc\_inf}
\DoxyCodeLine{7414     cij\_err2 =0d0}
\DoxyCodeLine{7415     c00\_err2 =0d0}
\DoxyCodeLine{7416 }
\DoxyCodeLine{7417 \textcolor{comment}{!    maxZ = maxval(abs(Z))}}
\DoxyCodeLine{7418 \textcolor{comment}{!    maxZ = 2d0*q2max}}
\DoxyCodeLine{7419 }
\DoxyCodeLine{7420     \textcolor{comment}{! truncation of expansion if calculated term larger than truncfacexp * previous term}}
\DoxyCodeLine{7421     \textcolor{comment}{! crucial for expansion parameters between 0.1 and 1 !!!}}
\DoxyCodeLine{7422 \textcolor{comment}{!    truncfacexp = sqrt(abs(maxZ/abs(fk))) * truncfacC}}
\DoxyCodeLine{7423     truncfacexp = sqrt(\mbox{\hyperlink{namespaceglobalc_ac6e3d986b3c7aa2041225441a07dddb6}{fac\_gp}}) * truncfacc}
\DoxyCodeLine{7424     gtrunc = ordgp\_max }
\DoxyCodeLine{7425 }
\DoxyCodeLine{7426 \textcolor{preprocessor}{\#ifdef Cgptest}}
\DoxyCodeLine{7427 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp rmaxExp'},rmaxexp,rmax,gtrunc}
\DoxyCodeLine{7428 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7429 \textcolor{preprocessor}{}}
\DoxyCodeLine{7430 \textcolor{comment}{! calculate C(n0,n1,n2) up to rank r for n0>0 and up to rank r-\/1 for n0=0}}
\DoxyCodeLine{7431     rloop: \textcolor{keywordflow}{do} r=1,rmaxexp}
\DoxyCodeLine{7432 }
\DoxyCodeLine{7433 \textcolor{preprocessor}{\#ifdef Cgptest}}
\DoxyCodeLine{7434 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp r'},r,rmax+gtrunc+1}
\DoxyCodeLine{7435 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7436 \textcolor{preprocessor}{}}
\DoxyCodeLine{7437 }
\DoxyCodeLine{7438       \textcolor{keywordflow}{if} (r.gt.rmax+gtrunc+1) \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{7439 }
\DoxyCodeLine{7440       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{7441       \textcolor{comment}{! 0th-\/order coefficients}}
\DoxyCodeLine{7442       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{7443 }
\DoxyCodeLine{7444       \textcolor{comment}{! calculating}}
\DoxyCodeLine{7445       \textcolor{comment}{! C\_00(a)0000..00 -\/-\/> C\_00(a)ij00..00 -\/-\/> C\_00(a)ijkl00..00 -\/-\/> ... -\/-\/> C\_00(a)ijklmn..}}
\DoxyCodeLine{7446       \textcolor{comment}{! exploiting eq. (5.63)}}
\DoxyCodeLine{7447       maxcexpgp(1,r,0)=0d0}
\DoxyCodeLine{7448       \textcolor{keywordflow}{do} n0=r/2,1,-\/1}
\DoxyCodeLine{7449         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{7450           n2=r-\/2*n0-\/n1}
\DoxyCodeLine{7451 }
\DoxyCodeLine{7452           cexpgp(n0,n1,n2,0) = (2d0*cuvexpgp(n0,n1,n2) + b\_0(n0-\/1,n1,n2)  \&}
\DoxyCodeLine{7453                + mm02*cexpgp(n0-\/1,n1,n2,0))/((r-\/n0)+1d0)/2d0}
\DoxyCodeLine{7454 }
\DoxyCodeLine{7455           \textcolor{keywordflow}{if} (n0.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7456             maxcexpgp(1,r,0) =  maxcexpgp(1,r,0) + abs(cexpgp(n0,n1,n2,0) )}
\DoxyCodeLine{7457 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7458 }
\DoxyCodeLine{7459           \textcolor{keywordflow}{if} (r-\/n0.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7460             c(n0,n1,n2) = cexpgp(n0,n1,n2,0)}
\DoxyCodeLine{7461 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7462 }
\DoxyCodeLine{7463 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7464 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7465 }
\DoxyCodeLine{7466       \textcolor{comment}{! calculate}}
\DoxyCodeLine{7467       \textcolor{comment}{! C\_00ijkl.. -\/-\/> C\_aijkl..}}
\DoxyCodeLine{7468       \textcolor{comment}{! exploiting eq. (5.62)}}
\DoxyCodeLine{7469       maxcexpgp(0,r-\/1,0)=0d0}
\DoxyCodeLine{7470       \textcolor{keywordflow}{do} n1=0,r-\/1}
\DoxyCodeLine{7471         n2 = r-\/1-\/n1}
\DoxyCodeLine{7472 }
\DoxyCodeLine{7473         smod = shat(0,n1,n2)}
\DoxyCodeLine{7474         \textcolor{keywordflow}{if} ((k.eq.1).and.(n1.ge.1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7475           smod = smod -\/ 2d0*n1*cexpgp(1,n1-\/1,n2,0)}
\DoxyCodeLine{7476         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((k.eq.2).and.(n2.ge.1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7477           smod = smod -\/ 2d0*n2*cexpgp(1,n1,n2-\/1,0)}
\DoxyCodeLine{7478 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7479 }
\DoxyCodeLine{7480         cexpgp(0,n1,n2,0) = smod/fk}
\DoxyCodeLine{7481         maxcexpgp(0,r-\/1,0) =  maxcexpgp(0,r-\/1,0) + abs(cexpgp(0,n1,n2,0))}
\DoxyCodeLine{7482         }
\DoxyCodeLine{7483         \textcolor{keywordflow}{if} (r.le.rmax+1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7484           c(0,n1,n2) = cexpgp(0,n1,n2,0)}
\DoxyCodeLine{7485 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7486 }
\DoxyCodeLine{7487 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7488 }
\DoxyCodeLine{7489       \textcolor{keywordflow}{if} (r.le.rmax+1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7490 \textcolor{comment}{!       Cerr(r-\/1) =  abs(maxZ/fk)*maxCexpgp(0,r-\/1,0)}}
\DoxyCodeLine{7491         cerr(r-\/1) =  \mbox{\hyperlink{namespaceglobalc_ac6e3d986b3c7aa2041225441a07dddb6}{fac\_gp}}*maxcexpgp(0,r-\/1,0)}
\DoxyCodeLine{7492 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{7493 }
\DoxyCodeLine{7494       \textcolor{comment}{! error propagation from B's}}
\DoxyCodeLine{7495       \textcolor{keywordflow}{if}(r.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{7496         c00\_err(r) = b\_err/(2*r)}
\DoxyCodeLine{7497 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{7498       cij\_err(r-\/1) = b\_err/abs(fk)}
\DoxyCodeLine{7499 }
\DoxyCodeLine{7500       \textcolor{keywordflow}{if}(r.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{7501         c00\_err2(r) = b\_err/(2*r)}
\DoxyCodeLine{7502 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{7503       cij\_err2(r-\/1) = b\_err/abs(fk)}
\DoxyCodeLine{7504 }
\DoxyCodeLine{7505 \textcolor{preprocessor}{\#ifdef Cgptest}}
\DoxyCodeLine{7506 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp B\_err'},b\_err,abs(fk), cij\_err(r-\/1),r}
\DoxyCodeLine{7507 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7508 \textcolor{preprocessor}{}}
\DoxyCodeLine{7509       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{7510       \textcolor{comment}{! higher order coefficients}}
\DoxyCodeLine{7511       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{7512 }
\DoxyCodeLine{7513       rg = r}
\DoxyCodeLine{7514       gloop: \textcolor{keywordflow}{do} g=1,min(gtrunc,r-\/1)}
\DoxyCodeLine{7515         rg = rg-\/1}
\DoxyCodeLine{7516 }
\DoxyCodeLine{7517         \textcolor{comment}{! calculating for rank=rmaxB+1}}
\DoxyCodeLine{7518         \textcolor{comment}{! C\_00(a)0000..00 -\/-\/> C\_00(a)ij00..00 -\/-\/> C\_00(a)ijkl00..00 -\/-\/> ... -\/-\/> C\_00(a)ijklmn..}}
\DoxyCodeLine{7519         \textcolor{comment}{! exploiting eq. (5.63)}}
\DoxyCodeLine{7520         maxcexpgp(1,rg,g) = 0d0}
\DoxyCodeLine{7521         \textcolor{keywordflow}{do} n0=rg/2,1,-\/1}
\DoxyCodeLine{7522           \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{7523             n2=rg-\/2*n0-\/n1}
\DoxyCodeLine{7524 }
\DoxyCodeLine{7525             cexpgp(n0,n1,n2,g) = (2d0*mm02*cexpgp(n0-\/1,n1,n2,g)  \&}
\DoxyCodeLine{7526                -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)*cexpgp(n0-\/1,n1+2,n2,g-\/1) -\/ 2d0*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)*cexpgp(n0-\/1,n1+1,n2+1,g-\/1)  \&}
\DoxyCodeLine{7527                -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)*cexpgp(n0-\/1,n1,n2+2,g-\/1))/((rg-\/n0)+1d0)/4d0}
\DoxyCodeLine{7528 }
\DoxyCodeLine{7529             \textcolor{keywordflow}{if}(n0.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7530               maxcexpgp(1,rg,g) =  maxcexpgp(1,rg,g) + abs(cexpgp(n0,n1,n2,g))}
\DoxyCodeLine{7531               }
\DoxyCodeLine{7532 }
\DoxyCodeLine{7533               \textcolor{keywordflow}{if} (g.eq.1.and.abs(cexpgp(1,n1,n2,g)).gt.          \&}
\DoxyCodeLine{7534                   truncfacexp*max(1d0,maxcexpgp(1,rg,g-\/1)) .or.  \&}
\DoxyCodeLine{7535                   g.ge.2.and.abs(cexpgp(1,n1,n2,g)).gt.          \&}
\DoxyCodeLine{7536                   truncfacexp*maxcexpgp(1,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7537 }
\DoxyCodeLine{7538 \textcolor{preprocessor}{\#ifdef Cgptest}}
\DoxyCodeLine{7539 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCg exit rloop'},n0,n1,n2,g,abs(cexpgp(n0,n1,n2,g)),maxcexpgp(1,rg,g-\/1)}
\DoxyCodeLine{7540 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7541 \textcolor{preprocessor}{}}
\DoxyCodeLine{7542                 gtrunc = g-\/1}
\DoxyCodeLine{7543                 \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{7544 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{7545 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{7546 }
\DoxyCodeLine{7547 \textcolor{comment}{!            if ((g.ge.2).and.(abs(Cexpgp(n0,n1,n2,g)).gt.truncfacexp*abs(Cexpgp(n0,n1,n2,g-\/1)))) then}}
\DoxyCodeLine{7548 \textcolor{comment}{!              gtrunc = g-\/1}}
\DoxyCodeLine{7549 \textcolor{comment}{!            end if}}
\DoxyCodeLine{7550 }
\DoxyCodeLine{7551 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{7552 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7553 }
\DoxyCodeLine{7554 \textcolor{preprocessor}{\#ifndef PPEXP00}}
\DoxyCodeLine{7555 \textcolor{preprocessor}{}        \textcolor{keywordflow}{do} n0=rg/2,1,-\/1}
\DoxyCodeLine{7556           \textcolor{keywordflow}{if} (rg-\/n0.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7557             \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{7558               n2=rg-\/2*n0-\/n1}
\DoxyCodeLine{7559               c(n0,n1,n2) = c(n0,n1,n2) + cexpgp(n0,n1,n2,g)}
\DoxyCodeLine{7560 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{7561 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7562 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7563 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7564 \textcolor{preprocessor}{}}
\DoxyCodeLine{7565         \textcolor{comment}{! calculate}}
\DoxyCodeLine{7566         \textcolor{comment}{! C\_000000..00 -\/-\/> C\_i0000..00 -\/-\/> C\_ij00..00 -\/-\/> ... -\/-\/> C\_ijk..}}
\DoxyCodeLine{7567         \textcolor{comment}{! exploiting eq. (5.62)}}
\DoxyCodeLine{7568         maxcexpgp(0,rg-\/1,g) = 0d0}
\DoxyCodeLine{7569         \textcolor{keywordflow}{do} n1=0,rg-\/1}
\DoxyCodeLine{7570           n2 = rg-\/1-\/n1}
\DoxyCodeLine{7571           }
\DoxyCodeLine{7572           smod = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,k)*cexpgp(0,n1+1,n2,g-\/1)  \&}
\DoxyCodeLine{7573               -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,k)*cexpgp(0,n1,n2+1,g-\/1)}
\DoxyCodeLine{7574           \textcolor{keywordflow}{if} ((k.eq.1).and.(n1.ge.1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7575             smod = smod -\/ 2d0*n1*cexpgp(1,n1-\/1,n2,g)}
\DoxyCodeLine{7576           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((k.eq.2).and.(n2.ge.1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7577             smod = smod -\/ 2d0*n2*cexpgp(1,n1,n2-\/1,g)}
\DoxyCodeLine{7578 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7579           }
\DoxyCodeLine{7580           cexpgp(0,n1,n2,g) = smod/fk}
\DoxyCodeLine{7581           }
\DoxyCodeLine{7582           maxcexpgp(0,rg-\/1,g) =  maxcexpgp(0,rg-\/1,g) + abs(cexpgp(0,n1,n2,g))}
\DoxyCodeLine{7583           }
\DoxyCodeLine{7584           \textcolor{keywordflow}{if} (g.eq.1.and.abs(cexpgp(0,n1,n2,g)).gt.                     \&}
\DoxyCodeLine{7585               truncfacexp*max(1/\mbox{\hyperlink{namespaceglobalc_a45c0f5c169a73fb12286352743b5a557}{m2max}},maxcexpgp(0,rg-\/1,g-\/1))    .or.    \&}
\DoxyCodeLine{7586               g.ge.2.and.abs(cexpgp(0,n1,n2,g)).gt.                     \&}
\DoxyCodeLine{7587               truncfacexp*maxcexpgp(0,rg-\/1,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7588 }
\DoxyCodeLine{7589 \textcolor{preprocessor}{\#ifdef Cgptest}}
\DoxyCodeLine{7590 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp exit gloop'},0,n1,n2,g,abs(cexpgp(0,n1,n2,g)),maxcexpgp(0,rg,g-\/1)}
\DoxyCodeLine{7591 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7592 \textcolor{preprocessor}{}            gtrunc = g-\/1}
\DoxyCodeLine{7593             \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{7594 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7595           }
\DoxyCodeLine{7596 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7597 }
\DoxyCodeLine{7598         \textcolor{comment}{! error propagation from B's}}
\DoxyCodeLine{7599         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{7600           c00\_err(rg) = max(c00\_err(rg),max(2*abs(m02)*cij\_err(rg-\/2),\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*cij\_err(rg))/(4*r) )}
\DoxyCodeLine{7601 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7602         cij\_err(rg-\/1) = max(cij\_err(rg-\/1),max(2*c00\_err(rg),\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*cij\_err(rg))/abs(fk) )}
\DoxyCodeLine{7603 }
\DoxyCodeLine{7604         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{7605           c00\_err2(rg) = max(c00\_err2(rg),max(2*abs(m02)*cij\_err2(rg-\/2),\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*cij\_err2(rg))/(4*r) )}
\DoxyCodeLine{7606 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7607         cij\_err2(rg-\/1) = max(cij\_err2(rg-\/1),max(2*c00\_err2(rg),\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*cij\_err2(rg))/abs(fk) )}
\DoxyCodeLine{7608 }
\DoxyCodeLine{7609 \textcolor{preprocessor}{\#ifdef PPEXP00}}
\DoxyCodeLine{7610 \textcolor{preprocessor}{}        \textcolor{keywordflow}{do} n0=rg/2,1,-\/1}
\DoxyCodeLine{7611           \textcolor{keywordflow}{if} (rg-\/n0.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7612             \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{7613               n2=rg-\/2*n0-\/n1}
\DoxyCodeLine{7614               c(n0,n1,n2) = c(n0,n1,n2) + cexpgp(n0,n1,n2,g)}
\DoxyCodeLine{7615 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{7616 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7617 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7618 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7619 \textcolor{preprocessor}{}}
\DoxyCodeLine{7620         \textcolor{keywordflow}{if} ((rg.le.rmax+1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7621           cerr(rg-\/1) = 0d0}
\DoxyCodeLine{7622           \textcolor{keywordflow}{do} n1=0,rg-\/1}
\DoxyCodeLine{7623             n2=rg-\/1-\/n1}
\DoxyCodeLine{7624             c(0,n1,n2) = c(0,n1,n2) + cexpgp(0,n1,n2,g)}
\DoxyCodeLine{7625 \textcolor{comment}{!            Cerr(rg-\/1)=max(Cerr(rg-\/1),abs(Cexpgp(0,n1,n2,g))**2/abs(Cexpgp(0,n1,n2,g-\/1)))}}
\DoxyCodeLine{7626             \textcolor{keywordflow}{if}(abs(cexpgp(0,n1,n2,g-\/1)).ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7627               cerr(rg-\/1)=max(cerr(rg-\/1),abs(cexpgp(0,n1,n2,g))*min(1d0,abs(cexpgp(0,n1,n2,g))/abs(cexpgp(0,n1,n2,g-\/1))))}
\DoxyCodeLine{7628             \textcolor{keywordflow}{else}}
\DoxyCodeLine{7629               cerr(rg-\/1)=max(cerr(rg-\/1),abs(cexpgp(0,n1,n2,g)))}
\DoxyCodeLine{7630 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{7631 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{7632 }
\DoxyCodeLine{7633           \textcolor{comment}{! if error from B's larger than error from expansion stop expansion}}
\DoxyCodeLine{7634           \textcolor{keywordflow}{if}(cij\_err(rg-\/1).gt.cerr(rg-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7635              gtrunc = min(g,gtrunc)}
\DoxyCodeLine{7636              }
\DoxyCodeLine{7637 \textcolor{preprocessor}{\#ifdef Cgptest}}
\DoxyCodeLine{7638 \textcolor{preprocessor}{}             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp exit err'},r,g,gtrunc}
\DoxyCodeLine{7639 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7640 \textcolor{preprocessor}{}}
\DoxyCodeLine{7641 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7642 }
\DoxyCodeLine{7643 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7644 }
\DoxyCodeLine{7645 \textcolor{keywordflow}{      end do} gloop}
\DoxyCodeLine{7646 }
\DoxyCodeLine{7647 \textcolor{preprocessor}{\#ifdef Cgptest}}
\DoxyCodeLine{7648 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp Cerr r ='},r,cerr}
\DoxyCodeLine{7649       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp Cacc r ='},r,cerr/abs(c(0,0,0))}
\DoxyCodeLine{7650       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp Cij\_err ='},r,cij\_err}
\DoxyCodeLine{7651 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7652 \textcolor{preprocessor}{}}
\DoxyCodeLine{7653       cerr2 = max(cerr,cij\_err2(0:rmax))}
\DoxyCodeLine{7654       cerr = max(cerr,cij\_err(0:rmax))}
\DoxyCodeLine{7655       }
\DoxyCodeLine{7656 \textcolor{preprocessor}{\#ifdef Cgptest}}
\DoxyCodeLine{7657 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp Cerr ='},r,cerr,maxval(cerr)}
\DoxyCodeLine{7658       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp accr ='},r,acc\_req\_cr*abs(c(0,0,0)),maxval(acc\_req\_cr*abs(c(0,0,0)))}
\DoxyCodeLine{7659       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp C-\/ar ='},r,cerr-\/acc\_req\_cr*abs(c(0,0,0)),maxval(cerr-\/acc\_req\_cr*abs(c(0,0,0)))}
\DoxyCodeLine{7660 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7661 \textcolor{preprocessor}{}}
\DoxyCodeLine{7662       \textcolor{comment}{! check if target precision already reached}}
\DoxyCodeLine{7663 \textcolor{comment}{!      if(maxval(Cerr-\/acc\_req\_Cr*abs(C(0,0,0))).le.0d0) exit    ! changed 28.01.15}}
\DoxyCodeLine{7664 \textcolor{preprocessor}{\#ifdef Cutrloop}}
\DoxyCodeLine{7665 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(cerr-\/acc\_req\_cr*abs(c(0,0,0))).le.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7666         \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{7667           \textcolor{keywordflow}{do} n0=0,rg/2}
\DoxyCodeLine{7668             \textcolor{keywordflow}{do} n1=0,rg-\/2*n0}
\DoxyCodeLine{7669               c(n0,n1,rg-\/2*n0-\/n1)=0d0}
\DoxyCodeLine{7670 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{7671 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{7672 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7673         \textcolor{keywordflow}{if}(r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7674           \textcolor{keywordflow}{do} n1=0,r}
\DoxyCodeLine{7675             c(0,n1,r-\/n1)=0d0}
\DoxyCodeLine{7676 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{7677 \textcolor{keywordflow}{        end if}   }
\DoxyCodeLine{7678 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{7679 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(cerr-\/acc\_req\_cr*abs(c(0,0,0))).le.0d0.and.r.gt.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7680 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7681 \textcolor{preprocessor}{}\textcolor{comment}{!       write(*,*) 'CalcCg exit rloop  =',r,rmax,rg}}
\DoxyCodeLine{7682 }
\DoxyCodeLine{7683         \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{7684 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{7685 }
\DoxyCodeLine{7686 \textcolor{comment}{!      write(*,*) 'CalcCgp after exit'}}
\DoxyCodeLine{7687 }
\DoxyCodeLine{7688 \textcolor{keywordflow}{    end do} rloop}
\DoxyCodeLine{7689 }
\DoxyCodeLine{7690       \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2=r, n0>0 }}
\DoxyCodeLine{7691     \textcolor{keywordflow}{do} r=rmax+1,2*rmax}
\DoxyCodeLine{7692       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{7693         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{7694           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{7695           c(n0,n1,n2) = (b\_0(n0-\/1,n1,n2) + 2*mm02*c(n0-\/1,n1,n2) + 4*cuv(n0,n1,n2) \&}
\DoxyCodeLine{7696                         + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)*c(n0-\/1,n1+1,n2) + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)*c(n0-\/1,n1,n2+1)) / (2*r)}
\DoxyCodeLine{7697 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7698 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7699 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7700 }
\DoxyCodeLine{7701 \textcolor{preprocessor}{\#ifdef Cgptest}}
\DoxyCodeLine{7702 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp final err'},cerr}
\DoxyCodeLine{7703     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp final acc'},cerr/abs(c(0,0,0))}
\DoxyCodeLine{7704 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7705 \textcolor{preprocessor}{}              }
\DoxyCodeLine{7706 \textcolor{preprocessor}{\#ifdef TRACECout}}
\DoxyCodeLine{7707 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp rmax'},rmax}
\DoxyCodeLine{7708     \textcolor{keywordflow}{do} r=14,rmax}
\DoxyCodeLine{7709     \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{7710     \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{7711     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgp out'},r,n0,n1,r-\/2*n0-\/n1,c(n0,n1,r-\/2*n0-\/n1)}
\DoxyCodeLine{7712 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7713 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7714 \textcolor{keywordflow}{    end do}   }
\DoxyCodeLine{7715 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7716 \textcolor{preprocessor}{}}
\DoxyCodeLine{7717 \textcolor{comment}{!   write(*,*) 'CalcCgp rmax',rmax}}
\DoxyCodeLine{7718 \textcolor{comment}{!   do r=14,rmax}}
\DoxyCodeLine{7719 \textcolor{comment}{!    do r=0,rmax}}
\DoxyCodeLine{7720 \textcolor{comment}{!   do n0=0,r/2}}
\DoxyCodeLine{7721 \textcolor{comment}{!   do n1=0,r-\/2*n0}}
\DoxyCodeLine{7722 \textcolor{comment}{!   write(*,*) 'CalcCgp out',r,n0,n1,r-\/2*n0-\/n1,C(n0,n1,r-\/2*n0-\/n1)}}
\DoxyCodeLine{7723 \textcolor{comment}{!   end do}}
\DoxyCodeLine{7724 \textcolor{comment}{!   end do}}
\DoxyCodeLine{7725 \textcolor{comment}{!   end do}}
\DoxyCodeLine{7726 }
\DoxyCodeLine{7727 \textcolor{comment}{!    write(*,*) 'CalcCgp Cerr ',Cerr}}
\DoxyCodeLine{7728 \textcolor{comment}{!    write(*,*) 'CalcCgp Cerr2',Cerr2}}
\DoxyCodeLine{7729 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductionc_a538f357262f51f0c6e2521677fd14586}\label{namespacereductionc_a538f357262f51f0c6e2521677fd14586}} 
\index{reductionc@{reductionc}!calccgpf@{calccgpf}}
\index{calccgpf@{calccgpf}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{calccgpf()}{calccgpf()}}
{\footnotesize\ttfamily subroutine reductionc\+::calccgpf (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{C,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Cuv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{ordgpf\+\_\+min,  }\item[{integer, intent(in)}]{ordgpf\+\_\+max,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr,  }\item[{double precision, dimension(0\+:rmax), intent(in)}]{acc\+\_\+req\+\_\+\+Cr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr2 }\end{DoxyParamCaption})}



Definition at line 7741 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{7741   }
\DoxyCodeLine{7742     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobalc}{globalc}}}
\DoxyCodeLine{7743   }
\DoxyCodeLine{7744     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,ordgpf\_min,ordgpf\_max,id}
\DoxyCodeLine{7745     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{7746     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: C(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{7747     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Cuv(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{7748     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Cerr(0:rmax),Cerr2(0:rmax)}
\DoxyCodeLine{7749     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(in)} :: acc\_req\_Cr(0:rmax)}
\DoxyCodeLine{7750     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Cexpgpf(:,:,:,:), CuvExpgpf(:,:,:)}
\DoxyCodeLine{7751     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: B\_0(:,:,:), B\_i(:,:,:), Shat(:,:,:,:)}
\DoxyCodeLine{7752     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Buv\_0(:,:,:), Buv\_i(:,:,:)}
\DoxyCodeLine{7753     \textcolor{keywordtype}{double complex} :: Smod, Caux, Zadj2f}
\DoxyCodeLine{7754     \textcolor{keywordtype}{double complex} :: C0\_coli, elimminf2\_coli}
\DoxyCodeLine{7755     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err(:),Cij\_err(:)}
\DoxyCodeLine{7756     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{7757     \textcolor{keywordtype}{double precision} :: B\_err,B\_max,aZadj2f}
\DoxyCodeLine{7758     \textcolor{keywordtype}{double precision} :: maxCexpgpf(0:1,0:rmax+2*ordgpf\_min,0:ordgpf\_max),truncfacexp}
\DoxyCodeLine{7759     \textcolor{keywordtype}{double precision} :: minZk }
\DoxyCodeLine{7760     \textcolor{keywordtype}{integer} :: rmaxB,rmaxExp,gtrunc,r,n0,n1,n2,i,j,jt,g,rg}
\DoxyCodeLine{7761     \textcolor{keywordtype}{integer} :: inds0(2),inds(2),k,l,lt,nl,nlt}
\DoxyCodeLine{7762     \textcolor{keywordtype}{integer} :: bin,nid(0:2)}
\DoxyCodeLine{7763 }
\DoxyCodeLine{7764 \textcolor{preprocessor}{\#ifdef Cgpftest}}
\DoxyCodeLine{7765 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf in '},rmax,ordgpf\_min,ordgpf\_max,id}
\DoxyCodeLine{7766     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf in '},p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{7767 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7768 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifdef TRACECin}}
\DoxyCodeLine{7769 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf in '},rmax,ordgpf\_min,ordgpf\_max,id}
\DoxyCodeLine{7770 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7771 \textcolor{preprocessor}{}}
\DoxyCodeLine{7772     \textcolor{comment}{! write(*,*) 'LH: CalcCgpf, ord', ordgpf\_min}}
\DoxyCodeLine{7773     \textcolor{comment}{! calculation of B-\/coefficients}}
\DoxyCodeLine{7774     rmaxb = rmax + 2*ordgpf\_min + 1}
\DoxyCodeLine{7775     \textcolor{keyword}{allocate}(b\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{7776     \textcolor{keyword}{allocate}(buv\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{7777     \textcolor{keyword}{allocate}(b\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{7778     \textcolor{keyword}{allocate}(buv\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{7779 }
\DoxyCodeLine{7780     \textcolor{comment}{! determine binaries for B-\/coefficients}}
\DoxyCodeLine{7781     k=0}
\DoxyCodeLine{7782     bin = 1}
\DoxyCodeLine{7783     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.2)}
\DoxyCodeLine{7784       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7785         nid(k) = id+bin}
\DoxyCodeLine{7786         k = k+1}
\DoxyCodeLine{7787 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{7788       bin = 2*bin}
\DoxyCodeLine{7789 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7790 }
\DoxyCodeLine{7791     \textcolor{keyword}{call }calcb(b\_0(:,0,:),buv\_0(:,0,:),p21,m12,m22,rmaxb,nid(0))}
\DoxyCodeLine{7792     \textcolor{keyword}{call }calcb(b\_i(:,:,1),buv\_i(:,:,1),p20,m02,m22,rmaxb,nid(1))}
\DoxyCodeLine{7793     \textcolor{keyword}{call }calcb(b\_i(:,:,2),buv\_i(:,:,2),p10,m02,m12,rmaxb,nid(2))}
\DoxyCodeLine{7794 }
\DoxyCodeLine{7795    \textcolor{comment}{! shift of integration momentum in B\_0}}
\DoxyCodeLine{7796     b\_max=0d0}
\DoxyCodeLine{7797     \textcolor{keywordflow}{do} n1=1,rmaxb}
\DoxyCodeLine{7798       \textcolor{keywordflow}{do} n2=0,rmaxb-\/n1}
\DoxyCodeLine{7799         n0 = (rmaxb-\/n1-\/n2)}
\DoxyCodeLine{7800         b\_0(0:n0,n1,n2) = -\/b\_0(0:n0,n1-\/1,n2)-\/b\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{7801         buv\_0(0:n0,n1,n2) = -\/buv\_0(0:n0,n1-\/1,n2)-\/buv\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{7802 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7803 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7804     b\_max = max(b\_max,maxval(abs(b\_i(0,0:rmaxb,1:2))))}
\DoxyCodeLine{7805     b\_err = acc\_def\_b*b\_max}
\DoxyCodeLine{7806 }
\DoxyCodeLine{7807     \textcolor{comment}{! determine (adjugated) Gram and Cayley matrix}}
\DoxyCodeLine{7808 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{7809 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{7810 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{7811 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{7812 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{7813 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{7814 \textcolor{comment}{!}}
\DoxyCodeLine{7815 \textcolor{comment}{!    q1q2 = (q10+q20-\/q21)}}
\DoxyCodeLine{7816 \textcolor{comment}{!    detZ = 4d0*q10*q20-\/q1q2*q1q2}}
\DoxyCodeLine{7817 }
\DoxyCodeLine{7818     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}).lt.abs(4d0*\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}*\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}} + \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1))*1d-\/4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7819       \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}-\/\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}).lt.abs(\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}-\/\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}).and.  \&}
\DoxyCodeLine{7820           abs(\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}-\/\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}).lt.abs(\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}-\/\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}})) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7821         \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}  =  4d0*\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}*\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}} -\/ (\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}-\/\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}+\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}})*(\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}-\/\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}+\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}})}
\DoxyCodeLine{7822 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{7823 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7824 }
\DoxyCodeLine{7825 \textcolor{comment}{!    Zadj(1,1) = 2d0*q20}}
\DoxyCodeLine{7826 \textcolor{comment}{!    Zadj(2,1) = -\/q1q2}}
\DoxyCodeLine{7827 \textcolor{comment}{!    Zadj(1,2) = -\/q1q2}}
\DoxyCodeLine{7828 \textcolor{comment}{!    Zadj(2,2) = 2d0*q10}}
\DoxyCodeLine{7829 \textcolor{comment}{!    f(1) = q10+mm02-\/mm12}}
\DoxyCodeLine{7830 \textcolor{comment}{!    f(2) = q20+mm02-\/mm22}}
\DoxyCodeLine{7831 \textcolor{comment}{!}}
\DoxyCodeLine{7832 \textcolor{comment}{!    Zadjf(1) = Zadj(1,1)*f(1)+Zadj(2,1)*f(2)}}
\DoxyCodeLine{7833 \textcolor{comment}{!    Zadjf(2) = Zadj(1,2)*f(1)+Zadj(2,2)*f(2)}}
\DoxyCodeLine{7834 \textcolor{comment}{!}}
\DoxyCodeLine{7835 \textcolor{comment}{! Xadj(1,1) and Xadj(2,2) exchanged!!!}}
\DoxyCodeLine{7836 \textcolor{comment}{!    Xadj(1,1) = 2d0*mm02*Z(1,1) -\/ f(1)*f(1)}}
\DoxyCodeLine{7837 \textcolor{comment}{!    Xadj(2,1) = 2d0*mm02*Z(1,2) -\/ f(1)*f(2)}}
\DoxyCodeLine{7838 \textcolor{comment}{!    Xadj(1,2) = Xadj(2,1)}}
\DoxyCodeLine{7839 \textcolor{comment}{!    Xadj(2,2) = 2d0*mm02*Z(2,2) -\/ f(2)*f(2)}}
\DoxyCodeLine{7840 }
\DoxyCodeLine{7841 }
\DoxyCodeLine{7842     \textcolor{comment}{! coefficients Shat defined in (5.13)}}
\DoxyCodeLine{7843     \textcolor{keyword}{allocate}(shat(0:rmaxb,0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{7844 }
\DoxyCodeLine{7845     \textcolor{keywordflow}{do} r=0,rmaxb}
\DoxyCodeLine{7846       \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{7847 }
\DoxyCodeLine{7848         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{7849           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{7850           shat(n0,n1,n2,:) = -\/b\_0(n0,n1,n2)}
\DoxyCodeLine{7851 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7852 }
\DoxyCodeLine{7853         k = r-\/2*n0}
\DoxyCodeLine{7854         shat(n0,0,k,1) = shat(n0,0,k,1) + b\_i(n0,k,1)}
\DoxyCodeLine{7855         shat(n0,k,0,2) = shat(n0,k,0,2) + b\_i(n0,k,2)}
\DoxyCodeLine{7856 }
\DoxyCodeLine{7857 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7858 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7859 }
\DoxyCodeLine{7860     \textcolor{comment}{! choose reduction formulas with smallest expansion terms}}
\DoxyCodeLine{7861     minzk = \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}}
\DoxyCodeLine{7862     \textcolor{keywordflow}{if} (maxval(abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1:2))).le.minzk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7863       minzk = maxval(abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1:2)))}
\DoxyCodeLine{7864       k = 1}
\DoxyCodeLine{7865       l = 1}
\DoxyCodeLine{7866       lt = 2}
\DoxyCodeLine{7867 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7868     \textcolor{keywordflow}{if} (maxval(abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1:2))).lt.minzk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7869       minzk = maxval(abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1:2)))}
\DoxyCodeLine{7870       k = 2}
\DoxyCodeLine{7871       l = 2}
\DoxyCodeLine{7872       lt = 1 }
\DoxyCodeLine{7873 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{7874 }
\DoxyCodeLine{7875 \textcolor{preprocessor}{\#ifdef Cgpftest}}
\DoxyCodeLine{7876 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf: minZk'},k,minzk}
\DoxyCodeLine{7877 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7878 \textcolor{preprocessor}{}}
\DoxyCodeLine{7879 \textcolor{comment}{!   write(*,*)  'CalcCgpf Zadj(i,j)=',i,j,Zadj(i,j),Xadj(i,j)}}
\DoxyCodeLine{7880         }
\DoxyCodeLine{7881     \textcolor{comment}{! allocation of array for det(Z)-\/ and det(X)-\/expanded C-\/coefficients}}
\DoxyCodeLine{7882     rmaxexp = rmaxb+1}
\DoxyCodeLine{7883     \textcolor{keyword}{allocate}(cexpgpf(0:max(rmax/2,1),0:rmaxexp-\/2,0:rmaxexp-\/2,0:ordgpf\_max))}
\DoxyCodeLine{7884    }
\DoxyCodeLine{7885     \textcolor{comment}{! calculate Cuv}}
\DoxyCodeLine{7886     \textcolor{keyword}{allocate}(cuvexpgpf(0:rmaxexp,0:rmaxexp,0:rmaxexp))}
\DoxyCodeLine{7887     \textcolor{keyword}{call }calccuv(cuvexpgpf,buv\_0,mm02,\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}},rmaxexp,id)}
\DoxyCodeLine{7888     cuv(0:rmax,0:rmax,0:rmax) = cuvexpgpf(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{7889 }
\DoxyCodeLine{7890     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{7891     \textcolor{keyword}{allocate}(c00\_err(0:rmaxexp))}
\DoxyCodeLine{7892     \textcolor{keyword}{allocate}(cij\_err(0:rmaxexp))}
\DoxyCodeLine{7893     \textcolor{keyword}{allocate}(c00\_err2(0:rmaxexp))}
\DoxyCodeLine{7894     \textcolor{keyword}{allocate}(cij\_err2(0:rmaxexp))}
\DoxyCodeLine{7895 }
\DoxyCodeLine{7896     \textcolor{comment}{! initialize accuracy estimates}}
\DoxyCodeLine{7897     cerr = acc\_inf}
\DoxyCodeLine{7898     cij\_err =0d0}
\DoxyCodeLine{7899     c00\_err =0d0}
\DoxyCodeLine{7900 }
\DoxyCodeLine{7901     cerr2 = acc\_inf}
\DoxyCodeLine{7902     cij\_err2 =0d0}
\DoxyCodeLine{7903     c00\_err2 =0d0}
\DoxyCodeLine{7904 }
\DoxyCodeLine{7905 \textcolor{comment}{!    maxZadjf = maxval(abs(Zadjf))}}
\DoxyCodeLine{7906 \textcolor{comment}{!    fmax = maxval(abs(f))}}
\DoxyCodeLine{7907 }
\DoxyCodeLine{7908     \textcolor{comment}{! truncation of expansion if calculated term larger than truncfacexp * previous term}}
\DoxyCodeLine{7909     \textcolor{comment}{! crucial for expansion parameters between 0.1 and 1 !!!}}
\DoxyCodeLine{7910 \textcolor{comment}{!    truncfacexp = sqrt(max(maxZadjf,abs(detZ))/abs(Xadj(i,j))*max(1d0,fmax/abs(Zadj(k,l)))) * truncfacC}}
\DoxyCodeLine{7911     truncfacexp = sqrt(\mbox{\hyperlink{namespaceglobalc_a92c2feddeb644af9e797691976e9143b}{fac\_gpf}}) * truncfacc}
\DoxyCodeLine{7912     gtrunc = ordgpf\_max }
\DoxyCodeLine{7913 }
\DoxyCodeLine{7914 \textcolor{preprocessor}{\#ifdef Cgpftest            }}
\DoxyCodeLine{7915 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf: gtrunc orig='},gtrunc}
\DoxyCodeLine{7916     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf: rmaxExp-\/2='},rmaxexp-\/2}
\DoxyCodeLine{7917 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7918 \textcolor{preprocessor}{}}
\DoxyCodeLine{7919 \textcolor{comment}{! calculate C(1,n1,n2) up to rank r+2}}
\DoxyCodeLine{7920 \textcolor{comment}{! calculate C(0,n1,n2) up to rank r  }}
\DoxyCodeLine{7921     rloop: \textcolor{keywordflow}{do} r=0,rmaxexp-\/2}
\DoxyCodeLine{7922 }
\DoxyCodeLine{7923 \textcolor{preprocessor}{\#ifdef Cgpftest            }}
\DoxyCodeLine{7924 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf: rloop='},r,rmaxexp-\/2,rmax+2*gtrunc+2}
\DoxyCodeLine{7925       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf: rloop='},rmax,gtrunc}
\DoxyCodeLine{7926 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7927 \textcolor{preprocessor}{}}
\DoxyCodeLine{7928       \textcolor{keywordflow}{if} (r.gt.rmax+2*gtrunc+2) \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{7929 }
\DoxyCodeLine{7930       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{7931       \textcolor{comment}{! 0th-\/order coefficients}}
\DoxyCodeLine{7932       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{7933 }
\DoxyCodeLine{7934       \textcolor{comment}{! calculating C\_00ijk.. exploiting eq. (5.71)}}
\DoxyCodeLine{7935       maxcexpgpf(1,r,0)=0d0}
\DoxyCodeLine{7936       \textcolor{keywordflow}{do} nl=r,0,-\/1}
\DoxyCodeLine{7937         nlt=r-\/nl}
\DoxyCodeLine{7938         inds0(l) = nl}
\DoxyCodeLine{7939         inds0(lt) = nlt}
\DoxyCodeLine{7940 }
\DoxyCodeLine{7941         inds(l) = nl+1}
\DoxyCodeLine{7942         inds(lt) = nlt}
\DoxyCodeLine{7943 }
\DoxyCodeLine{7944         caux = shat(0,inds(1),inds(2),k)}
\DoxyCodeLine{7945 }
\DoxyCodeLine{7946         cexpgpf(1,inds0(1),inds0(2),0) = caux/(2*(nl+1))}
\DoxyCodeLine{7947         maxcexpgpf(1,r,0) =  maxcexpgpf(1,r,0) + abs(cexpgpf(1,inds0(1),inds0(2),0) )}
\DoxyCodeLine{7948 \textcolor{comment}{!        if (r+2.le.rmax) then             !  for fixed rank}}
\DoxyCodeLine{7949         \textcolor{keywordflow}{if} (r+1.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7950           c(1,inds0(1),inds0(2)) = cexpgpf(1,inds0(1),inds0(2),0)}
\DoxyCodeLine{7951 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7952 }
\DoxyCodeLine{7953 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7954 }
\DoxyCodeLine{7955       \textcolor{comment}{! calculate C\_ijkl.. exploiting eq. (5.72)}}
\DoxyCodeLine{7956       maxcexpgpf(0,r,0)=0d0}
\DoxyCodeLine{7957       \textcolor{keywordflow}{do} n1=0,r}
\DoxyCodeLine{7958         n2 = r-\/n1}
\DoxyCodeLine{7959         inds(1) = n1}
\DoxyCodeLine{7960         inds(2) = n2}
\DoxyCodeLine{7961       }
\DoxyCodeLine{7962         caux = 2*(4+r+r)*cexpgpf(1,n1,n2,0) -\/ 4*cuvexpgpf(1,n1,n2)  \&}
\DoxyCodeLine{7963              -\/ 2*b\_0(0,n1,n2)}
\DoxyCodeLine{7964 }
\DoxyCodeLine{7965         cexpgpf(0,n1,n2,0) = caux/(2d0*m02)}
\DoxyCodeLine{7966 }
\DoxyCodeLine{7967         maxcexpgpf(0,r,0) =  maxcexpgpf(0,r,0) + abs(cexpgpf(0,n1,n2,0))}
\DoxyCodeLine{7968         \textcolor{keywordflow}{if} (r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7969           c(0,n1,n2) = cexpgpf(0,n1,n2,0)}
\DoxyCodeLine{7970 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7971 }
\DoxyCodeLine{7972 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7973 }
\DoxyCodeLine{7974       \textcolor{keywordflow}{if} (r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7975 \textcolor{comment}{!       Cerr(r) =  abs(maxZadjf/Xadj(i,j))*maxCexpgpf(0,r,0)}}
\DoxyCodeLine{7976         cerr(r) =  \mbox{\hyperlink{namespaceglobalc_a92c2feddeb644af9e797691976e9143b}{fac\_gpf}}*maxcexpgpf(0,r,0)}
\DoxyCodeLine{7977 }
\DoxyCodeLine{7978 \textcolor{comment}{!        write(*,*) 'CalcCgpf Cerr,0 ',r,Cerr(r),fac\_gpf,maxCexpgpf(0,r,0)}}
\DoxyCodeLine{7979 }
\DoxyCodeLine{7980 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{7981 }
\DoxyCodeLine{7982  \textcolor{comment}{! error propagation from B's}}
\DoxyCodeLine{7983       c00\_err(r+2) = b\_err /2d0               }
\DoxyCodeLine{7984       cij\_err(r) = max(b\_err,2*(r+2)*c00\_err(r+2))/abs(m02)}
\DoxyCodeLine{7985 }
\DoxyCodeLine{7986       c00\_err2(r+2) = b\_err /2d0               }
\DoxyCodeLine{7987       cij\_err2(r) = max(b\_err,2*(r+2)*c00\_err2(r+2))/abs(m02)}
\DoxyCodeLine{7988       }
\DoxyCodeLine{7989 }
\DoxyCodeLine{7990 \textcolor{preprocessor}{\#ifdef Cgpftest}}
\DoxyCodeLine{7991 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf leading terms r ='},r}
\DoxyCodeLine{7992       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf Cij\_err ='},r,cij\_err(0:r)}
\DoxyCodeLine{7993       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf Cexp0(1,0,0)='},r,c(1,0,0),cexpgpf(1,0,0,0)}
\DoxyCodeLine{7994       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf Cexp0(0,0,0)='},r,c(0,0,0),cexpgpf(0,0,0,0)}
\DoxyCodeLine{7995 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7996 \textcolor{preprocessor}{}}
\DoxyCodeLine{7997 }
\DoxyCodeLine{7998 }
\DoxyCodeLine{7999 }
\DoxyCodeLine{8000       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{8001       \textcolor{comment}{! higher order coefficients}}
\DoxyCodeLine{8002       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{8003 }
\DoxyCodeLine{8004       rg = r}
\DoxyCodeLine{8005       gloop: \textcolor{keywordflow}{do} g=1,min(gtrunc,r/2)}
\DoxyCodeLine{8006         rg = rg-\/2}
\DoxyCodeLine{8007 }
\DoxyCodeLine{8008         \textcolor{comment}{! calculating C\_00ijk.. exploiting eq. (5.71)}}
\DoxyCodeLine{8009         maxcexpgpf(1,rg,g) = 0d0}
\DoxyCodeLine{8010         \textcolor{keywordflow}{do} nl=rg,0,-\/1}
\DoxyCodeLine{8011           nlt=rg-\/nl}
\DoxyCodeLine{8012           inds0(l) = nl}
\DoxyCodeLine{8013           inds0(lt) = nlt}
\DoxyCodeLine{8014 }
\DoxyCodeLine{8015           inds(l) = nl+1}
\DoxyCodeLine{8016           inds(lt) = nlt}
\DoxyCodeLine{8017           caux = -\/\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(k)*cexpgpf(0,inds(1),inds(2),g-\/1)}
\DoxyCodeLine{8018 }
\DoxyCodeLine{8019           inds(l) = inds(l)+1}
\DoxyCodeLine{8020           caux = caux -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(k,l)*cexpgpf(0,inds(1),inds(2),g-\/1)}
\DoxyCodeLine{8021 }
\DoxyCodeLine{8022           inds(l) =  inds(l)-\/1}
\DoxyCodeLine{8023           inds(lt) =  inds(lt)+1}
\DoxyCodeLine{8024           caux = caux -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(k,lt)*cexpgpf(0,inds(1),inds(2),g-\/1)}
\DoxyCodeLine{8025 }
\DoxyCodeLine{8026           cexpgpf(1,inds0(1),inds0(2),g) = caux/(2*(nl+1))}
\DoxyCodeLine{8027 }
\DoxyCodeLine{8028           maxcexpgpf(1,rg,g) =  maxcexpgpf(1,rg,g) + abs(cexpgpf(1,inds0(1),inds0(2),g) )}
\DoxyCodeLine{8029 }
\DoxyCodeLine{8030           \textcolor{keywordflow}{if} (g.eq.1.and.abs(cexpgpf(1,inds0(1),inds0(2),g)).gt.      \&}
\DoxyCodeLine{8031                   truncfacexp*max(1d0,maxcexpgpf(1,rg,g-\/1))    .or.   \&}
\DoxyCodeLine{8032                   g.ge.2.and.abs(cexpgpf(1,inds0(1),inds0(2),g)).gt.  \&}
\DoxyCodeLine{8033                   truncfacexp*maxcexpgpf(1,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8034 \textcolor{preprocessor}{\#ifdef Cgpftest            }}
\DoxyCodeLine{8035 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf exit gloop'},n1,n2,g,abs(cexpgpf(1,inds0(1),inds0(2),g)),maxcexpgpf(1,rg,g-\/1)}
\DoxyCodeLine{8036             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf exit gloop'},g,rg,inds0(1),inds0(2)}
\DoxyCodeLine{8037 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8038 \textcolor{preprocessor}{}}
\DoxyCodeLine{8039             gtrunc = g-\/1}
\DoxyCodeLine{8040             \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{8041 }
\DoxyCodeLine{8042 \textcolor{keywordflow}{          end if} }
\DoxyCodeLine{8043         }
\DoxyCodeLine{8044 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8045 }
\DoxyCodeLine{8046 \textcolor{preprocessor}{\#ifndef PPEXP00}}
\DoxyCodeLine{8047 \textcolor{preprocessor}{}\textcolor{comment}{!        if (rg+2.le.rmax) then            !  for fixed rank}}
\DoxyCodeLine{8048         \textcolor{keywordflow}{if} (rg+1.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8049           \textcolor{keywordflow}{do} nl=rg,0,-\/1}
\DoxyCodeLine{8050             nlt=rg-\/nl}
\DoxyCodeLine{8051             inds0(l) = nl}
\DoxyCodeLine{8052             inds0(lt) = nlt}
\DoxyCodeLine{8053             c(1,inds0(1),inds0(2)) = c(1,inds0(1),inds0(2))  \&}
\DoxyCodeLine{8054                 + cexpgpf(1,inds0(1),inds0(2),g)}
\DoxyCodeLine{8055 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8056 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{8057 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8058 \textcolor{preprocessor}{}}
\DoxyCodeLine{8059         \textcolor{comment}{! calculate C\_ijkl.. exploiting eq. (5.72)}}
\DoxyCodeLine{8060         maxcexpgpf(0,rg,g) = 0d0}
\DoxyCodeLine{8061         \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{8062           n2 = rg-\/n1}
\DoxyCodeLine{8063           inds(1) = n1}
\DoxyCodeLine{8064           inds(2) = n2}
\DoxyCodeLine{8065           }
\DoxyCodeLine{8066           caux = 2*(4+rg+rg)*cexpgpf(1,n1,n2,g)}
\DoxyCodeLine{8067           }
\DoxyCodeLine{8068           \textcolor{keywordflow}{do} i=1,2}
\DoxyCodeLine{8069           \textcolor{keywordflow}{do} j=1,2}
\DoxyCodeLine{8070             inds(i)=inds(i)+1}
\DoxyCodeLine{8071             inds(j)=inds(j)+1 }
\DoxyCodeLine{8072             caux = caux + \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(i,j)*cexpgpf(0,inds(1),inds(2),g-\/1)}
\DoxyCodeLine{8073             inds(i)=inds(i)-\/1}
\DoxyCodeLine{8074             inds(j)=inds(j)-\/1  }
\DoxyCodeLine{8075 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8076 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8077 }
\DoxyCodeLine{8078           cexpgpf(0,n1,n2,g) = caux/(2*m02)}
\DoxyCodeLine{8079 }
\DoxyCodeLine{8080           maxcexpgpf(0,rg,g) =  maxcexpgpf(0,rg,g) + abs(cexpgpf(0,n1,n2,g))}
\DoxyCodeLine{8081           }
\DoxyCodeLine{8082           \textcolor{keywordflow}{if} (g.eq.1.and.abs(cexpgpf(0,n1,n2,g)).gt.        \&}
\DoxyCodeLine{8083               truncfacexp*max(1d0/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}},maxcexpgpf(0,rg,g-\/1)).or.     \&}
\DoxyCodeLine{8084               g.ge.2.and.abs(cexpgpf(0,n1,n2,g)).gt.        \&}
\DoxyCodeLine{8085               truncfacexp*maxcexpgpf(0,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8086 }
\DoxyCodeLine{8087 \textcolor{preprocessor}{\#ifdef Cgpftest            }}
\DoxyCodeLine{8088 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf exit gloop'},n1,n2,g,rg}
\DoxyCodeLine{8089             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf exit gloop'},abs(cexpgpf(0,n1,n2,g)),maxcexpgpf(0,rg,g-\/1),1d0/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}}
\DoxyCodeLine{8090             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf exit gloop'},truncfacexp}
\DoxyCodeLine{8091 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8092 \textcolor{preprocessor}{}}
\DoxyCodeLine{8093             gtrunc = g-\/1}
\DoxyCodeLine{8094             \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{8095 }
\DoxyCodeLine{8096 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{8097 }
\DoxyCodeLine{8098 \textcolor{comment}{!            if ((g.ge.2).and.(abs(Cexpgpf(0,n1,n2,g)).gt.truncfacexp*abs(Cexpgpf(0,n1,n2,g-\/1)))) then}}
\DoxyCodeLine{8099 \textcolor{comment}{!              gtrunc = g-\/1}}
\DoxyCodeLine{8100 \textcolor{comment}{!            end if}}
\DoxyCodeLine{8101 }
\DoxyCodeLine{8102 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8103 }
\DoxyCodeLine{8104 \textcolor{preprocessor}{\#ifdef Cgpftest}}
\DoxyCodeLine{8105 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf expansion terms r ='},r,g,rg}
\DoxyCodeLine{8106         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf Cij\_err ='},r,cij\_err(0:r)}
\DoxyCodeLine{8107         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf Cexp(1,0,0)='},r,g,cexpgpf(1,0,0,g)}
\DoxyCodeLine{8108         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf Cexp(0,0,0)='},r,g,cexpgpf(0,0,0,g)}
\DoxyCodeLine{8109 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8110 \textcolor{preprocessor}{}}
\DoxyCodeLine{8111         \textcolor{comment}{! error propagation from B's}}
\DoxyCodeLine{8112         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{8113           c00\_err(rg+2) =max(c00\_err(rg+2),                           \&}
\DoxyCodeLine{8114               \mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}/2d0*cij\_err(rg+1),                                 \&}
\DoxyCodeLine{8115               \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/2d0*cij\_err(rg+2))   }
\DoxyCodeLine{8116 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{8117 }
\DoxyCodeLine{8118 \textcolor{preprocessor}{\#ifdef Cgpftest}}
\DoxyCodeLine{8119 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf test2'},rg,i,j,cij\_err(rg)}
\DoxyCodeLine{8120         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf test2'},rg,cij\_err(rg+1),c00\_err(rg+1)}
\DoxyCodeLine{8121 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8122 \textcolor{preprocessor}{}}
\DoxyCodeLine{8123         cij\_err(rg)= max( cij\_err(rg),                                \&}
\DoxyCodeLine{8124             2*(rg+2)/abs(m02)*c00\_err(rg+2),                          \&}
\DoxyCodeLine{8125             \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/(2*abs(m02))*cij\_err(rg+2))}
\DoxyCodeLine{8126 }
\DoxyCodeLine{8127         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{8128           c00\_err2(rg+2) =max(c00\_err2(rg+2),                         \&}
\DoxyCodeLine{8129               \mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}/2d0*cij\_err(rg+1),                                 \&}
\DoxyCodeLine{8130               \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/2d0*cij\_err(rg+2))   }
\DoxyCodeLine{8131 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{8132 }
\DoxyCodeLine{8133         cij\_err2(rg)= max( cij\_err2(rg),                              \&}
\DoxyCodeLine{8134             2*(rg+2)/abs(m02)*c00\_err2(rg+2),                         \&}
\DoxyCodeLine{8135             \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/(2*abs(m02))*cij\_err2(rg+2))}
\DoxyCodeLine{8136 }
\DoxyCodeLine{8137 \textcolor{preprocessor}{\#ifdef PPEXP00}}
\DoxyCodeLine{8138 \textcolor{preprocessor}{}\textcolor{comment}{!        if (rg+2.le.rmax) then             !   for fixed rank}}
\DoxyCodeLine{8139         \textcolor{keywordflow}{if} (rg+1.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8140           \textcolor{keywordflow}{do} nl=rg,0,-\/1}
\DoxyCodeLine{8141             nlt=rg-\/nl}
\DoxyCodeLine{8142             inds0(l) = nl}
\DoxyCodeLine{8143             inds0(lt) = nlt}
\DoxyCodeLine{8144             c(1,inds0(1),inds0(2)) = c(1,inds0(1),inds0(2))  \&}
\DoxyCodeLine{8145                 + cexpgpf(1,inds0(1),inds0(2),g)}
\DoxyCodeLine{8146 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8147 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{8148 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8149 \textcolor{preprocessor}{}}
\DoxyCodeLine{8150         \textcolor{keywordflow}{if} ((rg.le.rmax)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8151           cerr(rg) = 0d0}
\DoxyCodeLine{8152           \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{8153             n2=rg-\/n1}
\DoxyCodeLine{8154             c(0,n1,n2) = c(0,n1,n2) + cexpgpf(0,n1,n2,g)}
\DoxyCodeLine{8155 }
\DoxyCodeLine{8156 \textcolor{preprocessor}{\#ifdef Cgpftest}}
\DoxyCodeLine{8157 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf test1'},rg,n1,n2,cerr(rg)}
\DoxyCodeLine{8158             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf test1'},cexpgpf(0,n1,n2,g)}
\DoxyCodeLine{8159             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf test1'},cexpgpf(0,n1,n2,g-\/1)}
\DoxyCodeLine{8160 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8161 \textcolor{preprocessor}{}}
\DoxyCodeLine{8162             \textcolor{keywordflow}{if}(abs(cexpgpf(0,n1,n2,g-\/1)).ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8163               cerr(rg)=max(cerr(rg),abs(cexpgpf(0,n1,n2,g))*min(1d0,abs(cexpgpf(0,n1,n2,g))/abs(cexpgpf(0,n1,n2,g-\/1))))}
\DoxyCodeLine{8164             \textcolor{keywordflow}{else}}
\DoxyCodeLine{8165               cerr(rg)=max(cerr(rg),abs(cexpgpf(0,n1,n2,g)))}
\DoxyCodeLine{8166 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{8167 }
\DoxyCodeLine{8168 \textcolor{preprocessor}{\#ifdef Cgpftest}}
\DoxyCodeLine{8169 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf test1'},cerr(rg)            }
\DoxyCodeLine{8170 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8171 \textcolor{preprocessor}{}}
\DoxyCodeLine{8172 \textcolor{preprocessor}{\#ifdef Cgpftest}}
\DoxyCodeLine{8173 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf expansion terms r ='},r,g,rg}
\DoxyCodeLine{8174             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf Cij\_err ='},r,cij\_err(0:min(r,rmax))}
\DoxyCodeLine{8175             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf Cerr    ='},r,cerr(0:min(r,rmax))}
\DoxyCodeLine{8176             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf C(1,0,0)='},r,c(1,0,0)}
\DoxyCodeLine{8177             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf C(0,0,0)='},r,c(0,0,0)}
\DoxyCodeLine{8178 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8179 \textcolor{preprocessor}{}}
\DoxyCodeLine{8180 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8181 }
\DoxyCodeLine{8182           \textcolor{comment}{! if error from B's larger than error from expansion stop expansion}}
\DoxyCodeLine{8183           \textcolor{keywordflow}{if}(cij\_err(rg).gt.cerr(rg)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8184              gtrunc = min(g,gtrunc)}
\DoxyCodeLine{8185 \textcolor{comment}{!            gtrunc = min(g+1,gtrunc)}}
\DoxyCodeLine{8186              }
\DoxyCodeLine{8187 \textcolor{preprocessor}{\#ifdef Cgpftest}}
\DoxyCodeLine{8188 \textcolor{preprocessor}{}             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf adjust gtrunc'},r,g,gtrunc}
\DoxyCodeLine{8189 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8190 \textcolor{preprocessor}{}}
\DoxyCodeLine{8191 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{8192 }
\DoxyCodeLine{8193 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{8194         }
\DoxyCodeLine{8195 \textcolor{keywordflow}{      end do} gloop}
\DoxyCodeLine{8196 }
\DoxyCodeLine{8197 \textcolor{comment}{!     write(*,*) 'CalcCgpf gtrunc aft gloop=',gtrunc,r}}
\DoxyCodeLine{8198 }
\DoxyCodeLine{8199 \textcolor{preprocessor}{\#ifdef Cgpftest}}
\DoxyCodeLine{8200 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf Cerr r ='},r}
\DoxyCodeLine{8201       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf Cerr r ='},r,cerr(0:min(r,rmax))}
\DoxyCodeLine{8202       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf Cacc r ='},r,cerr/abs(c(0,0,0))}
\DoxyCodeLine{8203       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf Cij\_err ='},r,cij\_err}
\DoxyCodeLine{8204       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf C(1,0,0)='},r,c(1,0,0)}
\DoxyCodeLine{8205       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf C(0,0,0)='},r,c(0,0,0)}
\DoxyCodeLine{8206       \textcolor{keywordflow}{if}(rmax.ge.1.and.r.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8207       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf C(0,1,0)='},r,c(0,1,0)}
\DoxyCodeLine{8208       \textcolor{keywordflow}{if}(rmax.ge.2.and.r.ge.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8209       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf C(0,1,1)='},r,c(0,1,1)}
\DoxyCodeLine{8210       \textcolor{keywordflow}{if}(rmax.ge.3.and.r.ge.3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8211       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf C(0,1,2)='},r,c(0,1,2)}
\DoxyCodeLine{8212       \textcolor{keywordflow}{if}(rmax.ge.4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8213       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf C(0,0,4)='},r,c(0,0,4)}
\DoxyCodeLine{8214 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{8215 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{8216 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{8217 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{8218 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8219 \textcolor{preprocessor}{}}
\DoxyCodeLine{8220       cerr2 = max(cerr,cij\_err2(0:rmax))}
\DoxyCodeLine{8221       cerr = max(cerr,cij\_err(0:rmax))}
\DoxyCodeLine{8222 }
\DoxyCodeLine{8223 \textcolor{preprocessor}{\#ifdef Cgpftest}}
\DoxyCodeLine{8224 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf Cerr ='},r,cerr,maxval(cerr)}
\DoxyCodeLine{8225 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8226 \textcolor{preprocessor}{}}
\DoxyCodeLine{8227       \textcolor{comment}{! check if target precision already reached}}
\DoxyCodeLine{8228 \textcolor{comment}{!      if(maxval(Cerr-\/acc\_req\_Cr*abs(C(0,0,0))).le.0d0) exit         ! changed 28.01.15}}
\DoxyCodeLine{8229 \textcolor{preprocessor}{\#ifdef Cutrloop}}
\DoxyCodeLine{8230 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(cerr-\/acc\_req\_cr*abs(c(0,0,0))).le.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8231         \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{8232           \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{8233             c(0,n1,rg-\/n1)=0d0}
\DoxyCodeLine{8234 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8235 \textcolor{keywordflow}{        end do}   }
\DoxyCodeLine{8236         \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{8237           \textcolor{keywordflow}{do} n1=0,rg-\/2}
\DoxyCodeLine{8238             c(1,n1,rg-\/2-\/n1)=0d0}
\DoxyCodeLine{8239 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{8240 \textcolor{keywordflow}{        end do}   }
\DoxyCodeLine{8241 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{8242 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(cerr-\/acc\_req\_cr*abs(c(0,0,0))).le.0d0.and.r.ge.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8243 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8244 \textcolor{preprocessor}{}}
\DoxyCodeLine{8245 \textcolor{preprocessor}{\#ifdef Cgpftest}}
\DoxyCodeLine{8246 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf exit rloop'},r,cerr,maxval(cerr)}
\DoxyCodeLine{8247 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8248 \textcolor{preprocessor}{}}
\DoxyCodeLine{8249         \textcolor{keywordflow}{exit} rloop }
\DoxyCodeLine{8250 }
\DoxyCodeLine{8251 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{8252 }
\DoxyCodeLine{8253 \textcolor{keywordflow}{    end do} rloop}
\DoxyCodeLine{8254 }
\DoxyCodeLine{8255 }
\DoxyCodeLine{8256     \textcolor{comment}{! calculating C\_0000ijk.. exploiting eq. (5.71)}}
\DoxyCodeLine{8257     \textcolor{keywordflow}{do} r=4,rmax}
\DoxyCodeLine{8258 \textcolor{comment}{!      do n0=2,rmax/2     !     for fixed rank}}
\DoxyCodeLine{8259       \textcolor{keywordflow}{do} n0=2,rmax}
\DoxyCodeLine{8260         \textcolor{keywordflow}{do} nl=r-\/2*n0,0,-\/1}
\DoxyCodeLine{8261           nlt=r-\/2*n0-\/nl}
\DoxyCodeLine{8262           inds0(l) = nl}
\DoxyCodeLine{8263           inds0(lt) = nlt}
\DoxyCodeLine{8264 }
\DoxyCodeLine{8265           inds(l) = nl+1}
\DoxyCodeLine{8266           inds(lt) = nlt}
\DoxyCodeLine{8267           caux = shat(n0-\/1,inds(1),inds(2),k)            \&}
\DoxyCodeLine{8268                  -\/ \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(k)*c(n0-\/1,inds(1),inds(2))          \&}
\DoxyCodeLine{8269                  -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(k,1)*c(n0-\/1,inds(1)+1,inds(2))      \&}
\DoxyCodeLine{8270                  -\/ \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(k,2)*c(n0-\/1,inds(1),inds(2)+1)        }
\DoxyCodeLine{8271 }
\DoxyCodeLine{8272           c(n0,inds0(1),inds0(2)) = caux/(2*(nl+1))}
\DoxyCodeLine{8273 }
\DoxyCodeLine{8274 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8275 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{8276 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{8277 }
\DoxyCodeLine{8278       \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2=r, n0>0 }}
\DoxyCodeLine{8279     \textcolor{keywordflow}{do} r=rmax+1,2*rmax}
\DoxyCodeLine{8280       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{8281         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{8282           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{8283           c(n0,n1,n2) = (b\_0(n0-\/1,n1,n2) + 2*mm02*c(n0-\/1,n1,n2) + 4*cuv(n0,n1,n2) \&}
\DoxyCodeLine{8284                         + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)*c(n0-\/1,n1+1,n2) + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)*c(n0-\/1,n1,n2+1)) / (2*r)}
\DoxyCodeLine{8285 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{8286 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{8287 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{8288 }
\DoxyCodeLine{8289 \textcolor{preprocessor}{\#ifdef Cgpftest}}
\DoxyCodeLine{8290 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf final err'},cerr}
\DoxyCodeLine{8291     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf final acc'},cerr/abs(c(0,0,0))}
\DoxyCodeLine{8292 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8293 \textcolor{preprocessor}{}}
\DoxyCodeLine{8294 \textcolor{comment}{!   write(*,*) 'CalcCgpf out',(((C((r-\/n1-\/n2)/2,n1,n2),n2=0,r-\/n1),n1=0,r),r=0,rmax)}}
\DoxyCodeLine{8295 \textcolor{preprocessor}{\#ifdef TRACECout}}
\DoxyCodeLine{8296 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf rmax'},rmax}
\DoxyCodeLine{8297     \textcolor{keywordflow}{do} r=14,rmax}
\DoxyCodeLine{8298     \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{8299     \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{8300     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgpf out'},r,n0,n1,r-\/2*n0-\/n1,c(n0,n1,r-\/2*n0-\/n1)}
\DoxyCodeLine{8301 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{8302 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{8303 \textcolor{keywordflow}{    end do}   }
\DoxyCodeLine{8304 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{8305 \textcolor{preprocessor}{}}
\DoxyCodeLine{8306 \textcolor{comment}{!    write(*,*) 'CalcCgpf Cerr ',Cerr}}
\DoxyCodeLine{8307 \textcolor{comment}{!    write(*,*) 'CalcCgpf Cerr2',Cerr2}}
\DoxyCodeLine{8308 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductionc_ad484f0b8dbe4261806df80cd75010944}\label{namespacereductionc_ad484f0b8dbe4261806df80cd75010944}} 
\index{reductionc@{reductionc}!calccgr@{calccgr}}
\index{calccgr@{calccgr}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{calccgr()}{calccgr()}}
{\footnotesize\ttfamily subroutine reductionc\+::calccgr (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{C,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Cuv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{ordgr\+\_\+min,  }\item[{integer, intent(in)}]{ordgr\+\_\+max,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr,  }\item[{double precision, dimension(0\+:rmax), intent(in)}]{acc\+\_\+req\+\_\+\+Cr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr2 }\end{DoxyParamCaption})}



Definition at line 5331 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{5331   }
\DoxyCodeLine{5332     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobalc}{globalc}}}
\DoxyCodeLine{5333 }
\DoxyCodeLine{5334     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,ordgr\_min,ordgr\_max,id}
\DoxyCodeLine{5335     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{5336     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: C(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5337     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Cuv(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5338     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Cerr(0:rmax),Cerr2(0:rmax)}
\DoxyCodeLine{5339     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(in)} :: acc\_req\_Cr(0:rmax)}
\DoxyCodeLine{5340     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: B\_0(:,:,:), B\_i(:,:,:), Shat(:,:,:,:)}
\DoxyCodeLine{5341     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Buv\_0(:,:,:), Buv\_i(:,:,:)}
\DoxyCodeLine{5342     \textcolor{keywordtype}{double precision} :: B\_err,B\_max}
\DoxyCodeLine{5343     \textcolor{keywordtype}{double complex} :: Zadjfj,Zadj2(2,2), Zadjkl, Zadj2f(2,2,2)}
\DoxyCodeLine{5344     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Cexpgr(:,:,:,:), CuvExpgr(:,:,:)}
\DoxyCodeLine{5345     \textcolor{keywordtype}{double complex} :: Smod(2), Skl, Caux}
\DoxyCodeLine{5346     \textcolor{keywordtype}{double complex} :: elimminf2\_coli}
\DoxyCodeLine{5347     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err(:),Cij\_err(:)}
\DoxyCodeLine{5348     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{5349     \textcolor{keywordtype}{double precision} :: maxZadj2f}
\DoxyCodeLine{5350     \textcolor{keywordtype}{double precision} :: maxCexpgr(0:1,0:2*(rmax+ordgr\_min),0:ordgr\_max),truncfacexp}
\DoxyCodeLine{5351     \textcolor{keywordtype}{integer} :: rmaxB,rmaxExp,gtrunc,r,n0,n1,n2,k,l,i,j,m,n,g,rg,lt,ltt,nn,nntt}
\DoxyCodeLine{5352     \textcolor{keywordtype}{integer} :: inds0(2), inds1(2), inds(2)}
\DoxyCodeLine{5353     \textcolor{keywordtype}{integer} :: bin,nid(0:2)}
\DoxyCodeLine{5354 }
\DoxyCodeLine{5355 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5356 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr in '},rmax,ordgr\_min,ordgr\_max}
\DoxyCodeLine{5357     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr in, f  '},\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}}
\DoxyCodeLine{5358 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5359 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifdef TRACECin}}
\DoxyCodeLine{5360 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr in '},rmax,ordgr\_min,ordgr\_max}
\DoxyCodeLine{5361 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5362 \textcolor{preprocessor}{}}
\DoxyCodeLine{5363     \textcolor{comment}{! allocation of B functions}}
\DoxyCodeLine{5364     rmaxb = 2*rmax + 2*ordgr\_min}
\DoxyCodeLine{5365     \textcolor{keyword}{allocate}(b\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{5366     \textcolor{keyword}{allocate}(buv\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{5367     \textcolor{keyword}{allocate}(b\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{5368     \textcolor{keyword}{allocate}(buv\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{5369     }
\DoxyCodeLine{5370     \textcolor{comment}{! determine binaries for B-\/coefficients}}
\DoxyCodeLine{5371     k=0}
\DoxyCodeLine{5372     bin = 1}
\DoxyCodeLine{5373     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.2)}
\DoxyCodeLine{5374       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5375         nid(k) = id+bin}
\DoxyCodeLine{5376         k = k+1}
\DoxyCodeLine{5377 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{5378       bin = 2*bin}
\DoxyCodeLine{5379 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{5380 }
\DoxyCodeLine{5381     \textcolor{keyword}{call }calcb(b\_0(:,0,:),buv\_0(:,0,:),p21,m12,m22,rmaxb,nid(0))}
\DoxyCodeLine{5382     \textcolor{keyword}{call }calcb(b\_i(:,:,1),buv\_i(:,:,1),p20,m02,m22,rmaxb,nid(1))}
\DoxyCodeLine{5383     \textcolor{keyword}{call }calcb(b\_i(:,:,2),buv\_i(:,:,2),p10,m02,m12,rmaxb,nid(2))}
\DoxyCodeLine{5384 }
\DoxyCodeLine{5385    \textcolor{comment}{! shift of integration momentum in B\_0}}
\DoxyCodeLine{5386     b\_max=0d0}
\DoxyCodeLine{5387     \textcolor{keywordflow}{do} n1=1,rmaxb}
\DoxyCodeLine{5388       \textcolor{keywordflow}{do} n2=0,rmaxb-\/n1}
\DoxyCodeLine{5389         n0 = (rmaxb-\/n1-\/n2)}
\DoxyCodeLine{5390         b\_0(0:n0,n1,n2) = -\/b\_0(0:n0,n1-\/1,n2)-\/b\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{5391         buv\_0(0:n0,n1,n2) = -\/buv\_0(0:n0,n1-\/1,n2)-\/buv\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{5392 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{5393 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{5394     b\_max = max(b\_max,maxval(abs(b\_i(0,0:rmaxb,1:2))))}
\DoxyCodeLine{5395     b\_err = acc\_def\_b*b\_max}
\DoxyCodeLine{5396 }
\DoxyCodeLine{5397     \textcolor{comment}{! calculate adjugated Gram matrix}}
\DoxyCodeLine{5398 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{5399 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{5400 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{5401 \textcolor{comment}{!    mm32 = elimminf2\_coli(m32)}}
\DoxyCodeLine{5402 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{5403 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{5404 \textcolor{comment}{!    q32  = elimminf2\_coli(p32)}}
\DoxyCodeLine{5405 \textcolor{comment}{!    q30  = elimminf2\_coli(p30)}}
\DoxyCodeLine{5406 \textcolor{comment}{!    q31  = elimminf2\_coli(p31)}}
\DoxyCodeLine{5407 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{5408 }
\DoxyCodeLine{5409 \textcolor{comment}{!    Z(1,1) = 2d0*q10}}
\DoxyCodeLine{5410 \textcolor{comment}{!    Z(2,1) = q10+q20-\/q21}}
\DoxyCodeLine{5411 \textcolor{comment}{!    Z(3,1) = q10+q30-\/q31}}
\DoxyCodeLine{5412 \textcolor{comment}{!    Z(1,2) = Z(2,1)}}
\DoxyCodeLine{5413 \textcolor{comment}{!    Z(2,2) = 2d0*q20}}
\DoxyCodeLine{5414 \textcolor{comment}{!    Z(3,2) = q20+q30-\/q32}}
\DoxyCodeLine{5415 \textcolor{comment}{!    Z(1,3) = Z(3,1)}}
\DoxyCodeLine{5416 \textcolor{comment}{!    Z(2,3) = Z(3,2)}}
\DoxyCodeLine{5417 \textcolor{comment}{!    Z(3,3) = 2d0*q30}}
\DoxyCodeLine{5418 }
\DoxyCodeLine{5419 \textcolor{comment}{!    q1q2 = (q10+q20-\/q21)}}
\DoxyCodeLine{5420 \textcolor{comment}{!    q1q3 = (q10+q30-\/q31)}}
\DoxyCodeLine{5421 \textcolor{comment}{!    q2q3 = (q20+q30-\/q32)}}
\DoxyCodeLine{5422 \textcolor{comment}{!    detZ = 8d0*q10*q30*q20+2D0*q1q2*q1q3*q2q3  \&}}
\DoxyCodeLine{5423 \textcolor{comment}{!     \&    -\/2d0*(q10*q2q3*q2q3+q20*q1q3*q1q3+q30*q1q2*q1q2)}}
\DoxyCodeLine{5424 }
\DoxyCodeLine{5425 \textcolor{comment}{!    Zadj(1,1) = (4d0*q30*q20-\/q2q3*q2q3)}}
\DoxyCodeLine{5426 \textcolor{comment}{!    Zadj(2,1) = (q1q3*q2q3-\/2d0*q30*q1q2)}}
\DoxyCodeLine{5427 \textcolor{comment}{!    Zadj(3,1) = (q1q2*q2q3-\/2d0*q20*q1q3)}}
\DoxyCodeLine{5428 \textcolor{comment}{!    Zadj(1,2) = Zadj(2,1)}}
\DoxyCodeLine{5429 \textcolor{comment}{!    Zadj(2,2) = (4d0*q10*q30-\/q1q3*q1q3)}}
\DoxyCodeLine{5430 \textcolor{comment}{!    Zadj(3,2) = (q1q2*q1q3-\/2d0*q10*q2q3)}}
\DoxyCodeLine{5431 \textcolor{comment}{!    Zadj(1,3) = Zadj(3,1)}}
\DoxyCodeLine{5432 \textcolor{comment}{!    Zadj(2,3) = Zadj(3,2)}}
\DoxyCodeLine{5433 \textcolor{comment}{!    Zadj(3,3) = (4d0*q10*q20-\/q1q2*q1q2)}}
\DoxyCodeLine{5434 \textcolor{comment}{!}}
\DoxyCodeLine{5435 \textcolor{comment}{!    f(1) = q10+mm02-\/mm12}}
\DoxyCodeLine{5436 \textcolor{comment}{!    f(2) = q20+mm02-\/mm22}}
\DoxyCodeLine{5437 \textcolor{comment}{!    f(3) = q30+mm02-\/mm32}}
\DoxyCodeLine{5438       }
\DoxyCodeLine{5439 \textcolor{comment}{!    Zadjf(1) = Zadj(1,1)*f(1)+Zadj(2,1)*f(2)+Zadj(3,1)*f(3)}}
\DoxyCodeLine{5440 \textcolor{comment}{!    Zadjf(2) = Zadj(1,2)*f(1)+Zadj(2,2)*f(2)+Zadj(3,2)*f(3)}}
\DoxyCodeLine{5441 \textcolor{comment}{!    Zadjf(3) = Zadj(1,3)*f(1)+Zadj(2,3)*f(2)+Zadj(3,3)*f(3)}}
\DoxyCodeLine{5442 }
\DoxyCodeLine{5443 }
\DoxyCodeLine{5444     \textcolor{comment}{! coefficients Shat defined in (5.13)}}
\DoxyCodeLine{5445     \textcolor{keyword}{allocate}(shat(0:rmaxb,0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{5446 }
\DoxyCodeLine{5447     \textcolor{keywordflow}{do} r=0,rmaxb}
\DoxyCodeLine{5448       \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{5449 }
\DoxyCodeLine{5450         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{5451           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{5452           shat(n0,n1,n2,:) = -\/b\_0(n0,n1,n2)}
\DoxyCodeLine{5453 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{5454 }
\DoxyCodeLine{5455         k = r-\/2*n0}
\DoxyCodeLine{5456         shat(n0,0,k,1) = shat(n0,0,k,1) + b\_i(n0,k,1)}
\DoxyCodeLine{5457         shat(n0,k,0,2) = shat(n0,k,0,2) + b\_i(n0,k,2)}
\DoxyCodeLine{5458 }
\DoxyCodeLine{5459 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{5460 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{5461 }
\DoxyCodeLine{5462 }
\DoxyCodeLine{5463     \textcolor{comment}{! choose reduction formulas with biggest denominators}}
\DoxyCodeLine{5464     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)).ge.abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5465       j = 1}
\DoxyCodeLine{5466     \textcolor{keywordflow}{else} }
\DoxyCodeLine{5467       j = 2}
\DoxyCodeLine{5468 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{5469 }
\DoxyCodeLine{5470     zadj2f(1,2,1) = -\/\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)}
\DoxyCodeLine{5471     zadj2f(1,2,2) =  \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)}
\DoxyCodeLine{5472 }
\DoxyCodeLine{5473     maxzadj2f = 0d0                \textcolor{comment}{! Zadj2f(k,n,l) = Zadf2(k,n,l,m)*f(m)}}
\DoxyCodeLine{5474                                    \textcolor{comment}{! Zadj2(m) ==  Zadf2(k,n,l,m)}}
\DoxyCodeLine{5475                                    \textcolor{comment}{! maxZadj2f = fmax!!}}
\DoxyCodeLine{5476     \textcolor{keywordflow}{if} (abs(zadj2f(1,2,1)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5477       maxzadj2f = abs(zadj2f(1,2,1))}
\DoxyCodeLine{5478       k = 1}
\DoxyCodeLine{5479       n = 2}
\DoxyCodeLine{5480       l = 1}
\DoxyCodeLine{5481       m = 2}
\DoxyCodeLine{5482       zadj2(2,2) = -\/1d0}
\DoxyCodeLine{5483 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{5484     \textcolor{keywordflow}{if} (abs(zadj2f(1,2,2)).gt.maxzadj2f) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5485       maxzadj2f = abs(zadj2f(1,2,2))}
\DoxyCodeLine{5486       k = 1}
\DoxyCodeLine{5487       n = 2}
\DoxyCodeLine{5488       l = 2}
\DoxyCodeLine{5489       m = 1}
\DoxyCodeLine{5490       zadj2(2,1) =  1d0}
\DoxyCodeLine{5491 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{5492 }
\DoxyCodeLine{5493 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5494 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr maxZadj2f '},maxzadj2f,maxval(abs(zadj2f(:,:,:)))}
\DoxyCodeLine{5495     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Zadj2f '},zadj2f}
\DoxyCodeLine{5496     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Zadj2f '},zadj2f(1,2,1),zadj2f(1,2,1)}
\DoxyCodeLine{5497     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr f      '},\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}}
\DoxyCodeLine{5498 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5499 \textcolor{preprocessor}{}}
\DoxyCodeLine{5500     zadjfj = \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j)}
\DoxyCodeLine{5501     zadjkl = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)}
\DoxyCodeLine{5502 }
\DoxyCodeLine{5503 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5504 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr k,n,nt,l'},k,n,l,m}
\DoxyCodeLine{5505     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr pars'}, maxzadj2f,zadj2f(k,n,l),\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l),\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}}
\DoxyCodeLine{5506     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr pars'}, abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(l)),abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})}
\DoxyCodeLine{5507     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr pars'},  abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(l)/ maxzadj2f),abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}/maxzadj2f)}
\DoxyCodeLine{5508 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5509 \textcolor{preprocessor}{}}
\DoxyCodeLine{5510     zadjfj = \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j)}
\DoxyCodeLine{5511     zadjkl = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)}
\DoxyCodeLine{5512 }
\DoxyCodeLine{5513     \textcolor{comment}{! allocation of array for expanded C-\/coefficients}}
\DoxyCodeLine{5514     rmaxexp = rmaxb}
\DoxyCodeLine{5515     \textcolor{keyword}{allocate}(cexpgr(0:rmaxexp/2,0:rmaxexp,0:rmaxexp,0:ordgr\_max))}
\DoxyCodeLine{5516 }
\DoxyCodeLine{5517     \textcolor{comment}{! calculate Cuv}}
\DoxyCodeLine{5518     \textcolor{keyword}{allocate}(cuvexpgr(0:(rmaxexp+1),0:rmaxexp+1,0:rmaxexp+1))}
\DoxyCodeLine{5519     \textcolor{keyword}{call }calccuv(cuvexpgr,buv\_0,mm02,\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}},rmaxexp+1,id)}
\DoxyCodeLine{5520     cuv(0:rmax,0:rmax,0:rmax) = cuvexpgr(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{5521 }
\DoxyCodeLine{5522     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{5523     \textcolor{keyword}{allocate}(c00\_err(0:rmaxexp))}
\DoxyCodeLine{5524     \textcolor{keyword}{allocate}(cij\_err(0:rmaxexp))}
\DoxyCodeLine{5525     \textcolor{keyword}{allocate}(c00\_err2(0:rmaxexp))}
\DoxyCodeLine{5526     \textcolor{keyword}{allocate}(cij\_err2(0:rmaxexp))}
\DoxyCodeLine{5527      }
\DoxyCodeLine{5528     \textcolor{comment}{! initialize accuracy estimates}}
\DoxyCodeLine{5529     cerr = acc\_inf}
\DoxyCodeLine{5530     cij\_err =0d0}
\DoxyCodeLine{5531     c00\_err =0d0}
\DoxyCodeLine{5532 }
\DoxyCodeLine{5533     cerr2 = acc\_inf}
\DoxyCodeLine{5534     cij\_err2 =0d0}
\DoxyCodeLine{5535     c00\_err2 =0d0}
\DoxyCodeLine{5536 }
\DoxyCodeLine{5537 \textcolor{comment}{!    maxZadj = maxval(abs(Zadj))}}
\DoxyCodeLine{5538 \textcolor{comment}{!    maxZadj2f = maxval(abs(f(inds2(1,:))*Zadj2(:)))}}
\DoxyCodeLine{5539 }
\DoxyCodeLine{5540     \textcolor{comment}{! truncation of expansion if calculated term larger than truncfacexp * previous term}}
\DoxyCodeLine{5541     \textcolor{comment}{! crucial for expansion parameters between 0.1 and 1 !!!}}
\DoxyCodeLine{5542     truncfacexp = sqrt(\mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}}) * truncfacc}
\DoxyCodeLine{5543     gtrunc = ordgr\_max }
\DoxyCodeLine{5544 }
\DoxyCodeLine{5545 \textcolor{comment}{! calculate C(n0,n1,n2) up to rank r+n0}}
\DoxyCodeLine{5546     rloop: \textcolor{keywordflow}{do} r=0,rmaxexp/2}
\DoxyCodeLine{5547 }
\DoxyCodeLine{5548 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5549 \textcolor{preprocessor}{}\textcolor{comment}{!      write(*,*) 'CalcCgr rloop',r,rmax,gtrunc}}
\DoxyCodeLine{5550 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5551 \textcolor{preprocessor}{}}
\DoxyCodeLine{5552       \textcolor{keywordflow}{if} (r.gt.rmax+gtrunc) \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{5553 }
\DoxyCodeLine{5554 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5555 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr rloop'},r,rmaxexp,rmaxb}
\DoxyCodeLine{5556 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5557 \textcolor{preprocessor}{}}
\DoxyCodeLine{5558       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{5559       \textcolor{comment}{! 0th-\/order coefficients}}
\DoxyCodeLine{5560       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{5561 }
\DoxyCodeLine{5562       \textcolor{comment}{! calculating}}
\DoxyCodeLine{5563       \textcolor{comment}{! C\_00(a)0000..00 -\/-\/> C\_00(a)ij00..00 -\/-\/> C\_00(a)ijkl00..00 -\/-\/> ... -\/-\/> C\_00(a)ijklmn..}}
\DoxyCodeLine{5564       \textcolor{comment}{! exploiting eq. (5.40) -\/ (5.53) solved for C\_00i1..<ir>...iP}}
\DoxyCodeLine{5565       maxcexpgr(1,r,0)=0d0}
\DoxyCodeLine{5566       \textcolor{keywordflow}{do} n0=r,1,-\/1}
\DoxyCodeLine{5567         \textcolor{keywordflow}{do} nn=r-\/n0,0,-\/1}
\DoxyCodeLine{5568           nntt = r-\/n0-\/nn}
\DoxyCodeLine{5569 }
\DoxyCodeLine{5570 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5571 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr rloop'},n0,nn,zadj2f(k,n,l)}
\DoxyCodeLine{5572 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5573 \textcolor{preprocessor}{}}
\DoxyCodeLine{5574           inds0(n) = nn}
\DoxyCodeLine{5575           inds0(k) = nntt}
\DoxyCodeLine{5576             }
\DoxyCodeLine{5577 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5578 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr inds0'},n0,inds0}
\DoxyCodeLine{5579 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5580 \textcolor{preprocessor}{}}
\DoxyCodeLine{5581           inds1(n) = nn+1}
\DoxyCodeLine{5582           inds1(k) = nntt}
\DoxyCodeLine{5583 }
\DoxyCodeLine{5584 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5585 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr inds1'},n0,inds1}
\DoxyCodeLine{5586 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5587 \textcolor{preprocessor}{}}
\DoxyCodeLine{5588           caux = -\/\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)*b\_0(n0-\/1,inds1(1),inds1(2))}
\DoxyCodeLine{5589 }
\DoxyCodeLine{5590 \textcolor{comment}{!            Caux = 2*Zadj(k,l) * (1+r-\/2*n0) * Cexpgr(n0,inds1(1),inds1(2),0)}}
\DoxyCodeLine{5591 }
\DoxyCodeLine{5592 \textcolor{comment}{!            inds = inds1}}
\DoxyCodeLine{5593 \textcolor{comment}{!            inds(k) = inds(k) + 1}}
\DoxyCodeLine{5594 \textcolor{comment}{!            inds(l) = inds(l) + 1}}
\DoxyCodeLine{5595 \textcolor{comment}{!            Caux = Caux + detZ * Cexpgr(n0-\/1,inds(1),inds(2),0)}}
\DoxyCodeLine{5596 \textcolor{comment}{!}}
\DoxyCodeLine{5597 \textcolor{comment}{!            inds = inds1}}
\DoxyCodeLine{5598 \textcolor{comment}{!            inds(k) = inds(k) + 1}}
\DoxyCodeLine{5599 \textcolor{comment}{!            Caux = Caux + Zadjf(l) * Cexpgr(n0-\/1,inds(1),inds(2),0)}}
\DoxyCodeLine{5600 }
\DoxyCodeLine{5601 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5602 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux 1c'},-\/\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)*b\_0(n0-\/1,inds1(1),inds1(2))}
\DoxyCodeLine{5603           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux 1s'},caux,caux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{5604 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5605 \textcolor{preprocessor}{}          }
\DoxyCodeLine{5606           inds = inds1}
\DoxyCodeLine{5607           inds(k) = inds(k)+1}
\DoxyCodeLine{5608           \textcolor{keywordflow}{do} i=1,2}
\DoxyCodeLine{5609             caux = caux -\/ \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,l)*shat(n0-\/1,inds(1),inds(2),i)}
\DoxyCodeLine{5610 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5611 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux 2ci'}, -\/\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,l)*shat(n0-\/1,inds(1),inds(2),i)}
\DoxyCodeLine{5612 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5613 \textcolor{preprocessor}{}\textcolor{keywordflow}{          end do}}
\DoxyCodeLine{5614 }
\DoxyCodeLine{5615 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5616 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux 2s'},caux,caux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{5617 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5618 \textcolor{preprocessor}{}}
\DoxyCodeLine{5619           \textcolor{keywordflow}{do} i=1,2}
\DoxyCodeLine{5620             inds = inds1}
\DoxyCodeLine{5621             inds(i) = inds(i)+1}
\DoxyCodeLine{5622             caux = caux + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)*shat(n0-\/1,inds(1),inds(2),i)}
\DoxyCodeLine{5623 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5624 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux 3ci'},\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)*shat(n0-\/1,inds(1),inds(2),i)}
\DoxyCodeLine{5625 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5626 \textcolor{preprocessor}{}\textcolor{keywordflow}{          end do}}
\DoxyCodeLine{5627 }
\DoxyCodeLine{5628 }
\DoxyCodeLine{5629 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5630 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux 3s'},caux,caux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{5631 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5632 \textcolor{preprocessor}{}}
\DoxyCodeLine{5633           caux = caux + 2*(nn+1) *zadj2(n ,m )*shat(n0,inds0(1),inds0(2),m)}
\DoxyCodeLine{5634 }
\DoxyCodeLine{5635 }
\DoxyCodeLine{5636 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5637 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux 4ca'}, 2*(nn+1) *zadj2(n ,m )*shat(n0,inds0(1),inds0(2),m) }
\DoxyCodeLine{5638           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux 4s'},caux,caux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{5639 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5640 \textcolor{preprocessor}{}}
\DoxyCodeLine{5641 \textcolor{comment}{!            Caux = Caux -\/ 2*(nn+1)* Zadj2f(k,n,l)*Cexpgr(n0,inds0(1),inds0(2),0) }}
\DoxyCodeLine{5642 }
\DoxyCodeLine{5643           inds = inds1}
\DoxyCodeLine{5644           \textcolor{keywordflow}{if}(m.eq.n) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5645             \textcolor{keywordflow}{if} (inds(n).gt.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5646               inds(n) = inds(n)-\/2}
\DoxyCodeLine{5647               caux = caux -\/ 4*(nn+1)*nn * zadj2(n,m ) * cexpgr(n0+1,inds(1),inds(2),0) }
\DoxyCodeLine{5648 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5649 \textcolor{preprocessor}{}              \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux 6c'},4*(nn+1)*nn* zadj2(n,m ) *cexpgr(n0+1,inds(1),inds(2),0) }
\DoxyCodeLine{5650               \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux 6s'},caux,caux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{5651 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5652 \textcolor{preprocessor}{}\textcolor{keywordflow}{            end if}}
\DoxyCodeLine{5653           \textcolor{keywordflow}{else}}
\DoxyCodeLine{5654             \textcolor{keywordflow}{if} (inds(n).gt.0.and.inds(m).gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5655               inds(n) = inds(n)-\/1}
\DoxyCodeLine{5656               inds(m) = inds(m)-\/1}
\DoxyCodeLine{5657               caux = caux -\/ 4*(nn+1)*(inds(m)+1)* zadj2(n,m ) * cexpgr(n0+1,inds(1),inds(2),0) }
\DoxyCodeLine{5658 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5659 \textcolor{preprocessor}{}              \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux 6c'},-\/4*(nn+1)*(inds(m)+1)* zadj2(n,m ) *cexpgr(n0+1,inds(1),inds(2),0) }
\DoxyCodeLine{5660               \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux 6s'},caux,caux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{5661 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5662 \textcolor{preprocessor}{}\textcolor{keywordflow}{            end if}}
\DoxyCodeLine{5663 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{5664           }
\DoxyCodeLine{5665           cexpgr(n0,inds0(1),inds0(2),0) = caux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{5666           }
\DoxyCodeLine{5667           \textcolor{keywordflow}{if} (n0.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5668             maxcexpgr(1,r,0) =  maxcexpgr(1,r,0) + abs(cexpgr(n0,inds0(1),inds0(2),0) )}
\DoxyCodeLine{5669 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{5670           }
\DoxyCodeLine{5671 \textcolor{comment}{!          if (r+n0.le.rmax) then             !  for fixed rank}}
\DoxyCodeLine{5672           \textcolor{keywordflow}{if} (r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5673             c(n0,inds0(1),inds0(2)) = cexpgr(n0,inds0(1),inds0(2),0)}
\DoxyCodeLine{5674 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{5675           }
\DoxyCodeLine{5676 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{5677 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{5678 }
\DoxyCodeLine{5679       \textcolor{comment}{! calculate}}
\DoxyCodeLine{5680       \textcolor{comment}{! C\_00ijkl.. -\/-\/> C\_aijkl..}}
\DoxyCodeLine{5681       \textcolor{comment}{! exploiting eq. (5.38)}}
\DoxyCodeLine{5682       maxcexpgr(0,r,0)=0d0}
\DoxyCodeLine{5683       \textcolor{keywordflow}{do} n1=0,r}
\DoxyCodeLine{5684         n2 = r-\/n1}
\DoxyCodeLine{5685 }
\DoxyCodeLine{5686         smod = shat(0,n1,n2,:)}
\DoxyCodeLine{5687         \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5688           smod(1) = smod(1) -\/ 2d0*n1*cexpgr(1,n1-\/1,n2,0)}
\DoxyCodeLine{5689 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{5690         \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5691           smod(2) = smod(2) -\/ 2d0*n2*cexpgr(1,n1,n2-\/1,0)}
\DoxyCodeLine{5692 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{5693 }
\DoxyCodeLine{5694         cexpgr(0,n1,n2,0) = (\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1) +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2)  \&}
\DoxyCodeLine{5695             )/zadjfj}
\DoxyCodeLine{5696         maxcexpgr(0,r,0) =  maxcexpgr(0,r,0) + abs(cexpgr(0,n1,n2,0))}
\DoxyCodeLine{5697         \textcolor{keywordflow}{if} (r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5698           c(0,n1,n2) = cexpgr(0,n1,n2,0)}
\DoxyCodeLine{5699 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{5700 }
\DoxyCodeLine{5701 }
\DoxyCodeLine{5702 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5703 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if}(r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5704           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr C(0,n1,n2,0)='},n1,n2,c(0,n1,n2)}
\DoxyCodeLine{5705 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{5706         }
\DoxyCodeLine{5707         \textcolor{keywordflow}{if}(n0.eq.0.and.n1.eq.0.and.n2.eq.3) \textcolor{keywordflow}{then} }
\DoxyCodeLine{5708           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'C(0,0,3)= '},0,c(n0,n1,n2)}
\DoxyCodeLine{5709 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{5710 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5711 \textcolor{preprocessor}{}}
\DoxyCodeLine{5712 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{5713 }
\DoxyCodeLine{5714 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5715 \textcolor{preprocessor}{}\textcolor{comment}{!      write(*,*) 'CalcCgr maxCexpgr 0',r-\/1, maxCexpgr(0,r-\/1,0)}}
\DoxyCodeLine{5716 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5717 \textcolor{preprocessor}{}}
\DoxyCodeLine{5718       \textcolor{keywordflow}{if}(r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5719 \textcolor{comment}{!       Cerr(r) =  abs(detZ/Zadjfj)*maxCexpgr(0,r,0)}}
\DoxyCodeLine{5720         cerr(r) =  \mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}}*maxcexpgr(0,r,0)}
\DoxyCodeLine{5721 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{5722 }
\DoxyCodeLine{5723       \textcolor{comment}{! error propagation from C's}}
\DoxyCodeLine{5724       \textcolor{keywordflow}{if}(r.gt.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{5725         c00\_err(r+1) = \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*b\_err/(2*maxzadj2f)}
\DoxyCodeLine{5726 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{5727       cij\_err(r)=\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(b\_err,2*c00\_err(r+1))/abs(zadjfj)}
\DoxyCodeLine{5728 }
\DoxyCodeLine{5729       \textcolor{keywordflow}{if}(r.gt.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{5730         c00\_err2(r+1) = \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*b\_err/(2*maxzadj2f)}
\DoxyCodeLine{5731 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{5732       cij\_err2(r)=\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(b\_err,2*c00\_err2(r+1))/abs(zadjfj)}
\DoxyCodeLine{5733 }
\DoxyCodeLine{5734       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{5735       \textcolor{comment}{! higher order coefficients}}
\DoxyCodeLine{5736       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{5737 }
\DoxyCodeLine{5738       rg = r}
\DoxyCodeLine{5739       gloop: \textcolor{keywordflow}{do} g=1,min(gtrunc,r)}
\DoxyCodeLine{5740         rg = rg-\/1}
\DoxyCodeLine{5741 }
\DoxyCodeLine{5742 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5743 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr: gloop '},r,rg,g}
\DoxyCodeLine{5744 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5745 \textcolor{preprocessor}{}}
\DoxyCodeLine{5746         \textcolor{comment}{! calculating}}
\DoxyCodeLine{5747         \textcolor{comment}{! C\_00(a)0000..00 -\/-\/> C\_00(a)ij00..00 -\/-\/> C\_00(a)ijkl00..00 -\/-\/> ... -\/-\/> C\_00(a)ijklmn..}}
\DoxyCodeLine{5748        \textcolor{comment}{! exploiting eq. (5.40) -\/ (5.53) solved for C\_00i1..<ir>...iP}}
\DoxyCodeLine{5749         maxcexpgr(1,rg,g) = 0d0}
\DoxyCodeLine{5750         \textcolor{keywordflow}{do} n0=rg,1,-\/1                      \textcolor{comment}{!  note rank of tensor = rg+n0}}
\DoxyCodeLine{5751           \textcolor{keywordflow}{do} nn=rg-\/n0,0,-\/1}
\DoxyCodeLine{5752             nntt = rg-\/n0-\/nn}
\DoxyCodeLine{5753             inds0(n) = nn}
\DoxyCodeLine{5754             inds0(k) = nntt}
\DoxyCodeLine{5755               }
\DoxyCodeLine{5756             inds1(n) = nn+1}
\DoxyCodeLine{5757             inds1(k) = nntt}
\DoxyCodeLine{5758               }
\DoxyCodeLine{5759 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5760 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux r inds='},n0,inds0}
\DoxyCodeLine{5761 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{5762 \textcolor{preprocessor}{}}
\DoxyCodeLine{5763             caux = 2*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l) * (2+rg-\/n0) * cexpgr(n0,inds1(1),inds1(2),g-\/1)}
\DoxyCodeLine{5764               }
\DoxyCodeLine{5765 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5766 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux r1c'},2*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)*(2+rg-\/n0)* cexpgr(n0,inds1(1),inds1(2),g-\/1)}
\DoxyCodeLine{5767             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux r1c'},2*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)*(2+rg-\/n0),cexpgr(n0,inds1(1),inds1(2),g-\/1) \&}
\DoxyCodeLine{5768                 ,n0,inds1(1),inds1(2)}
\DoxyCodeLine{5769             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux r1s'},caux,caux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{5770 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{5771 \textcolor{preprocessor}{}}
\DoxyCodeLine{5772             \textcolor{keywordflow}{if} (g.gt.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5773               inds = inds1}
\DoxyCodeLine{5774               inds(k) = inds(k) + 1}
\DoxyCodeLine{5775               inds(l) = inds(l) + 1}
\DoxyCodeLine{5776               caux = caux + \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}} * cexpgr(n0-\/1,inds(1),inds(2),g-\/2)}
\DoxyCodeLine{5777                 }
\DoxyCodeLine{5778 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5779 \textcolor{preprocessor}{}              \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux r2c'},\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}} * cexpgr(n0-\/1,inds(1),inds(2),g-\/2)}
\DoxyCodeLine{5780               \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux r2s'},caux,caux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{5781 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{5782 \textcolor{preprocessor}{}\textcolor{keywordflow}{            end if}}
\DoxyCodeLine{5783 }
\DoxyCodeLine{5784             inds = inds1}
\DoxyCodeLine{5785             inds(k) = inds(k) + 1}
\DoxyCodeLine{5786             caux = caux + \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(l) * cexpgr(n0-\/1,inds(1),inds(2),g-\/1)}
\DoxyCodeLine{5787             }
\DoxyCodeLine{5788 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5789 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux r3c'},\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(l)* cexpgr(n0-\/1,inds(1),inds(2),g-\/1)}
\DoxyCodeLine{5790             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux r3c'},\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(l),cexpgr(n0-\/1,inds(1),inds(2),g-\/1),n0-\/1,inds(1),inds(2)}
\DoxyCodeLine{5791             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux r3s'},caux,caux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{5792 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{5793 \textcolor{preprocessor}{}}
\DoxyCodeLine{5794 \textcolor{comment}{!            Caux = Caux -\/ 2*nn* Zadj2f(k,n,l)*Cexpgr(n0,inds0(1),inds0(2),g) }}
\DoxyCodeLine{5795 }
\DoxyCodeLine{5796             inds = inds1}
\DoxyCodeLine{5797             \textcolor{keywordflow}{if}(m.eq.n) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5798               \textcolor{keywordflow}{if} (inds(n).gt.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5799                 inds(n) = inds(n)-\/2}
\DoxyCodeLine{5800                 caux = caux -\/ 4*(nn+1)*nn * zadj2(n,m ) * cexpgr(n0+1,inds(1),inds(2),g) }
\DoxyCodeLine{5801 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5802 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux r6c'},4*(nn+1)*nn* zadj2(n,m ) *cexpgr(n0+1,inds(1),inds(2),g) }
\DoxyCodeLine{5803                 \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux r6s'},caux,caux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{5804 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{5805 \textcolor{preprocessor}{}\textcolor{keywordflow}{              end if}}
\DoxyCodeLine{5806             \textcolor{keywordflow}{else}}
\DoxyCodeLine{5807               \textcolor{keywordflow}{if} (inds(n).gt.0.and.inds(m).gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5808                 inds(n) = inds(n)-\/1}
\DoxyCodeLine{5809                 inds(m) = inds(m)-\/1}
\DoxyCodeLine{5810                 caux = caux -\/ 4*(nn+1)*(inds(m)+1)* zadj2(n,m ) * cexpgr(n0+1,inds(1),inds(2),g) }
\DoxyCodeLine{5811 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5812 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux r6c'},4*(nn+1)*(inds(m)+1)* zadj2(n,m ) *cexpgr(n0+1,inds(1),inds(2),g) }
\DoxyCodeLine{5813                 \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux r6c'},n,m,nn,4*(nn+1)*(inds(m)+1),zadj2(n,m ),cexpgr(n0+1,inds(1),inds(2),g) }
\DoxyCodeLine{5814                 \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Caux r6s'},caux,caux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{5815 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{5816 \textcolor{preprocessor}{}\textcolor{keywordflow}{              end if}}
\DoxyCodeLine{5817 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{5818               }
\DoxyCodeLine{5819 }
\DoxyCodeLine{5820             cexpgr(n0,inds0(1),inds0(2),g) = caux/(2*(nn+1)* zadj2f(k,n,l))}
\DoxyCodeLine{5821                              }
\DoxyCodeLine{5822             \textcolor{keywordflow}{if}(n0.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5823               maxcexpgr(1,rg,g) =  maxcexpgr(1,rg,g) + abs(cexpgr(n0,inds0(1),inds0(2),g))}
\DoxyCodeLine{5824               }
\DoxyCodeLine{5825               \textcolor{keywordflow}{if} (g.eq.1.and.abs(cexpgr(n0,inds0(1),inds0(2),g)).gt.   \& }
\DoxyCodeLine{5826                   truncfacexp*max(1d0,maxcexpgr(1,rg,g-\/1)) .or.        \&}
\DoxyCodeLine{5827                   g.ge.2.and.abs(cexpgr(n0,inds0(1),inds0(2),g)).gt.   \&}
\DoxyCodeLine{5828                   truncfacexp*maxcexpgr(1,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5829 }
\DoxyCodeLine{5830 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5831 \textcolor{preprocessor}{}                \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr exit gloop'},n0,inds0(1),inds0(2),g,rg,  \&}
\DoxyCodeLine{5832                     abs(cexpgr(n0,inds0(1),inds0(2),g)),maxcexpgr(1,rg,g-\/1),truncfacexp}
\DoxyCodeLine{5833 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{5834 \textcolor{preprocessor}{}                }
\DoxyCodeLine{5835                 gtrunc = g-\/1}
\DoxyCodeLine{5836                 \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{5837 \textcolor{keywordflow}{              end if}}
\DoxyCodeLine{5838 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{5839 }
\DoxyCodeLine{5840 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{5841 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{5842 }
\DoxyCodeLine{5843 \textcolor{preprocessor}{\#ifndef PPEXP00}}
\DoxyCodeLine{5844 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (rg.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5845           \textcolor{keywordflow}{do} n0=rg,1,-\/1}
\DoxyCodeLine{5846 \textcolor{comment}{!            if (rg+n0.le.rmax) then       ! for fixed rank}}
\DoxyCodeLine{5847             \textcolor{keywordflow}{if} (rg.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5848               \textcolor{keywordflow}{do} n1=0,rg-\/n0}
\DoxyCodeLine{5849                 n2=rg-\/n0-\/n1}
\DoxyCodeLine{5850                 c(n0,n1,n2) = c(n0,n1,n2) + cexpgr(n0,n1,n2,g)}
\DoxyCodeLine{5851 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{5852 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{5853 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{5854 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{5855 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5856 \textcolor{preprocessor}{}\textcolor{comment}{!        write(*,*) 'CalcCgr after it1 ',rg}}
\DoxyCodeLine{5857 }
\DoxyCodeLine{5858         \textcolor{comment}{! calculate}}
\DoxyCodeLine{5859         \textcolor{comment}{! C\_00ijkl.. -\/-\/> C\_aijkl..}}
\DoxyCodeLine{5860         \textcolor{comment}{! exploiting eq. (5.38)}}
\DoxyCodeLine{5861 }
\DoxyCodeLine{5862 \textcolor{comment}{!        write(*,*) 'CalcCgr maxCexp',rg,g-\/1,maxCexpgr(0,rg,g-\/1)}}
\DoxyCodeLine{5863 }
\DoxyCodeLine{5864         maxcexpgr(0,rg,g) = 0d0}
\DoxyCodeLine{5865         \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{5866           n2 = rg-\/n1}
\DoxyCodeLine{5867           }
\DoxyCodeLine{5868           smod = 0d0}
\DoxyCodeLine{5869           \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5870             smod(1) = smod(1) -\/ 2d0*n1*cexpgr(1,n1-\/1,n2,g)}
\DoxyCodeLine{5871 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{5872           \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5873             smod(2) = smod(2) -\/ 2d0*n2*cexpgr(1,n1,n2-\/1,g)}
\DoxyCodeLine{5874 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{5875 }
\DoxyCodeLine{5876           inds(1) = n1}
\DoxyCodeLine{5877           inds(2) = n2}
\DoxyCodeLine{5878           inds(j) = inds(j)+1}
\DoxyCodeLine{5879           cexpgr(0,n1,n2,g) = (\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1) +  \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2)  \&}
\DoxyCodeLine{5880               -\/ \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*cexpgr(0,inds(1),inds(2),g-\/1))/zadjfj}
\DoxyCodeLine{5881 }
\DoxyCodeLine{5882           maxcexpgr(0,rg,g) =  maxcexpgr(0,rg,g) + abs(cexpgr(0,n1,n2,g))}
\DoxyCodeLine{5883 }
\DoxyCodeLine{5884 \textcolor{comment}{!              if(n1.eq.0.and.n2.eq.1) then }}
\DoxyCodeLine{5885 \textcolor{comment}{!                write(*,*) 'C2(2,3)= ',g,Cexpgr(0,n1,n2,g)}}
\DoxyCodeLine{5886 \textcolor{comment}{!                write(*,*) 'C2(2,3)= ',Zadj(1,j)*Smod(1)/Zadjfj,  Zadj(2,j)*Smod(2)/Zadjfj,  \&}}
\DoxyCodeLine{5887 \textcolor{comment}{!                                -\/ detZ*Cexpgr(0,inds(1),inds(2),g-\/1)/Zadjfj}}
\DoxyCodeLine{5888 \textcolor{comment}{!                write(*,*) 'C2(2,3)= ',inds(1),inds(2),         \&}}
\DoxyCodeLine{5889 \textcolor{comment}{!                                -\/ detZ/Zadjfj,Cexpgr(0,inds(1),inds(2),g-\/1)}}
\DoxyCodeLine{5890 \textcolor{comment}{!              end if}}
\DoxyCodeLine{5891 }
\DoxyCodeLine{5892           \textcolor{keywordflow}{if} (g.eq.1.and.abs(cexpgr(0,n1,n2,g)).gt.        \&}
\DoxyCodeLine{5893               truncfacexp*max(1d0/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}},maxcexpgr(0,rg,g-\/1)).or.     \&}
\DoxyCodeLine{5894               g.ge.2.and.abs(cexpgr(0,n1,n2,g)).gt.        \&}
\DoxyCodeLine{5895               truncfacexp*maxcexpgr(0,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5896 }
\DoxyCodeLine{5897 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5898 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr exit gloop'},0,n1,n2,g,abs(cexpgr(0,n1,n2,g)),maxcexpgr(0,rg,g-\/1),truncfacexp}
\DoxyCodeLine{5899 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{5900 \textcolor{preprocessor}{}            gtrunc = g-\/1}
\DoxyCodeLine{5901             \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{5902 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{5903 }
\DoxyCodeLine{5904 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{5905 }
\DoxyCodeLine{5906         \textcolor{comment}{! error propagation from C's}}
\DoxyCodeLine{5907         \textcolor{keywordflow}{if}(rg.gt.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{5908           c00\_err(rg+1) = max( c00\_err(rg+1),                   \&}
\DoxyCodeLine{5909               max( \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*(2+rg-\/2*n0)*c00\_err(rg+2),       \&}
\DoxyCodeLine{5910                     abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})*cij\_err(rg+2),                \&}
\DoxyCodeLine{5911                     \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*cij\_err(rg+1)                   \&}
\DoxyCodeLine{5912                  ) / (2*maxzadj2f)  ) }
\DoxyCodeLine{5913 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{5914         cij\_err(rg)=max(cij\_err(rg),                \&}
\DoxyCodeLine{5915             max(2*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*c00\_err(rg+1),abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})*cij\_err(rg))/abs(zadjfj) )}
\DoxyCodeLine{5916 }
\DoxyCodeLine{5917         \textcolor{keywordflow}{if}(rg.gt.0)\textcolor{keywordflow}{then}}
\DoxyCodeLine{5918           c00\_err2(rg+1) = max( c00\_err2(rg+1),                   \&}
\DoxyCodeLine{5919               max( \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*(2+rg-\/2*n0)*c00\_err2(rg+2),       \&}
\DoxyCodeLine{5920                     abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})*cij\_err2(rg+2),                \&}
\DoxyCodeLine{5921                     \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*cij\_err2(rg+1)                   \&}
\DoxyCodeLine{5922                  ) / (2*maxzadj2f)  ) }
\DoxyCodeLine{5923 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{5924         cij\_err2(rg)=max(cij\_err2(rg),                \&}
\DoxyCodeLine{5925             max(2*\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*c00\_err2(rg+1),abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})*cij\_err2(rg))/abs(zadjfj) )}
\DoxyCodeLine{5926 }
\DoxyCodeLine{5927 \textcolor{preprocessor}{\#ifdef PPEXP00}}
\DoxyCodeLine{5928 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (rg.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5929           \textcolor{keywordflow}{do} n0=rg,1,-\/1}
\DoxyCodeLine{5930 \textcolor{comment}{!            if (rg+n0.le.rmax) then       ! for fixed rank}}
\DoxyCodeLine{5931             \textcolor{keywordflow}{if} (rg.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5932               \textcolor{keywordflow}{do} n1=0,rg-\/n0}
\DoxyCodeLine{5933                 n2=rg-\/n0-\/n1}
\DoxyCodeLine{5934                 c(n0,n1,n2) = c(n0,n1,n2) + cexpgr(n0,n1,n2,g)}
\DoxyCodeLine{5935 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{5936 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{5937 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{5938 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{5939 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5940 \textcolor{preprocessor}{}}
\DoxyCodeLine{5941         \textcolor{keywordflow}{if} (rg.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5942           cerr(rg) = 0d0}
\DoxyCodeLine{5943           \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{5944               n2 = rg-\/n1}
\DoxyCodeLine{5945               c(0,n1,n2) = c(0,n1,n2) + cexpgr(0,n1,n2,g)}
\DoxyCodeLine{5946             \textcolor{keywordflow}{if}(abs(cexpgr(0,n1,n2,g-\/1)).ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5947 \textcolor{comment}{!             Cerr(rg)=max(Cerr(rg),abs(Cexpgr(0,n1,n2,g))**2/abs(Cexpgr(0,n1,n2,g-\/1)))}}
\DoxyCodeLine{5948               cerr(rg)=max(cerr(rg),abs(cexpgr(0,n1,n2,g))*min(1d0,abs(cexpgr(0,n1,n2,g))/abs(cexpgr(0,n1,n2,g-\/1))))}
\DoxyCodeLine{5949             \textcolor{keywordflow}{else}}
\DoxyCodeLine{5950               cerr(rg)=max(cerr(rg),abs(cexpgr(0,n1,n2,g)))}
\DoxyCodeLine{5951 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{5952 }
\DoxyCodeLine{5953 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5954 \textcolor{preprocessor}{}              \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Cerr calc'},rg,cerr(rg),n1,n2,abs(cexpgr(0,n1,n2,g)),abs(cexpgr(0,n1,n2,g-\/1))}
\DoxyCodeLine{5955 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5956 \textcolor{preprocessor}{}}
\DoxyCodeLine{5957 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{5958 }
\DoxyCodeLine{5959           \textcolor{comment}{! if error from B's larger than error from expansion stop expansion}}
\DoxyCodeLine{5960           \textcolor{keywordflow}{if}(cij\_err(rg).gt.3d0*cerr(rg)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{5961             gtrunc = min(g,gtrunc)}
\DoxyCodeLine{5962              }
\DoxyCodeLine{5963 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5964 \textcolor{preprocessor}{}             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr exit err'},r,rg,g,gtrunc,cij\_err(rg),cerr(rg)}
\DoxyCodeLine{5965 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5966 \textcolor{preprocessor}{}}
\DoxyCodeLine{5967 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{5968 }
\DoxyCodeLine{5969 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{5970 }
\DoxyCodeLine{5971 \textcolor{keywordflow}{      end do} gloop}
\DoxyCodeLine{5972 }
\DoxyCodeLine{5973 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{5974 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr C(0,0,0) = '},r,c(0,0,0)}
\DoxyCodeLine{5975     \textcolor{keywordflow}{if}(r.ge.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{5976       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr C(1,0,0) = '},r,c(1,0,0)}
\DoxyCodeLine{5977       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr C(0,1,0) = '},r,c(0,1,0)}
\DoxyCodeLine{5978       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr C(0,0,1) = '},r,c(0,0,1)}
\DoxyCodeLine{5979       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr C(0,0,0) = '},r,c(0,0,0)}
\DoxyCodeLine{5980 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{5981     \textcolor{keywordflow}{if}(r.ge.2.and.rmax.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{5982       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr C(1,1,0) = '},r,c(1,1,0)}
\DoxyCodeLine{5983       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr C(1,0,1) = '},r,c(1,0,1)}
\DoxyCodeLine{5984       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr C(1,0,0) = '},r,c(1,0,0)}
\DoxyCodeLine{5985 \textcolor{comment}{!      write(*,*) 'CalcCgr C(0,2,0) = ',r,C(0,2,0)}}
\DoxyCodeLine{5986 \textcolor{comment}{!      write(*,*) 'CalcCgr C(0,1,1) = ',r,C(0,1,1)}}
\DoxyCodeLine{5987       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr C(0,0,2) = '},r,c(0,0,2)}
\DoxyCodeLine{5988 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{5989     \textcolor{keywordflow}{if}(r.ge.3.and.rmax.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{5990 \textcolor{comment}{!      write(*,*) 'CalcCgr C(3,0,0) = ',r,C(3,0,0)}}
\DoxyCodeLine{5991 \textcolor{comment}{!      write(*,*) 'CalcCgr C(2,0,1) = ',r,C(2,0,1)}}
\DoxyCodeLine{5992       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr C(1,0,2) = '},r,c(1,0,2)}
\DoxyCodeLine{5993       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr C(0,3,0) = '},r,c(0,3,0)}
\DoxyCodeLine{5994       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr C(0,2,1) = '},r,c(0,2,1)}
\DoxyCodeLine{5995       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr C(0,0,3) = '},r,c(0,0,3)}
\DoxyCodeLine{5996       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr C(0,1,1) = '},r,c(0,1,1)}
\DoxyCodeLine{5997       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr C(0,0,2) = '},r,c(0,0,2)}
\DoxyCodeLine{5998 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{5999       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Cij\_err'},r,cij\_err}
\DoxyCodeLine{6000       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr Cij\_acc'},r,cij\_err/abs(c(0,0,0))}
\DoxyCodeLine{6001 }
\DoxyCodeLine{6002       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr err'},r,cerr}
\DoxyCodeLine{6003       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr acc'},r,cerr/abs(c(0,0,0))}
\DoxyCodeLine{6004 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6005 \textcolor{preprocessor}{}}
\DoxyCodeLine{6006       cerr2 = max(cerr,cij\_err2(0:rmax))}
\DoxyCodeLine{6007       cerr = max(cerr,cij\_err(0:rmax))}
\DoxyCodeLine{6008 }
\DoxyCodeLine{6009 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{6010 \textcolor{preprocessor}{}\textcolor{comment}{!      write(*,*) 'CalcCgr exit r',r,maxval(Cerr),acc\_req\_C*abs(C(0,0,0))}}
\DoxyCodeLine{6011 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6012 \textcolor{preprocessor}{}}
\DoxyCodeLine{6013 \textcolor{comment}{!      if(maxval(Cerr).le.acc\_req\_C*abs(C(0,0,0))) exit           changed 28.01.15}}
\DoxyCodeLine{6014       \textcolor{comment}{! check if target precision already reached}}
\DoxyCodeLine{6015 \textcolor{preprocessor}{\#ifdef Cutrloop}}
\DoxyCodeLine{6016 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(cerr-\/acc\_req\_cr*abs(c(0,0,0))).le.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6017         \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{6018         \textcolor{keywordflow}{do} n0=0,rg/2}
\DoxyCodeLine{6019         \textcolor{keywordflow}{do} n1=0,rg-\/n0}
\DoxyCodeLine{6020           c(n0,n1,rg-\/n0-\/n1)=0d0}
\DoxyCodeLine{6021 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{6022 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{6023 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{6024 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{6025 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(cerr-\/acc\_req\_cr*abs(c(0,0,0))).le.0d0.and.r.ge.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6026 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6027 \textcolor{preprocessor}{}        \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{6028 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6029 }
\DoxyCodeLine{6030 \textcolor{keywordflow}{    end do} rloop}
\DoxyCodeLine{6031 }
\DoxyCodeLine{6032 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{6033 \textcolor{preprocessor}{}\textcolor{comment}{!    write(*,*) 'CalcCgr C(0,0,0) = ',C(0,0,0)}}
\DoxyCodeLine{6034 \textcolor{comment}{!    if(rmax.ge.3)then}}
\DoxyCodeLine{6035 \textcolor{comment}{!      write(*,*) 'CalcCgr C(0,1,1,1) = ',C(0,1,1,1)}}
\DoxyCodeLine{6036 \textcolor{comment}{!    end if}}
\DoxyCodeLine{6037 }
\DoxyCodeLine{6038     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr final err'},cerr}
\DoxyCodeLine{6039     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr final acc'},cerr /abs(c(0,0,0))}
\DoxyCodeLine{6040 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{6041 \textcolor{preprocessor}{}                           }
\DoxyCodeLine{6042 \textcolor{comment}{!   write(*,*) 'CalcCgr out',(((C((r-\/n1-\/n2)/2,n1,n2),n2=0,r-\/n1),n1=0,r),r=0,rmax)}}
\DoxyCodeLine{6043 \textcolor{preprocessor}{\#ifdef TRACECout}}
\DoxyCodeLine{6044 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr rmax'},rmax}
\DoxyCodeLine{6045     \textcolor{keywordflow}{do} r=14,rmax}
\DoxyCodeLine{6046     \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{6047     \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{6048     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr out'},r,n0,n1,r-\/2*n0-\/n1,c(n0,n1,r-\/2*n0-\/n1)}
\DoxyCodeLine{6049 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{6050 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{6051 \textcolor{keywordflow}{    end do}   }
\DoxyCodeLine{6052 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6053 \textcolor{preprocessor}{}}
\DoxyCodeLine{6054 \textcolor{comment}{!    write(*,*) 'CalcCgr Cerr ',Cerr}}
\DoxyCodeLine{6055 \textcolor{comment}{!    write(*,*) 'CalcCgr Cerr2',Cerr2}}
\DoxyCodeLine{6056 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductionc_afd9cf6480f6a7a06c66ba147e1554d30}\label{namespacereductionc_afd9cf6480f6a7a06c66ba147e1554d30}} 
\index{reductionc@{reductionc}!calccgy@{calccgy}}
\index{calccgy@{calccgy}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{calccgy()}{calccgy()}}
{\footnotesize\ttfamily subroutine reductionc\+::calccgy (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{C,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Cuv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{ordgy\+\_\+min,  }\item[{integer, intent(in)}]{ordgy\+\_\+max,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr,  }\item[{double precision, dimension(0\+:rmax), intent(in)}]{acc\+\_\+req\+\_\+\+Cr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr2 }\end{DoxyParamCaption})}



Definition at line 6070 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{6070   }
\DoxyCodeLine{6071     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobalc}{globalc}}}
\DoxyCodeLine{6072   }
\DoxyCodeLine{6073     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,ordgy\_min,ordgy\_max,id}
\DoxyCodeLine{6074     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{6075     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: C(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{6076     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Cuv(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{6077     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Cerr(0:rmax),Cerr2(0:rmax)}
\DoxyCodeLine{6078     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(in)} :: acc\_req\_Cr(0:rmax)}
\DoxyCodeLine{6079     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Cexpgy(:,:,:,:), CuvExpgy(:,:,:)}
\DoxyCodeLine{6080     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: B\_0(:,:,:), B\_i(:,:,:), Shat(:,:,:,:)}
\DoxyCodeLine{6081     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Buv\_0(:,:,:), Buv\_i(:,:,:)}
\DoxyCodeLine{6082     \textcolor{keywordtype}{double complex} :: Smod, Caux, Zadj2f}
\DoxyCodeLine{6083     \textcolor{keywordtype}{double complex} :: C0\_coli, elimminf2\_coli}
\DoxyCodeLine{6084     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err(:),Cij\_err(:)}
\DoxyCodeLine{6085     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{6086     \textcolor{keywordtype}{double precision} :: B\_err,B\_max,aZadj2f}
\DoxyCodeLine{6087     \textcolor{keywordtype}{double precision} :: maxCexpgy(0:1,0:rmax+2*ordgy\_min,0:ordgy\_max),truncfacexp}
\DoxyCodeLine{6088     \textcolor{keywordtype}{integer} :: rmaxB,rmaxExp,gtrunc,r,n0,n1,n2,i,j,jt,g,rg}
\DoxyCodeLine{6089     \textcolor{keywordtype}{integer} :: inds0(2),inds(2),k,l,lt,nl,nlt}
\DoxyCodeLine{6090     \textcolor{keywordtype}{integer} :: bin,nid(0:2)}
\DoxyCodeLine{6091 }
\DoxyCodeLine{6092 \textcolor{preprocessor}{\#ifdef Cgytest}}
\DoxyCodeLine{6093 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy in '},rmax,ordgy\_min,ordgy\_max,id}
\DoxyCodeLine{6094     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy in '},p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{6095 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6096 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifdef TRACECin}}
\DoxyCodeLine{6097 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy in '},rmax,ordgy\_min,ordgy\_max,id}
\DoxyCodeLine{6098 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6099 \textcolor{preprocessor}{}}
\DoxyCodeLine{6100     \textcolor{comment}{! write(*,*) 'LH: CalcCgy, ord', ordgy\_min}}
\DoxyCodeLine{6101     \textcolor{comment}{! calculation of B-\/coefficients}}
\DoxyCodeLine{6102     rmaxb = rmax + 2*ordgy\_min + 1}
\DoxyCodeLine{6103     \textcolor{keyword}{allocate}(b\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{6104     \textcolor{keyword}{allocate}(buv\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{6105     \textcolor{keyword}{allocate}(b\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{6106     \textcolor{keyword}{allocate}(buv\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{6107 }
\DoxyCodeLine{6108     \textcolor{comment}{! determine binaries for B-\/coefficients}}
\DoxyCodeLine{6109     k=0}
\DoxyCodeLine{6110     bin = 1}
\DoxyCodeLine{6111     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.2)}
\DoxyCodeLine{6112       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6113         nid(k) = id+bin}
\DoxyCodeLine{6114         k = k+1}
\DoxyCodeLine{6115 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6116       bin = 2*bin}
\DoxyCodeLine{6117 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{6118 }
\DoxyCodeLine{6119     \textcolor{keyword}{call }calcb(b\_0(:,0,:),buv\_0(:,0,:),p21,m12,m22,rmaxb,nid(0))}
\DoxyCodeLine{6120     \textcolor{keyword}{call }calcb(b\_i(:,:,1),buv\_i(:,:,1),p20,m02,m22,rmaxb,nid(1))}
\DoxyCodeLine{6121     \textcolor{keyword}{call }calcb(b\_i(:,:,2),buv\_i(:,:,2),p10,m02,m12,rmaxb,nid(2))}
\DoxyCodeLine{6122 }
\DoxyCodeLine{6123    \textcolor{comment}{! shift of integration momentum in B\_0}}
\DoxyCodeLine{6124     b\_max=0d0}
\DoxyCodeLine{6125     \textcolor{keywordflow}{do} n1=1,rmaxb}
\DoxyCodeLine{6126       \textcolor{keywordflow}{do} n2=0,rmaxb-\/n1}
\DoxyCodeLine{6127         n0 = (rmaxb-\/n1-\/n2)}
\DoxyCodeLine{6128         b\_0(0:n0,n1,n2) = -\/b\_0(0:n0,n1-\/1,n2)-\/b\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{6129         buv\_0(0:n0,n1,n2) = -\/buv\_0(0:n0,n1-\/1,n2)-\/buv\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{6130 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{6131 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{6132     b\_max = max(b\_max,maxval(abs(b\_i(0,0:rmaxb,1:2))))}
\DoxyCodeLine{6133     b\_err = acc\_def\_b*b\_max}
\DoxyCodeLine{6134 }
\DoxyCodeLine{6135     \textcolor{comment}{! determine (adjugated) Gram and Cayley matrix}}
\DoxyCodeLine{6136 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{6137 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{6138 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{6139 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{6140 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{6141 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{6142 \textcolor{comment}{!}}
\DoxyCodeLine{6143 \textcolor{comment}{!    q1q2 = (q10+q20-\/q21)}}
\DoxyCodeLine{6144 \textcolor{comment}{!    detZ = 4d0*q10*q20-\/q1q2*q1q2}}
\DoxyCodeLine{6145 }
\DoxyCodeLine{6146     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}).lt.abs(4d0*\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}*\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}} + \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1))*1d-\/4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6147       \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}-\/\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}).lt.abs(\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}-\/\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}).and.  \&}
\DoxyCodeLine{6148           abs(\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}-\/\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}).lt.abs(\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}-\/\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}})) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6149         \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}  =  4d0*\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}*\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}} -\/ (\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}-\/\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}+\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}})*(\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}-\/\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}+\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}})}
\DoxyCodeLine{6150 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6151 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{6152 }
\DoxyCodeLine{6153 \textcolor{comment}{!    Zadj(1,1) = 2d0*q20}}
\DoxyCodeLine{6154 \textcolor{comment}{!    Zadj(2,1) = -\/q1q2}}
\DoxyCodeLine{6155 \textcolor{comment}{!    Zadj(1,2) = -\/q1q2}}
\DoxyCodeLine{6156 \textcolor{comment}{!    Zadj(2,2) = 2d0*q10}}
\DoxyCodeLine{6157 \textcolor{comment}{!    f(1) = q10+mm02-\/mm12}}
\DoxyCodeLine{6158 \textcolor{comment}{!    f(2) = q20+mm02-\/mm22}}
\DoxyCodeLine{6159 \textcolor{comment}{!}}
\DoxyCodeLine{6160 \textcolor{comment}{!    Zadjf(1) = Zadj(1,1)*f(1)+Zadj(2,1)*f(2)}}
\DoxyCodeLine{6161 \textcolor{comment}{!    Zadjf(2) = Zadj(1,2)*f(1)+Zadj(2,2)*f(2)}}
\DoxyCodeLine{6162 \textcolor{comment}{!}}
\DoxyCodeLine{6163 \textcolor{comment}{! Xadj(1,1) and Xadj(2,2) exchanged!!!}}
\DoxyCodeLine{6164 \textcolor{comment}{!    Xadj(1,1) = 2d0*mm02*Z(1,1) -\/ f(1)*f(1)}}
\DoxyCodeLine{6165 \textcolor{comment}{!    Xadj(2,1) = 2d0*mm02*Z(1,2) -\/ f(1)*f(2)}}
\DoxyCodeLine{6166 \textcolor{comment}{!    Xadj(1,2) = Xadj(2,1)}}
\DoxyCodeLine{6167 \textcolor{comment}{!    Xadj(2,2) = 2d0*mm02*Z(2,2) -\/ f(2)*f(2)}}
\DoxyCodeLine{6168 }
\DoxyCodeLine{6169 }
\DoxyCodeLine{6170     \textcolor{comment}{! coefficients Shat defined in (5.13)}}
\DoxyCodeLine{6171     \textcolor{keyword}{allocate}(shat(0:rmaxb,0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{6172 }
\DoxyCodeLine{6173     \textcolor{keywordflow}{do} r=0,rmaxb}
\DoxyCodeLine{6174       \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{6175 }
\DoxyCodeLine{6176         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{6177           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{6178           shat(n0,n1,n2,:) = -\/b\_0(n0,n1,n2)}
\DoxyCodeLine{6179 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{6180 }
\DoxyCodeLine{6181         k = r-\/2*n0}
\DoxyCodeLine{6182         shat(n0,0,k,1) = shat(n0,0,k,1) + b\_i(n0,k,1)}
\DoxyCodeLine{6183         shat(n0,k,0,2) = shat(n0,k,0,2) + b\_i(n0,k,2)}
\DoxyCodeLine{6184 }
\DoxyCodeLine{6185 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{6186 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{6187 }
\DoxyCodeLine{6188     \textcolor{comment}{! choose reduction formulas with biggest denominators}}
\DoxyCodeLine{6189     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,1)).ge.abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6190       \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,1)).ge.abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6191         i = 1}
\DoxyCodeLine{6192         j = 1}
\DoxyCodeLine{6193         jt = 2}
\DoxyCodeLine{6194         zadj2f = -\/\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)  }
\DoxyCodeLine{6195       \textcolor{keywordflow}{else}}
\DoxyCodeLine{6196         i = 1}
\DoxyCodeLine{6197         j = 2}
\DoxyCodeLine{6198         jt = 1}
\DoxyCodeLine{6199         zadj2f = \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)}
\DoxyCodeLine{6200 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6201     \textcolor{keywordflow}{else}        }
\DoxyCodeLine{6202       \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,2)).ge.abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6203         i = 2}
\DoxyCodeLine{6204         j = 2}
\DoxyCodeLine{6205         jt = 1}
\DoxyCodeLine{6206         zadj2f = -\/\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)}
\DoxyCodeLine{6207       \textcolor{keywordflow}{else} }
\DoxyCodeLine{6208         i = 1}
\DoxyCodeLine{6209         j = 2}
\DoxyCodeLine{6210         jt = 2}
\DoxyCodeLine{6211         zadj2f = -\/\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2) }
\DoxyCodeLine{6212 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6213 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{6214     azadj2f = abs(zadj2f)}
\DoxyCodeLine{6215 }
\DoxyCodeLine{6216     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1)).ge.abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6217       \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1)).ge.abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6218         k = 1}
\DoxyCodeLine{6219         l = 1}
\DoxyCodeLine{6220         lt = 2}
\DoxyCodeLine{6221       \textcolor{keywordflow}{else}}
\DoxyCodeLine{6222         k = 1}
\DoxyCodeLine{6223         l = 2}
\DoxyCodeLine{6224         lt = 1}
\DoxyCodeLine{6225 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6226     \textcolor{keywordflow}{else}        }
\DoxyCodeLine{6227       \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2)).ge.abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6228         k = 2}
\DoxyCodeLine{6229         l = 2}
\DoxyCodeLine{6230         lt = 1}
\DoxyCodeLine{6231       \textcolor{keywordflow}{else} }
\DoxyCodeLine{6232         k = 1}
\DoxyCodeLine{6233         l = 2}
\DoxyCodeLine{6234         lt = 1}
\DoxyCodeLine{6235 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6236 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{6237 }
\DoxyCodeLine{6238 \textcolor{preprocessor}{\#ifdef Cgytest}}
\DoxyCodeLine{6239 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy: Zadj'},k,l,\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)}
\DoxyCodeLine{6240     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy: Xadj'},i,j,\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(i,j)}
\DoxyCodeLine{6241     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy: Zadjf'},j,\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j),\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}}
\DoxyCodeLine{6242 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6243 \textcolor{preprocessor}{}}
\DoxyCodeLine{6244 \textcolor{comment}{!   write(*,*)  'CalcCgy Zadj(i,j)=',i,j,Zadj(i,j),Xadj(i,j)}}
\DoxyCodeLine{6245         }
\DoxyCodeLine{6246     \textcolor{comment}{! allocation of array for det(Z)-\/ and det(X)-\/expanded C-\/coefficients}}
\DoxyCodeLine{6247     rmaxexp = rmaxb+1}
\DoxyCodeLine{6248     \textcolor{keyword}{allocate}(cexpgy(0:max(rmax/2,1),0:rmaxexp-\/2,0:rmaxexp-\/2,0:ordgy\_max))}
\DoxyCodeLine{6249    }
\DoxyCodeLine{6250     \textcolor{comment}{! calculate Cuv}}
\DoxyCodeLine{6251     \textcolor{keyword}{allocate}(cuvexpgy(0:rmaxexp,0:rmaxexp,0:rmaxexp))}
\DoxyCodeLine{6252     \textcolor{keyword}{call }calccuv(cuvexpgy,buv\_0,mm02,\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}},rmaxexp,id)}
\DoxyCodeLine{6253     cuv(0:rmax,0:rmax,0:rmax) = cuvexpgy(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{6254 }
\DoxyCodeLine{6255     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{6256     \textcolor{keyword}{allocate}(c00\_err(0:rmaxexp))}
\DoxyCodeLine{6257     \textcolor{keyword}{allocate}(cij\_err(0:rmaxexp))}
\DoxyCodeLine{6258     \textcolor{keyword}{allocate}(c00\_err2(0:rmaxexp))}
\DoxyCodeLine{6259     \textcolor{keyword}{allocate}(cij\_err2(0:rmaxexp))}
\DoxyCodeLine{6260 }
\DoxyCodeLine{6261     \textcolor{comment}{! initialize accuracy estimates}}
\DoxyCodeLine{6262     cerr = acc\_inf}
\DoxyCodeLine{6263     cij\_err =0d0}
\DoxyCodeLine{6264     c00\_err =0d0}
\DoxyCodeLine{6265 }
\DoxyCodeLine{6266     cerr2 = acc\_inf}
\DoxyCodeLine{6267     cij\_err2 =0d0}
\DoxyCodeLine{6268     c00\_err2 =0d0}
\DoxyCodeLine{6269 }
\DoxyCodeLine{6270 \textcolor{comment}{!    maxZadjf = maxval(abs(Zadjf))}}
\DoxyCodeLine{6271 \textcolor{comment}{!    fmax = maxval(abs(f))}}
\DoxyCodeLine{6272 }
\DoxyCodeLine{6273     \textcolor{comment}{! truncation of expansion if calculated term larger than truncfacexp * previous term}}
\DoxyCodeLine{6274     \textcolor{comment}{! crucial for expansion parameters between 0.1 and 1 !!!}}
\DoxyCodeLine{6275 \textcolor{comment}{!    truncfacexp = sqrt(max(maxZadjf,abs(detZ))/abs(Xadj(i,j))*max(1d0,fmax/abs(Zadj(k,l)))) * truncfacC}}
\DoxyCodeLine{6276     truncfacexp = sqrt(\mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}}) * truncfacc}
\DoxyCodeLine{6277     gtrunc = ordgy\_max }
\DoxyCodeLine{6278 }
\DoxyCodeLine{6279 \textcolor{preprocessor}{\#ifdef Cgytest            }}
\DoxyCodeLine{6280 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy gtrunc orig='},gtrunc}
\DoxyCodeLine{6281     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy rmaxExp-\/2='},rmaxexp-\/2}
\DoxyCodeLine{6282 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6283 \textcolor{preprocessor}{}}
\DoxyCodeLine{6284 \textcolor{comment}{! calculate C(1,n1,n2) up to rank r+2}}
\DoxyCodeLine{6285 \textcolor{comment}{! calculate C(0,n1,n2) up to rank r  }}
\DoxyCodeLine{6286     rloop: \textcolor{keywordflow}{do} r=0,rmaxexp-\/2}
\DoxyCodeLine{6287 }
\DoxyCodeLine{6288 \textcolor{preprocessor}{\#ifdef Cgytest            }}
\DoxyCodeLine{6289 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy rloop='},r,rmaxexp-\/2,rmax+2*gtrunc+2}
\DoxyCodeLine{6290       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy rloop='},rmax,gtrunc}
\DoxyCodeLine{6291 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6292 \textcolor{preprocessor}{}}
\DoxyCodeLine{6293       \textcolor{keywordflow}{if} (r.gt.rmax+2*gtrunc+2) \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{6294 }
\DoxyCodeLine{6295       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{6296       \textcolor{comment}{! 0th-\/order coefficients}}
\DoxyCodeLine{6297       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{6298 }
\DoxyCodeLine{6299       \textcolor{comment}{! calculating C\_00ijk.. exploiting eq. (5.49)}}
\DoxyCodeLine{6300       maxcexpgy(1,r,0)=0d0}
\DoxyCodeLine{6301       \textcolor{keywordflow}{do} nl=r,0,-\/1}
\DoxyCodeLine{6302         nlt=r-\/nl}
\DoxyCodeLine{6303         inds0(l) = nl}
\DoxyCodeLine{6304         inds0(lt) = nlt}
\DoxyCodeLine{6305 }
\DoxyCodeLine{6306         inds(l) = nl+1}
\DoxyCodeLine{6307         inds(lt) = nlt}
\DoxyCodeLine{6308         caux = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,1)*shat(0,inds(1),inds(2),1)  \&}
\DoxyCodeLine{6309              + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,2)*shat(0,inds(1),inds(2),2)}
\DoxyCodeLine{6310 }
\DoxyCodeLine{6311         \textcolor{keywordflow}{if} (nlt.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6312           inds(lt) = nlt-\/1}
\DoxyCodeLine{6313           caux = caux -\/ 2*nlt*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,lt)*cexpgy(1,inds(1),inds(2),0)}
\DoxyCodeLine{6314 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6315 }
\DoxyCodeLine{6316         cexpgy(1,inds0(1),inds0(2),0) = caux/(2*(nl+1)*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l))}
\DoxyCodeLine{6317         maxcexpgy(1,r,0) =  maxcexpgy(1,r,0) + abs(cexpgy(1,inds0(1),inds0(2),0) )}
\DoxyCodeLine{6318 \textcolor{comment}{!        if (r+2.le.rmax) then             !  for fixed rank}}
\DoxyCodeLine{6319         \textcolor{keywordflow}{if} (r+1.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6320           c(1,inds0(1),inds0(2)) = cexpgy(1,inds0(1),inds0(2),0)}
\DoxyCodeLine{6321 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6322 }
\DoxyCodeLine{6323 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{6324 }
\DoxyCodeLine{6325       \textcolor{comment}{! calculate C\_ijkl.. exploiting eq. (5.53)}}
\DoxyCodeLine{6326       maxcexpgy(0,r,0)=0d0}
\DoxyCodeLine{6327       \textcolor{keywordflow}{do} n1=0,r}
\DoxyCodeLine{6328         n2 = r-\/n1}
\DoxyCodeLine{6329         inds(1) = n1}
\DoxyCodeLine{6330         inds(2) = n2}
\DoxyCodeLine{6331       }
\DoxyCodeLine{6332         caux = (2*(2+r)*cexpgy(1,n1,n2,0) -\/ 4*cuvexpgy(1,n1,n2)  \&}
\DoxyCodeLine{6333              -\/ b\_0(0,n1,n2))*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,j)}
\DoxyCodeLine{6334 }
\DoxyCodeLine{6335 \textcolor{comment}{!     write(*,*) 'CalcCred Caux',Caux,Zadj(i,j),f(i),f(j)}}
\DoxyCodeLine{6336 }
\DoxyCodeLine{6337         smod = shat(0,n1,n2,jt)}
\DoxyCodeLine{6338 }
\DoxyCodeLine{6339         \textcolor{keywordflow}{if} (inds(jt).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6340           inds(jt) = inds(jt)-\/1}
\DoxyCodeLine{6341           smod = smod -\/ 2d0*(inds(jt)+1)*cexpgy(1,inds(1),inds(2),0)}
\DoxyCodeLine{6342 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6343 }
\DoxyCodeLine{6344         caux = caux + zadj2f*smod}
\DoxyCodeLine{6345 }
\DoxyCodeLine{6346 \textcolor{comment}{!       write(*,*) 'CalcCgy maxadjf',maxZadjf,Xadj(i,j),Caux}}
\DoxyCodeLine{6347 }
\DoxyCodeLine{6348         cexpgy(0,n1,n2,0) = caux/\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(i,j)}
\DoxyCodeLine{6349         maxcexpgy(0,r,0) =  maxcexpgy(0,r,0) + abs(cexpgy(0,n1,n2,0))}
\DoxyCodeLine{6350         \textcolor{keywordflow}{if} (r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6351           c(0,n1,n2) = cexpgy(0,n1,n2,0)}
\DoxyCodeLine{6352 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6353 }
\DoxyCodeLine{6354 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{6355 }
\DoxyCodeLine{6356       \textcolor{keywordflow}{if} (r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6357 \textcolor{comment}{!       Cerr(r) =  abs(maxZadjf/Xadj(i,j))*maxCexpgy(0,r,0)}}
\DoxyCodeLine{6358         cerr(r) =  \mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}}*maxcexpgy(0,r,0)}
\DoxyCodeLine{6359 }
\DoxyCodeLine{6360 \textcolor{comment}{!        write(*,*) 'CalcCgy Cerr,0 ',r,Cerr(r),fac\_gy,maxCexpgy(0,r,0)}}
\DoxyCodeLine{6361 }
\DoxyCodeLine{6362 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6363 }
\DoxyCodeLine{6364  \textcolor{comment}{! error propagation from B's}}
\DoxyCodeLine{6365       c00\_err(r+2) = b\_err /2d0               }
\DoxyCodeLine{6366       cij\_err(r)=max(abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,j))/abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(i,j))*max(b\_err,2*(r+2)*c00\_err(r+2)),  \&}
\DoxyCodeLine{6367                   \mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}/abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(i,j))*max(b\_err,2*c00\_err(r+1)))}
\DoxyCodeLine{6368 }
\DoxyCodeLine{6369       c00\_err2(r+2) = b\_err /2d0               }
\DoxyCodeLine{6370       cij\_err2(r)=max(abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,j))/abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(i,j))*max(b\_err,2*(r+2)*c00\_err2(r+2)),  \&}
\DoxyCodeLine{6371                   \mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}/abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(i,j))*max(b\_err,2*c00\_err2(r+1)))}
\DoxyCodeLine{6372 }
\DoxyCodeLine{6373       }
\DoxyCodeLine{6374       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{6375       \textcolor{comment}{! higher order coefficients}}
\DoxyCodeLine{6376       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{6377 }
\DoxyCodeLine{6378       rg = r}
\DoxyCodeLine{6379       gloop: \textcolor{keywordflow}{do} g=1,min(gtrunc,r/2)}
\DoxyCodeLine{6380         rg = rg-\/2}
\DoxyCodeLine{6381 }
\DoxyCodeLine{6382 \textcolor{comment}{!       write(*,*) 'CalcCgy gtrunc gloop=',gtrunc,r,g,rg}}
\DoxyCodeLine{6383 }
\DoxyCodeLine{6384         \textcolor{comment}{! calculating C\_00ijk.. exploiting eq. (5.49)}}
\DoxyCodeLine{6385         maxcexpgy(1,rg,g) = 0d0}
\DoxyCodeLine{6386         \textcolor{keywordflow}{do} nl=rg,0,-\/1}
\DoxyCodeLine{6387           nlt=rg-\/nl}
\DoxyCodeLine{6388           inds0(l) = nl}
\DoxyCodeLine{6389           inds0(lt) = nlt}
\DoxyCodeLine{6390 }
\DoxyCodeLine{6391           inds(l) = nl+1}
\DoxyCodeLine{6392           inds(lt) = nlt}
\DoxyCodeLine{6393           caux = -\/\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(k)*cexpgy(0,inds(1),inds(2),g-\/1)}
\DoxyCodeLine{6394 }
\DoxyCodeLine{6395           inds(k) = inds(k)+1}
\DoxyCodeLine{6396           caux = caux -\/ \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*cexpgy(0,inds(1),inds(2),g-\/1)}
\DoxyCodeLine{6397 }
\DoxyCodeLine{6398           \textcolor{keywordflow}{if} (nlt.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6399             inds(l) = nl+1}
\DoxyCodeLine{6400             inds(lt) = nlt-\/1}
\DoxyCodeLine{6401             caux = caux -\/ 2*nlt*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,lt)*cexpgy(1,inds(1),inds(2),g)}
\DoxyCodeLine{6402 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{6403 }
\DoxyCodeLine{6404           cexpgy(1,inds0(1),inds0(2),g) = caux/(2*(nl+1)*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l))}
\DoxyCodeLine{6405           maxcexpgy(1,rg,g) =  maxcexpgy(1,rg,g) + abs(cexpgy(1,inds0(1),inds0(2),g) )}
\DoxyCodeLine{6406 }
\DoxyCodeLine{6407           \textcolor{keywordflow}{if} (g.eq.1.and.abs(cexpgy(1,inds0(1),inds0(2),g)).gt.      \&}
\DoxyCodeLine{6408                   truncfacexp*max(1d0,maxcexpgy(1,rg,g-\/1))    .or.   \&}
\DoxyCodeLine{6409                   g.ge.2.and.abs(cexpgy(1,inds0(1),inds0(2),g)).gt.  \&}
\DoxyCodeLine{6410                   truncfacexp*maxcexpgy(1,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6411 \textcolor{preprocessor}{\#ifdef Cgytest            }}
\DoxyCodeLine{6412 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy exit gloop'},n1,n2,g,abs(cexpgy(1,inds0(1),inds0(2),g)),maxcexpgy(1,rg,g-\/1)}
\DoxyCodeLine{6413             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy exit gloop'},g,rg,inds0(1),inds0(2)}
\DoxyCodeLine{6414 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6415 \textcolor{preprocessor}{}}
\DoxyCodeLine{6416             gtrunc = g-\/1}
\DoxyCodeLine{6417             \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{6418 }
\DoxyCodeLine{6419 \textcolor{keywordflow}{          end if} }
\DoxyCodeLine{6420         }
\DoxyCodeLine{6421 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{6422 }
\DoxyCodeLine{6423 \textcolor{preprocessor}{\#ifndef PPEXP00}}
\DoxyCodeLine{6424 \textcolor{preprocessor}{}\textcolor{comment}{!        if (rg+2.le.rmax) then            !  for fixed rank}}
\DoxyCodeLine{6425         \textcolor{keywordflow}{if} (rg+1.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6426           \textcolor{keywordflow}{do} nl=rg,0,-\/1}
\DoxyCodeLine{6427             nlt=rg-\/nl}
\DoxyCodeLine{6428             inds0(l) = nl}
\DoxyCodeLine{6429             inds0(lt) = nlt}
\DoxyCodeLine{6430             c(1,inds0(1),inds0(2)) = c(1,inds0(1),inds0(2))  \&}
\DoxyCodeLine{6431                 + cexpgy(1,inds0(1),inds0(2),g)}
\DoxyCodeLine{6432 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{6433 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6434 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6435 \textcolor{preprocessor}{}}
\DoxyCodeLine{6436         \textcolor{comment}{! calculate C\_ijkl.. exploiting eq. (5.53)}}
\DoxyCodeLine{6437         maxcexpgy(0,rg,g) = 0d0}
\DoxyCodeLine{6438         \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{6439           n2 = rg-\/n1}
\DoxyCodeLine{6440           inds0(1) = n1}
\DoxyCodeLine{6441           inds0(2) = n2}
\DoxyCodeLine{6442           }
\DoxyCodeLine{6443           caux = 2*(2+rg)*cexpgy(1,n1,n2,g)*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,j)}
\DoxyCodeLine{6444           }
\DoxyCodeLine{6445 \textcolor{comment}{!          write(*,*) 'CalcCgy g Caux 1',rg,g,Caux}}
\DoxyCodeLine{6446 }
\DoxyCodeLine{6447           \textcolor{keywordflow}{if} (inds0(jt).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6448             inds = inds0}
\DoxyCodeLine{6449             inds(jt) = inds(jt)-\/1}
\DoxyCodeLine{6450             caux = caux -\/ 2d0*zadj2f*inds0(jt)*cexpgy(1,inds(1),inds(2),g)}
\DoxyCodeLine{6451 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{6452           }
\DoxyCodeLine{6453 \textcolor{comment}{!          write(*,*) 'CalcCgy g Caux 2',rg,g,Caux}}
\DoxyCodeLine{6454 }
\DoxyCodeLine{6455           inds0(i) = inds0(i)+1}
\DoxyCodeLine{6456           caux = caux -\/ \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j)*cexpgy(0,inds0(1),inds0(2),g-\/1)}
\DoxyCodeLine{6457           }
\DoxyCodeLine{6458 \textcolor{comment}{!          write(*,*) 'CalcCgy g Caux 3',rg,g,Caux}}
\DoxyCodeLine{6459 }
\DoxyCodeLine{6460           cexpgy(0,n1,n2,g) = caux/\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(i,j)}
\DoxyCodeLine{6461 }
\DoxyCodeLine{6462 \textcolor{comment}{!          write(*,*) 'CalcCgy g Cexpgy',rg,g,n1,n2,Cexpgy(0,n1,n2,g)}}
\DoxyCodeLine{6463 }
\DoxyCodeLine{6464           maxcexpgy(0,rg,g) =  maxcexpgy(0,rg,g) + abs(cexpgy(0,n1,n2,g))}
\DoxyCodeLine{6465           }
\DoxyCodeLine{6466           \textcolor{keywordflow}{if} (g.eq.1.and.abs(cexpgy(0,n1,n2,g)).gt.        \&}
\DoxyCodeLine{6467               truncfacexp*max(1d0/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}},maxcexpgy(0,rg,g-\/1)).or.     \&}
\DoxyCodeLine{6468               g.ge.2.and.abs(cexpgy(0,n1,n2,g)).gt.        \&}
\DoxyCodeLine{6469               truncfacexp*maxcexpgy(0,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6470 }
\DoxyCodeLine{6471 \textcolor{preprocessor}{\#ifdef Cgytest            }}
\DoxyCodeLine{6472 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy exit gloop'},n1,n2,g,rg}
\DoxyCodeLine{6473             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy exit gloop'},abs(cexpgy(0,n1,n2,g)),maxcexpgy(0,rg,g-\/1),1d0/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}}
\DoxyCodeLine{6474             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy exit gloop'},truncfacexp}
\DoxyCodeLine{6475 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6476 \textcolor{preprocessor}{}}
\DoxyCodeLine{6477             gtrunc = g-\/1}
\DoxyCodeLine{6478             \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{6479 }
\DoxyCodeLine{6480 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{6481 }
\DoxyCodeLine{6482 \textcolor{comment}{!            if ((g.ge.2).and.(abs(Cexpgy(0,n1,n2,g)).gt.truncfacexp*abs(Cexpgy(0,n1,n2,g-\/1)))) then}}
\DoxyCodeLine{6483 \textcolor{comment}{!              gtrunc = g-\/1}}
\DoxyCodeLine{6484 \textcolor{comment}{!            end if}}
\DoxyCodeLine{6485 }
\DoxyCodeLine{6486 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{6487 }
\DoxyCodeLine{6488         \textcolor{comment}{! error propagation from B's}}
\DoxyCodeLine{6489         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{6490           c00\_err(rg+2) =max(c00\_err(rg+2),                                       \&}
\DoxyCodeLine{6491               max(abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(k))/2d0*cij\_err(rg+1),                                \&}
\DoxyCodeLine{6492                   abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})/2d0*cij\_err(rg+2))/abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)))   }
\DoxyCodeLine{6493 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6494 }
\DoxyCodeLine{6495 \textcolor{preprocessor}{\#ifdef Cgytest}}
\DoxyCodeLine{6496 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy test2'},rg,i,j,cij\_err(rg)}
\DoxyCodeLine{6497         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy test2'},rg,cij\_err(rg+1),c00\_err(rg+1)}
\DoxyCodeLine{6498         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy test2'},rg,abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,j))}
\DoxyCodeLine{6499         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy test2'},rg,abs(zadj2f)}
\DoxyCodeLine{6500         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy test2'},rg,abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j))}
\DoxyCodeLine{6501         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy test2'},rg,abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(i,j))}
\DoxyCodeLine{6502 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6503 \textcolor{preprocessor}{}}
\DoxyCodeLine{6504         cij\_err(rg)= max( cij\_err(rg),                                \&}
\DoxyCodeLine{6505             max(2*(rg+2)*abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,j))*c00\_err(rg+2),                \&}
\DoxyCodeLine{6506                 2*abs(zadj2f)*c00\_err(rg+1),       \&}
\DoxyCodeLine{6507                 abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j))*cij\_err(rg+1))/abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(i,j)))}
\DoxyCodeLine{6508 }
\DoxyCodeLine{6509         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{6510           c00\_err2(rg+2) =max(c00\_err2(rg+2),                                       \&}
\DoxyCodeLine{6511               max(abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(k))/2d0*cij\_err2(rg+1),                                \&}
\DoxyCodeLine{6512                   abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})/2d0*cij\_err2(rg+2))/abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)))   }
\DoxyCodeLine{6513 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6514 }
\DoxyCodeLine{6515         cij\_err2(rg)= max( cij\_err2(rg),                                \&}
\DoxyCodeLine{6516             max(2*(rg+2)*abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(i,j))*c00\_err2(rg+2),                \&}
\DoxyCodeLine{6517                 2*abs(zadj2f)*c00\_err2(rg+1),       \&}
\DoxyCodeLine{6518                 abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j))*cij\_err2(rg+1))/abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(i,j)))}
\DoxyCodeLine{6519 }
\DoxyCodeLine{6520 \textcolor{preprocessor}{\#ifdef PPEXP00}}
\DoxyCodeLine{6521 \textcolor{preprocessor}{}\textcolor{comment}{!        if (rg+2.le.rmax) then             !   for fixed rank}}
\DoxyCodeLine{6522         \textcolor{keywordflow}{if} (rg+1.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6523           \textcolor{keywordflow}{do} nl=rg,0,-\/1}
\DoxyCodeLine{6524             nlt=rg-\/nl}
\DoxyCodeLine{6525             inds0(l) = nl}
\DoxyCodeLine{6526             inds0(lt) = nlt}
\DoxyCodeLine{6527             c(1,inds0(1),inds0(2)) = c(1,inds0(1),inds0(2))  \&}
\DoxyCodeLine{6528                 + cexpgy(1,inds0(1),inds0(2),g)}
\DoxyCodeLine{6529 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{6530 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6531 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6532 \textcolor{preprocessor}{}}
\DoxyCodeLine{6533         \textcolor{keywordflow}{if} ((rg.le.rmax)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6534           cerr(rg) = 0d0}
\DoxyCodeLine{6535           \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{6536             n2=rg-\/n1}
\DoxyCodeLine{6537             c(0,n1,n2) = c(0,n1,n2) + cexpgy(0,n1,n2,g)}
\DoxyCodeLine{6538 }
\DoxyCodeLine{6539 \textcolor{preprocessor}{\#ifdef Cgytest}}
\DoxyCodeLine{6540 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy test1'},rg,n1,n2,cerr(rg)}
\DoxyCodeLine{6541             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy test1'},cexpgy(0,n1,n2,g)}
\DoxyCodeLine{6542             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy test1'},cexpgy(0,n1,n2,g-\/1)}
\DoxyCodeLine{6543 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6544 \textcolor{preprocessor}{}}
\DoxyCodeLine{6545             \textcolor{keywordflow}{if}(abs(cexpgy(0,n1,n2,g-\/1)).ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6546               cerr(rg)=max(cerr(rg),abs(cexpgy(0,n1,n2,g))*min(1d0,abs(cexpgy(0,n1,n2,g))/abs(cexpgy(0,n1,n2,g-\/1))))}
\DoxyCodeLine{6547             \textcolor{keywordflow}{else}}
\DoxyCodeLine{6548               cerr(rg)=max(cerr(rg),abs(cexpgy(0,n1,n2,g)))}
\DoxyCodeLine{6549 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{6550 }
\DoxyCodeLine{6551 \textcolor{preprocessor}{\#ifdef Cgytest}}
\DoxyCodeLine{6552 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy test1'},cerr(rg)            }
\DoxyCodeLine{6553 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6554 \textcolor{preprocessor}{}}
\DoxyCodeLine{6555 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{6556 }
\DoxyCodeLine{6557           \textcolor{comment}{! if error from B's larger than error from expansion stop expansion}}
\DoxyCodeLine{6558           \textcolor{keywordflow}{if}(cij\_err(rg).gt.cerr(rg)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6559              gtrunc = min(g,gtrunc)}
\DoxyCodeLine{6560 \textcolor{comment}{!            gtrunc = min(g+1,gtrunc)}}
\DoxyCodeLine{6561              }
\DoxyCodeLine{6562 \textcolor{preprocessor}{\#ifdef Cgytest}}
\DoxyCodeLine{6563 \textcolor{preprocessor}{}             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy adjust gtrunc'},r,g,gtrunc}
\DoxyCodeLine{6564 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6565 \textcolor{preprocessor}{}}
\DoxyCodeLine{6566 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{6567 }
\DoxyCodeLine{6568 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6569         }
\DoxyCodeLine{6570         }
\DoxyCodeLine{6571 \textcolor{keywordflow}{      end do} gloop}
\DoxyCodeLine{6572 }
\DoxyCodeLine{6573 \textcolor{comment}{!     write(*,*) 'CalcCgy gtrunc aft gloop=',gtrunc,r}}
\DoxyCodeLine{6574 }
\DoxyCodeLine{6575 \textcolor{preprocessor}{\#ifdef Cgytest}}
\DoxyCodeLine{6576 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy Cerr r ='},r}
\DoxyCodeLine{6577       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy Cerr r ='},r,cerr}
\DoxyCodeLine{6578       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy Cacc r ='},r,cerr/abs(c(0,0,0))}
\DoxyCodeLine{6579       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy Cij\_err ='},r,cij\_err}
\DoxyCodeLine{6580       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy C(0,0,0)='},r,c(0,0,0)}
\DoxyCodeLine{6581       \textcolor{keywordflow}{if}(rmax.ge.1.and.r.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6582       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy C(0,1,0)='},r,c(0,1,0)}
\DoxyCodeLine{6583       \textcolor{keywordflow}{if}(rmax.ge.2.and.r.ge.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6584       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy C(0,1,1)='},r,c(0,1,1)}
\DoxyCodeLine{6585       \textcolor{keywordflow}{if}(rmax.ge.3.and.r.ge.3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6586       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy C(0,1,2)='},r,c(0,1,2)}
\DoxyCodeLine{6587       \textcolor{keywordflow}{if}(rmax.ge.4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6588       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy C(0,0,4)='},r,c(0,0,4)}
\DoxyCodeLine{6589 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{6590 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{6591 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{6592 \textcolor{keywordflow}{      endif}}
\DoxyCodeLine{6593 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6594 \textcolor{preprocessor}{}}
\DoxyCodeLine{6595       cerr2 = max(cerr,cij\_err2(0:rmax))}
\DoxyCodeLine{6596       cerr = max(cerr,cij\_err(0:rmax))}
\DoxyCodeLine{6597 }
\DoxyCodeLine{6598 \textcolor{preprocessor}{\#ifdef Cgytest}}
\DoxyCodeLine{6599 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy Cerr ='},r,cerr,maxval(cerr)}
\DoxyCodeLine{6600 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6601 \textcolor{preprocessor}{}}
\DoxyCodeLine{6602       \textcolor{comment}{! check if target precision already reached}}
\DoxyCodeLine{6603 \textcolor{comment}{!      if(maxval(Cerr-\/acc\_req\_Cr*abs(C(0,0,0))).le.0d0) exit         ! changed 28.01.15}}
\DoxyCodeLine{6604 \textcolor{preprocessor}{\#ifdef Cutrloop}}
\DoxyCodeLine{6605 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(cerr-\/acc\_req\_cr*abs(c(0,0,0))).le.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6606         \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{6607           \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{6608             c(0,n1,rg-\/n1)=0d0}
\DoxyCodeLine{6609 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{6610 \textcolor{keywordflow}{        end do}   }
\DoxyCodeLine{6611         \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{6612           \textcolor{keywordflow}{do} n1=0,rg-\/2}
\DoxyCodeLine{6613             c(1,n1,rg-\/2-\/n1)=0d0}
\DoxyCodeLine{6614 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{6615 \textcolor{keywordflow}{        end do}   }
\DoxyCodeLine{6616 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{6617 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(cerr-\/acc\_req\_cr*abs(c(0,0,0))).le.0d0.and.r.ge.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6618 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6619 \textcolor{preprocessor}{}}
\DoxyCodeLine{6620 \textcolor{preprocessor}{\#ifdef Cgytest}}
\DoxyCodeLine{6621 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy exit rloop'},r,cerr,maxval(cerr)}
\DoxyCodeLine{6622 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6623 \textcolor{preprocessor}{}}
\DoxyCodeLine{6624         \textcolor{keywordflow}{exit} rloop }
\DoxyCodeLine{6625 }
\DoxyCodeLine{6626 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6627 }
\DoxyCodeLine{6628 \textcolor{keywordflow}{    end do} rloop}
\DoxyCodeLine{6629 }
\DoxyCodeLine{6630 }
\DoxyCodeLine{6631     \textcolor{comment}{! calculating C\_0000ijk.. exploiting eq. (5.49)}}
\DoxyCodeLine{6632     \textcolor{keywordflow}{do} r=4,rmax}
\DoxyCodeLine{6633 \textcolor{comment}{!      do n0=2,rmax/2     !     for fixed rank}}
\DoxyCodeLine{6634       \textcolor{keywordflow}{do} n0=2,rmax}
\DoxyCodeLine{6635         \textcolor{keywordflow}{do} nl=r-\/2*n0,0,-\/1}
\DoxyCodeLine{6636           nlt=r-\/2*n0-\/nl}
\DoxyCodeLine{6637           inds0(l) = nl}
\DoxyCodeLine{6638           inds0(lt) = nlt}
\DoxyCodeLine{6639 }
\DoxyCodeLine{6640           inds(l) = nl+1}
\DoxyCodeLine{6641           inds(lt) = nlt}
\DoxyCodeLine{6642           caux = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,1)*shat(n0-\/1,inds(1),inds(2),1)  \&}
\DoxyCodeLine{6643                + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,2)*shat(n0-\/1,inds(1),inds(2),2)  \&}
\DoxyCodeLine{6644                -\/ \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(k)*c(n0-\/1,inds(1),inds(2))}
\DoxyCodeLine{6645 }
\DoxyCodeLine{6646           inds(k) = inds(k)+1}
\DoxyCodeLine{6647           caux = caux -\/ \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*c(n0-\/1,inds(1),inds(2))}
\DoxyCodeLine{6648 }
\DoxyCodeLine{6649           \textcolor{keywordflow}{if} (nlt.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6650             inds(l) = nl+1}
\DoxyCodeLine{6651             inds(lt) = nlt-\/1}
\DoxyCodeLine{6652             caux = caux -\/ 2*nlt*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,lt)*c(n0,inds(1),inds(2))}
\DoxyCodeLine{6653 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{6654 }
\DoxyCodeLine{6655           c(n0,inds0(1),inds0(2)) = caux/(2*(nl+1)*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l))}
\DoxyCodeLine{6656 }
\DoxyCodeLine{6657 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{6658 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{6659 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{6660 }
\DoxyCodeLine{6661       \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2=r, n0>0 }}
\DoxyCodeLine{6662     \textcolor{keywordflow}{do} r=rmax+1,2*rmax}
\DoxyCodeLine{6663       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{6664         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{6665           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{6666           c(n0,n1,n2) = (b\_0(n0-\/1,n1,n2) + 2*mm02*c(n0-\/1,n1,n2) + 4*cuv(n0,n1,n2) \&}
\DoxyCodeLine{6667                         + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)*c(n0-\/1,n1+1,n2) + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)*c(n0-\/1,n1,n2+1)) / (2*r)}
\DoxyCodeLine{6668 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{6669 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{6670 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{6671 }
\DoxyCodeLine{6672 \textcolor{preprocessor}{\#ifdef Cgytest}}
\DoxyCodeLine{6673 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy final err'},cerr}
\DoxyCodeLine{6674     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy final acc'},cerr/abs(c(0,0,0))}
\DoxyCodeLine{6675 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6676 \textcolor{preprocessor}{}}
\DoxyCodeLine{6677 \textcolor{comment}{!   write(*,*) 'CalcCgy out',(((C((r-\/n1-\/n2)/2,n1,n2),n2=0,r-\/n1),n1=0,r),r=0,rmax)}}
\DoxyCodeLine{6678 \textcolor{preprocessor}{\#ifdef TRACECout}}
\DoxyCodeLine{6679 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy rmax'},rmax}
\DoxyCodeLine{6680     \textcolor{keywordflow}{do} r=14,rmax}
\DoxyCodeLine{6681     \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{6682     \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{6683     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy out'},r,n0,n1,r-\/2*n0-\/n1,c(n0,n1,r-\/2*n0-\/n1)}
\DoxyCodeLine{6684 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{6685 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{6686 \textcolor{keywordflow}{    end do}   }
\DoxyCodeLine{6687 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6688 \textcolor{preprocessor}{}}
\DoxyCodeLine{6689 \textcolor{comment}{!    write(*,*) 'CalcCgy Cerr ',Cerr}}
\DoxyCodeLine{6690 \textcolor{comment}{!    write(*,*) 'CalcCgy Cerr2',Cerr2}}
\DoxyCodeLine{6691 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductionc_a02b30603b2e8f40a4f0ca04ac28e25c5}\label{namespacereductionc_a02b30603b2e8f40a4f0ca04ac28e25c5}} 
\index{reductionc@{reductionc}!calccgyo@{calccgyo}}
\index{calccgyo@{calccgyo}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{calccgyo()}{calccgyo()}}
{\footnotesize\ttfamily subroutine reductionc\+::calccgyo (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{C,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Cuv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{ordgy\+\_\+min,  }\item[{integer, intent(in)}]{ordgy\+\_\+max,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr,  }\item[{double precision, dimension(0\+:rmax), intent(in)}]{acc\+\_\+req\+\_\+\+Cr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr2 }\end{DoxyParamCaption})}



Definition at line 6706 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{6706   }
\DoxyCodeLine{6707     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobalc}{globalc}}}
\DoxyCodeLine{6708   }
\DoxyCodeLine{6709     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,ordgy\_min,ordgy\_max,id}
\DoxyCodeLine{6710     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{6711     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: C(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{6712     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Cuv(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{6713     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Cerr(0:rmax),Cerr2(0:rmax)}
\DoxyCodeLine{6714     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(in)} :: acc\_req\_Cr(0:rmax)}
\DoxyCodeLine{6715     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Cexpgy(:,:,:,:), CuvExpgy(:,:,:)}
\DoxyCodeLine{6716     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: B\_0(:,:,:), B\_i(:,:,:), Shat(:,:,:,:)}
\DoxyCodeLine{6717     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Buv\_0(:,:,:), Buv\_i(:,:,:)}
\DoxyCodeLine{6718     \textcolor{keywordtype}{double complex} :: Smod, Caux}
\DoxyCodeLine{6719     \textcolor{keywordtype}{double complex} :: C0\_coli, elimminf2\_coli}
\DoxyCodeLine{6720     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err(:),Cij\_err(:)}
\DoxyCodeLine{6721     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{6722     \textcolor{keywordtype}{double precision} :: B\_err,B\_max}
\DoxyCodeLine{6723     \textcolor{keywordtype}{double precision} :: maxCexpgy(0:1,0:rmax+2*ordgy\_min,0:ordgy\_max),truncfacexp}
\DoxyCodeLine{6724     \textcolor{keywordtype}{integer} :: rmaxB,rmaxExp,gtrunc,r,n0,n1,n2,a,b,j,sgnab,g,rg}
\DoxyCodeLine{6725     \textcolor{keywordtype}{integer} :: inds0(2),inds(2),at,bt,k,l,lt,nl,nlt}
\DoxyCodeLine{6726     \textcolor{keywordtype}{integer} :: bin,nid(0:2)}
\DoxyCodeLine{6727 }
\DoxyCodeLine{6728 \textcolor{preprocessor}{\#ifdef Cgytest}}
\DoxyCodeLine{6729 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy in '},rmax,ordgy\_min,ordgy\_max,id}
\DoxyCodeLine{6730 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6731 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifdef TRACECin}}
\DoxyCodeLine{6732 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy in '},rmax,ordgy\_min,ordgy\_max,id}
\DoxyCodeLine{6733 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6734 \textcolor{preprocessor}{}}
\DoxyCodeLine{6735     \textcolor{comment}{! write(*,*) 'LH: CalcCgy, ord', ordgy\_min}}
\DoxyCodeLine{6736     \textcolor{comment}{! calculation of B-\/coefficients}}
\DoxyCodeLine{6737     rmaxb = rmax + 2*ordgy\_min + 1}
\DoxyCodeLine{6738     \textcolor{keyword}{allocate}(b\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{6739     \textcolor{keyword}{allocate}(buv\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{6740     \textcolor{keyword}{allocate}(b\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{6741     \textcolor{keyword}{allocate}(buv\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{6742 }
\DoxyCodeLine{6743     \textcolor{comment}{! determine binaries for B-\/coefficients}}
\DoxyCodeLine{6744     k=0}
\DoxyCodeLine{6745     bin = 1}
\DoxyCodeLine{6746     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.2)}
\DoxyCodeLine{6747       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6748         nid(k) = id+bin}
\DoxyCodeLine{6749         k = k+1}
\DoxyCodeLine{6750 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6751       bin = 2*bin}
\DoxyCodeLine{6752 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{6753 }
\DoxyCodeLine{6754     \textcolor{keyword}{call }calcb(b\_0(:,0,:),buv\_0(:,0,:),p21,m12,m22,rmaxb,nid(0))}
\DoxyCodeLine{6755     \textcolor{keyword}{call }calcb(b\_i(:,:,1),buv\_i(:,:,1),p20,m02,m22,rmaxb,nid(1))}
\DoxyCodeLine{6756     \textcolor{keyword}{call }calcb(b\_i(:,:,2),buv\_i(:,:,2),p10,m02,m12,rmaxb,nid(2))}
\DoxyCodeLine{6757 }
\DoxyCodeLine{6758    \textcolor{comment}{! shift of integration momentum in B\_0}}
\DoxyCodeLine{6759     b\_max=0d0}
\DoxyCodeLine{6760     \textcolor{keywordflow}{do} n1=1,rmaxb}
\DoxyCodeLine{6761       \textcolor{keywordflow}{do} n2=0,rmaxb-\/n1}
\DoxyCodeLine{6762         n0 = (rmaxb-\/n1-\/n2)}
\DoxyCodeLine{6763         b\_0(0:n0,n1,n2) = -\/b\_0(0:n0,n1-\/1,n2)-\/b\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{6764         buv\_0(0:n0,n1,n2) = -\/buv\_0(0:n0,n1-\/1,n2)-\/buv\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{6765 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{6766 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{6767     b\_max = max(b\_max,maxval(abs(b\_i(0,0:rmaxb,1:2))))}
\DoxyCodeLine{6768     b\_err = acc\_def\_b*b\_max}
\DoxyCodeLine{6769 }
\DoxyCodeLine{6770     \textcolor{comment}{! determine (adjugated) Gram and Cayley matrix}}
\DoxyCodeLine{6771 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{6772 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{6773 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{6774 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{6775 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{6776 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{6777 \textcolor{comment}{!}}
\DoxyCodeLine{6778 \textcolor{comment}{!    q1q2 = (q10+q20-\/q21)}}
\DoxyCodeLine{6779 \textcolor{comment}{!    detZ = 4d0*q10*q20-\/q1q2*q1q2}}
\DoxyCodeLine{6780 }
\DoxyCodeLine{6781     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}/( 4d0*\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}*\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}} + \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1))).lt.1d-\/4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6782       \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}-\/\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}).lt.abs(\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}-\/\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}).and.  \&}
\DoxyCodeLine{6783           abs(\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}-\/\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}).lt.abs(\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}-\/\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}})) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6784         \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}  =  4d0*\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}*\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}} -\/ (\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}-\/\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}+\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}})*(\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}-\/\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}+\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}})}
\DoxyCodeLine{6785 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6786 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{6787 }
\DoxyCodeLine{6788 \textcolor{comment}{!    Zadj(1,1) = 2d0*q20}}
\DoxyCodeLine{6789 \textcolor{comment}{!    Zadj(2,1) = -\/q1q2}}
\DoxyCodeLine{6790 \textcolor{comment}{!    Zadj(1,2) = -\/q1q2}}
\DoxyCodeLine{6791 \textcolor{comment}{!    Zadj(2,2) = 2d0*q10}}
\DoxyCodeLine{6792 \textcolor{comment}{!    f(1) = q10+mm02-\/mm12}}
\DoxyCodeLine{6793 \textcolor{comment}{!    f(2) = q20+mm02-\/mm22}}
\DoxyCodeLine{6794 \textcolor{comment}{!}}
\DoxyCodeLine{6795 \textcolor{comment}{!    Zadjf(1) = Zadj(1,1)*f(1)+Zadj(2,1)*f(2)}}
\DoxyCodeLine{6796 \textcolor{comment}{!    Zadjf(2) = Zadj(1,2)*f(1)+Zadj(2,2)*f(2)}}
\DoxyCodeLine{6797 \textcolor{comment}{!}}
\DoxyCodeLine{6798 \textcolor{comment}{! Xadj(1,1) and Xadj(2,2) exchanged!!!}}
\DoxyCodeLine{6799 \textcolor{comment}{!    Xadj(1,1) = 2d0*mm02*Z(1,1) -\/ f(1)*f(1)}}
\DoxyCodeLine{6800 \textcolor{comment}{!    Xadj(2,1) = 2d0*mm02*Z(1,2) -\/ f(1)*f(2)}}
\DoxyCodeLine{6801 \textcolor{comment}{!    Xadj(1,2) = Xadj(2,1)}}
\DoxyCodeLine{6802 \textcolor{comment}{!    Xadj(2,2) = 2d0*mm02*Z(2,2) -\/ f(2)*f(2)}}
\DoxyCodeLine{6803 }
\DoxyCodeLine{6804 }
\DoxyCodeLine{6805     \textcolor{comment}{! coefficients Shat defined in (5.13)}}
\DoxyCodeLine{6806     \textcolor{keyword}{allocate}(shat(0:rmaxb,0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{6807 }
\DoxyCodeLine{6808     \textcolor{keywordflow}{do} r=0,rmaxb}
\DoxyCodeLine{6809       \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{6810 }
\DoxyCodeLine{6811         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{6812           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{6813           shat(n0,n1,n2,:) = -\/b\_0(n0,n1,n2)}
\DoxyCodeLine{6814 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{6815 }
\DoxyCodeLine{6816         k = r-\/2*n0}
\DoxyCodeLine{6817         shat(n0,0,k,1) = shat(n0,0,k,1) + b\_i(n0,k,1)}
\DoxyCodeLine{6818         shat(n0,k,0,2) = shat(n0,k,0,2) + b\_i(n0,k,2)}
\DoxyCodeLine{6819 }
\DoxyCodeLine{6820 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{6821 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{6822 }
\DoxyCodeLine{6823     \textcolor{comment}{! choose reduction formulas with biggest denominators}}
\DoxyCodeLine{6824     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,1)).ge.abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6825       \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,1)).ge.abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6826         a = 1}
\DoxyCodeLine{6827         b = 1}
\DoxyCodeLine{6828         at = 2}
\DoxyCodeLine{6829         bt = 2}
\DoxyCodeLine{6830         sgnab = 1}
\DoxyCodeLine{6831       \textcolor{keywordflow}{else}}
\DoxyCodeLine{6832         a = 1}
\DoxyCodeLine{6833         b = 2}
\DoxyCodeLine{6834         at = 2}
\DoxyCodeLine{6835         bt = 1}
\DoxyCodeLine{6836         sgnab = -\/1}
\DoxyCodeLine{6837 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6838     \textcolor{keywordflow}{else}        }
\DoxyCodeLine{6839       \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,2)).ge.abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6840         a = 2}
\DoxyCodeLine{6841         b = 2}
\DoxyCodeLine{6842         at = 1}
\DoxyCodeLine{6843         bt = 1}
\DoxyCodeLine{6844         sgnab = 1}
\DoxyCodeLine{6845       \textcolor{keywordflow}{else} }
\DoxyCodeLine{6846         a = 1}
\DoxyCodeLine{6847         b = 2}
\DoxyCodeLine{6848         at = 2}
\DoxyCodeLine{6849         bt = 1}
\DoxyCodeLine{6850         sgnab = -\/1}
\DoxyCodeLine{6851 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6852 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{6853 }
\DoxyCodeLine{6854     \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1)).ge.abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6855       \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1)).ge.abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6856         k = 1}
\DoxyCodeLine{6857         l = 1}
\DoxyCodeLine{6858         lt = 2}
\DoxyCodeLine{6859       \textcolor{keywordflow}{else}}
\DoxyCodeLine{6860         k = 1}
\DoxyCodeLine{6861         l = 2}
\DoxyCodeLine{6862         lt = 1}
\DoxyCodeLine{6863 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6864     \textcolor{keywordflow}{else}        }
\DoxyCodeLine{6865       \textcolor{keywordflow}{if} (abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2)).ge.abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2))) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6866         k = 2}
\DoxyCodeLine{6867         l = 2}
\DoxyCodeLine{6868         lt = 1}
\DoxyCodeLine{6869       \textcolor{keywordflow}{else} }
\DoxyCodeLine{6870         k = 1}
\DoxyCodeLine{6871         l = 2}
\DoxyCodeLine{6872         lt = 1}
\DoxyCodeLine{6873 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6874 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{6875 }
\DoxyCodeLine{6876     \textcolor{comment}{! allocation of array for det(Z)-\/ and det(X)-\/expanded C-\/coefficients}}
\DoxyCodeLine{6877     rmaxexp = rmaxb+1}
\DoxyCodeLine{6878     \textcolor{keyword}{allocate}(cexpgy(0:max(rmax/2,1),0:rmaxexp-\/2,0:rmaxexp-\/2,0:ordgy\_max))}
\DoxyCodeLine{6879    }
\DoxyCodeLine{6880     \textcolor{comment}{! calculate Cuv}}
\DoxyCodeLine{6881     \textcolor{keyword}{allocate}(cuvexpgy(0:rmaxexp,0:rmaxexp,0:rmaxexp))}
\DoxyCodeLine{6882     \textcolor{keyword}{call }calccuv(cuvexpgy,buv\_0,mm02,\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}},rmaxexp,id)}
\DoxyCodeLine{6883     cuv(0:rmax,0:rmax,0:rmax) = cuvexpgy(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{6884 }
\DoxyCodeLine{6885     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{6886     \textcolor{keyword}{allocate}(c00\_err(0:rmaxexp))}
\DoxyCodeLine{6887     \textcolor{keyword}{allocate}(cij\_err(0:rmaxexp))}
\DoxyCodeLine{6888     \textcolor{keyword}{allocate}(c00\_err2(0:rmaxexp))}
\DoxyCodeLine{6889     \textcolor{keyword}{allocate}(cij\_err2(0:rmaxexp))}
\DoxyCodeLine{6890 }
\DoxyCodeLine{6891     \textcolor{comment}{! initialize accuracy estimates}}
\DoxyCodeLine{6892     cerr = acc\_inf}
\DoxyCodeLine{6893     cij\_err =0d0}
\DoxyCodeLine{6894     c00\_err =0d0}
\DoxyCodeLine{6895 }
\DoxyCodeLine{6896     cerr2 = acc\_inf}
\DoxyCodeLine{6897     cij\_err2 =0d0}
\DoxyCodeLine{6898     c00\_err2 =0d0}
\DoxyCodeLine{6899 }
\DoxyCodeLine{6900 \textcolor{comment}{!    maxZadjf = maxval(abs(Zadjf))}}
\DoxyCodeLine{6901 \textcolor{comment}{!    fmax = maxval(abs(f))}}
\DoxyCodeLine{6902 }
\DoxyCodeLine{6903     \textcolor{comment}{! truncation of expansion if calculated term larger than truncfacexp * previous term}}
\DoxyCodeLine{6904     \textcolor{comment}{! crucial for expansion parameters between 0.1 and 1 !!!}}
\DoxyCodeLine{6905 \textcolor{comment}{!    truncfacexp = sqrt(max(maxZadjf,abs(detZ))/abs(Xadj(a,b))*max(1d0,fmax/abs(Zadj(k,l)))) * truncfacC}}
\DoxyCodeLine{6906     truncfacexp = sqrt(\mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}}) * truncfacc}
\DoxyCodeLine{6907 }
\DoxyCodeLine{6908     gtrunc = ordgy\_max }
\DoxyCodeLine{6909 }
\DoxyCodeLine{6910 \textcolor{comment}{! calculate C(1,n1,n2) up to rank r+2}}
\DoxyCodeLine{6911 \textcolor{comment}{! calculate C(0,n1,n2) up to rank r  }}
\DoxyCodeLine{6912     rloop: \textcolor{keywordflow}{do} r=0,rmaxexp-\/2}
\DoxyCodeLine{6913 }
\DoxyCodeLine{6914       \textcolor{keywordflow}{if} (r.gt.rmax+2*gtrunc+2) \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{6915 }
\DoxyCodeLine{6916       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{6917       \textcolor{comment}{! 0th-\/order coefficients}}
\DoxyCodeLine{6918       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{6919 }
\DoxyCodeLine{6920       \textcolor{comment}{! calculating C\_00ijk.. exploiting eq. (5.49)}}
\DoxyCodeLine{6921       maxcexpgy(1,r,0)=0d0}
\DoxyCodeLine{6922       \textcolor{keywordflow}{do} nl=r,0,-\/1}
\DoxyCodeLine{6923         nlt=r-\/nl}
\DoxyCodeLine{6924         inds0(l) = nl}
\DoxyCodeLine{6925         inds0(lt) = nlt}
\DoxyCodeLine{6926 }
\DoxyCodeLine{6927         inds(l) = nl+1}
\DoxyCodeLine{6928         inds(lt) = nlt}
\DoxyCodeLine{6929         caux = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,1)*shat(0,inds(1),inds(2),1)  \&}
\DoxyCodeLine{6930              + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,2)*shat(0,inds(1),inds(2),2)}
\DoxyCodeLine{6931 }
\DoxyCodeLine{6932         \textcolor{keywordflow}{if} (nlt.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6933           inds(lt) = nlt-\/1}
\DoxyCodeLine{6934           caux = caux -\/ 2*nlt*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,lt)*cexpgy(1,inds(1),inds(2),0)}
\DoxyCodeLine{6935 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6936 }
\DoxyCodeLine{6937         cexpgy(1,inds0(1),inds0(2),0) = caux/(2*(nl+1)*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l))}
\DoxyCodeLine{6938         maxcexpgy(1,r,0) =  maxcexpgy(1,r,0) + abs(cexpgy(1,inds0(1),inds0(2),0) )}
\DoxyCodeLine{6939         \textcolor{keywordflow}{if} (r+2.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6940           c(1,inds0(1),inds0(2)) = cexpgy(1,inds0(1),inds0(2),0)}
\DoxyCodeLine{6941 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6942 }
\DoxyCodeLine{6943 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{6944 }
\DoxyCodeLine{6945       \textcolor{comment}{! calculate C\_ijkl.. exploiting eq. (5.53)}}
\DoxyCodeLine{6946       maxcexpgy(0,r,0)=0d0}
\DoxyCodeLine{6947       \textcolor{keywordflow}{do} n1=0,r}
\DoxyCodeLine{6948         n2 = r-\/n1}
\DoxyCodeLine{6949         inds(1) = n1}
\DoxyCodeLine{6950         inds(2) = n2}
\DoxyCodeLine{6951       }
\DoxyCodeLine{6952         caux = (2*(2+r)*cexpgy(1,n1,n2,0) -\/ 4*cuvexpgy(1,n1,n2)  \&}
\DoxyCodeLine{6953              -\/ b\_0(0,n1,n2))*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(a,b)}
\DoxyCodeLine{6954 }
\DoxyCodeLine{6955 \textcolor{comment}{!     write(*,*) 'CalcCred Caux',Caux,Z(a,b),f(a),f(b)}}
\DoxyCodeLine{6956 }
\DoxyCodeLine{6957         smod = shat(0,n1,n2,a)}
\DoxyCodeLine{6958 }
\DoxyCodeLine{6959         \textcolor{keywordflow}{if} (inds(a).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6960           inds(a) = inds(a)-\/1}
\DoxyCodeLine{6961           smod = smod -\/ 2d0*(inds(a)+1)*cexpgy(1,inds(1),inds(2),0)}
\DoxyCodeLine{6962 }
\DoxyCodeLine{6963 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6964 }
\DoxyCodeLine{6965         caux = caux -\/ \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(b)*smod}
\DoxyCodeLine{6966 }
\DoxyCodeLine{6967 \textcolor{comment}{!       write(*,*) 'CalcCgy maxadjf',maxZadjf,Xadj(a,b),Caux}}
\DoxyCodeLine{6968 }
\DoxyCodeLine{6969         cexpgy(0,n1,n2,0) = caux/\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(a,b)}
\DoxyCodeLine{6970         maxcexpgy(0,r,0) =  maxcexpgy(0,r,0) + abs(cexpgy(0,n1,n2,0))}
\DoxyCodeLine{6971         \textcolor{keywordflow}{if} (r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6972           c(0,n1,n2) = cexpgy(0,n1,n2,0)}
\DoxyCodeLine{6973           cerr(r) =  abs(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(a,b)*cexpgy(0,n1,n2,0))}
\DoxyCodeLine{6974 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{6975 }
\DoxyCodeLine{6976 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{6977 }
\DoxyCodeLine{6978       \textcolor{keywordflow}{if} (r.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{6979 \textcolor{comment}{!       Cerr(r-\/1) =  abs(maxZadjf/Xadj(a,b))*maxCexpgy(0,r,0)}}
\DoxyCodeLine{6980         cerr(r-\/1) =  \mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}}*maxcexpgy(0,r,0)}
\DoxyCodeLine{6981 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{6982 }
\DoxyCodeLine{6983  \textcolor{comment}{! error propagation from B's}}
\DoxyCodeLine{6984       c00\_err(r+2) = b\_err           }
\DoxyCodeLine{6985       cij\_err(r)=max(abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(a,b))/abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(a,b))*max(b\_err,c00\_err(r+2)),  \&}
\DoxyCodeLine{6986                   \mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}/abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(a,b))*max(b\_err,c00\_err(r+1)))}
\DoxyCodeLine{6987 }
\DoxyCodeLine{6988       c00\_err2(r+2) = b\_err           }
\DoxyCodeLine{6989       cij\_err2(r)=max(abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(a,b))/abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(a,b))*max(b\_err,c00\_err(r+2)),  \&}
\DoxyCodeLine{6990                   \mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}/abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(a,b))*max(b\_err,c00\_err2(r+1)))}
\DoxyCodeLine{6991 }
\DoxyCodeLine{6992       }
\DoxyCodeLine{6993       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{6994       \textcolor{comment}{! higher order coefficients}}
\DoxyCodeLine{6995       \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{6996 }
\DoxyCodeLine{6997       rg = r}
\DoxyCodeLine{6998       gloop: \textcolor{keywordflow}{do} g=1,min(gtrunc,r/2)}
\DoxyCodeLine{6999         rg = rg-\/2}
\DoxyCodeLine{7000 }
\DoxyCodeLine{7001 \textcolor{comment}{!        write(*,*) 'CalcCgy gtrunc gloop=',gtrunc,r,g,rg}}
\DoxyCodeLine{7002 }
\DoxyCodeLine{7003         \textcolor{comment}{! calculating C\_00ijk.. exploiting eq. (5.49)}}
\DoxyCodeLine{7004         maxcexpgy(1,rg,g) = 0d0}
\DoxyCodeLine{7005         \textcolor{keywordflow}{do} nl=rg,0,-\/1}
\DoxyCodeLine{7006           nlt=rg-\/nl}
\DoxyCodeLine{7007           inds0(l) = nl}
\DoxyCodeLine{7008           inds0(lt) = nlt}
\DoxyCodeLine{7009 }
\DoxyCodeLine{7010           inds(l) = nl+1}
\DoxyCodeLine{7011           inds(lt) = nlt}
\DoxyCodeLine{7012           caux = -\/\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(k)*cexpgy(0,inds(1),inds(2),g-\/1)}
\DoxyCodeLine{7013 }
\DoxyCodeLine{7014           inds(k) = inds(k)+1}
\DoxyCodeLine{7015           caux = caux -\/ \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*cexpgy(0,inds(1),inds(2),g-\/1)}
\DoxyCodeLine{7016 }
\DoxyCodeLine{7017           \textcolor{keywordflow}{if} (nlt.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7018             inds(l) = nl+1}
\DoxyCodeLine{7019             inds(lt) = nlt-\/1}
\DoxyCodeLine{7020             caux = caux -\/ 2*nlt*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,lt)*cexpgy(1,inds(1),inds(2),g)}
\DoxyCodeLine{7021 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7022 }
\DoxyCodeLine{7023           cexpgy(1,inds0(1),inds0(2),g) = caux/(2*(nl+1)*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l))}
\DoxyCodeLine{7024           maxcexpgy(1,rg,g) =  maxcexpgy(1,rg,g) + abs(cexpgy(1,inds0(1),inds0(2),g) )}
\DoxyCodeLine{7025 }
\DoxyCodeLine{7026 }
\DoxyCodeLine{7027           \textcolor{keywordflow}{if} (g.eq.1.and.abs(cexpgy(1,inds0(1),inds0(2),g)).gt.      \&}
\DoxyCodeLine{7028               truncfacexp*max(1d0,maxcexpgy(1,rg,g-\/1))    .or.   \&}
\DoxyCodeLine{7029               g.ge.2.and.abs(cexpgy(1,inds0(1),inds0(2),g)).gt.  \&}
\DoxyCodeLine{7030               truncfacexp*maxcexpgy(1,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7031 }
\DoxyCodeLine{7032 \textcolor{preprocessor}{\#ifdef Cgytest            }}
\DoxyCodeLine{7033 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy cycle loop'},n1,n2,g,abs(cexpgy(1,inds0(1),inds0(2),g)),maxcexpgy(1,rg,g-\/1)}
\DoxyCodeLine{7034 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7035 \textcolor{preprocessor}{}}
\DoxyCodeLine{7036                 gtrunc = g-\/1}
\DoxyCodeLine{7037                 \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{7038 \textcolor{comment}{!                gtrunc = g}}
\DoxyCodeLine{7039 \textcolor{comment}{!                cycle gloop}}
\DoxyCodeLine{7040 }
\DoxyCodeLine{7041 \textcolor{keywordflow}{          end if} }
\DoxyCodeLine{7042         }
\DoxyCodeLine{7043 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7044 }
\DoxyCodeLine{7045 \textcolor{preprocessor}{\#ifndef PPEXP00}}
\DoxyCodeLine{7046 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (rg+2.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7047           \textcolor{keywordflow}{do} nl=rg,0,-\/1}
\DoxyCodeLine{7048             nlt=rg-\/nl}
\DoxyCodeLine{7049             inds0(l) = nl}
\DoxyCodeLine{7050             inds0(lt) = nlt}
\DoxyCodeLine{7051             c(1,inds0(1),inds0(2)) = c(1,inds0(1),inds0(2))  \&}
\DoxyCodeLine{7052                 + cexpgy(1,inds0(1),inds0(2),g)}
\DoxyCodeLine{7053 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{7054 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7055 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7056 \textcolor{preprocessor}{}}
\DoxyCodeLine{7057         \textcolor{comment}{! calculate C\_ijkl.. exploiting eq. (5.53)}}
\DoxyCodeLine{7058         maxcexpgy(0,rg,g) = 0d0}
\DoxyCodeLine{7059         \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{7060           n2 = rg-\/n1}
\DoxyCodeLine{7061           inds0(1) = n1}
\DoxyCodeLine{7062           inds0(2) = n2}
\DoxyCodeLine{7063           }
\DoxyCodeLine{7064           caux = 2*(2+rg)*cexpgy(1,n1,n2,g)*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(a,b)}
\DoxyCodeLine{7065           }
\DoxyCodeLine{7066 \textcolor{comment}{!         write(*,*) 'CalcCgy g Caux 1',rg,g,Caux}}
\DoxyCodeLine{7067 }
\DoxyCodeLine{7068           \textcolor{keywordflow}{if} (inds0(a).ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7069             inds = inds0}
\DoxyCodeLine{7070             inds(a) = inds(a)-\/1}
\DoxyCodeLine{7071             caux = caux + 2d0*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(b)*inds0(a)*cexpgy(1,inds(1),inds(2),g)}
\DoxyCodeLine{7072 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7073           }
\DoxyCodeLine{7074 \textcolor{comment}{!         write(*,*) 'CalcCgy g Caux 2',rg,g,Caux}}
\DoxyCodeLine{7075 }
\DoxyCodeLine{7076           inds0(at) = inds0(at)+1}
\DoxyCodeLine{7077           caux = caux -\/ sgnab*\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(bt)*cexpgy(0,inds0(1),inds0(2),g-\/1)}
\DoxyCodeLine{7078           }
\DoxyCodeLine{7079 \textcolor{comment}{!         write(*,*) 'CalcCgy g Caux 3',rg,g,Caux}}
\DoxyCodeLine{7080 }
\DoxyCodeLine{7081           cexpgy(0,n1,n2,g) = caux/\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(a,b)}
\DoxyCodeLine{7082 }
\DoxyCodeLine{7083 \textcolor{comment}{!         write(*,*) 'CalcCgyo g Cexpgy',rg,g,n1,n2,Cexpgy(0,n1,n2,g)}}
\DoxyCodeLine{7084 }
\DoxyCodeLine{7085           maxcexpgy(0,rg,g) =  maxcexpgy(0,rg,g) + abs(cexpgy(0,n1,n2,g))}
\DoxyCodeLine{7086           }
\DoxyCodeLine{7087           \textcolor{keywordflow}{if} (g.eq.1.and.abs(cexpgy(0,n1,n2,g)).gt.        \&}
\DoxyCodeLine{7088               truncfacexp*max(1d0/\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}},maxcexpgy(0,rg,g-\/1)).or.     \&}
\DoxyCodeLine{7089               g.ge.2.and.abs(cexpgy(0,n1,n2,g)).gt.        \&}
\DoxyCodeLine{7090               truncfacexp*maxcexpgy(0,rg,g-\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7091 }
\DoxyCodeLine{7092 \textcolor{preprocessor}{\#ifdef Cgytest            }}
\DoxyCodeLine{7093 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy cycle loop'},n1,n2,g,abs(cexpgy(0,n1,n2,g)),maxcexpgy(0,rg,g-\/1)}
\DoxyCodeLine{7094 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7095 \textcolor{preprocessor}{}}
\DoxyCodeLine{7096             gtrunc = g-\/1}
\DoxyCodeLine{7097             \textcolor{keywordflow}{exit} gloop}
\DoxyCodeLine{7098 \textcolor{comment}{!           gtrunc = g}}
\DoxyCodeLine{7099 \textcolor{comment}{!           cycle gloop}}
\DoxyCodeLine{7100 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7101 }
\DoxyCodeLine{7102 \textcolor{comment}{!            if ((g.ge.2).and.(abs(Cexpgy(0,n1,n2,g)).gt.truncfacexp*abs(Cexpgy(0,n1,n2,g-\/1)))) then}}
\DoxyCodeLine{7103 \textcolor{comment}{!              gtrunc = g-\/1}}
\DoxyCodeLine{7104 \textcolor{comment}{!            end if}}
\DoxyCodeLine{7105 }
\DoxyCodeLine{7106 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7107 }
\DoxyCodeLine{7108         \textcolor{comment}{! error propagation from B's}}
\DoxyCodeLine{7109         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{7110           c00\_err(rg+2) =max(c00\_err(rg+2),                                       \&}
\DoxyCodeLine{7111               max(abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(k))*cij\_err(rg+1),abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})*cij\_err(rg+2))/abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)))   }
\DoxyCodeLine{7112 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7113         cij\_err(rg)= max( cij\_err(rg),                                          \&}
\DoxyCodeLine{7114             max(abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(a,b))*c00\_err(rg+2),abs(\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(b))*c00\_err(rg+1),       \&}
\DoxyCodeLine{7115             abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(b))*cij\_err(rg+1))/abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(a,b)))}
\DoxyCodeLine{7116 }
\DoxyCodeLine{7117         \textcolor{keywordflow}{if}(rg.gt.1)\textcolor{keywordflow}{then}}
\DoxyCodeLine{7118           c00\_err2(rg+2) =max(c00\_err2(rg+2),                                       \&}
\DoxyCodeLine{7119               max(abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(k))*cij\_err2(rg+1),abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})*cij\_err2(rg+2))/abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l)))   }
\DoxyCodeLine{7120 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7121         cij\_err2(rg)= max( cij\_err2(rg),                                          \&}
\DoxyCodeLine{7122             max(abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(a,b))*c00\_err2(rg+2),abs(\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(b))*c00\_err2(rg+1),       \&}
\DoxyCodeLine{7123             abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(b))*cij\_err2(rg+1))/abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(a,b)))}
\DoxyCodeLine{7124 }
\DoxyCodeLine{7125 \textcolor{preprocessor}{\#ifdef PPEXP00}}
\DoxyCodeLine{7126 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (rg+2.le.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7127           \textcolor{keywordflow}{do} nl=rg,0,-\/1}
\DoxyCodeLine{7128             nlt=rg-\/nl}
\DoxyCodeLine{7129             inds0(l) = nl}
\DoxyCodeLine{7130             inds0(lt) = nlt}
\DoxyCodeLine{7131             c(1,inds0(1),inds0(2)) = c(1,inds0(1),inds0(2))  \&}
\DoxyCodeLine{7132                 + cexpgy(1,inds0(1),inds0(2),g)}
\DoxyCodeLine{7133 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{7134 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7135 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7136 \textcolor{preprocessor}{}}
\DoxyCodeLine{7137         \textcolor{keywordflow}{if} ((rg.le.rmax)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7138           cerr(rg) = 0d0}
\DoxyCodeLine{7139           \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{7140             n2=rg-\/n1}
\DoxyCodeLine{7141             c(0,n1,n2) = c(0,n1,n2) + cexpgy(0,n1,n2,g)}
\DoxyCodeLine{7142             \textcolor{keywordflow}{if}(abs(cexpgy(0,n1,n2,g-\/1)).ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7143               cerr(rg)=max(cerr(rg),abs(cexpgy(0,n1,n2,g))*min(1d0,abs(cexpgy(0,n1,n2,g))/abs(cexpgy(0,n1,n2,g-\/1))))}
\DoxyCodeLine{7144             \textcolor{keywordflow}{else}}
\DoxyCodeLine{7145               cerr(rg)=max(cerr(rg),abs(cexpgy(0,n1,n2,g)))}
\DoxyCodeLine{7146 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{7147 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{7148 }
\DoxyCodeLine{7149           \textcolor{comment}{! if error from B's larger than error from expansion stop expansion}}
\DoxyCodeLine{7150           \textcolor{keywordflow}{if}(cij\_err(rg).gt.cerr(rg)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7151              gtrunc = min(g,gtrunc)}
\DoxyCodeLine{7152 \textcolor{comment}{!            gtrunc = min(g+1,gtrunc)}}
\DoxyCodeLine{7153              }
\DoxyCodeLine{7154 \textcolor{preprocessor}{\#ifdef Cgytest}}
\DoxyCodeLine{7155 \textcolor{preprocessor}{}             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy exit err'},r,g,gtrunc}
\DoxyCodeLine{7156 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7157 \textcolor{preprocessor}{}}
\DoxyCodeLine{7158 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7159 }
\DoxyCodeLine{7160 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{7161         }
\DoxyCodeLine{7162         }
\DoxyCodeLine{7163 \textcolor{keywordflow}{      end do} gloop}
\DoxyCodeLine{7164 }
\DoxyCodeLine{7165 \textcolor{comment}{!     write(*,*) 'CalcCgy gtrunc after gloop=',gtrunc,r}}
\DoxyCodeLine{7166 }
\DoxyCodeLine{7167 \textcolor{preprocessor}{\#ifdef Cgytest}}
\DoxyCodeLine{7168 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy Cerr r ='},r}
\DoxyCodeLine{7169       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy Cerr r ='},r,cerr}
\DoxyCodeLine{7170       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy Cacc r ='},r,cerr/abs(c(0,0,0))}
\DoxyCodeLine{7171       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy Cij\_err ='},r,cij\_err}
\DoxyCodeLine{7172 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7173 \textcolor{preprocessor}{}}
\DoxyCodeLine{7174       cerr2 = max(cerr,cij\_err2(0:rmax))}
\DoxyCodeLine{7175       cerr = max(cerr,cij\_err(0:rmax))}
\DoxyCodeLine{7176 }
\DoxyCodeLine{7177 \textcolor{preprocessor}{\#ifdef Cgytest}}
\DoxyCodeLine{7178 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy Cerr ='},r,cerr,maxval(cerr)}
\DoxyCodeLine{7179 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7180 \textcolor{preprocessor}{}}
\DoxyCodeLine{7181       \textcolor{comment}{! check if target precision already reached}}
\DoxyCodeLine{7182 \textcolor{comment}{!      if(maxval(Cerr-\/acc\_req\_Cr*abs(C(0,0,0))).le.0d0) exit         ! changed 28.01.15}}
\DoxyCodeLine{7183 \textcolor{preprocessor}{\#ifdef Cutrloop}}
\DoxyCodeLine{7184 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(cerr-\/acc\_req\_cr*abs(c(0,0,0))).le.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7185         \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{7186           \textcolor{keywordflow}{do} n1=0,rg}
\DoxyCodeLine{7187             c(0,n1,rg-\/n1)=0d0}
\DoxyCodeLine{7188 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{7189 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7190         \textcolor{keywordflow}{do} rg=r+1,rmax}
\DoxyCodeLine{7191           \textcolor{keywordflow}{do} n1=0,rg-\/2}
\DoxyCodeLine{7192             c(1,n1,rg-\/2-\/n1)=0d0}
\DoxyCodeLine{7193 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{7194 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7195 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{7196 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if}(maxval(cerr-\/acc\_req\_cr*abs(c(0,0,0))).le.0d0.and.r.ge.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7197 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7198 \textcolor{preprocessor}{}        \textcolor{keywordflow}{exit} rloop}
\DoxyCodeLine{7199 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{7200 }
\DoxyCodeLine{7201 \textcolor{keywordflow}{    end do} rloop}
\DoxyCodeLine{7202 }
\DoxyCodeLine{7203 }
\DoxyCodeLine{7204     \textcolor{comment}{! calculating C\_0000ijk.. exploiting eq. (5.49)}}
\DoxyCodeLine{7205     \textcolor{keywordflow}{do} r=4,rmax}
\DoxyCodeLine{7206       \textcolor{keywordflow}{do} n0=2,rmax/2}
\DoxyCodeLine{7207         \textcolor{keywordflow}{do} nl=r-\/2*n0,0,-\/1}
\DoxyCodeLine{7208           nlt=r-\/2*n0-\/nl}
\DoxyCodeLine{7209           inds0(l) = nl}
\DoxyCodeLine{7210           inds0(lt) = nlt}
\DoxyCodeLine{7211 }
\DoxyCodeLine{7212           inds(l) = nl+1}
\DoxyCodeLine{7213           inds(lt) = nlt}
\DoxyCodeLine{7214           caux = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,1)*shat(n0-\/1,inds(1),inds(2),1)  \&}
\DoxyCodeLine{7215                + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,2)*shat(n0-\/1,inds(1),inds(2),2)  \&}
\DoxyCodeLine{7216                -\/ \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(k)*c(n0-\/1,inds(1),inds(2))}
\DoxyCodeLine{7217 }
\DoxyCodeLine{7218           inds(k) = inds(k)+1}
\DoxyCodeLine{7219           caux = caux -\/ \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*c(n0-\/1,inds(1),inds(2))}
\DoxyCodeLine{7220 }
\DoxyCodeLine{7221           \textcolor{keywordflow}{if} (nlt.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{7222             inds(l) = nl+1}
\DoxyCodeLine{7223             inds(lt) = nlt-\/1}
\DoxyCodeLine{7224             caux = caux -\/ 2*nlt*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,lt)*c(n0,inds(1),inds(2))}
\DoxyCodeLine{7225 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{7226 }
\DoxyCodeLine{7227           c(n0,inds0(1),inds0(2)) = caux/(2*(nl+1)*\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(k,l))}
\DoxyCodeLine{7228 }
\DoxyCodeLine{7229 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7230 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7231 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7232 }
\DoxyCodeLine{7233       \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2=r, n0>0 }}
\DoxyCodeLine{7234     \textcolor{keywordflow}{do} r=rmax+1,2*rmax}
\DoxyCodeLine{7235       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{7236         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{7237           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{7238           c(n0,n1,n2) = (b\_0(n0-\/1,n1,n2) + 2*mm02*c(n0-\/1,n1,n2) + 4*cuv(n0,n1,n2) \&}
\DoxyCodeLine{7239                         + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)*c(n0-\/1,n1+1,n2) + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)*c(n0-\/1,n1,n2+1)) / (2*r)}
\DoxyCodeLine{7240 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{7241 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{7242 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7243 }
\DoxyCodeLine{7244 \textcolor{preprocessor}{\#ifdef Cgytest}}
\DoxyCodeLine{7245 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy final err'},cerr}
\DoxyCodeLine{7246     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgy final acc'},cerr/abs(c(0,0,0))}
\DoxyCodeLine{7247 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7248 \textcolor{preprocessor}{}}
\DoxyCodeLine{7249 \textcolor{comment}{!   write(*,*) 'CalcCgyo out',(((C((r-\/n1-\/n2)/2,n1,n2),n2=0,r-\/n1),n1=0,r),r=0,rmax)}}
\DoxyCodeLine{7250 \textcolor{preprocessor}{\#ifdef TRACECout}}
\DoxyCodeLine{7251 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgyo rmax'},rmax}
\DoxyCodeLine{7252     \textcolor{keywordflow}{do} r=14,rmax}
\DoxyCodeLine{7253     \textcolor{keywordflow}{do} n0=0,r/2}
\DoxyCodeLine{7254     \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{7255     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgyo out'},r,n0,n1,r-\/2*n0-\/n1,c(n0,n1,r-\/2*n0-\/n1)}
\DoxyCodeLine{7256 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7257 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{7258 \textcolor{keywordflow}{    end do}   }
\DoxyCodeLine{7259 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7260 \textcolor{preprocessor}{}}
\DoxyCodeLine{7261 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductionc_a1e457556ed977295844fa971024ff95c}\label{namespacereductionc_a1e457556ed977295844fa971024ff95c}} 
\index{reductionc@{reductionc}!calccpv@{calccpv}}
\index{calccpv@{calccpv}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{calccpv()}{calccpv()}}
{\footnotesize\ttfamily subroutine reductionc\+::calccpv (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{C,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Cuv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr2 }\end{DoxyParamCaption})}



Definition at line 3130 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{3130   }
\DoxyCodeLine{3131     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobalc}{globalc}}}
\DoxyCodeLine{3132   }
\DoxyCodeLine{3133     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,id}
\DoxyCodeLine{3134     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{3135     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Cuv(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3136     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: C(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3137     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}  :: Cerr(0:rmax),Cerr2(0:rmax)}
\DoxyCodeLine{3138     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: B\_0(:,:,:), Buv\_0(:,:,:)}
\DoxyCodeLine{3139     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: B\_i(:,:,:), Buv\_i(:,:,:)}
\DoxyCodeLine{3140     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_alt(:,:,:)}
\DoxyCodeLine{3141     \textcolor{keywordtype}{double complex} :: Smod(2)}
\DoxyCodeLine{3142     \textcolor{keywordtype}{double complex} :: C0\_coli, elimminf2\_coli}
\DoxyCodeLine{3143     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err(:),Cij\_err(:)}
\DoxyCodeLine{3144     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{3145     \textcolor{keywordtype}{double precision} :: B\_err,B\_max}
\DoxyCodeLine{3146     \textcolor{keywordtype}{integer} :: rmaxB,r,n0,n1,n2,nn0,nn1,nn2,i,j}
\DoxyCodeLine{3147     \textcolor{keywordtype}{integer} :: bin,k,nid(0:2)}
\DoxyCodeLine{3148 }
\DoxyCodeLine{3149 \textcolor{preprocessor}{\#ifdef Cpvtest}}
\DoxyCodeLine{3150 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv in '}, id}
\DoxyCodeLine{3151 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3152 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifdef TRACECin}}
\DoxyCodeLine{3153 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv !n '}, id}
\DoxyCodeLine{3154 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3155 \textcolor{preprocessor}{}}
\DoxyCodeLine{3156     \textcolor{comment}{! calculation of scalar coefficient}}
\DoxyCodeLine{3157     c(0,0,0) = c0\_coli(p10,p21,p20,m02,m12,m22)}
\DoxyCodeLine{3158     cuv(0,0,0) = 0d0}
\DoxyCodeLine{3159 }
\DoxyCodeLine{3160     \textcolor{comment}{! accuracy estimate for C0 function}}
\DoxyCodeLine{3161     cerr(0) = acc\_def\_c0*max(1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}),abs(c(0,0,0)))   }
\DoxyCodeLine{3162     cerr2(0) = acc\_def\_c0*max(1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}),abs(c(0,0,0)))   }
\DoxyCodeLine{3163 }
\DoxyCodeLine{3164 \textcolor{comment}{!    write(*,*) 'CalcCpv: Cerr(0)= ',Cerr(0),Cerr(0)/abs(C(0,0,0)),abs(C(0,0,0))}}
\DoxyCodeLine{3165 }
\DoxyCodeLine{3166     \textcolor{keywordflow}{if} (rmax.eq.0) \textcolor{keywordflow}{return}}
\DoxyCodeLine{3167     }
\DoxyCodeLine{3168     \textcolor{comment}{! allocation and calculation of B functions}}
\DoxyCodeLine{3169     rmaxb = rmax-\/1}
\DoxyCodeLine{3170     \textcolor{comment}{! rmaxB = max(rmax-\/1,0)}}
\DoxyCodeLine{3171     \textcolor{keyword}{allocate}(b\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{3172     \textcolor{keyword}{allocate}(buv\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{3173     \textcolor{keyword}{allocate}(b\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{3174     \textcolor{keyword}{allocate}(buv\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{3175 }
\DoxyCodeLine{3176     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{3177     \textcolor{keyword}{allocate}(c00\_err(0:rmax))}
\DoxyCodeLine{3178     \textcolor{keyword}{allocate}(cij\_err(0:rmax))}
\DoxyCodeLine{3179     \textcolor{keyword}{allocate}(c00\_err2(0:rmax))}
\DoxyCodeLine{3180     \textcolor{keyword}{allocate}(cij\_err2(0:rmax))}
\DoxyCodeLine{3181     }
\DoxyCodeLine{3182     \textcolor{comment}{! determine binaries for B-\/coefficients}}
\DoxyCodeLine{3183     k=0}
\DoxyCodeLine{3184     bin = 1}
\DoxyCodeLine{3185     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.2)}
\DoxyCodeLine{3186       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3187         nid(k) = id+bin}
\DoxyCodeLine{3188         k = k+1}
\DoxyCodeLine{3189 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3190       bin = 2*bin}
\DoxyCodeLine{3191 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3192 }
\DoxyCodeLine{3193     \textcolor{keyword}{call }calcb(b\_0(:,0,:),buv\_0(:,0,:),p21,m12,m22,rmaxb,nid(0))}
\DoxyCodeLine{3194     \textcolor{keyword}{call }calcb(b\_i(:,:,1),buv\_i(:,:,1),p20,m02,m22,rmaxb,nid(1))}
\DoxyCodeLine{3195     \textcolor{keyword}{call }calcb(b\_i(:,:,2),buv\_i(:,:,2),p10,m02,m12,rmaxb,nid(2))}
\DoxyCodeLine{3196 }
\DoxyCodeLine{3197     \textcolor{comment}{! shift of integration momentum in B\_0 and calculate maximal B(0,...)}}
\DoxyCodeLine{3198     b\_max=0d0}
\DoxyCodeLine{3199     \textcolor{keywordflow}{do} n1=1,rmaxb}
\DoxyCodeLine{3200       \textcolor{keywordflow}{do} n2=0,rmaxb-\/n1}
\DoxyCodeLine{3201         n0 = (rmaxb-\/n1-\/n2)}
\DoxyCodeLine{3202         b\_0(0:n0,n1,n2) = -\/b\_0(0:n0,n1-\/1,n2)-\/b\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{3203         buv\_0(0:n0,n1,n2) = -\/buv\_0(0:n0,n1-\/1,n2)-\/buv\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{3204         b\_max = max(b\_max,abs(b\_0(0,n1,n2)))}
\DoxyCodeLine{3205 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3206 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3207 }
\DoxyCodeLine{3208 \textcolor{comment}{!    write(*,*) 'B\_max=',B\_max}}
\DoxyCodeLine{3209 }
\DoxyCodeLine{3210     b\_max=max(b\_max,maxval(abs(b\_i(0,0:rmaxb,1:2))))}
\DoxyCodeLine{3211 }
\DoxyCodeLine{3212     \textcolor{comment}{! determine inverse Gram matrix}}
\DoxyCodeLine{3213 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{3214 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{3215 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{3216 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{3217 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{3218 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{3219 \textcolor{comment}{! }}
\DoxyCodeLine{3220 \textcolor{comment}{!    q1q2 = (q10+q20-\/q21)}}
\DoxyCodeLine{3221 \textcolor{comment}{!    detZ = 4d0*q10*q20-\/q1q2*q1q2}}
\DoxyCodeLine{3222 \textcolor{comment}{!    Zinv(1,1) = 2d0*q20/detZ}}
\DoxyCodeLine{3223 \textcolor{comment}{!    Zinv(2,1) = -\/q1q2/detZ}}
\DoxyCodeLine{3224 \textcolor{comment}{!    Zinv(1,2) = Zinv(2,1)}}
\DoxyCodeLine{3225 \textcolor{comment}{!    Zinv(2,2) = 2d0*q10/detZ}}
\DoxyCodeLine{3226 \textcolor{comment}{!    f(1) = q10+mm02-\/mm12}}
\DoxyCodeLine{3227 \textcolor{comment}{!    f(2) = q20+mm02-\/mm22}}
\DoxyCodeLine{3228 }
\DoxyCodeLine{3229     \textcolor{comment}{! commented out 2.9.2017}}
\DoxyCodeLine{3230     \textcolor{comment}{! Zinv = Zadj/detZ}}
\DoxyCodeLine{3231 }
\DoxyCodeLine{3232     \textcolor{comment}{! calculate Cuv}}
\DoxyCodeLine{3233     \textcolor{keyword}{call }calccuv(cuv,buv\_0,mm02,\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}},rmax,id)}
\DoxyCodeLine{3234 }
\DoxyCodeLine{3235     \textcolor{comment}{! initialization of error propagation}}
\DoxyCodeLine{3236 \textcolor{comment}{!    Zadj=Zinv*detZ    }}
\DoxyCodeLine{3237 }
\DoxyCodeLine{3238 \textcolor{comment}{!    maxZadj = max(abs(Zadj(1,1)),abs(Zadj(2,1)),abs(Zadj(2,2)))}}
\DoxyCodeLine{3239 }
\DoxyCodeLine{3240 \textcolor{comment}{!    Zadjf(1) = Zadj(1,1)*f(1)+Zadj(2,1)*f(2)}}
\DoxyCodeLine{3241 \textcolor{comment}{!    Zadjf(2) = Zadj(1,2)*f(1)+Zadj(2,2)*f(2)}}
\DoxyCodeLine{3242 \textcolor{comment}{!    maxZadjf = max(abs(Zadjf(1)),abs(Zadjf(2)))}}
\DoxyCodeLine{3243 }
\DoxyCodeLine{3244 \textcolor{comment}{!    aZadjff = abs(Zadjf(1)*f(1)+Zadjf(2)*f(2))}}
\DoxyCodeLine{3245 }
\DoxyCodeLine{3246 \textcolor{comment}{!    adetZ = abs(detZ)}}
\DoxyCodeLine{3247 \textcolor{comment}{!    adetX = abs(2d0*mm02*detZ-\/Zadjf(1)*f(1)-\/Zadjf(2)*f(2))}}
\DoxyCodeLine{3248 }
\DoxyCodeLine{3249 \textcolor{comment}{!    write(*,*) 'adZ=',maxZadj,adetZ}}
\DoxyCodeLine{3250 }
\DoxyCodeLine{3251 }
\DoxyCodeLine{3252     cij\_err =0d0}
\DoxyCodeLine{3253     c00\_err =0d0}
\DoxyCodeLine{3254     cij\_err(0) = cerr(0)}
\DoxyCodeLine{3255     b\_err = acc\_def\_b*b\_max}
\DoxyCodeLine{3256 }
\DoxyCodeLine{3257     cij\_err2 =0d0}
\DoxyCodeLine{3258     c00\_err2 =0d0}
\DoxyCodeLine{3259     cij\_err2(0) = cerr2(0)}
\DoxyCodeLine{3260 }
\DoxyCodeLine{3261 \textcolor{comment}{!    write(*,*) 'CalcCpv: B\_err= ',B\_err,acc\_B,B\_max}}
\DoxyCodeLine{3262 }
\DoxyCodeLine{3263     \textcolor{keyword}{allocate}(c\_alt(0:rmax,0:rmax,0:rmax))}
\DoxyCodeLine{3264 }
\DoxyCodeLine{3265     \textcolor{comment}{! PV reduction}}
\DoxyCodeLine{3266     \textcolor{keywordflow}{do} r=1,rmax}
\DoxyCodeLine{3267 }
\DoxyCodeLine{3268       \textcolor{keywordflow}{if} (mod(r,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3269         \textcolor{comment}{! reduction formula (5.10) for C(r/2,0,0)}}
\DoxyCodeLine{3270         n0 = r/2        }
\DoxyCodeLine{3271         c(n0,0,0) = (b\_0(n0-\/1,0,0) + 2*mm02*c(n0-\/1,0,0) + 4*cuv(n0,0,0) \&}
\DoxyCodeLine{3272                         + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)*c(n0-\/1,1,0) + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)*c(n0-\/1,0,1)) / (2*r)}
\DoxyCodeLine{3273 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3274 }
\DoxyCodeLine{3275       \textcolor{keywordflow}{do} n0=(r-\/1)/2,0,-\/1}
\DoxyCodeLine{3276         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3277           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{3278 }
\DoxyCodeLine{3279           \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3280             nn1 = n1-\/1}
\DoxyCodeLine{3281             nn2 = n2}
\DoxyCodeLine{3282             j = 1}
\DoxyCodeLine{3283           \textcolor{keywordflow}{else}}
\DoxyCodeLine{3284             nn1 = n1}
\DoxyCodeLine{3285             nn2 = n2-\/1}
\DoxyCodeLine{3286             j = 2}
\DoxyCodeLine{3287 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3288          }
\DoxyCodeLine{3289           \textcolor{comment}{! reduction formula (5.11) for C(n0,n1,n2), n1+n2=/=0}}
\DoxyCodeLine{3290           \textcolor{keywordflow}{do} i=1,2}
\DoxyCodeLine{3291             smod(i) = -\/b\_0(n0,nn1,nn2)-\/\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(i)*c(n0,nn1,nn2)}
\DoxyCodeLine{3292 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{3293           }
\DoxyCodeLine{3294           \textcolor{keywordflow}{if} (nn1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3295             smod(1) = smod(1) -\/ 2d0*nn1*c(n0+1,nn1-\/1,nn2)}
\DoxyCodeLine{3296           \textcolor{keywordflow}{else}          }
\DoxyCodeLine{3297             smod(1) = smod(1) + b\_i(n0,nn2,1)}
\DoxyCodeLine{3298 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3299 }
\DoxyCodeLine{3300           \textcolor{keywordflow}{if} (nn2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3301             smod(2) = smod(2) -\/ 2d0*nn2*c(n0+1,nn1,nn2-\/1)}
\DoxyCodeLine{3302           \textcolor{keywordflow}{else}}
\DoxyCodeLine{3303             smod(2) = smod(2) + b\_i(n0,nn1,2)}
\DoxyCodeLine{3304 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3305           }
\DoxyCodeLine{3306           c(n0,n1,n2) = \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(1,j)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(2,j)*smod(2)}
\DoxyCodeLine{3307 }
\DoxyCodeLine{3308 \textcolor{comment}{!        if(n0.eq.0) then}}
\DoxyCodeLine{3309 \textcolor{comment}{!          write(*,*) 'Ca(0,n1,n2)=',n1,n2,C(0,n1,n2),nn1,nn2}}
\DoxyCodeLine{3310 \textcolor{comment}{!          write(*,*) 'Ca(0,n1,n2)=',Zinv(1,j),Smod(1),Zinv(2,j),Smod(2)}}
\DoxyCodeLine{3311 \textcolor{comment}{!        end if}}
\DoxyCodeLine{3312  }
\DoxyCodeLine{3313 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3314 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3315 }
\DoxyCodeLine{3316       \textcolor{comment}{! determine error from symmetry for n0=0 and n1>1, n2>1 }}
\DoxyCodeLine{3317       cerr(r)=cerr(r-\/1)}
\DoxyCodeLine{3318       cerr2(r)=cerr2(r-\/1)}
\DoxyCodeLine{3319       n0=0}
\DoxyCodeLine{3320         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3321           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{3322 }
\DoxyCodeLine{3323           \textcolor{keywordflow}{if} (n1.ge.1.and.n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3324             nn1 = n1}
\DoxyCodeLine{3325             nn2 = n2-\/1}
\DoxyCodeLine{3326             j = 2}
\DoxyCodeLine{3327          }
\DoxyCodeLine{3328             \textcolor{comment}{! reduction formula (5.11) for C(n0,n1,n2), n1+n2=/=0}}
\DoxyCodeLine{3329             \textcolor{keywordflow}{do} i=1,2}
\DoxyCodeLine{3330               smod(i) = -\/b\_0(n0,nn1,nn2)-\/\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(i)*c(n0,nn1,nn2)}
\DoxyCodeLine{3331 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{3332           }
\DoxyCodeLine{3333             \textcolor{keywordflow}{if} (nn1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3334               smod(1) = smod(1) -\/ 2d0*nn1*c(n0+1,nn1-\/1,nn2)}
\DoxyCodeLine{3335             \textcolor{keywordflow}{else}          }
\DoxyCodeLine{3336               smod(1) = smod(1) + b\_i(n0,nn2,1)}
\DoxyCodeLine{3337 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3338 }
\DoxyCodeLine{3339             \textcolor{keywordflow}{if} (nn2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3340               smod(2) = smod(2) -\/ 2d0*nn2*c(n0+1,nn1,nn2-\/1)}
\DoxyCodeLine{3341             \textcolor{keywordflow}{else}}
\DoxyCodeLine{3342               smod(2) = smod(2) + b\_i(n0,nn1,2)}
\DoxyCodeLine{3343 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3344            }
\DoxyCodeLine{3345             c\_alt(n0,n1,n2) = \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(1,j)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(2,j)*smod(2)}
\DoxyCodeLine{3346  }
\DoxyCodeLine{3347             cerr(r)=max(cerr(r),abs(c(n0,n1,n2)-\/c\_alt(n0,n1,n2)))}
\DoxyCodeLine{3348             cerr2(r)=max(cerr2(r),abs(c(n0,n1,n2)-\/c\_alt(n0,n1,n2)))}
\DoxyCodeLine{3349 }
\DoxyCodeLine{3350 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3351 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3352 }
\DoxyCodeLine{3353       \textcolor{keywordflow}{if}(r.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{3354         c00\_err(r) = max(abs(m02)*cij\_err(r-\/2), b\_err,    \&}
\DoxyCodeLine{3355               \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*cij\_err(r-\/2),             \&}
\DoxyCodeLine{3356               \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*max(c00\_err(r-\/1),b\_err))}
\DoxyCodeLine{3357 }
\DoxyCodeLine{3358 \textcolor{comment}{!        write(*,*) 'C00errtest',r,abs(m02)*Cij\_err(r-\/2), B\_err,    \&}}
\DoxyCodeLine{3359 \textcolor{comment}{!              aZadjff/adetZ*Cij\_err(r-\/2),             \&}}
\DoxyCodeLine{3360 \textcolor{comment}{!              maxZadjf/adetZ*C00\_err(r-\/1),maxZadjf/adetZ*B\_err, \&}}
\DoxyCodeLine{3361 \textcolor{comment}{!              C00\_err(r)}}
\DoxyCodeLine{3362 }
\DoxyCodeLine{3363       \textcolor{keywordflow}{else}}
\DoxyCodeLine{3364         c00\_err(r) = 0d0}
\DoxyCodeLine{3365 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3366       cij\_err(r) = max(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*cij\_err(r-\/1),   \&}
\DoxyCodeLine{3367               \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(c00\_err(r),b\_err))/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3368  }
\DoxyCodeLine{3369       \textcolor{keywordflow}{if}(r.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{3370         c00\_err2(r) = max(abs(m02)*cij\_err(r-\/2), b\_err,    \&}
\DoxyCodeLine{3371               \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*cij\_err2(r-\/2),             \&}
\DoxyCodeLine{3372               \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*max(c00\_err2(r-\/1),b\_err))}
\DoxyCodeLine{3373 }
\DoxyCodeLine{3374 \textcolor{comment}{!        write(*,*) 'C00errtest',r,abs(m02)*Cij\_err(r-\/2), B\_err,    \&}}
\DoxyCodeLine{3375 \textcolor{comment}{!              aZadjff/adetZ*Cij\_err(r-\/2),             \&}}
\DoxyCodeLine{3376 \textcolor{comment}{!              maxZadjf/adetZ*C00\_err(r-\/1),maxZadjf/adetZ*B\_err, \&}}
\DoxyCodeLine{3377 \textcolor{comment}{!              C00\_err(r)}}
\DoxyCodeLine{3378 }
\DoxyCodeLine{3379       \textcolor{keywordflow}{else}}
\DoxyCodeLine{3380         c00\_err2(r) = 0d0}
\DoxyCodeLine{3381 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3382       cij\_err2(r) = max((\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})*cij\_err2(r-\/1),   \&}
\DoxyCodeLine{3383                         max(c00\_err2(r),b\_err))/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})}
\DoxyCodeLine{3384  }
\DoxyCodeLine{3385 \textcolor{comment}{!      write(*,*) 'CalcCpv r',r, Cij\_err(r),maxZadjf*Cij\_err(r-\/1)/adetZ,  \&}}
\DoxyCodeLine{3386 \textcolor{comment}{!              maxZadj*(C00\_err(r))/adetZ,  \&          }}
\DoxyCodeLine{3387 \textcolor{comment}{!              maxZadj*(B\_err)/adetZ}}
\DoxyCodeLine{3388 }
\DoxyCodeLine{3389 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3390 }
\DoxyCodeLine{3391 }
\DoxyCodeLine{3392       \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2=r, n0>0 }}
\DoxyCodeLine{3393     \textcolor{comment}{! PV reduction (5.10)}}
\DoxyCodeLine{3394     \textcolor{keywordflow}{do} r=rmax+1,2*rmax}
\DoxyCodeLine{3395       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{3396         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3397           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{3398           c(n0,n1,n2) = (b\_0(n0-\/1,n1,n2) + 2*mm02*c(n0-\/1,n1,n2) + 4*cuv(n0,n1,n2) \&}
\DoxyCodeLine{3399                         + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)*c(n0-\/1,n1+1,n2) + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)*c(n0-\/1,n1,n2+1)) / (2*r)}
\DoxyCodeLine{3400 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3401 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3402 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3403 }
\DoxyCodeLine{3404 \textcolor{preprocessor}{\#ifdef Cpvtest}}
\DoxyCodeLine{3405 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv Cerrsym'},cerr}
\DoxyCodeLine{3406     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv Caccsym'},cerr/abs(c(0,0,0))}
\DoxyCodeLine{3407  }
\DoxyCodeLine{3408     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv Cijerr'},cij\_err(1:rmax)}
\DoxyCodeLine{3409     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv Cijacc'},cij\_err(1:rmax)/abs(c(0,0,0))}
\DoxyCodeLine{3410 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3411 \textcolor{preprocessor}{}}
\DoxyCodeLine{3412     cerr2 = max(cerr2,cij\_err2(0:rmax))}
\DoxyCodeLine{3413     cerr = max(cerr,cij\_err(0:rmax))}
\DoxyCodeLine{3414 }
\DoxyCodeLine{3415 \textcolor{preprocessor}{\#ifdef Cpvtest}}
\DoxyCodeLine{3416 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv Cerr'},cerr}
\DoxyCodeLine{3417     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv Cacc'},cerr/abs(c(0,0,0))}
\DoxyCodeLine{3418 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3419 \textcolor{preprocessor}{}}
\DoxyCodeLine{3420 \textcolor{comment}{!   write(*,*) 'CalcCpv out',(((C((r-\/n1-\/n2)/2,n1,n2),n2=0,r-\/n1),n1=0,r),r=0,rmax)}}
\DoxyCodeLine{3421 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductionc_a0c9c9737ac7e2bc0981b3641d6114dae}\label{namespacereductionc_a0c9c9737ac7e2bc0981b3641d6114dae}} 
\index{reductionc@{reductionc}!calccpv1@{calccpv1}}
\index{calccpv1@{calccpv1}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{calccpv1()}{calccpv1()}}
{\footnotesize\ttfamily subroutine reductionc\+::calccpv1 (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{C,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Cuv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr2 }\end{DoxyParamCaption})}



Definition at line 2487 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2487   }
\DoxyCodeLine{2488     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobalc}{globalc}}}
\DoxyCodeLine{2489   }
\DoxyCodeLine{2490     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,id}
\DoxyCodeLine{2491     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{2492     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Cuv(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2493     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: C(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2494     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Cerr(0:rmax),Cerr2(0:rmax)}
\DoxyCodeLine{2495 \textcolor{comment}{!   double complex, allocatable :: B\_0(:,:,:), Buv\_0(:,:,:)}}
\DoxyCodeLine{2496 \textcolor{comment}{!   double complex, allocatable :: B\_i(:,:,:), Buv\_i(:,:,:)}}
\DoxyCodeLine{2497 \textcolor{comment}{!   double complex, allocatable :: C\_alt(:,:,:)}}
\DoxyCodeLine{2498     \textcolor{keywordtype}{double complex} :: B\_0(0:rmax-\/1,0:rmax-\/1,0:rmax-\/1), Buv\_0(0:rmax-\/1,0:rmax-\/1,0:rmax-\/1)}
\DoxyCodeLine{2499     \textcolor{keywordtype}{double complex} :: B\_i(0:rmax-\/1,0:rmax-\/1,2), Buv\_i(0:rmax-\/1,0:rmax-\/1,2)}
\DoxyCodeLine{2500     \textcolor{keywordtype}{double complex} :: C\_alt(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2501     \textcolor{keywordtype}{double complex} :: Smod(2)}
\DoxyCodeLine{2502     \textcolor{keywordtype}{double complex} :: C0\_coli, elimminf2\_coli}
\DoxyCodeLine{2503 \textcolor{comment}{!   double precision, allocatable :: C00\_err(:),Cij\_err(:)}}
\DoxyCodeLine{2504 \textcolor{comment}{!   double precision, allocatable :: C00\_err2(:),Cij\_err2(:)}}
\DoxyCodeLine{2505     \textcolor{keywordtype}{double precision} :: C00\_err(0:rmax),Cij\_err(0:rmax)}
\DoxyCodeLine{2506     \textcolor{keywordtype}{double precision} :: C00\_err2(0:rmax),Cij\_err2(0:rmax)}
\DoxyCodeLine{2507     \textcolor{keywordtype}{double precision} :: B\_err,B\_max}
\DoxyCodeLine{2508     \textcolor{keywordtype}{integer} :: rmaxB,r,n0,n1,n2,nn0,nn1,nn2,i,j}
\DoxyCodeLine{2509     \textcolor{keywordtype}{integer} :: bin,k,nid(0:2)}
\DoxyCodeLine{2510 }
\DoxyCodeLine{2511 \textcolor{preprocessor}{\#ifdef Cpv1test}}
\DoxyCodeLine{2512 \textcolor{preprocessor}{}\textcolor{comment}{!    write(*,*) 'CalcCpv1 p in ',p10,p21,p20}}
\DoxyCodeLine{2513 \textcolor{comment}{!    write(*,*) 'CalcCpv1 m in ',m02,m12,m22}}
\DoxyCodeLine{2514     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv1 in '},rmax,id}
\DoxyCodeLine{2515 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2516 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifdef TRACECin}}
\DoxyCodeLine{2517 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv1 in '},rmax,id}
\DoxyCodeLine{2518 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2519 \textcolor{preprocessor}{}}
\DoxyCodeLine{2520     \textcolor{comment}{! calculation of scalar coefficient}}
\DoxyCodeLine{2521     c(0,0,0) = c0\_coli(p10,p21,p20,m02,m12,m22)}
\DoxyCodeLine{2522     cuv(0,0,0) = 0d0}
\DoxyCodeLine{2523 }
\DoxyCodeLine{2524     \textcolor{comment}{! accuracy estimate for C0 function}}
\DoxyCodeLine{2525     cerr(0) = acc\_def\_c0*max(1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}),abs(c(0,0,0)))   }
\DoxyCodeLine{2526     cerr2(0) = acc\_def\_c0*max(1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}),abs(c(0,0,0)))   }
\DoxyCodeLine{2527 }
\DoxyCodeLine{2528     \textcolor{keywordflow}{if} (rmax.eq.0) \textcolor{keywordflow}{return}}
\DoxyCodeLine{2529     }
\DoxyCodeLine{2530     \textcolor{comment}{! allocation and calculation of B functions}}
\DoxyCodeLine{2531     rmaxb = rmax-\/1}
\DoxyCodeLine{2532     \textcolor{comment}{! rmaxB = max(rmax-\/1,0)}}
\DoxyCodeLine{2533 \textcolor{comment}{!   allocate(B\_0(0:rmaxB,0:rmaxB,0:rmaxB))}}
\DoxyCodeLine{2534 \textcolor{comment}{!   allocate(Buv\_0(0:rmaxB,0:rmaxB,0:rmaxB))}}
\DoxyCodeLine{2535 \textcolor{comment}{!   allocate(B\_i(0:rmaxB,0:rmaxB,2))}}
\DoxyCodeLine{2536 \textcolor{comment}{!   allocate(Buv\_i(0:rmaxB,0:rmaxB,2))}}
\DoxyCodeLine{2537 }
\DoxyCodeLine{2538     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{2539 \textcolor{comment}{!   allocate(C00\_err(0:rmax))}}
\DoxyCodeLine{2540 \textcolor{comment}{!   allocate(Cij\_err(0:rmax))}}
\DoxyCodeLine{2541 \textcolor{comment}{!   allocate(C00\_err2(0:rmax))}}
\DoxyCodeLine{2542 \textcolor{comment}{!   allocate(Cij\_err2(0:rmax))}}
\DoxyCodeLine{2543     }
\DoxyCodeLine{2544     \textcolor{comment}{! determine binaries for B-\/coefficients}}
\DoxyCodeLine{2545     k=0}
\DoxyCodeLine{2546     bin = 1}
\DoxyCodeLine{2547     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.2)}
\DoxyCodeLine{2548       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2549         nid(k) = id+bin}
\DoxyCodeLine{2550         k = k+1}
\DoxyCodeLine{2551 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{2552       bin = 2*bin}
\DoxyCodeLine{2553 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{2554 }
\DoxyCodeLine{2555     \textcolor{keyword}{call }calcb(b\_0(:,0,:),buv\_0(:,0,:),p21,m12,m22,rmaxb,nid(0))}
\DoxyCodeLine{2556     \textcolor{keyword}{call }calcb(b\_i(:,:,1),buv\_i(:,:,1),p20,m02,m22,rmaxb,nid(1))}
\DoxyCodeLine{2557     \textcolor{keyword}{call }calcb(b\_i(:,:,2),buv\_i(:,:,2),p10,m02,m12,rmaxb,nid(2))}
\DoxyCodeLine{2558 }
\DoxyCodeLine{2559     \textcolor{comment}{! shift of integration momentum in B\_0 and calculate maximal B(0,...)}}
\DoxyCodeLine{2560     b\_max=0d0}
\DoxyCodeLine{2561     \textcolor{keywordflow}{do} n1=1,rmaxb}
\DoxyCodeLine{2562       \textcolor{keywordflow}{do} n2=0,rmaxb-\/n1}
\DoxyCodeLine{2563         n0 = (rmaxb-\/n1-\/n2)}
\DoxyCodeLine{2564         b\_0(0:n0,n1,n2) = -\/b\_0(0:n0,n1-\/1,n2)-\/b\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{2565         buv\_0(0:n0,n1,n2) = -\/buv\_0(0:n0,n1-\/1,n2)-\/buv\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{2566         b\_max = max(b\_max,abs(b\_0(0,n1,n2)))}
\DoxyCodeLine{2567 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{2568 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{2569 }
\DoxyCodeLine{2570 \textcolor{comment}{!    write(*,*) 'B\_max=',B\_max}}
\DoxyCodeLine{2571 }
\DoxyCodeLine{2572     b\_max=max(b\_max,maxval(abs(b\_i(0,0:rmaxb,1:2))))}
\DoxyCodeLine{2573 }
\DoxyCodeLine{2574     \textcolor{comment}{! determine inverse Gram matrix}}
\DoxyCodeLine{2575     \textcolor{comment}{! commented out 2.9.2017}}
\DoxyCodeLine{2576     \textcolor{comment}{! Zinv = Zadj/detZ}}
\DoxyCodeLine{2577 }
\DoxyCodeLine{2578     \textcolor{comment}{! calculate Cuv}}
\DoxyCodeLine{2579     \textcolor{keyword}{call }calccuv(cuv,buv\_0,mm02,\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}},rmax,id)}
\DoxyCodeLine{2580 }
\DoxyCodeLine{2581     \textcolor{comment}{! initialization of error propagation}}
\DoxyCodeLine{2582     cij\_err =0d0}
\DoxyCodeLine{2583     c00\_err =0d0}
\DoxyCodeLine{2584     cij\_err(0) = cerr(0)}
\DoxyCodeLine{2585     b\_err = acc\_def\_b*b\_max}
\DoxyCodeLine{2586 }
\DoxyCodeLine{2587     cij\_err2 =0d0}
\DoxyCodeLine{2588     c00\_err2 =0d0}
\DoxyCodeLine{2589     cij\_err2(0) = cerr2(0)}
\DoxyCodeLine{2590 }
\DoxyCodeLine{2591 }
\DoxyCodeLine{2592 \textcolor{preprocessor}{\#ifdef Cpv1test}}
\DoxyCodeLine{2593 \textcolor{preprocessor}{}\textcolor{comment}{!    write(*,*) 'CalcCpv1: B\_err= ',B\_err,acc\_def\_B,B\_max}}
\DoxyCodeLine{2594     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpv1 Cij\_err(0)='},cij\_err(0)}
\DoxyCodeLine{2595 \textcolor{comment}{!    write(*,*) 'CalcCpv1 test :', \& }}
\DoxyCodeLine{2596 \textcolor{comment}{!            (1d0 -\/ (Zadjf(1)+Zadjf(2))/detZ), \&}}
\DoxyCodeLine{2597 \textcolor{comment}{!            (detZmZadjf + Zadjs(1)*(mm12-\/mm02) + Zadjs(2)*(mm22-\/mm02)) /detZ}}
\DoxyCodeLine{2598 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2599 \textcolor{preprocessor}{}}
\DoxyCodeLine{2600 \textcolor{comment}{!   allocate(C\_alt(0:rmax,0:rmax,0:rmax))}}
\DoxyCodeLine{2601 }
\DoxyCodeLine{2602     \textcolor{comment}{! PV reduction}}
\DoxyCodeLine{2603     \textcolor{keywordflow}{do} r=1,rmax}
\DoxyCodeLine{2604 }
\DoxyCodeLine{2605     \textcolor{comment}{! reduction formula (5.10) with (5.11) inserted for n0 >= 1}}
\DoxyCodeLine{2606       \textcolor{keywordflow}{do} n0=r/2,1,-\/1}
\DoxyCodeLine{2607         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{2608           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{2609           c(n0,n1,n2) = + 4*cuv(n0,n1,n2) + \mbox{\hyperlink{namespaceglobalc_a8dc59fea129282fd82fda20025969b67}{detx}}/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*c(n0-\/1,n1,n2)}
\DoxyCodeLine{2610             c(n0,n1,n2) = c(n0,n1,n2) \&}
\DoxyCodeLine{2611                 + (\mbox{\hyperlink{namespaceglobalc_ae3a848253264b0b20c9d773d37bbbb44}{detzmzadjf}} + \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(1)*(mm12-\/mm02) + \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(2)*(\mbox{\hyperlink{namespaceglobalc_a7c2a517c5707c2e77eb16e183db3d259}{mm22}}-\/mm02) \&}
\DoxyCodeLine{2612                   ) /\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}} * b\_0(n0-\/1,n1,n2)}
\DoxyCodeLine{2613 \textcolor{comment}{!                + (1d0 -\/ (Zadjf(1)+Zadjf(2))/detZ)* B\_0(n0-\/1,n1,n2)}}
\DoxyCodeLine{2614 }
\DoxyCodeLine{2615             \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2616               c(n0,n1,n2) = c(n0,n1,n2) \&}
\DoxyCodeLine{2617                   -\/ 2*n1*\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*c(n0,n1-\/1,n2)}
\DoxyCodeLine{2618             \textcolor{keywordflow}{else}            }
\DoxyCodeLine{2619               c(n0,n1,n2) = c(n0,n1,n2) \&}
\DoxyCodeLine{2620                   + \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}* b\_i(n0-\/1,n2,1)}
\DoxyCodeLine{2621 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{2622             \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2623               c(n0,n1,n2) = c(n0,n1,n2) \&}
\DoxyCodeLine{2624                   -\/ 2*n2*\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}*c(n0,n1,n2-\/1)}
\DoxyCodeLine{2625             \textcolor{keywordflow}{else}            }
\DoxyCodeLine{2626               c(n0,n1,n2) = c(n0,n1,n2) \&}
\DoxyCodeLine{2627                   + \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}} * b\_i(n0-\/1,n1,2)}
\DoxyCodeLine{2628 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{2629 }
\DoxyCodeLine{2630             c(n0,n1,n2) = c(n0,n1,n2)  / (2*r) }
\DoxyCodeLine{2631 }
\DoxyCodeLine{2632 \textcolor{comment}{!        if(n0.eq.1) then}}
\DoxyCodeLine{2633 \textcolor{comment}{!          write(*,*) 'Ca(1,n1,n2)=',n1,n2, 4*Cuv(n0,n1,n2) + detX/detZ*C(n0-\/1,n1,n2)}}
\DoxyCodeLine{2634 \textcolor{comment}{!          write(*,*) 'Ca(1,n1,n2)=', (detZmZadjf + Zadjs(1)*(mm12-\/mm02) + Zadjs(2)*(mm22-\/mm02) \&}}
\DoxyCodeLine{2635 \textcolor{comment}{!                  ) /detZ * B\_0(n0-\/1,n1,n2)}}
\DoxyCodeLine{2636 \textcolor{comment}{!          write(*,*) 'Ca(1,n1,n2)=', detZmZadjf , Zadjs(1)*(mm12-\/mm02) , Zadjs(2)*(mm22-\/mm02) \&}}
\DoxyCodeLine{2637 \textcolor{comment}{!                  ,detZ , B\_0(n0-\/1,n1,n2)}}
\DoxyCodeLine{2638 \textcolor{comment}{!          write(*,*) 'Ca(1,n1,n2)=', (1d0 -\/ (Zadjf(1)+Zadjf(2))/detZ)* B\_0(n0-\/1,n1,n2)}}
\DoxyCodeLine{2639 \textcolor{comment}{!          write(*,*) 'Ca(1,n1,n2)=',  + Zadjf(1)/detZ* B\_i(n0-\/1,n2,1)}}
\DoxyCodeLine{2640 \textcolor{comment}{!          write(*,*) 'Ca(1,n1,n2)=',   + Zadjf(2)/detZ * B\_i(n0-\/1,n1,2)}}
\DoxyCodeLine{2641 \textcolor{comment}{!        end if}}
\DoxyCodeLine{2642 }
\DoxyCodeLine{2643 \textcolor{keywordflow}{         end do}}
\DoxyCodeLine{2644 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{2645 }
\DoxyCodeLine{2646     \textcolor{comment}{! reduction formula (5.11) with (5.10) inserted for n0 = 0}}
\DoxyCodeLine{2647 \textcolor{comment}{!     do n0=(r-\/1)/2,0,-\/1}}
\DoxyCodeLine{2648       n0=0 }
\DoxyCodeLine{2649         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{2650           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{2651 }
\DoxyCodeLine{2652           \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2653             nn1 = n1-\/1}
\DoxyCodeLine{2654             nn2 = n2}
\DoxyCodeLine{2655             j = 1}
\DoxyCodeLine{2656           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2657             nn1 = n1}
\DoxyCodeLine{2658             nn2 = n2-\/1}
\DoxyCodeLine{2659             j = 2}
\DoxyCodeLine{2660 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2661          }
\DoxyCodeLine{2662 \textcolor{comment}{!          do i=1,2}}
\DoxyCodeLine{2663 \textcolor{comment}{!            Smod(i) = -\/B\_0(n0,nn1,nn2)}}
\DoxyCodeLine{2664 \textcolor{comment}{!          end do}}
\DoxyCodeLine{2665           smod = 0d0}
\DoxyCodeLine{2666           }
\DoxyCodeLine{2667           \textcolor{keywordflow}{if} (nn1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2668             smod(1) = smod(1) -\/ 2d0*nn1*c(n0+1,nn1-\/1,nn2)}
\DoxyCodeLine{2669           \textcolor{keywordflow}{else}          }
\DoxyCodeLine{2670             smod(1) = smod(1) + b\_i(n0,nn2,1)}
\DoxyCodeLine{2671 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2672 }
\DoxyCodeLine{2673           \textcolor{keywordflow}{if} (nn2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2674             smod(2) = smod(2) -\/ 2d0*nn2*c(n0+1,nn1,nn2-\/1)}
\DoxyCodeLine{2675           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2676             smod(2) = smod(2) + b\_i(n0,nn1,2)}
\DoxyCodeLine{2677 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2678           }
\DoxyCodeLine{2679           c(n0,n1,n2) = (\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2)  \&}
\DoxyCodeLine{2680                            -\/ \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(j)*b\_0(n0,nn1,nn2) \&}
\DoxyCodeLine{2681                            -\/ \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j)*c(n0,nn1,nn2))/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}}
\DoxyCodeLine{2682 }
\DoxyCodeLine{2683 \textcolor{preprocessor}{\#ifdef Cpv1test}}
\DoxyCodeLine{2684 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if}(n0.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2685           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Ca(0,n1,n2)='},n1,n2,c(0,n1,n2),nn1,nn2,j}
\DoxyCodeLine{2686           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Ca(0,n1,n2)='},\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j),smod(1),\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j),smod(2)}
\DoxyCodeLine{2687           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Ca(0,n1,n2)='},\mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(j),b\_0(n0,nn1,nn2),\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j),c(n0,nn1,nn2)}
\DoxyCodeLine{2688           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Ca(0,n1,n2)='},\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1),\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2)}
\DoxyCodeLine{2689           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Ca(0,n1,n2)='},-\/\mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(j)*b\_0(n0,nn1,nn2),-\/\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j)*c(n0,nn1,nn2)}
\DoxyCodeLine{2690 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{2691 \textcolor{preprocessor}{\#endif }}
\DoxyCodeLine{2692 \textcolor{preprocessor}{}}
\DoxyCodeLine{2693 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{2694 \textcolor{comment}{!      end do}}
\DoxyCodeLine{2695 }
\DoxyCodeLine{2696       \textcolor{comment}{! determine error from symmetry for n0=0 and n1>=1, n2>=1 }}
\DoxyCodeLine{2697       cerr(r)=cerr(r-\/1)}
\DoxyCodeLine{2698       cerr2(r)=cerr2(r-\/1)}
\DoxyCodeLine{2699       n0=0}
\DoxyCodeLine{2700         \textcolor{keywordflow}{do} n1=1,r-\/2*n0-\/1}
\DoxyCodeLine{2701           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{2702 }
\DoxyCodeLine{2703           nn1 = n1}
\DoxyCodeLine{2704           nn2 = n2-\/1}
\DoxyCodeLine{2705           j = 2}
\DoxyCodeLine{2706          }
\DoxyCodeLine{2707 \textcolor{comment}{!          do i=1,2}}
\DoxyCodeLine{2708 \textcolor{comment}{!            Smod(i) = -\/B\_0(n0,nn1,nn2)}}
\DoxyCodeLine{2709 \textcolor{comment}{!          end do}}
\DoxyCodeLine{2710           smod = 0}
\DoxyCodeLine{2711           }
\DoxyCodeLine{2712           \textcolor{keywordflow}{if} (nn1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2713             smod(1) = smod(1) -\/ 2d0*nn1*c(n0+1,nn1-\/1,nn2)}
\DoxyCodeLine{2714           \textcolor{keywordflow}{else}          }
\DoxyCodeLine{2715             smod(1) = smod(1) + b\_i(n0,nn2,1)}
\DoxyCodeLine{2716 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2717 }
\DoxyCodeLine{2718           \textcolor{keywordflow}{if} (nn2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2719             smod(2) = smod(2) -\/ 2d0*nn2*c(n0+1,nn1,nn2-\/1)}
\DoxyCodeLine{2720           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2721             smod(2) = smod(2) + b\_i(n0,nn1,2)}
\DoxyCodeLine{2722 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2723            }
\DoxyCodeLine{2724           c\_alt(n0,n1,n2) = (\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j)*smod(2)  \&}
\DoxyCodeLine{2725                            -\/ \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(j)*b\_0(n0,nn1,nn2) \&}
\DoxyCodeLine{2726                            -\/ \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j)*c(n0,nn1,nn2))/\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}}
\DoxyCodeLine{2727  }
\DoxyCodeLine{2728           cerr(r)=max(cerr(r),abs(c(n0,n1,n2)-\/c\_alt(n0,n1,n2)))}
\DoxyCodeLine{2729           cerr2(r)=max(cerr2(r),abs(c(n0,n1,n2)-\/c\_alt(n0,n1,n2)))}
\DoxyCodeLine{2730 }
\DoxyCodeLine{2731 \textcolor{preprocessor}{\#ifdef Cpv1test}}
\DoxyCodeLine{2732 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if}(n0.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2733           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Cb(0,n1,n2)='},n1,n2,c\_alt(0,n1,n2),nn1,nn2,j}
\DoxyCodeLine{2734           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Cb(0,n1,n2)='},\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,j),smod(1),\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,j),smod(2)}
\DoxyCodeLine{2735           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Cb(0,n1,n2)='},\mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(j),b\_0(n0,nn1,nn2),\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(j),c(n0,nn1,nn2)}
\DoxyCodeLine{2736 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{2737 \textcolor{preprocessor}{\#endif }}
\DoxyCodeLine{2738 \textcolor{preprocessor}{}\textcolor{comment}{!            write(*,*) 'CalcCpv1 Cerr',n0,n1,n2, Cerr(r), abs(C(n0,n1,n2)),abs(C\_alt(n0,n1,n2))}}
\DoxyCodeLine{2739 }
\DoxyCodeLine{2740 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{2741 }
\DoxyCodeLine{2742       \textcolor{keywordflow}{if}(r.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{2743 \textcolor{comment}{! estimate using insertions of (5.11) in (5.10)}}
\DoxyCodeLine{2744         c00\_err(r) = max(2*abs(m02)*cij\_err(r-\/2), b\_err,    \&}
\DoxyCodeLine{2745               \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*cij\_err(r-\/2),             \&}
\DoxyCodeLine{2746               \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*max(2*c00\_err(r-\/1),b\_err))/(2*r)}
\DoxyCodeLine{2747 }
\DoxyCodeLine{2748 \textcolor{comment}{!        write(*,*) 'C00errtest',r,abs(m02)*Cij\_err(r-\/2), B\_err,    \&}}
\DoxyCodeLine{2749 \textcolor{comment}{!              aZadjff/adetZ*Cij\_err(r-\/2),             \&}}
\DoxyCodeLine{2750 \textcolor{comment}{!              maxZadjf/adetZ*C00\_err(r-\/1),maxZadjf/adetZ*B\_err, \&}}
\DoxyCodeLine{2751 \textcolor{comment}{!              C00\_err(r)}}
\DoxyCodeLine{2752 }
\DoxyCodeLine{2753       \textcolor{keywordflow}{else}}
\DoxyCodeLine{2754         c00\_err(r) = 0d0}
\DoxyCodeLine{2755 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{2756 \textcolor{comment}{! estimate using insertions of (5.10) in (5.11)}}
\DoxyCodeLine{2757       cij\_err(r) = max(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*cij\_err(r-\/1),   \&}
\DoxyCodeLine{2758               \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(2*c00\_err(r),b\_err))/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{2759  }
\DoxyCodeLine{2760       \textcolor{keywordflow}{if}(r.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{2761         c00\_err2(r) = max(2*abs(m02)*cij\_err2(r-\/2), b\_err,    \&}
\DoxyCodeLine{2762               \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*cij\_err2(r-\/2),             \&}
\DoxyCodeLine{2763               \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*max(2*c00\_err(r-\/1),b\_err))/(2*r)}
\DoxyCodeLine{2764 }
\DoxyCodeLine{2765 \textcolor{comment}{!        write(*,*) 'C00errtest',r,abs(m02)*Cij\_err2(r-\/2), B\_err,    \&}}
\DoxyCodeLine{2766 \textcolor{comment}{!              aZadjff/adetZ*Cij\_err2(r-\/2),             \&}}
\DoxyCodeLine{2767 \textcolor{comment}{!              maxZadjf/adetZ*C00\_err2(r-\/1),maxZadjf/adetZ*B\_err, \&}}
\DoxyCodeLine{2768 \textcolor{comment}{!              C00\_err2(r)}}
\DoxyCodeLine{2769 }
\DoxyCodeLine{2770       \textcolor{keywordflow}{else}}
\DoxyCodeLine{2771         c00\_err2(r) = 0d0}
\DoxyCodeLine{2772 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{2773       cij\_err2(r) = max((\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})*cij\_err2(r-\/1),max(2*c00\_err2(r),b\_err))/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})}
\DoxyCodeLine{2774 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{2775 }
\DoxyCodeLine{2776       \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2=r, n0>0 }}
\DoxyCodeLine{2777     \textcolor{keywordflow}{do} r=rmax+1,2*rmax}
\DoxyCodeLine{2778       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{2779         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{2780           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{2781           c(n0,n1,n2) = (b\_0(n0-\/1,n1,n2) + 2*mm02*c(n0-\/1,n1,n2) + 4*cuv(n0,n1,n2) \&}
\DoxyCodeLine{2782                         + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)*c(n0-\/1,n1+1,n2) + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)*c(n0-\/1,n1,n2+1)) / (2*r)}
\DoxyCodeLine{2783 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{2784 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{2785 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{2786 }
\DoxyCodeLine{2787 }
\DoxyCodeLine{2788 \textcolor{preprocessor}{\#ifdef Cpv1test}}
\DoxyCodeLine{2789 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv1 Cerrsym'},cerr}
\DoxyCodeLine{2790     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv1 Caccsym'},cerr/abs(c(0,0,0))}
\DoxyCodeLine{2791  }
\DoxyCodeLine{2792     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv1 Cijerr'},cij\_err(1:rmax)}
\DoxyCodeLine{2793     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv1 Cijacc'},cij\_err(1:rmax)/abs(c(0,0,0))}
\DoxyCodeLine{2794 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2795 \textcolor{preprocessor}{}}
\DoxyCodeLine{2796     cerr2 = max(cerr2,cij\_err2(0:rmax))}
\DoxyCodeLine{2797     cerr = max(cerr,cij\_err(0:rmax))}
\DoxyCodeLine{2798 }
\DoxyCodeLine{2799 \textcolor{preprocessor}{\#ifdef Cpv1test}}
\DoxyCodeLine{2800 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv1 Cerr'},cerr}
\DoxyCodeLine{2801     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv1 Cacc'},cerr/abs(c(0,0,0))}
\DoxyCodeLine{2802 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2803 \textcolor{preprocessor}{}}
\DoxyCodeLine{2804 \textcolor{comment}{!   write(*,*) 'CalcCpv1 out',(((C((r-\/n1-\/n2)/2,n1,n2),n2=0,r-\/n1),n1=0,r),r=0,rmax)}}
\DoxyCodeLine{2805 }
\DoxyCodeLine{2806 \textcolor{comment}{!    write(*,*) 'CalcCpv1 Cerr ',Cerr}}
\DoxyCodeLine{2807 \textcolor{comment}{!    write(*,*) 'CalcCpv1 Cerr2',Cerr2}}
\DoxyCodeLine{2808 }
\DoxyCodeLine{2809 \textcolor{preprocessor}{\#ifdef Cpv1test}}
\DoxyCodeLine{2810 \textcolor{preprocessor}{}\textcolor{comment}{!    write(*,*) 'CalcCpv1 C',C(0,0,0)}}
\DoxyCodeLine{2811 \textcolor{comment}{!    write(*,*) 'CalcCpv1 C1',C(0,1,0)}}
\DoxyCodeLine{2812 \textcolor{comment}{!    write(*,*) 'CalcCpv1 C2',C(0,0,1)}}
\DoxyCodeLine{2813 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2814 \textcolor{preprocessor}{}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductionc_ab619d7b52494c18fd799e600ec0820a3}\label{namespacereductionc_ab619d7b52494c18fd799e600ec0820a3}} 
\index{reductionc@{reductionc}!calccpv1o@{calccpv1o}}
\index{calccpv1o@{calccpv1o}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{calccpv1o()}{calccpv1o()}}
{\footnotesize\ttfamily subroutine reductionc\+::calccpv1o (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{C,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Cuv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr2 }\end{DoxyParamCaption})}



Definition at line 2826 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2826   }
\DoxyCodeLine{2827     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobalc}{globalc}}}
\DoxyCodeLine{2828   }
\DoxyCodeLine{2829     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,id}
\DoxyCodeLine{2830     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{2831     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Cuv(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2832     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: C(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2833     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Cerr(0:rmax),Cerr2(0:rmax)}
\DoxyCodeLine{2834     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: B\_0(:,:,:), Buv\_0(:,:,:)}
\DoxyCodeLine{2835     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: B\_i(:,:,:), Buv\_i(:,:,:)}
\DoxyCodeLine{2836     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_alt(:,:,:)}
\DoxyCodeLine{2837     \textcolor{keywordtype}{double complex} :: Smod(2)}
\DoxyCodeLine{2838     \textcolor{keywordtype}{double complex} :: C0\_coli, elimminf2\_coli}
\DoxyCodeLine{2839     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err(:),Cij\_err(:)}
\DoxyCodeLine{2840     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{2841     \textcolor{keywordtype}{double precision} :: B\_err,B\_max}
\DoxyCodeLine{2842     \textcolor{keywordtype}{integer} :: rmaxB,r,n0,n1,n2,nn0,nn1,nn2,i,j}
\DoxyCodeLine{2843     \textcolor{keywordtype}{integer} :: bin,k,nid(0:2)}
\DoxyCodeLine{2844 }
\DoxyCodeLine{2845 \textcolor{preprocessor}{\#ifdef Cpv1otest}}
\DoxyCodeLine{2846 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv1o in '},rmax,id}
\DoxyCodeLine{2847 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2848 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifdef TRACECin}}
\DoxyCodeLine{2849 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv1o in '},rmax,id}
\DoxyCodeLine{2850 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2851 \textcolor{preprocessor}{}}
\DoxyCodeLine{2852     \textcolor{comment}{! calculation of scalar coefficient}}
\DoxyCodeLine{2853     c(0,0,0) = c0\_coli(p10,p21,p20,m02,m12,m22)}
\DoxyCodeLine{2854     cuv(0,0,0) = 0d0}
\DoxyCodeLine{2855 }
\DoxyCodeLine{2856     \textcolor{comment}{! accuracy estimate for C0 function}}
\DoxyCodeLine{2857     cerr(0) = acc\_def\_c0*max(1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}),abs(c(0,0,0)))   }
\DoxyCodeLine{2858     cerr2(0) = acc\_def\_c0*max(1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}),abs(c(0,0,0)))   }
\DoxyCodeLine{2859 }
\DoxyCodeLine{2860     \textcolor{keywordflow}{if} (rmax.eq.0) \textcolor{keywordflow}{return}}
\DoxyCodeLine{2861     }
\DoxyCodeLine{2862     \textcolor{comment}{! allocation and calculation of B functions}}
\DoxyCodeLine{2863     rmaxb = rmax-\/1}
\DoxyCodeLine{2864     \textcolor{comment}{! rmaxB = max(rmax-\/1,0)}}
\DoxyCodeLine{2865     \textcolor{keyword}{allocate}(b\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{2866     \textcolor{keyword}{allocate}(buv\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{2867     \textcolor{keyword}{allocate}(b\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{2868     \textcolor{keyword}{allocate}(buv\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{2869 }
\DoxyCodeLine{2870     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{2871     \textcolor{keyword}{allocate}(c00\_err(0:rmax))}
\DoxyCodeLine{2872     \textcolor{keyword}{allocate}(cij\_err(0:rmax))}
\DoxyCodeLine{2873     \textcolor{keyword}{allocate}(c00\_err2(0:rmax))}
\DoxyCodeLine{2874     \textcolor{keyword}{allocate}(cij\_err2(0:rmax))}
\DoxyCodeLine{2875     }
\DoxyCodeLine{2876     \textcolor{comment}{! determine binaries for B-\/coefficients}}
\DoxyCodeLine{2877     k=0}
\DoxyCodeLine{2878     bin = 1}
\DoxyCodeLine{2879     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.2)}
\DoxyCodeLine{2880       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2881         nid(k) = id+bin}
\DoxyCodeLine{2882         k = k+1}
\DoxyCodeLine{2883 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{2884       bin = 2*bin}
\DoxyCodeLine{2885 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{2886 }
\DoxyCodeLine{2887     \textcolor{keyword}{call }calcb(b\_0(:,0,:),buv\_0(:,0,:),p21,m12,m22,rmaxb,nid(0))}
\DoxyCodeLine{2888     \textcolor{keyword}{call }calcb(b\_i(:,:,1),buv\_i(:,:,1),p20,m02,m22,rmaxb,nid(1))}
\DoxyCodeLine{2889     \textcolor{keyword}{call }calcb(b\_i(:,:,2),buv\_i(:,:,2),p10,m02,m12,rmaxb,nid(2))}
\DoxyCodeLine{2890 }
\DoxyCodeLine{2891     \textcolor{comment}{! shift of integration momentum in B\_0 and calculate maximal B(0,...)}}
\DoxyCodeLine{2892     b\_max=0d0}
\DoxyCodeLine{2893     \textcolor{keywordflow}{do} n1=1,rmaxb}
\DoxyCodeLine{2894       \textcolor{keywordflow}{do} n2=0,rmaxb-\/n1}
\DoxyCodeLine{2895         n0 = (rmaxb-\/n1-\/n2)}
\DoxyCodeLine{2896         b\_0(0:n0,n1,n2) = -\/b\_0(0:n0,n1-\/1,n2)-\/b\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{2897         buv\_0(0:n0,n1,n2) = -\/buv\_0(0:n0,n1-\/1,n2)-\/buv\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{2898         b\_max = max(b\_max,abs(b\_0(0,n1,n2)))}
\DoxyCodeLine{2899 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{2900 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{2901 }
\DoxyCodeLine{2902 \textcolor{comment}{!    write(*,*) 'B\_max=',B\_max}}
\DoxyCodeLine{2903 }
\DoxyCodeLine{2904     b\_max=max(b\_max,maxval(abs(b\_i(0,0:rmaxb,1:2))))}
\DoxyCodeLine{2905 }
\DoxyCodeLine{2906     \textcolor{comment}{! determine inverse Gram matrix}}
\DoxyCodeLine{2907 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{2908 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{2909 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{2910 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{2911 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{2912 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{2913 \textcolor{comment}{! }}
\DoxyCodeLine{2914 \textcolor{comment}{!    q1q2 = (q10+q20-\/q21)}}
\DoxyCodeLine{2915 \textcolor{comment}{!    detZ = 4d0*q10*q20-\/q1q2*q1q2}}
\DoxyCodeLine{2916 \textcolor{comment}{!    Zinv(1,1) = 2d0*q20/detZ}}
\DoxyCodeLine{2917 \textcolor{comment}{!    Zinv(2,1) = -\/q1q2/detZ}}
\DoxyCodeLine{2918 \textcolor{comment}{!    Zinv(1,2) = Zinv(2,1)}}
\DoxyCodeLine{2919 \textcolor{comment}{!    Zinv(2,2) = 2d0*q10/detZ}}
\DoxyCodeLine{2920 \textcolor{comment}{!    f(1) = q10+mm02-\/mm12}}
\DoxyCodeLine{2921 \textcolor{comment}{!    f(2) = q20+mm02-\/mm22}}
\DoxyCodeLine{2922 }
\DoxyCodeLine{2923     \textcolor{comment}{! commented out 2.9.2017}}
\DoxyCodeLine{2924     \textcolor{comment}{! Zinv = Zadj/detZ}}
\DoxyCodeLine{2925 }
\DoxyCodeLine{2926     \textcolor{comment}{! calculate Cuv}}
\DoxyCodeLine{2927     \textcolor{keyword}{call }calccuv(cuv,buv\_0,mm02,\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}},rmax,id)}
\DoxyCodeLine{2928 }
\DoxyCodeLine{2929     \textcolor{comment}{! initialization of error propagation}}
\DoxyCodeLine{2930 \textcolor{comment}{!    Zadj=Zinv*detZ    }}
\DoxyCodeLine{2931 }
\DoxyCodeLine{2932 \textcolor{comment}{!    maxZadj = max(abs(Zadj(1,1)),abs(Zadj(2,1)),abs(Zadj(2,2)))}}
\DoxyCodeLine{2933 }
\DoxyCodeLine{2934 \textcolor{comment}{!    Zadjf(1) = Zadj(1,1)*f(1)+Zadj(2,1)*f(2)}}
\DoxyCodeLine{2935 \textcolor{comment}{!    Zadjf(2) = Zadj(1,2)*f(1)+Zadj(2,2)*f(2)}}
\DoxyCodeLine{2936 \textcolor{comment}{!    maxZadjf = max(abs(Zadjf(1)),abs(Zadjf(2)))}}
\DoxyCodeLine{2937 }
\DoxyCodeLine{2938 \textcolor{comment}{!    aZadjff = abs(Zadjf(1)*f(1)+Zadjf(2)*f(2))}}
\DoxyCodeLine{2939 }
\DoxyCodeLine{2940 \textcolor{comment}{!    adetZ = abs(detZ)}}
\DoxyCodeLine{2941 \textcolor{comment}{!    adetX = abs(2d0*mm02*detZ-\/Zadjf(1)*f(1)-\/Zadjf(2)*f(2))}}
\DoxyCodeLine{2942 }
\DoxyCodeLine{2943 \textcolor{comment}{!    write(*,*) 'adZ=',maxZadj,adetZ}}
\DoxyCodeLine{2944 }
\DoxyCodeLine{2945 }
\DoxyCodeLine{2946     cij\_err =0d0}
\DoxyCodeLine{2947     c00\_err =0d0}
\DoxyCodeLine{2948     cij\_err(0) = cerr(0)}
\DoxyCodeLine{2949     b\_err = acc\_def\_b*b\_max}
\DoxyCodeLine{2950 }
\DoxyCodeLine{2951     cij\_err2 =0d0}
\DoxyCodeLine{2952     c00\_err2 =0d0}
\DoxyCodeLine{2953     cij\_err2(0) = cerr2(0)}
\DoxyCodeLine{2954 }
\DoxyCodeLine{2955 \textcolor{comment}{!    write(*,*) 'CalcCpv1o: B\_err= ',B\_err,acc\_def\_B,B\_max}}
\DoxyCodeLine{2956 }
\DoxyCodeLine{2957     \textcolor{keyword}{allocate}(c\_alt(0:rmax,0:rmax,0:rmax))}
\DoxyCodeLine{2958 }
\DoxyCodeLine{2959     \textcolor{comment}{! PV reduction}}
\DoxyCodeLine{2960     \textcolor{keywordflow}{do} r=1,rmax}
\DoxyCodeLine{2961 }
\DoxyCodeLine{2962       \textcolor{comment}{! reduction formula (5.10) for C(r/2,0,0)}}
\DoxyCodeLine{2963       \textcolor{keywordflow}{do} n0=r/2,1,-\/1}
\DoxyCodeLine{2964         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{2965           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{2966           c(n0,n1,n2) = (b\_0(n0-\/1,n1,n2) + 2*mm02*c(n0-\/1,n1,n2) + 4*cuv(n0,n1,n2) \&}
\DoxyCodeLine{2967                         + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)*c(n0-\/1,n1+1,n2) + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)*c(n0-\/1,n1,n2+1)) / (2*r)}
\DoxyCodeLine{2968 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{2969 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{2970 }
\DoxyCodeLine{2971 \textcolor{comment}{!     do n0=(r-\/1)/2,0,-\/1}}
\DoxyCodeLine{2972       n0=0 }
\DoxyCodeLine{2973         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{2974           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{2975 }
\DoxyCodeLine{2976           \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2977             nn1 = n1-\/1}
\DoxyCodeLine{2978             nn2 = n2}
\DoxyCodeLine{2979             j = 1}
\DoxyCodeLine{2980           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2981             nn1 = n1}
\DoxyCodeLine{2982             nn2 = n2-\/1}
\DoxyCodeLine{2983             j = 2}
\DoxyCodeLine{2984 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2985          }
\DoxyCodeLine{2986           \textcolor{comment}{! reduction formula (5.11) for C(n0,n1,n2), n1+n2=/=0}}
\DoxyCodeLine{2987           \textcolor{keywordflow}{do} i=1,2}
\DoxyCodeLine{2988             smod(i) = -\/b\_0(n0,nn1,nn2)-\/\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(i)*c(n0,nn1,nn2)}
\DoxyCodeLine{2989 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{2990           }
\DoxyCodeLine{2991           \textcolor{keywordflow}{if} (nn1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2992             smod(1) = smod(1) -\/ 2d0*nn1*c(n0+1,nn1-\/1,nn2)}
\DoxyCodeLine{2993           \textcolor{keywordflow}{else}          }
\DoxyCodeLine{2994             smod(1) = smod(1) + b\_i(n0,nn2,1)}
\DoxyCodeLine{2995 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2996 }
\DoxyCodeLine{2997           \textcolor{keywordflow}{if} (nn2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2998             smod(2) = smod(2) -\/ 2d0*nn2*c(n0+1,nn1,nn2-\/1)}
\DoxyCodeLine{2999           \textcolor{keywordflow}{else}}
\DoxyCodeLine{3000             smod(2) = smod(2) + b\_i(n0,nn1,2)}
\DoxyCodeLine{3001 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3002           }
\DoxyCodeLine{3003           c(n0,n1,n2) = \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(1,j)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(2,j)*smod(2)}
\DoxyCodeLine{3004 }
\DoxyCodeLine{3005 \textcolor{comment}{!        if(n0.eq.0) then}}
\DoxyCodeLine{3006 \textcolor{comment}{!          write(*,*) 'Ca(0,n1,n2)=',n1,n2,C(0,n1,n2),nn1,nn2,j}}
\DoxyCodeLine{3007 \textcolor{comment}{!          write(*,*) 'Ca(0,n1,n2)=',Zinv(1,j),Smod(1),Zinv(2,j),Smod(2)}}
\DoxyCodeLine{3008 \textcolor{comment}{!        end if}}
\DoxyCodeLine{3009  }
\DoxyCodeLine{3010 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3011 \textcolor{comment}{!      end do}}
\DoxyCodeLine{3012 }
\DoxyCodeLine{3013       \textcolor{comment}{! determine error from symmetry for n0=0 and n1>=1, n2>=1 }}
\DoxyCodeLine{3014       cerr(r)=cerr(r-\/1)}
\DoxyCodeLine{3015       cerr2(r)=cerr2(r-\/1)}
\DoxyCodeLine{3016       n0=0}
\DoxyCodeLine{3017         \textcolor{keywordflow}{do} n1=1,r-\/2*n0-\/1}
\DoxyCodeLine{3018           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{3019 }
\DoxyCodeLine{3020           nn1 = n1}
\DoxyCodeLine{3021           nn2 = n2-\/1}
\DoxyCodeLine{3022           j = 2}
\DoxyCodeLine{3023          }
\DoxyCodeLine{3024           \textcolor{comment}{! reduction formula (5.11) for C(n0,n1,n2), n1+n2=/=0}}
\DoxyCodeLine{3025           \textcolor{keywordflow}{do} i=1,2}
\DoxyCodeLine{3026             smod(i) = -\/b\_0(n0,nn1,nn2)-\/\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(i)*c(n0,nn1,nn2)}
\DoxyCodeLine{3027 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{3028           }
\DoxyCodeLine{3029           \textcolor{keywordflow}{if} (nn1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3030             smod(1) = smod(1) -\/ 2d0*nn1*c(n0+1,nn1-\/1,nn2)}
\DoxyCodeLine{3031           \textcolor{keywordflow}{else}          }
\DoxyCodeLine{3032             smod(1) = smod(1) + b\_i(n0,nn2,1)}
\DoxyCodeLine{3033 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3034 }
\DoxyCodeLine{3035           \textcolor{keywordflow}{if} (nn2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3036             smod(2) = smod(2) -\/ 2d0*nn2*c(n0+1,nn1,nn2-\/1)}
\DoxyCodeLine{3037           \textcolor{keywordflow}{else}}
\DoxyCodeLine{3038             smod(2) = smod(2) + b\_i(n0,nn1,2)}
\DoxyCodeLine{3039 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3040            }
\DoxyCodeLine{3041           c\_alt(n0,n1,n2) = \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(1,j)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}}(2,j)*smod(2)}
\DoxyCodeLine{3042  }
\DoxyCodeLine{3043           cerr(r)=max(cerr(r),abs(c(n0,n1,n2)-\/c\_alt(n0,n1,n2)))}
\DoxyCodeLine{3044           cerr2(r)=max(cerr2(r),abs(c(n0,n1,n2)-\/c\_alt(n0,n1,n2)))}
\DoxyCodeLine{3045 }
\DoxyCodeLine{3046 \textcolor{comment}{!            if(n0.eq.0) then}}
\DoxyCodeLine{3047 \textcolor{comment}{!              write(*,*) 'Cb(0,n1,n2)=',n1,n2,C\_alt(0,n1,n2),nn1,nn2,j}}
\DoxyCodeLine{3048 \textcolor{comment}{!              write(*,*) 'Cb(0,n1,n2)=',Zinv(1,j),Smod(1),Zinv(2,j),Smod(2)}}
\DoxyCodeLine{3049 \textcolor{comment}{!            end if}}
\DoxyCodeLine{3050 \textcolor{comment}{!            write(*,*) 'CalcCpv1o Cerr',n0,n1,n2, Cerr(r), abs(C(n0,n1,n2)),abs(C\_alt(n0,n1,n2))}}
\DoxyCodeLine{3051 }
\DoxyCodeLine{3052 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3053 }
\DoxyCodeLine{3054       \textcolor{keywordflow}{if}(r.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{3055         c00\_err(r) = max(2*abs(m02)*cij\_err(r-\/2), b\_err,    \&}
\DoxyCodeLine{3056               \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*cij\_err(r-\/2),             \&}
\DoxyCodeLine{3057               \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*max(2*c00\_err(r-\/1),b\_err))/(2*r)}
\DoxyCodeLine{3058 }
\DoxyCodeLine{3059 \textcolor{comment}{!        write(*,*) 'C00errtest',r,abs(m02)*Cij\_err(r-\/2), B\_err,    \&}}
\DoxyCodeLine{3060 \textcolor{comment}{!              aZadjff/adetZ*Cij\_err(r-\/2),             \&}}
\DoxyCodeLine{3061 \textcolor{comment}{!              maxZadjf/adetZ*C00\_err(r-\/1),maxZadjf/adetZ*B\_err, \&}}
\DoxyCodeLine{3062 \textcolor{comment}{!              C00\_err(r)}}
\DoxyCodeLine{3063 }
\DoxyCodeLine{3064       \textcolor{keywordflow}{else}}
\DoxyCodeLine{3065         c00\_err(r) = 0d0}
\DoxyCodeLine{3066 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3067       cij\_err(r) = max(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*cij\_err(r-\/1),   \&}
\DoxyCodeLine{3068               \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}*max(2*c00\_err(r),b\_err))/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{3069  }
\DoxyCodeLine{3070       \textcolor{keywordflow}{if}(r.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{3071         c00\_err2(r) = max(2*abs(m02)*cij\_err2(r-\/2), b\_err,    \&}
\DoxyCodeLine{3072               \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*cij\_err2(r-\/2),             \&}
\DoxyCodeLine{3073               \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*max(2*c00\_err(r-\/1),b\_err))/(2*r)}
\DoxyCodeLine{3074 }
\DoxyCodeLine{3075 \textcolor{comment}{!        write(*,*) 'C00errtest',r,abs(m02)*Cij\_err2(r-\/2), B\_err,    \&}}
\DoxyCodeLine{3076 \textcolor{comment}{!              aZadjff/adetZ*Cij\_err2(r-\/2),             \&}}
\DoxyCodeLine{3077 \textcolor{comment}{!              maxZadjf/adetZ*C00\_err2(r-\/1),maxZadjf/adetZ*B\_err, \&}}
\DoxyCodeLine{3078 \textcolor{comment}{!              C00\_err2(r)}}
\DoxyCodeLine{3079 }
\DoxyCodeLine{3080       \textcolor{keywordflow}{else}}
\DoxyCodeLine{3081         c00\_err2(r) = 0d0}
\DoxyCodeLine{3082 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3083       cij\_err2(r) = max((\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})*cij\_err2(r-\/1),max(2*c00\_err2(r),b\_err))/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})}
\DoxyCodeLine{3084 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3085 }
\DoxyCodeLine{3086       \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2=r, n0>0 }}
\DoxyCodeLine{3087     \textcolor{keywordflow}{do} r=rmax+1,2*rmax}
\DoxyCodeLine{3088       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{3089         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3090           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{3091           c(n0,n1,n2) = (b\_0(n0-\/1,n1,n2) + 2*mm02*c(n0-\/1,n1,n2) + 4*cuv(n0,n1,n2) \&}
\DoxyCodeLine{3092                         + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)*c(n0-\/1,n1+1,n2) + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)*c(n0-\/1,n1,n2+1)) / (2*r)}
\DoxyCodeLine{3093 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3094 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3095 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3096 }
\DoxyCodeLine{3097 }
\DoxyCodeLine{3098 \textcolor{preprocessor}{\#ifdef Cpv1otest}}
\DoxyCodeLine{3099 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv1o Cerrsym'},cerr}
\DoxyCodeLine{3100     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv1o Caccsym'},cerr/abs(c(0,0,0))}
\DoxyCodeLine{3101  }
\DoxyCodeLine{3102     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv1o Cijerr'},cij\_err(1:rmax)}
\DoxyCodeLine{3103     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv1o Cijacc'},cij\_err(1:rmax)/abs(c(0,0,0))}
\DoxyCodeLine{3104 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3105 \textcolor{preprocessor}{}}
\DoxyCodeLine{3106     cerr2 = max(cerr2,cij\_err2(0:rmax))}
\DoxyCodeLine{3107     cerr = max(cerr,cij\_err(0:rmax))}
\DoxyCodeLine{3108 }
\DoxyCodeLine{3109 \textcolor{preprocessor}{\#ifdef Cpv1otest}}
\DoxyCodeLine{3110 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv1o Cerr'},cerr}
\DoxyCodeLine{3111     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv1o Cacc'},cerr/abs(c(0,0,0))}
\DoxyCodeLine{3112 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3113 \textcolor{preprocessor}{}}
\DoxyCodeLine{3114 \textcolor{comment}{!   write(*,*) 'CalcCpv1o out',(((C((r-\/n1-\/n2)/2,n1,n2),n2=0,r-\/n1),n1=0,r),r=0,rmax)}}
\DoxyCodeLine{3115 }
\DoxyCodeLine{3116 \textcolor{comment}{!    write(*,*) 'CalcCpv1o Cerr ',Cerr}}
\DoxyCodeLine{3117 \textcolor{comment}{!    write(*,*) 'CalcCpv1o Cerr2',Cerr2}}
\DoxyCodeLine{3118 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductionc_a19fdc0454a218ea4ba1dc122fe85b68c}\label{namespacereductionc_a19fdc0454a218ea4ba1dc122fe85b68c}} 
\index{reductionc@{reductionc}!calccpv2@{calccpv2}}
\index{calccpv2@{calccpv2}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{calccpv2()}{calccpv2()}}
{\footnotesize\ttfamily subroutine reductionc\+::calccpv2 (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{C,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Cuv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr2 }\end{DoxyParamCaption})}



Definition at line 3434 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{3434   }
\DoxyCodeLine{3435     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobalc}{globalc}}}
\DoxyCodeLine{3436   }
\DoxyCodeLine{3437     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,id}
\DoxyCodeLine{3438     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{3439     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: C(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3440     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Cuv(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3441     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Cerr(0:rmax),Cerr2(0:rmax)}
\DoxyCodeLine{3442     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: B\_0(:,:,:), B\_i(:,:,:)}
\DoxyCodeLine{3443     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Buv\_0(:,:,:), Buv\_i(:,:,:)}
\DoxyCodeLine{3444     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: C\_alt(:,:,:)}
\DoxyCodeLine{3445     \textcolor{keywordtype}{double complex} :: C0\_coli, elimminf2\_coli}
\DoxyCodeLine{3446 \textcolor{comment}{!   double complex :: Caux(1:rmax/2+1,0:rmax-\/1,0:rmax-\/1), Smod(2)}}
\DoxyCodeLine{3447     \textcolor{keywordtype}{double complex} :: Caux(1:rmax,0:rmax-\/1,0:rmax-\/1), Smod(2)}
\DoxyCodeLine{3448     \textcolor{keywordtype}{double complex} :: chdet}
\DoxyCodeLine{3449     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err(:),Cij\_err(:)}
\DoxyCodeLine{3450     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{3451     \textcolor{keywordtype}{double precision} :: B\_err,B\_max}
\DoxyCodeLine{3452     \textcolor{keywordtype}{integer} :: rmaxB,r,n0,n1,n2,k}
\DoxyCodeLine{3453     \textcolor{keywordtype}{integer} :: bin,nid(0:3)}
\DoxyCodeLine{3454 }
\DoxyCodeLine{3455 \textcolor{preprocessor}{\#ifdef Cpv2test}}
\DoxyCodeLine{3456 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv2 in '}}
\DoxyCodeLine{3457 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3458 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifdef TRACECin}}
\DoxyCodeLine{3459 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv2 in '}}
\DoxyCodeLine{3460 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3461 \textcolor{preprocessor}{}}
\DoxyCodeLine{3462     \textcolor{comment}{! calculation of scalar coefficient}}
\DoxyCodeLine{3463     c(0,0,0) = c0\_coli(p10,p21,p20,m02,m12,m22)}
\DoxyCodeLine{3464     cuv(0,0,0) = 0d0}
\DoxyCodeLine{3465 }
\DoxyCodeLine{3466     \textcolor{comment}{! accuracy estimate for C0 function}}
\DoxyCodeLine{3467     cerr(0) = acc\_def\_c0*max( abs(c(0,0,0)), 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}) )}
\DoxyCodeLine{3468     cerr2(0) = acc\_def\_c0*max( abs(c(0,0,0)), 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}) )}
\DoxyCodeLine{3469 }
\DoxyCodeLine{3470 \textcolor{comment}{!   write(*,*) 'CalcCpv2: Cerr(0)= ',Cerr(0),Cerr(0)/abs(C(0,0,0)),abs(C(0,0,0))}}
\DoxyCodeLine{3471 }
\DoxyCodeLine{3472     \textcolor{keywordflow}{if} (rmax.eq.0) \textcolor{keywordflow}{return}}
\DoxyCodeLine{3473 }
\DoxyCodeLine{3474 }
\DoxyCodeLine{3475     \textcolor{comment}{! calculation of B-\/coefficients}}
\DoxyCodeLine{3476     rmaxb = rmax-\/1}
\DoxyCodeLine{3477     \textcolor{comment}{! rmaxB = max(rmax-\/1,0)}}
\DoxyCodeLine{3478     \textcolor{keyword}{allocate}(b\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{3479     \textcolor{keyword}{allocate}(buv\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{3480     \textcolor{keyword}{allocate}(b\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{3481     \textcolor{keyword}{allocate}(buv\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{3482 }
\DoxyCodeLine{3483     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{3484     \textcolor{keyword}{allocate}(c00\_err(0:rmax+1))}
\DoxyCodeLine{3485     \textcolor{keyword}{allocate}(cij\_err(0:rmax))}
\DoxyCodeLine{3486     \textcolor{keyword}{allocate}(c00\_err2(0:rmax+1))}
\DoxyCodeLine{3487     \textcolor{keyword}{allocate}(cij\_err2(0:rmax))}
\DoxyCodeLine{3488     }
\DoxyCodeLine{3489     \textcolor{comment}{! determine binaries for B-\/coefficients}}
\DoxyCodeLine{3490     k=0}
\DoxyCodeLine{3491     bin = 1}
\DoxyCodeLine{3492     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.2)}
\DoxyCodeLine{3493       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3494         nid(k) = id+bin}
\DoxyCodeLine{3495         k = k+1}
\DoxyCodeLine{3496 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3497       bin = 2*bin}
\DoxyCodeLine{3498 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3499 }
\DoxyCodeLine{3500     \textcolor{keyword}{call }calcb(b\_0(:,0,:),buv\_0(:,0,:),p21,m12,m22,rmaxb,nid(0))}
\DoxyCodeLine{3501     \textcolor{keyword}{call }calcb(b\_i(:,:,1),buv\_i(:,:,1),p20,m02,m22,rmaxb,nid(1))}
\DoxyCodeLine{3502     \textcolor{keyword}{call }calcb(b\_i(:,:,2),buv\_i(:,:,2),p10,m02,m12,rmaxb,nid(2))}
\DoxyCodeLine{3503 }
\DoxyCodeLine{3504     \textcolor{comment}{! shift of integration momentum in B\_0 and calculate maximal B(0,...)}}
\DoxyCodeLine{3505     b\_max=0d0}
\DoxyCodeLine{3506     \textcolor{keywordflow}{do} n1=1,rmaxb}
\DoxyCodeLine{3507       \textcolor{keywordflow}{do} n2=0,rmaxb-\/n1}
\DoxyCodeLine{3508         n0 = (rmaxb-\/n1-\/n2)}
\DoxyCodeLine{3509         b\_0(0:n0,n1,n2) = -\/b\_0(0:n0,n1-\/1,n2)-\/b\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{3510         buv\_0(0:n0,n1,n2) = -\/buv\_0(0:n0,n1-\/1,n2)-\/buv\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{3511         b\_max = max(b\_max,abs(b\_0(0,n1,n2)))}
\DoxyCodeLine{3512 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3513 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3514     b\_max=max(b\_max,maxval(abs(b\_i(0,0:rmaxb,1:2))))}
\DoxyCodeLine{3515     }
\DoxyCodeLine{3516     \textcolor{comment}{! determine inverse modified Cayley matrix}}
\DoxyCodeLine{3517 \textcolor{comment}{!    mm02 = elimminf2\_coli(m02)}}
\DoxyCodeLine{3518 \textcolor{comment}{!    mm12 = elimminf2\_coli(m12)}}
\DoxyCodeLine{3519 \textcolor{comment}{!    mm22 = elimminf2\_coli(m22)}}
\DoxyCodeLine{3520 \textcolor{comment}{!    q10  = elimminf2\_coli(p10)}}
\DoxyCodeLine{3521 \textcolor{comment}{!    q21  = elimminf2\_coli(p21)}}
\DoxyCodeLine{3522 \textcolor{comment}{!    q20  = elimminf2\_coli(p20)}}
\DoxyCodeLine{3523 }
\DoxyCodeLine{3524 }
\DoxyCodeLine{3525     \textcolor{comment}{! calculate Cuv}}
\DoxyCodeLine{3526     \textcolor{keyword}{call }calccuv(cuv,buv\_0,mm02,\mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(1:2,0),rmax,id)}
\DoxyCodeLine{3527 }
\DoxyCodeLine{3528     \textcolor{comment}{! initialization of error propagation}}
\DoxyCodeLine{3529 }
\DoxyCodeLine{3530 \textcolor{comment}{!    adetX = abs(chdet(3,mx))}}
\DoxyCodeLine{3531 \textcolor{comment}{!    maxZadjf=maxval(abs(mxinv(0,1:2)))*adetX}}
\DoxyCodeLine{3532 \textcolor{comment}{!    maxXadj=maxval(abs(mxinv(1:2,1:2)))*adetX}}
\DoxyCodeLine{3533 \textcolor{comment}{!    adetZ=abs(mxinv(0,0))*adetX}}
\DoxyCodeLine{3534 }
\DoxyCodeLine{3535 \textcolor{comment}{!   write(*,*) 'CalcCpv2 adetX ',adetX,maxZadjf,maxXadj,adetZ}}
\DoxyCodeLine{3536 }
\DoxyCodeLine{3537     cij\_err =0d0}
\DoxyCodeLine{3538     c00\_err =0d0}
\DoxyCodeLine{3539     cij\_err(0) = cerr(0)}
\DoxyCodeLine{3540     b\_err = acc\_def\_b*b\_max}
\DoxyCodeLine{3541 }
\DoxyCodeLine{3542     cij\_err2 =0d0}
\DoxyCodeLine{3543     c00\_err2 =0d0}
\DoxyCodeLine{3544     cij\_err2(0) = cerr2(0)}
\DoxyCodeLine{3545 }
\DoxyCodeLine{3546 \textcolor{comment}{!    write(*,*) 'CalcCpv: B\_err= ',B\_err,acc\_B,B\_max}}
\DoxyCodeLine{3547 }
\DoxyCodeLine{3548     \textcolor{keyword}{allocate}(c\_alt(0:rmax,0:rmax,0:rmax))}
\DoxyCodeLine{3549     }
\DoxyCodeLine{3550     \textcolor{comment}{! alternative PV-\/like reduction}}
\DoxyCodeLine{3551     \textcolor{keywordflow}{do} r=1,rmax}
\DoxyCodeLine{3552 }
\DoxyCodeLine{3553       \textcolor{keywordflow}{do} n0=2,r/2}
\DoxyCodeLine{3554         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3555           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{3556 }
\DoxyCodeLine{3557           \textcolor{keywordflow}{do} k=1,2}
\DoxyCodeLine{3558             smod(k) = -\/b\_0(n0-\/1,n1,n2)}
\DoxyCodeLine{3559 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{3560 }
\DoxyCodeLine{3561           \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3562             smod(1) = smod(1) -\/ 2*n1*c(n0,n1-\/1,n2)}
\DoxyCodeLine{3563           \textcolor{keywordflow}{else}}
\DoxyCodeLine{3564             smod(1) = smod(1) + b\_i(n0-\/1,n2,1)}
\DoxyCodeLine{3565 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3566 }
\DoxyCodeLine{3567           \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3568             smod(2) = smod(2) -\/ 2*n2*c(n0,n1,n2-\/1)}
\DoxyCodeLine{3569           \textcolor{keywordflow}{else}}
\DoxyCodeLine{3570             smod(2) = smod(2) + b\_i(n0-\/1,n1,2)}
\DoxyCodeLine{3571 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3572 }
\DoxyCodeLine{3573           caux(n0,n1,n2) = (c(n0-\/1,n1,n2) -\/ \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(1,0)*smod(1)  \&}
\DoxyCodeLine{3574                              -\/ \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(2,0)*smod(2))/\mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(0,0)}
\DoxyCodeLine{3575 }
\DoxyCodeLine{3576 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3577 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3578 }
\DoxyCodeLine{3579       }
\DoxyCodeLine{3580       \textcolor{keywordflow}{do} n0=1,r/2}
\DoxyCodeLine{3581         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3582           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{3583 }
\DoxyCodeLine{3584           c(n0,n1,n2) = (caux(n0,n1,n2) + 4d0*cuv(n0,n1,n2)  \&}
\DoxyCodeLine{3585                          + b\_0(n0-\/1,n1,n2))/r/2d0    }
\DoxyCodeLine{3586 }
\DoxyCodeLine{3587 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3588 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3589 }
\DoxyCodeLine{3590       }
\DoxyCodeLine{3591 }
\DoxyCodeLine{3592       \textcolor{comment}{! calculate C and determine error from symmetry for n0=0 and n1>0, n2>0 }}
\DoxyCodeLine{3593       cerr(r)=cerr(r-\/1)}
\DoxyCodeLine{3594       cerr2(r)=cerr2(r-\/1)}
\DoxyCodeLine{3595 }
\DoxyCodeLine{3596       \textcolor{keywordflow}{do} n1=0,r-\/1}
\DoxyCodeLine{3597         n2 = r-\/1-\/n1}
\DoxyCodeLine{3598 }
\DoxyCodeLine{3599         \textcolor{keywordflow}{do} k=1,2}
\DoxyCodeLine{3600           smod(k) = -\/b\_0(0,n1,n2)}
\DoxyCodeLine{3601 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3602 }
\DoxyCodeLine{3603         \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3604           smod(1) = smod(1) -\/ 2*n1*c(1,n1-\/1,n2)}
\DoxyCodeLine{3605         \textcolor{keywordflow}{else}}
\DoxyCodeLine{3606           smod(1) = smod(1) + b\_i(0,n2,1)}
\DoxyCodeLine{3607 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{3608 }
\DoxyCodeLine{3609         \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3610           smod(2) = smod(2) -\/ 2*n2*c(1,n1,n2-\/1)}
\DoxyCodeLine{3611         \textcolor{keywordflow}{else}}
\DoxyCodeLine{3612           smod(2) = smod(2) + b\_i(0,n1,2)}
\DoxyCodeLine{3613 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{3614 }
\DoxyCodeLine{3615         caux(1,n1,n2) = (c(0,n1,n2) -\/ \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(1,0)*smod(1)  \&}
\DoxyCodeLine{3616                            -\/ \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(2,0)*smod(2))/\mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(0,0)}
\DoxyCodeLine{3617 }
\DoxyCodeLine{3618         c(0,n1+1,n2) = \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(0,1)*caux(1,n1,n2)  \&}
\DoxyCodeLine{3619                        + \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(1,1)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(2,1)*smod(2)}
\DoxyCodeLine{3620         c\_alt(0,n1,n2+1) = \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(0,2)*caux(1,n1,n2)  \&}
\DoxyCodeLine{3621                        + \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(1,2)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(2,2)*smod(2)}
\DoxyCodeLine{3622 }
\DoxyCodeLine{3623         \textcolor{keywordflow}{if}(n1.eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3624           c(0,0,r) = c\_alt(0,0,r)          }
\DoxyCodeLine{3625         \textcolor{keywordflow}{else}}
\DoxyCodeLine{3626           cerr(r)=max(cerr(r),abs(c(0,n1,n2+1)-\/c\_alt(0,n1,n2+1)))}
\DoxyCodeLine{3627           cerr2(r)=max(cerr2(r),abs(c(0,n1,n2+1)-\/c\_alt(0,n1,n2+1)))}
\DoxyCodeLine{3628 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{3629 }
\DoxyCodeLine{3630 \textcolor{keywordflow}{      end do} }
\DoxyCodeLine{3631 }
\DoxyCodeLine{3632       c00\_err(r+1) = max(b\_err,\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*cij\_err(r-\/1),      \&}
\DoxyCodeLine{3633               \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*max(b\_err,c00\_err(r)))/(2*(r+1))}
\DoxyCodeLine{3634 }
\DoxyCodeLine{3635 \textcolor{comment}{!      write(*,*) 'CalcCpv2 00 r',r, B\_err,adetX/adetZ*Cij\_err(r-\/1),      \&}}
\DoxyCodeLine{3636 \textcolor{comment}{!              maxZadjf/adetZ*B\_err, maxZadjf/adetZ*C00\_err(r)}}
\DoxyCodeLine{3637 }
\DoxyCodeLine{3638       cij\_err(r) = max(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*max(2*(r+1)*c00\_err(r+1),b\_err),   \&}
\DoxyCodeLine{3639               \mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}*max(2*c00\_err(r),b\_err))/\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}}
\DoxyCodeLine{3640 }
\DoxyCodeLine{3641       c00\_err2(r+1) = max(b\_err,\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*cij\_err2(r-\/1),      \&}
\DoxyCodeLine{3642               \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}*max(b\_err,c00\_err2(r)))/(2*(r+1))}
\DoxyCodeLine{3643 }
\DoxyCodeLine{3644 \textcolor{comment}{!      write(*,*) 'CalcCpv2 00 r',r, B\_err,adetX/adetZ*Cij\_err(r-\/1),      \&}}
\DoxyCodeLine{3645 \textcolor{comment}{!              maxZadjf/adetZ*B\_err, maxZadjf/adetZ*C00\_err(r)}}
\DoxyCodeLine{3646 }
\DoxyCodeLine{3647       cij\_err2(r) = max(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*max(2*(r+1)*c00\_err2(r+1),b\_err),   \&}
\DoxyCodeLine{3648               \mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}*max(2*c00\_err2(r),b\_err))/\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}*(sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}})}
\DoxyCodeLine{3649 }
\DoxyCodeLine{3650 \textcolor{comment}{!      write(*,*) 'CalcCpv2 ij r',r, maxZadjf*C00\_err(r+1)/adetX,B\_err*maxZadjf/adetX, \&}}
\DoxyCodeLine{3651 \textcolor{comment}{!               maxXadj*C00\_err(r)/adetX, maxXadj*B\_err/adetX}}
\DoxyCodeLine{3652       }
\DoxyCodeLine{3653 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3654     }
\DoxyCodeLine{3655 }
\DoxyCodeLine{3656     \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2=r, n0>0 }}
\DoxyCodeLine{3657     \textcolor{keywordflow}{do} r=rmax+1,2*rmax}
\DoxyCodeLine{3658 }
\DoxyCodeLine{3659 \textcolor{preprocessor}{\#ifdef Cpv2test}}
\DoxyCodeLine{3660 \textcolor{preprocessor}{}\textcolor{comment}{! pv1 version might get unstable for some cases!}}
\DoxyCodeLine{3661       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{3662         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3663           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{3664           c(n0,n1,n2) = (b\_0(n0-\/1,n1,n2) + 2*mm02*c(n0-\/1,n1,n2) + 4*cuv(n0,n1,n2) \&}
\DoxyCodeLine{3665                         + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)*c(n0-\/1,n1+1,n2) + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)*c(n0-\/1,n1,n2+1)) / (2*r)}
\DoxyCodeLine{3666 }
\DoxyCodeLine{3667           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'C1(n0+1)'},n0,n1,n2}
\DoxyCodeLine{3668           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'C1(n0+1)'},(b\_0(n0-\/1,n1,n2) + 2*mm02*c(n0-\/1,n1,n2) + 4*cuv(n0,n1,n2) \&}
\DoxyCodeLine{3669                         + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)*c(n0-\/1,n1+1,n2) + \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)*c(n0-\/1,n1,n2+1)) / (2*r)}
\DoxyCodeLine{3670 }
\DoxyCodeLine{3671 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3672 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3673 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3674 \textcolor{preprocessor}{}}
\DoxyCodeLine{3675 \textcolor{comment}{! pv2 formulas added 24.01.2016}}
\DoxyCodeLine{3676       \textcolor{keywordflow}{do} n0=max(2,r-\/rmax),r/2}
\DoxyCodeLine{3677         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3678           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{3679 }
\DoxyCodeLine{3680           \textcolor{keywordflow}{do} k=1,2}
\DoxyCodeLine{3681             smod(k) = -\/b\_0(n0-\/1,n1,n2)}
\DoxyCodeLine{3682 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{3683 }
\DoxyCodeLine{3684           \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3685             smod(1) = smod(1) -\/ 2*n1*c(n0,n1-\/1,n2)}
\DoxyCodeLine{3686           \textcolor{keywordflow}{else}}
\DoxyCodeLine{3687             smod(1) = smod(1) + b\_i(n0-\/1,n2,1)}
\DoxyCodeLine{3688 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3689 }
\DoxyCodeLine{3690           \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3691             smod(2) = smod(2) -\/ 2*n2*c(n0,n1,n2-\/1)}
\DoxyCodeLine{3692           \textcolor{keywordflow}{else}}
\DoxyCodeLine{3693             smod(2) = smod(2) + b\_i(n0-\/1,n1,2)}
\DoxyCodeLine{3694 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3695 }
\DoxyCodeLine{3696           caux(n0,n1,n2) = (c(n0-\/1,n1,n2) -\/ \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(1,0)*smod(1)  \&}
\DoxyCodeLine{3697                              -\/ \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(2,0)*smod(2))/\mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}}(0,0)}
\DoxyCodeLine{3698 }
\DoxyCodeLine{3699 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3700 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3701 }
\DoxyCodeLine{3702       }
\DoxyCodeLine{3703       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{3704         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3705           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{3706 }
\DoxyCodeLine{3707           c(n0,n1,n2) = (caux(n0,n1,n2) + 4d0*cuv(n0,n1,n2)  \&}
\DoxyCodeLine{3708                          + b\_0(n0-\/1,n1,n2))/r/2d0    }
\DoxyCodeLine{3709 }
\DoxyCodeLine{3710 \textcolor{preprocessor}{\#ifdef Cpv2test}}
\DoxyCodeLine{3711 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'C2(n0+1)'},n0,n1,n2}
\DoxyCodeLine{3712           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'C2(n0+1)'},(caux(n0,n1,n2) + 4d0*cuv(n0,n1,n2)  \&}
\DoxyCodeLine{3713                          + b\_0(n0-\/1,n1,n2))/r/2d0}
\DoxyCodeLine{3714 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3715 \textcolor{preprocessor}{}}
\DoxyCodeLine{3716 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3717 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3718 }
\DoxyCodeLine{3719 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3720 }
\DoxyCodeLine{3721 \textcolor{preprocessor}{\#ifdef Cpv2test}}
\DoxyCodeLine{3722 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv2 Cerrsym'},cerr}
\DoxyCodeLine{3723     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv2 Caccsym'},cerr/abs(c(0,0,0))}
\DoxyCodeLine{3724 }
\DoxyCodeLine{3725     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv2 Cijerr'},cij\_err}
\DoxyCodeLine{3726     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv2 Cijacc'},cij\_err/abs(c(0,0,0))}
\DoxyCodeLine{3727 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3728 \textcolor{preprocessor}{}    }
\DoxyCodeLine{3729     cerr2 = max(cerr2,cij\_err2(0:rmax))}
\DoxyCodeLine{3730     cerr = max(cerr,cij\_err(0:rmax))}
\DoxyCodeLine{3731 }
\DoxyCodeLine{3732 \textcolor{preprocessor}{\#ifdef Cpv2test}}
\DoxyCodeLine{3733 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv2 Cerr'},cerr}
\DoxyCodeLine{3734     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpv2 Cacc'},cerr/abs(c(0,0,0))}
\DoxyCodeLine{3735 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3736 \textcolor{preprocessor}{}}
\DoxyCodeLine{3737 \textcolor{comment}{!   write(*,*) 'CalcCpv2 out',(((C((r-\/n1-\/n2)/2,n1,n2),n2=0,r-\/n1),n1=0,r),r=0,rmax)}}
\DoxyCodeLine{3738 }
\DoxyCodeLine{3739 \textcolor{comment}{!    write(*,*) 'CalcCpv2 Cerr ',Cerr}}
\DoxyCodeLine{3740 \textcolor{comment}{!    write(*,*) 'CalcCpv2 Cerr2',Cerr2}}
\DoxyCodeLine{3741 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductionc_a4834491397b1d3bcd391418091d68d31}\label{namespacereductionc_a4834491397b1d3bcd391418091d68d31}} 
\index{reductionc@{reductionc}!calccpvshift@{calccpvshift}}
\index{calccpvshift@{calccpvshift}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{calccpvshift()}{calccpvshift()}}
{\footnotesize\ttfamily subroutine reductionc\+::calccpvshift (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Cshift,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Cuvshift,  }\item[{double complex, intent(in)}]{p10shift,  }\item[{double complex, intent(in)}]{p21shift,  }\item[{double complex, intent(in)}]{p20shift,  }\item[{double complex, intent(in)}]{m02shift,  }\item[{double complex, intent(in)}]{m12shift,  }\item[{double complex, intent(in)}]{m22shift,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr2 }\end{DoxyParamCaption})}



Definition at line 3755 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{3755   }
\DoxyCodeLine{3756     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobalc}{globalc}}}
\DoxyCodeLine{3757   }
\DoxyCodeLine{3758     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,id}
\DoxyCodeLine{3759     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10shift,p21shift,p20shift,m02shift,m12shift,m22shift}
\DoxyCodeLine{3760     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Cuvshift(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3761     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Cshift(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{3762     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: Cerr(0:rmax),Cerr2(0:rmax)}
\DoxyCodeLine{3763     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: B\_0(:,:,:), Buv\_0(:,:,:)}
\DoxyCodeLine{3764     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: B\_i(:,:,:), Buv\_i(:,:,:)}
\DoxyCodeLine{3765     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{allocatable} :: Cshift\_alt(:,:,:)}
\DoxyCodeLine{3766     \textcolor{keywordtype}{double complex} :: Smod(2)}
\DoxyCodeLine{3767     \textcolor{keywordtype}{double complex} :: C0\_coli, elimminf2\_coli}
\DoxyCodeLine{3768     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err(:),Cij\_err(:)}
\DoxyCodeLine{3769     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{allocatable} :: C00\_err2(:),Cij\_err2(:)}
\DoxyCodeLine{3770     \textcolor{keywordtype}{double precision} :: B\_err,B\_max}
\DoxyCodeLine{3771     \textcolor{keywordtype}{integer} :: rmaxB,r,n0,n1,n2,nn0,nn1,nn2,i,j}
\DoxyCodeLine{3772     \textcolor{keywordtype}{integer} :: bin,k,nid(0:2)}
\DoxyCodeLine{3773     \textcolor{keywordtype}{logical} :: use\_cache\_system\_save}
\DoxyCodeLine{3774 }
\DoxyCodeLine{3775 \textcolor{preprocessor}{\#ifdef Cpvshifttest}}
\DoxyCodeLine{3776 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpvshift p in '},p10shift,p21shift,p20shift}
\DoxyCodeLine{3777     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpvshift m in '},m02shift,m12shift,m22shift}
\DoxyCodeLine{3778     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpvshift in '},rmax,id}
\DoxyCodeLine{3779 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3780 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifdef TRACECin}}
\DoxyCodeLine{3781 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpvshift in '},rmax,id}
\DoxyCodeLine{3782 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3783 \textcolor{preprocessor}{}}
\DoxyCodeLine{3784     \textcolor{comment}{! calculation of scalar coefficient}}
\DoxyCodeLine{3785     cshift(0,0,0) = c0\_coli(p10shift,p21shift,p20shift,m02shift,m12shift,m22shift)}
\DoxyCodeLine{3786     cuvshift(0,0,0) = 0d0}
\DoxyCodeLine{3787 }
\DoxyCodeLine{3788     \textcolor{comment}{! accuracy estimate for C0 function}}
\DoxyCodeLine{3789     cerr(0) = acc\_def\_c0*max(1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}),abs(cshift(0,0,0)))   }
\DoxyCodeLine{3790     cerr2(0) = acc\_def\_c0*max(1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}),abs(cshift(0,0,0)))   }
\DoxyCodeLine{3791 }
\DoxyCodeLine{3792     \textcolor{keywordflow}{if} (rmax.eq.0) \textcolor{keywordflow}{return}}
\DoxyCodeLine{3793     }
\DoxyCodeLine{3794     \textcolor{comment}{! allocation and calculation of B functions}}
\DoxyCodeLine{3795     rmaxb = rmax-\/1}
\DoxyCodeLine{3796     \textcolor{comment}{! rmaxB = max(rmax-\/1,0)}}
\DoxyCodeLine{3797     \textcolor{keyword}{allocate}(b\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{3798     \textcolor{keyword}{allocate}(buv\_0(0:rmaxb,0:rmaxb,0:rmaxb))}
\DoxyCodeLine{3799     \textcolor{keyword}{allocate}(b\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{3800     \textcolor{keyword}{allocate}(buv\_i(0:rmaxb,0:rmaxb,2))}
\DoxyCodeLine{3801 }
\DoxyCodeLine{3802     \textcolor{comment}{! allocate arrays for error propagation}}
\DoxyCodeLine{3803     \textcolor{keyword}{allocate}(c00\_err(0:rmax))}
\DoxyCodeLine{3804     \textcolor{keyword}{allocate}(cij\_err(0:rmax))}
\DoxyCodeLine{3805     \textcolor{keyword}{allocate}(c00\_err2(0:rmax))}
\DoxyCodeLine{3806     \textcolor{keyword}{allocate}(cij\_err2(0:rmax))}
\DoxyCodeLine{3807     }
\DoxyCodeLine{3808     \textcolor{comment}{! determine binaries for B-\/coefficients}}
\DoxyCodeLine{3809     k=0}
\DoxyCodeLine{3810     bin = 1}
\DoxyCodeLine{3811     \textcolor{keywordflow}{do} \textcolor{keywordflow}{while} (k.le.2)}
\DoxyCodeLine{3812       \textcolor{keywordflow}{if} (mod(id/bin,2).eq.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3813         nid(k) = id+bin}
\DoxyCodeLine{3814         k = k+1}
\DoxyCodeLine{3815 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{3816       bin = 2*bin}
\DoxyCodeLine{3817 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3818 }
\DoxyCodeLine{3819 \textcolor{comment}{!   call CalcB(B\_0(:,0,:),Buv\_0(:,0,:),p21shift,m12shift,m22shift,rmaxB,nid(0))}}
\DoxyCodeLine{3820 \textcolor{comment}{!   call CalcB(B\_i(:,:,1),Buv\_i(:,:,1),p20shift,m02shift,m22shift,rmaxB,nid(1))}}
\DoxyCodeLine{3821 \textcolor{comment}{!   call CalcB(B\_i(:,:,2),Buv\_i(:,:,2),p10shift,m02shift,m12shift,rmaxB,nid(2))}}
\DoxyCodeLine{3822     use\_cache\_system\_save = use\_cache\_system}
\DoxyCodeLine{3823     use\_cache\_system = .false.}
\DoxyCodeLine{3824     \textcolor{keyword}{call }calcb(b\_0(:,0,:),buv\_0(:,0,:),p21shift,m12shift,m22shift,rmaxb,0)}
\DoxyCodeLine{3825     \textcolor{keyword}{call }calcb(b\_i(:,:,1),buv\_i(:,:,1),p20shift,m02shift,m22shift,rmaxb,0)}
\DoxyCodeLine{3826     \textcolor{keyword}{call }calcb(b\_i(:,:,2),buv\_i(:,:,2),p10shift,m02shift,m12shift,rmaxb,0)}
\DoxyCodeLine{3827     use\_cache\_system = use\_cache\_system\_save}
\DoxyCodeLine{3828 \textcolor{comment}{!   call SwitchOnCacheSystem\_cll}}
\DoxyCodeLine{3829 }
\DoxyCodeLine{3830 }
\DoxyCodeLine{3831     \textcolor{comment}{! shift of integration momentum in B\_0 and calculate maximal B(0,...)}}
\DoxyCodeLine{3832     b\_max=0d0}
\DoxyCodeLine{3833     \textcolor{keywordflow}{do} n1=1,rmaxb}
\DoxyCodeLine{3834       \textcolor{keywordflow}{do} n2=0,rmaxb-\/n1}
\DoxyCodeLine{3835         n0 = (rmaxb-\/n1-\/n2)}
\DoxyCodeLine{3836         b\_0(0:n0,n1,n2) = -\/b\_0(0:n0,n1-\/1,n2)-\/b\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{3837         buv\_0(0:n0,n1,n2) = -\/buv\_0(0:n0,n1-\/1,n2)-\/buv\_0(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{3838         b\_max = max(b\_max,abs(b\_0(0,n1,n2)))}
\DoxyCodeLine{3839 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3840 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{3841 }
\DoxyCodeLine{3842 \textcolor{comment}{!    write(*,*) 'B\_max=',B\_max}}
\DoxyCodeLine{3843 }
\DoxyCodeLine{3844     b\_max=max(b\_max,maxval(abs(b\_i(0,0:rmaxb,1:2))))}
\DoxyCodeLine{3845 }
\DoxyCodeLine{3846     \textcolor{comment}{! determine inverse Gram matrix}}
\DoxyCodeLine{3847 \textcolor{comment}{!    Zinvshift = Zadjshift/detZshift}}
\DoxyCodeLine{3848 }
\DoxyCodeLine{3849     \textcolor{comment}{! calculate Cuv}}
\DoxyCodeLine{3850     \textcolor{keyword}{call }calccuv(cuvshift,buv\_0,\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}},\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}},rmax,id)}
\DoxyCodeLine{3851 }
\DoxyCodeLine{3852     \textcolor{comment}{! initialization of error propagation}}
\DoxyCodeLine{3853     cij\_err =0d0}
\DoxyCodeLine{3854     c00\_err =0d0}
\DoxyCodeLine{3855     cij\_err(0) = cerr(0)}
\DoxyCodeLine{3856     b\_err = acc\_def\_b*b\_max}
\DoxyCodeLine{3857 }
\DoxyCodeLine{3858     cij\_err2 =0d0}
\DoxyCodeLine{3859     c00\_err2 =0d0}
\DoxyCodeLine{3860     cij\_err2(0) = cerr2(0)}
\DoxyCodeLine{3861 }
\DoxyCodeLine{3862 }
\DoxyCodeLine{3863 \textcolor{preprocessor}{\#ifdef Cpvshifttest}}
\DoxyCodeLine{3864 \textcolor{preprocessor}{}\textcolor{comment}{!    write(*,*) 'CalcCpvshift: B\_err= ',B\_err,acc\_def\_B,B\_max}}
\DoxyCodeLine{3865     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcDpvshift Cij\_err(0)='},cij\_err(0)}
\DoxyCodeLine{3866 \textcolor{comment}{!    write(*,*) 'CalcCpvshift test :', \& }}
\DoxyCodeLine{3867 \textcolor{comment}{!            (1d0 -\/ (Zadjf(1)+Zadjf(2))/detZshift), \&}}
\DoxyCodeLine{3868 \textcolor{comment}{!            (detZmZadjf + Zadjs(1)*(mm12shift-\/mm02shift) + Zadjs(2)*(mm22shift-\/mm02shift)) /detZshift}}
\DoxyCodeLine{3869 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3870 \textcolor{preprocessor}{}}
\DoxyCodeLine{3871     \textcolor{keyword}{allocate}(cshift\_alt(0:rmax,0:rmax,0:rmax))}
\DoxyCodeLine{3872 }
\DoxyCodeLine{3873     \textcolor{comment}{! PV reduction}}
\DoxyCodeLine{3874     \textcolor{keywordflow}{do} r=1,rmax}
\DoxyCodeLine{3875 }
\DoxyCodeLine{3876     \textcolor{comment}{! reduction formula (5.10) with (5.11) inserted for n0 >= 1}}
\DoxyCodeLine{3877       \textcolor{keywordflow}{do} n0=r/2,1,-\/1}
\DoxyCodeLine{3878         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3879           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{3880           cshift(n0,n1,n2) = + 4*cuvshift(n0,n1,n2) + \mbox{\hyperlink{namespaceglobalc_ac168cff5383186848cf10fbe7eef6c95}{detxshift}}/\mbox{\hyperlink{namespaceglobalc_a5ee81ae3d90111f9756391e0c589bc63}{detzshift}}*cshift(n0-\/1,n1,n2)}
\DoxyCodeLine{3881             cshift(n0,n1,n2) = cshift(n0,n1,n2) \&}
\DoxyCodeLine{3882                 + (\mbox{\hyperlink{namespaceglobalc_a0280899f395c1130250317a0c65a27bf}{detzmzadjfshift}} + \mbox{\hyperlink{namespaceglobalc_a4ab084a78a3a020a9e6aac9f4868711e}{zadjsshift}}(1)*(\mbox{\hyperlink{namespaceglobalc_a8db82f9bf54b6faee883b33e0f2f2984}{mm12shift}}-\/\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}}) + \mbox{\hyperlink{namespaceglobalc_a4ab084a78a3a020a9e6aac9f4868711e}{zadjsshift}}(2)*(\mbox{\hyperlink{namespaceglobalc_a526a71c3feadc61442fa54e19388ca7b}{mm22shift}}-\/\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}}) \&}
\DoxyCodeLine{3883                   ) /\mbox{\hyperlink{namespaceglobalc_a5ee81ae3d90111f9756391e0c589bc63}{detzshift}} * b\_0(n0-\/1,n1,n2)}
\DoxyCodeLine{3884 \textcolor{comment}{!                + (1d0 -\/ (Zadjfshift(1)+Zadjfshift(2))/detZshift)* B\_0(n0-\/1,n1,n2)}}
\DoxyCodeLine{3885 }
\DoxyCodeLine{3886             \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3887               cshift(n0,n1,n2) = cshift(n0,n1,n2) \&}
\DoxyCodeLine{3888                   -\/ 2*n1*\mbox{\hyperlink{namespaceglobalc_a19a48bfc1152ab4e6cede92fc6034df1}{zadjfshift}}(1)/\mbox{\hyperlink{namespaceglobalc_a5ee81ae3d90111f9756391e0c589bc63}{detzshift}}*cshift(n0,n1-\/1,n2)}
\DoxyCodeLine{3889             \textcolor{keywordflow}{else}            }
\DoxyCodeLine{3890               cshift(n0,n1,n2) = cshift(n0,n1,n2) \&}
\DoxyCodeLine{3891                   + \mbox{\hyperlink{namespaceglobalc_a19a48bfc1152ab4e6cede92fc6034df1}{zadjfshift}}(1)/\mbox{\hyperlink{namespaceglobalc_a5ee81ae3d90111f9756391e0c589bc63}{detzshift}}* b\_i(n0-\/1,n2,1)}
\DoxyCodeLine{3892 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3893             \textcolor{keywordflow}{if} (n2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3894               cshift(n0,n1,n2) = cshift(n0,n1,n2) \&}
\DoxyCodeLine{3895                   -\/ 2*n2*\mbox{\hyperlink{namespaceglobalc_a19a48bfc1152ab4e6cede92fc6034df1}{zadjfshift}}(2)/\mbox{\hyperlink{namespaceglobalc_a5ee81ae3d90111f9756391e0c589bc63}{detzshift}}*cshift(n0,n1,n2-\/1)}
\DoxyCodeLine{3896             \textcolor{keywordflow}{else}            }
\DoxyCodeLine{3897               cshift(n0,n1,n2) = cshift(n0,n1,n2) \&}
\DoxyCodeLine{3898                   + \mbox{\hyperlink{namespaceglobalc_a19a48bfc1152ab4e6cede92fc6034df1}{zadjfshift}}(2)/\mbox{\hyperlink{namespaceglobalc_a5ee81ae3d90111f9756391e0c589bc63}{detzshift}} * b\_i(n0-\/1,n1,2)}
\DoxyCodeLine{3899 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{3900 }
\DoxyCodeLine{3901             cshift(n0,n1,n2) = cshift(n0,n1,n2)  / (2*r) }
\DoxyCodeLine{3902 }
\DoxyCodeLine{3903 \textcolor{comment}{!        if(n0.eq.1) then}}
\DoxyCodeLine{3904 \textcolor{comment}{!          write(*,*) 'Cas(1,n1,n2)=',n1,n2, 4*Cuvshift(n0,n1,n2) + detXshift/detZshift*Cshift(n0-\/1,n1,n2)}}
\DoxyCodeLine{3905 \textcolor{comment}{!          write(*,*) 'Cas(1,n1,n2)=', (detZmZadjfshift + Zadjsshift(1)*(mm12shift-\/mm02shift) + Zadjsshift(2)*(mm22shift-\/mm02shift) \&}}
\DoxyCodeLine{3906 \textcolor{comment}{!                  ) /detZshift * B\_0(n0-\/1,n1,n2)}}
\DoxyCodeLine{3907 \textcolor{comment}{!          write(*,*) 'Cas(1,n1,n2)=', detZmZadjfshift,Zadjsshift(1)*(mm12shift-\/mm02shift),Zadjsshift(2)*(mm22shift-\/mm02shift) \&}}
\DoxyCodeLine{3908 \textcolor{comment}{!                  ,detZshift ,B\_0(n0-\/1,n1,n2)}}
\DoxyCodeLine{3909 \textcolor{comment}{!          write(*,*) 'Cas(1,n1,n2)=', (1d0 -\/ (Zadjfshift(1)+Zadjfshift(2))/detZshift)* B\_0(n0-\/1,n1,n2)}}
\DoxyCodeLine{3910 \textcolor{comment}{!          write(*,*) 'Cas(1,n1,n2)=',  + Zadjfshift(1)/detZshift* B\_i(n0-\/1,n2,1)}}
\DoxyCodeLine{3911 \textcolor{comment}{!          write(*,*) 'Cas(1,n1,n2)=',   + Zadjfshift(2)/detZshift * B\_i(n0-\/1,n1,2)}}
\DoxyCodeLine{3912 \textcolor{comment}{!        end if}}
\DoxyCodeLine{3913 }
\DoxyCodeLine{3914 \textcolor{keywordflow}{         end do}}
\DoxyCodeLine{3915 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{3916 }
\DoxyCodeLine{3917     \textcolor{comment}{! reduction formula (5.11) with (5.10) inserted for n0 = 0}}
\DoxyCodeLine{3918 \textcolor{comment}{!     do n0=(r-\/1)/2,0,-\/1}}
\DoxyCodeLine{3919       n0=0 }
\DoxyCodeLine{3920         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{3921           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{3922 }
\DoxyCodeLine{3923           \textcolor{keywordflow}{if} (n1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3924             nn1 = n1-\/1}
\DoxyCodeLine{3925             nn2 = n2}
\DoxyCodeLine{3926             j = 1}
\DoxyCodeLine{3927           \textcolor{keywordflow}{else}}
\DoxyCodeLine{3928             nn1 = n1}
\DoxyCodeLine{3929             nn2 = n2-\/1}
\DoxyCodeLine{3930             j = 2}
\DoxyCodeLine{3931 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3932          }
\DoxyCodeLine{3933 \textcolor{comment}{!          do i=1,2}}
\DoxyCodeLine{3934 \textcolor{comment}{!            Smod(i) = -\/B\_0(n0,nn1,nn2)}}
\DoxyCodeLine{3935 \textcolor{comment}{!          end do}}
\DoxyCodeLine{3936           smod = 0d0}
\DoxyCodeLine{3937           }
\DoxyCodeLine{3938           \textcolor{keywordflow}{if} (nn1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3939             smod(1) = smod(1) -\/ 2d0*nn1*cshift(n0+1,nn1-\/1,nn2)}
\DoxyCodeLine{3940           \textcolor{keywordflow}{else}          }
\DoxyCodeLine{3941             smod(1) = smod(1) + b\_i(n0,nn2,1)}
\DoxyCodeLine{3942 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3943 }
\DoxyCodeLine{3944           \textcolor{keywordflow}{if} (nn2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3945             smod(2) = smod(2) -\/ 2d0*nn2*cshift(n0+1,nn1,nn2-\/1)}
\DoxyCodeLine{3946           \textcolor{keywordflow}{else}}
\DoxyCodeLine{3947             smod(2) = smod(2) + b\_i(n0,nn1,2)}
\DoxyCodeLine{3948 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3949           }
\DoxyCodeLine{3950           cshift(n0,n1,n2) = (\mbox{\hyperlink{namespaceglobalc_a26ca49de188ad4b40adf16b0222797d5}{zadjshift}}(1,j)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a26ca49de188ad4b40adf16b0222797d5}{zadjshift}}(2,j)*smod(2)  \&}
\DoxyCodeLine{3951                            -\/ \mbox{\hyperlink{namespaceglobalc_a4ab084a78a3a020a9e6aac9f4868711e}{zadjsshift}}(j)*b\_0(n0,nn1,nn2) \&}
\DoxyCodeLine{3952                            -\/ \mbox{\hyperlink{namespaceglobalc_a19a48bfc1152ab4e6cede92fc6034df1}{zadjfshift}}(j)*cshift(n0,nn1,nn2))/\mbox{\hyperlink{namespaceglobalc_a5ee81ae3d90111f9756391e0c589bc63}{detzshift}}}
\DoxyCodeLine{3953 }
\DoxyCodeLine{3954 \textcolor{comment}{!          if(n0.eq.0) then}}
\DoxyCodeLine{3955 \textcolor{comment}{!            write(*,*) 'Cas(0,n1,n2)=',n1,n2,Cshift(0,n1,n2),nn1,nn2,j}}
\DoxyCodeLine{3956 \textcolor{comment}{!            write(*,*) 'Cas(0,n1,n2)=',Zadjshift(1,j),Smod(1),Zadjshift(2,j),Smod(2)}}
\DoxyCodeLine{3957 \textcolor{comment}{!            write(*,*) 'Cas(0,n1,n2)=',Zadjsshift(j),B\_0(n0,nn1,nn2),Zadjfshift(j),Cshift(n0,nn1,nn2)}}
\DoxyCodeLine{3958 \textcolor{comment}{!            write(*,*) 'Cas(0,n1,n2)=',Zadjshift(1,j)*Smod(1),Zadjshift(2,j)*Smod(2)}}
\DoxyCodeLine{3959 \textcolor{comment}{!            write(*,*) 'Cas(0,n1,n2)=',-\/Zadjsshift(j)*B\_0(n0,nn1,nn2),-\/Zadjfshift(j)*Cshift(n0,nn1,nn2)}}
\DoxyCodeLine{3960 \textcolor{comment}{!          end if}}
\DoxyCodeLine{3961           }
\DoxyCodeLine{3962 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{3963 \textcolor{comment}{!      end do}}
\DoxyCodeLine{3964 }
\DoxyCodeLine{3965       \textcolor{comment}{! determine error from symmetry for n0=0 and n1>=1, n2>=1 }}
\DoxyCodeLine{3966       cerr(r)=cerr(r-\/1)}
\DoxyCodeLine{3967       cerr2(r)=cerr2(r-\/1)}
\DoxyCodeLine{3968       n0=0}
\DoxyCodeLine{3969         \textcolor{keywordflow}{do} n1=1,r-\/2*n0-\/1}
\DoxyCodeLine{3970           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{3971 }
\DoxyCodeLine{3972           nn1 = n1}
\DoxyCodeLine{3973           nn2 = n2-\/1}
\DoxyCodeLine{3974           j = 2}
\DoxyCodeLine{3975          }
\DoxyCodeLine{3976 \textcolor{comment}{!          do i=1,2}}
\DoxyCodeLine{3977 \textcolor{comment}{!            Smod(i) = -\/B\_0(n0,nn1,nn2)}}
\DoxyCodeLine{3978 \textcolor{comment}{!          end do}}
\DoxyCodeLine{3979           smod = 0}
\DoxyCodeLine{3980           }
\DoxyCodeLine{3981           \textcolor{keywordflow}{if} (nn1.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3982             smod(1) = smod(1) -\/ 2d0*nn1*cshift(n0+1,nn1-\/1,nn2)}
\DoxyCodeLine{3983           \textcolor{keywordflow}{else}          }
\DoxyCodeLine{3984             smod(1) = smod(1) + b\_i(n0,nn2,1)}
\DoxyCodeLine{3985 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3986 }
\DoxyCodeLine{3987           \textcolor{keywordflow}{if} (nn2.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{3988             smod(2) = smod(2) -\/ 2d0*nn2*cshift(n0+1,nn1,nn2-\/1)}
\DoxyCodeLine{3989           \textcolor{keywordflow}{else}}
\DoxyCodeLine{3990             smod(2) = smod(2) + b\_i(n0,nn1,2)}
\DoxyCodeLine{3991 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{3992            }
\DoxyCodeLine{3993           cshift\_alt(n0,n1,n2) = (\mbox{\hyperlink{namespaceglobalc_a26ca49de188ad4b40adf16b0222797d5}{zadjshift}}(1,j)*smod(1) + \mbox{\hyperlink{namespaceglobalc_a26ca49de188ad4b40adf16b0222797d5}{zadjshift}}(2,j)*smod(2)  \&}
\DoxyCodeLine{3994                            -\/ \mbox{\hyperlink{namespaceglobalc_a4ab084a78a3a020a9e6aac9f4868711e}{zadjsshift}}(j)*b\_0(n0,nn1,nn2) \&}
\DoxyCodeLine{3995                            -\/ \mbox{\hyperlink{namespaceglobalc_a19a48bfc1152ab4e6cede92fc6034df1}{zadjfshift}}(j)*cshift(n0,nn1,nn2))/\mbox{\hyperlink{namespaceglobalc_a5ee81ae3d90111f9756391e0c589bc63}{detzshift}}}
\DoxyCodeLine{3996  }
\DoxyCodeLine{3997           cerr(r)=max(cerr(r),abs(cshift(n0,n1,n2)-\/cshift\_alt(n0,n1,n2)))}
\DoxyCodeLine{3998           cerr2(r)=max(cerr2(r),abs(cshift(n0,n1,n2)-\/cshift\_alt(n0,n1,n2)))}
\DoxyCodeLine{3999 }
\DoxyCodeLine{4000 \textcolor{comment}{!          if(n0.eq.0) then}}
\DoxyCodeLine{4001 \textcolor{comment}{!            write(*,*) 'Cbs(0,n1,n2)=',n1,n2,Cshift\_alt(0,n1,n2),nn1,nn2,j}}
\DoxyCodeLine{4002 \textcolor{comment}{!            write(*,*) 'Cbs(0,n1,n2)=',Zadjshift(1,j),Smod(1),Zadjshift(2,j),Smod(2)}}
\DoxyCodeLine{4003 \textcolor{comment}{!            write(*,*) 'Cbs(0,n1,n2)=',Zadjsshift(j),B\_0(n0,nn1,nn2),Zadjfshift(j),Cshift(n0,nn1,nn2)}}
\DoxyCodeLine{4004 \textcolor{comment}{!          end if}}
\DoxyCodeLine{4005 \textcolor{comment}{!            write(*,*) 'CalcCpvshift Cerr',n0,n1,n2, Cerr(r), abs(Cshift(n0,n1,n2)),abs(Cshift\_alt(n0,n1,n2))}}
\DoxyCodeLine{4006 }
\DoxyCodeLine{4007 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4008 }
\DoxyCodeLine{4009       \textcolor{keywordflow}{if}(r.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{4010 \textcolor{comment}{! estimate using insertions of (5.11) in (5.10)}}
\DoxyCodeLine{4011         c00\_err(r) = max(2*abs(m02shift)*cij\_err(r-\/2), b\_err,    \&}
\DoxyCodeLine{4012               \mbox{\hyperlink{namespaceglobalc_ada46a2845917d83ee02ea5754b33fe08}{azadjffshift}}/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}*cij\_err(r-\/2),             \&}
\DoxyCodeLine{4013               \mbox{\hyperlink{namespaceglobalc_a5a95c855c3182d83765f2bad05579761}{maxzadjfshift}}/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}*max(2*c00\_err(r-\/1),b\_err))/(2*r)}
\DoxyCodeLine{4014 }
\DoxyCodeLine{4015       \textcolor{keywordflow}{else}}
\DoxyCodeLine{4016         c00\_err(r) = 0d0}
\DoxyCodeLine{4017 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{4018 \textcolor{comment}{! estimate using insertions of (5.10) in (5.11)}}
\DoxyCodeLine{4019       cij\_err(r) = max(\mbox{\hyperlink{namespaceglobalc_a5a95c855c3182d83765f2bad05579761}{maxzadjfshift}}*cij\_err(r-\/1),   \&}
\DoxyCodeLine{4020               \mbox{\hyperlink{namespaceglobalc_a9400f35ae47e801cf5e42790467bd030}{maxzadjshift}}*max(2*c00\_err(r),b\_err))/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}}
\DoxyCodeLine{4021  }
\DoxyCodeLine{4022       \textcolor{keywordflow}{if}(r.ge.2)\textcolor{keywordflow}{then}}
\DoxyCodeLine{4023         c00\_err2(r) = max(2*abs(m02shift)*cij\_err2(r-\/2), b\_err,    \&}
\DoxyCodeLine{4024               \mbox{\hyperlink{namespaceglobalc_ada46a2845917d83ee02ea5754b33fe08}{azadjffshift}}/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}*cij\_err2(r-\/2),             \&}
\DoxyCodeLine{4025               \mbox{\hyperlink{namespaceglobalc_a5a95c855c3182d83765f2bad05579761}{maxzadjfshift}}/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}*max(2*c00\_err(r-\/1),b\_err))/(2*r)}
\DoxyCodeLine{4026 }
\DoxyCodeLine{4027       \textcolor{keywordflow}{else}}
\DoxyCodeLine{4028         c00\_err2(r) = 0d0}
\DoxyCodeLine{4029 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{4030       cij\_err2(r) = max((\mbox{\hyperlink{namespaceglobalc_a5a95c855c3182d83765f2bad05579761}{maxzadjfshift}}/\mbox{\hyperlink{namespaceglobalc_a9400f35ae47e801cf5e42790467bd030}{maxzadjshift}})*cij\_err2(r-\/1),max(2*c00\_err2(r),b\_err))/sqrt(\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}})}
\DoxyCodeLine{4031 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{4032 }
\DoxyCodeLine{4033       \textcolor{comment}{! reduction formula (5.10) for n0+n1+n2=r, n0>0 }}
\DoxyCodeLine{4034     \textcolor{keywordflow}{do} r=rmax+1,2*rmax}
\DoxyCodeLine{4035       \textcolor{keywordflow}{do} n0=r-\/rmax,r/2}
\DoxyCodeLine{4036         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{4037           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{4038           cshift(n0,n1,n2) = (b\_0(n0-\/1,n1,n2) + 2*\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}}*cshift(n0-\/1,n1,n2) + 4*cuvshift(n0,n1,n2) \&}
\DoxyCodeLine{4039                         + \mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(1)*cshift(n0-\/1,n1+1,n2) + \mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(2)*cshift(n0-\/1,n1,n2+1)) / (2*r)}
\DoxyCodeLine{4040 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{4041 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{4042 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{4043 }
\DoxyCodeLine{4044 }
\DoxyCodeLine{4045 \textcolor{preprocessor}{\#ifdef Cpvshifttest}}
\DoxyCodeLine{4046 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpvshift Cerrsym'},cerr}
\DoxyCodeLine{4047     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpvshift Caccsym'},cerr/abs(cshift(0,0,0))}
\DoxyCodeLine{4048  }
\DoxyCodeLine{4049     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpvshift Cijerr'},cij\_err(1:rmax)}
\DoxyCodeLine{4050     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpvshift Cijacc'},cij\_err(1:rmax)/abs(cshift(0,0,0))}
\DoxyCodeLine{4051 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4052 \textcolor{preprocessor}{}}
\DoxyCodeLine{4053     cerr2 = max(cerr2,cij\_err2(0:rmax))}
\DoxyCodeLine{4054     cerr = max(cerr,cij\_err(0:rmax))}
\DoxyCodeLine{4055 }
\DoxyCodeLine{4056 \textcolor{preprocessor}{\#ifdef Cpvshifttest}}
\DoxyCodeLine{4057 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpvshift Cerr'},cerr}
\DoxyCodeLine{4058     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpvshift Cacc'},cerr/abs(cshift(0,0,0))}
\DoxyCodeLine{4059 \textcolor{comment}{!    write(*,*) 'CalcCpvshift Cerr2',Cerr2}}
\DoxyCodeLine{4060 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4061 \textcolor{preprocessor}{}}
\DoxyCodeLine{4062 }
\DoxyCodeLine{4063 }
\DoxyCodeLine{4064 \textcolor{preprocessor}{\#ifdef Cpvshifttest}}
\DoxyCodeLine{4065 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpvshift C'},cshift(0,0,0)}
\DoxyCodeLine{4066     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpvshift C1'},cshift(0,1,0)}
\DoxyCodeLine{4067     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpvshift C2'},cshift(0,0,1)}
\DoxyCodeLine{4068     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpvshift C11'},cshift(0,2,0)}
\DoxyCodeLine{4069     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpvshift C12'},cshift(0,1,1)}
\DoxyCodeLine{4070     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCpvshift C22'},cshift(0,0,2)}
\DoxyCodeLine{4071 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4072 \textcolor{preprocessor}{}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductionc_a825edc5ee13bd3456e398fb3a3e642c9}\label{namespacereductionc_a825edc5ee13bd3456e398fb3a3e642c9}} 
\index{reductionc@{reductionc}!calccred@{calccred}}
\index{calccred@{calccred}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{calccred()}{calccred()}}
{\footnotesize\ttfamily subroutine reductionc\+::calccred (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{C,  }\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Cuv,  }\item[{double complex, intent(in)}]{p10,  }\item[{double complex, intent(in)}]{p21,  }\item[{double complex, intent(in)}]{p20,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, intent(in)}]{m12,  }\item[{double complex, intent(in)}]{m22,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr1,  }\item[{double precision, dimension(0\+:rmax), intent(out)}]{Cerr2,  }\item[{integer, intent(in), optional}]{rbasic,  }\item[{double precision, dimension(0\+:rmax), intent(in), optional}]{acc\+\_\+req\+\_\+\+Cextra }\end{DoxyParamCaption})}



Definition at line 322 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{322   }
\DoxyCodeLine{323     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceglobalc}{globalc}}}
\DoxyCodeLine{324 }
\DoxyCodeLine{325     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,id}
\DoxyCodeLine{326     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: rbasic}
\DoxyCodeLine{327     \textcolor{comment}{!   rbasic defines rank of tensors that are needed by mastercall}}
\DoxyCodeLine{328     \textcolor{comment}{!          higher ranks up to rmax are needed for internal iterations}}
\DoxyCodeLine{329     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: acc\_req\_Cextra(0:rmax)}
\DoxyCodeLine{330     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: p10,p21,p20,m02,m12,m22}
\DoxyCodeLine{331     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: C(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{332     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Cuv(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{333     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)}  ::Cerr1(0:rmax),Cerr2(0:rmax)}
\DoxyCodeLine{334     \textcolor{keywordtype}{double complex} :: C\_alt(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{335     \textcolor{keywordtype}{double complex} :: Cuv\_alt(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{336     \textcolor{keywordtype}{double precision} ::  Cerr(0:rmax),Cerr\_alt(0:rmax),Cerr1\_alt(0:rmax),Cerr2\_alt(0:rmax)}
\DoxyCodeLine{337     \textcolor{keywordtype}{double precision} :: C0est,Ctyp}
\DoxyCodeLine{338 \textcolor{preprocessor}{\#ifdef USEC0}}
\DoxyCodeLine{339 \textcolor{preprocessor}{}    \textcolor{keywordtype}{double complex} :: C0\_coli}
\DoxyCodeLine{340 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{341 \textcolor{preprocessor}{}    \textcolor{keywordtype}{double complex} :: C0\_coli}
\DoxyCodeLine{342 \textcolor{comment}{!    double complex :: detX,chdet}}
\DoxyCodeLine{343     \textcolor{keywordtype}{double complex} :: chdet}
\DoxyCodeLine{344 }
\DoxyCodeLine{345     \textcolor{keywordtype}{double complex} :: elimminf2\_coli}
\DoxyCodeLine{346     \textcolor{keywordtype}{integer} :: r,rid,n0,n1,n2,g,gy,gp,gr,gpf,i,rdef,iexp}
\DoxyCodeLine{347     \textcolor{keywordtype}{logical} :: use\_pv,use\_pv2,use\_g,use\_gy,use\_gp,use\_gr,use\_gpf,use\_pvs}
\DoxyCodeLine{348 }
\DoxyCodeLine{349     \textcolor{keywordtype}{integer} :: r\_alt,Crmethod(0:rmax),Crmethod\_alt(0:rmax),CrCalc(0:rmax),CCalc}
\DoxyCodeLine{350     \textcolor{keywordtype}{double precision} :: acc\_pv\_alt, acc\_pv2\_alt, acc\_Cr\_alt}
\DoxyCodeLine{351 }
\DoxyCodeLine{352     \textcolor{comment}{!   CalcC stores methods that have been calculated}}
\DoxyCodeLine{353     \textcolor{comment}{!   Crmethod(r) stores best method=used for rank r }}
\DoxyCodeLine{354 }
\DoxyCodeLine{355     \textcolor{keywordtype}{double precision} :: err\_pv(0:rmax),err\_pv2(0:rmax),err\_g(0:rmax),err\_gy(0:rmax),  \&}
\DoxyCodeLine{356                         err\_gp(0:rmax),err\_gr(0:rmax),err\_gpf(0:rmax)}
\DoxyCodeLine{357     \textcolor{keywordtype}{double precision} :: err\_pvs(0:rmax)}
\DoxyCodeLine{358     \textcolor{keywordtype}{double precision} :: h\_pv,w\_pv,v\_pv,z\_pv,h\_pv2,w\_pv2,v\_pv2,z\_pv2,hw\_pv2}
\DoxyCodeLine{359     \textcolor{keywordtype}{double precision} :: h\_pvs,w\_pvs,v\_pvs,z\_pvs}
\DoxyCodeLine{360     \textcolor{keywordtype}{double precision} :: x\_g,u\_g,z\_g,err\_g\_B(0:rmax),err\_g\_exp}
\DoxyCodeLine{361     \textcolor{keywordtype}{double precision} :: x\_gy,y\_gy,v\_gy,v1\_gy,b\_gy,err\_gy\_B(0:rmax),err\_gy\_exp}
\DoxyCodeLine{362     \textcolor{keywordtype}{double precision} :: w\_gp,v\_gp,z\_gp,err\_gp\_B(0:rmax),err\_gp\_exp}
\DoxyCodeLine{363     \textcolor{keywordtype}{double precision} :: x\_gr,y\_gr,y1\_gr,a\_gr,err\_gr\_B(0:rmax),err\_gr\_exp}
\DoxyCodeLine{364     \textcolor{keywordtype}{double precision} :: x\_gpf,y\_gpf,v\_gpf,v1\_gpf,b\_gpf,err\_gpf\_B(0:rmax),err\_gpf\_exp}
\DoxyCodeLine{365     \textcolor{keywordtype}{double precision} :: err\_B,err\_C0,err\_C(0:rmax),err\_inf,err\_req\_Cr(0:rmax),acc\_req\_Cr(0:rmax),acc\_C(0:rmax)}
\DoxyCodeLine{366     \textcolor{keywordtype}{double precision} :: checkest,norm,Cscale}
\DoxyCodeLine{367     \textcolor{keywordtype}{logical} :: lerr\_C0,errorwriteflag}
\DoxyCodeLine{368 }
\DoxyCodeLine{369     \textcolor{keywordtype}{character(len=*)},\textcolor{keywordtype}{parameter} :: fmt1 = \textcolor{stringliteral}{"(A7,'dcmplx(',d25.18,' , ',d25.18,' )')"}}
\DoxyCodeLine{370     \textcolor{keywordtype}{character(len=*)},\textcolor{keywordtype}{parameter} :: fmt10 = \textcolor{stringliteral}{"(A17,'(',d25.18,' , ',d25.18,' )')"}}
\DoxyCodeLine{371 \textcolor{preprocessor}{\#ifdef CritPointsCOLI    }}
\DoxyCodeLine{372 \textcolor{preprocessor}{}    \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: MaxCritPointC=50}
\DoxyCodeLine{373 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{374 \textcolor{preprocessor}{}    \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: MaxCritPointC=0}
\DoxyCodeLine{375 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{376 \textcolor{preprocessor}{}    \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{save} :: CritPointCntC}
\DoxyCodeLine{377 }
\DoxyCodeLine{378     \textcolor{keyword}{data} critpointcntc /0/}
\DoxyCodeLine{379 }
\DoxyCodeLine{380     \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{381     \textcolor{comment}{! choose reduction scheme}}
\DoxyCodeLine{382     \textcolor{comment}{! by estimating expected errors}}
\DoxyCodeLine{383     \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{384 }
\DoxyCodeLine{385 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{386 \textcolor{preprocessor}{}     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred in '},rmax,id,p10,p21,p20}
\DoxyCodeLine{387 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{388 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifdef TRACECin}}
\DoxyCodeLine{389 \textcolor{preprocessor}{}     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred in '},rmax,id}
\DoxyCodeLine{390 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{391 \textcolor{preprocessor}{}}
\DoxyCodeLine{392     \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(rbasic)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{393       rdef = rbasic}
\DoxyCodeLine{394     \textcolor{keywordflow}{else}}
\DoxyCodeLine{395       rdef = rmax}
\DoxyCodeLine{396 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{397 }
\DoxyCodeLine{398 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{399 \textcolor{preprocessor}{}     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred rdef '},rdef}
\DoxyCodeLine{400 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{401 \textcolor{preprocessor}{}}
\DoxyCodeLine{402     \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(acc\_req\_cextra)) \textcolor{keywordflow}{then} }
\DoxyCodeLine{403       acc\_req\_cr = acc\_req\_cextra}
\DoxyCodeLine{404     \textcolor{keywordflow}{else}}
\DoxyCodeLine{405       acc\_req\_cr = acc\_req\_c}
\DoxyCodeLine{406 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{407 }
\DoxyCodeLine{408 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{409 \textcolor{preprocessor}{}     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred acc\_req\_Cr '},acc\_req\_cr}
\DoxyCodeLine{410 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{411 \textcolor{preprocessor}{}}
\DoxyCodeLine{412     \textcolor{comment}{! eliminate infinitesimal masses}}
\DoxyCodeLine{413     mm02 = elimminf2\_coli(m02)}
\DoxyCodeLine{414     mm12 = elimminf2\_coli(m12)}
\DoxyCodeLine{415     \mbox{\hyperlink{namespaceglobalc_a7c2a517c5707c2e77eb16e183db3d259}{mm22}} = elimminf2\_coli(m22)}
\DoxyCodeLine{416     \mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}  = elimminf2\_coli(p10)}
\DoxyCodeLine{417     \mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}  = elimminf2\_coli(p21)}
\DoxyCodeLine{418     \mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}  = elimminf2\_coli(p20)}
\DoxyCodeLine{419 }
\DoxyCodeLine{420     \textcolor{comment}{! set mass scales}}
\DoxyCodeLine{421     \mbox{\hyperlink{namespaceglobalc_a63210e2d88e5fe40f4b927fe139e7232}{q2max}} = max(abs(\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}),abs(\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}),abs(\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}))}
\DoxyCodeLine{422     \mbox{\hyperlink{namespaceglobalc_a45c0f5c169a73fb12286352743b5a557}{m2max}} = max(abs(mm02),abs(mm12),abs(\mbox{\hyperlink{namespaceglobalc_a7c2a517c5707c2e77eb16e183db3d259}{mm22}}))}
\DoxyCodeLine{423     \mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}} = max(\mbox{\hyperlink{namespaceglobalc_a63210e2d88e5fe40f4b927fe139e7232}{q2max}},\mbox{\hyperlink{namespaceglobalc_a45c0f5c169a73fb12286352743b5a557}{m2max}})}
\DoxyCodeLine{424  }
\DoxyCodeLine{425     \textcolor{comment}{! Gram and related stuff}}
\DoxyCodeLine{426     \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1) = 2d0*\mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}}
\DoxyCodeLine{427     \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1) = \mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}+\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}-\/\mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}   \textcolor{comment}{!  = q1q2}}
\DoxyCodeLine{428     \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{429     \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2) = 2d0*\mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}}
\DoxyCodeLine{430 }
\DoxyCodeLine{431     \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}} = maxval(abs(\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}))}
\DoxyCodeLine{432 }
\DoxyCodeLine{433     \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}} = chdet(2,\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}})}
\DoxyCodeLine{434 }
\DoxyCodeLine{435     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}.ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{436       \textcolor{keyword}{call }chinv(2,\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}},\mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}})}
\DoxyCodeLine{437       \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}} = \mbox{\hyperlink{namespaceglobalc_a7227aa5cbfdd19984eec16c78f9a0863}{zinv}} * \mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}}
\DoxyCodeLine{438     \textcolor{keywordflow}{else}}
\DoxyCodeLine{439       \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2)}
\DoxyCodeLine{440       \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,1) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{441       \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2) = -\/\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{442       \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1)}
\DoxyCodeLine{443 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{444 }
\DoxyCodeLine{445     \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(1) = \mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}} + \mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}} -\/ \mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}} }
\DoxyCodeLine{446     \mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(2) = \mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}} + \mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}} -\/ \mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}} }
\DoxyCodeLine{447 }
\DoxyCodeLine{448 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{449 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Z(1) '},\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1), \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,2),\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1),\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2),\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}}
\DoxyCodeLine{450     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Zadj(1) '},\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1), \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2),\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,1),\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2),\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}}}
\DoxyCodeLine{451     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Zadjs(2) '},\mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(2), \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,1)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2)}
\DoxyCodeLine{452     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Zadjs(1) '},\mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(1), \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2)}
\DoxyCodeLine{453     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Zadjs(2) '},\mbox{\hyperlink{namespaceglobalc_a8db89bf29680316e1975a1cfc3bd8e6c}{zadjs}}(2), \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,1)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2)}
\DoxyCodeLine{454 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{455 \textcolor{preprocessor}{}}
\DoxyCodeLine{456     \mbox{\hyperlink{namespaceglobalc_ae3a848253264b0b20c9d773d37bbbb44}{detzmzadjf}} = \mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1)}
\DoxyCodeLine{457 }
\DoxyCodeLine{458 \textcolor{comment}{!   write(*,*) 'Zn    ',Z   }}
\DoxyCodeLine{459 \textcolor{comment}{!   write(*,*) 'Zinvn ',Zinv}}
\DoxyCodeLine{460 \textcolor{comment}{!   write(*,*) 'Zadjn ',Zadj}}
\DoxyCodeLine{461 \textcolor{comment}{!   write(*,*) 'detZn ',detZ}}
\DoxyCodeLine{462 }
\DoxyCodeLine{463     \mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}} = abs(\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}})}
\DoxyCodeLine{464     \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}} = max(abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1)),abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,1)),abs(\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2)))}
\DoxyCodeLine{465 }
\DoxyCodeLine{466     \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1) = \mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}+mm02-\/mm12}
\DoxyCodeLine{467     \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2) = \mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}+mm02-\/\mbox{\hyperlink{namespaceglobalc_a7c2a517c5707c2e77eb16e183db3d259}{mm22}}}
\DoxyCodeLine{468     \mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}} = max(abs(\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)),abs(\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)))}
\DoxyCodeLine{469 }
\DoxyCodeLine{470     \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(0,0) = 2d0*mm02}
\DoxyCodeLine{471 \textcolor{comment}{! 25.08.17}}
\DoxyCodeLine{472 \textcolor{comment}{!    mx(1,0) = q10 -\/ mm12 + mm02}}
\DoxyCodeLine{473 \textcolor{comment}{!    mx(2,0) = q20 -\/ mm22 + mm02}}
\DoxyCodeLine{474 \textcolor{comment}{!    mx(2,1) = q10+q20-\/q21}}
\DoxyCodeLine{475 \textcolor{comment}{!    mx(1,1) = 2d0*q10}}
\DoxyCodeLine{476 \textcolor{comment}{!    mx(2,2) = 2d0*q20}}
\DoxyCodeLine{477     \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(1,0) = \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)}
\DoxyCodeLine{478     \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(2,0) = \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)}
\DoxyCodeLine{479     \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(0,1) = \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(1,0)}
\DoxyCodeLine{480     \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(0,2) = \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(2,0)}
\DoxyCodeLine{481     \mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}(1:2,1:2) = \mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1:2,1:2)}
\DoxyCodeLine{482 }
\DoxyCodeLine{483     \mbox{\hyperlink{namespaceglobalc_a8dc59fea129282fd82fda20025969b67}{detx}} = chdet(3,\mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}})}
\DoxyCodeLine{484 }
\DoxyCodeLine{485     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_a8dc59fea129282fd82fda20025969b67}{detx}}.ne.0d0.and.\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}.ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{486 }
\DoxyCodeLine{487 \textcolor{comment}{!     write(*,*) 'CalcCred mx=',mx}}
\DoxyCodeLine{488 }
\DoxyCodeLine{489       \textcolor{keyword}{call }chinv(3,\mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}},\mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}})}
\DoxyCodeLine{490 }
\DoxyCodeLine{491 \textcolor{comment}{!     write(*,*) 'CalcCred mxinv=',mxinv}}
\DoxyCodeLine{492 }
\DoxyCodeLine{493       \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}} = \mbox{\hyperlink{namespaceglobalc_a4e722dd8aa2d9b39b53987772820bedd}{mxinv}} * \mbox{\hyperlink{namespaceglobalc_a8dc59fea129282fd82fda20025969b67}{detx}}}
\DoxyCodeLine{494 }
\DoxyCodeLine{495 \textcolor{comment}{!     write(*,*) 'CalcCred Xadj=',Xadj}}
\DoxyCodeLine{496 }
\DoxyCodeLine{497       \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1:2) = -\/\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(0,1:2)}
\DoxyCodeLine{498 }
\DoxyCodeLine{499     \textcolor{keywordflow}{else}}
\DoxyCodeLine{500 \textcolor{comment}{! 25.08.17}}
\DoxyCodeLine{501 \textcolor{comment}{!      mx(0,0) = 2d0*mm02}}
\DoxyCodeLine{502 \textcolor{comment}{!      mx(1,0) = q10 -\/ mm12 + mm02}}
\DoxyCodeLine{503 \textcolor{comment}{!      mx(2,0) = q20 -\/ mm22 + mm02}}
\DoxyCodeLine{504 \textcolor{comment}{!      mx(0,1) = mx(1,0)}}
\DoxyCodeLine{505 \textcolor{comment}{!      mx(1,1) = 2d0*q10}}
\DoxyCodeLine{506 \textcolor{comment}{!      mx(2,1) = q10+q20-\/q21}}
\DoxyCodeLine{507 \textcolor{comment}{!      mx(0,2) = mx(2,0)}}
\DoxyCodeLine{508 \textcolor{comment}{!      mx(1,2) = mx(2,1)}}
\DoxyCodeLine{509 \textcolor{comment}{!      mx(2,2) = 2d0*q20}}
\DoxyCodeLine{510 }
\DoxyCodeLine{511       \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1) = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,1)*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,1)*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)}
\DoxyCodeLine{512       \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2) = \mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(1,2)*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)+\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}(2,2)*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)}
\DoxyCodeLine{513 }
\DoxyCodeLine{514       \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,2) = 2d0*mm02*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(1,1) -\/ \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)}
\DoxyCodeLine{515       \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,1) = 2d0*mm02*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,2) -\/ \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)}
\DoxyCodeLine{516       \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,1) = 2d0*mm02*\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}(2,1) -\/ \mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1)*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2)}
\DoxyCodeLine{517       \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,2) = \mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,1)}
\DoxyCodeLine{518 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{519 }
\DoxyCodeLine{520 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{521 \textcolor{preprocessor}{}\textcolor{comment}{!    write(*,*) 'fi ',f(1),f(2)}}
\DoxyCodeLine{522 \textcolor{comment}{!    write(*,*) 'm02 ',m02,2*q10,2*q20,2*Z(2,1)}}
\DoxyCodeLine{523 \textcolor{comment}{!    write(*,*) 'Xadj11 ',4d0*mm02*q20 -\/ f(1)*f(1),Xadj(1,1)}}
\DoxyCodeLine{524 \textcolor{comment}{!    write(*,*) 'Xadj21 ',2d0*mm02*Z(2,1) -\/ f(1)*f(2),Xadj(1,2)}}
\DoxyCodeLine{525 \textcolor{comment}{!    write(*,*) 'Xadj22 ',4d0*mm02*q10 -\/ f(2)*f(2),Xadj(2,2)}}
\DoxyCodeLine{526 \textcolor{comment}{!    write(*,*) 'detXn ',detX}}
\DoxyCodeLine{527 \textcolor{comment}{!    write(*,*) 'Zadjf1',Zadjf(1),Zadj(1,1)*f(1)+Zadj(2,1)*f(2)}}
\DoxyCodeLine{528 \textcolor{comment}{!    write(*,*) 'Zadjf2',Zadjf(2),Zadj(1,2)*f(1)+Zadj(2,2)*f(2)}}
\DoxyCodeLine{529 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{530 \textcolor{preprocessor}{}}
\DoxyCodeLine{531     \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}} = max(abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)),abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)))}
\DoxyCodeLine{532     \mbox{\hyperlink{namespaceglobalc_a2066e024d434b31a1734a85603ee6544}{maxzadjfd}} = max(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}},\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})}
\DoxyCodeLine{533 }
\DoxyCodeLine{534     \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}} = abs(\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1) + \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2))}
\DoxyCodeLine{535     \mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}} = abs(2d0*mm02*\mbox{\hyperlink{namespaceglobalc_ac03a07613f3a6ff42df7cdfae4f299f1}{detz}} -\/ \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(1)*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(1) -\/ \mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}(2)*\mbox{\hyperlink{namespaceglobalc_acd9b06e29f792896407a5295fe52de7a}{f}}(2))}
\DoxyCodeLine{536     \mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}} = max(abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1,1)),abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,1)),abs(\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(2,2)))}
\DoxyCodeLine{537 }
\DoxyCodeLine{538 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{539 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'maxZ    '},\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}},\mbox{\hyperlink{namespaceglobalc_a68e62f5d752be9315f909681fa34b5dc}{z}}}
\DoxyCodeLine{540     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'maxZadj '},\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}},\mbox{\hyperlink{namespaceglobalc_a681cad368a6e344275929878057c26bb}{zadj}}}
\DoxyCodeLine{541     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'maxZadjf '},\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}},\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}}
\DoxyCodeLine{542     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred adetX '},\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}},\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{543     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Zadjf '},\mbox{\hyperlink{namespaceglobalc_a3b71264e818826ef66ed84ded4531204}{zadjf}}}
\DoxyCodeLine{544     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Xadj '},\mbox{\hyperlink{namespaceglobalc_af980a946730642c5bc600e79bebe25df}{xadj}}(1:2,1:2)}
\DoxyCodeLine{545 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{546 \textcolor{preprocessor}{}}
\DoxyCodeLine{547 }
\DoxyCodeLine{548     \textcolor{comment}{! quantities for modified error estimates}}
\DoxyCodeLine{549     \textcolor{comment}{! momentum weights}}
\DoxyCodeLine{550 \textcolor{comment}{!    do i = 1,2}}
\DoxyCodeLine{551 \textcolor{comment}{!      pweight(i) = max(abs(Z(i,1))/maxval(abs(Z(1:2,1))),  \&}}
\DoxyCodeLine{552 \textcolor{comment}{!          abs(Z(i,2))/maxval(abs(Z(1:2,2))))}}
\DoxyCodeLine{553 \textcolor{comment}{!    end do}}
\DoxyCodeLine{554 }
\DoxyCodeLine{555 \textcolor{comment}{!    wmaxZadj = max(pweight(1)*abs(Zadj(1,1)),pweight(1)*abs(Zadj(1,2)),  \&}}
\DoxyCodeLine{556 \textcolor{comment}{!        pweight(2)*abs(Zadj(2,1)),pweight(2)*abs(Zadj(2,2)))}}
\DoxyCodeLine{557 \textcolor{comment}{!}}
\DoxyCodeLine{558 \textcolor{comment}{!    wmaxZadjf = max(pweight(1)*abs(Zadjf(1)),pweight(2)*abs(Zadjf(2)))}}
\DoxyCodeLine{559 \textcolor{comment}{!}}
\DoxyCodeLine{560 \textcolor{comment}{!    wmaxXadj = max(pweight(1)*abs(Xadj(1,1)),   \&}}
\DoxyCodeLine{561 \textcolor{comment}{!        pweight(1)*abs(Xadj(1,2)),pweight(2)*abs(Xadj(2,1)),  \&}}
\DoxyCodeLine{562 \textcolor{comment}{!        pweight(2)*abs(Xadj(2,2)))}}
\DoxyCodeLine{563 \textcolor{comment}{!    wmaxXadj = max(2d0*abs(mm02)*sqrt(adetZ*maxZadj/maxZ),maxZadj2ff*maxZadjf/(maxZadj*fmax))        }}
\DoxyCodeLine{564 }
\DoxyCodeLine{565 \textcolor{comment}{!    write(*,*) 'CalcCred pweight',pweight(1:2)}}
\DoxyCodeLine{566 \textcolor{comment}{!    write(*,*) 'CalcCred wmaxZadj',maxZadj,wmaxZadj}}
\DoxyCodeLine{567 \textcolor{comment}{!    write(*,*) 'CalcCred wmaxZadjf',maxZadjf,wmaxZadjf}}
\DoxyCodeLine{568 \textcolor{comment}{!    write(*,*) 'CalcCred wmaxZadjf',maxXadj,wmaxXadj}}
\DoxyCodeLine{569 }
\DoxyCodeLine{570 }
\DoxyCodeLine{571     \textcolor{comment}{! rough estimate for C0 to set the scale, to be improved}}
\DoxyCodeLine{572     cscale = max(abs(p10),abs(p21),abs(p20),abs(m02), \(\backslash\)}
\DoxyCodeLine{573               abs(m12),abs(m22))}
\DoxyCodeLine{574 \textcolor{preprocessor}{\#ifdef USEC0}}
\DoxyCodeLine{575 \textcolor{preprocessor}{}    c0est = max(abs(c0\_coli(p10,p21,p20,m02,m12,m22)),1d0/cscale)}
\DoxyCodeLine{576     lerr\_c0 = .true.}
\DoxyCodeLine{577 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{578 \textcolor{preprocessor}{}\textcolor{comment}{! changed 09.09.16}}
\DoxyCodeLine{579      \textcolor{keywordflow}{if}(cscale.ne.0d0) \textcolor{keywordflow}{then} }
\DoxyCodeLine{580        c0est = 1d0/cscale}
\DoxyCodeLine{581      \textcolor{keywordflow}{else}}
\DoxyCodeLine{582        c0est = 1d0}
\DoxyCodeLine{583 \textcolor{keywordflow}{     end if}}
\DoxyCodeLine{584 \textcolor{comment}{!    if (adetZ.ne.0d0) then}}
\DoxyCodeLine{585 \textcolor{comment}{!      C0est = 1d0/sqrt(adetZ)}}
\DoxyCodeLine{586 \textcolor{comment}{!    elseif (m2max.ne.0d0) then}}
\DoxyCodeLine{587 \textcolor{comment}{!      C0est = 1d0/m2max}}
\DoxyCodeLine{588 \textcolor{comment}{!    else if (maxZ.ne.0d0) then}}
\DoxyCodeLine{589 \textcolor{comment}{!      C0est = 1d0/maxZ}}
\DoxyCodeLine{590 \textcolor{comment}{!    else}}
\DoxyCodeLine{591 \textcolor{comment}{!      C0est = 1d0 }}
\DoxyCodeLine{592 \textcolor{comment}{!    end if}}
\DoxyCodeLine{593     lerr\_c0 = .false.}
\DoxyCodeLine{594 \textcolor{preprocessor}{\#endif }}
\DoxyCodeLine{595 \textcolor{preprocessor}{}}
\DoxyCodeLine{596 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{597 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred C0    = '},c0\_coli(p10,p21,p20,m02,m12,m22)}
\DoxyCodeLine{598     \textcolor{keywordflow}{if}(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}.ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{599       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred C0est = '},c0est,1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})}
\DoxyCodeLine{600     \textcolor{keywordflow}{else}}
\DoxyCodeLine{601       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred C0est = '},c0est}
\DoxyCodeLine{602 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{603 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{604 \textcolor{preprocessor}{}}
\DoxyCodeLine{605     err\_inf = acc\_inf*c0est}
\DoxyCodeLine{606 }
\DoxyCodeLine{607     err\_req\_cr = acc\_req\_cr * c0est}
\DoxyCodeLine{608 }
\DoxyCodeLine{609     ccalc = 0}
\DoxyCodeLine{610     crcalc = 0}
\DoxyCodeLine{611     crmethod = 0}
\DoxyCodeLine{612     cerr = err\_inf}
\DoxyCodeLine{613     cerr1 = err\_inf}
\DoxyCodeLine{614     cerr2 = err\_inf}
\DoxyCodeLine{615     acc\_c = acc\_inf}
\DoxyCodeLine{616     ccount(0) = ccount(0)+1}
\DoxyCodeLine{617 }
\DoxyCodeLine{618     \textcolor{comment}{! error estimate for C0}}
\DoxyCodeLine{619     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}.ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{620 \textcolor{comment}{!      err\_C0 = acc\_def\_C0*q2max/sqrt(adetZ) * C0est}}
\DoxyCodeLine{621       err\_c0 = acc\_def\_c0*max( c0est, 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}) )}
\DoxyCodeLine{622     \textcolor{keywordflow}{else}}
\DoxyCodeLine{623       err\_c0 = acc\_def\_c0 * c0est}
\DoxyCodeLine{624 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{625     err\_b = acc\_def\_b}
\DoxyCodeLine{626      }
\DoxyCodeLine{627 }
\DoxyCodeLine{628     \textcolor{comment}{! estimate accuracy of PV-\/reduction}}
\DoxyCodeLine{629 \textcolor{comment}{!    if (adetZ.eq.0d0) then}}
\DoxyCodeLine{630 \textcolor{comment}{!    if (adetZ.lt.dprec\_cll*maxZ**2) then}}
\DoxyCodeLine{631     h\_pv = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{632     w\_pv = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{633     v\_pv = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{634     z\_pv = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{635 \textcolor{comment}{!    if (adetZ.lt.dprec\_cll*maxZadjf.or.adetZ.eq.0d0) then}}
\DoxyCodeLine{636 \textcolor{comment}{!   14.07.2017}}
\DoxyCodeLine{637     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}.lt.dprec\_cll*\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}.or.\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}.lt.dprec\_cll*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}**2.or.\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}.eq.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{638       use\_pv = .false.}
\DoxyCodeLine{639       err\_pv = err\_inf}
\DoxyCodeLine{640     \textcolor{keywordflow}{else}}
\DoxyCodeLine{641       use\_pv = .true.}
\DoxyCodeLine{642       err\_pv(0) = err\_c0}
\DoxyCodeLine{643       \textcolor{keywordflow}{if} (rdef.gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{644 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{645 \textcolor{preprocessor}{}        h\_pv = sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}}
\DoxyCodeLine{646         w\_pv = max((\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*h\_pv/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})**2, abs(mm02)*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*h\_pv/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}, \mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*(h\_pv/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})**2)}
\DoxyCodeLine{647         v\_pv = \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}*h\_pv/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{648         z\_pv = \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*h\_pv/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{649 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{650 \textcolor{preprocessor}{}        w\_pv = max((\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})**2, abs(mm02)*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}, \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}**2)}
\DoxyCodeLine{651         v\_pv = \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{652         z\_pv = \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{653 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{654 \textcolor{preprocessor}{}}
\DoxyCodeLine{655 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{656 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred w\_pv'},(\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})**2, abs(mm02)*\mbox{\hyperlink{namespaceglobalc_a63210e2d88e5fe40f4b927fe139e7232}{q2max}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}, \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_ad03a56a1948c0721129397b0167b6f5b}{azadjff}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}**2}
\DoxyCodeLine{657         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred w\_pv'},w\_pv,v\_pv,z\_pv,h\_pv}
\DoxyCodeLine{658 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{659 \textcolor{preprocessor}{}}
\DoxyCodeLine{660         \textcolor{keywordflow}{if} (mod(rdef,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{661           err\_pv(rdef) = max( w\_pv**((rdef-\/1)/2) * v\_pv * err\_c0,  \&}
\DoxyCodeLine{662               max(w\_pv**((rdef-\/1)/2),1d0) * z\_pv * err\_b )}
\DoxyCodeLine{663 }
\DoxyCodeLine{664 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{665 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred err\_pv cont'}, w\_pv**((rdef-\/1)/2)* v\_pv* err\_c0, \&}
\DoxyCodeLine{666                         w\_pv**((rdef-\/1)/2) * z\_pv * err\_b, err\_c0,err\_b}
\DoxyCodeLine{667           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred err\_pv cont'}, w\_pv**((rdef-\/1)/2),v\_pv, err\_c0}
\DoxyCodeLine{668 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{669 \textcolor{preprocessor}{}}
\DoxyCodeLine{670         \textcolor{keywordflow}{else}}
\DoxyCodeLine{671           err\_pv(rdef) = max( w\_pv**(rdef/2) * err\_c0,  \&}
\DoxyCodeLine{672               max(w\_pv**(rdef/2-\/1) * v\_pv, 1d0) * z\_pv * err\_b )}
\DoxyCodeLine{673       }
\DoxyCodeLine{674 \textcolor{preprocessor}{\#ifdef Credtest      }}
\DoxyCodeLine{675 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred w\_pv'}, w\_pv,err\_c0,sqrt(w\_pv)}
\DoxyCodeLine{676           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred err\_pv cont'}, w\_pv**(rdef/2) * err\_c0, \&}
\DoxyCodeLine{677                         w\_pv**(rdef/2-\/1) * v\_pv * z\_pv * err\_b, z\_pv * err\_b, err\_c0,err\_b}
\DoxyCodeLine{678 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{679 \textcolor{preprocessor}{}}
\DoxyCodeLine{680 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{681 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{682 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{683 }
\DoxyCodeLine{684     \textcolor{comment}{! estimate accuracy of alternative PV-\/reduction}}
\DoxyCodeLine{685 \textcolor{comment}{!    if ((adetZ.eq.0).or.(adetX.eq.0)) then}}
\DoxyCodeLine{686 \textcolor{comment}{!    if ((adetZ.lt.dprec\_cll*maxZ**2).or.(adetX.lt.dprec\_cll*maxval(abs(mx))**3)) then}}
\DoxyCodeLine{687     z\_pv2 = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{688     v\_pv2 = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{689     w\_pv2 = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{690     hw\_pv2 = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{691 \textcolor{comment}{!    if ((adetZ.lt.dprec\_cll*maxZadjf).or.(adetX.lt.dprec\_cll*maxval(abs(mx))*adetZ).or.adetZ.eq.0d0) then}}
\DoxyCodeLine{692 \textcolor{comment}{!    14.07.2017   }}
\DoxyCodeLine{693     \textcolor{keywordflow}{if} ((\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}.lt.dprec\_cll*\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}).or.(\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}.lt.dprec\_cll*maxval(abs(\mbox{\hyperlink{namespaceglobalc_a45a5ea837abaed5eed6859b91950bdfb}{mx}}))*\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}).or.  \&}
\DoxyCodeLine{694          (\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}.lt.dprec\_cll*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}**2).or.(\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}.lt.dprec\_cll*\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}**2*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}).or.\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}.eq.0d0.or.\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}}.eq.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{695       use\_pv2 = .false.}
\DoxyCodeLine{696       err\_pv2 = err\_inf}
\DoxyCodeLine{697     \textcolor{keywordflow}{else}}
\DoxyCodeLine{698       use\_pv2 = .true.}
\DoxyCodeLine{699       err\_pv2(0) = err\_c0}
\DoxyCodeLine{700       \textcolor{keywordflow}{if} (rdef.gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{701         w\_pv2 = \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{702 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{703 \textcolor{preprocessor}{}        h\_pv2 = sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})/\mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}}
\DoxyCodeLine{704         hw\_pv2 =  w\_pv2*h\_pv2}
\DoxyCodeLine{705 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{706 \textcolor{preprocessor}{}        hw\_pv2 =  w\_pv2 }
\DoxyCodeLine{707 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{708 \textcolor{preprocessor}{}        v\_pv2 = \mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}}
\DoxyCodeLine{709         z\_pv2 = \mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}/\mbox{\hyperlink{namespaceglobalc_a757b3daddf6bc4ff8d8c4d75f94f357b}{adetx}} }
\DoxyCodeLine{710 }
\DoxyCodeLine{711 \textcolor{comment}{!        write(*,*) 'CalcCred: w\_pv2',w\_pv2,v\_pv2,z\_pv2,err\_C0,err\_B}}
\DoxyCodeLine{712 }
\DoxyCodeLine{713         \textcolor{keywordflow}{if} (mod(rdef,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{714 \textcolor{comment}{! change 21.10.15 for PVEST2}}
\DoxyCodeLine{715 \textcolor{comment}{!          err\_pv2(rdef) = max( err\_C0 * max(w\_pv2**rdef,w\_pv2*v\_pv2**((rdef-\/1)/2) ),  \&}}
\DoxyCodeLine{716 \textcolor{comment}{!              err\_B * z\_pv2 * max(w\_pv2**(rdef+1),w\_pv2, \&}}
\DoxyCodeLine{717 \textcolor{comment}{!                              w\_pv2*v\_pv2**((rdef-\/1)/2),w\_pv2**2, \& }}
\DoxyCodeLine{718 \textcolor{comment}{!                              v\_pv2**((rdef+1)/2),v\_pv2 ) )}}
\DoxyCodeLine{719 }
\DoxyCodeLine{720           err\_pv2(rdef) = max( err\_c0 * max(hw\_pv2**rdef,hw\_pv2*v\_pv2**((rdef-\/1)/2) ),  \&}
\DoxyCodeLine{721               err\_b * z\_pv2 * max(w\_pv2*hw\_pv2**(rdef),hw\_pv2, \&}
\DoxyCodeLine{722                               w\_pv2*hw\_pv2*v\_pv2**((rdef-\/1)/2), \&}
\DoxyCodeLine{723                               hw\_pv2*v\_pv2**((rdef-\/1)/2),w\_pv2*hw\_pv2, \& }
\DoxyCodeLine{724                               v\_pv2**((rdef+1)/2),v\_pv2 ) )}
\DoxyCodeLine{725 }
\DoxyCodeLine{726 \textcolor{comment}{!        write(*,*) 'CalcCred: err\_pv2',rdef,err\_C0 * max(1d0,w\_pv2**rdef,v\_pv2**((rdef-\/1)/2),w\_pv2*v\_pv2**((rdef-\/1)/2) ), \&}}
\DoxyCodeLine{727 \textcolor{comment}{!            err\_B * max(1d0,z\_pv2*w\_pv2**(rdef+1),z\_pv2*w\_pv2, \&}}
\DoxyCodeLine{728 \textcolor{comment}{!              z\_pv2*w\_pv2*v\_pv2**((rdef-\/1)/2),z\_pv2*w\_pv2**2, \& }}
\DoxyCodeLine{729 \textcolor{comment}{!              z\_pv2*v\_pv2**((rdef+1)/2),z\_pv2*v\_pv2 ) }}
\DoxyCodeLine{730 }
\DoxyCodeLine{731         \textcolor{keywordflow}{else}}
\DoxyCodeLine{732 \textcolor{comment}{! change 21.10.15 for PVEST2}}
\DoxyCodeLine{733 \textcolor{comment}{!          err\_pv2(rdef) = max( err\_C0 * max(w\_pv2**rdef,v\_pv2**(rdef/2)),  \&}}
\DoxyCodeLine{734 \textcolor{comment}{!              err\_B * z\_pv2 * max(w\_pv2**(rdef+1),w\_pv2,  \&}}
\DoxyCodeLine{735 \textcolor{comment}{!                                  w\_pv2*v\_pv2**(rdef/2), w\_pv2**2,  \&}}
\DoxyCodeLine{736 \textcolor{comment}{!                                  v\_pv2**(rdef/2),v\_pv2) )}}
\DoxyCodeLine{737           err\_pv2(rdef) = max( err\_c0 * max(hw\_pv2**rdef,v\_pv2**(rdef/2)),  \&}
\DoxyCodeLine{738               err\_b * z\_pv2 * max(w\_pv2*hw\_pv2**(rdef),hw\_pv2,  \&}
\DoxyCodeLine{739                                   w\_pv2*v\_pv2**(rdef/2), w\_pv2*hw\_pv2,  \&}
\DoxyCodeLine{740                                   v\_pv2**(rdef/2),v\_pv2) )}
\DoxyCodeLine{741 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{742 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{743 \textcolor{keywordflow}{    end if} }
\DoxyCodeLine{744 }
\DoxyCodeLine{745     \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{746     err\_pv(rdef)  = err\_pv(rdef)/impest\_c}
\DoxyCodeLine{747     err\_pv2(rdef) = err\_pv2(rdef)/impest\_c     }
\DoxyCodeLine{748 }
\DoxyCodeLine{749 \textcolor{preprocessor}{\#ifdef TEST}}
\DoxyCodeLine{750 \textcolor{preprocessor}{}\textcolor{comment}{!   use\_pv = .false.     ! TEST switch off PV}}
\DoxyCodeLine{751    use\_pv2 = .false.}
\DoxyCodeLine{752 \textcolor{comment}{!    use\_pv = .true.}}
\DoxyCodeLine{753 \textcolor{comment}{!    use\_pv2 = .true.}}
\DoxyCodeLine{754 \textcolor{comment}{!    err\_pv(rdef) = 1d50}}
\DoxyCodeLine{755     err\_pv2(rdef) = 1d50}
\DoxyCodeLine{756 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{757 \textcolor{preprocessor}{}}
\DoxyCodeLine{758 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{759 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: err\_pv'},err\_pv(rdef),err\_pv2(rdef),err\_req\_cr(rdef)}
\DoxyCodeLine{760     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: acc\_pv'},err\_pv(rdef)/c0est,err\_pv2(rdef)/c0est,acc\_req\_c}
\DoxyCodeLine{761 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{762 \textcolor{preprocessor}{}}
\DoxyCodeLine{763 \textcolor{comment}{! changed 16.11.16}}
\DoxyCodeLine{764 \textcolor{comment}{!   Ctyp = real(undefined\_C)}}
\DoxyCodeLine{765     ctyp = c0est}
\DoxyCodeLine{766 }
\DoxyCodeLine{767 \textcolor{preprocessor}{\#ifdef ALWAYSPV}}
\DoxyCodeLine{768 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if}(use\_pv.or.use\_pv2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{769 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{770 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (min(err\_pv(rdef),err\_pv2(rdef)).le.err\_req\_cr(rdef)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{771 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{772 \textcolor{preprocessor}{}      \textcolor{keywordflow}{if} (err\_pv(rdef).le.err\_pv2(rdef)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{773 }
\DoxyCodeLine{774 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{775 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: call Cpv 1 '},rmax,id,err\_pv(rdef)}
\DoxyCodeLine{776 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{777 \textcolor{preprocessor}{}}
\DoxyCodeLine{778         \textcolor{comment}{! use PV-\/reduction if appropriate}}
\DoxyCodeLine{779         \textcolor{keyword}{call }calccpv1(c,cuv,p10,p21,p20,m02,m12,m22,rmax,id,cerr1,cerr2)}
\DoxyCodeLine{780 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{781 \textcolor{preprocessor}{}        cerr = cerr2}
\DoxyCodeLine{782 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{783 \textcolor{preprocessor}{}        cerr = cerr1}
\DoxyCodeLine{784 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{785 \textcolor{preprocessor}{}        ccount(1) = ccount(1)+1}
\DoxyCodeLine{786         crcalc(0:rmax)=crcalc(0:rmax)+1}
\DoxyCodeLine{787         ccalc=ccalc+1}
\DoxyCodeLine{788         crmethod(0:rmax)=1}
\DoxyCodeLine{789 }
\DoxyCodeLine{790 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{791 \textcolor{preprocessor}{}        checkest=cerr(rdef)/err\_pv(rdef)}
\DoxyCodeLine{792         \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_c.or.checkest.lt.1d-\/2*impest\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{793           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: estimate err\_pv imprecise'},err\_pv(rdef),cerr(rdef)}
\DoxyCodeLine{794 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{795 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{796 \textcolor{preprocessor}{}        err\_pv=cerr}
\DoxyCodeLine{797 }
\DoxyCodeLine{798       \textcolor{keywordflow}{else}}
\DoxyCodeLine{799 }
\DoxyCodeLine{800 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{801 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: call Cpv2 1'},rdef,id,err\_pv2(rdef)}
\DoxyCodeLine{802 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{803 \textcolor{preprocessor}{}}
\DoxyCodeLine{804         \textcolor{comment}{! use alternative PV-\/reduction if appropriate}}
\DoxyCodeLine{805         \textcolor{keyword}{call }calccpv2(c,cuv,p10,p21,p20,m02,m12,m22,rmax,id,cerr1,cerr2)}
\DoxyCodeLine{806 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{807 \textcolor{preprocessor}{}        cerr = cerr2}
\DoxyCodeLine{808 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{809 \textcolor{preprocessor}{}        cerr = cerr1}
\DoxyCodeLine{810 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{811 \textcolor{preprocessor}{}        ccount(2) = ccount(2)+1}
\DoxyCodeLine{812         crcalc(0:rmax)=crcalc(0:rmax)+2}
\DoxyCodeLine{813         ccalc=ccalc+2}
\DoxyCodeLine{814         crmethod(0:rmax)=2}
\DoxyCodeLine{815 }
\DoxyCodeLine{816 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{817 \textcolor{preprocessor}{}        checkest=cerr(rdef)/err\_pv2(rdef)}
\DoxyCodeLine{818         \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_c.or.checkest.lt.1d-\/2*impest\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{819           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: estimate err\_pv2 imprecise'},err\_pv2(rdef),cerr(rdef)}
\DoxyCodeLine{820 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{821 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{822 \textcolor{preprocessor}{}}
\DoxyCodeLine{823         err\_pv2=cerr}
\DoxyCodeLine{824 }
\DoxyCodeLine{825 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{826 }
\DoxyCodeLine{827 \textcolor{preprocessor}{\#ifndef USEC0}}
\DoxyCodeLine{828 \textcolor{preprocessor}{}      \textcolor{comment}{! refine error estimate for C0}}
\DoxyCodeLine{829 \textcolor{comment}{!      C0est = abs(C(0,0,0))}}
\DoxyCodeLine{830       err\_c0 = acc\_def\_c0*max( abs(c(0,0,0)), 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}) )}
\DoxyCodeLine{831 \textcolor{comment}{!      err\_req\_Cr = acc\_req\_Cr * abs(C(0,0,0))}}
\DoxyCodeLine{832       lerr\_c0 = .true.}
\DoxyCodeLine{833 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{834 \textcolor{preprocessor}{}}
\DoxyCodeLine{835       \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{836         ctyp =  max(abs(c(0,0,0)),abs(c(0,1,0)),abs(c(0,0,1)))}
\DoxyCodeLine{837       \textcolor{keywordflow}{else}}
\DoxyCodeLine{838         ctyp =  abs(c(0,0,0))}
\DoxyCodeLine{839 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{840       \textcolor{keywordflow}{if}(ctyp.eq.0d0) ctyp = c0est}
\DoxyCodeLine{841       err\_req\_cr = acc\_req\_cr * ctyp}
\DoxyCodeLine{842 }
\DoxyCodeLine{843 }
\DoxyCodeLine{844 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{845 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred C0est after PV='},abs(c(0,0,0)),ctyp}
\DoxyCodeLine{846       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cerr after PV ='},cerr}
\DoxyCodeLine{847       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cacc after PV ='},cerr/ctyp}
\DoxyCodeLine{848       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred err\_req ='},err\_req\_cr}
\DoxyCodeLine{849       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cerr1-\/req='},cerr1-\/err\_req\_cr}
\DoxyCodeLine{850       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred max(Cerr-\/req)'},maxval(cerr-\/err\_req\_cr)}
\DoxyCodeLine{851       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred max(Cerr1-\/req)'},maxval(cerr1-\/err\_req\_cr)}
\DoxyCodeLine{852 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{853 \textcolor{preprocessor}{}}
\DoxyCodeLine{854 \textcolor{comment}{! check with Cerr = Cerr2: exp not tried => larger errors}}
\DoxyCodeLine{855       \textcolor{keywordflow}{if} (maxval(cerr1-\/err\_req\_cr).lt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{856         ccount(ccalc+ccountoffset0) = ccount(ccalc+ccountoffset0)+1}
\DoxyCodeLine{857         \textcolor{keywordflow}{return}}
\DoxyCodeLine{858 \textcolor{keywordflow}{      end if}      }
\DoxyCodeLine{859     \textcolor{keywordflow}{else}   \textcolor{comment}{!  added 14.07.2017}}
\DoxyCodeLine{860       c = 0d0}
\DoxyCodeLine{861       cuv = 0d0}
\DoxyCodeLine{862       cerr1 = err\_inf}
\DoxyCodeLine{863       cerr2 = err\_inf}
\DoxyCodeLine{864 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{865 }
\DoxyCodeLine{866 \textcolor{preprocessor}{\#ifdef TEST}}
\DoxyCodeLine{867 \textcolor{preprocessor}{}\textcolor{comment}{!    return          ! use only PV}}
\DoxyCodeLine{868 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{869 \textcolor{preprocessor}{}}
\DoxyCodeLine{870         }
\DoxyCodeLine{871     \textcolor{comment}{! choose most promising expansion scheme}}
\DoxyCodeLine{872     \textcolor{comment}{! Gram expansion}}
\DoxyCodeLine{873 \textcolor{comment}{!    if (maxZadjf.ne.0d0) then}}
\DoxyCodeLine{874     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}.gt.\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}**2*dprec\_cll) \textcolor{keywordflow}{then}   \textcolor{comment}{!  10.07.2017}}
\DoxyCodeLine{875       x\_g = \mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}/\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}}
\DoxyCodeLine{876 \textcolor{comment}{!      u\_g = max(1d0,m2scale*m2scale/maxZadjf/6d0,abs(mm02)*q2max/maxZadjf/6d0)}}
\DoxyCodeLine{877 \textcolor{comment}{!      u\_g = max(1d0,fmax*fmax/maxZadjf/6d0,abs(mm02)*maxZ/maxZadjf/6d0)}}
\DoxyCodeLine{878 \textcolor{comment}{! 03.03.15  large P counts!}}
\DoxyCodeLine{879 \textcolor{comment}{!      u\_g = max(1d0,fmax*fmax/maxZadjf/2d0,abs(mm02)*maxZ/maxZadjf/2d0)}}
\DoxyCodeLine{880 \textcolor{comment}{! 24.04.15  term appear only combined}}
\DoxyCodeLine{881       u\_g = max(1d0,\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}/\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/2d0)}
\DoxyCodeLine{882       \mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}} = x\_g*u\_g}
\DoxyCodeLine{883       err\_g = err\_inf}
\DoxyCodeLine{884       g = -\/1}
\DoxyCodeLine{885       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}}.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{886         use\_g = .false.}
\DoxyCodeLine{887         err\_g\_exp = err\_inf}
\DoxyCodeLine{888         z\_g = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{889       \textcolor{keywordflow}{else}}
\DoxyCodeLine{890         use\_g = .true.}
\DoxyCodeLine{891 \textcolor{comment}{!       z\_g = max(1d0,m2scale*q2max/maxZadjf)}}
\DoxyCodeLine{892         z\_g = \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}}
\DoxyCodeLine{893         err\_g\_b(rdef) = err\_b * u\_g**rdef * z\_g }
\DoxyCodeLine{894         err\_g\_exp = u\_g**(rdef-\/1) * ctyp}
\DoxyCodeLine{895 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{896     \textcolor{keywordflow}{else}}
\DoxyCodeLine{897       use\_g = .false.}
\DoxyCodeLine{898       err\_g = err\_inf}
\DoxyCodeLine{899       g = -\/1}
\DoxyCodeLine{900       err\_g\_exp = err\_inf}
\DoxyCodeLine{901       u\_g = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{902       z\_g = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{903 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{904 }
\DoxyCodeLine{905 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{906 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if}(use\_g) \textcolor{keywordflow}{then}}
\DoxyCodeLine{907       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after Gram pars'},use\_g,\mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}},x\_g,u\_g,z\_g,err\_g\_b(rdef),err\_g\_exp}
\DoxyCodeLine{908     \textcolor{keywordflow}{else}}
\DoxyCodeLine{909       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after Gram pars'},use\_g,err\_g\_exp}
\DoxyCodeLine{910 \textcolor{keywordflow}{    end if} }
\DoxyCodeLine{911 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{912 \textcolor{preprocessor}{}}
\DoxyCodeLine{913     \textcolor{comment}{! Gram-\/Cayley expansion}}
\DoxyCodeLine{914 \textcolor{comment}{!    if (maxXadj.ne.0d0.and.maxZ.ne.0d0) then}}
\DoxyCodeLine{915     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}.gt.\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}**2*dprec\_cll.and.\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}.gt.\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}*dprec\_cll) \textcolor{keywordflow}{then}   \textcolor{comment}{!  10.07.2017}}
\DoxyCodeLine{916       x\_gy = \mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}/\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}}
\DoxyCodeLine{917       y\_gy = \mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}/\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}}
\DoxyCodeLine{918 \textcolor{comment}{!     v\_gy = m2scale/q2max}}
\DoxyCodeLine{919       v\_gy = \mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}/\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}}
\DoxyCodeLine{920       v1\_gy = max(1d0,v\_gy)}
\DoxyCodeLine{921       \mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}} = max(x\_gy,y\_gy)*v1\_gy}
\DoxyCodeLine{922       err\_gy = err\_inf}
\DoxyCodeLine{923       gy = -\/1}
\DoxyCodeLine{924       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}}.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{925         use\_gy = .false.}
\DoxyCodeLine{926         err\_gy\_exp = err\_inf}
\DoxyCodeLine{927         b\_gy = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{928       \textcolor{keywordflow}{else}}
\DoxyCodeLine{929         use\_gy = .true.}
\DoxyCodeLine{930 \textcolor{comment}{!       b\_gy = max(1d0,m2scale*q2max/maxXadj)}}
\DoxyCodeLine{931         b\_gy = \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/\mbox{\hyperlink{namespaceglobalc_a178a8167e9b21a261b0dcbf5eeccb0d6}{maxxadj}}}
\DoxyCodeLine{932         err\_gy\_b(rdef) = err\_b * b\_gy*v1\_gy}
\DoxyCodeLine{933         err\_gy\_exp = 1d0 * ctyp}
\DoxyCodeLine{934 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{935     \textcolor{keywordflow}{else}}
\DoxyCodeLine{936       use\_gy = .false.}
\DoxyCodeLine{937       err\_gy = err\_inf}
\DoxyCodeLine{938       gy = -\/1}
\DoxyCodeLine{939       err\_gy\_exp = err\_inf}
\DoxyCodeLine{940       v1\_gy = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{941       b\_gy = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{942 \textcolor{keywordflow}{    end if} }
\DoxyCodeLine{943 }
\DoxyCodeLine{944 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{945 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if}(use\_gy) \textcolor{keywordflow}{then}}
\DoxyCodeLine{946       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after GramCay pars'},use\_gy,\mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}},x\_gy,y\_gy,v\_gy,b\_gy,err\_gy\_b(rdef),err\_gy\_exp}
\DoxyCodeLine{947     \textcolor{keywordflow}{else}}
\DoxyCodeLine{948       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after GramCay pars'},use\_gy,err\_gy\_exp}
\DoxyCodeLine{949 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{950 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{951 \textcolor{preprocessor}{}}
\DoxyCodeLine{952     \textcolor{comment}{! expansion in small momenta}}
\DoxyCodeLine{953 \textcolor{comment}{!    if (fmax.ne.0d0) then}}
\DoxyCodeLine{954     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}.gt.\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}*dprec\_cll) \textcolor{keywordflow}{then}   \textcolor{comment}{!  10.07.2017}}
\DoxyCodeLine{955 \textcolor{comment}{!     w\_gp = q2max/fmax}}
\DoxyCodeLine{956       w\_gp = \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}}
\DoxyCodeLine{957       v\_gp = max(1d0,abs(mm02)/\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}})}
\DoxyCodeLine{958       \mbox{\hyperlink{namespaceglobalc_ac6e3d986b3c7aa2041225441a07dddb6}{fac\_gp}} = w\_gp*v\_gp}
\DoxyCodeLine{959       err\_gp = err\_inf}
\DoxyCodeLine{960       gp = -\/1}
\DoxyCodeLine{961       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_ac6e3d986b3c7aa2041225441a07dddb6}{fac\_gp}}.ge.1d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{962         use\_gp = .false.}
\DoxyCodeLine{963         err\_gp\_exp = err\_inf}
\DoxyCodeLine{964         z\_gp = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{965       \textcolor{keywordflow}{else}}
\DoxyCodeLine{966         use\_gp = .true.}
\DoxyCodeLine{967 \textcolor{comment}{!       z\_gp = max(1d0,m2scale/fmax)}}
\DoxyCodeLine{968         z\_gp = 1d0/\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}}
\DoxyCodeLine{969         err\_gp\_b(rdef) = err\_b * z\_gp*v\_gp**rdef}
\DoxyCodeLine{970         err\_gp\_exp = v\_gp**(rdef-\/1) * ctyp}
\DoxyCodeLine{971 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{972     \textcolor{keywordflow}{else}}
\DoxyCodeLine{973       use\_gp = .false.}
\DoxyCodeLine{974       err\_gp = err\_inf}
\DoxyCodeLine{975       gp = -\/1}
\DoxyCodeLine{976       err\_gp\_exp = err\_inf}
\DoxyCodeLine{977       z\_gp = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{978       v\_gp = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{979 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{980 }
\DoxyCodeLine{981 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{982 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if}(use\_gp) \textcolor{keywordflow}{then}}
\DoxyCodeLine{983       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after Mom pars'},use\_gp,\mbox{\hyperlink{namespaceglobalc_ac6e3d986b3c7aa2041225441a07dddb6}{fac\_gp}},w\_gp,v\_gp,z\_gp,err\_gp\_b(rdef),err\_gp\_exp}
\DoxyCodeLine{984     \textcolor{keywordflow}{else}}
\DoxyCodeLine{985       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after Mom pars'},use\_gp,err\_gp\_exp}
\DoxyCodeLine{986 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{987 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{988 \textcolor{preprocessor}{}}
\DoxyCodeLine{989     \textcolor{comment}{! reversed Gram expansion}}
\DoxyCodeLine{990 \textcolor{comment}{!    if (maxZadjf.ne.0d0.and.fmax.ne.0d0) then}}
\DoxyCodeLine{991     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}.gt.\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}**2*dprec\_cll.and.\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}.gt.\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}*dprec\_cll) \textcolor{keywordflow}{then}   \textcolor{comment}{!  10.07.2017}}
\DoxyCodeLine{992       x\_gr = \mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}/\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}}
\DoxyCodeLine{993       y\_gr = \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/\mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}              \textcolor{comment}{! c*y    c=2}}
\DoxyCodeLine{994       y1\_gr = max(1d0,y\_gr)}
\DoxyCodeLine{995       a\_gr = \mbox{\hyperlink{namespaceglobalc_a696b45ffeb0007690ccdcc718d7dca4f}{maxzadj}}/\mbox{\hyperlink{namespaceglobalc_ac677162c818f8192aef5fc592d114690}{maxzadjf}}}
\DoxyCodeLine{996       \mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}} = max(x\_gr,y\_gr)}
\DoxyCodeLine{997       err\_gr = err\_inf}
\DoxyCodeLine{998       gr = -\/1}
\DoxyCodeLine{999       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}}.ge.1.or.2*rmax.gt.rmax\_b) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1000         use\_gr = .false.}
\DoxyCodeLine{1001         err\_gr\_exp = err\_inf}
\DoxyCodeLine{1002       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1003         use\_gr = .true.}
\DoxyCodeLine{1004         err\_gr\_b(rdef) = err\_b * a\_gr}
\DoxyCodeLine{1005         err\_gr\_exp = y1\_gr * ctyp}
\DoxyCodeLine{1006 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1007     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1008       use\_gr = .false.}
\DoxyCodeLine{1009       err\_gr = err\_inf}
\DoxyCodeLine{1010       gr = -\/1}
\DoxyCodeLine{1011       err\_gr\_exp = err\_inf}
\DoxyCodeLine{1012       y1\_gr = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{1013       a\_gr = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{1014 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{1015 }
\DoxyCodeLine{1016 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1017 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if}(use\_gr) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1018     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after revGram pars'},use\_gr,\mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}},x\_gr,y\_gr,y1\_gr,a\_gr,err\_gr\_b(rdef),err\_gr\_exp}
\DoxyCodeLine{1019     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1020     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after revGram pars'},use\_gr,err\_gr\_exp}
\DoxyCodeLine{1021 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{1022 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1023 \textcolor{preprocessor}{}}
\DoxyCodeLine{1024     \textcolor{comment}{!  expansion in small momenta and f's}}
\DoxyCodeLine{1025 \textcolor{comment}{!  estimates to be confirmed 16.08.17, r dependence may be different}}
\DoxyCodeLine{1026 \textcolor{comment}{!  since C\_mni... is needed in contrast to Cgy expansion}}
\DoxyCodeLine{1027     \textcolor{keywordflow}{if} (abs(m02).gt.\mbox{\hyperlink{namespaceglobalc_a51a820fad118ed6ce72a270632df6317}{m2scale}}*dprec\_cll) \textcolor{keywordflow}{then} }
\DoxyCodeLine{1028       x\_gpf = \mbox{\hyperlink{namespaceglobalc_a4ce079406f083ee01c2025f3fa4f6746}{fmax}}/abs(m02)}
\DoxyCodeLine{1029       y\_gpf =  \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/abs(m02)}
\DoxyCodeLine{1030       v\_gpf = 0d0}
\DoxyCodeLine{1031       v1\_gpf = max(1d0,v\_gpf)}
\DoxyCodeLine{1032       \mbox{\hyperlink{namespaceglobalc_a92c2feddeb644af9e797691976e9143b}{fac\_gpf}} = max(x\_gpf,y\_gpf)*v1\_gpf}
\DoxyCodeLine{1033       err\_gpf = err\_inf}
\DoxyCodeLine{1034       gpf = -\/1}
\DoxyCodeLine{1035       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_a92c2feddeb644af9e797691976e9143b}{fac\_gpf}}.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1036         use\_gpf = .false.}
\DoxyCodeLine{1037         err\_gpf\_exp = err\_inf}
\DoxyCodeLine{1038         b\_gpf = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{1039       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1040         use\_gpf = .true.}
\DoxyCodeLine{1041         b\_gpf = 1d0/abs(m02)}
\DoxyCodeLine{1042         err\_gpf\_b(rdef) = err\_b * b\_gpf*v1\_gpf}
\DoxyCodeLine{1043         err\_gpf\_exp = 1d0 * ctyp}
\DoxyCodeLine{1044 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1045     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1046       use\_gpf = .false.}
\DoxyCodeLine{1047       err\_gpf = err\_inf}
\DoxyCodeLine{1048       gpf = -\/1}
\DoxyCodeLine{1049       err\_gpf\_exp = err\_inf}
\DoxyCodeLine{1050       v1\_gpf = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{1051       b\_gpf = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{1052 \textcolor{keywordflow}{    end if} }
\DoxyCodeLine{1053 }
\DoxyCodeLine{1054 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1055 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if}(use\_gpf) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1056       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after pf pars'},use\_gpf,\mbox{\hyperlink{namespaceglobalc_a92c2feddeb644af9e797691976e9143b}{fac\_gpf}},x\_gpf,y\_gpf,v\_gpf,b\_gpf,err\_gpf\_b(rdef),err\_gpf\_exp}
\DoxyCodeLine{1057     \textcolor{keywordflow}{else}}
\DoxyCodeLine{1058       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after pf pars'},use\_gpf,err\_gpf\_exp}
\DoxyCodeLine{1059 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{1060 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1061 \textcolor{preprocessor}{}}
\DoxyCodeLine{1062 }
\DoxyCodeLine{1063 \textcolor{comment}{! no method works}}
\DoxyCodeLine{1064     \textcolor{keywordflow}{if}(use\_pv.or.use\_pv2.or.use\_g.or.use\_gy.or.use\_gp.or.use\_gr.or.use\_gpf.eqv..false.) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1065       \textcolor{keyword}{call }seterrflag\_coli(-\/6)}
\DoxyCodeLine{1066       \textcolor{keyword}{call }errout\_coli(\textcolor{stringliteral}{'CalcCred'},\textcolor{stringliteral}{' no reduction method works'}, \&}
\DoxyCodeLine{1067            errorwriteflag)}
\DoxyCodeLine{1068 \textcolor{comment}{!      write(nerrout\_coli,'((a))')  '  no reduction method works'}}
\DoxyCodeLine{1069       \textcolor{keywordflow}{if} (errorwriteflag) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1070         \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcCred: p10 = '},p10}
\DoxyCodeLine{1071         \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcCred: p21 = '},p21}
\DoxyCodeLine{1072         \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcCred: p20 = '},p20}
\DoxyCodeLine{1073         \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcCred: m02 = '},m02}
\DoxyCodeLine{1074         \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcCred: m12 = '},m12}
\DoxyCodeLine{1075         \textcolor{keyword}{write}(nerrout\_coli,fmt10) \textcolor{stringliteral}{' CalcCred: m22 = '},m22   }
\DoxyCodeLine{1076 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1077       c = 0d0}
\DoxyCodeLine{1078       cuv = 0d0}
\DoxyCodeLine{1079       cerr = err\_inf}
\DoxyCodeLine{1080       cerr2 = err\_inf}
\DoxyCodeLine{1081 }
\DoxyCodeLine{1082 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1083 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: exit'}}
\DoxyCodeLine{1084 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1085 \textcolor{preprocessor}{}}
\DoxyCodeLine{1086       \textcolor{keywordflow}{return}}
\DoxyCodeLine{1087 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{1088 }
\DoxyCodeLine{1089 \textcolor{preprocessor}{\#ifdef TEST}}
\DoxyCodeLine{1090 \textcolor{preprocessor}{}\textcolor{comment}{! switched off for testing}}
\DoxyCodeLine{1091    use\_g  = .false.}
\DoxyCodeLine{1092    use\_gy = .false.}
\DoxyCodeLine{1093    use\_gp = .false.}
\DoxyCodeLine{1094    use\_gr = .false.}
\DoxyCodeLine{1095    use\_gpf = .false.}
\DoxyCodeLine{1096 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1097 \textcolor{preprocessor}{}}
\DoxyCodeLine{1098     iexp = 0}
\DoxyCodeLine{1099     \textcolor{keywordflow}{do} i=0,rmax\_c-\/rmax}
\DoxyCodeLine{1100  }
\DoxyCodeLine{1101       \textcolor{keywordflow}{if} (use\_g) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1102         \textcolor{keywordflow}{if} (err\_g\_exp.gt.err\_g\_b(rdef)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1103           g = i}
\DoxyCodeLine{1104           err\_g\_exp = err\_g\_exp*\mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}}}
\DoxyCodeLine{1105           err\_g(rdef) = max(err\_g\_exp,err\_g\_b(rdef))}
\DoxyCodeLine{1106           \textcolor{keywordflow}{if}(err\_g(rdef).lt.err\_req\_cr(rdef)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1107             iexp = 1}
\DoxyCodeLine{1108             \textcolor{comment}{! increase g by 2 to account for bad estimates}}
\DoxyCodeLine{1109             g = min(max(g+2,2*g),rmax\_c-\/rmax)}
\DoxyCodeLine{1110             \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1111 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1112 }
\DoxyCodeLine{1113 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1114 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred i g'},i,g,err\_g\_exp,err\_g\_b(rdef),err\_g(rdef) }
\DoxyCodeLine{1115 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1116 \textcolor{preprocessor}{}}
\DoxyCodeLine{1117 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1118 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1119 }
\DoxyCodeLine{1120       \textcolor{keywordflow}{if} (mod(i,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1121         \textcolor{keywordflow}{if} (use\_gy) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1122           \textcolor{keywordflow}{if} (err\_gy\_exp.gt.err\_gy\_b(rdef)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1123             gy = i/2}
\DoxyCodeLine{1124             err\_gy\_exp = err\_gy\_exp*\mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}}}
\DoxyCodeLine{1125             err\_gy(rdef) = max(err\_gy\_exp, err\_gy\_b(rdef))}
\DoxyCodeLine{1126             \textcolor{keywordflow}{if}(err\_gy(rdef).lt.err\_req\_cr(rdef)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1127               iexp = 2}
\DoxyCodeLine{1128               \textcolor{comment}{! increase gy by 2 to account for bad estimates}}
\DoxyCodeLine{1129               gy = min(max(gy+4,2*gy),(rmax\_c-\/rmax)/2)}
\DoxyCodeLine{1130               \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1131 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{1132 }
\DoxyCodeLine{1133 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1134 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred i gy'},i,gy,err\_gy\_exp,err\_gy\_b(rdef),err\_gy(rdef) }
\DoxyCodeLine{1135 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1136 \textcolor{preprocessor}{}}
\DoxyCodeLine{1137 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1138 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1139 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1140 }
\DoxyCodeLine{1141       \textcolor{keywordflow}{if} (use\_gp) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1142         \textcolor{keywordflow}{if} (err\_gp\_exp.gt.err\_gp\_b(rdef)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1143           gp = i}
\DoxyCodeLine{1144           err\_gp\_exp = err\_gp\_exp*\mbox{\hyperlink{namespaceglobalc_ac6e3d986b3c7aa2041225441a07dddb6}{fac\_gp}}}
\DoxyCodeLine{1145           err\_gp(rdef) = max(err\_gp\_exp,err\_gp\_b(rdef))}
\DoxyCodeLine{1146           \textcolor{keywordflow}{if}(err\_gp(rdef).lt.err\_req\_cr(rdef)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1147             iexp = 3}
\DoxyCodeLine{1148             \textcolor{comment}{! increase gp by 2 to account for bad estimates}}
\DoxyCodeLine{1149             gp = min(max(gp+2,2*gp),rmax\_c-\/rmax)}
\DoxyCodeLine{1150             \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1151 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1152 }
\DoxyCodeLine{1153 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1154 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred i gp'},i,gp,err\_gp\_exp,err\_gp\_b(rdef),err\_gp(rdef) }
\DoxyCodeLine{1155 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1156 \textcolor{preprocessor}{}}
\DoxyCodeLine{1157 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1158 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1159 }
\DoxyCodeLine{1160       \textcolor{keywordflow}{if} (mod(i,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1161 }
\DoxyCodeLine{1162         \textcolor{keywordflow}{if} (use\_gr) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1163 }
\DoxyCodeLine{1164 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1165 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: it gr'},use\_gr,err\_gr\_exp,err\_gr\_b(rdef),err\_gr(rdef),  \&}
\DoxyCodeLine{1166                                      err\_req\_cr(rdef)}
\DoxyCodeLine{1167 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1168 \textcolor{preprocessor}{} }
\DoxyCodeLine{1169           \textcolor{keywordflow}{if} (err\_gr\_exp.gt.err\_gr\_b(rdef)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1170             gr = i/2}
\DoxyCodeLine{1171             err\_gr\_exp = err\_gr\_exp*\mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}}}
\DoxyCodeLine{1172             err\_gr(rdef) = max(err\_gr\_exp, err\_gr\_b(rdef))}
\DoxyCodeLine{1173             \textcolor{keywordflow}{if}(err\_gr(rdef).lt.err\_req\_cr(rdef)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1174               iexp = 4}
\DoxyCodeLine{1175               \textcolor{comment}{! increase gy by 2 to account for bad estimates}}
\DoxyCodeLine{1176 \textcolor{comment}{! changed 28.07.14}}
\DoxyCodeLine{1177 \textcolor{comment}{!             gr = min(max(gr+4,2*gr),(rmax\_C-\/rmax)/2)}}
\DoxyCodeLine{1178               gr = min(max(gr+4,2*gr),rmax\_c-\/rmax,max(0,(rmax\_b-\/2*rmax)/2))}
\DoxyCodeLine{1179               \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1180 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{1181 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1182 }
\DoxyCodeLine{1183 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1184 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: it gr'},i,gr, err\_gr\_exp,err\_gr\_b(rdef) ,err\_gr(rdef)}
\DoxyCodeLine{1185 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1186 \textcolor{preprocessor}{}}
\DoxyCodeLine{1187 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1188 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1189 }
\DoxyCodeLine{1190       \textcolor{keywordflow}{if} (mod(i,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1191         \textcolor{keywordflow}{if} (use\_gpf) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1192           \textcolor{keywordflow}{if} (err\_gpf\_exp.gt.err\_gpf\_b(rdef)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1193             gpf = i/2}
\DoxyCodeLine{1194             err\_gpf\_exp = err\_gpf\_exp*\mbox{\hyperlink{namespaceglobalc_a92c2feddeb644af9e797691976e9143b}{fac\_gpf}}}
\DoxyCodeLine{1195             err\_gpf(rdef) = max(err\_gpf\_exp, err\_gpf\_b(rdef))}
\DoxyCodeLine{1196             \textcolor{keywordflow}{if}(err\_gpf(rdef).lt.err\_req\_cr(rdef)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1197               iexp = 5}
\DoxyCodeLine{1198               \textcolor{comment}{! increase gpf by 2 to account for bad estimates}}
\DoxyCodeLine{1199               gpf = min(max(gpf+4,2*gpf),(rmax\_c-\/rmax)/2)}
\DoxyCodeLine{1200               \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1201 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{1202 }
\DoxyCodeLine{1203 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1204 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred i gpf'},i,gpf,err\_gpf\_exp,err\_gpf\_b(rdef),err\_gpf(rdef),err\_req\_cr(rdef)}
\DoxyCodeLine{1205 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1206 \textcolor{preprocessor}{}}
\DoxyCodeLine{1207 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1208 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1209 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1210 }
\DoxyCodeLine{1211 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{1212 }
\DoxyCodeLine{1213     \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{1214     err\_g(rdef)  =  err\_g(rdef)/impest\_c}
\DoxyCodeLine{1215     err\_gy(rdef) =  err\_gy(rdef)/impest\_c     }
\DoxyCodeLine{1216     err\_gp(rdef) =  err\_gp(rdef)/impest\_c}
\DoxyCodeLine{1217     err\_gr(rdef) =  err\_gr(rdef)/impest\_c     }
\DoxyCodeLine{1218     err\_gpf(rdef)=  err\_gpf(rdef)/impest\_c     }
\DoxyCodeLine{1219 }
\DoxyCodeLine{1220 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1221 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'iexp='},iexp}
\DoxyCodeLine{1222     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'facexp='},\mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}},\mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}},\mbox{\hyperlink{namespaceglobalc_ac6e3d986b3c7aa2041225441a07dddb6}{fac\_gp}},\mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}},\mbox{\hyperlink{namespaceglobalc_a92c2feddeb644af9e797691976e9143b}{fac\_gpf}}}
\DoxyCodeLine{1223     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'errexp='},err\_g\_exp,err\_gy\_exp,err\_gp\_exp,err\_gr\_exp,err\_gpf\_exp,err\_req\_cr(rdef)}
\DoxyCodeLine{1224     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'errexptot='},i}
\DoxyCodeLine{1225     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'g:  errexptot ='},g,err\_g(rdef)}
\DoxyCodeLine{1226     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'gy: errexptot ='},gy,err\_gy(rdef)}
\DoxyCodeLine{1227     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'gp: errexptot ='},gp,err\_gp(rdef)}
\DoxyCodeLine{1228     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'gr: errexptot ='},gr,err\_gr(rdef)}
\DoxyCodeLine{1229     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'gpf: errexptot='},gpf,err\_gpf(rdef)}
\DoxyCodeLine{1230     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'errexptot='},i,g,err\_g(rdef),gy,err\_gy(rdef),gp,err\_gp(rdef),gr,err\_gr(rdef),gpf,err\_gpf(rdef)}
\DoxyCodeLine{1231     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'accexptot='},i,g,err\_g(rdef)/ctyp,gy,err\_gy(rdef)/ctyp,gp,err\_gp(rdef)/ctyp,      \&    }
\DoxyCodeLine{1232         gr,err\_gr(rdef)/ctyp,gpf,err\_gpf(rdef)/ctyp}
\DoxyCodeLine{1233 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1234 \textcolor{preprocessor}{}}
\DoxyCodeLine{1235     \textcolor{comment}{! call expansions with estimated order to save CPU time}}
\DoxyCodeLine{1236 }
\DoxyCodeLine{1237 \textcolor{preprocessor}{\#ifdef TEST}}
\DoxyCodeLine{1238 \textcolor{preprocessor}{}\textcolor{comment}{!    iexp = 0   ! TEST: force specific expansion}}
\DoxyCodeLine{1239 \textcolor{comment}{!    gy = 14}}
\DoxyCodeLine{1240 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1241 \textcolor{preprocessor}{}}
\DoxyCodeLine{1242     \textcolor{keywordflow}{select case} (iexp)}
\DoxyCodeLine{1243  }
\DoxyCodeLine{1244 \textcolor{preprocessor}{\#ifdef TEST}}
\DoxyCodeLine{1245 \textcolor{preprocessor}{}\textcolor{comment}{!  case only as replacement for CalcCg, not as extra case}}
\DoxyCodeLine{1246       \textcolor{keywordflow}{case} (7)  }
\DoxyCodeLine{1247         \textcolor{keyword}{call }calccgn(c\_alt,cuv,p10,p21,p20,m02,m12,m22,rmax,g,g,id,cerr1\_alt,acc\_req\_cr,cerr2\_alt)}
\DoxyCodeLine{1248 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{1249 \textcolor{preprocessor}{}        cerr\_alt = cerr2\_alt}
\DoxyCodeLine{1250 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1251 \textcolor{preprocessor}{}        cerr\_alt = cerr1\_alt}
\DoxyCodeLine{1252 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1253 \textcolor{preprocessor}{}        ccount(3) = ccount(3)+1}
\DoxyCodeLine{1254         crcalc(0:rmax)=crcalc(0:rmax)+4}
\DoxyCodeLine{1255         ccalc=ccalc+4}
\DoxyCodeLine{1256         crmethod\_alt(0:rmax)=4}
\DoxyCodeLine{1257         }
\DoxyCodeLine{1258 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1259 \textcolor{preprocessor}{}        checkest=cerr\_alt(rdef)/err\_g(rdef)}
\DoxyCodeLine{1260         \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_c.or.checkest.lt.1d-\/2*impest\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1261           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: estimate err\_g imprecise '},err\_g(rdef),cerr\_alt(rdef)}
\DoxyCodeLine{1262 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1263 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1264 \textcolor{preprocessor}{}}
\DoxyCodeLine{1265         err\_g=cerr\_alt}
\DoxyCodeLine{1266 }
\DoxyCodeLine{1267         \textcolor{keyword}{call }copycimp3(c,c\_alt,cerr,cerr\_alt,cerr1,cerr1\_alt,cerr2,cerr2\_alt,crmethod,crmethod\_alt,rmax,rmax)}
\DoxyCodeLine{1268         }
\DoxyCodeLine{1269 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1270 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cerr after exp ='},cerr}
\DoxyCodeLine{1271         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cacc='},cerr/ctyp}
\DoxyCodeLine{1272         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred method='},crmethod}
\DoxyCodeLine{1273 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1274 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1275 \textcolor{preprocessor}{}}
\DoxyCodeLine{1276       \textcolor{keywordflow}{case} (1)  }
\DoxyCodeLine{1277         \textcolor{keyword}{call }calccg(c\_alt,cuv,p10,p21,p20,m02,m12,m22,rmax,g,g,id,cerr1\_alt,acc\_req\_cr,cerr2\_alt)}
\DoxyCodeLine{1278 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{1279 \textcolor{preprocessor}{}        cerr\_alt = cerr2\_alt}
\DoxyCodeLine{1280 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1281 \textcolor{preprocessor}{}        cerr\_alt = cerr1\_alt}
\DoxyCodeLine{1282 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1283 \textcolor{preprocessor}{}        ccount(3) = ccount(3)+1}
\DoxyCodeLine{1284         crcalc(0:rmax)=crcalc(0:rmax)+4}
\DoxyCodeLine{1285         ccalc=ccalc+4}
\DoxyCodeLine{1286         crmethod\_alt(0:rmax)=4}
\DoxyCodeLine{1287         }
\DoxyCodeLine{1288 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1289 \textcolor{preprocessor}{}        checkest=cerr\_alt(rdef)/err\_g(rdef)}
\DoxyCodeLine{1290         \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_c.or.checkest.lt.1d-\/2*impest\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1291           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: estimate err\_g imprecise '},err\_g(rdef),cerr\_alt(rdef)}
\DoxyCodeLine{1292 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1293 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1294 \textcolor{preprocessor}{}}
\DoxyCodeLine{1295         err\_g=cerr\_alt}
\DoxyCodeLine{1296 }
\DoxyCodeLine{1297         \textcolor{keyword}{call }copycimp3(c,c\_alt,cerr,cerr\_alt,cerr1,cerr1\_alt,cerr2,cerr2\_alt,crmethod,crmethod\_alt,rmax,rmax)}
\DoxyCodeLine{1298         }
\DoxyCodeLine{1299 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1300 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cerr after exp ='},cerr}
\DoxyCodeLine{1301         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cacc='},cerr/ctyp}
\DoxyCodeLine{1302         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred method='},crmethod}
\DoxyCodeLine{1303 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1304 \textcolor{preprocessor}{}}
\DoxyCodeLine{1305       \textcolor{keywordflow}{case} (2)}
\DoxyCodeLine{1306 }
\DoxyCodeLine{1307         \textcolor{keyword}{call }calccgy(c\_alt,cuv,p10,p21,p20,m02,m12,m22,rmax,gy,gy,id,cerr1\_alt,acc\_req\_cr,cerr2\_alt)}
\DoxyCodeLine{1308 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{1309 \textcolor{preprocessor}{}        cerr\_alt = cerr2\_alt}
\DoxyCodeLine{1310 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1311 \textcolor{preprocessor}{}        cerr\_alt = cerr1\_alt}
\DoxyCodeLine{1312 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1313 \textcolor{preprocessor}{}        ccount(4) = ccount(4)+1}
\DoxyCodeLine{1314         crcalc(0:rmax)=crcalc(0:rmax)+8}
\DoxyCodeLine{1315         ccalc=ccalc+8}
\DoxyCodeLine{1316         crmethod\_alt(0:rmax)=8}
\DoxyCodeLine{1317 }
\DoxyCodeLine{1318 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1319 \textcolor{preprocessor}{}        checkest=cerr\_alt(rdef)/err\_gy(rdef)}
\DoxyCodeLine{1320         \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_c.or.checkest.lt.1d-\/2*impest\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1321           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: estimate err\_gy imprecise'},err\_gy(rdef),cerr\_alt(rdef),checkest}
\DoxyCodeLine{1322 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1323 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1324 \textcolor{preprocessor}{}}
\DoxyCodeLine{1325         err\_gy=cerr\_alt}
\DoxyCodeLine{1326 }
\DoxyCodeLine{1327         \textcolor{keyword}{call }copycimp3(c,c\_alt,cerr,cerr\_alt,cerr1,cerr1\_alt,cerr2,cerr2\_alt,crmethod,crmethod\_alt,rmax,rmax)}
\DoxyCodeLine{1328 }
\DoxyCodeLine{1329 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1330 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cerr after exp ='},cerr}
\DoxyCodeLine{1331         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cacc='},cerr/ctyp}
\DoxyCodeLine{1332         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred method='},crmethod}
\DoxyCodeLine{1333 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1334 \textcolor{preprocessor}{}}
\DoxyCodeLine{1335       \textcolor{keywordflow}{case} (3)  }
\DoxyCodeLine{1336         \textcolor{keyword}{call }calccgp(c\_alt,cuv,p10,p21,p20,m02,m12,m22,rmax,gp,gp,id,cerr1\_alt,acc\_req\_cr,cerr2\_alt)}
\DoxyCodeLine{1337 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{1338 \textcolor{preprocessor}{}        cerr\_alt = cerr2\_alt}
\DoxyCodeLine{1339 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1340 \textcolor{preprocessor}{}        cerr\_alt = cerr1\_alt}
\DoxyCodeLine{1341 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1342 \textcolor{preprocessor}{}        ccount(5) = ccount(5)+1}
\DoxyCodeLine{1343         crcalc(0:rmax)=crcalc(0:rmax)+16}
\DoxyCodeLine{1344         ccalc=ccalc+16}
\DoxyCodeLine{1345         crmethod\_alt(0:rmax)=16}
\DoxyCodeLine{1346 }
\DoxyCodeLine{1347 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1348 \textcolor{preprocessor}{}        checkest=cerr\_alt(rdef)/err\_gp(rdef)}
\DoxyCodeLine{1349         \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_c.or.checkest.lt.1d-\/2*impest\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1350           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: estimate err\_gp imprecise'},err\_gp(rdef),cerr\_alt(rdef)}
\DoxyCodeLine{1351 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1352 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1353 \textcolor{preprocessor}{}}
\DoxyCodeLine{1354         err\_gp=cerr\_alt}
\DoxyCodeLine{1355 }
\DoxyCodeLine{1356         \textcolor{keyword}{call }copycimp3(c,c\_alt,cerr,cerr\_alt,cerr1,cerr1\_alt,cerr2,cerr2\_alt,crmethod,crmethod\_alt,rmax,rmax)}
\DoxyCodeLine{1357 }
\DoxyCodeLine{1358 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1359 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cerr after exp ='},cerr}
\DoxyCodeLine{1360         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cacc='},cerr/ctyp}
\DoxyCodeLine{1361         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred method='},crmethod}
\DoxyCodeLine{1362 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1363 \textcolor{preprocessor}{}}
\DoxyCodeLine{1364       \textcolor{keywordflow}{case} (4)  }
\DoxyCodeLine{1365         \textcolor{keyword}{call }calccgr(c\_alt,cuv,p10,p21,p20,m02,m12,m22,rmax,gr,gr,id,cerr1\_alt,acc\_req\_cr,cerr2\_alt)}
\DoxyCodeLine{1366 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{1367 \textcolor{preprocessor}{}        cerr\_alt = cerr2\_alt}
\DoxyCodeLine{1368 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1369 \textcolor{preprocessor}{}        cerr\_alt = cerr1\_alt}
\DoxyCodeLine{1370 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1371 \textcolor{preprocessor}{}        ccount(6) = ccount(6)+1}
\DoxyCodeLine{1372         crcalc(0:rmax)=crcalc(0:rmax)+32}
\DoxyCodeLine{1373         ccalc=ccalc+32}
\DoxyCodeLine{1374         crmethod\_alt(0:rmax)=32}
\DoxyCodeLine{1375 }
\DoxyCodeLine{1376 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1377 \textcolor{preprocessor}{}        checkest=cerr\_alt(rdef)/err\_gr(rdef)}
\DoxyCodeLine{1378         \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_c.or.checkest.lt.1d-\/2*impest\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1379           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: estimate err\_gr imprecise'},err\_gr(rdef),cerr\_alt(rdef)}
\DoxyCodeLine{1380 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1381 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1382 \textcolor{preprocessor}{}}
\DoxyCodeLine{1383         err\_gr=cerr\_alt}
\DoxyCodeLine{1384 }
\DoxyCodeLine{1385         \textcolor{keyword}{call }copycimp3(c,c\_alt,cerr,cerr\_alt,cerr1,cerr1\_alt,cerr2,cerr2\_alt,crmethod,crmethod\_alt,rmax,rmax)}
\DoxyCodeLine{1386 }
\DoxyCodeLine{1387 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1388 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cerr after exp ='},cerr}
\DoxyCodeLine{1389         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cacc='},cerr/ctyp}
\DoxyCodeLine{1390         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred method='},crmethod}
\DoxyCodeLine{1391 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1392 \textcolor{preprocessor}{}}
\DoxyCodeLine{1393       \textcolor{keywordflow}{case} (5)}
\DoxyCodeLine{1394 }
\DoxyCodeLine{1395         \textcolor{keyword}{call }calccgpf(c\_alt,cuv,p10,p21,p20,m02,m12,m22,rmax,gpf,gpf,id,cerr1\_alt,acc\_req\_cr,cerr2\_alt)}
\DoxyCodeLine{1396 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{1397 \textcolor{preprocessor}{}        cerr\_alt = cerr2\_alt}
\DoxyCodeLine{1398 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1399 \textcolor{preprocessor}{}        cerr\_alt = cerr1\_alt}
\DoxyCodeLine{1400 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1401 \textcolor{preprocessor}{}        ccount(4) = ccount(4)+1}
\DoxyCodeLine{1402         crcalc(0:rmax)=crcalc(0:rmax)+8}
\DoxyCodeLine{1403         ccalc=ccalc+8}
\DoxyCodeLine{1404         crmethod\_alt(0:rmax)=8}
\DoxyCodeLine{1405 }
\DoxyCodeLine{1406 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1407 \textcolor{preprocessor}{}        checkest=cerr\_alt(rdef)/err\_gpf(rdef)}
\DoxyCodeLine{1408         \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_c.or.checkest.lt.1d-\/2*impest\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1409           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: estimate err\_gpf imprecise'},err\_gpf(rdef),cerr\_alt(rdef),checkest}
\DoxyCodeLine{1410 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1411 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1412 \textcolor{preprocessor}{}}
\DoxyCodeLine{1413         err\_gpf=cerr\_alt}
\DoxyCodeLine{1414 }
\DoxyCodeLine{1415         \textcolor{keyword}{call }copycimp3(c,c\_alt,cerr,cerr\_alt,cerr1,cerr1\_alt,cerr2,cerr2\_alt,crmethod,crmethod\_alt,rmax,rmax)}
\DoxyCodeLine{1416 }
\DoxyCodeLine{1417 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1418 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cerr after exp ='},cerr}
\DoxyCodeLine{1419         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cacc='},cerr/ctyp}
\DoxyCodeLine{1420         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred method='},crmethod}
\DoxyCodeLine{1421 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1422 \textcolor{preprocessor}{}}
\DoxyCodeLine{1423 \textcolor{keywordflow}{    end select}}
\DoxyCodeLine{1424 }
\DoxyCodeLine{1425 \textcolor{preprocessor}{\#ifndef USEC0}}
\DoxyCodeLine{1426 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifndef ALWAYSPV}}
\DoxyCodeLine{1427 \textcolor{preprocessor}{}    \textcolor{comment}{! refine error estimate for C0}}
\DoxyCodeLine{1428     \textcolor{keywordflow}{if}(.not.lerr\_c0.and.iexp.ne.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1429 \textcolor{comment}{!      C0est =  abs(C(0,0,0))}}
\DoxyCodeLine{1430       err\_c0 = acc\_def\_c0*max( abs(c(0,0,0)), 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}) )}
\DoxyCodeLine{1431 \textcolor{comment}{!      err\_req\_Cr = acc\_req\_Cr * abs(C(0,0,0))}}
\DoxyCodeLine{1432       lerr\_c0 = .true.}
\DoxyCodeLine{1433 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{1434 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1435 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1436 \textcolor{preprocessor}{}}
\DoxyCodeLine{1437     \textcolor{keywordflow}{if} (iexp.ne.0)  \textcolor{keywordflow}{then}         \textcolor{comment}{!  if added 21.11.2016 }}
\DoxyCodeLine{1438       \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1439         ctyp =  max(abs(c(0,0,0)),abs(c(0,1,0)),abs(c(0,0,1)))}
\DoxyCodeLine{1440       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1441         ctyp =  abs(c(0,0,0))}
\DoxyCodeLine{1442 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1443       err\_req\_cr = acc\_req\_cr * ctyp}
\DoxyCodeLine{1444       }
\DoxyCodeLine{1445       \textcolor{keywordflow}{if} (maxval(cerr1-\/err\_req\_cr).lt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1446         ccount(ccalc+ccountoffset0) = ccount(ccalc+ccountoffset0)+1}
\DoxyCodeLine{1447         \textcolor{keywordflow}{return}}
\DoxyCodeLine{1448 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1449 \textcolor{keywordflow}{    end if}    }
\DoxyCodeLine{1450 }
\DoxyCodeLine{1451 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1452 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred no optimal method bef shift'},ctyp,acc\_req\_cr}
\DoxyCodeLine{1453     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'err\_req='},err\_req\_cr(rdef),rdef}
\DoxyCodeLine{1454     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'err\_est='},err\_pv(rdef),err\_pv2(rdef),err\_g(rdef)  \&}
\DoxyCodeLine{1455         ,err\_gy(rdef),err\_gp(rdef),err\_gr(rdef),err\_gpf(rdef)}
\DoxyCodeLine{1456 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1457 \textcolor{preprocessor}{}}
\DoxyCodeLine{1458 \textcolor{preprocessor}{\#ifdef TEST}}
\DoxyCodeLine{1459 \textcolor{preprocessor}{}    \textcolor{keywordflow}{return}          \textcolor{comment}{! do not try shifted PV}}
\DoxyCodeLine{1460 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1461 \textcolor{preprocessor}{}}
\DoxyCodeLine{1462 \textcolor{preprocessor}{\#ifdef PVSHIFT }}
\DoxyCodeLine{1463 \textcolor{preprocessor}{}    \textcolor{comment}{! try PV with shifted momentum}}
\DoxyCodeLine{1464     shiftloop: \textcolor{keywordflow}{do} i=1,2}
\DoxyCodeLine{1465 }
\DoxyCodeLine{1466 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1467 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred try pv shift i = '},i}
\DoxyCodeLine{1468 \textcolor{preprocessor}{\#endif    }}
\DoxyCodeLine{1469 \textcolor{preprocessor}{}}
\DoxyCodeLine{1470       \textcolor{keywordflow}{if} (i.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1471         \mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}} = mm12}
\DoxyCodeLine{1472         \mbox{\hyperlink{namespaceglobalc_a8db82f9bf54b6faee883b33e0f2f2984}{mm12shift}} = mm02}
\DoxyCodeLine{1473         \mbox{\hyperlink{namespaceglobalc_a526a71c3feadc61442fa54e19388ca7b}{mm22shift}} = \mbox{\hyperlink{namespaceglobalc_a7c2a517c5707c2e77eb16e183db3d259}{mm22}}}
\DoxyCodeLine{1474         \mbox{\hyperlink{namespaceglobalc_a67bf8e12b4f3bcee871090152c675f9e}{q10shift}} = \mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}}
\DoxyCodeLine{1475         \mbox{\hyperlink{namespaceglobalc_aa76b6e3bf684f082cd038791036c69de}{q21shift}} = \mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}}
\DoxyCodeLine{1476         \mbox{\hyperlink{namespaceglobalc_a1674eaa05737b52642244de28f3c8452}{q20shift}} = \mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}}
\DoxyCodeLine{1477       \textcolor{keywordflow}{else} }
\DoxyCodeLine{1478         \mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}} = \mbox{\hyperlink{namespaceglobalc_a7c2a517c5707c2e77eb16e183db3d259}{mm22}}}
\DoxyCodeLine{1479         \mbox{\hyperlink{namespaceglobalc_a8db82f9bf54b6faee883b33e0f2f2984}{mm12shift}} = mm12}
\DoxyCodeLine{1480         \mbox{\hyperlink{namespaceglobalc_a526a71c3feadc61442fa54e19388ca7b}{mm22shift}} = mm02}
\DoxyCodeLine{1481         \mbox{\hyperlink{namespaceglobalc_a67bf8e12b4f3bcee871090152c675f9e}{q10shift}} = \mbox{\hyperlink{namespaceglobalc_aed5540d9788bf859a6b1b57a3d25a45b}{q21}}}
\DoxyCodeLine{1482         \mbox{\hyperlink{namespaceglobalc_aa76b6e3bf684f082cd038791036c69de}{q21shift}} = \mbox{\hyperlink{namespaceglobalc_ab58f8cce2730b284d04ebaf9df6b778a}{q10}}}
\DoxyCodeLine{1483         \mbox{\hyperlink{namespaceglobalc_a1674eaa05737b52642244de28f3c8452}{q20shift}} = \mbox{\hyperlink{namespaceglobalc_a251a4ee1cc3b8bf54e2e3020e264cd84}{q20}}}
\DoxyCodeLine{1484 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1485 }
\DoxyCodeLine{1486       \mbox{\hyperlink{namespaceglobalc_a0e51561791a4d4225394aa4831383d77}{zshift}}(1,1) = 2d0*\mbox{\hyperlink{namespaceglobalc_a67bf8e12b4f3bcee871090152c675f9e}{q10shift}}}
\DoxyCodeLine{1487       \mbox{\hyperlink{namespaceglobalc_a0e51561791a4d4225394aa4831383d77}{zshift}}(2,1) = \mbox{\hyperlink{namespaceglobalc_a67bf8e12b4f3bcee871090152c675f9e}{q10shift}}+\mbox{\hyperlink{namespaceglobalc_a1674eaa05737b52642244de28f3c8452}{q20shift}}-\/\mbox{\hyperlink{namespaceglobalc_aa76b6e3bf684f082cd038791036c69de}{q21shift}}}
\DoxyCodeLine{1488       \mbox{\hyperlink{namespaceglobalc_a0e51561791a4d4225394aa4831383d77}{zshift}}(1,2) = \mbox{\hyperlink{namespaceglobalc_a0e51561791a4d4225394aa4831383d77}{zshift}}(2,1)}
\DoxyCodeLine{1489       \mbox{\hyperlink{namespaceglobalc_a0e51561791a4d4225394aa4831383d77}{zshift}}(2,2) = 2d0*\mbox{\hyperlink{namespaceglobalc_a1674eaa05737b52642244de28f3c8452}{q20shift}}}
\DoxyCodeLine{1490 }
\DoxyCodeLine{1491       \mbox{\hyperlink{namespaceglobalc_ae790b272fa30ed57e592556fa1e22714}{maxzshift}} = maxval(abs(\mbox{\hyperlink{namespaceglobalc_a0e51561791a4d4225394aa4831383d77}{zshift}}))}
\DoxyCodeLine{1492 }
\DoxyCodeLine{1493       \mbox{\hyperlink{namespaceglobalc_a5ee81ae3d90111f9756391e0c589bc63}{detzshift}} = chdet(2,\mbox{\hyperlink{namespaceglobalc_a0e51561791a4d4225394aa4831383d77}{zshift}})}
\DoxyCodeLine{1494 }
\DoxyCodeLine{1495 \textcolor{comment}{!      if (detZshift.ne.0d0) then}}
\DoxyCodeLine{1496 \textcolor{comment}{!        call chinv(2,Zshift,Zinvshift)}}
\DoxyCodeLine{1497 \textcolor{comment}{!        Zadjshift = Zinvshift * detZshift}}
\DoxyCodeLine{1498 \textcolor{comment}{!      else}}
\DoxyCodeLine{1499         \mbox{\hyperlink{namespaceglobalc_a26ca49de188ad4b40adf16b0222797d5}{zadjshift}}(1,1) = \mbox{\hyperlink{namespaceglobalc_a0e51561791a4d4225394aa4831383d77}{zshift}}(2,2)}
\DoxyCodeLine{1500         \mbox{\hyperlink{namespaceglobalc_a26ca49de188ad4b40adf16b0222797d5}{zadjshift}}(2,1) = -\/\mbox{\hyperlink{namespaceglobalc_a0e51561791a4d4225394aa4831383d77}{zshift}}(1,2)}
\DoxyCodeLine{1501         \mbox{\hyperlink{namespaceglobalc_a26ca49de188ad4b40adf16b0222797d5}{zadjshift}}(1,2) = -\/\mbox{\hyperlink{namespaceglobalc_a0e51561791a4d4225394aa4831383d77}{zshift}}(1,2)}
\DoxyCodeLine{1502         \mbox{\hyperlink{namespaceglobalc_a26ca49de188ad4b40adf16b0222797d5}{zadjshift}}(2,2) = \mbox{\hyperlink{namespaceglobalc_a0e51561791a4d4225394aa4831383d77}{zshift}}(1,1)}
\DoxyCodeLine{1503 \textcolor{comment}{!      end if}}
\DoxyCodeLine{1504 }
\DoxyCodeLine{1505       \mbox{\hyperlink{namespaceglobalc_a4ab084a78a3a020a9e6aac9f4868711e}{zadjsshift}}(1) = \mbox{\hyperlink{namespaceglobalc_aa76b6e3bf684f082cd038791036c69de}{q21shift}} + \mbox{\hyperlink{namespaceglobalc_a1674eaa05737b52642244de28f3c8452}{q20shift}} -\/ \mbox{\hyperlink{namespaceglobalc_a67bf8e12b4f3bcee871090152c675f9e}{q10shift}} }
\DoxyCodeLine{1506       \mbox{\hyperlink{namespaceglobalc_a4ab084a78a3a020a9e6aac9f4868711e}{zadjsshift}}(2) = \mbox{\hyperlink{namespaceglobalc_aa76b6e3bf684f082cd038791036c69de}{q21shift}} + \mbox{\hyperlink{namespaceglobalc_a67bf8e12b4f3bcee871090152c675f9e}{q10shift}} -\/ \mbox{\hyperlink{namespaceglobalc_a1674eaa05737b52642244de28f3c8452}{q20shift}}}
\DoxyCodeLine{1507 }
\DoxyCodeLine{1508       \mbox{\hyperlink{namespaceglobalc_a0280899f395c1130250317a0c65a27bf}{detzmzadjfshift}} = \mbox{\hyperlink{namespaceglobalc_aa76b6e3bf684f082cd038791036c69de}{q21shift}}*\mbox{\hyperlink{namespaceglobalc_a0e51561791a4d4225394aa4831383d77}{zshift}}(2,1)}
\DoxyCodeLine{1509 }
\DoxyCodeLine{1510       \mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}} = abs(\mbox{\hyperlink{namespaceglobalc_a5ee81ae3d90111f9756391e0c589bc63}{detzshift}})}
\DoxyCodeLine{1511       \mbox{\hyperlink{namespaceglobalc_a9400f35ae47e801cf5e42790467bd030}{maxzadjshift}} = max(abs(\mbox{\hyperlink{namespaceglobalc_a26ca49de188ad4b40adf16b0222797d5}{zadjshift}}(1,1)),abs(\mbox{\hyperlink{namespaceglobalc_a26ca49de188ad4b40adf16b0222797d5}{zadjshift}}(2,1)),abs(\mbox{\hyperlink{namespaceglobalc_a26ca49de188ad4b40adf16b0222797d5}{zadjshift}}(2,2)))}
\DoxyCodeLine{1512 }
\DoxyCodeLine{1513       \mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(1) = \mbox{\hyperlink{namespaceglobalc_a67bf8e12b4f3bcee871090152c675f9e}{q10shift}}+\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}}-\/\mbox{\hyperlink{namespaceglobalc_a8db82f9bf54b6faee883b33e0f2f2984}{mm12shift}} }
\DoxyCodeLine{1514       \mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(2) = \mbox{\hyperlink{namespaceglobalc_a1674eaa05737b52642244de28f3c8452}{q20shift}}+\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}}-\/\mbox{\hyperlink{namespaceglobalc_a526a71c3feadc61442fa54e19388ca7b}{mm22shift}}}
\DoxyCodeLine{1515 }
\DoxyCodeLine{1516 \textcolor{preprocessor}{\#ifdef Credtestshift}}
\DoxyCodeLine{1517 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'fshift1'},\mbox{\hyperlink{namespaceglobalc_a67bf8e12b4f3bcee871090152c675f9e}{q10shift}}+\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}}-\/\mbox{\hyperlink{namespaceglobalc_a8db82f9bf54b6faee883b33e0f2f2984}{mm12shift}},\mbox{\hyperlink{namespaceglobalc_a67bf8e12b4f3bcee871090152c675f9e}{q10shift}},\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}},-\/\mbox{\hyperlink{namespaceglobalc_a8db82f9bf54b6faee883b33e0f2f2984}{mm12shift}}}
\DoxyCodeLine{1518       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'fshift2'},\mbox{\hyperlink{namespaceglobalc_a1674eaa05737b52642244de28f3c8452}{q20shift}}+\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}}-\/\mbox{\hyperlink{namespaceglobalc_a526a71c3feadc61442fa54e19388ca7b}{mm22shift}},\mbox{\hyperlink{namespaceglobalc_a1674eaa05737b52642244de28f3c8452}{q20shift}},\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}},-\/\mbox{\hyperlink{namespaceglobalc_a526a71c3feadc61442fa54e19388ca7b}{mm22shift}}}
\DoxyCodeLine{1519 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1520 \textcolor{preprocessor}{}}
\DoxyCodeLine{1521       \mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(0,0) = 2d0*\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}}}
\DoxyCodeLine{1522       \mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(1,0) = \mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(1)}
\DoxyCodeLine{1523       \mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(2,0) = \mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(2)}
\DoxyCodeLine{1524       \mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(0,1) = \mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(1,0)}
\DoxyCodeLine{1525       \mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(0,2) = \mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(2,0)}
\DoxyCodeLine{1526 \textcolor{comment}{!     mxshift(1,1) = 2d0*q10shift}}
\DoxyCodeLine{1527 \textcolor{comment}{!     mxshift(2,1) = q10shift+q20shift-\/q21shift}}
\DoxyCodeLine{1528 \textcolor{comment}{!     mxshift(2,2) = 2d0*q20shift}}
\DoxyCodeLine{1529 \textcolor{comment}{!     mxshift(1,2) = mxshift(2,1)}}
\DoxyCodeLine{1530 }
\DoxyCodeLine{1531       \mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(1:2,1:2) = \mbox{\hyperlink{namespaceglobalc_a0e51561791a4d4225394aa4831383d77}{zshift}}(1:2,1:2)}
\DoxyCodeLine{1532 }
\DoxyCodeLine{1533       \mbox{\hyperlink{namespaceglobalc_ac168cff5383186848cf10fbe7eef6c95}{detxshift}} = chdet(3,\mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}})}
\DoxyCodeLine{1534 }
\DoxyCodeLine{1535       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_ac168cff5383186848cf10fbe7eef6c95}{detxshift}}.ne.0d0.and.\mbox{\hyperlink{namespaceglobalc_ae790b272fa30ed57e592556fa1e22714}{maxzshift}}.ne.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1536 }
\DoxyCodeLine{1537 \textcolor{comment}{!     write(*,*) 'CalcCred mxshift=',mxshift}}
\DoxyCodeLine{1538 }
\DoxyCodeLine{1539         \textcolor{keyword}{call }chinv(3,\mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}},\mbox{\hyperlink{namespaceglobalc_afbeb373d6ae13077b3f7bfc97c750f2d}{mxinvshift}})}
\DoxyCodeLine{1540 }
\DoxyCodeLine{1541 \textcolor{comment}{!     write(*,*) 'CalcCred mxinvshift=',mxinvshift}}
\DoxyCodeLine{1542 }
\DoxyCodeLine{1543         \mbox{\hyperlink{namespaceglobalc_a737db5719a2400a379a2595379951967}{xadjshift}} = \mbox{\hyperlink{namespaceglobalc_afbeb373d6ae13077b3f7bfc97c750f2d}{mxinvshift}} * \mbox{\hyperlink{namespaceglobalc_ac168cff5383186848cf10fbe7eef6c95}{detxshift}}}
\DoxyCodeLine{1544 }
\DoxyCodeLine{1545 \textcolor{comment}{!     write(*,*) 'CalcCred Xadj=',Xadj}}
\DoxyCodeLine{1546 }
\DoxyCodeLine{1547         \mbox{\hyperlink{namespaceglobalc_a19a48bfc1152ab4e6cede92fc6034df1}{zadjfshift}}(1:2) = -\/\mbox{\hyperlink{namespaceglobalc_a737db5719a2400a379a2595379951967}{xadjshift}}(0,1:2)}
\DoxyCodeLine{1548 }
\DoxyCodeLine{1549       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1550         \mbox{\hyperlink{namespaceglobalc_a19a48bfc1152ab4e6cede92fc6034df1}{zadjfshift}}(1) = \mbox{\hyperlink{namespaceglobalc_a26ca49de188ad4b40adf16b0222797d5}{zadjshift}}(1,1)*\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(1)+\mbox{\hyperlink{namespaceglobalc_a26ca49de188ad4b40adf16b0222797d5}{zadjshift}}(2,1)*\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(2)}
\DoxyCodeLine{1551         \mbox{\hyperlink{namespaceglobalc_a19a48bfc1152ab4e6cede92fc6034df1}{zadjfshift}}(2) = \mbox{\hyperlink{namespaceglobalc_a26ca49de188ad4b40adf16b0222797d5}{zadjshift}}(1,2)*\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(1)+\mbox{\hyperlink{namespaceglobalc_a26ca49de188ad4b40adf16b0222797d5}{zadjshift}}(2,2)*\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(2)}
\DoxyCodeLine{1552         \mbox{\hyperlink{namespaceglobalc_a737db5719a2400a379a2595379951967}{xadjshift}}(2,2) = 2d0*\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}}*\mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(1,1) -\/ \mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(1)*\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(1)}
\DoxyCodeLine{1553         \mbox{\hyperlink{namespaceglobalc_a737db5719a2400a379a2595379951967}{xadjshift}}(1,1) = 2d0*\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}}*\mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(2,2) -\/ \mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(2)*\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(2)}
\DoxyCodeLine{1554         \mbox{\hyperlink{namespaceglobalc_a737db5719a2400a379a2595379951967}{xadjshift}}(2,1) = 2d0*\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}}*\mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(1,2) -\/ \mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(1)*\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(2)}
\DoxyCodeLine{1555         \mbox{\hyperlink{namespaceglobalc_a737db5719a2400a379a2595379951967}{xadjshift}}(1,2) = \mbox{\hyperlink{namespaceglobalc_a737db5719a2400a379a2595379951967}{xadjshift}}(2,1)}
\DoxyCodeLine{1556 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1557 }
\DoxyCodeLine{1558 \textcolor{preprocessor}{\#ifdef Credtestshift}}
\DoxyCodeLine{1559 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'fishift '},\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(1),\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(2)}
\DoxyCodeLine{1560       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'m02shift '},\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}},\mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(1,1),\mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(2,2),\mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(1,2)}
\DoxyCodeLine{1561       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Xadjshift11 '}, 2d0*\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}}*\mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(1,1) -\/ \mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(2)*\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(2),\mbox{\hyperlink{namespaceglobalc_a737db5719a2400a379a2595379951967}{xadjshift}}(1,1)}
\DoxyCodeLine{1562       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Xadjshift21 '}, 2d0*\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}}*\mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(1,2) -\/ \mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(1)*\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(2),\mbox{\hyperlink{namespaceglobalc_a737db5719a2400a379a2595379951967}{xadjshift}}(1,2)}
\DoxyCodeLine{1563       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Xadjshift22 '}, 2d0*\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}}*\mbox{\hyperlink{namespaceglobalc_aa48f97ab719f6f9325ebbc7ed9941b63}{mxshift}}(2,2) -\/ \mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(1)*\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(1),\mbox{\hyperlink{namespaceglobalc_a737db5719a2400a379a2595379951967}{xadjshift}}(2,2)}
\DoxyCodeLine{1564       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'detXshiftn '},\mbox{\hyperlink{namespaceglobalc_ac168cff5383186848cf10fbe7eef6c95}{detxshift}}}
\DoxyCodeLine{1565       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Zadjfshift1'},\mbox{\hyperlink{namespaceglobalc_a19a48bfc1152ab4e6cede92fc6034df1}{zadjfshift}}(1),2d0*\mbox{\hyperlink{namespaceglobalc_a1674eaa05737b52642244de28f3c8452}{q20shift}}*\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(1)  \&  }
\DoxyCodeLine{1566           +(\mbox{\hyperlink{namespaceglobalc_aa76b6e3bf684f082cd038791036c69de}{q21shift}}-\/\mbox{\hyperlink{namespaceglobalc_a1674eaa05737b52642244de28f3c8452}{q20shift}}-\/\mbox{\hyperlink{namespaceglobalc_a67bf8e12b4f3bcee871090152c675f9e}{q10shift}})*\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(2)}
\DoxyCodeLine{1567       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Zadjfshift2'},\mbox{\hyperlink{namespaceglobalc_a19a48bfc1152ab4e6cede92fc6034df1}{zadjfshift}}(2), \&  }
\DoxyCodeLine{1568           (\mbox{\hyperlink{namespaceglobalc_aa76b6e3bf684f082cd038791036c69de}{q21shift}}-\/\mbox{\hyperlink{namespaceglobalc_a1674eaa05737b52642244de28f3c8452}{q20shift}}-\/\mbox{\hyperlink{namespaceglobalc_a67bf8e12b4f3bcee871090152c675f9e}{q10shift}})*\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(1)+2d0*\mbox{\hyperlink{namespaceglobalc_a67bf8e12b4f3bcee871090152c675f9e}{q10shift}}*\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(2)}
\DoxyCodeLine{1569 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1570 \textcolor{preprocessor}{}      }
\DoxyCodeLine{1571       \mbox{\hyperlink{namespaceglobalc_a5a95c855c3182d83765f2bad05579761}{maxzadjfshift}} = max(abs(\mbox{\hyperlink{namespaceglobalc_a19a48bfc1152ab4e6cede92fc6034df1}{zadjfshift}}(1)),abs(\mbox{\hyperlink{namespaceglobalc_a19a48bfc1152ab4e6cede92fc6034df1}{zadjfshift}}(2)))}
\DoxyCodeLine{1572 \textcolor{comment}{!    maxZadjfds = max(maxZadjfshift,adetZshift)}}
\DoxyCodeLine{1573 }
\DoxyCodeLine{1574       \mbox{\hyperlink{namespaceglobalc_ada46a2845917d83ee02ea5754b33fe08}{azadjffshift}} = abs(\mbox{\hyperlink{namespaceglobalc_a19a48bfc1152ab4e6cede92fc6034df1}{zadjfshift}}(1)*\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(1) + \mbox{\hyperlink{namespaceglobalc_a19a48bfc1152ab4e6cede92fc6034df1}{zadjfshift}}(2)*\mbox{\hyperlink{namespaceglobalc_ac80581d52aeed2500146b56393b24820}{fshift}}(2))}
\DoxyCodeLine{1575 \textcolor{comment}{!    adetXshift = abs(2d0*mm02*detZshift -\/ Zadjfshift(1)*fshift(1) -\/ Zadjfshift(2)*fshift(2))}}
\DoxyCodeLine{1576 \textcolor{comment}{!    maxXadjshift = max(abs(Xadjshift(1,1)),abs(Xadjshift(2,1)),abs(Xadjshift(2,2)))}}
\DoxyCodeLine{1577 }
\DoxyCodeLine{1578       h\_pvs = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{1579       w\_pvs = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{1580       v\_pvs = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{1581       z\_pvs = real(\mbox{\hyperlink{namespaceglobalc_a0d63b4e282ee81cfa71df869ef042686}{undefined\_c}})}
\DoxyCodeLine{1582       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}.lt.dprec\_cll*\mbox{\hyperlink{namespaceglobalc_a5a95c855c3182d83765f2bad05579761}{maxzadjfshift}}.or.\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}.lt.dprec\_cll*\mbox{\hyperlink{namespaceglobalc_ae790b272fa30ed57e592556fa1e22714}{maxzshift}}**2.or.\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}.eq.0d0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1583         use\_pvs = .false.}
\DoxyCodeLine{1584         err\_pvs = err\_inf}
\DoxyCodeLine{1585       \textcolor{keywordflow}{else}}
\DoxyCodeLine{1586         use\_pvs = .true.}
\DoxyCodeLine{1587         err\_pvs(0) = err\_c0}
\DoxyCodeLine{1588         \textcolor{keywordflow}{if} (rdef.gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1589 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{1590 \textcolor{preprocessor}{}          h\_pvs = sqrt(\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}})/\mbox{\hyperlink{namespaceglobalc_a9400f35ae47e801cf5e42790467bd030}{maxzadjshift}}}
\DoxyCodeLine{1591           w\_pvs = max((\mbox{\hyperlink{namespaceglobalc_a5a95c855c3182d83765f2bad05579761}{maxzadjfshift}}*h\_pvs/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}})**2, abs(\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}})*\mbox{\hyperlink{namespaceglobalc_ae790b272fa30ed57e592556fa1e22714}{maxzshift}}*h\_pv/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}},  \&}
\DoxyCodeLine{1592               \mbox{\hyperlink{namespaceglobalc_ada46a2845917d83ee02ea5754b33fe08}{azadjffshift}}*\mbox{\hyperlink{namespaceglobalc_ae790b272fa30ed57e592556fa1e22714}{maxzshift}}*(h\_pvs/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}})**2)}
\DoxyCodeLine{1593           v\_pvs = \mbox{\hyperlink{namespaceglobalc_a5a95c855c3182d83765f2bad05579761}{maxzadjfshift}}*h\_pvs/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}}
\DoxyCodeLine{1594           z\_pvs = \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*h\_pvs/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}}
\DoxyCodeLine{1595 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1596 \textcolor{preprocessor}{}          w\_pvs = max((\mbox{\hyperlink{namespaceglobalc_a5a95c855c3182d83765f2bad05579761}{maxzadjfshift}}/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}})**2, abs(\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}})*\mbox{\hyperlink{namespaceglobalc_ae790b272fa30ed57e592556fa1e22714}{maxzshift}}/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}},   \&}
\DoxyCodeLine{1597               \mbox{\hyperlink{namespaceglobalc_ae790b272fa30ed57e592556fa1e22714}{maxzshift}}*\mbox{\hyperlink{namespaceglobalc_ada46a2845917d83ee02ea5754b33fe08}{azadjffshift}}/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}**2)}
\DoxyCodeLine{1598           v\_pvs = \mbox{\hyperlink{namespaceglobalc_a5a95c855c3182d83765f2bad05579761}{maxzadjfshift}}/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}}
\DoxyCodeLine{1599           z\_pvs = \mbox{\hyperlink{namespaceglobalc_ae790b272fa30ed57e592556fa1e22714}{maxzshift}}/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}}
\DoxyCodeLine{1600 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1601 \textcolor{preprocessor}{}}
\DoxyCodeLine{1602 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1603 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred w\_pvs'},(\mbox{\hyperlink{namespaceglobalc_a5a95c855c3182d83765f2bad05579761}{maxzadjfshift}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}})**2, abs(\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}})*\mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}, \mbox{\hyperlink{namespaceglobalc_ac6a4b54d3e56387c17dfe649a9829d42}{maxz}}*\mbox{\hyperlink{namespaceglobalc_ada46a2845917d83ee02ea5754b33fe08}{azadjffshift}}/\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}**2}
\DoxyCodeLine{1604           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred w\_pvs'},w\_pvs,v\_pvs,z\_pv,h\_pv}
\DoxyCodeLine{1605 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1606 \textcolor{preprocessor}{}}
\DoxyCodeLine{1607           \textcolor{keywordflow}{if} (mod(rdef,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1608             err\_pvs(rdef) = max( w\_pvs**((rdef-\/1)/2) * v\_pvs * err\_c0,  \&}
\DoxyCodeLine{1609                 max(w\_pvs**((rdef-\/1)/2),1d0) * z\_pv * err\_b )}
\DoxyCodeLine{1610             }
\DoxyCodeLine{1611 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1612 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred err\_pvs'}, w\_pvs**((rdef-\/1)/2)* v\_pvs* err\_c0, \&}
\DoxyCodeLine{1613                 w\_pvs**((rdef-\/1)/2) * z\_pv * err\_b, err\_c0,err\_b}
\DoxyCodeLine{1614             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred err\_pvs'}, w\_pvs**((rdef-\/1)/2),v\_pvs, err\_c0}
\DoxyCodeLine{1615 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1616 \textcolor{preprocessor}{}            }
\DoxyCodeLine{1617           \textcolor{keywordflow}{else}}
\DoxyCodeLine{1618             err\_pvs(rdef) = max( w\_pvs**(rdef/2) * err\_c0,  \&}
\DoxyCodeLine{1619                 max(w\_pvs**(rdef/2-\/1) * v\_pvs, 1d0) * z\_pv * err\_b )}
\DoxyCodeLine{1620             }
\DoxyCodeLine{1621 \textcolor{preprocessor}{\#ifdef Credtest      }}
\DoxyCodeLine{1622 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred w\_pvs'}, w\_pvs,err\_c0,sqrt(w\_pvs)}
\DoxyCodeLine{1623             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred w\_pvs'}, (\mbox{\hyperlink{namespaceglobalc_a5a95c855c3182d83765f2bad05579761}{maxzadjfshift}}/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}})**2,  \&}
\DoxyCodeLine{1624                 abs(\mbox{\hyperlink{namespaceglobalc_aea5440d6102711fa4cfb735511345916}{mm02shift}})*\mbox{\hyperlink{namespaceglobalc_ae790b272fa30ed57e592556fa1e22714}{maxzshift}}/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}, \mbox{\hyperlink{namespaceglobalc_ae790b272fa30ed57e592556fa1e22714}{maxzshift}}*\mbox{\hyperlink{namespaceglobalc_ada46a2845917d83ee02ea5754b33fe08}{azadjffshift}}/\mbox{\hyperlink{namespaceglobalc_a8402b4d6c384453e3079a6b6524d64fe}{adetzshift}}**2}
\DoxyCodeLine{1625             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred err\_pvs'}, w\_pvs**(rdef/2) * err\_c0, \&}
\DoxyCodeLine{1626                 w\_pvs**(rdef/2-\/1) * v\_pvs * z\_pv * err\_b, z\_pv * err\_b, err\_c0,err\_b}
\DoxyCodeLine{1627 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1628 \textcolor{preprocessor}{}            }
\DoxyCodeLine{1629 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1630 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1631 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1632 }
\DoxyCodeLine{1633 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1634 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred use\_pvs'},use\_pvs,err\_pvs(rdef).lt.err\_pv(rdef),i}
\DoxyCodeLine{1635       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred err\_pvs'},err\_pvs(rdef),err\_pv(rdef),i      }
\DoxyCodeLine{1636 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1637 \textcolor{preprocessor}{}}
\DoxyCodeLine{1638       \textcolor{keywordflow}{if}(use\_pvs.and.err\_pvs(rdef).lt. min(err\_pv(rdef),err\_pv2(rdef),err\_g(rdef)  \&}
\DoxyCodeLine{1639         ,err\_gy(rdef),err\_gp(rdef),err\_gr(rdef),err\_gpf(rdef)) ) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1640 }
\DoxyCodeLine{1641 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1642 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: call Cpvs 1 '},rmax,id,err\_pvs(rdef)}
\DoxyCodeLine{1643 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1644 \textcolor{preprocessor}{}}
\DoxyCodeLine{1645         \textcolor{comment}{! use shifted PV-\/reduction}}
\DoxyCodeLine{1646         \textcolor{keywordflow}{if} (i.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1647           \textcolor{keyword}{call }calccpvshift(c\_alt,cuv,p10,p20,p21,m12,m02,m22,rmax,id,cerr1\_alt,cerr2\_alt)}
\DoxyCodeLine{1648 \textcolor{comment}{! map coefficients back, order of calculation matters!}}
\DoxyCodeLine{1649           \textcolor{keywordflow}{do} r=1,rmax}
\DoxyCodeLine{1650             \textcolor{keywordflow}{do} n2=0,rmax-\/r}
\DoxyCodeLine{1651               \textcolor{keywordflow}{do} n1=rmax-\/n2,r,-\/1}
\DoxyCodeLine{1652                 n0 = rmax-\/n1-\/n2}
\DoxyCodeLine{1653 \textcolor{comment}{!                write(*,*) 'pvs2',n0,n1,n2,-\/C\_alt(0:n0,n1-\/1,n2),-\/C\_alt(0:n0,n1,n2),-\/C\_alt(0:n0,n1-\/1,n2+1)}}
\DoxyCodeLine{1654                 c\_alt(0:n0,n1,n2) = -\/c\_alt(0:n0,n1-\/1,n2)-\/c\_alt(0:n0,n1,n2)-\/c\_alt(0:n0,n1-\/1,n2+1)}
\DoxyCodeLine{1655 \textcolor{comment}{!                write(*,*) 'pvs2',n0,n1,n2,C\_alt(0:n0,n1,n2)}}
\DoxyCodeLine{1656 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{1657 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{1658 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{1659 }
\DoxyCodeLine{1660         \textcolor{keywordflow}{elseif} (i.eq.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1661           \textcolor{keyword}{call }calccpvshift(c\_alt,cuv,p21,p10,p20,m22,m12,m02,rmax,id,cerr1\_alt,cerr2\_alt)}
\DoxyCodeLine{1662 }
\DoxyCodeLine{1663           \textcolor{keywordflow}{do} r=1,rmax}
\DoxyCodeLine{1664             \textcolor{keywordflow}{do} n1=0,rmax-\/r}
\DoxyCodeLine{1665               \textcolor{keywordflow}{do} n2=rmax-\/n1,r,-\/1}
\DoxyCodeLine{1666                 n0 = rmax-\/n1-\/n2}
\DoxyCodeLine{1667                 c\_alt(0:n0,n1,n2) = -\/c\_alt(0:n0,n1,n2-\/1)-\/c\_alt(0:n0,n1,n2)-\/c\_alt(0:n0,n1+1,n2-\/1)}
\DoxyCodeLine{1668 \textcolor{comment}{!                write(*,*) 'pvs2',n0,n1,n2,C\_alt(0:n0,n1,n2),-\/C\_alt(0:n0,n1,n2-\/1),-\/C\_alt(0:n0,n1,n2),-\/C\_alt(0:n0,n1+1,n2-\/1)}}
\DoxyCodeLine{1669 \textcolor{keywordflow}{              end do}}
\DoxyCodeLine{1670 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{1671 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{1672 }
\DoxyCodeLine{1673 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1674 }
\DoxyCodeLine{1675 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{1676 \textcolor{preprocessor}{}        cerr\_alt = cerr2\_alt}
\DoxyCodeLine{1677 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1678 \textcolor{preprocessor}{}        cerr\_alt = cerr1\_alt}
\DoxyCodeLine{1679 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1680 \textcolor{preprocessor}{}        ccount(9) = ccount(9)+1}
\DoxyCodeLine{1681 \textcolor{comment}{!        CrCalc(0:rmax)=CrCalc(0:rmax)+1}}
\DoxyCodeLine{1682 \textcolor{comment}{!        CCalc=CCalc+1}}
\DoxyCodeLine{1683         crmethod\_alt(0:rmax)=1}
\DoxyCodeLine{1684         \textcolor{keywordflow}{if} (cerr\_alt(rmax).lt.cerr(rmax)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1685            ccount(8) = ccount(8)+1}
\DoxyCodeLine{1686 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1687 }
\DoxyCodeLine{1688 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1689 \textcolor{preprocessor}{}        checkest=cerr\_alt(rdef)/err\_pvs(rdef)}
\DoxyCodeLine{1690         \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_c.or.checkest.lt.1d-\/2*impest\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1691           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: estimate err\_pvs imprecise '},err\_pvs(rdef),cerr\_alt(rdef)}
\DoxyCodeLine{1692 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1693 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1694 \textcolor{preprocessor}{}}
\DoxyCodeLine{1695         err\_pvs=cerr\_alt}
\DoxyCodeLine{1696 }
\DoxyCodeLine{1697         \textcolor{keyword}{call }copycimp3(c,c\_alt,cerr,cerr\_alt,cerr1,cerr1\_alt,cerr2,cerr2\_alt,crmethod,crmethod\_alt,rmax,rmax)}
\DoxyCodeLine{1698 }
\DoxyCodeLine{1699         \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1700           ctyp =  max(abs(c(0,0,0)),abs(c(0,1,0)),abs(c(0,0,1)))}
\DoxyCodeLine{1701         \textcolor{keywordflow}{else}}
\DoxyCodeLine{1702           ctyp =  abs(c(0,0,0))}
\DoxyCodeLine{1703 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1704         err\_req\_cr = acc\_req\_cr * ctyp}
\DoxyCodeLine{1705       }
\DoxyCodeLine{1706 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1707 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred C0est after PVS='},abs(c(0,0,0)),ctyp}
\DoxyCodeLine{1708         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cerr after PVS ='},cerr}
\DoxyCodeLine{1709         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cacc after PVS ='},cerr/ctyp}
\DoxyCodeLine{1710         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred err\_req ='},err\_req\_cr}
\DoxyCodeLine{1711         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred Cerr1-\/req='},cerr1-\/err\_req\_cr}
\DoxyCodeLine{1712         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred max(Cerr-\/req)'},maxval(cerr-\/err\_req\_cr)}
\DoxyCodeLine{1713         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred max(Cerr1-\/req)'},maxval(cerr1-\/err\_req\_cr)}
\DoxyCodeLine{1714 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1715 \textcolor{preprocessor}{}}
\DoxyCodeLine{1716 \textcolor{comment}{! check with Cerr = Cerr2: exp not tried => larger errors}}
\DoxyCodeLine{1717         \textcolor{keywordflow}{if} (maxval(cerr1-\/err\_req\_cr).lt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1718           ccount(ccalc+ccountoffset0) = ccount(ccalc+ccountoffset0)+1}
\DoxyCodeLine{1719           \textcolor{keywordflow}{return}}
\DoxyCodeLine{1720 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1721 }
\DoxyCodeLine{1722 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1723 \textcolor{keywordflow}{    end do} shiftloop}
\DoxyCodeLine{1724 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1725 \textcolor{preprocessor}{}}
\DoxyCodeLine{1726 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1727 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred no optimal method aft shift'},ctyp,acc\_req\_cr}
\DoxyCodeLine{1728     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'err\_req='},err\_req\_cr(rdef),rdef}
\DoxyCodeLine{1729     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'err\_est='},err\_pv(rdef),err\_pv2(rdef),err\_g(rdef)  \&}
\DoxyCodeLine{1730         ,err\_gy(rdef),err\_gp(rdef),err\_gr(rdef),err\_gpf(rdef)}
\DoxyCodeLine{1731 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1732 \textcolor{preprocessor}{}}
\DoxyCodeLine{1733 \textcolor{preprocessor}{\#ifdef TEST}}
\DoxyCodeLine{1734 \textcolor{preprocessor}{}    \textcolor{keywordflow}{return}      \textcolor{comment}{!  TEST: no improvement by other methods}}
\DoxyCodeLine{1735 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1736 \textcolor{preprocessor}{}}
\DoxyCodeLine{1737     \textcolor{comment}{! no method does work optimal}}
\DoxyCodeLine{1738     \textcolor{comment}{! use the least problematic (for each rank)}}
\DoxyCodeLine{1739 }
\DoxyCodeLine{1740     \textcolor{keywordflow}{do} r=rmax,0,-\/1}
\DoxyCodeLine{1741      }
\DoxyCodeLine{1742 }
\DoxyCodeLine{1743       \textcolor{keywordflow}{if}(use\_pv.and.mod(crcalc(r),2).ne.1) \textcolor{keywordflow}{then}   }
\DoxyCodeLine{1744     \textcolor{comment}{! estimate accuracy of PV-\/reduction if not yet calculated}}
\DoxyCodeLine{1745         \textcolor{keywordflow}{if} (use\_pv) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1746 }
\DoxyCodeLine{1747 \textcolor{comment}{!          write(*,*) 'CalcCred err\_pv',  r,w\_pv,v\_pv,z\_pv,err\_C0,err\_B}}
\DoxyCodeLine{1748 }
\DoxyCodeLine{1749           \textcolor{keywordflow}{if} (mod(r,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1750             err\_pv(r) = max( w\_pv**((r-\/1)/2) * v\_pv * err\_c0,  \&}
\DoxyCodeLine{1751                 max(w\_pv**((r-\/1)/2),1d0) * z\_pv * err\_b )}
\DoxyCodeLine{1752 }
\DoxyCodeLine{1753 \textcolor{comment}{!          write(*,*) 'CalcCred err\_pv',  w\_pv**((r-\/1)/2) * v\_pv * err\_C0,  \&}}
\DoxyCodeLine{1754 \textcolor{comment}{!                w\_pv**((r-\/1)/2) * z\_pv * err\_B, err\_C0,err\_B}}
\DoxyCodeLine{1755 }
\DoxyCodeLine{1756           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (r.ne.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1757             err\_pv(r) = max( w\_pv**(r/2) * err\_c0,  \&}
\DoxyCodeLine{1758                 max(w\_pv**(r/2-\/1) * v\_pv , 1d0) * z\_pv * err\_b )}
\DoxyCodeLine{1759                 }
\DoxyCodeLine{1760 \textcolor{comment}{!          write(*,*) 'CalcCred err\_pv', w\_pv**(rmax/2) * err\_C0, \&}}
\DoxyCodeLine{1761 \textcolor{comment}{!                        w\_pv**(rmax/2-\/1) * v\_pv * z\_pv * err\_B, err\_C0,err\_B}}
\DoxyCodeLine{1762           \textcolor{keywordflow}{else}}
\DoxyCodeLine{1763             err\_pv(r) = err\_c0}
\DoxyCodeLine{1764 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1765         \textcolor{keywordflow}{else}}
\DoxyCodeLine{1766           err\_pv(r) = err\_inf}
\DoxyCodeLine{1767 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1768       \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{1769         err\_pv(r)  = err\_pv(r)/impest\_c}
\DoxyCodeLine{1770 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1771 }
\DoxyCodeLine{1772       \textcolor{keywordflow}{if} (use\_pv2.and.mod(crcalc(r),4)-\/mod(crcalc(r),2).ne.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1773     \textcolor{comment}{! estimate accuracy of alternative PV-\/reduction if not yet calculated}}
\DoxyCodeLine{1774         \textcolor{keywordflow}{if} (use\_pv2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1775           \textcolor{keywordflow}{if} (mod(r,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1776 \textcolor{comment}{! change 21.10.15 for PVEST2}}
\DoxyCodeLine{1777 \textcolor{comment}{!            err\_pv2(r) = max( err\_C0 * max(w\_pv2**r,w\_pv2*v\_pv2**((r-\/1)/2) ),  \&}}
\DoxyCodeLine{1778 \textcolor{comment}{!                err\_B * z\_pv2 * max(w\_pv2**(r+1),w\_pv2, \&}}
\DoxyCodeLine{1779 \textcolor{comment}{!                                    w\_pv2*v\_pv2**((r-\/1)/2),w\_pv2**2, \& }}
\DoxyCodeLine{1780 \textcolor{comment}{!                                    v\_pv2**((r+1)/2),v\_pv2) )}}
\DoxyCodeLine{1781             err\_pv2(r) = max( err\_c0 * max(hw\_pv2**r,hw\_pv2*v\_pv2**((r-\/1)/2) ),  \&}
\DoxyCodeLine{1782                 err\_b * z\_pv2 * max(w\_pv2*hw\_pv2**(r),hw\_pv2, \&}
\DoxyCodeLine{1783                                     hw\_pv2*v\_pv2**((r-\/1)/2),w\_pv2*hw\_pv2, \& }
\DoxyCodeLine{1784                                     w\_pv2*hw\_pv2*v\_pv2**((r-\/1)/2), \& }
\DoxyCodeLine{1785                                     v\_pv2**((r+1)/2),v\_pv2) )}
\DoxyCodeLine{1786 }
\DoxyCodeLine{1787 \textcolor{comment}{!            write(*,*) 'CalcC err\_pv2 ',r, err\_pv2(r), \&}}
\DoxyCodeLine{1788 \textcolor{comment}{!                 err\_C0 * max(1d0,w\_pv2**r,v\_pv2**((r-\/1)/2),w\_pv2*v\_pv2**((r-\/1)/2) )  ,  \&}}
\DoxyCodeLine{1789 \textcolor{comment}{!                 err\_B * max(1d0,z\_pv2*w\_pv2**(r+1),z\_pv2*w\_pv2, \&}}
\DoxyCodeLine{1790 \textcolor{comment}{!                z\_pv2*w\_pv2*v\_pv2**((r-\/1)/2),z\_pv2*w\_pv2**2, \& }}
\DoxyCodeLine{1791 \textcolor{comment}{!                z\_pv2*v\_pv2**((r+1)/2),z\_pv2*v\_pv2)}}
\DoxyCodeLine{1792 }
\DoxyCodeLine{1793           \textcolor{keywordflow}{else}}
\DoxyCodeLine{1794 \textcolor{comment}{! change 21.10.15 for PVEST2}}
\DoxyCodeLine{1795 \textcolor{comment}{!            err\_pv2(r) = max( err\_C0 * max(w\_pv2**r,v\_pv2**(r/2)),  \&}}
\DoxyCodeLine{1796 \textcolor{comment}{!                err\_B * z\_pv2 * max(w\_pv2**(r+1),w\_pv2,  \&}}
\DoxyCodeLine{1797 \textcolor{comment}{!                                    w\_pv2*v\_pv2**(r/2), w\_pv2**2,  \&}}
\DoxyCodeLine{1798 \textcolor{comment}{!                                    v\_pv2**(r/2),v\_pv2) )}}
\DoxyCodeLine{1799             err\_pv2(r) = max( err\_c0 * max(hw\_pv2**r,v\_pv2**(r/2)),  \&}
\DoxyCodeLine{1800                 err\_b * z\_pv2 * max(w\_pv2*hw\_pv2**(r),hw\_pv2,  \&}
\DoxyCodeLine{1801                                     hw\_pv2*v\_pv2**(r/2), w\_pv2*hw\_pv2,  \&}
\DoxyCodeLine{1802                                     v\_pv2**(r/2),v\_pv2) )}
\DoxyCodeLine{1803 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1804         \textcolor{keywordflow}{else}}
\DoxyCodeLine{1805           err\_pv2(r) = err\_inf}
\DoxyCodeLine{1806 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{1807       \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{1808         err\_pv2(r) = err\_pv2(r)/impest\_c     }
\DoxyCodeLine{1809 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1810 }
\DoxyCodeLine{1811       \textcolor{keywordflow}{if} (use\_g.and.mod(crcalc(r),8)-\/mod(crcalc(r),4).ne.4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1812       \textcolor{comment}{! estimate accuracy of alternative Gram expansion if not yet calculated}}
\DoxyCodeLine{1813         err\_g\_b(r) = err\_b * u\_g**r * z\_g}
\DoxyCodeLine{1814         err\_g\_exp = u\_g**(r-\/1) * ctyp}
\DoxyCodeLine{1815         err\_g(r) = err\_inf }
\DoxyCodeLine{1816 }
\DoxyCodeLine{1817       \textcolor{comment}{! determine optimal order of expansion }}
\DoxyCodeLine{1818         \textcolor{keywordflow}{do} i=0,rmax\_c-\/r}
\DoxyCodeLine{1819           g = i}
\DoxyCodeLine{1820           err\_g\_exp = err\_g\_exp*\mbox{\hyperlink{namespaceglobalc_a30966c786fe9cbb2a5eabd43912a2928}{fac\_g}}}
\DoxyCodeLine{1821           err\_g(r) = max(err\_g\_exp,err\_g\_b(r))}
\DoxyCodeLine{1822 }
\DoxyCodeLine{1823 \textcolor{comment}{!          write(*,*) 'CalcCred gi',i,g,err\_g\_exp,err\_g(r),err\_g\_B(r),err\_req\_Cr(r)}}
\DoxyCodeLine{1824 }
\DoxyCodeLine{1825           \textcolor{keywordflow}{if} (err\_g\_exp.lt.err\_g\_b(r).or.err\_g(r).lt.err\_req\_cr(r)) \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1826 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1827       \textcolor{comment}{! increase gp by 2 to account for bad estimates}}
\DoxyCodeLine{1828         g = min(max(g+2,2*g),rmax\_c-\/r)}
\DoxyCodeLine{1829       \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{1830         err\_g(r)  =  err\_g(r)/impest\_c}
\DoxyCodeLine{1831 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1832 }
\DoxyCodeLine{1833       \textcolor{keywordflow}{if} (use\_gy.and.mod(crcalc(r),16)-\/mod(crcalc(r),8).ne.8) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1834       \textcolor{comment}{! estimate accuracy of alternative Gram-\/Cayley expansion if not yet calculated}}
\DoxyCodeLine{1835         err\_gy\_b(r) = err\_b * b\_gy*v1\_gy}
\DoxyCodeLine{1836         err\_gy\_exp = 1d0 * ctyp}
\DoxyCodeLine{1837 }
\DoxyCodeLine{1838       \textcolor{comment}{! determine optimal order of expansion }}
\DoxyCodeLine{1839         gy = 0}
\DoxyCodeLine{1840         \textcolor{keywordflow}{do} i=0,rmax\_c-\/r}
\DoxyCodeLine{1841           \textcolor{keywordflow}{if} (mod(i,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1842             gy = i/2}
\DoxyCodeLine{1843             err\_gy\_exp = err\_gy\_exp*\mbox{\hyperlink{namespaceglobalc_af8b9f920c734a2e3621ada75bc4dc839}{fac\_gy}}}
\DoxyCodeLine{1844             err\_gy(r) = max(err\_gy\_exp, err\_gy\_b(r))}
\DoxyCodeLine{1845             \textcolor{keywordflow}{if} (err\_gy\_exp.lt.err\_gy\_b(r).or.err\_gy(r).lt.err\_req\_cr(r)) \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1846 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1847 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1848       \textcolor{comment}{! increase gy by 2 to account for bad estimates}}
\DoxyCodeLine{1849         gy = min(max(gy+4,2*gy),(rmax\_c-\/r)/2)}
\DoxyCodeLine{1850       \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{1851         err\_gy(r) =  err\_gy(r)/impest\_c     }
\DoxyCodeLine{1852 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1853 }
\DoxyCodeLine{1854       \textcolor{keywordflow}{if} (use\_gp.and.mod(crcalc(r),32)-\/mod(crcalc(r),16).ne.16) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1855       \textcolor{comment}{! estimate accuracy of small momentum expansion if not yet calculated}}
\DoxyCodeLine{1856         err\_gp\_b(r) = err\_b * z\_gp*v\_gp**r}
\DoxyCodeLine{1857         err\_gp\_exp = v\_gp**(r-\/1) * ctyp }
\DoxyCodeLine{1858 }
\DoxyCodeLine{1859       \textcolor{comment}{! determine optimal order of expansion }}
\DoxyCodeLine{1860         \textcolor{keywordflow}{do} i=0,rmax\_c-\/r}
\DoxyCodeLine{1861           gp = i}
\DoxyCodeLine{1862           err\_gp\_exp = err\_gp\_exp*\mbox{\hyperlink{namespaceglobalc_ac6e3d986b3c7aa2041225441a07dddb6}{fac\_gp}}}
\DoxyCodeLine{1863           err\_gp(r) = max(err\_gp\_exp,err\_gp\_b(r))}
\DoxyCodeLine{1864           \textcolor{keywordflow}{if} (err\_gp\_exp.lt.err\_gp\_b(r).or.err\_gp(r).lt.err\_req\_cr(r)) \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1865 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1866       \textcolor{comment}{! increase gp by 2 to account for bad estimates}}
\DoxyCodeLine{1867         gp = min(max(gp+2,2*gp),rmax\_c-\/r)}
\DoxyCodeLine{1868       \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{1869         err\_gp(r) =  err\_gp(r)/impest\_c}
\DoxyCodeLine{1870 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1871 }
\DoxyCodeLine{1872       \textcolor{keywordflow}{if} (mod(crcalc(r),64)-\/mod(crcalc(r),32).ne.32.and.use\_gr) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1873       \textcolor{comment}{! estimate accuracy of alternative Gram expansion}}
\DoxyCodeLine{1874         err\_gr\_b(r) = err\_b * a\_gr}
\DoxyCodeLine{1875         err\_gr\_exp = y1\_gr * ctyp}
\DoxyCodeLine{1876 }
\DoxyCodeLine{1877       \textcolor{comment}{! determine optimal order of expansion }}
\DoxyCodeLine{1878         gr = 0}
\DoxyCodeLine{1879         \textcolor{keywordflow}{do} i=0,rmax\_c-\/r}
\DoxyCodeLine{1880           \textcolor{keywordflow}{if} (mod(i,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1881             gr = i/2}
\DoxyCodeLine{1882             err\_gr\_exp = err\_gr\_exp*\mbox{\hyperlink{namespaceglobalc_ad97cba305edc50dc94d779ef3de039dc}{fac\_gr}}}
\DoxyCodeLine{1883             err\_gr(r) = max(err\_gr\_exp,err\_gr\_b(r))}
\DoxyCodeLine{1884 }
\DoxyCodeLine{1885 \textcolor{preprocessor}{\#ifdef Cgrtest}}
\DoxyCodeLine{1886 \textcolor{preprocessor}{}            \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCgr err\_gr'},i,gr,err\_gr\_exp,err\_gr\_b(r),err\_gr(r),err\_req\_cr(r)}
\DoxyCodeLine{1887 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1888 \textcolor{preprocessor}{}}
\DoxyCodeLine{1889             \textcolor{keywordflow}{if} (err\_gr\_exp.lt.err\_gr\_b(r).or.err\_gr(r).lt.err\_req\_cr(r)) \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1890 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1891 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1892       \textcolor{comment}{! increase gr to account for bad estimates}}
\DoxyCodeLine{1893 \textcolor{comment}{! changed 28.07.14}}
\DoxyCodeLine{1894 \textcolor{comment}{!       gr = min(max(gr+2,2*gr),(rmax\_C-\/r)/2)}}
\DoxyCodeLine{1895         gr = min(max(gr+2,2*gr),rmax\_c-\/r,max(0,(rmax\_b-\/2*r)/2))}
\DoxyCodeLine{1896       \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{1897         err\_gr(r) =  err\_gr(r)/impest\_c     }
\DoxyCodeLine{1898 }
\DoxyCodeLine{1899 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1900 }
\DoxyCodeLine{1901       \textcolor{keywordflow}{if} (use\_gpf.and.mod(crcalc(r),128)-\/mod(crcalc(r),64).ne.64) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1902       \textcolor{comment}{! estimate accuracy of alternative Gram-\/Cayley expansion if not yet calculated}}
\DoxyCodeLine{1903         err\_gpf\_b(r) = err\_b * b\_gpf*v1\_gpf}
\DoxyCodeLine{1904         err\_gpf\_exp = 1d0 * ctyp}
\DoxyCodeLine{1905 }
\DoxyCodeLine{1906       \textcolor{comment}{! determine optimal order of expansion }}
\DoxyCodeLine{1907         gpf = 0}
\DoxyCodeLine{1908         \textcolor{keywordflow}{do} i=0,rmax\_c-\/r}
\DoxyCodeLine{1909           \textcolor{keywordflow}{if} (mod(i,2).eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1910             gpf = i/2}
\DoxyCodeLine{1911             err\_gpf\_exp = err\_gpf\_exp*\mbox{\hyperlink{namespaceglobalc_a92c2feddeb644af9e797691976e9143b}{fac\_gpf}}}
\DoxyCodeLine{1912             err\_gpf(r) = max(err\_gpf\_exp, err\_gpf\_b(r))}
\DoxyCodeLine{1913             \textcolor{keywordflow}{if} (err\_gpf\_exp.lt.err\_gpf\_b(r).or.err\_gpf(r).lt.err\_req\_cr(r)) \textcolor{keywordflow}{exit}}
\DoxyCodeLine{1914 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1915 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{1916       \textcolor{comment}{! increase gpf by 2 to account for bad estimates}}
\DoxyCodeLine{1917         gpf = min(max(gpf+4,2*gpf),(rmax\_c-\/r)/2)}
\DoxyCodeLine{1918       \textcolor{comment}{! scale estimates down to allow trying other methods}}
\DoxyCodeLine{1919         err\_gpf(r) =  err\_gpf(r)/impest\_c     }
\DoxyCodeLine{1920 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{1921 }
\DoxyCodeLine{1922 }
\DoxyCodeLine{1923 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1924 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: bef final loop expansion depth'},r,g,gy,gp,gr,gpf}
\DoxyCodeLine{1925       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: bef final loop err methods'},r,err\_pv(r),err\_pv2(r)   \&}
\DoxyCodeLine{1926           ,err\_g(r),err\_gy(r),err\_gp(r),err\_gr(r),err\_gp(r),err\_gpf(r)}
\DoxyCodeLine{1927       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: bef final loop acc methods'},r,err\_pv(r)/ctyp,err\_pv2(r)/ctyp,    \&}
\DoxyCodeLine{1928              err\_g(r)/ctyp,err\_gy(r)/ctyp,err\_gp(r)/ctyp,err\_gr(r)/ctyp,err\_gpf(r)/ctyp}
\DoxyCodeLine{1929       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: bef final loop'},r,crcalc(r),crmethod(r)}
\DoxyCodeLine{1930 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1931 \textcolor{preprocessor}{}}
\DoxyCodeLine{1932 100   \textcolor{keywordflow}{continue}   \textcolor{comment}{! try other methods if error larger than expected}}
\DoxyCodeLine{1933 }
\DoxyCodeLine{1934       \textcolor{keywordflow}{if} (min(err\_pv(r),err\_pv2(r)).le.min(err\_g(r),err\_gy(r),err\_gp(r),err\_gr(r),err\_gpf(r))       \&}
\DoxyCodeLine{1935           .and.min(err\_pv(r),err\_pv2(r)).lt.err\_inf) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1936 }
\DoxyCodeLine{1937         \textcolor{keywordflow}{if} (use\_pv.and.err\_pv(r).le.err\_pv2(r).and.mod(crcalc(r),2).ne.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1938 }
\DoxyCodeLine{1939 \textcolor{comment}{!          deallocate(C\_alt)}}
\DoxyCodeLine{1940 \textcolor{comment}{!          deallocate(Cuv\_alt)}}
\DoxyCodeLine{1941 \textcolor{comment}{!          deallocate(Cerr\_alt)}}
\DoxyCodeLine{1942 \textcolor{comment}{!          deallocate(Cerr2\_alt)}}
\DoxyCodeLine{1943 \textcolor{comment}{!          deallocate(Crmethod\_alt)}}
\DoxyCodeLine{1944 \textcolor{comment}{!          allocate(C\_alt(0:r,0:r,0:r))}}
\DoxyCodeLine{1945 \textcolor{comment}{!          allocate(Cuv\_alt(0:r,0:r,0:r))}}
\DoxyCodeLine{1946 \textcolor{comment}{!          allocate(Cerr\_alt(0:r))}}
\DoxyCodeLine{1947 \textcolor{comment}{!          allocate(Cerr2\_alt(0:r))}}
\DoxyCodeLine{1948 \textcolor{comment}{!          allocate(Crmethod\_alt(0:r))}}
\DoxyCodeLine{1949 }
\DoxyCodeLine{1950 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1951 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: call Cpv 2'},r,id}
\DoxyCodeLine{1952 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1953 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if} (r.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1954             \textcolor{keyword}{call }calccpv1(c\_alt,cuv,p10,p21,p20,m02,m12,m22,r,id,cerr1\_alt,cerr2\_alt)}
\DoxyCodeLine{1955           \textcolor{keywordflow}{else}}
\DoxyCodeLine{1956             \textcolor{keyword}{call }calccpv1(c\_alt(0:r,0:r,0:r),cuv\_alt(0:r,0:r,0:r),  \&}
\DoxyCodeLine{1957                 p10,p21,p20,m02,m12,m22,r,id,cerr1\_alt(0:r),cerr2\_alt(0:r))}
\DoxyCodeLine{1958 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1959 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{1960 \textcolor{preprocessor}{}          cerr\_alt = cerr2\_alt}
\DoxyCodeLine{1961 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1962 \textcolor{preprocessor}{}          cerr\_alt = cerr1\_alt}
\DoxyCodeLine{1963 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1964 \textcolor{preprocessor}{}          ccount(11) = ccount(11)+1}
\DoxyCodeLine{1965           crcalc(0:r)=crcalc(0:r)+1}
\DoxyCodeLine{1966           ccalc=ccalc+1}
\DoxyCodeLine{1967           crmethod\_alt(0:r)=1}
\DoxyCodeLine{1968           checkest=cerr\_alt(r)/(err\_pv(r)*abs(c\_alt(0,0,0)))}
\DoxyCodeLine{1969           }
\DoxyCodeLine{1970 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1971 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_c.or.checkest.lt.1d-\/2*impest\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1972             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: estimate acc\_pv imprecise'},err\_pv(r),cerr\_alt(r)/abs(c\_alt(0,0,0))}
\DoxyCodeLine{1973 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1974 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1975 \textcolor{preprocessor}{}}
\DoxyCodeLine{1976           err\_pv(0:r)=cerr\_alt(0:r)}
\DoxyCodeLine{1977 }
\DoxyCodeLine{1978           \textcolor{keyword}{call }copycimp3(c,c\_alt(0:r,0:r,0:r),cerr,cerr\_alt(0:r),cerr1,cerr1\_alt(0:r),   \&   }
\DoxyCodeLine{1979               cerr2,cerr2\_alt(0:r),crmethod,crmethod\_alt(0:r),rmax,r)}
\DoxyCodeLine{1980 }
\DoxyCodeLine{1981           \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1982             ctyp =  max(abs(c(0,0,0)),abs(c(0,1,0)),abs(c(0,0,1)))}
\DoxyCodeLine{1983           \textcolor{keywordflow}{else}}
\DoxyCodeLine{1984             ctyp =  abs(c(0,0,0))}
\DoxyCodeLine{1985 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{1986           err\_req\_cr = acc\_req\_cr * ctyp}
\DoxyCodeLine{1987 }
\DoxyCodeLine{1988 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{1989 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after pv 2nd try Cmethod'},crmethod}
\DoxyCodeLine{1990           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after pv 2nd try Cerr(r)'},cerr}
\DoxyCodeLine{1991           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after pv 2nd try Cacc(r)'},cerr/ctyp}
\DoxyCodeLine{1992 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1993 \textcolor{preprocessor}{}}
\DoxyCodeLine{1994           \textcolor{keywordflow}{if}(checkest.gt.impest\_c.and.mode\_coli.lt.1) \textcolor{keywordflow}{goto} 100     \textcolor{comment}{! error larger than expected: try other methods}}
\DoxyCodeLine{1995           }
\DoxyCodeLine{1996         \textcolor{keywordflow}{elseif} (use\_pv2.and.err\_pv2(r).le.err\_pv(r).and.mod(crcalc(r),4)-\/mod(crcalc(r),2).ne.2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{1997 }
\DoxyCodeLine{1998 \textcolor{comment}{!          deallocate(C\_alt)}}
\DoxyCodeLine{1999 \textcolor{comment}{!          deallocate(Cuv\_alt)}}
\DoxyCodeLine{2000 \textcolor{comment}{!          deallocate(Cerr\_alt)}}
\DoxyCodeLine{2001 \textcolor{comment}{!          deallocate(Cerr2\_alt)}}
\DoxyCodeLine{2002 \textcolor{comment}{!          deallocate(Crmethod\_alt)}}
\DoxyCodeLine{2003 \textcolor{comment}{!          allocate(C\_alt(0:r,0:r,0:r))}}
\DoxyCodeLine{2004 \textcolor{comment}{!          allocate(Cuv\_alt(0:r,0:r,0:r))}}
\DoxyCodeLine{2005 \textcolor{comment}{!          allocate(Cerr\_alt(0:r))}}
\DoxyCodeLine{2006 \textcolor{comment}{!          allocate(Cerr2\_alt(0:r))}}
\DoxyCodeLine{2007 \textcolor{comment}{!          allocate(Crmethod\_alt(0:r))}}
\DoxyCodeLine{2008 }
\DoxyCodeLine{2009           \textcolor{keywordflow}{if} (r.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2010             \textcolor{keyword}{call }calccpv2(c\_alt,cuv,p10,p21,p20,m02,m12,m22,r,id,cerr1\_alt,cerr2\_alt)}
\DoxyCodeLine{2011           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2012             \textcolor{keyword}{call }calccpv2(c\_alt(0:r,0:r,0:r),cuv\_alt(0:r,0:r,0:r),p10,p21,p20,m02,m12,m22,r,id,cerr1\_alt(0:r),cerr2\_alt(0:r))}
\DoxyCodeLine{2013 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2014 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{2015 \textcolor{preprocessor}{}          cerr\_alt = cerr2\_alt}
\DoxyCodeLine{2016 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2017 \textcolor{preprocessor}{}          cerr\_alt = cerr1\_alt}
\DoxyCodeLine{2018 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2019 \textcolor{preprocessor}{}          ccount(12) = ccount(12)+1}
\DoxyCodeLine{2020           crcalc(0:r)=crcalc(0:r)+2}
\DoxyCodeLine{2021           ccalc=ccalc+2}
\DoxyCodeLine{2022           crmethod\_alt(0:r)=2}
\DoxyCodeLine{2023           checkest=cerr\_alt(r)/(err\_pv(r)*abs(c\_alt(0,0,0)))}
\DoxyCodeLine{2024           }
\DoxyCodeLine{2025 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{2026 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_c.or.checkest.lt.1d-\/2*impest\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2027             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: estimate err\_pv2 imprecise'},err\_pv2(r),cerr\_alt(r)}
\DoxyCodeLine{2028 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2029 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2030 \textcolor{preprocessor}{}}
\DoxyCodeLine{2031           err\_pv2(0:r)=cerr\_alt(0:r)}
\DoxyCodeLine{2032 }
\DoxyCodeLine{2033           \textcolor{keyword}{call }copycimp3(c,c\_alt(0:r,0:r,0:r),cerr,cerr\_alt(0:r),cerr1,cerr1\_alt(0:r),   \&   }
\DoxyCodeLine{2034               cerr2,cerr2\_alt(0:r),crmethod,crmethod\_alt(0:r),rmax,r)}
\DoxyCodeLine{2035 }
\DoxyCodeLine{2036           \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2037             ctyp =  max(abs(c(0,0,0)),abs(c(0,1,0)),abs(c(0,0,1)))}
\DoxyCodeLine{2038           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2039             ctyp =  abs(c(0,0,0))}
\DoxyCodeLine{2040 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2041           err\_req\_cr = acc\_req\_cr * ctyp}
\DoxyCodeLine{2042 }
\DoxyCodeLine{2043 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{2044 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after pv 2nd try Cmethod'},crmethod}
\DoxyCodeLine{2045           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after pv 2nd try Cerr(r)'},cerr}
\DoxyCodeLine{2046           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after pv 2nd try Cacc(r)'},cerr/ctyp}
\DoxyCodeLine{2047 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2048 \textcolor{preprocessor}{}          }
\DoxyCodeLine{2049           \textcolor{keywordflow}{if}(checkest.gt.impest\_c.and.mode\_coli.lt.1) \textcolor{keywordflow}{goto} 100     \textcolor{comment}{! error larger than expected: try other methods}}
\DoxyCodeLine{2050 }
\DoxyCodeLine{2051 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{2052 }
\DoxyCodeLine{2053       \textcolor{keywordflow}{else} }
\DoxyCodeLine{2054 }
\DoxyCodeLine{2055 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{2056 \textcolor{preprocessor}{}        \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: explore exps once more'}}
\DoxyCodeLine{2057 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2058 \textcolor{preprocessor}{}}
\DoxyCodeLine{2059         \textcolor{keywordflow}{if} (use\_g.and.err\_g(r).le.min(err\_gy(r),err\_gp(r),err\_gr(r),err\_gpf(r))        \&}
\DoxyCodeLine{2060             .and.mod(crcalc(r),8)-\/mod(crcalc(r),4).ne.4) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2061 }
\DoxyCodeLine{2062 \textcolor{comment}{!          deallocate(C\_alt)}}
\DoxyCodeLine{2063 \textcolor{comment}{!          deallocate(Cuv\_alt)}}
\DoxyCodeLine{2064 \textcolor{comment}{!          deallocate(Cerr\_alt)}}
\DoxyCodeLine{2065 \textcolor{comment}{!          deallocate(Cerr2\_alt)}}
\DoxyCodeLine{2066 \textcolor{comment}{!          deallocate(Crmethod\_alt)}}
\DoxyCodeLine{2067 \textcolor{comment}{!          allocate(C\_alt(0:r,0:r,0:r))}}
\DoxyCodeLine{2068 \textcolor{comment}{!          allocate(Cuv\_alt(0:r,0:r,0:r))}}
\DoxyCodeLine{2069 \textcolor{comment}{!          allocate(Cerr\_alt(0:r))}}
\DoxyCodeLine{2070 \textcolor{comment}{!          allocate(Cerr2\_alt(0:r))}}
\DoxyCodeLine{2071 \textcolor{comment}{!          allocate(Crmethod\_alt(0:r))}}
\DoxyCodeLine{2072 }
\DoxyCodeLine{2073           \textcolor{keywordflow}{if} (r.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2074             \textcolor{keyword}{call }calccg(c\_alt,cuv,p10,p21,p20,m02,m12,m22,r,g,rmax\_c,id,cerr1\_alt,acc\_req\_cr,cerr2\_alt)}
\DoxyCodeLine{2075           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2076             \textcolor{keyword}{call }calccg(c\_alt(0:r,0:r,0:r),cuv\_alt(0:r,0:r,0:r),   \&}
\DoxyCodeLine{2077                 p10,p21,p20,m02,m12,m22,r,g,rmax\_c,id,cerr1\_alt(0:r),acc\_req\_cr(0:r),cerr2\_alt(0:r))}
\DoxyCodeLine{2078 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2079 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{2080 \textcolor{preprocessor}{}          cerr\_alt = cerr2\_alt}
\DoxyCodeLine{2081 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2082 \textcolor{preprocessor}{}          cerr\_alt = cerr1\_alt}
\DoxyCodeLine{2083 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2084 \textcolor{preprocessor}{}          ccount(13) = ccount(13)+1}
\DoxyCodeLine{2085           crcalc(0:r)=crcalc(0:r)+4}
\DoxyCodeLine{2086           ccalc=ccalc+4}
\DoxyCodeLine{2087           crmethod\_alt(0:r)=4}
\DoxyCodeLine{2088           checkest=cerr\_alt(r)/err\_g(r)}
\DoxyCodeLine{2089 }
\DoxyCodeLine{2090 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{2091 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_c.or.checkest.lt.1d-\/2*impest\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2092             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: estimate err\_g imprecise '},err\_g(r),cerr\_alt(r)}
\DoxyCodeLine{2093 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2094 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2095 \textcolor{preprocessor}{}          }
\DoxyCodeLine{2096           err\_g(0:r)=cerr\_alt(0:r)}
\DoxyCodeLine{2097 }
\DoxyCodeLine{2098           \textcolor{keyword}{call }copycimp3(c,c\_alt(0:r,0:r,0:r),cerr,cerr\_alt(0:r),cerr1,cerr1\_alt(0:r),   \&   }
\DoxyCodeLine{2099               cerr2,cerr2\_alt(0:r),crmethod,crmethod\_alt(0:r),rmax,r)}
\DoxyCodeLine{2100 }
\DoxyCodeLine{2101           \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2102             ctyp =  max(abs(c(0,0,0)),abs(c(0,1,0)),abs(c(0,0,1)))}
\DoxyCodeLine{2103           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2104             ctyp =  abs(c(0,0,0))}
\DoxyCodeLine{2105 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2106           err\_req\_cr = acc\_req\_cr * ctyp}
\DoxyCodeLine{2107 }
\DoxyCodeLine{2108 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{2109 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after exps 2nd try Cmethod'},crmethod}
\DoxyCodeLine{2110           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after exps 2nd try Cerr(r)'},cerr}
\DoxyCodeLine{2111           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after exps 2nd try Cacc(r)'},cerr/ctyp}
\DoxyCodeLine{2112 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2113 \textcolor{preprocessor}{}}
\DoxyCodeLine{2114           \textcolor{keywordflow}{if}(checkest.gt.impest\_c.and.mode\_coli.lt.1) \textcolor{keywordflow}{goto} 100     \textcolor{comment}{! error larger than expected: try other methods}}
\DoxyCodeLine{2115           }
\DoxyCodeLine{2116         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (use\_gy.and.err\_gy(r).le.min(err\_g(r),err\_gp(r),err\_gr(r),err\_gpf(r))        \&}
\DoxyCodeLine{2117             .and.mod(crcalc(r),16)-\/mod(crcalc(r),8).ne.8) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2118 \textcolor{comment}{!          deallocate(C\_alt)}}
\DoxyCodeLine{2119 \textcolor{comment}{!          deallocate(Cuv\_alt)}}
\DoxyCodeLine{2120 \textcolor{comment}{!          deallocate(Cerr\_alt)}}
\DoxyCodeLine{2121 \textcolor{comment}{!          deallocate(Cerr2\_alt)}}
\DoxyCodeLine{2122 \textcolor{comment}{!          deallocate(Crmethod\_alt)}}
\DoxyCodeLine{2123 \textcolor{comment}{!          allocate(C\_alt(0:r,0:r,0:r))}}
\DoxyCodeLine{2124 \textcolor{comment}{!          allocate(Cuv\_alt(0:r,0:r,0:r))}}
\DoxyCodeLine{2125 \textcolor{comment}{!          allocate(Cerr\_alt(0:r))}}
\DoxyCodeLine{2126 \textcolor{comment}{!          allocate(Cerr2\_alt(0:r))}}
\DoxyCodeLine{2127 \textcolor{comment}{!          allocate(Crmethod\_alt(0:r))}}
\DoxyCodeLine{2128 }
\DoxyCodeLine{2129           \textcolor{keywordflow}{if} (r.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2130             \textcolor{keyword}{call }calccgy(c\_alt,cuv,p10,p21,p20,m02,m12,m22,r,gy,(rmax\_c)/2,id,cerr1\_alt,acc\_req\_cr,cerr2\_alt)}
\DoxyCodeLine{2131           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2132             \textcolor{keyword}{call }calccgy(c\_alt(0:r,0:r,0:r),cuv\_alt(0:r,0:r,0:r),  \&}
\DoxyCodeLine{2133                 p10,p21,p20,m02,m12,m22,r,gy,(rmax\_c)/2,id,cerr1\_alt(0:r),acc\_req\_cr(0:r),cerr2\_alt(0:r))}
\DoxyCodeLine{2134 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2135 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{2136 \textcolor{preprocessor}{}          cerr\_alt = cerr2\_alt}
\DoxyCodeLine{2137 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2138 \textcolor{preprocessor}{}          cerr\_alt = cerr1\_alt}
\DoxyCodeLine{2139 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2140 \textcolor{preprocessor}{}          ccount(14) = ccount(14)+1}
\DoxyCodeLine{2141           crcalc(0:r)=crcalc(0:r)+8}
\DoxyCodeLine{2142           ccalc=ccalc+8}
\DoxyCodeLine{2143           crmethod\_alt(0:r)=8}
\DoxyCodeLine{2144           checkest=cerr\_alt(r)/err\_gy(r)}
\DoxyCodeLine{2145 }
\DoxyCodeLine{2146 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{2147 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_c.or.checkest.lt.1d-\/2*impest\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2148             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: estimate err\_gy imprecise'},err\_gy(r),cerr\_alt(r)}
\DoxyCodeLine{2149 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2150 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2151 \textcolor{preprocessor}{}          err\_gy(0:r)=cerr\_alt(0:r)}
\DoxyCodeLine{2152           }
\DoxyCodeLine{2153           \textcolor{keyword}{call }copycimp3(c,c\_alt(0:r,0:r,0:r),cerr,cerr\_alt(0:r),cerr1,cerr1\_alt(0:r),   \&   }
\DoxyCodeLine{2154               cerr2,cerr2\_alt(0:r),crmethod,crmethod\_alt(0:r),rmax,r)}
\DoxyCodeLine{2155   }
\DoxyCodeLine{2156           \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2157             ctyp =  max(abs(c(0,0,0)),abs(c(0,1,0)),abs(c(0,0,1)))}
\DoxyCodeLine{2158           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2159             ctyp =  abs(c(0,0,0))}
\DoxyCodeLine{2160 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2161           err\_req\_cr = acc\_req\_cr * ctyp}
\DoxyCodeLine{2162 }
\DoxyCodeLine{2163 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{2164 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after exps 2nd try Cmethod'},crmethod}
\DoxyCodeLine{2165           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after exps 2nd try Cerr(r)'},cerr}
\DoxyCodeLine{2166           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after exps 2nd try Cacc(r)'},cerr/ctyp}
\DoxyCodeLine{2167 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2168 \textcolor{preprocessor}{}}
\DoxyCodeLine{2169           \textcolor{keywordflow}{if}(checkest.gt.impest\_c.and.mode\_coli.lt.1) \textcolor{keywordflow}{goto} 100     \textcolor{comment}{! error larger than expected: try other methods}}
\DoxyCodeLine{2170           }
\DoxyCodeLine{2171         \textcolor{keywordflow}{elseif} (use\_gp.and.err\_gp(r).le.min(err\_g(r),err\_gy(r),err\_gr(r),err\_gpf(r))        \&}
\DoxyCodeLine{2172             .and.mod(crcalc(r),32)-\/mod(crcalc(r),16).ne.16) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2173 }
\DoxyCodeLine{2174 \textcolor{comment}{!          deallocate(C\_alt)}}
\DoxyCodeLine{2175 \textcolor{comment}{!          deallocate(Cuv\_alt)}}
\DoxyCodeLine{2176 \textcolor{comment}{!          deallocate(Cerr\_alt)}}
\DoxyCodeLine{2177 \textcolor{comment}{!          deallocate(Cerr2\_alt)}}
\DoxyCodeLine{2178 \textcolor{comment}{!          deallocate(Crmethod\_alt)}}
\DoxyCodeLine{2179 \textcolor{comment}{!          allocate(C\_alt(0:r,0:r,0:r))}}
\DoxyCodeLine{2180 \textcolor{comment}{!          allocate(Cuv\_alt(0:r,0:r,0:r))}}
\DoxyCodeLine{2181 \textcolor{comment}{!          allocate(Cerr\_alt(0:r))}}
\DoxyCodeLine{2182 \textcolor{comment}{!          allocate(Cerr2\_alt(0:r))}}
\DoxyCodeLine{2183 \textcolor{comment}{!          allocate(Crmethod\_alt(0:r))}}
\DoxyCodeLine{2184 }
\DoxyCodeLine{2185           \textcolor{keywordflow}{if} (r.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2186             \textcolor{keyword}{call }calccgp(c\_alt,cuv,p10,p21,p20,m02,m12,m22,r,gp,rmax\_c,id,cerr1\_alt,acc\_req\_cr,cerr2\_alt)}
\DoxyCodeLine{2187           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2188             \textcolor{keyword}{call }calccgp(c\_alt(0:r,0:r,0:r),cuv\_alt(0:r,0:r,0:r),   \&}
\DoxyCodeLine{2189                 p10,p21,p20,m02,m12,m22,r,gp,rmax\_c,id,cerr1\_alt(0:r),acc\_req\_cr(0:r),cerr2\_alt(0:r))}
\DoxyCodeLine{2190 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2191 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{2192 \textcolor{preprocessor}{}          cerr\_alt = cerr2\_alt}
\DoxyCodeLine{2193 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2194 \textcolor{preprocessor}{}          cerr\_alt = cerr1\_alt}
\DoxyCodeLine{2195 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2196 \textcolor{preprocessor}{}          ccount(15) = ccount(15)+1}
\DoxyCodeLine{2197           crcalc(0:r)=crcalc(0:r)+16}
\DoxyCodeLine{2198           ccalc=ccalc+16}
\DoxyCodeLine{2199           crmethod\_alt(0:r)=16}
\DoxyCodeLine{2200           checkest=cerr\_alt(r)/err\_gp(r)}
\DoxyCodeLine{2201 }
\DoxyCodeLine{2202 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{2203 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_c.or.checkest.lt.1d-\/2*impest\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2204             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: estimate err\_gp imprecise'},err\_gp(r),cerr\_alt(r)}
\DoxyCodeLine{2205 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2206 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2207 \textcolor{preprocessor}{}}
\DoxyCodeLine{2208           err\_gp(0:r)=cerr\_alt(0:r)}
\DoxyCodeLine{2209           }
\DoxyCodeLine{2210           \textcolor{keyword}{call }copycimp3(c,c\_alt(0:r,0:r,0:r),cerr,cerr\_alt(0:r),cerr1,cerr1\_alt(0:r),   \&   }
\DoxyCodeLine{2211               cerr2,cerr2\_alt(0:r),crmethod,crmethod\_alt(0:r),rmax,r)}
\DoxyCodeLine{2212 }
\DoxyCodeLine{2213           \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2214             ctyp =  max(abs(c(0,0,0)),abs(c(0,1,0)),abs(c(0,0,1)))}
\DoxyCodeLine{2215           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2216             ctyp =  abs(c(0,0,0))}
\DoxyCodeLine{2217 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2218           err\_req\_cr = acc\_req\_cr * ctyp}
\DoxyCodeLine{2219 }
\DoxyCodeLine{2220 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{2221 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after exps 2nd try Cmethod'},crmethod}
\DoxyCodeLine{2222           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after exps 2nd try Cerr(r)'},cerr}
\DoxyCodeLine{2223           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after exps 2nd try Cacc(r)'},cerr/ctyp}
\DoxyCodeLine{2224 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2225 \textcolor{preprocessor}{}}
\DoxyCodeLine{2226           \textcolor{keywordflow}{if}(checkest.gt.impest\_c.and.mode\_coli.lt.1) \textcolor{keywordflow}{goto} 100     \textcolor{comment}{! error larger than expected: try other methods          }}
\DoxyCodeLine{2227 }
\DoxyCodeLine{2228         \textcolor{keywordflow}{elseif} (use\_gr.and.err\_gr(r).le.min(err\_g(r),err\_gy(r),err\_gp(r),err\_gpf(r))   \&}
\DoxyCodeLine{2229             .and.mod(crcalc(r),64)-\/mod(crcalc(r),32).ne.32) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2230 \textcolor{comment}{!          deallocate(C\_alt)}}
\DoxyCodeLine{2231 \textcolor{comment}{!          deallocate(Cuv\_alt)}}
\DoxyCodeLine{2232 \textcolor{comment}{!          deallocate(Cerr\_alt)}}
\DoxyCodeLine{2233 \textcolor{comment}{!          deallocate(Cerr2\_alt)}}
\DoxyCodeLine{2234 \textcolor{comment}{!          deallocate(Crmethod\_alt)}}
\DoxyCodeLine{2235 \textcolor{comment}{!          allocate(C\_alt(0:r,0:r,0:r))}}
\DoxyCodeLine{2236 \textcolor{comment}{!          allocate(Cuv\_alt(0:r,0:r,0:r))}}
\DoxyCodeLine{2237 \textcolor{comment}{!          allocate(Cerr\_alt(0:r))}}
\DoxyCodeLine{2238 \textcolor{comment}{!          allocate(Cerr2\_alt(0:r))}}
\DoxyCodeLine{2239 \textcolor{comment}{!          allocate(Crmethod\_alt(0:r))}}
\DoxyCodeLine{2240 }
\DoxyCodeLine{2241           \textcolor{keywordflow}{if} (r.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2242             \textcolor{keyword}{call }calccgr(c\_alt,cuv,p10,p21,p20,m02,m12,m22,r,gr,rmax\_c,id,cerr1\_alt,acc\_req\_cr,cerr2\_alt)}
\DoxyCodeLine{2243           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2244             \textcolor{keyword}{call }calccgr(c\_alt(0:r,0:r,0:r),cuv\_alt(0:r,0:r,0:r),   \&}
\DoxyCodeLine{2245                 p10,p21,p20,m02,m12,m22,r,gr,rmax\_c,id,cerr1\_alt(0:r),acc\_req\_cr(0:r),cerr2\_alt(0:r))}
\DoxyCodeLine{2246 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2247 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{2248 \textcolor{preprocessor}{}          cerr\_alt = cerr2\_alt}
\DoxyCodeLine{2249 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2250 \textcolor{preprocessor}{}          cerr\_alt = cerr1\_alt}
\DoxyCodeLine{2251 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2252 \textcolor{preprocessor}{}          ccount(16) = ccount(16)+1}
\DoxyCodeLine{2253           crcalc(0:r)=crcalc(0:r)+32}
\DoxyCodeLine{2254           ccalc=ccalc+32}
\DoxyCodeLine{2255           crmethod\_alt(0:r)=32}
\DoxyCodeLine{2256           checkest=cerr\_alt(r)/err\_gr(r)}
\DoxyCodeLine{2257 }
\DoxyCodeLine{2258 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{2259 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_c.or.checkest.lt.1d-\/2*impest\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2260             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: estimate err\_gr imprecise'},err\_gr(r),cerr\_alt(r)}
\DoxyCodeLine{2261 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2262 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2263 \textcolor{preprocessor}{}}
\DoxyCodeLine{2264           err\_gr(0:r)=cerr\_alt(0:r)}
\DoxyCodeLine{2265           }
\DoxyCodeLine{2266           \textcolor{keyword}{call }copycimp3(c,c\_alt(0:r,0:r,0:r),cerr,cerr\_alt(0:r),cerr1,cerr1\_alt(0:r),   \&   }
\DoxyCodeLine{2267               cerr2,cerr2\_alt(0:r),crmethod,crmethod\_alt(0:r),rmax,r)}
\DoxyCodeLine{2268 }
\DoxyCodeLine{2269           \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2270             ctyp =  max(abs(c(0,0,0)),abs(c(0,1,0)),abs(c(0,0,1)))}
\DoxyCodeLine{2271           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2272             ctyp =  abs(c(0,0,0))}
\DoxyCodeLine{2273 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2274           err\_req\_cr = acc\_req\_cr * ctyp}
\DoxyCodeLine{2275 }
\DoxyCodeLine{2276 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{2277 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after exps 2nd try Cmethod'},crmethod}
\DoxyCodeLine{2278           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after exps 2nd try Cerr(r)'},cerr}
\DoxyCodeLine{2279           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after exps 2nd try Cacc(r)'},cerr/ctyp}
\DoxyCodeLine{2280 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2281 \textcolor{preprocessor}{}}
\DoxyCodeLine{2282           \textcolor{keywordflow}{if}(checkest.gt.impest\_c.and.mode\_coli.lt.1) \textcolor{keywordflow}{goto} 100     \textcolor{comment}{! error larger than expected: try other methods          }}
\DoxyCodeLine{2283 }
\DoxyCodeLine{2284         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (use\_gpf.and.err\_gpf(r).le.min(err\_g(r),err\_gy(r),err\_gp(r),err\_gr(r))        \&}
\DoxyCodeLine{2285             .and.mod(crcalc(r),128)-\/mod(crcalc(r),64).ne.64) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2286 \textcolor{comment}{!          deallocate(C\_alt)}}
\DoxyCodeLine{2287 \textcolor{comment}{!          deallocate(Cuv\_alt)}}
\DoxyCodeLine{2288 \textcolor{comment}{!          deallocate(Cerr\_alt)}}
\DoxyCodeLine{2289 \textcolor{comment}{!          deallocate(Cerr2\_alt)}}
\DoxyCodeLine{2290 \textcolor{comment}{!          deallocate(Crmethod\_alt)}}
\DoxyCodeLine{2291 \textcolor{comment}{!          allocate(C\_alt(0:r,0:r,0:r))}}
\DoxyCodeLine{2292 \textcolor{comment}{!          allocate(Cuv\_alt(0:r,0:r,0:r))}}
\DoxyCodeLine{2293 \textcolor{comment}{!          allocate(Cerr\_alt(0:r))}}
\DoxyCodeLine{2294 \textcolor{comment}{!          allocate(Cerr2\_alt(0:r))}}
\DoxyCodeLine{2295 \textcolor{comment}{!          allocate(Crmethod\_alt(0:r))}}
\DoxyCodeLine{2296 }
\DoxyCodeLine{2297           \textcolor{keywordflow}{if} (r.eq.rmax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2298             \textcolor{keyword}{call }calccgpf(c\_alt,cuv,p10,p21,p20,m02,m12,m22,r,gpf,(rmax\_c)/2,id,cerr1\_alt,acc\_req\_cr,cerr2\_alt)}
\DoxyCodeLine{2299           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2300             \textcolor{keyword}{call }calccgpf(c\_alt(0:r,0:r,0:r),cuv\_alt(0:r,0:r,0:r),  \&}
\DoxyCodeLine{2301                 p10,p21,p20,m02,m12,m22,r,gpf,(rmax\_c)/2,id,cerr1\_alt(0:r),acc\_req\_cr(0:r),cerr2\_alt(0:r))}
\DoxyCodeLine{2302 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2303 \textcolor{preprocessor}{\#ifdef PVEST2}}
\DoxyCodeLine{2304 \textcolor{preprocessor}{}          cerr\_alt = cerr2\_alt}
\DoxyCodeLine{2305 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2306 \textcolor{preprocessor}{}          cerr\_alt = cerr1\_alt}
\DoxyCodeLine{2307 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2308 \textcolor{preprocessor}{}          ccount(17) = ccount(17)+1}
\DoxyCodeLine{2309           crcalc(0:r)=crcalc(0:r)+64}
\DoxyCodeLine{2310           ccalc=ccalc+64}
\DoxyCodeLine{2311           crmethod\_alt(0:r)=64}
\DoxyCodeLine{2312           checkest=cerr\_alt(r)/err\_gpf(r)}
\DoxyCodeLine{2313 }
\DoxyCodeLine{2314 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{2315 \textcolor{preprocessor}{}          \textcolor{keywordflow}{if}(checkest.gt.1d2*impest\_c.or.checkest.lt.1d-\/2*impest\_c) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2316             \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: estimate err\_gpf imprecise'},err\_gpf(r),cerr\_alt(r)}
\DoxyCodeLine{2317 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2318 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2319 \textcolor{preprocessor}{}          err\_gpf(0:r)=cerr\_alt(0:r)}
\DoxyCodeLine{2320           }
\DoxyCodeLine{2321           \textcolor{keyword}{call }copycimp3(c,c\_alt(0:r,0:r,0:r),cerr,cerr\_alt(0:r),cerr1,cerr1\_alt(0:r),   \&   }
\DoxyCodeLine{2322               cerr2,cerr2\_alt(0:r),crmethod,crmethod\_alt(0:r),rmax,r)}
\DoxyCodeLine{2323   }
\DoxyCodeLine{2324           \textcolor{keywordflow}{if} (rmax.ge.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2325             ctyp =  max(abs(c(0,0,0)),abs(c(0,1,0)),abs(c(0,0,1)))}
\DoxyCodeLine{2326           \textcolor{keywordflow}{else}}
\DoxyCodeLine{2327             ctyp =  abs(c(0,0,0))}
\DoxyCodeLine{2328 \textcolor{keywordflow}{          end if}}
\DoxyCodeLine{2329           err\_req\_cr = acc\_req\_cr * ctyp}
\DoxyCodeLine{2330 }
\DoxyCodeLine{2331 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{2332 \textcolor{preprocessor}{}          \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after exps 2nd try Cmethod'},crmethod}
\DoxyCodeLine{2333           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after exps 2nd try Cerr(r)'},cerr}
\DoxyCodeLine{2334           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: after exps 2nd try Cacc(r)'},cerr/ctyp}
\DoxyCodeLine{2335 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2336 \textcolor{preprocessor}{}}
\DoxyCodeLine{2337           \textcolor{keywordflow}{if}(checkest.gt.impest\_c.and.mode\_coli.lt.1) \textcolor{keywordflow}{goto} 100     \textcolor{comment}{! error larger than expected: try other methods}}
\DoxyCodeLine{2338           }
\DoxyCodeLine{2339 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{2340 }
\DoxyCodeLine{2341 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{2342 }
\DoxyCodeLine{2343 \textcolor{preprocessor}{\#ifndef USEC0}}
\DoxyCodeLine{2344 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#ifndef ALWAYSPV}}
\DoxyCodeLine{2345 \textcolor{preprocessor}{}      \textcolor{comment}{! refine error estimate for C0}}
\DoxyCodeLine{2346       \textcolor{keywordflow}{if}(.not.lerr\_c0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2347 \textcolor{comment}{!        C0est =  abs(C(0,0,0))}}
\DoxyCodeLine{2348         err\_c0 = acc\_def\_c0*max( abs(c(0,0,0)), 1d0/sqrt(\mbox{\hyperlink{namespaceglobalc_af21d631408d8c766aefab2ae6a5a5082}{adetz}}) )}
\DoxyCodeLine{2349 \textcolor{comment}{!        err\_req\_Cr = acc\_req\_Cr * abs(C(0,0,0))}}
\DoxyCodeLine{2350         lerr\_c0 = .true.}
\DoxyCodeLine{2351 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{2352 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2353 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2354 \textcolor{preprocessor}{}}
\DoxyCodeLine{2355 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{2356 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: final loop err methods'},r,err\_pv(r),err\_pv2(r),    \&}
\DoxyCodeLine{2357           err\_g(r),err\_gy(r),err\_gp(r),err\_gr(r),err\_gpf(r)}
\DoxyCodeLine{2358       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: final loop acc methods'},r,err\_pv(r)/ctyp,err\_pv2(r)/ctyp,    \&}
\DoxyCodeLine{2359              err\_g(r)/ctyp,err\_gy(r)/ctyp,err\_gp(r)/ctyp,err\_gr(r)/ctyp,err\_gpf(r)/ctyp}
\DoxyCodeLine{2360       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred: final loop'},r,crcalc(r),crmethod(r)}
\DoxyCodeLine{2361 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2362 \textcolor{preprocessor}{}\textcolor{keywordflow}{    end do}}
\DoxyCodeLine{2363 }
\DoxyCodeLine{2364     norm = abs(c(0,0,0))}
\DoxyCodeLine{2365     \textcolor{keywordflow}{do} r=1,rdef}
\DoxyCodeLine{2366       \textcolor{keywordflow}{do} n1=0,rdef}
\DoxyCodeLine{2367         n2 = rdef-\/n1}
\DoxyCodeLine{2368        norm =  max(norm,abs(c(0,n1,n2)))}
\DoxyCodeLine{2369 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{2370 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{2371     acc\_c(0:rdef) = cerr(0:rdef)/norm}
\DoxyCodeLine{2372 }
\DoxyCodeLine{2373     ccount(ccalc+ccountoffset0) = ccount(ccalc+ccountoffset0)+1}
\DoxyCodeLine{2374 }
\DoxyCodeLine{2375     \textcolor{keywordflow}{if} (maxval(acc\_c(0:rdef)-\/sqrt(reqacc\_coli)).gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2376       ccount(ccalc+ccountoffset3) = ccount(ccalc+ccountoffset3)+1}
\DoxyCodeLine{2377 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{2378 }
\DoxyCodeLine{2379     \textcolor{keywordflow}{if} (maxval(acc\_c(0:rdef)-\/reqacc\_coli).gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2380       ccount(ccalc+ccountoffset1) = ccount(ccalc+ccountoffset1)+1}
\DoxyCodeLine{2381 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{2382 }
\DoxyCodeLine{2383 \textcolor{preprocessor}{\#ifdef Credtest              }}
\DoxyCodeLine{2384 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred final acc\_C='},cerr/norm,critacc\_coli}
\DoxyCodeLine{2385     \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred final method C='},crmethod}
\DoxyCodeLine{2386 \textcolor{preprocessor}{\#endif              }}
\DoxyCodeLine{2387 \textcolor{preprocessor}{}}
\DoxyCodeLine{2388     \textcolor{keywordflow}{if} (maxval(acc\_c(0:rdef)-\/critacc\_coli).gt.0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2389 }
\DoxyCodeLine{2390       ccount(ccalc+ccountoffset2) = ccount(ccalc+ccountoffset2)+1}
\DoxyCodeLine{2391 }
\DoxyCodeLine{2392 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{2393 \textcolor{preprocessor}{}      \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CritPoint C'},critacc\_coli,acc\_c}
\DoxyCodeLine{2394       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CritPoint C'},maxval(acc\_c(0:rdef)-\/critacc\_coli),maxval(acc\_c(0:rdef)),rdef,acc\_c(rdef)}
\DoxyCodeLine{2395 \textcolor{preprocessor}{\#endif      }}
\DoxyCodeLine{2396 \textcolor{preprocessor}{}}
\DoxyCodeLine{2397 \textcolor{comment}{!      call SetErrFlag\_coli(-\/5)}}
\DoxyCodeLine{2398 \textcolor{comment}{!      call ErrOut\_coli('CalcCred',' critical accuracy not reached', \&}}
\DoxyCodeLine{2399 \textcolor{comment}{!           errorwriteflag)}}
\DoxyCodeLine{2400 }
\DoxyCodeLine{2401 \textcolor{preprocessor}{\#ifdef CritPointsCOLI }}
\DoxyCodeLine{2402 \textcolor{preprocessor}{}      critpointcntc = critpointcntc + 1    }
\DoxyCodeLine{2403 }
\DoxyCodeLine{2404       \textcolor{keywordflow}{if} (critpointcntc.le.maxcritpointc.and.monitoring) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2405         \textcolor{keyword}{call }critpointsout\_coli(\textcolor{stringliteral}{'C\_coli'},acc\_c(rdef))}
\DoxyCodeLine{2406         \textcolor{keyword}{write}(ncpout\_coli,*) \textcolor{stringliteral}{'arguments of CalcCred\_coli:'}}
\DoxyCodeLine{2407         \textcolor{keyword}{write}(ncpout\_coli,*) \textcolor{stringliteral}{'rank = '}, rmax}
\DoxyCodeLine{2408         \textcolor{keywordflow}{if}(\textcolor{keyword}{present}(rbasic)) \textcolor{keyword}{write}(ncpout\_coli,*) \textcolor{stringliteral}{'rbas = '}, rbasic}
\DoxyCodeLine{2409         \textcolor{keyword}{write}(ncpout\_coli,fmt1) \textcolor{stringliteral}{'p10 = '}, p10}
\DoxyCodeLine{2410         \textcolor{keyword}{write}(ncpout\_coli,fmt1) \textcolor{stringliteral}{'p21 = '}, p21}
\DoxyCodeLine{2411         \textcolor{keyword}{write}(ncpout\_coli,fmt1) \textcolor{stringliteral}{'p20 = '}, p20}
\DoxyCodeLine{2412         \textcolor{keyword}{write}(ncpout\_coli,fmt1) \textcolor{stringliteral}{'m02 = '}, m02}
\DoxyCodeLine{2413         \textcolor{keyword}{write}(ncpout\_coli,fmt1) \textcolor{stringliteral}{'m12 = '}, m12}
\DoxyCodeLine{2414         \textcolor{keyword}{write}(ncpout\_coli,fmt1) \textcolor{stringliteral}{'m22 = '}, m22}
\DoxyCodeLine{2415         \textcolor{keywordflow}{if} (critpointcntc.eq.maxcritpointc) \textcolor{keywordflow}{then}}
\DoxyCodeLine{2416           \textcolor{keyword}{write}(ncpout\_coli,*)}
\DoxyCodeLine{2417           \textcolor{keyword}{write}(ncpout\_coli,*)}
\DoxyCodeLine{2418           \textcolor{keyword}{write}(ncpout\_coli,*)}
\DoxyCodeLine{2419           \textcolor{keyword}{write}(ncpout\_coli,*) \textcolor{stringliteral}{'***********************************************************'}}
\DoxyCodeLine{2420           \textcolor{keyword}{write}(ncpout\_coli,*)}
\DoxyCodeLine{2421           \textcolor{keyword}{write}(ncpout\_coli,*) \textcolor{stringliteral}{' Further output of bad C functions will be suppressed '}}
\DoxyCodeLine{2422 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{2423 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{2424 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2425 \textcolor{preprocessor}{}\textcolor{keywordflow}{    end if}}
\DoxyCodeLine{2426 }
\DoxyCodeLine{2427 \textcolor{preprocessor}{\#ifdef Credtest}}
\DoxyCodeLine{2428 \textcolor{preprocessor}{}    \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'CalcCred out'}}
\DoxyCodeLine{2429 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2430 \textcolor{preprocessor}{}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductionc_a2e20ea986747112f4fd11824edd0b104}\label{namespacereductionc_a2e20ea986747112f4fd11824edd0b104}} 
\index{reductionc@{reductionc}!calccuv@{calccuv}}
\index{calccuv@{calccuv}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{calccuv()}{calccuv()}}
{\footnotesize\ttfamily subroutine reductionc\+::calccuv (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(out)}]{Cuv,  }\item[{double complex, dimension(0\+:rmax-\/1,0\+:rmax-\/1,0\+:rmax-\/1), intent(in)}]{Buv\+\_\+0,  }\item[{double complex, intent(in)}]{m02,  }\item[{double complex, dimension(2), intent(in)}]{f,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{id }\end{DoxyParamCaption})}



Definition at line 2442 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{2442   }
\DoxyCodeLine{2443     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: rmax,id}
\DoxyCodeLine{2444     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: m02,f(2)}
\DoxyCodeLine{2445 \textcolor{comment}{!   double complex, intent(inout) :: Cuv(0:rmax,0:rmax,0:rmax)}}
\DoxyCodeLine{2446     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(out)} :: Cuv(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{2447     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: Buv\_0(0:rmax-\/1,0:rmax-\/1,0:rmax-\/1)}
\DoxyCodeLine{2448     \textcolor{keywordtype}{integer} :: r,n0,n1,n2,r0}
\DoxyCodeLine{2449         }
\DoxyCodeLine{2450     \textcolor{comment}{! C\_(0,n1,n2) UV-\/finite}}
\DoxyCodeLine{2451     cuv(0,:,:) = 0d0}
\DoxyCodeLine{2452     }
\DoxyCodeLine{2453 \textcolor{comment}{!    do r=2,rmax}}
\DoxyCodeLine{2454 \textcolor{comment}{!      do n0=1,rmax/2}}
\DoxyCodeLine{2455 \textcolor{comment}{!        do n1=0,r-\/2*n0}}
\DoxyCodeLine{2456 \textcolor{comment}{!          n2 = r-\/2*n0-\/n1}}
\DoxyCodeLine{2457     \textcolor{keywordflow}{do} r=2,2*rmax}
\DoxyCodeLine{2458       \textcolor{keywordflow}{do} n0=max(1,r-\/rmax),r/2}
\DoxyCodeLine{2459         \textcolor{keywordflow}{do} n1=0,r-\/2*n0}
\DoxyCodeLine{2460           n2 = r-\/2*n0-\/n1}
\DoxyCodeLine{2461         }
\DoxyCodeLine{2462           cuv(n0,n1,n2) = (buv\_0(n0-\/1,n1,n2) + 2*m02*cuv(n0-\/1,n1,n2)  \&}
\DoxyCodeLine{2463                           + f(1)*cuv(n0-\/1,n1+1,n2)  \& }
\DoxyCodeLine{2464                           + f(2)*cuv(n0-\/1,n1,n2+1)) / (2*r) }
\DoxyCodeLine{2465 }
\DoxyCodeLine{2466 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{2467 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{2468 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{2469     }

\end{DoxyCode}
\mbox{\Hypertarget{namespacereductionc_adf734eec39325cfe8542e6050a2e12b5}\label{namespacereductionc_adf734eec39325cfe8542e6050a2e12b5}} 
\index{reductionc@{reductionc}!copycimp3@{copycimp3}}
\index{copycimp3@{copycimp3}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{copycimp3()}{copycimp3()}}
{\footnotesize\ttfamily subroutine reductionc\+::copycimp3 (\begin{DoxyParamCaption}\item[{double complex, dimension(0\+:rmax,0\+:rmax,0\+:rmax), intent(inout)}]{C,  }\item[{double complex, dimension(0\+:r\+\_\+alt,0\+:r\+\_\+alt,0\+:r\+\_\+alt), intent(in)}]{C\+\_\+alt,  }\item[{double precision, dimension(0\+:rmax), intent(inout)}]{Cerr,  }\item[{double precision, dimension(0\+:r\+\_\+alt), intent(in)}]{Cerr\+\_\+alt,  }\item[{double precision, dimension(0\+:rmax), intent(inout)}]{Cerr1,  }\item[{double precision, dimension(0\+:r\+\_\+alt), intent(in)}]{Cerr1\+\_\+alt,  }\item[{double precision, dimension(0\+:rmax), intent(inout)}]{Cerr2,  }\item[{double precision, dimension(0\+:r\+\_\+alt), intent(in)}]{Cerr2\+\_\+alt,  }\item[{integer, dimension(0\+:rmax), intent(inout)}]{Crmethod,  }\item[{integer, dimension(0\+:rmax), intent(in)}]{Crmethod\+\_\+alt,  }\item[{integer, intent(in)}]{rmax,  }\item[{integer, intent(in)}]{r\+\_\+alt }\end{DoxyParamCaption})}



Definition at line 8324 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{8324 }
\DoxyCodeLine{8325     \textcolor{keywordtype}{integer},   \textcolor{keywordtype}{intent(in)} :: rmax,r\_alt}
\DoxyCodeLine{8326     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(inout)} :: C(0:rmax,0:rmax,0:rmax)}
\DoxyCodeLine{8327     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(inout)} :: Cerr(0:rmax),Cerr1(0:rmax),Cerr2(0:rmax)}
\DoxyCodeLine{8328     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(inout)} :: Crmethod(0:rmax)}
\DoxyCodeLine{8329     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{intent(in)} :: C\_alt(0:r\_alt,0:r\_alt,0:r\_alt)}
\DoxyCodeLine{8330     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(in)} :: Cerr\_alt(0:r\_alt),Cerr2\_alt(0:r\_alt),Cerr1\_alt(0:r\_alt)}
\DoxyCodeLine{8331     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: Crmethod\_alt(0:rmax)}
\DoxyCodeLine{8332 }
\DoxyCodeLine{8333     \textcolor{keywordtype}{integer} :: r,n1,n0}
\DoxyCodeLine{8334 }
\DoxyCodeLine{8335 \textcolor{comment}{!    write(*,*) 'CopyCimp3: Cerr =',Cerr}}
\DoxyCodeLine{8336 \textcolor{comment}{!    write(*,*) 'CopyCimp3: Cerr\_alt =',Cerr\_alt}}
\DoxyCodeLine{8337 }
\DoxyCodeLine{8338     \textcolor{keywordflow}{do} r=0,r\_alt}
\DoxyCodeLine{8339       \textcolor{keywordflow}{if} (cerr\_alt(r).lt.cerr(r)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{8340         crmethod(r)=crmethod\_alt(r)}
\DoxyCodeLine{8341         cerr(r)=cerr\_alt(r)}
\DoxyCodeLine{8342         cerr1(r)=cerr1\_alt(r)}
\DoxyCodeLine{8343         cerr2(r)=cerr2\_alt(r)}
\DoxyCodeLine{8344         \textcolor{keywordflow}{forall} (n0=0:r)}
\DoxyCodeLine{8345           \textcolor{keywordflow}{forall} (n1=0:r-\/n0)}
\DoxyCodeLine{8346             c(n0,n1,r-\/n0-\/n1) = c\_alt(n0,n1,r-\/n0-\/n1)}
\DoxyCodeLine{8347 \textcolor{keywordflow}{          end forall}}
\DoxyCodeLine{8348 \textcolor{keywordflow}{        end forall}}
\DoxyCodeLine{8349 \textcolor{comment}{!        forall (n1=0:r)}}
\DoxyCodeLine{8350 \textcolor{comment}{!          forall (n2=0:r-\/n1)}}
\DoxyCodeLine{8351 \textcolor{comment}{!            C((r-\/n1-\/n2)/2,n1,n2) = C\_alt((r-\/n1-\/n2)/2,n1,n2)}}
\DoxyCodeLine{8352 \textcolor{comment}{!          end forall}}
\DoxyCodeLine{8353 \textcolor{comment}{!        end forall}}
\DoxyCodeLine{8354 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{8355 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{8356 }

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacereductionc_a19db4465a44ccdcd73f8e4db70749b94}\label{namespacereductionc_a19db4465a44ccdcd73f8e4db70749b94}} 
\index{reductionc@{reductionc}!truncfacc@{truncfacc}}
\index{truncfacc@{truncfacc}!reductionc@{reductionc}}
\doxysubsubsection{\texorpdfstring{truncfacc}{truncfacc}}
{\footnotesize\ttfamily double precision, parameter reductionc\+::truncfacc = 1d2}



Definition at line 82 of file reduction\+C.\+F90.


\begin{DoxyCode}{0}
\DoxyCodeLine{82   \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{parameter} :: truncfacC = 1d2}

\end{DoxyCode}
